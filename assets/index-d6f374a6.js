function yU(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var PI=Symbol("$$IDENTIFIER_DECORATOR");function BI(t){return typeof t=="function"}function qy(t){return!!(t&&typeof t.useClass<"u")}function Qy(t){return!!(t&&typeof t.useFactory<"u")}function Jy(t){return!!(t&&typeof t.useValue<"u")}function eS(t){return!!(t&&typeof t.useAsync<"u")}var FI=Symbol("AsyncHook");function Lf(t){return!!(t&&t.__symbol===FI)}function b1(t){return typeof t>"u"?"undefined":BI(t)&&!t[PI]?t.name:t.toString()}var hr;(function(t){t.MANY="many",t.OPTIONAL="optional",t.REQUIRED="required"})(hr||(hr={}));var a1;(function(t){t.SELF="self",t.SKIP_SELF="skipSelf"})(a1||(a1={}));var SU=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),qi=function(t){SU(e,t);function e(n){return t.call(this,"[redi]: ".concat(n))||this}return e}(Error),UI=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),tS=Symbol("$$TARGET"),Bp=Symbol("$$DEPENDENCIES"),EU=function(t){UI(e,t);function e(n,r){var i="Could not find dependency registered on the ".concat(n,' (indexed) parameter of the constructor of "').concat(b1(r),'".');return t.call(this,i)||this}return e}(qi),HI=function(t){UI(e,t);function e(n,r){var i='It seems that you register "undefined" as dependency on the '.concat(r+1,' parameter of "').concat(b1(n),'". Please make sure that there is not cyclic dependency among your TypeScript files, or consider using "forwardRef". For more info please visit our website https://redi.wendell.fun/docs/debug#could-not-find-dependency-registered-on');return t.call(this,i)||this}return e}(qi);function VI(t){var e=t;return e[Bp]||[]}function X_(t,e){var n=VI(t),r=n.find(function(i){return i.paramIndex===e});if(!r)throw new EU(e,t);return r}function jI(t,e,n,r,i){r===void 0&&(r=hr.REQUIRED);var o={paramIndex:n,identifier:e,quantity:r,lookUp:i,withNew:!1};if(typeof e>"u")throw new HI(t,n);var s=t;s[tS]===s?s[Bp].push(o):(s[Bp]=[o],s[tS]=s)}var nS=new Set;function nn(t){if(nS.has(t))throw new qi('Identifier "'.concat(t,'" already exists.'));nS.add(t);var e=function(n,r,i){jI(n,e,i)};return e.toString=function(){return t},e[PI]=!0,e}var wU=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),RU=function(t){wU(e,t);function e(n,r,i){var o='Expect "'.concat(r,'" dependency items for id "').concat(b1(n),'" but get ').concat(i,".");return t.call(this,o)||this}return e}(qi);function zI(t,e,n){if(e===hr.OPTIONAL&&n>1||e===hr.REQUIRED&&n!==1)throw new RU(t,e,n)}function DU(t,e){return t===hr.MANY?e:e[0]}function IU(t,e,n){var r=X_(t,e);r.quantity=n}function Y_(t){return function e(n){return this instanceof e?this:function(r,i,o){if(n)jI(r,n,o,t);else{if(t===hr.REQUIRED)throw new HI(r,o);IU(r,o,t)}}}}var xU=Y_(hr.MANY),A5=Y_(hr.OPTIONAL),ne=Y_(hr.REQUIRED);function MU(t){return!!t&&typeof t.unwrap=="function"}function OU(t){return MU(t)?t.unwrap():t}function rS(t){return!!t&&typeof t.dispose=="function"}var TU=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();function $U(t){return t.length===1}var WI=function(t){TU(e,t);function e(n){var r='Cannot find "'.concat(b1(n),'" registered by any injector.');return t.call(this,r)||this}return e}(qi),kU=function(){function t(e){var n=this;this.dependencyMap=new Map,this.normalizeDependencies(e).map(function(r){return n.add(r[0],r[1])})}return t.prototype.add=function(e,n){typeof n>"u"&&(n={useClass:e,lazy:!1});var r=this.dependencyMap.get(e);typeof r>"u"&&(r=[],this.dependencyMap.set(e,r)),r.push(n)},t.prototype.delete=function(e){this.dependencyMap.delete(e)},t.prototype.get=function(e,n){n===void 0&&(n=hr.REQUIRED);var r=this.dependencyMap.get(e);return zI(e,n,r.length),DU(n,r)},t.prototype.has=function(e){return this.dependencyMap.has(e)},t.prototype.append=function(e){var n=this;this.normalizeDependencies(e).forEach(function(r){return n.add(r[0],r[1])})},t.prototype.dispose=function(){this.dependencyMap.clear()},t.prototype.normalizeDependencies=function(e){return e.map(function(n){var r=n[0],i;return $U(n)?i={useClass:n[0],lazy:!1}:i=n[1],[r,i]})},t}(),AU=function(){function t(){this.resolvedDependencies=new Map}return t.prototype.add=function(e,n){var r=this.resolvedDependencies.get(e);typeof r>"u"&&(r=[],this.resolvedDependencies.set(e,r)),r.push(n)},t.prototype.has=function(e){return this.resolvedDependencies.has(e)},t.prototype.delete=function(e){if(this.resolvedDependencies.has(e)){var n=this.resolvedDependencies.get(e);n.forEach(function(r){return rS(r)?r.dispose():void 0}),this.resolvedDependencies.delete(e)}},t.prototype.get=function(e,n){n===void 0&&(n=hr.REQUIRED);var r=this.resolvedDependencies.get(e);if(!r)throw new WI(e);return zI(e,n,r.length),n===hr.MANY?r:r[0]},t.prototype.dispose=function(){Array.from(this.resolvedDependencies.values()).forEach(function(e){e.forEach(function(n){return rS(n)?n.dispose():void 0})}),this.resolvedDependencies.clear()},t}();function NU(t,e,n){var r=X_(t,e);r.lookUp=n}function XI(t){return function e(){return this instanceof e?this:function(n,r,i){NU(n,i,t)}}}var LU=XI(a1.SKIP_SELF),PU=XI(a1.SELF);function BU(t,e,n){var r=X_(t,e);r.withNew=n}function FU(t){return function e(){return this instanceof e?this:function(n,r,i){BU(n,i,t)}}}var UU=FU(!0);function HU(t){return t?t.map(function(e,n){if(!Array.isArray(e))return{paramIndex:n,identifier:e,quantity:hr.REQUIRED,withNew:!1};var r=e.slice(0,e.length-1),i=e[e.length-1],o=void 0,s=hr.REQUIRED,a=!1;return r.forEach(function(l){if(l instanceof PU)o=a1.SELF;else if(l instanceof LU)o=a1.SKIP_SELF;else if(l instanceof A5)s=hr.OPTIONAL;else if(l instanceof xU)s=hr.MANY;else if(l instanceof UU)a=!0;else throw new qi("unknown dep modifier ".concat(l,"."))}),{paramIndex:n,identifier:i,quantity:s,lookUp:o,withNew:a}}):[]}var Fp;(function(){if(typeof requestIdleCallback<"u"&&typeof cancelIdleCallback<"u")Fp=function(e,n){var r=requestIdleCallback(e,typeof n=="number"?{timeout:n}:void 0),i=!1;return function(){i||(i=!0,cancelIdleCallback(r))}};else{var t=Object.freeze({didTimeout:!0,timeRemaining:function(){return 15}});Fp=function(e){var n=setTimeout(function(){return e(t)}),r=!1;return function(){r||(r=!0,clearTimeout(n))}}}})();var VU=function(){function t(e){var n=this;this.didRun=!1,this.selfExecutor=function(){try{n.value=e()}catch(r){n.error=r}finally{n.didRun=!0}},this.disposeCallback=Fp(function(){return n.selfExecutor()})}return t.prototype.hasRun=function(){return this.didRun},t.prototype.dispose=function(){this.disposeCallback()},t.prototype.getValue=function(){if(this.didRun||(this.dispose(),this.selfExecutor()),this.error)throw this.error;return this.value},t}(),l0=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),th=function(){return th=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},th.apply(this,arguments)},Zl=function(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},jU=300,V0=Symbol("$$NOT_INSTANTIATED_SYMBOL"),zU=function(t){l0(e,t);function e(n){return t.call(this,'Detecting cyclic dependency. The last identifier is "'.concat(b1(n),'".'))||this}return e}(qi),WU=function(t){l0(e,t);function e(){return t.call(this,"Injector cannot be accessed after it was disposed.")||this}return e}(qi),XU=function(t){l0(e,t);function e(n){return t.call(this,'Async item "'.concat(b1(n),'" returns another async item.'))||this}return e}(qi),YU=function(t){l0(e,t);function e(n){return t.call(this,'Cannot get async item "'.concat(b1(n),'" from sync api.'))||this}return e}(qi),iS=function(t){l0(e,t);function e(n){return t.call(this,'Cannot add dependency "'.concat(b1(n),'" after it is already resolved.'))||this}return e}(qi),GU=function(t){l0(e,t);function e(n){return t.call(this,'Cannot dependency dependency "'.concat(b1(n),'" after it is already resolved.'))||this}return e}(qi),Tn=function(){function t(e,n){n===void 0&&(n=null),this.parent=n,this.children=[],this.resolutionOngoing=0,this.disposed=!1,this.dependencyCollection=new kU(e||[]),this.resolvedDependencyCollection=new AU,n&&n.children.push(this)}return t.prototype.createChild=function(e){return this.ensureInjectorNotDisposed(),new t(e,this)},t.prototype.dispose=function(){this.children.forEach(function(e){return e.dispose()}),this.children.length=0,this.dependencyCollection.dispose(),this.resolvedDependencyCollection.dispose(),this.deleteSelfFromParent(),this.disposed=!0},t.prototype.deleteSelfFromParent=function(){if(this.parent){var e=this.parent.children.indexOf(this);e>-1&&this.parent.children.splice(e,1)}},t.prototype.add=function(e){this.ensureInjectorNotDisposed();var n=e[0],r=e[1];if(this.resolvedDependencyCollection.has(n))throw new iS(n);typeof r>"u"?this.dependencyCollection.add(n):eS(r)||qy(r)||Jy(r)||Qy(r)?this.dependencyCollection.add(n,r):this.resolvedDependencyCollection.add(n,r)},t.prototype.replace=function(e){this.ensureInjectorNotDisposed();var n=e[0];if(this.resolvedDependencyCollection.has(n))throw new iS(n);this.dependencyCollection.delete(n),e.length===1?this.dependencyCollection.add(n):this.dependencyCollection.add(n,e[1])},t.prototype.delete=function(e){if(this.ensureInjectorNotDisposed(),this.resolvedDependencyCollection.has(e))throw new GU(e);this.dependencyCollection.delete(e)},t.prototype.invoke=function(e){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o={get:function(s,a,l){return n._get(s,a,l)}};return e.apply(void 0,Zl([o],r,!1))},t.prototype.has=function(e){var n;return this.dependencyCollection.has(e)||((n=this.parent)===null||n===void 0?void 0:n.has(e))||!1},t.prototype.get=function(e,n,r){var i=this._get(e,n,r);if(Array.isArray(i)&&i.some(function(o){return Lf(o)})||Lf(i))throw new YU(e);return i},t.prototype._get=function(e,n,r,i){this.ensureInjectorNotDisposed();var o=hr.REQUIRED;if(n===hr.REQUIRED||n===hr.OPTIONAL||n===hr.MANY?o=n:r=n,!i){var s=this.getValue(e,o,r);if(s!==V0)return s}return this.createDependency(e,o,r,!i)},t.prototype.getAsync=function(e){this.ensureInjectorNotDisposed();var n=this.getValue(e,hr.REQUIRED);if(n!==V0)return Promise.resolve(n);var r=this.createDependency(e,hr.REQUIRED);return Lf(r)?r.whenReady():Promise.resolve(r)},t.prototype.createInstance=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return this.ensureInjectorNotDisposed(),this._resolveClass.apply(this,Zl([e],n,!1))},t.prototype.resolveDependency=function(e,n,r){return r===void 0&&(r=!0),Jy(n)?this.resolveValueDependency(e,n):Qy(n)?this.resolveFactory(e,n,r):qy(n)?this.resolveClass(e,n,r):this.resolveAsync(e,n)},t.prototype.resolveValueDependency=function(e,n){var r=n.useValue;return this.resolvedDependencyCollection.add(e,r),r},t.prototype.resolveClass=function(e,n,r){var i=this;r===void 0&&(r=!0);var o=n.useClass,s;if(n.lazy){var a=new VU(function(){return i._resolveClass(o)});s=new Proxy(Object.create(null),{get:function(l,u){var c;if(u in l)return l[u];if(u!=="whenReady"){var d=a.hasRun(),h=a.getValue();d||(c=n.onInstantiation)===null||c===void 0||c.call(n,h);var f=h[u];return typeof f!="function"||(f=f.bind(h),l[u]=f),f}},set:function(l,u,c){return a.getValue()[u]=c,!0}})}else s=this._resolveClass(o);return e&&r&&this.resolvedDependencyCollection.add(e,s),s},t.prototype._resolveClass=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.markNewResolution(e);for(var i=VI(e).sort(function(m,p){return m.paramIndex-p.paramIndex}).map(function(m){return th(th({},m),{identifier:OU(m.identifier)})}),o=[],s=0,a=i;s<a.length;s++){var l=a[s],u=this._get(l.identifier,l.quantity,l.lookUp,l.withNew);o.push(u)}var c=Zl([],n,!0),d=i.length>0?i[0].paramIndex:c.length;if(c.length!==d){console.warn("[redi]: Expect ".concat(d," custom parameter(s) of ").concat(e.toString()," but get ").concat(c.length,"."));var h=d-c.length;h>0?c=Zl(Zl([],c,!0),new Array(h).fill(void 0),!0):c=c.slice(0,d)}var f=new(e.bind.apply(e,Zl(Zl([void 0],c,!1),o,!1)));return this.markResolutionCompleted(),f},t.prototype.resolveFactory=function(e,n,r){var i;this.markNewResolution(e);for(var o=HU(n.deps),s=[],a=0,l=o;a<l.length;a++){var u=l[a],c=this._get(u.identifier,u.quantity,u.lookUp,u.withNew);s.push(c)}var d=n.useFactory.apply(null,s);return r&&this.resolvedDependencyCollection.add(e,d),this.markResolutionCompleted(),(i=n==null?void 0:n.onInstantiation)===null||i===void 0||i.call(n,d),d},t.prototype.resolveAsync=function(e,n){var r=this,i={__symbol:FI,whenReady:function(){return r._resolveAsync(e,n)}};return i},t.prototype._resolveAsync=function(e,n){var r=this;return n.useAsync().then(function(i){var o=r.getValue(e);if(o!==V0)return o;var s;if(Array.isArray(i)){var a=i[1];if(eS(a))throw new XU(e);s=r.resolveDependency(e,a)}else BI(i)?s=r._resolveClass(i):s=i;return r.resolvedDependencyCollection.add(e,s),s})},t.prototype.getValue=function(e,n,r){var i=this;n===void 0&&(n=hr.REQUIRED);var o=function(){return i.dependencyCollection.has(e)&&!i.resolvedDependencyCollection.has(e)?V0:i.resolvedDependencyCollection.get(e,n)},s=function(){return i.parent?i.parent.getValue(e,n):V0};return r===a1.SKIP_SELF?s():r===a1.SELF||this.resolvedDependencyCollection.has(e)||this.dependencyCollection.has(e)?o():s()},t.prototype.createDependency=function(e,n,r,i){var o=this;n===void 0&&(n=hr.REQUIRED),i===void 0&&(i=!0);var s=function(){var l=o.dependencyCollection.get(e,n),u=null;return Array.isArray(l)?u=l.map(function(c){return o.resolveDependency(e,c,i)}):l&&(u=o.resolveDependency(e,l,i)),u},a=function(){if(o.parent)return o.parent.createDependency(e,n,void 0,i);if(n===hr.OPTIONAL)return null;throw new WI(e)};return r===a1.SKIP_SELF?a():e===t?this:this.dependencyCollection.has(e)?s():a()},t.prototype.markNewResolution=function(e){if(this.resolutionOngoing+=1,this.resolutionOngoing>=jU)throw new zU(e)},t.prototype.markResolutionCompleted=function(){this.resolutionOngoing-=1},t.prototype.ensureInjectorNotDisposed=function(){if(this.disposed)throw new WU},t}(),oS=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof global<"u"&&global,sS="REDI_GLOBAL_LOCK";oS[sS]?console.error(`[redi]: You are loading scripts of redi more than once! This may cause undesired behavior in your application.
Maybe your dependencies added redi as its dependency and bundled redi to its dist files. Or you import different versions of redi.
For more info please visit our website: https://redi.wendell.fun/en-US/docs/debug#import-scripts-of-redi-more-than-once`):oS[sS]=!0;var Up=function(t,e){return Up=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Up(t,e)};function C1(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Up(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function KU(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(d){s(d)}}function l(c){try{u(r.throw(c))}catch(d){s(d)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})}function YI(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(n=0)),n;)try{if(r=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){n.label=u[1];break}if(u[0]===6&&n.label<o[1]){n.label=o[1],o=u;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(u);break}o[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(c){u=[6,c],i=0}finally{r=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Fu(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function wl(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function Uu(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function S2(t){return this instanceof S2?(this.v=t,this):new S2(t)}function ZU(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(h){r[h]&&(i[h]=function(f){return new Promise(function(m,p){o.push([h,f,m,p])>1||a(h,f)})})}function a(h,f){try{l(r[h](f))}catch(m){d(o[0][3],m)}}function l(h){h.value instanceof S2?Promise.resolve(h.value.v).then(u,c):d(o[0][2],h)}function u(h){a("next",h)}function c(h){a("throw",h)}function d(h,f){h(f),o.shift(),o.length&&a(o[0][0],o[0][1])}}function qU(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Fu=="function"?Fu(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,l){s=t[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(u){o({value:u,done:a})},s)}}function nr(t){return typeof t=="function"}function GI(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Pf=GI(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function s6(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var u0=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=Fu(s),l=a.next();!l.done;l=a.next()){var u=l.value;u.remove(this)}}catch(p){e={error:p}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else s.remove(this);var c=this.initialTeardown;if(nr(c))try{c()}catch(p){o=p instanceof Pf?p.errors:[p]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var h=Fu(d),f=h.next();!f.done;f=h.next()){var m=f.value;try{aS(m)}catch(p){o=o??[],p instanceof Pf?o=Uu(Uu([],wl(o)),wl(p.errors)):o.push(p)}}}catch(p){r={error:p}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}if(o)throw new Pf(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)aS(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&s6(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&s6(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),KI=u0.EMPTY;function ZI(t){return t instanceof u0||t&&"closed"in t&&nr(t.remove)&&nr(t.add)&&nr(t.unsubscribe)}function aS(t){nr(t)?t():t.unsubscribe()}var qI={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Hp={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=Hp.delegate;return i!=null&&i.setTimeout?i.setTimeout.apply(i,Uu([t,e],wl(n))):setTimeout.apply(void 0,Uu([t,e],wl(n)))},clearTimeout:function(t){var e=Hp.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function QI(t){Hp.setTimeout(function(){throw t})}function Vp(){}function a3(t){t()}var G_=function(t){C1(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,ZI(n)&&n.add(r)):r.destination=tH,r}return e.create=function(n,r,i){return new jp(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(u0),QU=Function.prototype.bind;function Bf(t,e){return QU.call(t,e)}var JU=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){t7(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){t7(r)}else t7(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){t7(n)}},t}(),jp=function(t){C1(e,t);function e(n,r,i){var o=t.call(this)||this,s;if(nr(n)||!n)s={next:n??void 0,error:r??void 0,complete:i??void 0};else{var a;o&&qI.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=function(){return o.unsubscribe()},s={next:n.next&&Bf(n.next,a),error:n.error&&Bf(n.error,a),complete:n.complete&&Bf(n.complete,a)}):s=n}return o.destination=new JU(s),o}return e}(G_);function t7(t){QI(t)}function eH(t){throw t}var tH={closed:!0,next:Vp,error:eH,complete:Vp},K_=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function c0(t){return t}function nH(t){return t.length===0?c0:t.length===1?t[0]:function(n){return t.reduce(function(r,i){return i(r)},n)}}var tn=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,o=iH(e)?e:new jp(e,n,r);return a3(function(){var s=i,a=s.operator,l=s.source;o.add(a?a.call(o,l):l?i._subscribe(o):i._trySubscribe(o))}),o},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=lS(n),new n(function(i,o){var s=new jp({next:function(a){try{e(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:i});r.subscribe(s)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[K_]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return nH(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=lS(e),new e(function(r,i){var o;n.subscribe(function(s){return o=s},function(s){return i(s)},function(){return r(o)})})},t.create=function(e){return new t(e)},t}();function lS(t){var e;return(e=t??qI.Promise)!==null&&e!==void 0?e:Promise}function rH(t){return t&&nr(t.next)&&nr(t.error)&&nr(t.complete)}function iH(t){return t&&t instanceof G_||rH(t)&&ZI(t)}function oH(t){return nr(t==null?void 0:t.lift)}function ea(t){return function(e){if(oH(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Uo(t,e,n,r,i){return new sH(t,e,n,r,i)}var sH=function(t){C1(e,t);function e(n,r,i,o,s,a){var l=t.call(this,n)||this;return l.onFinalize=s,l.shouldUnsubscribe=a,l._next=r?function(u){try{r(u)}catch(c){n.error(c)}}:t.prototype._next,l._error=o?function(u){try{o(u)}catch(c){n.error(c)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=i?function(){try{i()}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._complete,l}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(G_),aH=GI(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Qt=function(t){C1(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new uS(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new aH},e.prototype.next=function(n){var r=this;a3(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var s=Fu(r.currentObservers),a=s.next();!a.done;a=s.next()){var l=a.value;l.next(n)}}catch(u){i={error:u}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;a3(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;a3(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,o=i.hasError,s=i.isStopped,a=i.observers;return o||s?KI:(this.currentObservers=null,a.push(n),new u0(function(){r.currentObservers=null,s6(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,o=r.thrownError,s=r.isStopped;i?n.error(o):s&&n.complete()},e.prototype.asObservable=function(){var n=new tn;return n.source=this,n},e.create=function(n,r){return new uS(n,r)},e}(tn),uS=function(t){C1(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:KI},e}(Qt),rn=function(t){C1(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,o=n._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(Qt),JI={now:function(){return(JI.delegate||Date).now()},delegate:void 0},lH=function(t){C1(e,t);function e(n,r){return t.call(this)||this}return e.prototype.schedule=function(n,r){return this},e}(u0),nh={setInterval:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=nh.delegate;return i!=null&&i.setInterval?i.setInterval.apply(i,Uu([t,e],wl(n))):setInterval.apply(void 0,Uu([t,e],wl(n)))},clearInterval:function(t){var e=nh.delegate;return((e==null?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0},uH=function(t){C1(e,t);function e(n,r){var i=t.call(this,n,r)||this;return i.scheduler=n,i.work=r,i.pending=!1,i}return e.prototype.schedule=function(n,r){var i;if(r===void 0&&(r=0),this.closed)return this;this.state=n;var o=this.id,s=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(s,o,r)),this.pending=!0,this.delay=r,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(s,this.id,r),this},e.prototype.requestAsyncId=function(n,r,i){return i===void 0&&(i=0),nh.setInterval(n.flush.bind(n,this),i)},e.prototype.recycleAsyncId=function(n,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;r!=null&&nh.clearInterval(r)},e.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(n,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(n,r){var i=!1,o;try{this.work(n)}catch(s){i=!0,o=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),o},e.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,i=n.scheduler,o=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,s6(o,this),r!=null&&(this.id=this.recycleAsyncId(i,r,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(lH),cS=function(){function t(e,n){n===void 0&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(e,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,e).schedule(r,n)},t.now=JI.now,t}(),cH=function(t){C1(e,t);function e(n,r){r===void 0&&(r=cS.now);var i=t.call(this,n,r)||this;return i.actions=[],i._active=!1,i}return e.prototype.flush=function(n){var r=this.actions;if(this._active){r.push(n);return}var i;this._active=!0;do if(i=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,i){for(;n=r.shift();)n.unsubscribe();throw i}},e}(cS),ex=new cH(uH),dH=new tn(function(t){return t.complete()});function hH(t){return t&&nr(t.schedule)}function Z_(t){return t[t.length-1]}function fH(t){return nr(Z_(t))?t.pop():void 0}function N5(t){return hH(Z_(t))?t.pop():void 0}function mH(t,e){return typeof Z_(t)=="number"?t.pop():e}var q_=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function tx(t){return nr(t==null?void 0:t.then)}function nx(t){return nr(t[K_])}function rx(t){return Symbol.asyncIterator&&nr(t==null?void 0:t[Symbol.asyncIterator])}function ix(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function pH(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ox=pH();function sx(t){return nr(t==null?void 0:t[ox])}function ax(t){return ZU(this,arguments,function(){var n,r,i,o;return YI(this,function(s){switch(s.label){case 0:n=t.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,S2(n.read())];case 3:return r=s.sent(),i=r.value,o=r.done,o?[4,S2(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,S2(i)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function lx(t){return nr(t==null?void 0:t.getReader)}function y1(t){if(t instanceof tn)return t;if(t!=null){if(nx(t))return gH(t);if(q_(t))return vH(t);if(tx(t))return _H(t);if(rx(t))return ux(t);if(sx(t))return bH(t);if(lx(t))return CH(t)}throw ix(t)}function gH(t){return new tn(function(e){var n=t[K_]();if(nr(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function vH(t){return new tn(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function _H(t){return new tn(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,QI)})}function bH(t){return new tn(function(e){var n,r;try{for(var i=Fu(t),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function ux(t){return new tn(function(e){yH(t,e).catch(function(n){return e.error(n)})})}function CH(t){return ux(ax(t))}function yH(t,e){var n,r,i,o;return KU(this,void 0,void 0,function(){var s,a;return YI(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=qU(t),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(s=r.value,e.next(s),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),i={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Bs(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function cx(t,e){return e===void 0&&(e=0),ea(function(n,r){n.subscribe(Uo(r,function(i){return Bs(r,t,function(){return r.next(i)},e)},function(){return Bs(r,t,function(){return r.complete()},e)},function(i){return Bs(r,t,function(){return r.error(i)},e)}))})}function dx(t,e){return e===void 0&&(e=0),ea(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function SH(t,e){return y1(t).pipe(dx(e),cx(e))}function EH(t,e){return y1(t).pipe(dx(e),cx(e))}function wH(t,e){return new tn(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function RH(t,e){return new tn(function(n){var r;return Bs(n,e,function(){r=t[ox](),Bs(n,e,function(){var i,o,s;try{i=r.next(),o=i.value,s=i.done}catch(a){n.error(a);return}s?n.complete():n.next(o)},0,!0)}),function(){return nr(r==null?void 0:r.return)&&r.return()}})}function hx(t,e){if(!t)throw new Error("Iterable cannot be null");return new tn(function(n){Bs(n,e,function(){var r=t[Symbol.asyncIterator]();Bs(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function DH(t,e){return hx(ax(t),e)}function IH(t,e){if(t!=null){if(nx(t))return SH(t,e);if(q_(t))return wH(t,e);if(tx(t))return EH(t,e);if(rx(t))return hx(t,e);if(sx(t))return RH(t,e);if(lx(t))return DH(t,e)}throw ix(t)}function L5(t,e){return e?IH(t,e):y1(t)}function n7(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=N5(t);return L5(t,n)}function Q_(t){return!!t&&(t instanceof tn||nr(t.lift)&&nr(t.subscribe))}function Fs(t,e){return ea(function(n,r){var i=0;n.subscribe(Uo(r,function(o){r.next(t.call(e,o,i++))}))})}var xH=Array.isArray;function MH(t,e){return xH(e)?t.apply(void 0,Uu([],wl(e))):t(e)}function fx(t){return Fs(function(e){return MH(t,e)})}var OH=Array.isArray,TH=Object.getPrototypeOf,$H=Object.prototype,kH=Object.keys;function AH(t){if(t.length===1){var e=t[0];if(OH(e))return{args:e,keys:null};if(NH(e)){var n=kH(e);return{args:n.map(function(r){return e[r]}),keys:n}}}return{args:t,keys:null}}function NH(t){return t&&typeof t=="object"&&TH(t)===$H}function LH(t,e){return t.reduce(function(n,r,i){return n[r]=e[i],n},{})}function mx(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=N5(t),r=fH(t),i=AH(t),o=i.args,s=i.keys;if(o.length===0)return L5([],n);var a=new tn(PH(o,n,s?function(l){return LH(s,l)}:c0));return r?a.pipe(fx(r)):a}function PH(t,e,n){return n===void 0&&(n=c0),function(r){dS(e,function(){for(var i=t.length,o=new Array(i),s=i,a=i,l=function(c){dS(e,function(){var d=L5(t[c],e),h=!1;d.subscribe(Uo(r,function(f){o[c]=f,h||(h=!0,a--),a||r.next(n(o.slice()))},function(){--s||r.complete()}))},r)},u=0;u<i;u++)l(u)},r)}}function dS(t,e,n){t?Bs(n,t,e):e()}function BH(t,e,n,r,i,o,s,a){var l=[],u=0,c=0,d=!1,h=function(){d&&!l.length&&!u&&e.complete()},f=function(p){return u<r?m(p):l.push(p)},m=function(p){o&&e.next(p),u++;var g=!1;y1(n(p,c++)).subscribe(Uo(e,function(v){i==null||i(v),o?f(v):e.next(v)},function(){g=!0},void 0,function(){if(g)try{u--;for(var v=function(){var _=l.shift();s?Bs(e,s,function(){return m(_)}):m(_)};l.length&&u<r;)v();h()}catch(_){e.error(_)}}))};return t.subscribe(Uo(e,f,function(){d=!0,h()})),function(){a==null||a()}}function J_(t,e,n){return n===void 0&&(n=1/0),nr(e)?J_(function(r,i){return Fs(function(o,s){return e(r,o,i,s)})(y1(t(r,i)))},n):(typeof e=="number"&&(n=e),ea(function(r,i){return BH(r,i,t,n)}))}function FH(t){return t===void 0&&(t=1/0),J_(c0,t)}var UH=["addListener","removeListener"],HH=["addEventListener","removeEventListener"],VH=["on","off"];function zp(t,e,n,r){if(nr(n)&&(r=n,n=void 0),r)return zp(t,e,n).pipe(fx(r));var i=wl(WH(t)?HH.map(function(a){return function(l){return t[a](e,l,n)}}):jH(t)?UH.map(hS(t,e)):zH(t)?VH.map(hS(t,e)):[],2),o=i[0],s=i[1];if(!o&&q_(t))return J_(function(a){return zp(a,e,n)})(y1(t));if(!o)throw new TypeError("Invalid event target");return new tn(function(a){var l=function(){for(var u=[],c=0;c<arguments.length;c++)u[c]=arguments[c];return a.next(1<u.length?u:u[0])};return o(l),function(){return s(l)}})}function hS(t,e){return function(n){return function(r){return t[n](e,r)}}}function jH(t){return nr(t.addListener)&&nr(t.removeListener)}function zH(t){return nr(t.on)&&nr(t.off)}function WH(t){return nr(t.addEventListener)&&nr(t.removeEventListener)}function P5(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=N5(t),r=mH(t,1/0),i=t;return i.length?i.length===1?y1(i[0]):FH(r)(L5(i,n)):dH}function Wp(t,e){return ea(function(n,r){var i=0;n.subscribe(Uo(r,function(o){return t.call(e,o,i++)&&r.next(o)}))})}function XH(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=(e=N5(r))!==null&&e!==void 0?e:ex,s=(n=r[0])!==null&&n!==void 0?n:null,a=r[1]||1/0;return ea(function(l,u){var c=[],d=!1,h=function(p){var g=p.buffer,v=p.subs;v.unsubscribe(),s6(c,p),u.next(g),d&&f()},f=function(){if(c){var p=new u0;u.add(p);var g=[],v={buffer:g,subs:p};c.push(v),Bs(p,o,function(){return h(v)},t)}};s!==null&&s>=0?Bs(u,o,f,s,!0):d=!0,f();var m=Uo(u,function(p){var g,v,_=c.slice();try{for(var C=Fu(_),y=C.next();!y.done;y=C.next()){var S=y.value,E=S.buffer;E.push(p),a<=E.length&&h(S)}}catch(w){g={error:w}}finally{try{y&&!y.done&&(v=C.return)&&v.call(C)}finally{if(g)throw g.error}}},function(){for(;c!=null&&c.length;)u.next(c.shift().buffer);m==null||m.unsubscribe(),u.complete(),u.unsubscribe()},void 0,function(){return c=null});l.subscribe(m)})}function YH(t,e){return e===void 0&&(e=ex),ea(function(n,r){var i=null,o=null,s=null,a=function(){if(i){i.unsubscribe(),i=null;var u=o;o=null,r.next(u)}};function l(){var u=s+t,c=e.now();if(c<u){i=this.schedule(void 0,u-c),r.add(i);return}a()}n.subscribe(Uo(r,function(u){o=u,s=e.now(),i||(i=e.schedule(l,t),r.add(i))},function(){a(),r.complete()},void 0,function(){o=i=null}))})}function eb(t,e){return e===void 0&&(e=c0),t=t??GH,ea(function(n,r){var i,o=!0;n.subscribe(Uo(r,function(s){var a=e(s);(o||!t(i,a))&&(o=!1,i=a,r.next(s))}))})}function GH(t,e){return t===e}function tb(t,e){return ea(function(n,r){var i=null,o=0,s=!1,a=function(){return s&&!i&&r.complete()};n.subscribe(Uo(r,function(l){i==null||i.unsubscribe();var u=0,c=o++;y1(t(l,c)).subscribe(i=Uo(r,function(d){return r.next(e?e(l,d,c,u++):d)},function(){i=null,a()}))},function(){s=!0,a()}))})}function Ts(t){return ea(function(e,n){y1(t).subscribe(Uo(n,function(){return n.complete()},Vp)),!n.closed&&e.subscribe(n)})}function KH(t,e,n){var r=nr(t)||e||n?{next:t,error:e,complete:n}:t;return r?ea(function(i,o){var s;(s=r.subscribe)===null||s===void 0||s.call(r);var a=!0;i.subscribe(Uo(o,function(l){var u;(u=r.next)===null||u===void 0||u.call(r,l),o.next(l)},function(){var l;a=!1,(l=r.complete)===null||l===void 0||l.call(r),o.complete()},function(l){var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,l),o.error(l)},function(){var l,u;a&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):c0}var ZH=Object.defineProperty,qH=(t,e,n)=>e in t?ZH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,he=(t,e,n)=>(qH(t,typeof e!="symbol"?e+"":e,n),n);function QH(){JH()}const r7=typeof global<"u"?global:typeof self<"u"?self:window;function JH(){typeof r7.requestIdleCallback!="function"&&(r7.requestIdleCallback=function(t){const e=Date.now();return setTimeout(function(){const n=Math.max(0,50-(Date.now()-e));t({didTimeout:n===0,timeRemaining(){return n}})},1)}),typeof r7.cancelIdleCallback!="function"&&(r7.cancelIdleCallback=function(t){clearTimeout(t)})}let B5=class px{constructor(){he(this,"_data",[])}static create(){return new px}add(e){this._data.indexOf(e)>-1||this._data.push(e)}delete(e){const n=this._data.indexOf(e);this._data.splice(n,1)}getData(){return this._data}};var dr=(t=>(t[t.Univer=0]="Univer",t[t.Doc=1]="Doc",t[t.Sheet=2]="Sheet",t[t.Slide=3]="Slide",t))(dr||{});let S1=class{constructor(e){he(this,"_name"),this._name=e}onStarting(e){}onReady(){}onRendered(){}onSteady(){}onDestroy(){}getPluginName(){return this._name}};he(S1,"type",0);let eV=class{constructor(){he(this,"_plugins",[])}addPlugin(e){this._plugins.push(e)}removePlugins(){const e=this._plugins.slice();return this._plugins.length=0,e}forEachPlugin(e){this._plugins.forEach(e)}},tV=class{constructor(){he(this,"_pluginsRegisteredByBusiness",new Map)}registerPlugin(e,n){const r=e.type;this._pluginsRegisteredByBusiness.has(r)||this._pluginsRegisteredByBusiness.set(r,[]),this._pluginsRegisteredByBusiness.get(r).push({plugin:e,options:n})}getRegisterPlugins(e){return this._pluginsRegisteredByBusiness.get(e)||[]}clearPluginsOfType(e){this._pluginsRegisteredByBusiness.delete(e)}};function ga(t,e){const n=t.indexOf(e);return n>-1?(t.splice(n,1),!0):!1}function nV(t,e){for(let n=t.length-1;n>-1;n--){const r=t[n];if(e(r,n))return r}return null}function rV(t){for(const[e,n]of t.entries())try{if(!n())return{index:e,result:!1}}catch(r){return{index:e,result:!1,error:r}}return{result:!0,index:-1}}function fS(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function mS(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function pS(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function Ld(t){return typeof t=="function"}function iV(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Ff=iV(function(t){return function(e){t(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(n,r){return r+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function gS(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var gx=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=fS(s),l=a.next();!l.done;l=a.next()){var u=l.value;u.remove(this)}}catch(p){e={error:p}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else s.remove(this);var c=this.initialTeardown;if(Ld(c))try{c()}catch(p){o=p instanceof Ff?p.errors:[p]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var h=fS(d),f=h.next();!f.done;f=h.next()){var m=f.value;try{vS(m)}catch(p){o=o??[],p instanceof Ff?o=pS(pS([],mS(o)),mS(p.errors)):o.push(p)}}}catch(p){r={error:p}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}if(o)throw new Ff(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)vS(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&gS(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&gS(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}();gx.EMPTY;function oV(t){return t instanceof gx||t&&"closed"in t&&Ld(t.remove)&&Ld(t.add)&&Ld(t.unsubscribe)}function vS(t){Ld(t)?t():t.unsubscribe()}let sV=class{constructor(e=!1){he(this,"skipNextObservers"),he(this,"lastReturnValue"),he(this,"isStopPropagation",!1),this.initialize(e)}initialize(e=!1){return this.skipNextObservers=e,this}stopPropagation(){this.isStopPropagation=!0}};function aV(t){return t instanceof vx}let vx=class{constructor(e,n){he(this,"_willBeUnregistered",!1),he(this,"unregisterOnNextCall",!1),this.callback=e,this.observable=n}dispose(){this.observable.remove(this)}},Sn=class _x{constructor(e){he(this,"_observers",new Array),he(this,"_eventState"),he(this,"_onObserverAdded"),this._eventState=new sV,e&&(this._onObserverAdded=e)}get observers(){return this._observers}add(e,n=!1,r=!1){if(!e)return null;const i=new vx(e,this);return i.unregisterOnNextCall=r,n?this._observers.unshift(i):this._observers.push(i),this._onObserverAdded&&this._onObserverAdded(i),i}addOnce(e){return this.add(e,void 0,!0)}remove(e){return e&&this._observers.indexOf(e)!==-1?(this._deferUnregister(e),!0):!1}removeCallback(e){for(let n=0;n<this._observers.length;n++){const r=this._observers[n];if(!r._willBeUnregistered&&r.callback===e)return this._deferUnregister(r),!0}return!1}makeObserverTopPriority(e){this._remove(e),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e),this._observers.push(e)}notifyObservers(e){if(!this._observers.length)return null;const n=this._eventState;n.skipNextObservers=!1,n.lastReturnValue=e,n.isStopPropagation=!1;let r=!1;for(let i=0;i<this._observers.length;i++){const o=this._observers[i];if(!o._willBeUnregistered&&(n.lastReturnValue=o.callback(e,n),o.unregisterOnNextCall&&this._deferUnregister(o),n.isStopPropagation&&(r=!0),n.skipNextObservers))return{lastReturnValue:n.lastReturnValue,stopPropagation:r}}return{lastReturnValue:n.lastReturnValue,stopPropagation:r}}notifyObserversWithPromise(e){let n=Promise.resolve(e);if(!this._observers.length)return n;const r=this._eventState;r.skipNextObservers=!1;for(let i=0;i<this._observers.length;i++){const o=this._observers[i];r.skipNextObservers||o._willBeUnregistered||(n=n.then(()=>o.callback(e,r)),o.unregisterOnNextCall&&this._deferUnregister(o))}return n.then(()=>e)}notifyObserver(e,n){if(e._willBeUnregistered)return;const r=this._eventState;return r.skipNextObservers=!1,e.callback(n,r),e.unregisterOnNextCall&&this._deferUnregister(e),{lastReturnValue:r.lastReturnValue,stopPropagation:r.isStopPropagation}}hasObservers(){return this._observers.length>0}clear(){this._observers=new Array,this._onObserverAdded=null}clone(){const e=new _x;return e._observers=this._observers.slice(0),e}_deferUnregister(e){e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout(()=>{this._remove(e)},0)}_remove(e){if(!e)return!1;const n=this._observers.indexOf(e);return n!==-1?(this._observers.splice(n,1),!0):!1}};function Be(t){let e=!1;return oV(t)?{dispose:()=>{e||(e=!0,t.unsubscribe())}}:aV(t)?{dispose:()=>{e||(e=!0,t.dispose())}}:{dispose:()=>{e||(e=!0,t())}}}let Ia=class{constructor(){he(this,"_disposables",new Set)}add(e){return this._disposables.add(e),{dispose:()=>{e.dispose(),this._disposables.delete(e)}}}dispose(){this._disposables.forEach(e=>{e.dispose(),this._disposables.delete(e)})}},je=class{constructor(){he(this,"_disposed",!1),he(this,"_collection",new Ia)}disposeWithMe(e){return this._collection.add(e)}dispose(){this._disposed||(this._disposed=!0,this._collection.dispose())}},E1=class extends je{constructor(){super(...arguments),he(this,"dispose$",new Qt)}dispose(){super.dispose(),this.dispose$.next(),this.dispose$.complete()}};const Tr=nn("univer.context-service");let lV=class extends je{constructor(){super(...arguments),he(this,"_contextChanged$",new Qt),he(this,"contextChanged$",this._contextChanged$.asObservable()),he(this,"_contextMap",new Map)}dispose(){super.dispose(),this._contextChanged$.complete()}getContextValue(e){return this._contextMap.get(e)??!1}setContextValue(e,n){this._contextMap.set(e,n),this._contextChanged$.next()}};var bx=(t=>(t[t.SILENT=0]="SILENT",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.VERBOSE=3]="VERBOSE",t))(bx||{});const hs=nn("univer.log");let uV=class extends je{constructor(){super(...arguments),he(this,"_logLevel",0)}log(...e){if(this._logLevel<3||!e.length)return;const n=e[0];/^\[(.*?)\]/g.test(n)?console.log(`\x1B[97;104m${n}\x1B[0m:`,...e.slice(1)):console.log(...e)}warn(...e){this._logLevel>=2&&console.warn(...e)}error(...e){this._logLevel>=1&&console.error(...e)}setLogLevel(e){this._logLevel=e}};var cV=Object.defineProperty,dV=Object.getOwnPropertyDescriptor,hV=(t,e,n,r)=>{for(var i=r>1?void 0:r?dV(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&cV(e,n,i),i},_S=(t,e)=>(n,r)=>e(n,r,t),se=(t=>(t[t.COMMAND=0]="COMMAND",t[t.OPERATION=1]="OPERATION",t[t.MUTATION=2]="MUTATION",t))(se||{});const le=nn("anywhere.command-service");let fV=class{constructor(){he(this,"_commands",new Map)}registerCommand(e){if(this._commands.has(e.id))throw new Error(`Command ${e.id} has registered before!`);return this._commands.set(e.id,e),Be(()=>{var n;this._commands.delete(e.id),(n=e.onDispose)==null||n.call(e)})}getCommand(e){return this._commands.has(e)?[this._commands.get(e)]:null}},Xp=class{constructor(e,n){he(this,"_commandRegistry"),he(this,"_beforeCommandExecutionListeners",[]),he(this,"_commandExecutedListeners",[]),he(this,"_multiCommandDisposables",new Map),he(this,"_commandExecutingLevel",0),he(this,"_commandExecutionStack",[]),this._injector=e,this._log=n,this._commandRegistry=new fV}registerCommand(e){return this._registerCommand(e)}registerAsMultipleCommand(e){return this._registerMultiCommand(e)}beforeCommandExecuted(e){if(this._beforeCommandExecutionListeners.indexOf(e)===-1)return this._beforeCommandExecutionListeners.push(e),Be(()=>{const n=this._beforeCommandExecutionListeners.indexOf(e);this._beforeCommandExecutionListeners.splice(n,1)});throw new Error("Could not add a listener twice.")}onCommandExecuted(e){if(this._commandExecutedListeners.indexOf(e)===-1)return this._commandExecutedListeners.push(e),Be(()=>{const n=this._commandExecutedListeners.indexOf(e);this._commandExecutedListeners.splice(n,1)});throw new Error("Could not add a listener twice.")}async executeCommand(e,n,r){const i=this._commandRegistry.getCommand(e);if(i){const[o]=i,s={id:o.id,type:o.type,params:n},a=this._pushCommandExecutionStack(s);this._beforeCommandExecutionListeners.forEach(u=>u(s,r));const l=await this._execute(o,n);return this._commandExecutedListeners.forEach(u=>u(s,r)),a.dispose(),l}throw new Error(`[CommandService]: command "${e}" is not registered.`)}syncExecuteCommand(e,n,r){const i=this._commandRegistry.getCommand(e);if(i){const[o]=i,s={id:o.id,type:o.type,params:n};if(o.type===2){const u=nV(this._commandExecutionStack,c=>c.type===0);u&&(s.params=s.params??{},s.params.trigger=u.id)}const a=this._pushCommandExecutionStack(s);this._beforeCommandExecutionListeners.forEach(u=>u(s,r));const l=this._syncExecute(o,n);return this._commandExecutedListeners.forEach(u=>u(s,r)),a.dispose(),l}throw new Error(`[CommandService]: command "${e}" is not registered.`)}_pushCommandExecutionStack(e){return this._commandExecutionStack.push(e),Be(()=>ga(this._commandExecutionStack,e))}_registerCommand(e){return this._commandRegistry.registerCommand(e)}_registerMultiCommand(e){const n=this._commandRegistry.getCommand(e.id);let r;if(!n)r=new mV(e.id),this._multiCommandDisposables.set(e.id,this._commandRegistry.registerCommand(r));else{if(n[0].multi!==!0)throw new Error("Command has registered as a single command.");r=n[0]}const i=r.registerImplementation(e);return Be(()=>{var o;i.dispose(),r.hasImplementations()||(o=this._multiCommandDisposables.get(e.id))==null||o.dispose()})}async _execute(e,n){this._log.log("[CommandService]",`${"|-".repeat(Math.max(this._commandExecutingLevel,0))}executing command "${e.id}"`),this._commandExecutingLevel++;let r;try{r=await this._injector.invoke(e.handler,n),this._commandExecutingLevel--}catch(i){throw r=!1,this._commandExecutingLevel=0,i}return r}_syncExecute(e,n){this._log.log("[CommandService]",`${"|-".repeat(Math.max(0,this._commandExecutingLevel))}executing command "${e.id}".`),this._commandExecutingLevel++;let r;try{if(r=this._injector.invoke(e.handler,n),r instanceof Promise)throw new Error("[CommandService]: Command handler should not return a promise.");this._commandExecutingLevel--}catch(i){throw r=!1,this._commandExecutingLevel=0,i}return r}};Xp=hV([_S(0,ne(Tn)),_S(1,hs)],Xp);let mV=class{constructor(e){he(this,"name"),he(this,"multi",!0),he(this,"type",0),he(this,"priority",0),he(this,"_implementations",[]),he(this,"handler",async(n,r)=>{if(!this._implementations.length)return!1;const i=n.get(hs),o=n.get(Tr),s=n.get(Tn);for(const a of this._implementations){const l=a.command.preconditions;if(l!=null&&l(o)&&(i.log("[MultiCommand]",`executing implementation "${a.command.name}".`),await s.invoke(a.command.handler,r)))return!0}return!1}),this.id=e,this.name=e}registerImplementation(e){const n={command:e};return this._implementations.push(n),this._implementations.sort((r,i)=>i.command.priority-r.command.priority),Be(()=>{var r;const i=this._implementations.indexOf(n);this._implementations.splice(i,1),(r=e.onDispose)==null||r.call(e)})}hasImplementations(){return this._implementations.length>0}};function Xn(t,e,n){const r=t.map(i=>()=>e.syncExecuteCommand(i.id,i.params,n));return rV(r)}const d0=nn("univer.config-service");let pV=class{constructor(){he(this,"_config",new Map)}getConfig(e){return this._config.get(e)}setConfig(e,n){this._config.set(e,n)}deleteConfig(e){this._config.delete(e)}},q6=class extends je{constructor(){super(...arguments),he(this,"_error$",new Qt),he(this,"error$",this._error$.asObservable())}dispose(){this._error$.complete()}emit(e){this._error$.next({errorKey:e})}};const gV="__default_document_sub_component_id20231101__";let vV=class{constructor(){he(this,"_managerInfo",new Map),he(this,"_remove$",new Qt),he(this,"remove$",this._remove$.asObservable()),he(this,"_andOrUpdate$",new Qt),he(this,"andOrUpdate$",this._andOrUpdate$.asObservable()),he(this,"_pluginUpdate$",new Qt),he(this,"pluginUpdate$",this._pluginUpdate$.asObservable())}getFloatObject(e){return this._getFloatingObject(e)}getFloatObjects(e){return this._getFloatingObjects(e)}dispose(){this._remove$.complete(),this._andOrUpdate$.complete(),this._pluginUpdate$.complete(),this._managerInfo.clear()}clear(e){const n=this._clearByParam(e);this._remove$.next(n)}addOrUpdate(e){const n=this._addByParam(e);this._andOrUpdate$.next(n)}BatchAddOrUpdate(e){const n=[];e.forEach(r=>{n.push(...this._addByParam(r))}),this._andOrUpdate$.next(n)}remove(e){const n=this._removeByParam(e);this._remove$.next(n)}pluginUpdateRefresh(e){this._pluginUpdate$.next(e)}_getFloatingObjects(e){var n;if(e==null)return;const{unitId:r,subComponentId:i}=e;return(n=this._managerInfo.get(r))==null?void 0:n.get(i)}_getFloatingObject(e){var n,r;if(e==null)return;const{unitId:i,subComponentId:o,floatingObjectId:s}=e;return(r=(n=this._managerInfo.get(i))==null?void 0:n.get(o))==null?void 0:r.get(s)}_addByParam(e){const{unitId:n,subComponentId:r,floatingObject:i,floatingObjectId:o}=e;this._managerInfo.has(n)||this._managerInfo.set(n,new Map);const s=this._managerInfo.get(n);return s.has(r)||s.set(r,new Map),s.get(r).set(o,i),[{unitId:n,subComponentId:r,floatingObjectId:o,floatingObject:i}]}_clearByParam(e){const n=this._getFloatingObjects(e),{unitId:r,subComponentId:i}=e,o=[];return n==null||n.forEach((s,a)=>{o.push({unitId:r,subComponentId:i,floatingObjectId:a,floatingObject:s})}),n==null||n.clear(),o}_removeByParam(e){const n=this._getFloatingObjects(e),r=n==null?void 0:n.get(e.floatingObjectId);return r==null?[]:(n==null||n.delete(e.floatingObjectId),[{...e,floatingObject:r}])}};const Cx=nn("univer.floating-object.service");let Q6=class{constructor(){he(this,"cursor",0)}reset(){return this.cursor=0,this}moveCursor(e){this.cursor+=e}moveCursorTo(e){this.cursor=e}};function _V(t,e){let n=0,r=t.length-1;for(;n<=r;){const i=Math.floor((r+n)/2);if(e<t[i]&&(i===0||e>=t[i-1]))return i;if(e>=t[i])n=i+1;else if(e<t[i])r=i-1;else return-1}return-1}function bV(t,e){let n=0,r=0,i=0,o=-1,s=t.length-1;for(;n<t.length&&s>=0&&s>=n;){if(r=t[s],s===0?i=0:i=t[s-1],e>=i&&e<=r){o=s;break}if(r=t[n],n===0?i=0:i=t[n-1],e>=i&&e<r){o=n;break}n++,s--}return o}function A1(t,e){let n=t.length-1;return e<0?-1:e<t[0]?0:e>t[t.length-1]?1/0:(t.length<40||e<=t[20]||e>=t[n-20]?n=bV(t,e):n=_V(t,e),n)}var wt=(t=>(t[t.NONE=0]="NONE",t[t.THIN=1]="THIN",t[t.HAIR=2]="HAIR",t[t.DOTTED=3]="DOTTED",t[t.DASHED=4]="DASHED",t[t.DASH_DOT=5]="DASH_DOT",t[t.DASH_DOT_DOT=6]="DASH_DOT_DOT",t[t.DOUBLE=7]="DOUBLE",t[t.MEDIUM=8]="MEDIUM",t[t.MEDIUM_DASHED=9]="MEDIUM_DASHED",t[t.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",t[t.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",t[t.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",t[t.THICK=13]="THICK",t))(wt||{}),Wr=(t=>(t.TOP="top",t.BOTTOM="bottom",t.LEFT="left",t.RIGHT="right",t.NONE="none",t.ALL="all",t.OUTSIDE="outside",t.INSIDE="inside",t.HORIZONTAL="horizontal",t.VERTICAL="vertical",t.TLBR="tlbr",t.TLBC_TLMR="tlbc_tlmr",t.TLBR_TLBC_TLMR="tlbr_tlbc_tlmr",t.BLTR="bl_tr",t.MLTR_BCTR="mltr_bctr",t))(Wr||{}),Rs=(t=>(t[t.UNSUPPORTED=0]="UNSUPPORTED",t[t.RGB=1]="RGB",t[t.HEX=2]="HEX",t[t.THEME=3]="THEME",t))(Rs||{}),sr=(t=>(t[t.COLUMNS=0]="COLUMNS",t[t.ROWS=1]="ROWS",t))(sr||{}),ge=(t=>(t[t.UP=0]="UP",t[t.RIGHT=1]="RIGHT",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT",t))(ge||{});function yx(t){switch(t){case 3:return 1;case 1:return 3;case 0:return 2;case 2:return 0}}var F5=(t=>(t.EN_US="enUS",t.ZH_CN="zhCN",t))(F5||{}),Sx=(t=>(t[t.GRID=0]="GRID",t[t.KANBAN=1]="KANBAN",t[t.GANTT=2]="GANTT",t))(Sx||{}),rh=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",t[t.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",t))(rh||{}),Jr=(t=>(t[t.DASH=0]="DASH",t[t.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",t[t.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",t[t.DASHED_HEAVY=3]="DASHED_HEAVY",t[t.DASH_LONG=4]="DASH_LONG",t[t.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",t[t.DOT_DASH=6]="DOT_DASH",t[t.DOT_DOT_DASH=7]="DOT_DOT_DASH",t[t.DOTTED=8]="DOTTED",t[t.DOTTED_HEAVY=9]="DOTTED_HEAVY",t[t.DOUBLE=10]="DOUBLE",t[t.NONE=11]="NONE",t[t.SINGLE=12]="SINGLE",t[t.THICK=13]="THICK",t[t.WAVE=14]="WAVE",t[t.WAVY_DOUBLE=15]="WAVY_DOUBLE",t[t.WAVY_HEAVY=16]="WAVY_HEAVY",t[t.WORDS=17]="WORDS",t))(Jr||{}),Ln=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LEFT=1]="LEFT",t[t.CENTER=2]="CENTER",t[t.RIGHT=3]="RIGHT",t[t.JUSTIFIED=4]="JUSTIFIED",t))(Ln||{}),Kr=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.TOP=1]="TOP",t[t.MIDDLE=2]="MIDDLE",t[t.BOTTOM=3]="BOTTOM",t))(Kr||{}),yr=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.OVERFLOW=1]="OVERFLOW",t[t.CLIP=2]="CLIP",t[t.WRAP=3]="WRAP",t))(yr||{}),A2=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ITALIC=1]="ITALIC",t))(A2||{}),N2=(t=>(t[t.NORMAL=0]="NORMAL",t[t.BOLD=1]="BOLD",t))(N2||{}),Cr=(t=>(t[t.NORMAL=1]="NORMAL",t[t.SUBSCRIPT=2]="SUBSCRIPT",t[t.SUPERSCRIPT=3]="SUPERSCRIPT",t))(Cr||{}),ke=(t=>(t[t.FALSE=0]="FALSE",t[t.TRUE=1]="TRUE",t))(ke||{}),er=(t=>(t[t.STRING=1]="STRING",t[t.NUMBER=2]="NUMBER",t[t.BOOLEAN=3]="BOOLEAN",t[t.FORCE_STRING=4]="FORCE_STRING",t))(er||{}),io=(t=>(t[t.DARK1=0]="DARK1",t[t.LIGHT1=1]="LIGHT1",t[t.DARK2=2]="DARK2",t[t.LIGHT2=3]="LIGHT2",t[t.ACCENT1=4]="ACCENT1",t[t.ACCENT2=5]="ACCENT2",t[t.ACCENT3=6]="ACCENT3",t[t.ACCENT4=7]="ACCENT4",t[t.ACCENT5=8]="ACCENT5",t[t.ACCENT6=9]="ACCENT6",t[t.HYPERLINK=10]="HYPERLINK",t[t.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",t))(io||{}),nb=(t=>(t.OFFICE="Office",t.OFFICE_2007_2010="Office 2007-2010",t.GRAYSCALE="Grayscale",t.BLUE_WARM="Blue Warm",t.BLUE="Blue",t.BLUE_II="Blue II",t.BLUE_GREEN="Blue Green",t.GREEN="Green",t.GREEN_YELLOW="Green Yellow",t.YELLOW="Yellow",t.YELLOW_ORANGE="Yellow Orange",t.ORANGE="Orange",t.ORANGE_RED="Orange Red",t.RED_ORANGE="Red Orange",t.RED="Red",t.RED_VIOLET="Red Violet",t.VIOLET="Violet",t.VIOLET_II="Violet II",t.MEDIAN="Median",t.PAPER="Paper",t.MARQUEE="Marquee",t.SLIPSTREAM="Slipstream",t.Aspect="Aspect",t))(nb||{});const CV={[nb.OFFICE]:{[io.ACCENT1]:"#4472C4",[io.ACCENT2]:"#ED7D31",[io.ACCENT3]:"#A5A5A5",[io.ACCENT4]:"#70AD47",[io.ACCENT5]:"#5B9BD5",[io.ACCENT6]:"#70AD47",[io.DARK1]:"#000000",[io.DARK2]:"#44546A",[io.LIGHT1]:"#FFFFFF",[io.LIGHT2]:"#E7E6E6",[io.HYPERLINK]:"#0563C1",[io.FOLLOWED_HYPERLINK]:"#954F72"}};let rb=class{constructor(){he(this,"_themeValue",io.LIGHT1),he(this,"_themeColors"),he(this,"_themeTint"),he(this,"_rgbValue",""),he(this,"_colorType"),this._colorType=Rs.UNSUPPORTED,this._themeColors=nb.OFFICE,this._themeTint=0}asRgbColor(){return new SV(this._rgbValue,this)}asThemeColor(){return new EV(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case Rs.THEME:return this.asThemeColor();case Rs.RGB:return this.asRgbColor();case Rs.UNSUPPORTED:throw Error("unsupported color type")}}setRgbColor(e){return this._colorType=Rs.RGB,this._rgbValue=e,this}setThemeColors(e){this._colorType=Rs.THEME,this._themeColors=e}setThemeTint(e){this._colorType=Rs.THEME,this._themeTint=e}setThemeColor(e){return this._colorType=Rs.THEME,this._themeValue=e,this}getColorType(){return this._colorType}},ih=class Ex{constructor(e){he(this,"_builder"),this._builder=e}static rgbColorToHexValue(e){return`#${((1<<24)+(e.getRed()<<16)+(e.getGreen()<<8)+e.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(e){e?e.indexOf("#")>-1&&(e=e.substring(1)):e="#000000";const n=+`0x${e[0]}${e[1]}`,r=+`0x${e[2]}${e[3]}`,i=+`0x${e[4]}${e[5]}`;return new rb().setRgbColor(`rgb(${n},${r},${i})`).asRgbColor()}static hexToRgbString(e){const n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(n,(o,s,a,l)=>s+s+a+a+l+l);const r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);let i=null;if(r){const o=parseInt(r[1],16),s=parseInt(r[2],16),a=parseInt(r[3],16);i=`rgba(${o},${s},${a})`}return i}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new Ex(this._builder)}equals(e){return!1}},yV=class{constructor(e){he(this,"_saturation",0),he(this,"_hue",0),he(this,"_lightness",0),he(this,"_alpha",0);const n=e.getRed()/255,r=e.getGreen()/255,i=e.getBlue()/255,o=e.getAlpha()/255,s=Math.min(n,Math.min(r,i)),a=Math.max(n,Math.max(r,i)),l=a-s;if(a===s){this._hue=0,this._saturation=0,this._lightness=a;return}this._lightness=(s+a)/2,this._lightness<.5?this._saturation=l/(a+s):this._saturation=l/(2-a-s),n===a&&(this._hue=(r-i)/l),r===a&&(this._hue=2+(i-n)/l),i===a&&(this._hue=4+(n-r)/l),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=o}asRgbColor(){const e=new rb;if(this._saturation===0)return e.setRgbColor(`rgba(${this._lightness*255},${this._lightness*255},${this._lightness*255},${this._alpha*255})`),e.asRgbColor();let n;this._lightness<.5?n=this._lightness*(1+this._saturation):n=this._lightness+this._saturation-this._lightness*this._saturation;const r=2*this._lightness-n,i=this._hue/360,o=i+1/3,s=this.setColor(n,r,o),a=this.setColor(n,r,i),l=i-1/3,u=this.setColor(n,r,l);return e.setRgbColor(`rgba(${Math.round(s*255)},${Math.round(a*255)},${Math.round(u*255)},${this._alpha*255})`),e.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(e,n,r){r<0&&(r+=1),r>1&&(r-=1);let i;return 6*r<1?i=n+(e-n)*6*r:2*r<1?i=e:3*r<2?i=n+(e-n)*(2/3-r)*6:i=n,i}setLightness(e){this._lightness=e}};const l3=class W1 extends ih{constructor(e,n){super(n),he(this,"_cssString"),he(this,"_red"),he(this,"_green"),he(this,"_blue"),he(this,"_alpha");let r=e.match(W1.RGBA_EXTRACT);if(r){const i=+r[1],o=+r[2],s=+r[3],a=+r[4];this._cssString=e,this._red=i,this._green=o,this._blue=s,this._alpha=a;return}if(r=e.match(W1.RGB_EXTRACT),r){const i=+r[1],o=+r[2],s=+r[3];this._cssString=e,this._red=i,this._green=o,this._blue=s,this._alpha=1;return}throw new Error("Invalid rgba or rgb color")}asHexString(){return ih.rgbColorToHexValue(this)}getRed(){let e=this._red+W1.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getGreen(){let e=this._green+W1.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getBlue(){let e=this._blue+W1.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getAlpha(){return this._alpha}getColorType(){return Rs.RGB}clone(){return new W1(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(e){return e instanceof W1?e._red===this._red&&e._blue===this._blue&&e._green===this._green&&e._alpha===this._alpha:!1}getCssString(){return this._cssString}};he(l3,"RGB_COLOR_AMT",0),he(l3,"RGBA_EXTRACT",new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*")),he(l3,"RGB_EXTRACT",new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*"));let SV=l3;const wx=class Yc extends ih{constructor(e,n,r,i){super(i),he(this,"_themeColorType"),he(this,"_themeTint"),he(this,"_themeColors"),this._themeColorType=e,this._themeTint=n,this._themeColors=r}lumValue(e,n){if(e==null)return n;let r;return e<0?r=n*(1+e):r=n*(1-e)+(255-255*(1-e)),r}asRgbColor(){const e=CV[this._themeColors];if(e==null)throw new Error("not find themeColors type");const n=e[this._themeColorType];if(n==null)throw new Error("not find themeColors value");let r;if(Yc._cacheThemeColor.has(this._themeColors)){if(r=Yc._cacheThemeColor.get(this._themeColors),r.has(this._themeColorType))return r.get(this._themeColorType)}else r=new Map,Yc._cacheThemeColor.set(this._themeColors,r);const i=new yV(ih.hexValueToRgbColor(n));i.setLightness(this.lumValue(this._themeTint,i.getLightness()*255)/255);const o=i.asRgbColor();return r.set(this._themeColorType,o),o}clone(){return new Yc(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(e){return e instanceof Yc?e._themeColorType===this._themeColorType:!1}getColorType(){return Rs.THEME}getThemeColorType(){return this._themeColorType}};he(wx,"_cacheThemeColor",new Map);let EV=wx;const e2={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]};let _o=class sa{constructor(e){if(he(this,"_color"),he(this,"_rgbColor"),he(this,"_isValid",!1),e==null){this._setNullColor();return}if(e instanceof sa){this._color={...e._color},this._rgbColor={...e._rgbColor};return}const n=Rx(e);if(n==null){this._setNullColor();return}this._color=n;const r=xV(this._color);if(r==null){this._setNullColor();return}this._rgbColor=r,this._isValid=!0}static mix(e,n,r){r=Math.min(1,Math.max(0,r));const i=new sa(e).toRgb(),o=new sa(n).toRgb(),s=i.a??1,a=o.a??1,l={r:(o.r-i.r)*r+i.r,g:(o.g-i.g)*r+i.g,b:(o.b-i.b)*r+i.b,a:(a-s)*r+s};return new sa(l)}static getContrastRatio(e,n){const r=new sa(e).getLuminance(),i=new sa(n).getLuminance();return(Math.max(r,i)+.05)/(Math.min(r,i)+.05)}get isValid(){return this._isValid}toRgb(){return this._rgbColor}toRgbString(){const{r:e,g:n,b:r,a:i=1}=this.toRgb(),o=i<1;return`rgb${o?"a":""}(${e},${n},${r}${o?`,${i}`:""})`}toString(){return this.toRgbString()}toHexString(e){const{r:n,g:r,b:i,a:o=1}=this.toRgb(),s=o<1,a=[i7(Math.round(n).toString(16)),i7(Math.round(r).toString(16)),i7(Math.round(i).toString(16)),i7(Math.round(o*255).toString(16))];return e&&a[0][0]===a[0][1]&&a[1][0]===a[1][1]&&a[2][0]===a[2][1]&&a[3][0]===a[3][1]?s?`#${a[0][0]}${a[1][0]}${a[2][0]}${a[3][0]}`:`#${a[0][0]}${a[1][0]}${a[2][0]}`:s?`#${a[0]}${a[1]}${a[2]}${a[3]}`:`#${a[0]}${a[1]}${a[2]}`}toHsv(){return $V(this.toRgb())}toHsl(){return TV(this.toRgb())}lighten(e=10){const n=this.toHsl();return n.l+=e,n.l=Math.min(Math.max(n.l,0),100),new sa(n)}darken(e=10){const n=this.toHsl();return n.l-=e,n.l=Math.min(Math.max(n.l,0),100),new sa(n)}setAlpha(e){return new sa({...this._rgbColor,a:e})}getLuminance(){let{r:e,g:n,b:r}=this.toRgb();return e=Uf(e),n=Uf(n),r=Uf(r),Number((.2126*e+.7152*n+.0722*r).toFixed(3))}getBrightness(){const{r:e,g:n,b:r}=this.toRgb();return(e*299+n*587+r*114)/1e3}getAlpha(){return this._color.a??1}isDark(){return this.getBrightness()<128}isLight(){return!this.isDark()}_setNullColor(){this._isValid=!1,this._color={r:0,g:0,b:0,a:0},this._rgbColor={r:0,g:0,b:0,a:0}}};const i7=t=>t.length===1?`0${t}`:t,Uf=t=>(t/=255,t<=.03928?t/12.92:((t+.055)/1.055)**2.4),Rx=t=>{if(AV(t)){if("r"in t){const r={r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)};return t.a!==void 0&&(r.a=t.a),r}if("l"in t){const r={h:Math.round(t.h),s:t.s,l:t.l};return t.a!==void 0&&(r.a=t.a),r}const n={h:Math.round(t.h),s:t.s,v:t.v};return t.a!==void 0&&(n.a=t.a),n}const e=t.trim();if(e2[e]){const n=e2[e],r={r:Math.round(n[0]),g:Math.round(n[1]),b:Math.round(n[2])};return r.a=n[3]||1,r}if(e.startsWith("#"))return wV(e);if(e.startsWith("rgb"))return RV(e);if(e.startsWith("hsl"))return DV(e);if(e.startsWith("hsv"))return IV(e)},wV=t=>{const e=t.substring(1),n=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let r=e.match(n);if(!r||r.length<3)throw new Error(`The color '${t}' is illegal hex color`);r[0].length===1&&(r=r.map(o=>o+o));const i={r:parseInt(r[0],16),g:parseInt(r[1],16),b:parseInt(r[2],16)};return r.length>3&&(i.a=parseInt(r[3],16)/255),i},RV=t=>{const e=t.indexOf("(");if(e===-1)throw new Error(`The color '${t}' is illegal rgb color`);const n=t.substring(e+1,t.length-1).split(",");if(n.length<3)throw new Error(`The color '${t}' is illegal rgb color`);const r={r:parseInt(n[0],10),g:parseInt(n[1],10),b:parseInt(n[2],10)};return n.length>3&&(r.a=parseFloat(n[3])),r},DV=t=>{const e=t.indexOf("(");if(e===-1)throw new Error(`The color '${t}' is illegal hsl color`);const n=t.substring(e+1,t.length-1).split(",");if(n.length<3)throw new Error(`The color '${t}' is illegal hsl color`);const r={h:parseInt(n[0],10),s:parseFloat(n[1]),l:parseFloat(n[2])};return n.length>3&&(r.a=parseFloat(n[3])),r},IV=t=>{const e=t.indexOf("(");if(e===-1)throw new Error(`The color '${t}' is illegal hsv color`);const n=t.substring(e+1,t.length-1).split(",");if(n.length<3)throw new Error(`The color '${t}' is illegal hsv color`);const r={h:parseInt(n[0],10),s:parseFloat(n[1]),v:parseFloat(n[2])};return n.length>3&&(r.a=parseFloat(n[3])),r},xV=t=>{const e=Rx(t);if(e!=null)return"r"in e?e:"l"in e?MV(e):OV(e)},Hf=(t,e,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t),MV=t=>{let{h:e,s:n,l:r}=t;e/=360,n/=100,r/=100;let i=0,o=0,s=0;if(n===0)i=o=s=r;else{const l=r<.5?r*(1+n):r+n-r*n,u=2*r-l;i=Hf(u,l,e+1/3),o=Hf(u,l,e),s=Hf(u,l,e-1/3)}const a={r:Math.round(i*255),g:Math.round(o*255),b:Math.round(s*255)};return t.a!==void 0&&(a.a=t.a),a},OV=t=>{let{h:e,s:n,v:r}=t;e=e/360*6,n/=100,r/=100;const i=Math.floor(e),o=e-i,s=r*(1-n),a=r*(1-o*n),l=r*(1-(1-o)*n),u=i%6,c=[r,a,s,s,l,r][u],d=[l,r,r,a,s,s][u],h=[s,s,l,r,r,a][u],f={r:c*255,g:d*255,b:h*255};return t.a!==void 0&&(f.a=t.a),f},TV=t=>{let{r:e,g:n,b:r}=t;e/=255,n/=255,r/=255;const i=Math.max(e,n,r),o=Math.min(e,n,r),s=(i+o)/2;let a,l;if(i===o)a=l=0;else{const c=i-o;switch(l=s>.5?c/(2-i-o):c/(i+o),i){case e:a=(n-r)/c+(n<r?6:0);break;case n:a=(r-e)/c+2;break;default:a=(e-n)/c+4;break}a/=6}const u={h:Math.round(a*360),s:Math.round(l*100),l:Math.round(s*100)};return t.a!==void 0&&(u.a=t.a),u},$V=t=>{let{r:e,g:n,b:r}=t;e/=255,n/=255,r/=255;const i=Math.max(e,n,r),o=Math.min(e,n,r);let s;const a=i,l=i-o,u=i===0?0:l/i;if(i===o)s=0;else{switch(i){case e:s=(n-r)/l+(n<r?6:0);break;case n:s=(r-e)/l+2;break;default:s=(e-n)/l+4;break}s/=6}const c={h:Math.round(s*360),s:Math.round(u*100),v:Math.round(a*100)};return t.a!==void 0&&(c.a=t.a),c},kV=t=>t==null,AV=t=>!kV(t)&&typeof t=="object";var Ei=(t=>(t[t.COVER=0]="COVER",t[t.REPLACE=1]="REPLACE",t[t.INTERSECTION=2]="INTERSECTION",t))(Ei||{});let NV=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");const LV=/^-ms-/,PV=/-([a-z])/g,N1=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];let De=class ei{static stringAt(e){let n="",r=e;for(;r>=N1.length;)r/=N1.length,r-=1,n+=N1[r%N1.length];const i=e%N1.length;return n+=N1[i],n}static indexAt(e){let n=0;for(let r=0;r<e.length-1;r+=1){const i=e.charCodeAt(r)-65,o=e.length-1-r;n+=N1.length**o+N1.length*i}return n+=e.charCodeAt(e.length-1)-65,n}static deleteBlank(e){return ei.isString(e)?e.replace(/\s/g,""):e}static getSystemType(){const e=navigator.userAgent,n=navigator.platform==="Win32"||navigator.platform==="Windows",r=navigator.platform==="Mac68K"||navigator.platform==="MacPPC"||navigator.platform==="Macintosh"||navigator.platform==="MacIntel";if(r)return"Mac";if(navigator.platform==="X11"&&!n&&!r)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(n){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Windows 2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"Windows XP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Windows 2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"Windows Vista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Windows 7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Windows 10";if(e.indexOf("Windows NT 11")>-1||e.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const e=navigator.userAgent,n=e.indexOf("Opera")>-1,r=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,i=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,o=e.indexOf("Edge")>-1,s=e.indexOf("Firefox")>-1,a=e.indexOf("Safari")>-1&&e.indexOf("Chrome")===-1,l=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(r){new RegExp("MSIE (\\d+\\.\\d+);").test(e);const u=parseFloat(RegExp.$1);return u===7?"IE7":u===8?"IE8":u===9?"IE9":u===10?"IE10":"0"}return s?"FF":n?"Opera":a?"Safari":l?"Chrome":o?"Edge":i?"IE11":"Unknown browser"}static generateRandomId(e=21){return NV(e)}static getClassName(e){return e.constructor.name}static deepMerge(e,...n){n.forEach(s=>s&&o(s));function r(s,a){s.forEach((l,u)=>{if(ei.isArray(l)){const c=a[u]??[];a[u]=c,r(l,c);return}if(ei.isObject(l)){const c=a[u]??{};a[u]=c,i(l,c);return}a[u]=l})}function i(s,a){Object.keys(s).forEach(l=>{const u=s[l];if(ei.isObject(u)){const c=a[l]??{};a[l]=c,i(u,c);return}if(ei.isArray(u)){const c=a[l]??[];a[l]=c,r(u,c);return}a[l]=u})}function o(s){Object.keys(s).forEach(a=>{const l=s[a];if(ei.isArray(l)){const u=e[a]??[];e[a]=u,r(l,u);return}if(ei.isObject(l)){const u=e[a]??{};e[a]=u,i(l,u);return}e[a]=l})}return e}static numberFixed(e,n){return Number(Number(e).toFixed(n))}static diffValue(e,n){function r(s,a){const l=ei.getValueType(s),u=ei.getValueType(a);return l!==u?!1:ei.isArray(s)?i(s,a):ei.isObject(s)?o(s,a):ei.isDate(s)?s.getTime()===a.getTime():ei.isRegExp(s)?s.toString()===a.toString():s===a}function i(s,a){if(e.length!==n.length)return!1;for(let l=0,u=s.length;l<u;l++){const c=s[l],d=a[l];if(!r(c,d))return!1}return!0}function o(s,a){const l=Object.keys(s),u=Object.keys(a);if(l.length!==u.length)return!1;for(const c of l){if(!u.includes(c))return!1;const d=s[c],h=a[c];if(!r(d,h))return!1}return!0}return r(e,n)}static deepClone(e){if(!this.isDefine(e))return e;if(this.isRegExp(e))return new RegExp(e);if(this.isDate(e))return new Date(e);if(this.isArray(e)){const n=[];return e.forEach((r,i)=>{n[i]=ei.deepClone(r)}),n}if(this.isObject(e)){const n={};return Object.keys(e).forEach(r=>{const i=e[r];n[r]=ei.deepClone(i)}),Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}return e}static getLanguage(){const e="en-US";return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||e}static getValueType(e){return Object.prototype.toString.apply(e)}static isDefine(e){return e!=null}static isBlank(e){return this.isDefine(e)?this.isString(e)?e.trim()==="":!1:!0}static isAssignableFrom(e,n){return e instanceof n}static isBoolean(e){return this.getValueType(e)==="[object Boolean]"}static isPlainObject(e){return this.isDefine(e)?Object.getPrototypeOf(e)===Object.getPrototypeOf({}):!1}static isFunction(e){return this.getValueType(e)==="[object Function]"}static isDate(e){return this.getValueType(e)==="[object Date]"}static isRegExp(e){return this.getValueType(e)==="[object RegExp]"}static isArray(e){return this.getValueType(e)==="[object Array]"}static isString(e){return this.getValueType(e)==="[object String]"}static isNumber(e){return this.getValueType(e)==="[object Number]"}static isStringNumber(e){return!isNaN(parseFloat(e))&&isFinite(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isEmptyObject(e){for(const n in e)return!1;return!0}static isMobile(){let e=0,n=0;return document.body.clientWidth&&(e=document.body.clientWidth),document.body.clientHeight&&(n=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||e<350&&n<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){const e=navigator.userAgent.toLowerCase();return String(e.match(/MicroMessenger/i))==="micromessenger"}static isAndroid(){const e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static itCount(e){return n=>{for(let r=0;r<e;r++)n&&n()}}static hasLength(e,n){return ei.isDefine(e)?ei.isDefine(n)?e.length===n:e.length>0:!1}static capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}static fCamelCase(e,n){return n.toUpperCase()}static camelCase(e){return e.replace(LV,"ms-").replace(PV,this.fCamelCase)}static removeNull(e){return this.isObject(e)&&Object.keys(e).forEach(n=>{const r=e[n];r==null?delete e[n]:ei.removeNull(r)}),e}static fillTwoDimensionalArray(e,n,r){return new Array(e).fill(r).map(i=>new Array(n).fill(r))}static numToWord(e){let n="";for(;e>0;){let r=e%26;r=r===0?r=26:r,n=String.fromCharCode(96+r)+n,e=(e-r)/26}return n.toLocaleUpperCase()}static ABCatNum(e){if(e==null||e.length===0)return NaN;const n=e.toLowerCase().split(""),r=n.length;let i=0,o=0;for(let s=0;s<r;s++)o=n[s].charCodeAt(0)-96,i+=o*26**(r-s-1);return i===0?NaN:i-1}static chatAtABC(e){let n="";for(;e>=0;)n=String.fromCharCode(e%26+97)+n,e=Math.floor(e/26)-1;return n.toUpperCase()}static randSort(e){for(let n=0,r=e.length;n<r;n++){const i=parseInt((Math.random()*r).toString()),o=e[i];e[i]=e[n],e[n]=o}return e}static commonExtend(e,n){const r={};for(const i in e)r[i]=e[i];for(const i in n)n[i]!=null&&(r[i]=n[i]);return r}static commonExtend1(e,n){for(const r in e)n[r]==null&&(n[r]=e[r]);return n}static arrayToObject(e){const n={};return e.forEach((r,i)=>{n[i]={},r.forEach((o,s)=>{n[i][s]=o})}),n}static hasIntersectionBetweenTwoRanges(e,n,r,i){return n>=r&&i>=e}};function ib(t){if(!t)return;const{actualRow:e,actualColumn:n,isMerged:r,isMergedMainCell:i,mergeInfo:o}=t;let{startY:s,endY:a,startX:l,endX:u}=t,c=e,d=n,h=e,f=n;if(r&&o){const{startRow:m,startColumn:p,endRow:g,endColumn:v,startY:_,endY:C,startX:y,endX:S}=o;c=m,d=p,h=g,f=v,s=_,a=C,l=y,u=S}return i&&(s=o.startY,a=o.endY,l=o.startX,u=o.endX,h=o.endRow,f=o.endColumn),{startRow:c,startColumn:d,endRow:h,endColumn:f,startY:s,endY:a,startX:l,endX:u}}function BV(t){if(!t)return;const{actualRow:e,actualColumn:n,isMerged:r,isMergedMainCell:i,startRow:o,startColumn:s,endRow:a,endColumn:l}=t;let u=e,c=n,d=e,h=n;return(r||i)&&(u=o,c=s,d=a,h=l),{startRow:u,startColumn:c,endRow:d,endColumn:h}}function bS(t){var e;return!t||(((e=t==null?void 0:t.v)==null?void 0:e.toString())||"").length===0&&!t.p}function oo(t){if(t){if(t.rgb)return t.rgb;if(t.th)return new rb().setThemeColor(t.th).asThemeColor().asRgbColor().getCssString()}return null}function Ao(t){return De.isString(t)&&t.substring(0,1)==="="&&t.length>1}function q1(t){return De.isString(t)&&t.indexOf("=")===-1&&t.length===6}function FV(t,e=!1){var n;let r="";const i=new Map([["ff",()=>{t.ff&&(r+=`font-family: ${t.ff}; `)}],["fs",()=>{if(t.fs){let s=t.fs;t.va&&(s/=2),r+=`font-size: ${s}pt; `}}],["it",()=>{t.it&&(r+="font-style: italic; ")}],["bl",()=>{t.bl&&(r+="font-weight: bold; ")}],["ul",()=>{var s;(s=t.ul)!=null&&s.s&&(r.indexOf("text-decoration-line")>-1?r=r.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," underline"):r+="text-decoration-line: underline; ",t.ul.cl&&r.indexOf("text-decoration-color")===-1&&(r+=`text-decoration-color: ${oo(t.ul.cl)}; `),t.ul.t&&r.indexOf("text-decoration-style")===-1&&(r+=`text-decoration-style: ${t.ul.t} `))}],["st",()=>{var s;(s=t.st)!=null&&s.s&&(r.indexOf("text-decoration-line")>-1?r=r.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," line-through"):r+="text-decoration-line: line-through; ",t.st.cl&&r.indexOf("text-decoration-color")===-1&&(r+=`text-decoration-color: ${oo(t.st.cl)}; `),t.st.t&&r.indexOf("text-decoration-style")===-1&&(r+=`text-decoration-style: ${t.st.t} `))}],["ol",()=>{var s;(s=t.ol)!=null&&s.s&&(r.indexOf("text-decoration-line")>-1?r=r.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," overline"):r+="text-decoration-line: overline; ",t.ol.cl&&r.indexOf("text-decoration-color")===-1&&(r+=`text-decoration-color: ${oo(t.ol.cl)}; `),t.ol.t&&r.indexOf("text-decoration-style")===-1&&(r+=`text-decoration-style: ${t.ol.t} `))}],["bg",()=>{t.bg&&(r+=`background: ${oo(t.bg)}; `)}],["bd",()=>{var s,a,l,u,c,d,h,f;(s=t.bd)!=null&&s.b&&(r+=`border-bottom: ${o7((a=t.bd)==null?void 0:a.b.s)} ${oo(t.bd.b.cl)??""}; `),(l=t.bd)!=null&&l.t&&(r+=`border-top: ${o7((u=t.bd)==null?void 0:u.t.s)} ${oo(t.bd.t.cl)??""}; `),(c=t.bd)!=null&&c.r&&(r+=`border-right: ${o7((d=t.bd)==null?void 0:d.r.s)} ${oo(t.bd.r.cl)??""}; `),(h=t.bd)!=null&&h.l&&(r+=`border-left: ${o7((f=t.bd)==null?void 0:f.l.s)} ${oo(t.bd.l.cl)??""}; `)}],["cl",()=>{t.cl&&(r+=`color: ${oo(t.cl)}; `)}],["va",()=>{t.va===Cr.SUBSCRIPT?r+="vertical-align: sub; ":t.va===Cr.SUPERSCRIPT&&(r+="vertical-align: super; ")}],["td",()=>{t.td===rh.LEFT_TO_RIGHT?r+="direction: ltr; ":t.td===rh.RIGHT_TO_LEFT&&(r+="direction: rtl; ")}],["tr",()=>{var s,a,l;t.tr&&(r+=`data-rotate: (${(s=t.tr)==null?void 0:s.a}deg${(a=t.tr)!=null&&a.v?` ,${(l=t.tr)==null?void 0:l.v}`:""});`)}],["ht",()=>{t.ht===Ln.LEFT?r+="text-align: left; ":t.ht===Ln.RIGHT?r+="text-align: right; ":t.ht===Ln.CENTER?r+="text-align: center; ":t.ht===Ln.JUSTIFIED&&(r+="text-align: justify; ")}],["vt",()=>{t.vt===Kr.BOTTOM?r+="vertical-align: bottom; ":t.vt===Kr.TOP?r+="vertical-align: top; ":t.vt===Kr.MIDDLE&&(r+="vertical-align: middle; ")}],["tb",()=>{t.tb===yr.CLIP?r+="text-overflow: clip; ":t.tb===yr.OVERFLOW?r+="text-break: overflow; ":t.tb===yr.WRAP&&(r+="word-wrap: break-word;")}],["pd",()=>{var s,a,l,u,c,d,h,f;const m=`${(s=t.pd)==null?void 0:s.b}pt`,p=`${(a=t.pd)==null?void 0:a.t}pt`,g=`${(l=t.pd)==null?void 0:l.l}pt`,v=`${(u=t.pd)==null?void 0:u.r}pt`;(c=t.pd)!=null&&c.b&&(r+=`padding-bottom: ${m}; `),(d=t.pd)!=null&&d.t&&(r+=`padding-top: ${p}; `),(h=t.pd)!=null&&h.l&&(r+=`padding-left: ${g}; `),(f=t.pd)!=null&&f.r&&(r+=`padding-right: ${v}; `)}]]),o=["bd","tr","tb"];for(const s in t)e&&o.includes(s)||(n=i.get(s))==null||n();return r}function o7(t){let e="";return t===wt.NONE?e="none":t===wt.THIN?e="0.5pt solid":t===wt.HAIR?e="0.5pt double":t===wt.DOTTED?e="0.5pt dotted":t===wt.DASHED||t===wt.DASH_DOT?e="0.5pt dashed":t===wt.DASH_DOT_DOT?e="0.5pt dotted":t===wt.DOUBLE?e="0.5pt double":t===wt.MEDIUM?e="1pt solid":t===wt.MEDIUM_DASHED||t===wt.MEDIUM_DASH_DOT?e="1pt dashed":t===wt.MEDIUM_DASH_DOT_DOT?e="1pt dotted":t===wt.SLANT_DASH_DOT?e="0.5pt dashed":t===wt.THICK&&(e="1.5pt solid"),e}function za(t){let e=0;if(t=t.trim(),t==="none")e=wt.NONE;else if(t==="0.5pt solid")e=wt.THIN;else if(t==="0.5pt double")e=wt.HAIR;else if(t==="0.5pt dotted")e=wt.DOTTED;else if(t==="0.5pt dashed")e=wt.DASHED;else if(t==="1pt solid")e=wt.MEDIUM;else if(t==="1pt dashed")e=wt.MEDIUM_DASHED;else if(t==="1pt dotted")e=wt.MEDIUM_DASH_DOT_DOT;else if(t==="1.5pt solid")e=wt.THICK;else return wt.NONE;return e}function u3(t,e){let n=t.body;if(e){const{headers:r,footers:i}=t;r!=null&&r[e]?n=r[e].body:i!=null&&i[e]&&(n=i[e].body)}return n}function UV(t){const{startRow:e,endRow:n,startColumn:r,endColumn:i}=t;return!(e<0||r<0||n<0||i<0)}function Dx(t,e){return Object.prototype.toString.call(t)===Object.prototype.toString.call(e)?Object.prototype.toString.call(t)==="[object Object]"||Object.prototype.toString.call(t)==="[object Array]"?Object.keys(t).length!==Object.keys(e).length?!1:Object.keys(t).every(n=>Dx(t[n],e[n])):t===e:!1}function HV(t,e){const n=t.ts||{},r=e.ts||{};return t.sId!==e.sId?!1:Dx(n,r)}function ob(t,e,n,r){if(t>e&&([t,e]=[e,t]),n>r&&([n,r]=[r,n]),e<n||r<t)return[t,e];n<t&&(n=t),r>e&&(r=e);const i=r-n+1;let o=[];return t===n?o=[r+1-i,e-i]:e===r?o=[t,n-1]:o=[t,e-i],o}function VV(t){return!(t==null||(t.indentStart==null||t.indentStart===0)&&t.hanging==null||t.hanging===0)}function Ix(t,e,n){return t.slice(0,e)+n+t.slice(e)}function xx(t,e,n){return e>n?t:t.slice(0,e)+t.slice(n)}var jV=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},zV={exports:{}};/*! @preserve
 * numeral.js
 * version : 2.0.6
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */(function(t){(function(e,n){t.exports?t.exports=n():e.numeral=n()})(jV,function(){var e,n,r="2.0.6",i={},o={},s={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},a={currentLocale:s.currentLocale,zeroFormat:s.zeroFormat,nullFormat:s.nullFormat,defaultFormat:s.defaultFormat,scalePercentBy100:s.scalePercentBy100};function l(u,c){this._input=u,this._value=c}return e=function(u){var c,d,h,f;if(e.isNumeral(u))c=u.value();else if(u===0||typeof u>"u")c=0;else if(u===null||n.isNaN(u))c=null;else if(typeof u=="string")if(a.zeroFormat&&u===a.zeroFormat)c=0;else if(a.nullFormat&&u===a.nullFormat||!u.replace(/[^0-9]+/g,"").length)c=null;else{for(d in i)if(f=typeof i[d].regexps.unformat=="function"?i[d].regexps.unformat():i[d].regexps.unformat,f&&u.match(f)){h=i[d].unformat;break}h=h||e._.stringToNumber,c=h(u)}else c=Number(u)||null;return new l(u,c)},e.version=r,e.isNumeral=function(u){return u instanceof l},e._=n={numberToFormat:function(u,c,d){var h=o[e.options.currentLocale],f=!1,m=!1,p=0,g="",v=1e12,_=1e9,C=1e6,y=1e3,S="",E=!1,w,R,D,I,k,O,$;if(u=u||0,R=Math.abs(u),e._.includes(c,"(")?(f=!0,c=c.replace(/[\(|\)]/g,"")):(e._.includes(c,"+")||e._.includes(c,"-"))&&(k=e._.includes(c,"+")?c.indexOf("+"):u<0?c.indexOf("-"):-1,c=c.replace(/[\+|\-]/g,"")),e._.includes(c,"a")&&(w=c.match(/a(k|m|b|t)?/),w=w?w[1]:!1,e._.includes(c," a")&&(g=" "),c=c.replace(new RegExp(g+"a[kmbt]?"),""),R>=v&&!w||w==="t"?(g+=h.abbreviations.trillion,u=u/v):R<v&&R>=_&&!w||w==="b"?(g+=h.abbreviations.billion,u=u/_):R<_&&R>=C&&!w||w==="m"?(g+=h.abbreviations.million,u=u/C):(R<C&&R>=y&&!w||w==="k")&&(g+=h.abbreviations.thousand,u=u/y)),e._.includes(c,"[.]")&&(m=!0,c=c.replace("[.]",".")),D=u.toString().split(".")[0],I=c.split(".")[1],O=c.indexOf(","),p=(c.split(".")[0].split(",")[0].match(/0/g)||[]).length,I?(e._.includes(I,"[")?(I=I.replace("]",""),I=I.split("["),S=e._.toFixed(u,I[0].length+I[1].length,d,I[1].length)):S=e._.toFixed(u,I.length,d),D=S.split(".")[0],e._.includes(S,".")?S=h.delimiters.decimal+S.split(".")[1]:S="",m&&Number(S.slice(1))===0&&(S="")):D=e._.toFixed(u,0,d),g&&!w&&Number(D)>=1e3&&g!==h.abbreviations.trillion)switch(D=String(Number(D)/1e3),g){case h.abbreviations.thousand:g=h.abbreviations.million;break;case h.abbreviations.million:g=h.abbreviations.billion;break;case h.abbreviations.billion:g=h.abbreviations.trillion;break}if(e._.includes(D,"-")&&(D=D.slice(1),E=!0),D.length<p)for(var N=p-D.length;N>0;N--)D="0"+D;return O>-1&&(D=D.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+h.delimiters.thousands)),c.indexOf(".")===0&&(D=""),$=D+S+(g||""),f?$=(f&&E?"(":"")+$+(f&&E?")":""):k>=0?$=k===0?(E?"-":"+")+$:$+(E?"-":"+"):E&&($="-"+$),$},stringToNumber:function(u){var c=o[a.currentLocale],d=u,h={thousand:3,million:6,billion:9,trillion:12},f,m,p;if(a.zeroFormat&&u===a.zeroFormat)m=0;else if(a.nullFormat&&u===a.nullFormat||!u.replace(/[^0-9]+/g,"").length)m=null;else{m=1,c.delimiters.decimal!=="."&&(u=u.replace(/\./g,"").replace(c.delimiters.decimal,"."));for(f in h)if(p=new RegExp("[^a-zA-Z]"+c.abbreviations[f]+"(?:\\)|(\\"+c.currency.symbol+")?(?:\\))?)?$"),d.match(p)){m*=Math.pow(10,h[f]);break}m*=(u.split("-").length+Math.min(u.split("(").length-1,u.split(")").length-1))%2?1:-1,u=u.replace(/[^0-9\.]+/g,""),m*=Number(u)}return m},isNaN:function(u){return typeof u=="number"&&isNaN(u)},includes:function(u,c){return u.indexOf(c)!==-1},insert:function(u,c,d){return u.slice(0,d)+c+u.slice(d)},reduce:function(u,c){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof c!="function")throw new TypeError(c+" is not a function");var d=Object(u),h=d.length>>>0,f=0,m;if(arguments.length===3)m=arguments[2];else{for(;f<h&&!(f in d);)f++;if(f>=h)throw new TypeError("Reduce of empty array with no initial value");m=d[f++]}for(;f<h;f++)f in d&&(m=c(m,d[f],f,d));return m},multiplier:function(u){var c=u.toString().split(".");return c.length<2?1:Math.pow(10,c[1].length)},correctionFactor:function(){var u=Array.prototype.slice.call(arguments);return u.reduce(function(c,d){var h=n.multiplier(d);return c>h?c:h},1)},toFixed:function(u,c,d,h){var f=u.toString().split("."),m=c-(h||0),p,g,v,_;return f.length===2?p=Math.min(Math.max(f[1].length,m),c):p=m,v=Math.pow(10,p),_=(d(u+"e+"+p)/v).toFixed(p),h>c-p&&(g=new RegExp("\\.?0{1,"+(h-(c-p))+"}$"),_=_.replace(g,"")),_}},e.options=a,e.formats=i,e.locales=o,e.locale=function(u){return u&&(a.currentLocale=u.toLowerCase()),a.currentLocale},e.localeData=function(u){if(!u)return o[a.currentLocale];if(u=u.toLowerCase(),!o[u])throw new Error("Unknown locale : "+u);return o[u]},e.reset=function(){for(var u in s)a[u]=s[u]},e.zeroFormat=function(u){a.zeroFormat=typeof u=="string"?u:null},e.nullFormat=function(u){a.nullFormat=typeof u=="string"?u:null},e.defaultFormat=function(u){a.defaultFormat=typeof u=="string"?u:"0.0"},e.register=function(u,c,d){if(c=c.toLowerCase(),this[u+"s"][c])throw new TypeError(c+" "+u+" already registered.");return this[u+"s"][c]=d,d},e.validate=function(u,c){var d,h,f,m,p,g,v,_;if(typeof u!="string"&&(u+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",u)),u=u.trim(),u.match(/^\d+$/))return!0;if(u==="")return!1;try{v=e.localeData(c)}catch{v=e.localeData(e.locale())}return f=v.currency.symbol,p=v.abbreviations,d=v.delimiters.decimal,v.delimiters.thousands==="."?h="\\.":h=v.delimiters.thousands,_=u.match(/^[^\d]+/),_!==null&&(u=u.substr(1),_[0]!==f)||(_=u.match(/[^\d]+$/),_!==null&&(u=u.slice(0,-1),_[0]!==p.thousand&&_[0]!==p.million&&_[0]!==p.billion&&_[0]!==p.trillion))?!1:(g=new RegExp(h+"{2}"),u.match(/[^\d.,]/g)?!1:(m=u.split(d),m.length>2?!1:m.length<2?!!m[0].match(/^\d+.*\d$/)&&!m[0].match(g):m[0].length===1?!!m[0].match(/^\d+$/)&&!m[0].match(g)&&!!m[1].match(/^\d+$/):!!m[0].match(/^\d+.*\d$/)&&!m[0].match(g)&&!!m[1].match(/^\d+$/)))},e.fn=l.prototype={clone:function(){return e(this)},format:function(u,c){var d=this._value,h=u||a.defaultFormat,f,m,p;if(c=c||Math.round,d===0&&a.zeroFormat!==null)m=a.zeroFormat;else if(d===null&&a.nullFormat!==null)m=a.nullFormat;else{for(f in i)if(h.match(i[f].regexps.format)){p=i[f].format;break}p=p||e._.numberToFormat,m=p(d,h,c)}return m},value:function(){return this._value},input:function(){return this._input},set:function(u){return this._value=Number(u),this},add:function(u){var c=n.correctionFactor.call(null,this._value,u);function d(h,f,m,p){return h+Math.round(c*f)}return this._value=n.reduce([this._value,u],d,0)/c,this},subtract:function(u){var c=n.correctionFactor.call(null,this._value,u);function d(h,f,m,p){return h-Math.round(c*f)}return this._value=n.reduce([u],d,Math.round(this._value*c))/c,this},multiply:function(u){function c(d,h,f,m){var p=n.correctionFactor(d,h);return Math.round(d*p)*Math.round(h*p)/Math.round(p*p)}return this._value=n.reduce([this._value,u],c,1),this},divide:function(u){function c(d,h,f,m){var p=n.correctionFactor(d,h);return Math.round(d*p)/Math.round(h*p)}return this._value=n.reduce([this._value,u],c),this},difference:function(u){return Math.abs(e(this._value).subtract(u).value())}},e.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(u){var c=u%10;return~~(u%100/10)===1?"th":c===1?"st":c===2?"nd":c===3?"rd":"th"},currency:{symbol:"$"}}),function(){e.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(u,c,d){var h=e._.includes(c," BPS")?" ":"",f;return u=u*1e4,c=c.replace(/\s?BPS/,""),f=e._.numberToFormat(u,c,d),e._.includes(f,")")?(f=f.split(""),f.splice(-1,0,h+"BPS"),f=f.join("")):f=f+h+"BPS",f},unformat:function(u){return+(e._.stringToNumber(u)*1e-4).toFixed(15)}})}(),function(){var u={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},c={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},d=u.suffixes.concat(c.suffixes.filter(function(f){return u.suffixes.indexOf(f)<0})),h=d.join("|");h="("+h.replace("B","B(?!PS)")+")",e.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(h)},format:function(f,m,p){var g,v=e._.includes(m,"ib")?c:u,_=e._.includes(m," b")||e._.includes(m," ib")?" ":"",C,y,S;for(m=m.replace(/\s?i?b/,""),C=0;C<=v.suffixes.length;C++)if(y=Math.pow(v.base,C),S=Math.pow(v.base,C+1),f===null||f===0||f>=y&&f<S){_+=v.suffixes[C],y>0&&(f=f/y);break}return g=e._.numberToFormat(f,m,p),g+_},unformat:function(f){var m=e._.stringToNumber(f),p,g;if(m){for(p=u.suffixes.length-1;p>=0;p--){if(e._.includes(f,u.suffixes[p])){g=Math.pow(u.base,p);break}if(e._.includes(f,c.suffixes[p])){g=Math.pow(c.base,p);break}}m*=g||1}return m}})}(),function(){e.register("format","currency",{regexps:{format:/(\$)/},format:function(u,c,d){var h=e.locales[e.options.currentLocale],f={before:c.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:c.match(/([\+|\-|\)|\s|\$]*)$/)[0]},m,p,g;for(c=c.replace(/\s?\$\s?/,""),m=e._.numberToFormat(u,c,d),u>=0?(f.before=f.before.replace(/[\-\(]/,""),f.after=f.after.replace(/[\-\)]/,"")):u<0&&!e._.includes(f.before,"-")&&!e._.includes(f.before,"(")&&(f.before="-"+f.before),g=0;g<f.before.length;g++)switch(p=f.before[g],p){case"$":m=e._.insert(m,h.currency.symbol,g);break;case" ":m=e._.insert(m," ",g+h.currency.symbol.length-1);break}for(g=f.after.length-1;g>=0;g--)switch(p=f.after[g],p){case"$":m=g===f.after.length-1?m+h.currency.symbol:e._.insert(m,h.currency.symbol,-(f.after.length-(1+g)));break;case" ":m=g===f.after.length-1?m+" ":e._.insert(m," ",-(f.after.length-(1+g)+h.currency.symbol.length-1));break}return m}})}(),function(){e.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(u,c,d){var h,f=typeof u=="number"&&!e._.isNaN(u)?u.toExponential():"0e+0",m=f.split("e");return c=c.replace(/e[\+|\-]{1}0/,""),h=e._.numberToFormat(Number(m[0]),c,d),h+"e"+m[1]},unformat:function(u){var c=e._.includes(u,"e+")?u.split("e+"):u.split("e-"),d=Number(c[0]),h=Number(c[1]);h=e._.includes(u,"e-")?h*=-1:h;function f(m,p,g,v){var _=e._.correctionFactor(m,p),C=m*_*(p*_)/(_*_);return C}return e._.reduce([d,Math.pow(10,h)],f,1)}})}(),function(){e.register("format","ordinal",{regexps:{format:/(o)/},format:function(u,c,d){var h=e.locales[e.options.currentLocale],f,m=e._.includes(c," o")?" ":"";return c=c.replace(/\s?o/,""),m+=h.ordinal(u),f=e._.numberToFormat(u,c,d),f+m}})}(),function(){e.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(u,c,d){var h=e._.includes(c," %")?" ":"",f;return e.options.scalePercentBy100&&(u=u*100),c=c.replace(/\s?\%/,""),f=e._.numberToFormat(u,c,d),e._.includes(f,")")?(f=f.split(""),f.splice(-1,0,h+"%"),f=f.join("")):f=f+h+"%",f},unformat:function(u){var c=e._.stringToNumber(u);return e.options.scalePercentBy100?c*.01:c}})}(),function(){e.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(u,c,d){var h=Math.floor(u/60/60),f=Math.floor((u-h*60*60)/60),m=Math.round(u-h*60*60-f*60);return h+":"+(f<10?"0"+f:f)+":"+(m<10?"0"+m:m)},unformat:function(u){var c=u.split(":"),d=0;return c.length===3?(d=d+Number(c[0])*60*60,d=d+Number(c[1])*60,d=d+Number(c[2])):c.length===2&&(d=d+Number(c[0])*60,d=d+Number(c[1])),Number(d)}})}(),e})})(zV);function Mx(t){return t===null||t.toString().replace(/\s/g,"")===""||typeof t=="boolean"?!1:!isNaN(t)}let Yp=new Date("2017-02-19T19:06:09.000Z");Number.isNaN(Yp.getFullYear())&&(Yp=new Date("2/19/17"));Yp.getFullYear();function WV(t){let e=0;for(let n=0;n<t.length;n++)e=t.charCodeAt(n)+(e<<6)+(e<<16)-e;return e>>>0}let s7=class{static hasLength(e,n){return e.length===n}static getValueType(e){return Object.prototype.toString.apply(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isIterable(e){return e[Symbol.iterator]!=null}static isNumber(e){return this.getValueType(e)==="[object Number]"}};const ur=Symbol("newer"),ti=Symbol("older");let XV=class{constructor(e){he(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[ur],{done:!1,value:e.key}):{done:!0,value:void 0}}},YV=class{constructor(e){he(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[ur],{done:!1,value:e.value}):{done:!0,value:void 0}}},GV=class{constructor(e){he(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[ur],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}}};var Ox,Tx;let CS=class{constructor(e,n){he(this,"key"),he(this,"value"),he(this,Ox),he(this,Tx),this.key=e,this.value=n,this[ur]=void 0,this[ti]=void 0}toJSON(){return{key:this.key,value:this.value}}};Ox=ur,Tx=ti;let U5=class{constructor(...e){if(he(this,"_keymap"),he(this,"size",0),he(this,"limit"),he(this,"oldest"),he(this,"newest"),he(this,"_onShiftListeners",[]),s7.hasLength(e,1)){if(s7.isNumber(e[0])){const n=e[0];this._initialize(n,void 0);return}if(s7.isIterable(e[0])){const n=e[0];this._initialize(0,n);return}return}if(s7.hasLength(e,2)){const n=e[0],r=e[1];this._initialize(n,r)}}onShift(e){if(this._onShiftListeners.indexOf(e)===-1)return this._onShiftListeners.push(e),Be(()=>ga(this._onShiftListeners,e));throw new Error("[LRUMap]: the listener has been registered!")}_initialize(e,n){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=e,this._keymap=new Map,n&&(this.assign(n),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[ur]&&(e===this.oldest&&(this.oldest=e[ur]),e[ur][ti]=e[ti]),e[ti]&&(e[ti][ur]=e[ur]),e[ur]=void 0,e[ti]=this.newest,this.newest&&(this.newest[ur]=e),this.newest=e)}assign(e){let n,r=this.limit||Number.MAX_VALUE;this._keymap.clear();const i=e[Symbol.iterator]();for(let o=i.next();!o.done;o=i.next()){const s=new CS(o.value[0],o.value[1]);if(this._keymap.set(s.key,s),n?(n[ur]=s,s[ti]=n):this.oldest=s,n=s,r--===0)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size}set(e,n){let r=this._keymap.get(e);return r?(r.value=n,this._markEntryAsUsed(r),this):(this._keymap.set(e,r=new CS(e,n)),this.newest?(this.newest[ur]=r,r[ti]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift(),this)}shift(){const e=this.oldest;if(e)return this.oldest&&this.oldest[ur]?(this.oldest=this.oldest[ur],this.oldest[ti]=void 0):(this.oldest=void 0,this.newest=void 0),e[ur]=e[ti]=void 0,this._keymap.delete(e.key),--this.size,this._onShiftListeners.forEach(n=>n(e)),[e.key,e.value]}get(e){const n=this._keymap.get(e);if(n)return this._markEntryAsUsed(n),n.value}has(e){return this._keymap.has(e)}find(e){const n=this._keymap.get(e);return n?n.value:void 0}delete(e){const n=this._keymap.get(e);if(n)return this._keymap.delete(n.key),n[ur]&&n[ti]?(n[ti][ur]=n[ur],n[ur][ti]=n[ti]):n[ur]?(n[ur][ti]=void 0,this.oldest=n[ur]):n[ti]?(n[ti][ur]=void 0,this.newest=n[ti]):this.oldest=this.newest=void 0,this.size--,n.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new XV(this.oldest)}values(){return new YV(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new GV(this.oldest)}forEach(e,n){typeof n!="object"&&(n=this);let r=this.oldest;for(;r;)e.call(n,r.value,r.key,this),r=r[ur]}toJSON(){const e=new Array(this.size);let n=0,r=this.oldest;for(;r;)e[n++]={key:r.key,value:r.value},r=r[ur];return e}toString(){let e="",n=this.oldest;for(;n;)e+=`${String(n.key)}:${n.value}`,n=n[ur],n&&(e+=" < ");return e}};function ba(t){let e=0;const n=Object.keys(t);for(const r of n){const i=Number(r);e=Math.max(e,i)}return e+1}function oh(t,e,n){const r=ba(n),i=n;for(let o=r-1;o>=t;o--)i[o+1]=i[o];i[t]=e}function $x(t,e,n){const r=t+e,i=ba(n),o=n;let s=0;const a={};for(let c=t;c<r;c++){const d=o[c];d!==void 0&&(delete o[c],a[s]=d,s++)}const l=r-t,u=i;for(let c=r;c<u;c++)o[c]!==void 0&&(o[c-l]=o[c],delete o[c])}function kx(t,e){const n=t,r=Object.keys(n),i=r.length,o=e,s=Object.keys(o),a=s.length,l={};let u=0;for(let c=0;c<i;c++,u++){const d=r[c];l[u]=n[d]}for(let c=0;c<a;c++,u++){const d=s[c];l[u]=o[d]}return l}function Ax(t,e,n){const r=n;if(ba(n)>0){const i={};let o=0;for(let s=t;s<e;s++)r[s]&&(i[o]=r[s],o++);return i}return{}}function sh(t,e,n,r){const i=t>n;if(!i&&t+e>n)throw new Error("Invalid move operation");i?KV(t,e,n,r):ZV(t,e,n,r)}function KV(t,e,n,r){const i=r,o=[];for(let s=t;s<t+e;s++)o.push(i[s]);for(let s=t-1;s>=n;s--){const a=i[s];i[s+e]=a,a==null&&delete i[s+e]}o.forEach((s,a)=>{i[n+a]=s})}function ZV(t,e,n,r){const i=r,o=[];for(let s=t;s<t+e;s++)o.push(i[s]);for(let s=t+e;s<n;s++){const a=i[s];i[s-e]=a,a==null&&delete i[s-e]}o.forEach((s,a)=>{i[n+a-e]=s})}let nt=class bd{constructor(e={}){he(this,"_matrix"),this._setOriginValue(e)}static MakeObjectMatrixSize(e){return new bd({[e-1]:{}})}getMatrix(){return this._matrix}forEach(e){const n=this._matrix,r=Object.keys(n);for(const i of r){const o=Number(i),s=n[o];if(e(o,s)===!1)return this}return this}forRow(e){const n=this._matrix,r=Object.keys(n);for(const i of r){const o=Number(i),s=n[o];if(e(o,Object.keys(s).map(a=>Number(a)))===!1)return this}return this}forValue(e){const n=this._matrix,r=Object.keys(n);for(const i of r){const o=Number(i),s=n[o],a=Object.keys(s);for(const l of a){const u=Number(l),c=s[Number(l)];if(e(o,u,c)===!1)return this}}return this}swapRow(e,n){const r=this._matrix[e],i=this._matrix[n];this._matrix[e]=i,this._matrix[n]=r}getRow(e){return this._matrix[e]}getRowOrCreate(e){let n=this.getRow(e);return n==null&&(n={},this._matrix[e]=n),n}reset(){this._setOriginValue({})}hasValue(){const e=this._matrix,n=Object.keys(e);if(n.length===0)return!1;for(const r of n){const i=Number(r),o=e[i];if(Object.keys(o).length>0)return!0}return!1}getValue(e,n){var r,i;return(i=(r=this._matrix)==null?void 0:r[e])==null?void 0:i[n]}setValue(e,n,r){const i=this.getRowOrCreate(e);i[n]=r}deleteValue(e,n){var r,i;(i=(r=this._matrix)==null?void 0:r[e])==null||delete i[n]}realDeleteValue(e,n){var r,i,o;if((i=(r=this._matrix)==null?void 0:r[e])==null||delete i[n],this.getRow(e)){const s=this.getRow(e);if(s==null)return;Object.keys(s).length===0&&((o=this._matrix)==null||delete o[e])}}setRow(e,n){this._matrix[e]=n}moveRows(e,n,r){sh(e,n,r,this._matrix)}moveColumns(e,n,r){this.forEach((i,o)=>{sh(e,n,r,o)})}getFragment(e,n,r,i){const o=new bd;let s=0;for(let a=e;a<=n;a++){const l={};let u=0;for(let c=r;c<=i;c++){const d=this.getValue(a,c);l[u]=d,u++}o.setRow(s,l),s++}return o}getSlice(e,n,r,i){const o=new bd;for(let s=e;s<=n;s++)for(let a=r;a<=i;a++){const l=this.getValue(s,a);l&&o.setValue(s,a,De.deepClone(l))}return o}getSizeOf(){return Object.keys(this._matrix).length}getLength(){return ba(this._matrix)}getRange(){const e=this.getLength()-1;let n=0;const r=this.getLength();for(let i=0;i<r;i++){const o=this.getRow(i);if(o){const s=ba(o)-1;n=s>n?s:n}}return{startRow:0,startColumn:0,endRow:e,endColumn:n}}toNativeArray(){const e=new Array;return this.forValue((n,r,i)=>{e.push(i)}),e}toArray(){const e=[];return this.forRow((n,r)=>{e[n]==null&&(e[n]=[]),r.forEach(i=>{e[n][i]=this.getValue(n,i)})}),e}toJSON(){return this._matrix}clone(){const e=JSON.stringify(this._matrix);return JSON.parse(e)}getData(){const e=JSON.stringify(this._matrix);return JSON.parse(e)}getArrayData(){let e=0,n=0,r=!1,i=!1;const o=new bd;return this.forEach((s,a)=>{r||(r=!0,e=s),Object.keys(a).forEach(l=>{const u=Number(l);i?u<n&&(n=u):(i=!0,n=u);const c=this.getValue(s,u);o.setValue(s-e,u-n,c)})}),o.getData()}getDataRange(){let e=0,n=0,r=0,i=!1,o=!1;this.forEach((a,l)=>{i||(i=!0,e=a);const u=ba(l)-1;u>r&&(r=u),Object.keys(l).forEach(c=>{const d=Number(c);o?d<n&&(n=d):(o=!0,n=d)})});const s=e+this.getSizeOf()-1;return{startRow:e,startColumn:n,endRow:s,endColumn:r}}getDiscreteRanges(){const e=[];return this.forEach((n,r)=>{Object.keys(r).forEach(i=>{const o=Number(i);let s=!1;for(const a of e)if(n>=a.startRow&&n<=a.endRow+1&&o>=a.startColumn&&o<=a.endColumn+1){a.endRow=Math.max(n,a.endRow),a.endColumn=Math.max(o,a.endColumn),s=!0;break}s||e.push({startRow:n,endRow:n,startColumn:o,endColumn:o})})}),e}merge(e){this.forValue((n,r)=>{const i=e.getValue(n,r);i!=null&&this.setValue(n,r,i)})}_setOriginValue(e={}){this._matrix=e}};var Nx=(t=>(t.INIT="init",t.FETCHING="fetching",t.DONE="done",t))(Nx||{});let Lx=class{constructor(){he(this,"status","init")}};const qV=t=>t.some(e=>e.status==="init")?"init":t.some(e=>e.status==="fetching")?"fetching":"done";var Rt=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ROW=1]="ROW",t[t.COLUMN=2]="COLUMN",t[t.ALL=3]="ALL",t))(Rt||{}),br=(t=>(t[t.NONE=0]="NONE",t[t.ROW=1]="ROW",t[t.COLUMN=2]="COLUMN",t[t.ALL=3]="ALL",t))(br||{});function QV(t){return[t.startRow,t.startColumn,t.endRow,t.endColumn]}const Gc=class Px{static clone(e){return{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn,rangeType:e.rangeType}}static equals(e,n){return e.endRow===n.endRow&&e.endColumn===n.endColumn&&e.startRow===n.startRow&&e.startColumn===n.startColumn&&(e.rangeType===n.rangeType||e.rangeType===void 0&&n.rangeType===Rt.NORMAL||n.rangeType===void 0&&e.rangeType===Rt.NORMAL)}static intersects(e,n){const r=e.startRow,i=e.endRow,o=e.startColumn,s=e.endColumn,a=n.startRow,l=n.endRow,u=n.startColumn,c=n.endColumn,d=Math.abs(o+s-u-c),h=Math.abs(o-s)+Math.abs(u-c),f=Math.abs(r+i-a-l),m=Math.abs(r-i)+Math.abs(a-l);return d<=h&&f<=m}static getIntersects(e,n){const r=e.startRow,i=e.endRow,o=e.startColumn,s=e.endColumn,a=n.startRow,l=n.endRow,u=n.startColumn,c=n.endColumn;let d,h,f,m;if(a<=i)a>=r?h=a:h=r;else return null;if(l>=r)l>=i?m=i:m=l;else return null;if(u<=s)u>o?d=u:d=o;else return null;if(c>=o)c>=s?f=s:f=c;else return null;return{startRow:h,endRow:m,startColumn:d,endColumn:f,rangeType:Rt.NORMAL}}static contains(e,n){return e.startRow<=n.startRow&&e.endRow>=n.endRow&&e.startColumn<=n.startColumn&&e.endColumn>=n.endColumn}static realContain(e,n){return Px.contains(e,n)&&(e.startRow<n.startRow||e.endRow>n.endRow||e.startColumn<n.startColumn||e.endColumn>n.endColumn)}static union(...e){return e.reduce((n,r)=>({startRow:Math.min(n.startRow,r.startRow),startColumn:Math.min(n.startColumn,r.startColumn),endRow:Math.max(n.endRow,r.endRow),endColumn:Math.max(n.endColumn,r.endColumn),rangeType:Rt.NORMAL}),e[0])}static subtract(e,n){if(n.startRow>=e.endRow||n.endRow<=e.startRow||n.startColumn>=e.endColumn||n.endColumn<=e.startColumn)return[e];const r=[];n.startRow>e.startRow&&r.push({startRow:e.startRow,startColumn:e.startColumn,endRow:n.startRow,endColumn:e.endColumn}),n.endRow<e.endRow&&r.push({startRow:n.endRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn});const i=Math.max(e.startRow,n.startRow),o=Math.min(e.endRow,n.endRow);return n.startColumn>e.startColumn&&r.push({startRow:i,startColumn:e.startColumn,endRow:o,endColumn:n.startColumn}),n.endColumn<e.endColumn&&r.push({startRow:i,startColumn:n.endColumn,endRow:o,endColumn:e.endColumn}),r}};he(Gc,"getRelativeRange",(t,e)=>({startRow:t.startRow-e.startRow,endRow:t.endRow-t.startRow,startColumn:t.startColumn-e.startColumn,endColumn:t.endColumn-t.startColumn})),he(Gc,"getPositionRange",(t,e)=>({startRow:t.startRow+e.startRow,endRow:t.endRow+t.startRow+e.startRow,startColumn:t.startColumn+e.startColumn,endColumn:t.endColumn+t.startColumn+e.startColumn})),he(Gc,"moveHorizontal",(t,e=0,n=0)=>({...t,startColumn:t.startColumn+e,endColumn:t.endColumn+e+n})),he(Gc,"moveVertical",(t,e=0,n=0)=>({...t,startRow:t.startRow+e,endRow:t.endRow+e+n})),he(Gc,"moveOffset",(t,e,n)=>({...t,startRow:t.startRow+n,endRow:t.endRow+n,startColumn:t.startColumn+e,endColumn:t.endColumn+e}));let pt=Gc,Vf=class{constructor(e,n){he(this,"_values",[]),he(this,"_keys",[]),he(this,"_keyMaps",new Map),this._values=e,this._keys=n,e.forEach(r=>{this._initKeyMap(r)})}_initKeyMap(e){this._keys.forEach(n=>{const r=e[n],i=this._keyMaps.get(n)||new Map;i.set(r,e),this._keyMaps.set(n,i)})}getValue(e){for(let n=0;n<this._keys.length;n++){const r=this._keyMaps.get(this._keys[n]);if(r!=null&&r.has(e))return r.get(e)}return null}hasValue(e){for(let n=0;n<this._keys.length;n++){const r=this._keyMaps.get(this._keys[n]);if(r!=null&&r.has(e))return!0}return!1}addValue(e){this._values.push(e),this._initKeyMap(e)}setValue(e,n,r){const i=this.getValue(e);i&&Object.keys(i).includes(n)&&(i[n]=r)}deleteValue(e){const n=this.getValue(e);if(n){this._keys.forEach(i=>{const o=this._keyMaps.get(i),s=n[i];o==null||o.delete(s)});const r=this._values.findIndex(i=>i===n);this._values.splice(r,1)}}getValues(){return this._values}getKeyMap(e){var n;return[...((n=this._keyMaps.get(e))==null?void 0:n.keys())||[]]}clear(){this._values=[],this._keys=[],this._keyMaps.clear()}};function yS(t,e,n,r){return{forEach(i){for(let o=t;o<=e;o++)for(let s=n;s<=r;s++)i(o,s)}}}const ah=65,Bx=90,JV=97;function ej(t){const e=Bx-ah+1;let n="";for(;t>=0;)n=String.fromCharCode(t%e+ah)+n,t=Math.floor(t/e)-1;return n}function tj(t,e){let n="";for(;e>0;)n+=t,e--;return n}function Fx(t,e=!1){const n=Bx-ah+1;let r=JV;e&&(r=ah);const i=String.fromCharCode(t%n+r),o=Math.floor(t/n)+1;return tj(i,o)}function Ns(t,e){return t.zIndex>e.zIndex?1:t.zIndex===e.zIndex?0:-1}function SS(t,e){return t.zIndex>e.zIndex?-1:t.zIndex===e.zIndex?0:1}function J6(t="index",e=1){return(n,r)=>n[t]>r[t]?e:n[t]===r[t]?0:-e}var Xr=(t=>(t[t.PARAGRAPH=0]="PARAGRAPH",t[t.SECTION_BREAK=1]="SECTION_BREAK",t[t.TABLE=2]="TABLE",t[t.TABLE_ROW=3]="TABLE_ROW",t[t.TABLE_CELL=4]="TABLE_CELL",t))(Xr||{}),en=(t=>(t.PARAGRAPH="\r",t.SECTION_BREAK=`
`,t.TABLE_START="",t.TABLE_ROW_START="\x1B",t.TABLE_CELL_START="",t.TABLE_CELL_END="",t.TABLE_ROW_END="",t.TABLE_END="",t.CUSTOM_RANGE_START="",t.CUSTOM_RANGE_END="",t.COLUMN_BREAK="\v",t.PAGE_BREAK="\f",t.DOCS_END="\0",t.TAB="	",t.CUSTOM_BLOCK="\b",t.LETTER="",t.SPACE=" ",t))(en||{});function Ux(t){const e=[];for(const n of t){const{st:r,ed:i}=n;if(r===i)continue;if(e.length===0){e.push(n);continue}const o=e.pop();HV(n,o)&&De.hasIntersectionBetweenTwoRanges(o.st,o.ed,n.st,n.ed)?e.push({...n,st:o.st,ed:i}):e.push(o,n)}return e}function Hx(t,e,n,r){const{textRuns:i}=t;if(i==null)return;const o=[],s=i.length;let a=!1;const l=e.textRuns??[];if(l.length)for(let u=0,c=l.length;u<c;u++){const d=l[u];d.st+=r,d.ed+=r}for(let u=0;u<s;u++){const c=i[u],{st:d,ed:h}=c;if(h<r)o.push(c);else if(r>=d&&r<=h)if(a)c.st+=n,c.ed+=n,o.push(c);else{a=!0,c.ed+=n;const f=[];if(l.length){const m={...c,st:d,ed:l[0].st};f.push(m),f.push(...l);const p=l[l.length-1],g={...c,st:p.ed,ed:h+n};f.push(g)}else f.push(c);o.push(...f)}else c.st+=n,c.ed+=n,a||(a=!0,o.push(...l)),o.push(c)}a||(a=!0,o.push(...l)),t.textRuns=Ux(o)}function sb(t,e,n,r){const{paragraphs:i}=t;if(i==null)return;const{paragraphs:o,dataStream:s}=e,a=[];let l=-1;for(let c=0,d=i.length;c<d;c++){const h=i[c],{startIndex:f}=h;f>=r&&(h.startIndex+=n),l===-1&&f>=r&&(l=c),a.push(h.startIndex)}let u=-1;if(o){for(let c=0,d=o.length;c<d;c++){const h=o[c];h.startIndex+=r;const f=h.startIndex;u=a.indexOf(f)}if(s===en.PARAGRAPH&&o.length===1){const c=i[l],d=o[0],h=c.paragraphStyle,f=c.bullet;c.paragraphStyle=d.paragraphStyle,c.bullet=d.bullet,d.paragraphStyle=h,d.bullet=f}u!==-1&&i.splice(u,1),i.push(...o),i.sort(J6("startIndex"))}}function nj(t,e,n,r){const{sectionBreaks:i}=t;if(i==null)return;for(let s=0,a=i.length;s<a;s++){const l=i[s],{startIndex:u}=l;u>=r&&(l.startIndex+=n)}const o=e.sectionBreaks;if(o){for(let s=0,a=o.length;s<a;s++){const l=o[s];l.startIndex+=r}i.push(...o),i.sort(J6("startIndex"))}}function Vx(t,e,n,r){const{customBlocks:i}=t;if(i==null)return;for(let s=0,a=i.length;s<a;s++){const l=i[s],{startIndex:u}=l;u>=r&&(l.startIndex+=n)}const o=e.customBlocks;if(o){for(let s=0,a=o.length;s<a;s++){const l=o[s];l.startIndex+=r}i.push(...o),i.sort(J6("startIndex"))}}function ab(t,e,n,r){const{tables:i}=t;if(i==null)return;for(let s=0,a=i.length;s<a;s++){const l=i[s],{startIndex:u,endIndex:c}=l;u>r?(l.startIndex+=n,l.endIndex+=n):c>=r-1&&(l.endIndex+=n)}const o=e.tables;if(o){for(let s=0,a=o.length;s<a;s++){const l=o[s];l.startIndex+=r,l.endIndex+=r}i.push(...o),i.sort(J6("startIndex"))}}function rj(t,e,n,r){const{customRanges:i}=t;if(i==null)return;for(let s=0,a=i.length;s<a;s++){const l=i[s],{startIndex:u,endIndex:c}=l;u>r?(l.startIndex+=n,l.endIndex+=n):c>=r-1&&(l.endIndex+=n)}const o=e.customRanges;if(o){for(let s=0,a=o.length;s<a;s++){const l=o[s];l.startIndex+=r,l.endIndex+=r}i.push(...o),i.sort(J6("startIndex"))}}function jx(t,e,n){const{textRuns:r}=t,i=n,o=n+e,s=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{st:d,ed:h}=c;if(i<=d&&o>=h){s.push({...c,st:d-i,ed:h-i});continue}else d<=i&&h>=o?(s.push({...c,st:i-i,ed:o-i}),c.ed-=e):i>=d&&i<h?(s.push({...c,st:i-i,ed:h-i}),c.ed=i):o>d&&o<=h?(s.push({...c,st:d-i,ed:o-i}),c.st=o-e,c.ed-=e):d>=o&&(c.st-=e,c.ed-=e);a.push(c)}t.textRuns=a}return s}function zx(t,e,n){const{paragraphs:r}=t,i=n,o=n+e,s=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:d}=c;if(d>=i&&d<o){s.push({...c,startIndex:d-n});continue}else d>=o&&(c.startIndex-=e);a.push(c)}t.paragraphs=a}return s}function Wx(t,e,n){const{sectionBreaks:r}=t,i=n,o=n+e-1,s=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:d}=c;if(d>=i&&d<=o){s.push({...c,startIndex:d-n});continue}else d>o&&(c.startIndex-=e);a.push(c)}t.sectionBreaks=a}return s}function Xx(t,e,n){const{customBlocks:r}=t,i=n,o=n+e-1,s=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:d}=c;if(d>=i&&d<=o){s.push({...c,startIndex:d-n});continue}else d>o&&(c.startIndex-=e);a.push(c)}t.customBlocks=a}return s}function Yx(t,e,n){const{tables:r}=t,i=n,o=n+e-1,s=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:d,endIndex:h}=c;if(i<=d&&o>=h){s.push({...c,startIndex:d-n,endIndex:h-n});continue}else if(d<=i&&h>=o){const f=ob(d,h,i,o);c.startIndex=f[0],c.endIndex=f[1]}else o<d&&(c.startIndex-=e,c.endIndex-=e);a.push(c)}t.tables=a}return s}function Gx(t,e,n){const{customRanges:r}=t,i=n,o=n+e-1,s=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:d,endIndex:h}=c;if(i<=d&&o>=h){s.push({...c,startIndex:d-n,endIndex:h-n});continue}else if(d<=i&&h>=o){const f=ob(d,h,i,o);c.startIndex=f[0],c.endIndex=f[1]}else o<d&&(c.startIndex-=e,c.endIndex-=e);a.push(c)}t.customRanges=a}return s}function ij(t,e,n){const{dataStream:r}=t,i=n,o=n+e,s=jx(t,e,n),a=zx(t,e,n),l=Wx(t,e,n),u=Xx(t,e,n),c=Yx(t,e,n),d=Gx(t,e,n);let h="";return r&&(t.dataStream=xx(r,i,o),h=r.slice(i,o)),{dataStream:h,textRuns:s,paragraphs:a,sectionBreaks:l,customBlocks:u,tables:c,customRanges:d}}function oj(t,e,n,r){t.dataStream=Ix(t.dataStream,r,e.dataStream),Hx(t,e,n,r),sb(t,e,n,r),nj(t,e,n,r),Vx(t,e,n,r),ab(t,e,n,r),rj(t,e,n,r)}var ha=(t=>(t[t.GLYPH_TYPE_UNSPECIFIED=0]="GLYPH_TYPE_UNSPECIFIED",t[t.NONE=1]="NONE",t[t.DECIMAL=2]="DECIMAL",t[t.ZERO_DECIMAL=3]="ZERO_DECIMAL",t[t.UPPER_ALPHA=4]="UPPER_ALPHA",t[t.ALPHA=5]="ALPHA",t[t.UPPER_ROMAN=6]="UPPER_ROMAN",t[t.ROMAN=7]="ROMAN",t))(ha||{}),fa=(t=>(t[t.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",t[t.START=1]="START",t[t.CENTER=2]="CENTER",t[t.END=3]="END",t))(fa||{}),fo=(t=>(t[t.DEFAULT=0]="DEFAULT",t[t.LINES=1]="LINES",t[t.LINES_AND_CHARS=2]="LINES_AND_CHARS",t[t.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",t))(fo||{}),lh=(t=>(t[t.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",t[t.CONTINUOUS=1]="CONTINUOUS",t[t.NEXT_PAGE=2]="NEXT_PAGE",t[t.EVEN_PAGE=3]="EVEN_PAGE",t[t.ODD_PAGE=4]="ODD_PAGE",t))(lh||{}),a6=(t=>(t[t.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",t[t.NONE=1]="NONE",t[t.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",t))(a6||{}),Pd=(t=>(t[t.BOTH_SIDES=0]="BOTH_SIDES",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t[t.LARGEST=3]="LARGEST",t))(Pd||{}),va=(t=>(t[t.INLINE=0]="INLINE",t[t.WRAP_NONE=1]="WRAP_NONE",t[t.WRAP_POLYGON=2]="WRAP_POLYGON",t[t.WRAP_SQUARE=3]="WRAP_SQUARE",t[t.WRAP_THROUGH=4]="WRAP_THROUGH",t[t.WRAP_TIGHT=5]="WRAP_TIGHT",t[t.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",t))(va||{}),uh=(t=>(t[t.AUTO=0]="AUTO",t[t.AT_LEAST=1]="AT_LEAST",t[t.EXACT=2]="EXACT",t))(uh||{}),Cd=(t=>(t.NORMAL="normal",t.BOLD="bold",t.ITALIC="italic",t))(Cd||{}),Ir=(t=>(t[t.CHARACTER=0]="CHARACTER",t[t.COLUMN=1]="COLUMN",t[t.INSIDE_MARGIN=2]="INSIDE_MARGIN",t[t.LEFT_MARGIN=3]="LEFT_MARGIN",t[t.MARGIN=4]="MARGIN",t[t.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",t[t.PAGE=6]="PAGE",t[t.RIGHT_MARGIN=7]="RIGHT_MARGIN",t))(Ir||{}),Ar=(t=>(t[t.BOTTOM_MARGIN=0]="BOTTOM_MARGIN",t[t.INSIDE_MARGIN=1]="INSIDE_MARGIN",t[t.LINE=2]="LINE",t[t.MARGIN=3]="MARGIN",t[t.OUTSIDE_MARGIN=4]="OUTSIDE_MARGIN",t[t.PAGE=5]="PAGE",t[t.PARAGRAPH=6]="PARAGRAPH",t[t.TOP_MARGIN=7]="TOP_MARGIN",t))(Ar||{}),Kx=(t=>(t[t.POINT=0]="POINT",t[t.LINE=1]="LINE",t[t.CHARACTER=2]="CHARACTER",t))(Kx||{}),X1=(t=>(t[t.CENTER=0]="CENTER",t[t.INSIDE=1]="INSIDE",t[t.LEFT=2]="LEFT",t[t.OUTSIDE=3]="OUTSIDE",t[t.RIGHT=4]="RIGHT",t))(X1||{}),Kc=(t=>(t[t.BOTTOM=0]="BOTTOM",t[t.CENTER=1]="CENTER",t[t.INSIDE=2]="INSIDE",t[t.OUTSIDE=3]="OUTSIDE",t[t.TOP=4]="TOP",t))(Kc||{}),H5=(t=>(t[t.PORTRAIT=0]="PORTRAIT",t[t.LANDSCAPE=1]="LANDSCAPE",t))(H5||{}),l6=(t=>(t.BULLET_LIST="BULLET_LIST",t.ORDER_LIST="ORDER_LIST",t))(l6||{});const sj={BULLET_LIST:{listType:"BULLET_LIST",nestingLevel:[{bulletAlignment:fa.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:21},{bulletAlignment:fa.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:42},{bulletAlignment:fa.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:63}]},ORDER_LIST:{listType:"ORDER_LIST",nestingLevel:[{bulletAlignment:fa.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:ha.DECIMAL,hanging:21,indentStart:21},{bulletAlignment:fa.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:ha.DECIMAL,hanging:21,indentStart:42},{bulletAlignment:fa.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:ha.DECIMAL,hanging:21,indentStart:63}]}};function aj(t,e,n,r,i){const o=lj(t,e,n,r,i),s=cj(t,e,n,r,i),a=dj(t,e,n,r,i),l=hj(t,e,n,r,i),u=fj(t,e,n,r,i),c=mj(t,e,n,r,i);return{dataStream:"",textRuns:o,paragraphs:s,sectionBreaks:a,customBlocks:l,tables:u,customRanges:c}}function lj(t,e,n,r,i){const{textRuns:o}=t,{textRuns:s}=e;if(o==null||s==null)return;const a=jx(t,n,r);if(i!==Ei.REPLACE){const l=uj(s,a,i);e.textRuns=l}return Hx(t,e,n,r),a}function uj(t,e,n){if(e.length===0)return t;t=De.deepClone(t),e=De.deepClone(e);const r=[],i=t.length,o=e.length;let s=0,a=0,l=null;function u(){return l?(r.push(l),l=null,!0):!1}for(;s<i&&a<o;){const{st:f,ed:m,ts:p}=t[s],{st:g,ed:v,ts:_,sId:C}=e[a];let y;n===Ei.COVER?y={..._,...p}:y={...p,..._},m<g?(u()||r.push(t[s]),s++):v<f?(u()||r.push(e[a]),a++):(r.push({st:Math.min(f,g),ed:Math.max(f,g),ts:f<g?{...p}:{..._},sId:f<g?void 0:C}),r.push({st:Math.max(f,g),ed:Math.min(m,v),ts:y,sId:C}),m<v?(s++,e[a].st=m):(a++,t[s].st=v),l={st:Math.min(m,v),ed:Math.max(m,v),ts:m<v?{..._}:{...p},sId:m<v?C:void 0})}u();const c=r[r.length-1],d=t[i-1],h=e[o-1];return c.ed!==Math.max(d.ed,h.ed)&&(d.ed>h.ed?r.push(d):r.push(h)),Ux(r)}function cj(t,e,n,r,i){const{paragraphs:o}=t,{paragraphs:s}=e;if(o==null||s==null)return;const a=zx(t,n,r);if(i!==Ei.REPLACE){const l=[];for(const u of s){const{startIndex:c,paragraphStyle:d,bullet:h}=u;let f=[];for(const m of a){const{startIndex:p,paragraphStyle:g,bullet:v}=m;let _,C;if(i===Ei.COVER?(_={...g,...d},C={listId:"",listType:l6.BULLET_LIST,nestingLevel:0,textStyle:{},...v,...h}):(_={...d,...g},C={listId:"",listType:l6.BULLET_LIST,nestingLevel:0,textStyle:{},...h,...v}),c===p){f.push({startIndex:c,paragraphStyle:_,bullet:C});break}}l.push(...f),f=[]}e.paragraphs=l}return sb(t,e,n,r),a}function dj(t,e,n,r,i){const{sectionBreaks:o}=t,{sectionBreaks:s}=e;if(o==null||s==null)return;const a=Wx(t,n,r);if(i!==Ei.REPLACE){const l=[];for(const u of s){const{startIndex:c}=u;let d=[];for(const h of a){const{startIndex:f}=h;if(c===f){i===Ei.COVER?d.push({...h,...u}):d.push({...u,...h});break}}l.push(...d),d=[]}e.sectionBreaks=l}return sb(t,e,n,r),a}function hj(t,e,n,r,i){const{customBlocks:o}=t,{customBlocks:s}=e;if(o==null||s==null)return;const a=Xx(t,n,r);if(i!==Ei.REPLACE){const l=[];for(const u of s){const{startIndex:c}=u;let d=[];for(const h of a){const{startIndex:f}=h;if(c===f){i===Ei.COVER?d.push({...h,...u}):d.push({...u,...h});break}}l.push(...d),d=[]}e.customBlocks=l}return Vx(t,e,n,r),a}function fj(t,e,n,r,i){const{tables:o}=t,{tables:s}=e;if(o==null||s==null)return;const a=Yx(t,n,r);if(i!==Ei.REPLACE){const l=[];for(const u of s){const{startIndex:c,endIndex:d}=u;let h=[];for(const f of a){const{startIndex:m,endIndex:p}=f;if(m>=c&&p<=d){i===Ei.COVER?h.push({...f,...u}):h.push({...u,...f});break}}l.push(...h),h=[]}e.tables=l}return ab(t,e,n,r),a}function mj(t,e,n,r,i){const{customRanges:o}=t,{tables:s}=e;if(o==null||s==null)return;const a=Gx(t,n,r);if(i!==Ei.REPLACE){const l=[];for(const u of s){const{startIndex:c,endIndex:d}=u;let h=[];for(const f of a){const{startIndex:m,endIndex:p}=f;if(m>=c&&p<=d){i===Ei.COVER?h.push({...f,...u}):h.push({...u,...f});break}}l.push(...h),h=[]}e.customRanges=l}return ab(t,e,n,r),a}const Zx={id:"default_doc",documentStyle:{}};let pj=class{constructor(e){he(this,"snapshot"),this.snapshot={...Zx,...e}}get drawings(){return this.snapshot.drawings}get documentStyle(){return this.snapshot.documentStyle}get lists(){return this.snapshot.lists}get body(){return this.snapshot.body}get zoomRatio(){var e;return((e=this.snapshot.settings)==null?void 0:e.zoomRatio)||1}getBody(){return this.snapshot.body}getShouldRenderLoopImmediately(){return this.snapshot.shouldStartRenderingImmediately!==!1}getContainer(){return this.snapshot.container}getParentRenderUnitId(){return this.snapshot.parentRenderUnitId}getSnapshot(){return this.snapshot}updateDocumentId(e){this.snapshot.id=e}updateDocumentRenderConfig(e){const{documentStyle:n}=this.snapshot;n.renderConfig==null?n.renderConfig=e:n.renderConfig={...n.renderConfig,...e}}updateDocumentDataMargin(e){const{t:n,l:r,b:i,r:o}=e,{documentStyle:s}=this.snapshot;n!=null&&(s.marginTop=n),r!=null&&(s.marginLeft=r),i!=null&&(s.marginBottom=i),o!=null&&(s.marginRight=o)}updateDocumentDataPageSize(e,n){const{documentStyle:r}=this.snapshot;if(!r.pageSize){e=e??1/0,n=n??1/0,r.pageSize={width:e,height:n};return}e!==void 0&&(r.pageSize.width=e),n!==void 0&&(r.pageSize.height=n)}updateDrawing(e,n){const{drawings:r}=this,{width:i,height:o,left:s,top:a}=n,l=r==null?void 0:r[e];if(!l)return;const u=l.objectTransform;u.size.width=i,u.size.height=o,u.positionH.posOffset=s,u.positionV.posOffset=a}setZoomRatio(e=1){this.snapshot.settings==null?this.snapshot.settings={zoomRatio:e}:this.snapshot.settings.zoomRatio=1}},u6=class Gp extends pj{constructor(e){super(e),he(this,"_unitId"),he(this,"headerModelMap",new Map),he(this,"footerModelMap",new Map);const n=6;this._unitId=this.snapshot.id??De.generateRandomId(n),this._initializeHeaderFooterModel()}dispose(){this.headerModelMap.forEach(e=>{e.dispose()}),this.footerModelMap.forEach(e=>{e.dispose()})}getRev(){return this.snapshot.rev??0}incrementRev(){this.snapshot.rev=this.getRev()+1}getSettings(){return this.snapshot.settings}reset(e){if(e.id&&e.id!==this._unitId)throw new Error("Cannot reset a document model with a different unit id!");this.snapshot={...Zx,...e},this._initializeHeaderFooterModel()}getSelfOrHeaderFooterModel(e){if(e!=null){if(this.headerModelMap.has(e))return this.headerModelMap.get(e);if(this.footerModelMap.has(e))return this.footerModelMap.get(e)}return this}getUnitId(){return this._unitId}apply(e){const n=[],r=new Q6;return r.reset(),e.forEach(i=>{if(i=De.deepClone(i),i.t==="r"){const{coverType:o,body:s,len:a,segmentId:l}=i;if(s!=null){const u=this._updateApply(s,a,r.cursor,o,l);n.push({...i,t:"r",coverType:Ei.REPLACE,body:u})}else n.push({...i,t:"r"});r.moveCursor(a)}else if(i.t==="i"){const{body:o,len:s,segmentId:a,line:l}=i;this._insertApply(o,s,r.cursor,a),r.moveCursor(s),n.push({t:"d",len:s,line:l,segmentId:a})}else if(i.t==="d"){const{len:o,segmentId:s}=i,a=this._deleteApply(o,r.cursor,s);n.push({...i,t:"i",body:a})}else throw new Error(`Unknown mutation type for mutation: ${i}.`)}),n}_updateApply(e,n,r,i=Ei.COVER,o){if(e==null)throw new Error("updateBody is none");const s=this.snapshot,a=u3(s,o);if(a==null)throw new Error("no body has changed");return aj(a,e,n,r,i)}_deleteApply(e,n,r){const i=this.snapshot,o=u3(i,r);if(o==null)throw new Error("no body has changed");return e<=0?{dataStream:""}:ij(o,e,n)}_insertApply(e,n,r,i){const o=this.snapshot,s=u3(o,i);if(n!==0){if(s==null)throw new Error("no body has changed");oj(s,e,n,r)}}_initializeHeaderFooterModel(){const{headers:e,footers:n}=this.getSnapshot();if(e)for(const r in e){const i=e[r];this.headerModelMap.set(r,new Gp(i))}if(n)for(const r in n){const i=n[r];this.footerModelMap.set(r,new Gp(i))}}updateDocumentId(e){super.updateDocumentId(e),this._unitId=e}};const jf={sheetId:"",range:{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}},gj={id:"",sheetOrder:[],name:"",appVersion:"",locale:F5.ZH_CN,styles:{},sheets:{},resources:[]},vj=1e3,_j=20,Kp=19,c3=73,bj=46,Cj=20,ch={type:Sx.GRID,name:"Sheet1",id:"sheet-01",tabColor:"",hidden:ke.FALSE,rowCount:vj,columnCount:_j,zoomRatio:1,freeze:{xSplit:0,ySplit:0,startRow:-1,startColumn:-1},scrollTop:0,scrollLeft:0,defaultColumnWidth:c3,defaultRowHeight:Kp,mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},status:ke.FALSE,showGridlines:ke.TRUE,rowHeader:{width:bj,hidden:ke.FALSE},columnHeader:{height:Cj,hidden:ke.FALSE},selections:["A1"],rightToLeft:ke.FALSE,pluginMeta:{}},zf={ff:"Times New Roman",fs:14,it:ke.FALSE,bl:ke.FALSE,ul:{s:ke.FALSE},st:{s:ke.FALSE},ol:{s:ke.FALSE},tr:{a:0,v:ke.FALSE},td:rh.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:Ln.UNSPECIFIED,vt:Kr.UNSPECIFIED,tb:yr.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0}},yj={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}};let Sj=class{constructor(e={}){he(this,"_styles"),he(this,"_cacheMap",new U5(1e5)),this._styles=e,this._generateCacheMap()}each(e){return Object.entries(this._styles).forEach(e),this}search(e,n){return this._cacheMap.has(n)?this._cacheMap.get(n):this._getExistingStyleId(e)||"-1"}get(e){return typeof e!="string"?e:(e=String(e),this._styles[e])}add(e,n){const r=De.generateRandomId(6);return this._styles[r]=e,this._cacheMap.set(n,r),r}setValue(e){if(e==null)return;const n=JSON.stringify(e),r=this.search(e,n);return r!=="-1"?r:this.add(e,n)}toJSON(){return this._styles}getStyleByCell(e){let n;e&&De.isObject(e.s)?n=e.s:n=(e==null?void 0:e.s)&&this.get(e.s);const r=e==null?void 0:e.interceptorStyle;return r?{...n,...r}:n}_generateCacheMap(){const{_styles:e,_cacheMap:n}=this;for(const r in e){const i=JSON.stringify(e[r]);n.set(i,r)}}_getExistingStyleId(e){const{_styles:n}=this;for(const r in n)if(De.diffValue(n[r],e))return r;return null}};function qx(t){return t&&(t.s!==void 0||t.p!==void 0||t.v!==void 0)||t.f!==void 0||t.si!==void 0}function Ej(t){if(t.t!==void 0)return t.t;if(typeof t.v=="string")return er.STRING;if(typeof t.v=="number")return er.NUMBER;if(typeof t.v=="boolean")return er.BOOLEAN}function dh(t){if(t==null)return!0;const{v:e,f:n,si:r,p:i,s:o}=t;return!(!(e==null||typeof e=="string"&&e.length===0)||n!=null&&n.length>0||r!=null&&r.length>0||i!=null)}var Qx=(t=>(t[t.SLIDE=0]="SLIDE",t[t.MASTER=1]="MASTER",t[t.LAYOUT=2]="LAYOUT",t[t.HANDOUT_MASTER=3]="HANDOUT_MASTER",t[t.NOTES_MASTER=4]="NOTES_MASTER",t))(Qx||{});let wj=class{constructor(e,n){he(this,"_columnData",{}),this._config=e,this._columnData=n}getColumnData(){return this._columnData}getColVisible(e){const{_columnData:n}=this,r=n[e];return r?r.hd!==ke.TRUE:!0}getHiddenCols(e=0,n=ba(this._columnData)-1){const r=[];let i=!1,o=-1;for(let s=e;s<=n;s++){const a=this.getColVisible(s);i&&a?(i=!1,r.push({rangeType:Rt.COLUMN,startColumn:o,endColumn:s-1,startRow:0,endRow:0})):!i&&!a&&(i=!0,o=s)}return i&&r.push({startRow:0,endRow:0,startColumn:o,endColumn:n,rangeType:Rt.COLUMN}),r}getColumnDatas(e,n){const r={};let i=0;for(let o=e;o<e+n;o++){const s=this.getColumnOrCreate(o);r[i]=s,i++}return r}getSize(){return ba(this._columnData)}getColumnWidth(e){const{_columnData:n}=this,r=this._config;let i=0;return i=(n[e]||{hd:ke.FALSE,w:r.defaultColumnWidth}).w||r.defaultColumnWidth,i}getColumn(e){const n=this._columnData[e];if(n)return n}getColumnOrCreate(e){const{_columnData:n}=this,r=this._config,i=n[e];if(i)return i;const o={w:r.defaultColumnWidth,hd:ke.FALSE};return this._columnData[e]=o,o}};function a7(t,e){for(const n of e){const{ts:r={}}=n;if(r[t]==null)return ke.FALSE;switch(t){case"bl":case"it":{if(r[t]===ke.FALSE)return ke.FALSE;break}case"ul":case"st":{if(r[t].s===ke.FALSE)return ke.FALSE;break}default:throw new Error(`unknown style key: ${t} in IStyleBase`)}}return ke.TRUE}let Er=class Zp{constructor(e,n,r){he(this,"_range"),he(this,"_worksheet"),this._deps=r,this._range=n,this._worksheet=e}static foreach(e,n){const{startRow:r,startColumn:i,endRow:o,endColumn:s}=e;for(let a=r;a<=o;a++)for(let l=i;l<=s;l++)n(a,l)}getRangeData(){return this._range}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:e,endRow:n,startColumn:r,endColumn:i}=this._range,o=[];for(let s=e;s<=n;s++){const a=[];for(let l=r;l<=i;l++)a.push(this.getMatrix().getValue(s,l)||null);o.push(a)}return o}getMatrix(){const{startRow:e,endRow:n,startColumn:r,endColumn:i}=this._range,o=this._worksheet.getCellMatrix(),s=new nt;for(let a=e;a<=n;a++)for(let l=r;l<=i;l++)s.setValue(a,l,o.getValue(a,l)||null);return s}getMatrixObject(){const{startRow:e,endRow:n,startColumn:r,endColumn:i}=this._range,o=this._worksheet.getCellMatrix(),s=new nt;for(let a=e;a<=n;a++)for(let l=r;l<=i;l++)s.setValue(a-e,l-r,o.getValue(a,l)||{});return s}getA1Notation(){const{startRow:e,endRow:n,startColumn:r,endColumn:i}=this._range;let o,s;return r<i?(o=De.numToWord(r+1)+(e+1),s=De.numToWord(i+1)+(n+1)):(o=De.numToWord(i+1)+(n+1),s=De.numToWord(r+1)+(e+1)),o===s?`${o}`:`${o}:${s}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){const e=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var i;const o=e.getStyleByCell(r);return((i=o==null?void 0:o.bg)==null?void 0:i.rgb)||zf.bg.rgb}))}getCell(e,n){const{startRow:r,endRow:i,startColumn:o,endColumn:s}=this._range,a={startRow:r+e,endRow:r+e,startColumn:o+n,endColumn:o+n};return new Zp(this._worksheet,a,this._deps)}getColumn(){return this._range.startColumn}getObjectValue(e={}){return this.getObjectValues(e)[0][0]}getObjectValues(e={}){var n;const{startRow:r,endRow:i,startColumn:o,endColumn:s}=this._range,a=this._worksheet.getCellMatrix().getFragment(r,i,o,s).getData();if(e.isIncludeStyle){const l=this._deps.getStyles();for(let u=0;u<=i-r;u++)for(let c=0;c<=s-o;c++){if(a==null||((n=a==null?void 0:a[u])==null?void 0:n[c])==null)continue;const d=a[u][c].s;d&&(a[u][c].s=l.get(d))}}return a}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){const e=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var i;const o=e.getStyleByCell(r);return((i=o==null?void 0:o.cl)==null?void 0:i.rgb)||zf.cl.rgb}))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){var e,n;const{p:r}=this.getValue()??{};return r&&Array.isArray((e=r.body)==null?void 0:e.textRuns)?a7("ul",(n=r.body)==null?void 0:n.textRuns)===ke.TRUE?{s:ke.TRUE}:{s:ke.FALSE}:this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThrough(){var e,n;const{p:r}=this.getValue()??{};return r&&Array.isArray((e=r.body)==null?void 0:e.textRuns)?a7("st",(n=r.body)==null?void 0:n.textRuns)===ke.TRUE?{s:ke.TRUE}:{s:ke.FALSE}:this.getStrikeThroughs()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getFontSize(){return this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getBorder(){return this.getBorders()[0][0]}getBorders(){return this._getStyles("bd")}getFontStyle(){var e,n;const{p:r}=this.getValue()??{};return r&&Array.isArray((e=r.body)==null?void 0:e.textRuns)?a7("it",(n=r.body)==null?void 0:n.textRuns)===ke.TRUE?A2.ITALIC:A2.NORMAL:this.getFontStyles()[0][0]}getFontStyles(){return this._getStyles("it")}getFontWeight(){var e,n;const{p:r}=this.getValue()??{};return r&&Array.isArray((e=r.body)==null?void 0:e.textRuns)?a7("bl",(n=r.body)==null?void 0:n.textRuns)===ke.TRUE?N2.BOLD:N2.NORMAL:this.getFontWeights()[0][0]}getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_range:e,_worksheet:n}=this,{startRow:r,endRow:i}=e;let o=0;for(let s=0;s<=i-r;s++){const a=n.getRowHeight(s);o+=a}return o}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._range.endColumn}getLastRow(){return this._range.endRow}getNumColumns(){const{startColumn:e,endColumn:n}=this._range;return n-e+1}getNumRows(){const{startRow:e,endRow:n}=this._range;return n-e+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map(e=>e.map(n=>(n==null?void 0:n.p)||""))}getRowIndex(){return this._range.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){const e=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>e.getStyleByCell(r)))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_range:e,_worksheet:n}=this,{startColumn:r,endColumn:i}=e;let o=0;for(let s=0;s<=i-r;s++)o+=n.getColumnWidth(s);return o}getWrap(){return this.getWraps()[0][0]}getWraps(){return this._getStyles("tb")}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}forEach(e){Zp.foreach(this._range,e)}_getStyles(e){const n=this._deps.getStyles();return this.getValues().map(r=>r.map(i=>{const o=n&&n.getStyleByCell(i);return o&&o[e]||zf[e]}))}},Rj=class{constructor(e,n){he(this,"_rowData"),this._config=e,this._rowData=n}getRowData(){return this._rowData}getRowDatas(e,n){const r={};let i=0;for(let o=e;o<e+n;o++){const s=this.getRowOrCreate(o);r[i]=s,i++}return r}getRowHeight(e,n=1){const{_rowData:r}=this,i=this._config;let o=0;for(let s=0;s<n;s++){const a=r[s+e]||{hd:ke.FALSE,h:i.defaultRowHeight},{isAutoHeight:l,ah:u,h:c=i.defaultRowHeight}=a;o+=(l==null||l)&&typeof u=="number"?u:c}return o}getRow(e){return this._rowData[e]}getRowOrCreate(e){const{_rowData:n}=this,r=n[e];if(r)return r;const i=this._config,o={hd:ke.FALSE,h:i.defaultRowHeight};return n[e]=o,o}getHiddenRows(e=0,n=ba(this._rowData)-1){const r=[];let i=!1,o=-1;for(let s=e;s<=n;s++){const a=this.getRowVisible(s);i&&a?(i=!1,r.push({startRow:o,endRow:s-1,startColumn:0,endColumn:0,rangeType:Rt.ROW})):!i&&!a&&(i=!0,o=s)}return i&&r.push({startRow:o,endRow:n,startColumn:0,endColumn:0,rangeType:Rt.ROW}),r}getRowVisible(e){const n=this.getRow(e);return n?n.hd!==ke.TRUE:!0}getSize(){return ba(this._rowData)}},Dj=class extends je{constructor(){super(...arguments),he(this,"_cellContentInterceptors",[]),he(this,"_rowFilteredInterceptors",[]),he(this,"_rowVisibleInterceptors",[]),he(this,"_colVisibleInterceptors",[])}dispose(){super.dispose(),this._cellContentInterceptors.length=0,this._rowFilteredInterceptors.length=0,this._rowVisibleInterceptors.length=0,this._colVisibleInterceptors.length=0}getCell(e,n){for(const r of this._cellContentInterceptors){const i=r.getCell(e,n);if(typeof i<"u")return i}return null}registerCellContentInterceptor(e){if(this._cellContentInterceptors.includes(e))throw new Error("[SheetViewModel]: Interceptor already registered.");return this._cellContentInterceptors.push(e),Be(()=>ga(this._cellContentInterceptors,e))}registerRowFilteredInterceptor(e){if(this._rowFilteredInterceptors.includes(e))throw new Error("[SheetViewModel]: Interceptor already registered.");return this._rowFilteredInterceptors.push(e),Be(()=>ga(this._rowFilteredInterceptors,e))}registerRowVisibleInterceptor(e){if(this._rowVisibleInterceptors.includes(e))throw new Error("[SheetViewModel]: Interceptor already registered.");return this._rowVisibleInterceptors.push(e),Be(()=>ga(this._rowVisibleInterceptors,e))}registerColVisibleInterceptor(e){if(this._colVisibleInterceptors.includes(e))throw new Error("[SheetViewModel]: Interceptor already registered.");return this._colVisibleInterceptors.push(e),Be(()=>ga(this._colVisibleInterceptors,e))}},ES=class Jx{constructor(e,n){he(this,"_initialized"),he(this,"_sheetId"),he(this,"_snapshot"),he(this,"_cellData"),he(this,"_rowManager"),he(this,"_columnManager"),he(this,"_viewModel"),this._styles=n;const r={...ch,mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},rowHeader:{width:46,hidden:ke.FALSE},columnHeader:{height:20,hidden:ke.FALSE},selections:["A1"],rightToLeft:ke.FALSE,pluginMeta:{},...e};this._snapshot=r;const{columnData:i,rowData:o,cellData:s}=this._snapshot;this._sheetId=this._snapshot.id??De.generateRandomId(6),this._initialized=!1,this._cellData=new nt(s),this._rowManager=new Rj(this._snapshot,o),this._columnManager=new wj(this._snapshot,i),this._viewModel=new Dj}__interceptViewModel(e){e(this._viewModel)}getSnapshot(){return this._snapshot}getCellMatrix(){return this._cellData}getRowManager(){return this._rowManager}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}getName(){return this._snapshot.name}clone(){const{_snapshot:e}=this,n=De.deepClone(e);return new Jx(n,this._styles)}getMergeData(){return this._snapshot.mergeData}getMergedCells(e,n){const r=this._snapshot.mergeData,i=[];for(let o=0;o<r.length;o++){const s=r[o];pt.intersects({startRow:e,startColumn:n,endRow:e,endColumn:n},s)&&i.push(s)}return i.length?i:null}getMergedCell(e,n){const r=this._snapshot.mergeData;for(let i=0;i<r.length;i++){const o=r[i];if(pt.intersects({startRow:e,startColumn:n,endRow:e,endColumn:n},o))return o}return null}getCell(e,n){return e<0||n<0?null:this._viewModel.getCell(e,n)}getCellRaw(e,n){return this.getCellMatrix().getValue(e,n)}getMatrixWithMergedCells(e,n,r,i){const o=this.getCellMatrix(),s=this._snapshot.mergeData.filter(l=>pt.intersects({startRow:e,startColumn:n,endRow:r,endColumn:i},l)),a=new nt;return yS(e,r,n,i).forEach((l,u)=>{const c=o.getValue(l,u);c&&a.setValue(l,u,c)}),s.forEach(l=>{const{startColumn:u,startRow:c,endColumn:d,endRow:h}=l;yS(c,h,u,d).forEach((f,m)=>{f===c&&m===u&&a.setValue(f,m,{...o.getValue(f,m),rowSpan:h-c+1,colSpan:d-u+1}),(f!==c||m!==u)&&a.realDeleteValue(f,m)})}),a}getRange(e,n,r,i){return typeof e=="object"?new Er(this,e,{getStyles:()=>this._styles}):new Er(this,{startRow:e,startColumn:n,endColumn:i||n,endRow:r||e},{getStyles:()=>this._styles})}getStatus(){const{_snapshot:e}=this;return e.status}getZoomRatio(){return this._snapshot.zoomRatio||1}getConfig(){return this._snapshot}getFreeze(){return this._snapshot.freeze}getMaxColumns(){const{_snapshot:e}=this,{columnCount:n}=e;return n}getMaxRows(){const{_snapshot:e}=this,{rowCount:n}=e;return n}getType(){const{_snapshot:e}=this,{type:n}=e;return n}getRowCount(){return this._snapshot.rowCount}setRowCount(e){this._snapshot.rowCount=e}getColumnCount(){return this._snapshot.columnCount}setColumnCount(e){this._snapshot.columnCount=e}isSheetHidden(){return this._snapshot.hidden}hasHiddenGridlines(){const{_snapshot:e}=this,{showGridlines:n}=e;return n===0}getTabColor(){const{_snapshot:e}=this,{tabColor:n}=e;return n}getColumnWidth(e){return this.getColumnManager().getColumnWidth(e)}getRowHeight(e){return this.getRowManager().getRowHeight(e)}getRowVisible(e){return this.getRowManager().getRowVisible(e)}getHiddenRows(e,n){const r=this.getMaxColumns()-1,i=this._rowManager.getHiddenRows(e,n);return i.forEach(o=>o.endColumn=r),i}getColVisible(e){return this._columnManager.getColVisible(e)}getHiddenCols(e,n){const r=this.getMaxRows()-1,i=this._columnManager.getHiddenCols(e,n);return i.forEach(o=>o.endRow=r),i}isRightToLeft(){const{_snapshot:e}=this,{rightToLeft:n}=e;return n}getPluginMeta(e){return this._snapshot.pluginMeta[e]}setPluginMeta(e,n){this._snapshot.pluginMeta[e]=n}getLastRowWithContent(){return this._cellData.getLength()-1}getLastColumnWithContent(){return this._cellData.getRange().endColumn}cellHasValue(e){return e&&(e.v!==void 0||e.f!==void 0||e.p!==void 0)}};var Ij=Object.defineProperty,xj=Object.getOwnPropertyDescriptor,Mj=(t,e,n,r)=>{for(var i=r>1?void 0:r?xj(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Ij(e,n,i),i},Oj=(t,e)=>(n,r)=>e(n,r,t);function wS(t,e){return`${t.getUnitId()}|${e.getSheetId()}`}let hh=class extends je{constructor(e={},n){super(),he(this,"_sheetCreated$",new Qt),he(this,"sheetCreated$",this._sheetCreated$.asObservable()),he(this,"_sheetDisposed$",new Qt),he(this,"sheetDisposed$",this._sheetDisposed$.asObservable()),he(this,"_activeSheet$",new rn(null)),he(this,"activeSheet$",this._activeSheet$.asObservable()),he(this,"_worksheets"),he(this,"_styles"),he(this,"_snapshot"),he(this,"_unitId"),he(this,"_count"),this._log=n,this._snapshot=De.commonExtend(gj,e);const{styles:r}=this._snapshot;(this._snapshot.id==null||this._snapshot.id.length===0)&&(this._snapshot.id=De.generateRandomId(6)),this._unitId=this._snapshot.id,this._styles=new Sj(r),this._count=1,this._worksheets=new Map,this._getDefaultWorkSheet()}dispose(){super.dispose(),this._sheetCreated$.complete(),this._sheetDisposed$.complete(),this._activeSheet$.complete()}save(){return De.deepClone(this._snapshot)}static isIRangeType(e){return typeof e=="string"||"startRow"in e||"row"in e}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getRev(){return this._snapshot.rev??1}incrementRev(){this._snapshot.rev=this.getRev()+1}getShouldRenderLoopImmediately(){return this._snapshot.shouldStartRenderingImmediately!==!1}getContainer(){return this._snapshot.container}addWorksheet(e,n,r){const{sheets:i,sheetOrder:o}=this._snapshot;if(i[e])return!1;i[e]=r,o.splice(n,0,e);const s=new ES(r,this._styles);return this._worksheets.set(e,s),this._sheetCreated$.next(s),!0}getParentRenderUnitId(){return this._snapshot.parentRenderUnitId}getWorksheets(){return this._worksheets}getActiveSpreadsheet(){return this}getStyles(){return this._styles}getConfig(){return this._snapshot}getIndexBySheetId(e){const{sheetOrder:n}=this._snapshot;return n.findIndex(r=>r===e)}getRawActiveSheet(){const{sheetOrder:e}=this._snapshot;return e.find(n=>this._worksheets.get(n).getStatus()===ke.TRUE)}getActiveSheet(){const{sheetOrder:e}=this._snapshot,n=this.getRawActiveSheet();return n?this._worksheets.get(n):this._worksheets.get(e[0])}__setActiveSheet(e){this._activeSheet$.next(e)}getActiveSheetIndex(){const{sheetOrder:e}=this._snapshot;return e.findIndex(n=>this._worksheets.get(n).getStatus()===1)}getSheetSize(){return this._snapshot.sheetOrder.length}flush(){}getSheets(){const{sheetOrder:e}=this._snapshot;return e.map(n=>this._worksheets.get(n))}getSheetsName(){const{sheetOrder:e}=this._snapshot,n=[];return e.forEach(r=>{const i=this._worksheets.get(r);i&&n.push(i.getName())}),n}getSheetIndex(e){const{sheetOrder:n}=this._snapshot;return n.findIndex(r=>e.getSheetId()===r)}getSheetBySheetName(e){const{sheetOrder:n}=this._snapshot,r=n.find(i=>this._worksheets.get(i).getName()===e);return this._worksheets.get(r)}getSheetBySheetId(e){return this._worksheets.get(e)}getSheetByIndex(e){const{sheetOrder:n}=this._snapshot;return this._worksheets.get(n[e])}getHiddenWorksheets(){return this.getSheets().filter(e=>e.getConfig().hidden===ke.TRUE).map(e=>e.getConfig().id)}transformRangeType(e){if(typeof e=="string")return this._getCellRange(e);if(typeof e!="string"&&"row"in e){const n=e;return{sheetId:"",range:{startRow:n.row[0],startColumn:n.column[0],endRow:n.row[1],endColumn:n.column[1]}}}return typeof e!="string"&&"startRow"in e?{sheetId:"",range:e}:jf}load(e){this._snapshot=e}checkSheetName(e){return this.getSheetsName().includes(e)}uniqueSheetName(e="sheet1"){let n=e;for(;this.checkSheetName(n);)n=e+this._count,this._count++;return n}_getCellRange(e){var n,r,i,o,s;let a="",l="";if(e.indexOf("!")>-1){const f=e.split("!");a=f[0],l=f[1],a=a.replace(/\\'/g,"'").replace(/''/g,"'"),a.substring(0,1)==="'"&&a.substring(a.length-1,1)==="'"&&(a=a.substring(1,a.length-1))}else l=e;if(l.indexOf(":")===-1){const f=parseInt(l.replace(/[^0-9]/g,""),10)-1,m=De.ABCatNum(l.replace(/[^A-Za-z]/g,""));return!Number.isNaN(f)&&!Number.isNaN(m)?{sheetId:a,range:{startRow:f,endRow:f,startColumn:m,endColumn:m}}:jf}l=l.split(":");const u=[0,0],c=[0,0],d=((n=this.getSheetBySheetName(a))==null?void 0:n.getMaxRows())||((r=this.getActiveSheet())==null?void 0:r.getMaxRows()),h=((i=this.getSheetBySheetName(a))==null?void 0:i.getMaxColumns())||((o=this.getActiveSheet())==null?void 0:o.getMaxColumns());return u[0]=parseInt(l[0].replace(/[^0-9]/g,""),10)-1,u[1]=parseInt(l[1].replace(/[^0-9]/g,""),10)-1,Number.isNaN(u[0])&&(u[0]=0),Number.isNaN(u[1])&&(u[1]=d),u[0]>u[1]||(c[0]=De.ABCatNum(l[0].replace(/[^A-Za-z]/g,"")),c[1]=De.ABCatNum(l[1].replace(/[^A-Za-z]/g,"")),Number.isNaN(c[0])&&(c[0]=0),Number.isNaN(c[1])&&(c[1]=h),c[0]>c[1])?jf:{sheetId:((s=this.getSheetBySheetName(a))==null?void 0:s.getSheetId())||"",range:{startRow:u[0],endRow:u[1],startColumn:c[0],endColumn:c[1]}}}_getDefaultWorkSheet(){const{_snapshot:e,_worksheets:n}=this,{sheets:r,sheetOrder:i}=e;De.isEmptyObject(r)&&(r[ch.id]=Object.assign(ch,{status:ke.TRUE}));for(const o in r){const s=r[o],{name:a}=s;s.name=this.uniqueSheetName(a),s.name!==a&&this._log.warn(`The worksheet name ${a} is duplicated, we change it to ${s.name}`);const l=new ES(s,this._styles);n.set(o,l),i.includes(o)||i.push(o)}}};hh=Mj([Oj(1,hs)],hh);let eM=class{constructor(e){he(this,"_snapshot"),he(this,"_unitId"),this._snapshot={...yj,...e},this._unitId=this._snapshot.id??De.generateRandomId(6)}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var e;return(e=this._snapshot.body)==null?void 0:e.pages}getPageOrder(){var e;return(e=this._snapshot.body)==null?void 0:e.pageOrder}getPage(e){const n=this.getPages();return n==null?void 0:n[e]}getElementsByPage(e){var n;return(n=this.getPage(e))==null?void 0:n.pageElements}getElement(e,n){var r;return(r=this.getElementsByPage(e))==null?void 0:r[n]}getPageSize(){return this._snapshot.pageSize}addPage(){return{id:"cover_1",pageType:Qx.SLIDE,zIndex:1,title:"cover",description:"this is first page, cover",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}};const Rl="FOCUSING_SHEET",fi="FOCUSING_DOC",RS="FOCUSING_SLIDE",e4="FOCUSING_EDITOR_BUT_HIDDEN",Dr="FOCUSING_EDITOR",yu="FOCUSING_EDITOR_INPUT_FORMULA",l1="FOCUSING_FORMULA_EDITOR";var Tj=Object.defineProperty,$j=Object.getOwnPropertyDescriptor,kj=(t,e,n,r)=>{for(var i=r>1?void 0:r?$j(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Tj(e,n,i),i},Aj=(t,e)=>(n,r)=>e(n,r,t),Pr=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.DOC=1]="DOC",t[t.SHEET=2]="SHEET",t[t.SLIDE=3]="SLIDE",t))(Pr||{});const oe=nn("univer.current");let qp=class extends je{constructor(e,n){super(),he(this,"_focused",null),he(this,"_focused$",new rn(null)),he(this,"focused$",this._focused$.asObservable()),he(this,"_currentSheet$",new rn(null)),he(this,"currentSheet$",this._currentSheet$.asObservable()),he(this,"_currentDoc$",new rn(null)),he(this,"currentDoc$",this._currentDoc$.asObservable()),he(this,"_currentSlide$",new rn(null)),he(this,"currentSlide$",this._currentSlide$.asObservable()),he(this,"_sheetAdded$",new Qt),he(this,"sheetAdded$",this._sheetAdded$.asObservable()),he(this,"_docAdded$",new Qt),he(this,"docAdded$",this._docAdded$.asObservable()),he(this,"_slideAdded$",new Qt),he(this,"slideAdded$",this._slideAdded$.asObservable()),he(this,"_sheetDisposed$",new Qt),he(this,"sheetDisposed$",this._sheetDisposed$.asObservable()),he(this,"_docDisposed$",new Qt),he(this,"docDisposed$",this._docDisposed$.asObservable()),he(this,"_slideDisposed$",new Qt),he(this,"slideDisposed$",this._slideDisposed$.asObservable()),he(this,"_sheets",[]),he(this,"_docs",[]),he(this,"_slides",[]),this._handler=e,this._contextService=n}dispose(){super.dispose(),this._focused$.complete(),this._currentDoc$.complete(),this._currentSheet$.complete(),this._currentSlide$.complete(),this._sheetAdded$.complete(),this._docAdded$.complete(),this._slideAdded$.complete(),this._sheetDisposed$.complete(),this._docDisposed$.complete(),this._slideDisposed$.complete()}createDoc(e){return this._handler.createUniverDoc(e)}createSheet(e){return this._handler.createUniverSheet(e)}createSlide(e){return this._handler.createUniverSlide(e)}addSheet(e){this._sheets.push(e),this._sheetAdded$.next(e),this.setCurrentUniverSheetInstance(e.getUnitId())}changeDoc(e,n){const r=this._docs.find(i=>i.getUnitId()===e);if(r!=null){const i=this._docs.indexOf(r);this._docs.splice(i,1)}this.addDoc(n)}addDoc(e){this._docs.push(e),this._docAdded$.next(e),this.setCurrentUniverDocInstance(e.getUnitId())}addSlide(e){this._slides.push(e),this._slideAdded$.next(e),this.setCurrentUniverSlideInstance(e.getUnitId())}getUniverSheetInstance(e){return this._sheets.find(n=>n.getUnitId()===e)}getUniverDocInstance(e){return this._docs.find(n=>n.getUnitId()===e)}getUniverSlideInstance(e){return this._slides.find(n=>n.getUnitId()===e)}getAllUniverSheetsInstance(){return this._sheets}getAllUniverDocsInstance(){return this._docs}getAllUniverSlidesInstance(){return this._slides}setCurrentUniverSheetInstance(e){this._currentSheet$.next(this.getUniverSheetInstance(e)||null)}setCurrentUniverSlideInstance(e){this._currentSlide$.next(this.getUniverSlideInstance(e)||null)}setCurrentUniverDocInstance(e){this._currentDoc$.next(this.getUniverDocInstance(e)||null)}getCurrentUniverSheetInstance(){const e=this._currentSheet$.getValue();if(!e)throw new Error("No current sheet!");return e}getCurrentUniverDocInstance(){const e=this._currentDoc$.getValue();if(!e)throw new Error("No current doc!");return e}getCurrentUniverSlideInstance(){const e=this._currentSlide$.getValue();if(!e)throw new Error("No current slide!");return e}focusUniverInstance(e){e&&(this._focused=this.getUniverSheetInstance(e)||this.getUniverDocInstance(e)||this.getUniverSlideInstance(e)||null),this._focused$.next(e),[fi,Rl,RS].forEach(n=>this._contextService.setContextValue(n,!1)),this._focused instanceof hh?this._contextService.setContextValue(Rl,!0):this._focused instanceof u6?this._contextService.setContextValue(fi,!0):this._focused instanceof eM&&this._contextService.setContextValue(RS,!0)}getFocusedUniverInstance(){return this._focused}getDocumentType(e){if(this.getUniverDocInstance(e))return 1;if(this.getUniverSheetInstance(e))return 2;if(this.getUniverSlideInstance(e))return 3;throw new Error(`[UniverInstanceService]: No document with unitId ${e}`)}disposeDocument(e){const n=this.getUniverDocInstance(e);if(n){const o=this._docs.indexOf(n);return this._docs.splice(o,1),this._docDisposed$.next(n),this.focusUniverInstance(null),!0}const r=this.getUniverSheetInstance(e);if(r){const o=this._sheets.indexOf(r);return this._sheets.splice(o,1),this._sheetDisposed$.next(r),this.focusUniverInstance(null),!0}const i=this.getUniverSlideInstance(e);if(i){const o=this._slides.indexOf(i);return this._slides.splice(o,1),this._slideDisposed$.next(i),this.focusUniverInstance(null),!0}return!1}};qp=kj([Aj(1,Tr)],qp);var it=(t=>(t[t.Starting=0]="Starting",t[t.Ready=1]="Ready",t[t.Rendered=2]="Rendered",t[t.Steady=3]="Steady",t))(it||{});const DS={0:"Starting",1:"Ready",2:"Rendered",3:"Steady"},d3=new Map;function yt(t,e){return function(n){V5(t,e)}}function V5(t,e){d3.has(t)||d3.set(t,[]),d3.get(t).push(e)}var Nj=Object.defineProperty,Lj=Object.getOwnPropertyDescriptor,tM=(t,e,n,r)=>{for(var i=r>1?void 0:r?Lj(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Nj(e,n,i),i},Qp=(t,e)=>(n,r)=>e(n,r,t);let Ls=class extends je{constructor(e){super(),he(this,"_lifecycle$",new rn(it.Starting)),he(this,"lifecycle$",this._lifecycle$.asObservable()),this._logService=e,this._logService.log("[LifecycleService]",`lifecycle progressed to "${DS[it.Starting]}".`)}get stage(){return this._lifecycle$.getValue()}set stage(e){if(e<this.stage)throw new Error("[LifecycleService]: lifecycle stage cannot go backward!");e!==this.stage&&(this._logService.log("[LifecycleService]",`lifecycle progressed to "${DS[e]}".`),this._lifecycle$.next(e))}subscribeWithPrevious(){return new tn(e=>(this.stage===it.Starting||(this.stage===it.Ready?e.next(it.Starting):this.stage===it.Rendered?(e.next(it.Starting),e.next(it.Ready)):(e.next(it.Starting),e.next(it.Ready),e.next(it.Rendered))),this._lifecycle$.subscribe(e)))}};Ls=tM([Qp(0,hs)],Ls);let ul=class extends je{constructor(e,n){super(),he(this,"_started",!1),this._lifecycleService=e,this._injector=n}start(){this._started||(this._started=!0,this.disposeWithMe(Be(this._lifecycleService.subscribeWithPrevious().subscribe(e=>this.initModulesOnStage(e)))))}initModulesOnStage(e){const n=d3.get(e);n==null||n.forEach(r=>{this._injector.has(r)&&this._injector.get(r)})}};ul=tM([Qp(0,ne(Ls)),Qp(1,ne(Tn))],ul);function Pj(t,e){if(t)try{return t[e]?t[e]:e.split(".").reduce((n,r)=>n[r],t)}catch{return console.warn("Key %s not found",e),e}}let mn=class extends je{constructor(){super(),he(this,"currentLocale",F5.ZH_CN),he(this,"locales",null),he(this,"localeChanged$",new Qt),he(this,"t",e=>{if(!this.locales)throw new Error("Locale not initialized");return Pj(this.locales[this.currentLocale],e)??e}),this.disposeWithMe(Be(()=>this.localeChanged$.complete()))}load(e){this.locales=De.deepMerge(this.locales??{},e)}setLocale(e){this.currentLocale=e,this.localeChanged$.next()}getLocales(){var e;return(e=this.locales)==null?void 0:e[this.currentLocale]}getCurrentLocale(){return this.currentLocale}};const lb=nn("resource-manager-service"),Bj=nn("ResourcePersistenceService");V5(it.Ready,Bj);var Fj=Object.defineProperty,Uj=Object.getOwnPropertyDescriptor,Hj=(t,e,n,r)=>{for(var i=r>1?void 0:r?Uj(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Fj(e,n,i),i},IS=(t,e)=>(n,r)=>e(n,r,t);const ub=nn("univer.permission-service"),xS="PERMISSION";let h3=class extends je{constructor(e,n){super(),he(this,"_permissionPointMap",new Map),he(this,"deletePermissionPoint",(r,i)=>{const o=this._permissionPointMap.get(r);if(o){const s=o.get(i);s&&(s.complete(),this._permissionPointMap.delete(i))}}),he(this,"addPermissionPoint",(r,i)=>{const o=this._permissionPointMap.get(r)||new Map;return o.has(i.id)?!1:(o.set(i.id,new rn(i)),this._permissionPointMap.set(r,o),!0)}),he(this,"updatePermissionPoint",(r,i,o)=>{const s=this._permissionPointMap.get(r);if(!s)return;const a=s.get(i);if(a){const l=a.getValue();l.value=o,l.status=Nx.DONE,a.next(l)}}),he(this,"getPermissionPoint",(r,i)=>{const o=this._permissionPointMap.get(r);if(!o)return;const s=o.get(i);if(s)return s.getValue()}),this._resourceManagerService=e,this._univerInstanceService=n}_init(){this.disposeWithMe(Be(this._univerInstanceService.sheetAdded$.subscribe(e=>{this._resourceManagerService.registerPluginResource(e.getUnitId(),xS,{onChange:(n,r)=>{r.forEach(i=>{this.getPermissionPoint(n,i.id)?this.updatePermissionPoint(n,i.id,i.value):this.addPermissionPoint(n,i)})},toJson:n=>this._toJson(n),parseJson:n=>this._parseJson(n)})}))),this.disposeWithMe(Be(this._univerInstanceService.sheetDisposed$.subscribe(e=>{this._resourceManagerService.disposePluginResource(e.getUnitId(),xS)})))}_toJson(e){const n=this._permissionPointMap.get(e);let r=[];return n&&(r=[...n.keys()].reduce((i,o)=>{const s=n.get(o);return s&&i.push(s.getValue()),i},[])),JSON.stringify(r)}_parseJson(e){return JSON.parse(e)}composePermission$(e,n){const r=this._permissionPointMap.get(e),i=n.map(o=>{const s=r==null?void 0:r.get(o);if(!s)throw new Error(`${o} permissionPoint is not exist`);return s.asObservable()});return mx(i).pipe(Fs(o=>(o.every(s=>this._permissionPointMap.get(s.id)),o)))}composePermission(e,n){const r=this._permissionPointMap.get(e);return n.map(i=>{const o=r==null?void 0:r.get(i);if(!o)throw new Error(`${i} permissionPoint is not exist`);return o.getValue()})}};h3=Hj([yt(it.Starting,h3),IS(0,ne(lb)),IS(1,ne(oe))],h3);const Jp="univer.editable";let Wf=class extends Lx{constructor(e){super(),he(this,"id",Jp),he(this,"value",!0),he(this,"unitID"),this.unitID=e}};var Vj=Object.defineProperty,jj=Object.getOwnPropertyDescriptor,zj=(t,e,n,r)=>{for(var i=r>1?void 0:r?jj(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Vj(e,n,i),i},MS=(t,e)=>(n,r)=>e(n,r,t);let f3=class extends je{constructor(e,n){super(),this._permissionService=e,this._univerInstanceService=n,this._init()}_init(){this._univerInstanceService.sheetAdded$.subscribe(e=>{const n=new Wf(e.getUnitId());this._permissionService.addPermissionPoint(e.getUnitId(),n)})}getEditable(e){let n=e;n||(n=this._univerInstanceService.getCurrentUniverSheetInstance().getUnitId());const r=new Wf(n),i=this._permissionService.getPermissionPoint(n,r.id);return i==null?void 0:i.value}setEditable(e,n){const r=new Wf(e);this._permissionService.updatePermissionPoint(e,r.id,n)}};f3=zj([yt(it.Starting,f3),MS(0,ne(ub)),MS(1,ne(oe))],f3);let Wj=class extends je{constructor(){super(...arguments),he(this,"_resourceMap",new Map),he(this,"_register$",new Qt),he(this,"register$",this._register$.asObservable())}getAllResource(e){const n=this._resourceMap.get(e);return n?[...n.keys()].reduce((r,i)=>{const o=n.get(i);return o&&r.push({unitID:e,resourceName:i,hook:o}),r},[]):[]}registerPluginResource(e,n,r){const i=this._resourceMap.get(e)||new Map;if(i.has(n))throw new Error("the pluginName is registered");return i.set(n,r),this._resourceMap.set(e,i),this._register$.next({unitID:e,resourceName:n,hook:r}),Be(()=>i.delete(n))}disposePluginResource(e,n){const r=this._resourceMap.get(e);r==null||r.delete(n)}dispose(){this._register$.complete(),this._resourceMap.clear()}},Ki=class extends je{constructor(){super(),he(this,"_currentTheme"),he(this,"_currentTheme$",new rn({})),he(this,"currentTheme$",this._currentTheme$.asObservable()),this.disposeWithMe(Be(()=>this._currentTheme$.complete()))}getCurrentTheme(){if(!this._currentTheme)throw new Error("[ThemeService]: current theme is not set!");return this._currentTheme}setTheme(e){this._currentTheme=e,this._currentTheme$.next(e)}};const Zr="__defaultDocumentNormalEditorSpecialUnitId_20231006__",Un="__defaultDocumentFormulaBarEditorSpecialUnitId_20231012__",c6=`\r
`;var Xj=Object.defineProperty,Yj=Object.getOwnPropertyDescriptor,Gj=(t,e,n,r)=>{for(var i=r>1?void 0:r?Yj(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Xj(e,n,i),i},Xf=(t,e)=>(n,r)=>e(n,r,t);const At=nn("univer.undo-redo.service"),Kj=20;let eg=class extends je{constructor(e,n,r){super(),he(this,"undoRedoStatus$"),he(this,"_undoRedoStatus$",new rn({undos:0,redos:0})),he(this,"_undoStacks",new Map),he(this,"_redoStacks",new Map),this._univerInstanceService=e,this._commandService=n,this._contextService=r,this.undoRedoStatus$=this._undoRedoStatus$.asObservable(),this.disposeWithMe(this._commandService.registerCommand(cb)),this.disposeWithMe(this._commandService.registerCommand(db)),this.disposeWithMe(Be(()=>this._undoRedoStatus$.complete())),this.disposeWithMe(Be(this._univerInstanceService.focused$.subscribe(()=>this._updateStatus())))}pushUndoRedo(e){const{unitID:n}=e,r=this._getRedoStack(n,!0),i=this._getUndoStack(n,!0);r.length=0,i.push(e),i.length>Kj&&i.splice(0,1),this._updateStatus()}clearUndoRedo(e){const n=this._getRedoStack(e);n&&(n.length=0);const r=this._getUndoStack(e);r&&(r.length=0),this._updateStatus()}pitchTopUndoElement(){const e=this._getUndoStackForFocused();return e.length?e[e.length-1]:null}pitchTopRedoElement(){const e=this._getRedoStackForFocused();return e.length?e[e.length-1]:null}popUndoToRedo(){const e=this._getUndoStackForFocused().pop();e&&(this._getRedoStackForFocused().push(e),this._updateStatus())}popRedoToUndo(){const e=this._getRedoStackForFocused().pop();e&&(this._getUndoStackForFocused().push(e),this._updateStatus())}_updateStatus(){var e,n;const r=this._getFocusedUniverInstanceId(),i=r&&((e=this._undoStacks.get(r))==null?void 0:e.length)||0,o=r&&((n=this._redoStacks.get(r))==null?void 0:n.length)||0;this._undoRedoStatus$.next({undos:i,redos:o})}_getUndoStack(e,n=!1){let r=this._undoStacks.get(e);return!r&&n&&(r=[],this._undoStacks.set(e,r)),r||null}_getRedoStack(e,n=!1){let r=this._redoStacks.get(e);return!r&&n&&(r=[],this._redoStacks.set(e,r)),r||null}_getUndoStackForFocused(){const e=this._getFocusedUniverInstanceId();if(!e)throw new Error("No focused univer instance!");return this._getUndoStack(e,!0)}_getRedoStackForFocused(){const e=this._getFocusedUniverInstanceId();if(!e)throw new Error("No focused univer instance!");return this._getRedoStack(e,!0)}_getFocusedUniverInstanceId(){var e,n;let r="";const i=this._contextService.getContextValue(Rl),o=this._contextService.getContextValue(l1),s=this._contextService.getContextValue(Dr);return i?o?r=Un:s?r=Zr:r=((e=this._univerInstanceService.getFocusedUniverInstance())==null?void 0:e.getUnitId())??"":r=((n=this._univerInstanceService.getFocusedUniverInstance())==null?void 0:n.getUnitId())??"",r}};eg=Gj([Xf(0,oe),Xf(1,le),Xf(2,Tr)],eg);let nM=class{dispose(){}async dispatchToHandlers(){return!1}};const cb=new class extends nM{constructor(){super(...arguments),he(this,"type",se.COMMAND),he(this,"id","univer.command.undo")}async handler(t){const e=t.get(At),n=e.pitchTopUndoElement();if(!n)return!1;const r=t.get(le);return(n.undo?await n.undo(n.undoMutations):Xn(n.undoMutations,r))?(e.popUndoToRedo(),!0):!1}},db=new class extends nM{constructor(){super(...arguments),he(this,"type",se.COMMAND),he(this,"id","univer.command.redo")}async handler(t){const e=t.get(At),n=e.pitchTopRedoElement();if(!n)return!1;const r=t.get(le);return(n.redo?await n.redo(n.redoMutations):Xn(n.redoMutations,r))?(e.popRedoToUndo(),!0):!1}};let j5=class extends je{constructor(){super(...arguments),he(this,"_started",!1)}addPlugins(e){if(this._started){const n=e.map(([r,i])=>this._initPlugin(r,i));this._pluginsRunLifecycle(n,it.Starting),setTimeout(()=>this._takePluginsThroughLifecycle(n))}else{const n=e.map(([r,i])=>this._initPlugin(r,i));this._takePluginsThroughLifecycle(n),this._started=!0}}_takePluginsThroughLifecycle(e,n=!1){this.disposeWithMe(Be(this._lifecycleService.subscribeWithPrevious().subscribe(r=>{n&&r===it.Starting||this._pluginsRunLifecycle(e,r)})))}_pluginsRunLifecycle(e,n){e.forEach(r=>{switch(n){case it.Starting:r.onStarting(this._injector);break;case it.Ready:r.onReady();break;case it.Rendered:r.onRendered();break;case it.Steady:r.onSteady();break}}),this._lifecycleInitializerService.initModulesOnStage(n)}_initPlugin(e,n){return this._injector.createInstance(e,n)}};var Zj=Object.defineProperty,qj=Object.getOwnPropertyDescriptor,Qj=(t,e,n,r)=>{for(var i=r>1?void 0:r?qj(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Zj(e,n,i),i},Yf=(t,e)=>(n,r)=>e(n,r,t);let tg=class extends j5{constructor(e,n,r){super(),this._injector=e,this._lifecycleService=n,this._lifecycleInitializerService=r}createDoc(e){return this._injector.createInstance(u6,e)}};tg=Qj([Yf(0,ne(Tn)),Yf(1,ne(Ls)),Yf(2,ne(ul))],tg);var Jj=Object.defineProperty,ez=Object.getOwnPropertyDescriptor,tz=(t,e,n,r)=>{for(var i=r>1?void 0:r?ez(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Jj(e,n,i),i},Gf=(t,e)=>(n,r)=>e(n,r,t);let ng=class extends j5{constructor(e,n,r){super(),this._injector=e,this._lifecycleService=n,this._lifecycleInitializerService=r}createSheet(e){return this._injector.createInstance(hh,e)}};ng=tz([Gf(0,ne(Tn)),Gf(1,ne(Ls)),Gf(2,ne(ul))],ng);var nz=Object.defineProperty,rz=Object.getOwnPropertyDescriptor,iz=(t,e,n,r)=>{for(var i=r>1?void 0:r?rz(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&nz(e,n,i),i},Kf=(t,e)=>(n,r)=>e(n,r,t);let rg=class extends j5{constructor(e,n,r){super(),this._injector=e,this._lifecycleService=n,this._lifecycleInitializerService=r}createSlide(e){return this._injector.createInstance(eM,e)}};rg=iz([Kf(0,ne(Tn)),Kf(1,ne(Ls)),Kf(2,ne(ul))],rg);const oz=200;let sz=class extends j5{constructor(e={}){super(),he(this,"_injector"),he(this,"_univerPluginStore",new eV),he(this,"_univerPluginRegistry",new tV),he(this,"_univerSheet",null),he(this,"_univerDoc",null),he(this,"_univerSlide",null),he(this,"_initLazyPluginsTimer"),this._injector=this._initDependencies();const{theme:n,locale:r,locales:i,logLevel:o}=e;n&&this._injector.get(Ki).setTheme(n),i&&this._injector.get(mn).load(i),r&&this._injector.get(mn).setLocale(r),o&&this._injector.get(hs).setLogLevel(o)}get _univerInstanceService(){return this._injector.get(oe)}get _lifecycleService(){return this._injector.get(Ls)}get _lifecycleInitializerService(){return this._injector.get(ul)}__getInjector(){return this._injector}dispose(){this._injector.dispose()}setLocale(e){this._injector.get(mn).setLocale(e)}createUniverSheet(e){let n;const r=()=>{n=this._univerSheet.createSheet(e),this._univerInstanceService.addSheet(n)};if(this._univerSheet)r();else{this._tryProgressToStart();const i=this._univerSheet=this._injector.createInstance(ng),o=this._univerPluginRegistry.getRegisterPlugins(dr.Sheet).map(s=>[s.plugin,s.options]);this._univerPluginRegistry.clearPluginsOfType(dr.Sheet),i.addPlugins(o),r(),this._tryProgressToReady()}return n}createUniverDoc(e){let n;const r=()=>{n=this._univerDoc.createDoc(e),this._univerInstanceService.addDoc(n)};if(this._univerDoc)r();else{this._tryProgressToStart();const i=this._univerDoc=this._injector.createInstance(tg),o=this._univerPluginRegistry.getRegisterPlugins(dr.Doc).map(s=>[s.plugin,s.options]);this._univerPluginRegistry.clearPluginsOfType(dr.Doc),i.addPlugins(o),r(),this._tryProgressToReady()}return n}createUniverSlide(e){let n;const r=()=>{n=this._univerSlide.createSlide(e),this._univerInstanceService.addSlide(n)};if(this._univerSlide)r();else{this._tryProgressToStart();const i=this._univerSlide=this._injector.createInstance(rg),o=this._univerPluginRegistry.getRegisterPlugins(dr.Slide).map(s=>[s.plugin,s.options]);this._univerPluginRegistry.clearPluginsOfType(dr.Slide),i.addPlugins(o),r(),this._tryProgressToReady()}return n}_initDependencies(){return new Tn([[oe,{useFactory:e=>new qp({createUniverDoc:n=>this.createUniverDoc(n),createUniverSheet:n=>this.createUniverSheet(n),createUniverSlide:n=>this.createUniverSlide(n)},e),deps:[Tr]}],[q6],[mn],[Ki],[Ls],[ul],[ub,{useClass:h3}],[f3],[hs,{useClass:uV,lazy:!0}],[le,{useClass:Xp,lazy:!0}],[At,{useClass:eg,lazy:!0}],[d0,{useClass:pV}],[Tr,{useClass:lV}],[Cx,{useClass:vV,lazy:!0}],[lb,{useClass:Wj,lazy:!0}]])}_tryProgressToStart(){this._started||(this._injector.get(ul).start(),this._started=!0)}_tryProgressToReady(){this._injector.get(Ls).stage<it.Ready&&(this._injector.get(Ls).stage=it.Ready,this._univerPluginStore.forEachPlugin(e=>e.onReady()))}registerPlugin(e,n){if(e.type===dr.Univer)this._registerUniverPlugin(e,n);else if(e.type===dr.Sheet)this._registerSheetsPlugin(e,n);else if(e.type===dr.Doc)this._registerDocsPlugin(e,n);else if(e.type===dr.Slide)this._registerSlidesPlugin(e,n);else throw new Error(`Unimplemented plugin system for business: "${e.type}".`);if(this._started)return this._scheduleInitPluginAfterStarted()}_scheduleInitPluginAfterStarted(){this._initLazyPluginsTimer===void 0&&(this._initLazyPluginsTimer=setTimeout(()=>this._flushLazyPlugins(),oz))}_flushLazyPlugins(){this._initLazyPluginsTimer=void 0;const e=this._univerPluginRegistry.getRegisterPlugins(dr.Univer);if(e.length){this._univerPluginRegistry.clearPluginsOfType(dr.Univer);const n=e.map(r=>this._injector.createInstance(r.plugin,r.options));this._takePluginsThroughLifecycle(n)}if(this._univerSheet){const n=this._univerPluginRegistry.getRegisterPlugins(dr.Sheet).map(r=>[r.plugin,r.options]);n.length&&(this._univerSheet.addPlugins(n),this._univerPluginRegistry.clearPluginsOfType(dr.Sheet))}if(this._univerDoc){const n=this._univerPluginRegistry.getRegisterPlugins(dr.Doc).map(r=>[r.plugin,r.options]);n.length&&(this._univerDoc.addPlugins(n),this._univerPluginRegistry.clearPluginsOfType(dr.Doc))}if(this._univerSlide){const n=this._univerPluginRegistry.getRegisterPlugins(dr.Slide).map(r=>[r.plugin,r.options]);n.length&&(this._univerSlide.addPlugins(n),this._univerPluginRegistry.clearPluginsOfType(dr.Slide))}}_registerUniverPlugin(e,n){if(this._started)this._univerPluginRegistry.registerPlugin(e,n);else{const r=this._injector.createInstance(e,n);r.onStarting(this._injector),this._univerPluginStore.addPlugin(r)}}_registerSheetsPlugin(e,n){this._univerPluginRegistry.registerPlugin(e,n)}_registerDocsPlugin(e,n){this._univerPluginRegistry.registerPlugin(e,n)}_registerSlidesPlugin(e,n){this._univerPluginRegistry.registerPlugin(e,n)}};function rM(t){const e=new MessageChannel;let n=!1;return e.port1.onmessage=()=>{n||t()},e.port2.postMessage(null),()=>{n=!0}}const iM=nn("ILocalStorageService"),h0=t=>`sheet_interceptor_${t}`,oM=t=>function(e,n){let r=-1;function i(o,s){if(o<=r)throw new Error("[SheetInterceptorService]: next() called multiple times!");return r=o,o===t.length?s:t[o].handler(s,n,i.bind(null,o+1))}return i(0,e)};let sM=class{constructor(e){he(this,"_interceptorsByName",new Map),he(this,"_interceptorPoints"),this._interceptorPoints=e}fetchThroughInterceptors(e){const n=e,r=this._interceptorsByName.get(n);return oM(r||[])}intercept(e,n){const r=e;this._interceptorsByName.has(r)||this._interceptorsByName.set(r,[]);const i=this._interceptorsByName.get(r);return i.push(n),this._interceptorsByName.set(r,i.sort((o,s)=>(s.priority??0)-(o.priority??0))),()=>ga(this._interceptorsByName.get(r),n)}getInterceptPoints(){return this._interceptorPoints}};const OS=`'?\\[((?![\\/?:"<>|*\\\\]).)*\\]`,az=/[^0-9]/g,lz=/[^A-Za-z]/g;function uz(t){const e=t[0]==="$",n=t.substring(1).indexOf("$")>-1;return e&&n?br.ALL:e?br.COLUMN:n?br.ROW:br.NONE}function TS(t=br.NONE){let e="",n="";return t===br.ROW?e="$":t===br.COLUMN?n="$":t===br.ALL&&(e="$",n="$"),{rowAbsoluteString:e,columnAbsoluteString:n}}function L2(t){const{startColumn:e,startRow:n,endColumn:r,endRow:i,startAbsoluteRefType:o,endAbsoluteRefType:s}=t,a=TS(o),l=TS(s),u=`${a.columnAbsoluteString}${De.chatAtABC(e)}${a.rowAbsoluteString}${n+1}`,c=`${l.columnAbsoluteString}${De.chatAtABC(r)}${l.rowAbsoluteString}${i+1}`;return u===c?u:`${u}:${c}`}function cz(t,e){return`${t}!${L2(e)}`}function dz(t,e,n){return`[${t}]${e}!${L2(n)}`}function Bd(t){const{unitId:e,sheetName:n,range:r}=t;return e!=null&&e.length>0&&n!=null&&n.length>0?dz(e,n,r):n!=null&&n.length>0?cz(n,r):L2(r)}function Zf(t){const e=parseInt(t.replace(az,""))-1,n=De.ABCatNum(t.replace(lz,"")),r=uz(t);return{row:e,column:n,absoluteRefType:r}}function xa(t){const e=new RegExp(OS).exec(t);let n="";e!=null&&(n=e[0],t=t.replace(new RegExp(OS,"g"),""));const r=t.indexOf("!");let i="",o="";r>-1?(i=t.substring(0,r),o=t.substring(r)):o=t;const s=o.indexOf(":");if(s===-1){const p=Zf(o),g=p.row,v=p.column,_=p.absoluteRefType;return{unitId:n,sheetName:i,range:{startRow:g,startColumn:v,endRow:g,endColumn:v,startAbsoluteRefType:_,endAbsoluteRefType:_}}}const a=o.substring(0,s),l=o.substring(s+1),u=Zf(a),c=Zf(l),d=u.row,h=u.column,f=c.row,m=c.column;return{unitId:n,sheetName:i,range:{startRow:d,startColumn:h,endRow:f,endColumn:m,startAbsoluteRefType:u.absoluteRefType,endAbsoluteRefType:c.absoluteRefType}}}QH();function aM(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var lM={exports:{}},$n={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t4=Symbol.for("react.element"),hz=Symbol.for("react.portal"),fz=Symbol.for("react.fragment"),mz=Symbol.for("react.strict_mode"),pz=Symbol.for("react.profiler"),gz=Symbol.for("react.provider"),vz=Symbol.for("react.context"),_z=Symbol.for("react.forward_ref"),bz=Symbol.for("react.suspense"),Cz=Symbol.for("react.memo"),yz=Symbol.for("react.lazy"),$S=Symbol.iterator;function Sz(t){return t===null||typeof t!="object"?null:(t=$S&&t[$S]||t["@@iterator"],typeof t=="function"?t:null)}var uM={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},cM=Object.assign,dM={};function f0(t,e,n){this.props=t,this.context=e,this.refs=dM,this.updater=n||uM}f0.prototype.isReactComponent={};f0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};f0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function hM(){}hM.prototype=f0.prototype;function hb(t,e,n){this.props=t,this.context=e,this.refs=dM,this.updater=n||uM}var fb=hb.prototype=new hM;fb.constructor=hb;cM(fb,f0.prototype);fb.isPureReactComponent=!0;var kS=Array.isArray,fM=Object.prototype.hasOwnProperty,mb={current:null},mM={key:!0,ref:!0,__self:!0,__source:!0};function pM(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)fM.call(e,r)&&!mM.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:t4,type:t,key:o,ref:s,props:i,_owner:mb.current}}function Ez(t,e){return{$$typeof:t4,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function pb(t){return typeof t=="object"&&t!==null&&t.$$typeof===t4}function wz(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var AS=/\/+/g;function qf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?wz(""+t.key):e.toString(36)}function m3(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case t4:case hz:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+qf(s,0):r,kS(i)?(n="",t!=null&&(n=t.replace(AS,"$&/")+"/"),m3(i,e,n,"",function(u){return u})):i!=null&&(pb(i)&&(i=Ez(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(AS,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",kS(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+qf(o,a);s+=m3(o,e,n,l,i)}else if(l=Sz(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+qf(o,a++),s+=m3(o,e,n,l,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function l7(t,e,n){if(t==null)return t;var r=[],i=0;return m3(t,r,"","",function(o){return e.call(n,o,i++)}),r}function Rz(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Qi={current:null},p3={transition:null},Dz={ReactCurrentDispatcher:Qi,ReactCurrentBatchConfig:p3,ReactCurrentOwner:mb};$n.Children={map:l7,forEach:function(t,e,n){l7(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return l7(t,function(){e++}),e},toArray:function(t){return l7(t,function(e){return e})||[]},only:function(t){if(!pb(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};$n.Component=f0;$n.Fragment=fz;$n.Profiler=pz;$n.PureComponent=hb;$n.StrictMode=mz;$n.Suspense=bz;$n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Dz;$n.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=cM({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=mb.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)fM.call(e,l)&&!mM.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:t4,type:t.type,key:i,ref:o,props:r,_owner:s}};$n.createContext=function(t){return t={$$typeof:vz,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:gz,_context:t},t.Consumer=t};$n.createElement=pM;$n.createFactory=function(t){var e=pM.bind(null,t);return e.type=t,e};$n.createRef=function(){return{current:null}};$n.forwardRef=function(t){return{$$typeof:_z,render:t}};$n.isValidElement=pb;$n.lazy=function(t){return{$$typeof:yz,_payload:{_status:-1,_result:t},_init:Rz}};$n.memo=function(t,e){return{$$typeof:Cz,type:t,compare:e===void 0?null:e}};$n.startTransition=function(t){var e=p3.transition;p3.transition={};try{t()}finally{p3.transition=e}};$n.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};$n.useCallback=function(t,e){return Qi.current.useCallback(t,e)};$n.useContext=function(t){return Qi.current.useContext(t)};$n.useDebugValue=function(){};$n.useDeferredValue=function(t){return Qi.current.useDeferredValue(t)};$n.useEffect=function(t,e){return Qi.current.useEffect(t,e)};$n.useId=function(){return Qi.current.useId()};$n.useImperativeHandle=function(t,e,n){return Qi.current.useImperativeHandle(t,e,n)};$n.useInsertionEffect=function(t,e){return Qi.current.useInsertionEffect(t,e)};$n.useLayoutEffect=function(t,e){return Qi.current.useLayoutEffect(t,e)};$n.useMemo=function(t,e){return Qi.current.useMemo(t,e)};$n.useReducer=function(t,e,n){return Qi.current.useReducer(t,e,n)};$n.useRef=function(t){return Qi.current.useRef(t)};$n.useState=function(t){return Qi.current.useState(t)};$n.useSyncExternalStore=function(t,e,n){return Qi.current.useSyncExternalStore(t,e,n)};$n.useTransition=function(){return Qi.current.useTransition()};$n.version="18.2.0";lM.exports=$n;var b=lM.exports;const Qe=aM(b),Iz=yU({__proto__:null,default:Qe},[b]);function gM(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=gM(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function wi(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=gM(t))&&(r&&(r+=" "),r+=e);return r}var vM={exports:{}},zo={},_M={exports:{}},bM={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,A){var T=z.length;z.push(A);e:for(;0<T;){var P=T-1>>>1,K=z[P];if(0<i(K,A))z[P]=A,z[T]=K,T=P;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var A=z[0],T=z.pop();if(T!==A){z[0]=T;e:for(var P=0,K=z.length,ee=K>>>1;P<ee;){var ue=2*(P+1)-1,fe=z[ue],Ee=ue+1,Q=z[Ee];if(0>i(fe,T))Ee<K&&0>i(Q,fe)?(z[P]=Q,z[Ee]=T,P=Ee):(z[P]=fe,z[ue]=T,P=ue);else if(Ee<K&&0>i(Q,T))z[P]=Q,z[Ee]=T,P=Ee;else break e}}return A}function i(z,A){var T=z.sortIndex-A.sortIndex;return T!==0?T:z.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var l=[],u=[],c=1,d=null,h=3,f=!1,m=!1,p=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(z){for(var A=n(u);A!==null;){if(A.callback===null)r(u);else if(A.startTime<=z)r(u),A.sortIndex=A.expirationTime,e(l,A);else break;A=n(u)}}function y(z){if(p=!1,C(z),!m)if(n(l)!==null)m=!0,X(S);else{var A=n(u);A!==null&&te(y,A.startTime-z)}}function S(z,A){m=!1,p&&(p=!1,v(R),R=-1),f=!0;var T=h;try{for(C(A),d=n(l);d!==null&&(!(d.expirationTime>A)||z&&!k());){var P=d.callback;if(typeof P=="function"){d.callback=null,h=d.priorityLevel;var K=P(d.expirationTime<=A);A=t.unstable_now(),typeof K=="function"?d.callback=K:d===n(l)&&r(l),C(A)}else r(l);d=n(l)}if(d!==null)var ee=!0;else{var ue=n(u);ue!==null&&te(y,ue.startTime-A),ee=!1}return ee}finally{d=null,h=T,f=!1}}var E=!1,w=null,R=-1,D=5,I=-1;function k(){return!(t.unstable_now()-I<D)}function O(){if(w!==null){var z=t.unstable_now();I=z;var A=!0;try{A=w(!0,z)}finally{A?$():(E=!1,w=null)}}else E=!1}var $;if(typeof _=="function")$=function(){_(O)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,H=N.port2;N.port1.onmessage=O,$=function(){H.postMessage(null)}}else $=function(){g(O,0)};function X(z){w=z,E||(E=!0,$())}function te(z,A){R=g(function(){z(t.unstable_now())},A)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,X(S))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(z){switch(h){case 1:case 2:case 3:var A=3;break;default:A=h}var T=h;h=A;try{return z()}finally{h=T}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,A){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var T=h;h=z;try{return A()}finally{h=T}},t.unstable_scheduleCallback=function(z,A,T){var P=t.unstable_now();switch(typeof T=="object"&&T!==null?(T=T.delay,T=typeof T=="number"&&0<T?P+T:P):T=P,z){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=T+K,z={id:c++,callback:A,priorityLevel:z,startTime:T,expirationTime:K,sortIndex:-1},T>P?(z.sortIndex=T,e(u,z),n(l)===null&&z===n(u)&&(p?(v(R),R=-1):p=!0,te(y,T-P))):(z.sortIndex=K,e(l,z),m||f||(m=!0,X(S))),z},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(z){var A=h;return function(){var T=h;h=A;try{return z.apply(this,arguments)}finally{h=T}}}})(bM);_M.exports=bM;var xz=_M.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CM=b,Ho=xz;function ct(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yM=new Set,d6={};function oc(t,e){P2(t,e),P2(t+"Capture",e)}function P2(t,e){for(d6[t]=e,t=0;t<e.length;t++)yM.add(e[t])}var h1=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ig=Object.prototype.hasOwnProperty,Mz=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,NS={},LS={};function Oz(t){return ig.call(LS,t)?!0:ig.call(NS,t)?!1:Mz.test(t)?LS[t]=!0:(NS[t]=!0,!1)}function Tz(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function $z(t,e,n,r){if(e===null||typeof e>"u"||Tz(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ji(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Ri={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ri[t]=new Ji(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ri[e]=new Ji(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ri[t]=new Ji(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ri[t]=new Ji(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ri[t]=new Ji(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ri[t]=new Ji(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ri[t]=new Ji(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ri[t]=new Ji(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ri[t]=new Ji(t,5,!1,t.toLowerCase(),null,!1,!1)});var gb=/[\-:]([a-z])/g;function vb(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(gb,vb);Ri[e]=new Ji(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(gb,vb);Ri[e]=new Ji(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(gb,vb);Ri[e]=new Ji(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ri[t]=new Ji(t,1,!1,t.toLowerCase(),null,!1,!1)});Ri.xlinkHref=new Ji("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ri[t]=new Ji(t,1,!1,t.toLowerCase(),null,!0,!0)});function _b(t,e,n,r){var i=Ri.hasOwnProperty(e)?Ri[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&($z(e,n,i,r)&&(n=null),r||i===null?Oz(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var w1=CM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u7=Symbol.for("react.element"),t2=Symbol.for("react.portal"),n2=Symbol.for("react.fragment"),bb=Symbol.for("react.strict_mode"),og=Symbol.for("react.profiler"),SM=Symbol.for("react.provider"),EM=Symbol.for("react.context"),Cb=Symbol.for("react.forward_ref"),sg=Symbol.for("react.suspense"),ag=Symbol.for("react.suspense_list"),yb=Symbol.for("react.memo"),Y1=Symbol.for("react.lazy"),wM=Symbol.for("react.offscreen"),PS=Symbol.iterator;function j0(t){return t===null||typeof t!="object"?null:(t=PS&&t[PS]||t["@@iterator"],typeof t=="function"?t:null)}var $r=Object.assign,Qf;function yd(t){if(Qf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Qf=e&&e[1]||""}return`
`+Qf+t}var Jf=!1;function em(t,e){if(!t||Jf)return"";Jf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=a);break}}}finally{Jf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?yd(t):""}function kz(t){switch(t.tag){case 5:return yd(t.type);case 16:return yd("Lazy");case 13:return yd("Suspense");case 19:return yd("SuspenseList");case 0:case 2:case 15:return t=em(t.type,!1),t;case 11:return t=em(t.type.render,!1),t;case 1:return t=em(t.type,!0),t;default:return""}}function lg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case n2:return"Fragment";case t2:return"Portal";case og:return"Profiler";case bb:return"StrictMode";case sg:return"Suspense";case ag:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case EM:return(t.displayName||"Context")+".Consumer";case SM:return(t._context.displayName||"Context")+".Provider";case Cb:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case yb:return e=t.displayName||null,e!==null?e:lg(t.type)||"Memo";case Y1:e=t._payload,t=t._init;try{return lg(t(e))}catch{}}return null}function Az(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return lg(e);case 8:return e===bb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Dl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function RM(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Nz(t){var e=RM(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function c7(t){t._valueTracker||(t._valueTracker=Nz(t))}function DM(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=RM(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function fh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ug(t,e){var n=e.checked;return $r({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function BS(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Dl(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function IM(t,e){e=e.checked,e!=null&&_b(t,"checked",e,!1)}function cg(t,e){IM(t,e);var n=Dl(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?dg(t,e.type,n):e.hasOwnProperty("defaultValue")&&dg(t,e.type,Dl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function FS(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function dg(t,e,n){(e!=="number"||fh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Sd=Array.isArray;function E2(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Dl(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function hg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ct(91));return $r({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function US(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ct(92));if(Sd(n)){if(1<n.length)throw Error(ct(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Dl(n)}}function xM(t,e){var n=Dl(e.value),r=Dl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function HS(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function MM(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?MM(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var d7,OM=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(d7=d7||document.createElement("div"),d7.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=d7.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function h6(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Fd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Lz=["Webkit","ms","Moz","O"];Object.keys(Fd).forEach(function(t){Lz.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Fd[e]=Fd[t]})});function TM(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Fd.hasOwnProperty(t)&&Fd[t]?(""+e).trim():e+"px"}function $M(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=TM(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var Pz=$r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mg(t,e){if(e){if(Pz[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ct(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ct(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ct(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ct(62))}}function pg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gg=null;function Sb(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var vg=null,w2=null,R2=null;function VS(t){if(t=i4(t)){if(typeof vg!="function")throw Error(ct(280));var e=t.stateNode;e&&(e=G5(e),vg(t.stateNode,t.type,e))}}function kM(t){w2?R2?R2.push(t):R2=[t]:w2=t}function AM(){if(w2){var t=w2,e=R2;if(R2=w2=null,VS(t),e)for(t=0;t<e.length;t++)VS(e[t])}}function NM(t,e){return t(e)}function LM(){}var tm=!1;function PM(t,e,n){if(tm)return t(e,n);tm=!0;try{return NM(t,e,n)}finally{tm=!1,(w2!==null||R2!==null)&&(LM(),AM())}}function f6(t,e){var n=t.stateNode;if(n===null)return null;var r=G5(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ct(231,e,typeof n));return n}var _g=!1;if(h1)try{var z0={};Object.defineProperty(z0,"passive",{get:function(){_g=!0}}),window.addEventListener("test",z0,z0),window.removeEventListener("test",z0,z0)}catch{_g=!1}function Bz(t,e,n,r,i,o,s,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var Ud=!1,mh=null,ph=!1,bg=null,Fz={onError:function(t){Ud=!0,mh=t}};function Uz(t,e,n,r,i,o,s,a,l){Ud=!1,mh=null,Bz.apply(Fz,arguments)}function Hz(t,e,n,r,i,o,s,a,l){if(Uz.apply(this,arguments),Ud){if(Ud){var u=mh;Ud=!1,mh=null}else throw Error(ct(198));ph||(ph=!0,bg=u)}}function sc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function BM(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function jS(t){if(sc(t)!==t)throw Error(ct(188))}function Vz(t){var e=t.alternate;if(!e){if(e=sc(t),e===null)throw Error(ct(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return jS(i),t;if(o===r)return jS(i),e;o=o.sibling}throw Error(ct(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(ct(189))}}if(n.alternate!==r)throw Error(ct(190))}if(n.tag!==3)throw Error(ct(188));return n.stateNode.current===n?t:e}function FM(t){return t=Vz(t),t!==null?UM(t):null}function UM(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=UM(t);if(e!==null)return e;t=t.sibling}return null}var HM=Ho.unstable_scheduleCallback,zS=Ho.unstable_cancelCallback,jz=Ho.unstable_shouldYield,zz=Ho.unstable_requestPaint,Vr=Ho.unstable_now,Wz=Ho.unstable_getCurrentPriorityLevel,Eb=Ho.unstable_ImmediatePriority,VM=Ho.unstable_UserBlockingPriority,gh=Ho.unstable_NormalPriority,Xz=Ho.unstable_LowPriority,jM=Ho.unstable_IdlePriority,z5=null,Ca=null;function Yz(t){if(Ca&&typeof Ca.onCommitFiberRoot=="function")try{Ca.onCommitFiberRoot(z5,t,void 0,(t.current.flags&128)===128)}catch{}}var Us=Math.clz32?Math.clz32:Zz,Gz=Math.log,Kz=Math.LN2;function Zz(t){return t>>>=0,t===0?32:31-(Gz(t)/Kz|0)|0}var h7=64,f7=4194304;function Ed(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function vh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Ed(a):(o&=s,o!==0&&(r=Ed(o)))}else s=n&~i,s!==0?r=Ed(s):o!==0&&(r=Ed(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Us(e),i=1<<n,r|=t[n],e&=~i;return r}function qz(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qz(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-Us(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=qz(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function Cg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function zM(){var t=h7;return h7<<=1,!(h7&4194240)&&(h7=64),t}function nm(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function n4(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Us(e),t[e]=n}function Jz(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Us(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function wb(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Us(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var ir=0;function WM(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var XM,Rb,YM,GM,KM,yg=!1,m7=[],cl=null,dl=null,hl=null,m6=new Map,p6=new Map,K1=[],eW="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function WS(t,e){switch(t){case"focusin":case"focusout":cl=null;break;case"dragenter":case"dragleave":dl=null;break;case"mouseover":case"mouseout":hl=null;break;case"pointerover":case"pointerout":m6.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":p6.delete(e.pointerId)}}function W0(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=i4(e),e!==null&&Rb(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function tW(t,e,n,r,i){switch(e){case"focusin":return cl=W0(cl,t,e,n,r,i),!0;case"dragenter":return dl=W0(dl,t,e,n,r,i),!0;case"mouseover":return hl=W0(hl,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return m6.set(o,W0(m6.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,p6.set(o,W0(p6.get(o)||null,t,e,n,r,i)),!0}return!1}function ZM(t){var e=Su(t.target);if(e!==null){var n=sc(e);if(n!==null){if(e=n.tag,e===13){if(e=BM(n),e!==null){t.blockedOn=e,KM(t.priority,function(){YM(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function g3(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Sg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);gg=r,n.target.dispatchEvent(r),gg=null}else return e=i4(n),e!==null&&Rb(e),t.blockedOn=n,!1;e.shift()}return!0}function XS(t,e,n){g3(t)&&n.delete(e)}function nW(){yg=!1,cl!==null&&g3(cl)&&(cl=null),dl!==null&&g3(dl)&&(dl=null),hl!==null&&g3(hl)&&(hl=null),m6.forEach(XS),p6.forEach(XS)}function X0(t,e){t.blockedOn===e&&(t.blockedOn=null,yg||(yg=!0,Ho.unstable_scheduleCallback(Ho.unstable_NormalPriority,nW)))}function g6(t){function e(i){return X0(i,t)}if(0<m7.length){X0(m7[0],t);for(var n=1;n<m7.length;n++){var r=m7[n];r.blockedOn===t&&(r.blockedOn=null)}}for(cl!==null&&X0(cl,t),dl!==null&&X0(dl,t),hl!==null&&X0(hl,t),m6.forEach(e),p6.forEach(e),n=0;n<K1.length;n++)r=K1[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<K1.length&&(n=K1[0],n.blockedOn===null);)ZM(n),n.blockedOn===null&&K1.shift()}var D2=w1.ReactCurrentBatchConfig,_h=!0;function rW(t,e,n,r){var i=ir,o=D2.transition;D2.transition=null;try{ir=1,Db(t,e,n,r)}finally{ir=i,D2.transition=o}}function iW(t,e,n,r){var i=ir,o=D2.transition;D2.transition=null;try{ir=4,Db(t,e,n,r)}finally{ir=i,D2.transition=o}}function Db(t,e,n,r){if(_h){var i=Sg(t,e,n,r);if(i===null)hm(t,e,r,bh,n),WS(t,r);else if(tW(i,t,e,n,r))r.stopPropagation();else if(WS(t,r),e&4&&-1<eW.indexOf(t)){for(;i!==null;){var o=i4(i);if(o!==null&&XM(o),o=Sg(t,e,n,r),o===null&&hm(t,e,r,bh,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else hm(t,e,r,null,n)}}var bh=null;function Sg(t,e,n,r){if(bh=null,t=Sb(r),t=Su(t),t!==null)if(e=sc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=BM(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return bh=t,null}function qM(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wz()){case Eb:return 1;case VM:return 4;case gh:case Xz:return 16;case jM:return 536870912;default:return 16}default:return 16}}var Q1=null,Ib=null,v3=null;function QM(){if(v3)return v3;var t,e=Ib,n=e.length,r,i="value"in Q1?Q1.value:Q1.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return v3=i.slice(t,1<r?1-r:void 0)}function _3(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function p7(){return!0}function YS(){return!1}function Wo(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?p7:YS,this.isPropagationStopped=YS,this}return $r(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=p7)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=p7)},persist:function(){},isPersistent:p7}),e}var m0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xb=Wo(m0),r4=$r({},m0,{view:0,detail:0}),oW=Wo(r4),rm,im,Y0,W5=$r({},r4,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mb,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Y0&&(Y0&&t.type==="mousemove"?(rm=t.screenX-Y0.screenX,im=t.screenY-Y0.screenY):im=rm=0,Y0=t),rm)},movementY:function(t){return"movementY"in t?t.movementY:im}}),GS=Wo(W5),sW=$r({},W5,{dataTransfer:0}),aW=Wo(sW),lW=$r({},r4,{relatedTarget:0}),om=Wo(lW),uW=$r({},m0,{animationName:0,elapsedTime:0,pseudoElement:0}),cW=Wo(uW),dW=$r({},m0,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),hW=Wo(dW),fW=$r({},m0,{data:0}),KS=Wo(fW),mW={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vW(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=gW[t])?!!e[t]:!1}function Mb(){return vW}var _W=$r({},r4,{key:function(t){if(t.key){var e=mW[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=_3(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?pW[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mb,charCode:function(t){return t.type==="keypress"?_3(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?_3(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),bW=Wo(_W),CW=$r({},W5,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ZS=Wo(CW),yW=$r({},r4,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mb}),SW=Wo(yW),EW=$r({},m0,{propertyName:0,elapsedTime:0,pseudoElement:0}),wW=Wo(EW),RW=$r({},W5,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),DW=Wo(RW),IW=[9,13,27,32],Ob=h1&&"CompositionEvent"in window,Hd=null;h1&&"documentMode"in document&&(Hd=document.documentMode);var xW=h1&&"TextEvent"in window&&!Hd,JM=h1&&(!Ob||Hd&&8<Hd&&11>=Hd),qS=String.fromCharCode(32),QS=!1;function eO(t,e){switch(t){case"keyup":return IW.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tO(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var r2=!1;function MW(t,e){switch(t){case"compositionend":return tO(e);case"keypress":return e.which!==32?null:(QS=!0,qS);case"textInput":return t=e.data,t===qS&&QS?null:t;default:return null}}function OW(t,e){if(r2)return t==="compositionend"||!Ob&&eO(t,e)?(t=QM(),v3=Ib=Q1=null,r2=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return JM&&e.locale!=="ko"?null:e.data;default:return null}}var TW={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function JS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!TW[t.type]:e==="textarea"}function nO(t,e,n,r){kM(r),e=Ch(e,"onChange"),0<e.length&&(n=new xb("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Vd=null,v6=null;function $W(t){fO(t,0)}function X5(t){var e=s2(t);if(DM(e))return t}function kW(t,e){if(t==="change")return e}var rO=!1;if(h1){var sm;if(h1){var am="oninput"in document;if(!am){var eE=document.createElement("div");eE.setAttribute("oninput","return;"),am=typeof eE.oninput=="function"}sm=am}else sm=!1;rO=sm&&(!document.documentMode||9<document.documentMode)}function tE(){Vd&&(Vd.detachEvent("onpropertychange",iO),v6=Vd=null)}function iO(t){if(t.propertyName==="value"&&X5(v6)){var e=[];nO(e,v6,t,Sb(t)),PM($W,e)}}function AW(t,e,n){t==="focusin"?(tE(),Vd=e,v6=n,Vd.attachEvent("onpropertychange",iO)):t==="focusout"&&tE()}function NW(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return X5(v6)}function LW(t,e){if(t==="click")return X5(e)}function PW(t,e){if(t==="input"||t==="change")return X5(e)}function BW(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ys=typeof Object.is=="function"?Object.is:BW;function _6(t,e){if(Ys(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!ig.call(e,i)||!Ys(t[i],e[i]))return!1}return!0}function nE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function rE(t,e){var n=nE(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=nE(n)}}function oO(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?oO(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function sO(){for(var t=window,e=fh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=fh(t.document)}return e}function Tb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function FW(t){var e=sO(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&oO(n.ownerDocument.documentElement,n)){if(r!==null&&Tb(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=rE(n,o);var s=rE(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var UW=h1&&"documentMode"in document&&11>=document.documentMode,i2=null,Eg=null,jd=null,wg=!1;function iE(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;wg||i2==null||i2!==fh(r)||(r=i2,"selectionStart"in r&&Tb(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),jd&&_6(jd,r)||(jd=r,r=Ch(Eg,"onSelect"),0<r.length&&(e=new xb("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=i2)))}function g7(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var o2={animationend:g7("Animation","AnimationEnd"),animationiteration:g7("Animation","AnimationIteration"),animationstart:g7("Animation","AnimationStart"),transitionend:g7("Transition","TransitionEnd")},lm={},aO={};h1&&(aO=document.createElement("div").style,"AnimationEvent"in window||(delete o2.animationend.animation,delete o2.animationiteration.animation,delete o2.animationstart.animation),"TransitionEvent"in window||delete o2.transitionend.transition);function Y5(t){if(lm[t])return lm[t];if(!o2[t])return t;var e=o2[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in aO)return lm[t]=e[n];return t}var lO=Y5("animationend"),uO=Y5("animationiteration"),cO=Y5("animationstart"),dO=Y5("transitionend"),hO=new Map,oE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fl(t,e){hO.set(t,e),oc(e,[t])}for(var um=0;um<oE.length;um++){var cm=oE[um],HW=cm.toLowerCase(),VW=cm[0].toUpperCase()+cm.slice(1);Fl(HW,"on"+VW)}Fl(lO,"onAnimationEnd");Fl(uO,"onAnimationIteration");Fl(cO,"onAnimationStart");Fl("dblclick","onDoubleClick");Fl("focusin","onFocus");Fl("focusout","onBlur");Fl(dO,"onTransitionEnd");P2("onMouseEnter",["mouseout","mouseover"]);P2("onMouseLeave",["mouseout","mouseover"]);P2("onPointerEnter",["pointerout","pointerover"]);P2("onPointerLeave",["pointerout","pointerover"]);oc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));oc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));oc("onBeforeInput",["compositionend","keypress","textInput","paste"]);oc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));oc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));oc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jW=new Set("cancel close invalid load scroll toggle".split(" ").concat(wd));function sE(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Hz(r,e,void 0,t),t.currentTarget=null}function fO(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;sE(i,a,u),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;sE(i,a,u),o=l}}}if(ph)throw t=bg,ph=!1,bg=null,t}function _r(t,e){var n=e[Mg];n===void 0&&(n=e[Mg]=new Set);var r=t+"__bubble";n.has(r)||(mO(e,t,2,!1),n.add(r))}function dm(t,e,n){var r=0;e&&(r|=4),mO(n,t,r,e)}var v7="_reactListening"+Math.random().toString(36).slice(2);function b6(t){if(!t[v7]){t[v7]=!0,yM.forEach(function(n){n!=="selectionchange"&&(jW.has(n)||dm(n,!1,t),dm(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[v7]||(e[v7]=!0,dm("selectionchange",!1,e))}}function mO(t,e,n,r){switch(qM(e)){case 1:var i=rW;break;case 4:i=iW;break;default:i=Db}n=i.bind(null,e,n,t),i=void 0,!_g||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function hm(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Su(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}PM(function(){var u=o,c=Sb(n),d=[];e:{var h=hO.get(t);if(h!==void 0){var f=xb,m=t;switch(t){case"keypress":if(_3(n)===0)break e;case"keydown":case"keyup":f=bW;break;case"focusin":m="focus",f=om;break;case"focusout":m="blur",f=om;break;case"beforeblur":case"afterblur":f=om;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=GS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=aW;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=SW;break;case lO:case uO:case cO:f=cW;break;case dO:f=wW;break;case"scroll":f=oW;break;case"wheel":f=DW;break;case"copy":case"cut":case"paste":f=hW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=ZS}var p=(e&4)!==0,g=!p&&t==="scroll",v=p?h!==null?h+"Capture":null:h;p=[];for(var _=u,C;_!==null;){C=_;var y=C.stateNode;if(C.tag===5&&y!==null&&(C=y,v!==null&&(y=f6(_,v),y!=null&&p.push(C6(_,y,C)))),g)break;_=_.return}0<p.length&&(h=new f(h,m,null,n,c),d.push({event:h,listeners:p}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==gg&&(m=n.relatedTarget||n.fromElement)&&(Su(m)||m[f1]))break e;if((f||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,f?(m=n.relatedTarget||n.toElement,f=u,m=m?Su(m):null,m!==null&&(g=sc(m),m!==g||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=u),f!==m)){if(p=GS,y="onMouseLeave",v="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(p=ZS,y="onPointerLeave",v="onPointerEnter",_="pointer"),g=f==null?h:s2(f),C=m==null?h:s2(m),h=new p(y,_+"leave",f,n,c),h.target=g,h.relatedTarget=C,y=null,Su(c)===u&&(p=new p(v,_+"enter",m,n,c),p.target=C,p.relatedTarget=g,y=p),g=y,f&&m)t:{for(p=f,v=m,_=0,C=p;C;C=Sc(C))_++;for(C=0,y=v;y;y=Sc(y))C++;for(;0<_-C;)p=Sc(p),_--;for(;0<C-_;)v=Sc(v),C--;for(;_--;){if(p===v||v!==null&&p===v.alternate)break t;p=Sc(p),v=Sc(v)}p=null}else p=null;f!==null&&aE(d,h,f,p,!1),m!==null&&g!==null&&aE(d,g,m,p,!0)}}e:{if(h=u?s2(u):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var S=kW;else if(JS(h))if(rO)S=PW;else{S=NW;var E=AW}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=LW);if(S&&(S=S(t,u))){nO(d,S,n,c);break e}E&&E(t,h,u),t==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&dg(h,"number",h.value)}switch(E=u?s2(u):window,t){case"focusin":(JS(E)||E.contentEditable==="true")&&(i2=E,Eg=u,jd=null);break;case"focusout":jd=Eg=i2=null;break;case"mousedown":wg=!0;break;case"contextmenu":case"mouseup":case"dragend":wg=!1,iE(d,n,c);break;case"selectionchange":if(UW)break;case"keydown":case"keyup":iE(d,n,c)}var w;if(Ob)e:{switch(t){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else r2?eO(t,n)&&(R="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(JM&&n.locale!=="ko"&&(r2||R!=="onCompositionStart"?R==="onCompositionEnd"&&r2&&(w=QM()):(Q1=c,Ib="value"in Q1?Q1.value:Q1.textContent,r2=!0)),E=Ch(u,R),0<E.length&&(R=new KS(R,t,null,n,c),d.push({event:R,listeners:E}),w?R.data=w:(w=tO(n),w!==null&&(R.data=w)))),(w=xW?MW(t,n):OW(t,n))&&(u=Ch(u,"onBeforeInput"),0<u.length&&(c=new KS("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=w))}fO(d,e)})}function C6(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ch(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=f6(t,n),o!=null&&r.unshift(C6(t,o,i)),o=f6(t,e),o!=null&&r.push(C6(t,o,i))),t=t.return}return r}function Sc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function aE(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=f6(n,o),l!=null&&s.unshift(C6(n,l,a))):i||(l=f6(n,o),l!=null&&s.push(C6(n,l,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var zW=/\r\n?/g,WW=/\u0000|\uFFFD/g;function lE(t){return(typeof t=="string"?t:""+t).replace(zW,`
`).replace(WW,"")}function _7(t,e,n){if(e=lE(e),lE(t)!==e&&n)throw Error(ct(425))}function yh(){}var Rg=null,Dg=null;function Ig(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var xg=typeof setTimeout=="function"?setTimeout:void 0,XW=typeof clearTimeout=="function"?clearTimeout:void 0,uE=typeof Promise=="function"?Promise:void 0,YW=typeof queueMicrotask=="function"?queueMicrotask:typeof uE<"u"?function(t){return uE.resolve(null).then(t).catch(GW)}:xg;function GW(t){setTimeout(function(){throw t})}function fm(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),g6(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);g6(e)}function fl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function cE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var p0=Math.random().toString(36).slice(2),pa="__reactFiber$"+p0,y6="__reactProps$"+p0,f1="__reactContainer$"+p0,Mg="__reactEvents$"+p0,KW="__reactListeners$"+p0,ZW="__reactHandles$"+p0;function Su(t){var e=t[pa];if(e)return e;for(var n=t.parentNode;n;){if(e=n[f1]||n[pa]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=cE(t);t!==null;){if(n=t[pa])return n;t=cE(t)}return e}t=n,n=t.parentNode}return null}function i4(t){return t=t[pa]||t[f1],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function s2(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ct(33))}function G5(t){return t[y6]||null}var Og=[],a2=-1;function Ul(t){return{current:t}}function Sr(t){0>a2||(t.current=Og[a2],Og[a2]=null,a2--)}function fr(t,e){a2++,Og[a2]=t.current,t.current=e}var Il={},Pi=Ul(Il),mo=Ul(!1),Hu=Il;function B2(t,e){var n=t.type.contextTypes;if(!n)return Il;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function po(t){return t=t.childContextTypes,t!=null}function Sh(){Sr(mo),Sr(Pi)}function dE(t,e,n){if(Pi.current!==Il)throw Error(ct(168));fr(Pi,e),fr(mo,n)}function pO(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ct(108,Az(t)||"Unknown",i));return $r({},n,r)}function Eh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Il,Hu=Pi.current,fr(Pi,t),fr(mo,mo.current),!0}function hE(t,e,n){var r=t.stateNode;if(!r)throw Error(ct(169));n?(t=pO(t,e,Hu),r.__reactInternalMemoizedMergedChildContext=t,Sr(mo),Sr(Pi),fr(Pi,t)):Sr(mo),fr(mo,n)}var t1=null,K5=!1,mm=!1;function gO(t){t1===null?t1=[t]:t1.push(t)}function qW(t){K5=!0,gO(t)}function Hl(){if(!mm&&t1!==null){mm=!0;var t=0,e=ir;try{var n=t1;for(ir=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}t1=null,K5=!1}catch(i){throw t1!==null&&(t1=t1.slice(t+1)),HM(Eb,Hl),i}finally{ir=e,mm=!1}}return null}var l2=[],u2=0,wh=null,Rh=0,Jo=[],es=0,Vu=null,i1=1,o1="";function cu(t,e){l2[u2++]=Rh,l2[u2++]=wh,wh=t,Rh=e}function vO(t,e,n){Jo[es++]=i1,Jo[es++]=o1,Jo[es++]=Vu,Vu=t;var r=i1;t=o1;var i=32-Us(r)-1;r&=~(1<<i),n+=1;var o=32-Us(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,i1=1<<32-Us(e)+i|n<<i|r,o1=o+t}else i1=1<<o|n<<i|r,o1=t}function $b(t){t.return!==null&&(cu(t,1),vO(t,1,0))}function kb(t){for(;t===wh;)wh=l2[--u2],l2[u2]=null,Rh=l2[--u2],l2[u2]=null;for(;t===Vu;)Vu=Jo[--es],Jo[es]=null,o1=Jo[--es],Jo[es]=null,i1=Jo[--es],Jo[es]=null}var Po=null,No=null,Rr=!1,$s=null;function _O(t,e){var n=as(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function fE(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Po=t,No=fl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Po=t,No=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Vu!==null?{id:i1,overflow:o1}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=as(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Po=t,No=null,!0):!1;default:return!1}}function Tg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function $g(t){if(Rr){var e=No;if(e){var n=e;if(!fE(t,e)){if(Tg(t))throw Error(ct(418));e=fl(n.nextSibling);var r=Po;e&&fE(t,e)?_O(r,n):(t.flags=t.flags&-4097|2,Rr=!1,Po=t)}}else{if(Tg(t))throw Error(ct(418));t.flags=t.flags&-4097|2,Rr=!1,Po=t}}}function mE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Po=t}function b7(t){if(t!==Po)return!1;if(!Rr)return mE(t),Rr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ig(t.type,t.memoizedProps)),e&&(e=No)){if(Tg(t))throw bO(),Error(ct(418));for(;e;)_O(t,e),e=fl(e.nextSibling)}if(mE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ct(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){No=fl(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}No=null}}else No=Po?fl(t.stateNode.nextSibling):null;return!0}function bO(){for(var t=No;t;)t=fl(t.nextSibling)}function F2(){No=Po=null,Rr=!1}function Ab(t){$s===null?$s=[t]:$s.push(t)}var QW=w1.ReactCurrentBatchConfig;function Ds(t,e){if(t&&t.defaultProps){e=$r({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Dh=Ul(null),Ih=null,c2=null,Nb=null;function Lb(){Nb=c2=Ih=null}function Pb(t){var e=Dh.current;Sr(Dh),t._currentValue=e}function kg(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function I2(t,e){Ih=t,Nb=c2=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ho=!0),t.firstContext=null)}function fs(t){var e=t._currentValue;if(Nb!==t)if(t={context:t,memoizedValue:e,next:null},c2===null){if(Ih===null)throw Error(ct(308));c2=t,Ih.dependencies={lanes:0,firstContext:t}}else c2=c2.next=t;return e}var Eu=null;function Bb(t){Eu===null?Eu=[t]:Eu.push(t)}function CO(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Bb(e)):(n.next=i.next,i.next=n),e.interleaved=n,m1(t,r)}function m1(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var G1=!1;function Fb(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yO(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function u1(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ml(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,zn&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,m1(t,n)}return i=r.interleaved,i===null?(e.next=e,Bb(r)):(e.next=i.next,i.next=e),r.interleaved=e,m1(t,n)}function b3(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,wb(t,n)}}function pE(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function xh(t,e,n,r){var i=t.updateQueue;G1=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,s===null?o=u:s.next=u,s=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==s&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(o!==null){var d=i.baseState;s=0,c=u=l=null,a=o;do{var h=a.lane,f=a.eventTime;if((r&h)===h){c!==null&&(c=c.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,p=a;switch(h=e,f=n,p.tag){case 1:if(m=p.payload,typeof m=="function"){d=m.call(f,d,h);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,h=typeof m=="function"?m.call(f,d,h):m,h==null)break e;d=$r({},d,h);break e;case 2:G1=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=f,l=d):c=c.next=f,s|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(c===null&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);zu|=s,t.lanes=s,t.memoizedState=d}}function gE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ct(191,i));i.call(r)}}}var SO=new CM.Component().refs;function Ag(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:$r({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Z5={isMounted:function(t){return(t=t._reactInternals)?sc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Gi(),i=gl(t),o=u1(r,i);o.payload=e,n!=null&&(o.callback=n),e=ml(t,o,i),e!==null&&(Hs(e,t,i,r),b3(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Gi(),i=gl(t),o=u1(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=ml(t,o,i),e!==null&&(Hs(e,t,i,r),b3(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Gi(),r=gl(t),i=u1(n,r);i.tag=2,e!=null&&(i.callback=e),e=ml(t,i,r),e!==null&&(Hs(e,t,r,n),b3(e,t,r))}};function vE(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!_6(n,r)||!_6(i,o):!0}function EO(t,e,n){var r=!1,i=Il,o=e.contextType;return typeof o=="object"&&o!==null?o=fs(o):(i=po(e)?Hu:Pi.current,r=e.contextTypes,o=(r=r!=null)?B2(t,i):Il),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Z5,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function _E(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Z5.enqueueReplaceState(e,e.state,null)}function Ng(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=SO,Fb(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=fs(o):(o=po(e)?Hu:Pi.current,i.context=B2(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Ag(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Z5.enqueueReplaceState(i,i.state,null),xh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function G0(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ct(309));var r=n.stateNode}if(!r)throw Error(ct(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;a===SO&&(a=i.refs={}),s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(ct(284));if(!n._owner)throw Error(ct(290,t))}return t}function C7(t,e){throw t=Object.prototype.toString.call(e),Error(ct(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function bE(t){var e=t._init;return e(t._payload)}function wO(t){function e(v,_){if(t){var C=v.deletions;C===null?(v.deletions=[_],v.flags|=16):C.push(_)}}function n(v,_){if(!t)return null;for(;_!==null;)e(v,_),_=_.sibling;return null}function r(v,_){for(v=new Map;_!==null;)_.key!==null?v.set(_.key,_):v.set(_.index,_),_=_.sibling;return v}function i(v,_){return v=vl(v,_),v.index=0,v.sibling=null,v}function o(v,_,C){return v.index=C,t?(C=v.alternate,C!==null?(C=C.index,C<_?(v.flags|=2,_):C):(v.flags|=2,_)):(v.flags|=1048576,_)}function s(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,_,C,y){return _===null||_.tag!==6?(_=ym(C,v.mode,y),_.return=v,_):(_=i(_,C),_.return=v,_)}function l(v,_,C,y){var S=C.type;return S===n2?c(v,_,C.props.children,y,C.key):_!==null&&(_.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Y1&&bE(S)===_.type)?(y=i(_,C.props),y.ref=G0(v,_,C),y.return=v,y):(y=R3(C.type,C.key,C.props,null,v.mode,y),y.ref=G0(v,_,C),y.return=v,y)}function u(v,_,C,y){return _===null||_.tag!==4||_.stateNode.containerInfo!==C.containerInfo||_.stateNode.implementation!==C.implementation?(_=Sm(C,v.mode,y),_.return=v,_):(_=i(_,C.children||[]),_.return=v,_)}function c(v,_,C,y,S){return _===null||_.tag!==7?(_=$u(C,v.mode,y,S),_.return=v,_):(_=i(_,C),_.return=v,_)}function d(v,_,C){if(typeof _=="string"&&_!==""||typeof _=="number")return _=ym(""+_,v.mode,C),_.return=v,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case u7:return C=R3(_.type,_.key,_.props,null,v.mode,C),C.ref=G0(v,null,_),C.return=v,C;case t2:return _=Sm(_,v.mode,C),_.return=v,_;case Y1:var y=_._init;return d(v,y(_._payload),C)}if(Sd(_)||j0(_))return _=$u(_,v.mode,C,null),_.return=v,_;C7(v,_)}return null}function h(v,_,C,y){var S=_!==null?_.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return S!==null?null:a(v,_,""+C,y);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case u7:return C.key===S?l(v,_,C,y):null;case t2:return C.key===S?u(v,_,C,y):null;case Y1:return S=C._init,h(v,_,S(C._payload),y)}if(Sd(C)||j0(C))return S!==null?null:c(v,_,C,y,null);C7(v,C)}return null}function f(v,_,C,y,S){if(typeof y=="string"&&y!==""||typeof y=="number")return v=v.get(C)||null,a(_,v,""+y,S);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case u7:return v=v.get(y.key===null?C:y.key)||null,l(_,v,y,S);case t2:return v=v.get(y.key===null?C:y.key)||null,u(_,v,y,S);case Y1:var E=y._init;return f(v,_,C,E(y._payload),S)}if(Sd(y)||j0(y))return v=v.get(C)||null,c(_,v,y,S,null);C7(_,y)}return null}function m(v,_,C,y){for(var S=null,E=null,w=_,R=_=0,D=null;w!==null&&R<C.length;R++){w.index>R?(D=w,w=null):D=w.sibling;var I=h(v,w,C[R],y);if(I===null){w===null&&(w=D);break}t&&w&&I.alternate===null&&e(v,w),_=o(I,_,R),E===null?S=I:E.sibling=I,E=I,w=D}if(R===C.length)return n(v,w),Rr&&cu(v,R),S;if(w===null){for(;R<C.length;R++)w=d(v,C[R],y),w!==null&&(_=o(w,_,R),E===null?S=w:E.sibling=w,E=w);return Rr&&cu(v,R),S}for(w=r(v,w);R<C.length;R++)D=f(w,v,R,C[R],y),D!==null&&(t&&D.alternate!==null&&w.delete(D.key===null?R:D.key),_=o(D,_,R),E===null?S=D:E.sibling=D,E=D);return t&&w.forEach(function(k){return e(v,k)}),Rr&&cu(v,R),S}function p(v,_,C,y){var S=j0(C);if(typeof S!="function")throw Error(ct(150));if(C=S.call(C),C==null)throw Error(ct(151));for(var E=S=null,w=_,R=_=0,D=null,I=C.next();w!==null&&!I.done;R++,I=C.next()){w.index>R?(D=w,w=null):D=w.sibling;var k=h(v,w,I.value,y);if(k===null){w===null&&(w=D);break}t&&w&&k.alternate===null&&e(v,w),_=o(k,_,R),E===null?S=k:E.sibling=k,E=k,w=D}if(I.done)return n(v,w),Rr&&cu(v,R),S;if(w===null){for(;!I.done;R++,I=C.next())I=d(v,I.value,y),I!==null&&(_=o(I,_,R),E===null?S=I:E.sibling=I,E=I);return Rr&&cu(v,R),S}for(w=r(v,w);!I.done;R++,I=C.next())I=f(w,v,R,I.value,y),I!==null&&(t&&I.alternate!==null&&w.delete(I.key===null?R:I.key),_=o(I,_,R),E===null?S=I:E.sibling=I,E=I);return t&&w.forEach(function(O){return e(v,O)}),Rr&&cu(v,R),S}function g(v,_,C,y){if(typeof C=="object"&&C!==null&&C.type===n2&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case u7:e:{for(var S=C.key,E=_;E!==null;){if(E.key===S){if(S=C.type,S===n2){if(E.tag===7){n(v,E.sibling),_=i(E,C.props.children),_.return=v,v=_;break e}}else if(E.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Y1&&bE(S)===E.type){n(v,E.sibling),_=i(E,C.props),_.ref=G0(v,E,C),_.return=v,v=_;break e}n(v,E);break}else e(v,E);E=E.sibling}C.type===n2?(_=$u(C.props.children,v.mode,y,C.key),_.return=v,v=_):(y=R3(C.type,C.key,C.props,null,v.mode,y),y.ref=G0(v,_,C),y.return=v,v=y)}return s(v);case t2:e:{for(E=C.key;_!==null;){if(_.key===E)if(_.tag===4&&_.stateNode.containerInfo===C.containerInfo&&_.stateNode.implementation===C.implementation){n(v,_.sibling),_=i(_,C.children||[]),_.return=v,v=_;break e}else{n(v,_);break}else e(v,_);_=_.sibling}_=Sm(C,v.mode,y),_.return=v,v=_}return s(v);case Y1:return E=C._init,g(v,_,E(C._payload),y)}if(Sd(C))return m(v,_,C,y);if(j0(C))return p(v,_,C,y);C7(v,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,_!==null&&_.tag===6?(n(v,_.sibling),_=i(_,C),_.return=v,v=_):(n(v,_),_=ym(C,v.mode,y),_.return=v,v=_),s(v)):n(v,_)}return g}var U2=wO(!0),RO=wO(!1),o4={},ya=Ul(o4),S6=Ul(o4),E6=Ul(o4);function wu(t){if(t===o4)throw Error(ct(174));return t}function Ub(t,e){switch(fr(E6,e),fr(S6,t),fr(ya,o4),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:fg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=fg(e,t)}Sr(ya),fr(ya,e)}function H2(){Sr(ya),Sr(S6),Sr(E6)}function DO(t){wu(E6.current);var e=wu(ya.current),n=fg(e,t.type);e!==n&&(fr(S6,t),fr(ya,n))}function Hb(t){S6.current===t&&(Sr(ya),Sr(S6))}var xr=Ul(0);function Mh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var pm=[];function Vb(){for(var t=0;t<pm.length;t++)pm[t]._workInProgressVersionPrimary=null;pm.length=0}var C3=w1.ReactCurrentDispatcher,gm=w1.ReactCurrentBatchConfig,ju=0,Or=null,ni=null,ui=null,Oh=!1,zd=!1,w6=0,JW=0;function Mi(){throw Error(ct(321))}function jb(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ys(t[n],e[n]))return!1;return!0}function zb(t,e,n,r,i,o){if(ju=o,Or=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,C3.current=t===null||t.memoizedState===null?rX:iX,t=n(r,i),zd){o=0;do{if(zd=!1,w6=0,25<=o)throw Error(ct(301));o+=1,ui=ni=null,e.updateQueue=null,C3.current=oX,t=n(r,i)}while(zd)}if(C3.current=Th,e=ni!==null&&ni.next!==null,ju=0,ui=ni=Or=null,Oh=!1,e)throw Error(ct(300));return t}function Wb(){var t=w6!==0;return w6=0,t}function ua(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ui===null?Or.memoizedState=ui=t:ui=ui.next=t,ui}function ms(){if(ni===null){var t=Or.alternate;t=t!==null?t.memoizedState:null}else t=ni.next;var e=ui===null?Or.memoizedState:ui.next;if(e!==null)ui=e,ni=t;else{if(t===null)throw Error(ct(310));ni=t,t={memoizedState:ni.memoizedState,baseState:ni.baseState,baseQueue:ni.baseQueue,queue:ni.queue,next:null},ui===null?Or.memoizedState=ui=t:ui=ui.next=t}return ui}function R6(t,e){return typeof e=="function"?e(t):e}function vm(t){var e=ms(),n=e.queue;if(n===null)throw Error(ct(311));n.lastRenderedReducer=t;var r=ni,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,u=o;do{var c=u.lane;if((ju&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,s=r):l=l.next=d,Or.lanes|=c,zu|=c}u=u.next}while(u!==null&&u!==o);l===null?s=r:l.next=a,Ys(r,e.memoizedState)||(ho=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,Or.lanes|=o,zu|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function _m(t){var e=ms(),n=e.queue;if(n===null)throw Error(ct(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);Ys(o,e.memoizedState)||(ho=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function IO(){}function xO(t,e){var n=Or,r=ms(),i=e(),o=!Ys(r.memoizedState,i);if(o&&(r.memoizedState=i,ho=!0),r=r.queue,Xb(TO.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||ui!==null&&ui.memoizedState.tag&1){if(n.flags|=2048,D6(9,OO.bind(null,n,r,i,e),void 0,null),hi===null)throw Error(ct(349));ju&30||MO(n,e,i)}return i}function MO(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Or.updateQueue,e===null?(e={lastEffect:null,stores:null},Or.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function OO(t,e,n,r){e.value=n,e.getSnapshot=r,$O(e)&&kO(t)}function TO(t,e,n){return n(function(){$O(e)&&kO(t)})}function $O(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ys(t,n)}catch{return!0}}function kO(t){var e=m1(t,1);e!==null&&Hs(e,t,1,-1)}function CE(t){var e=ua();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:R6,lastRenderedState:t},e.queue=t,t=t.dispatch=nX.bind(null,Or,t),[e.memoizedState,t]}function D6(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Or.updateQueue,e===null?(e={lastEffect:null,stores:null},Or.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function AO(){return ms().memoizedState}function y3(t,e,n,r){var i=ua();Or.flags|=t,i.memoizedState=D6(1|e,n,void 0,r===void 0?null:r)}function q5(t,e,n,r){var i=ms();r=r===void 0?null:r;var o=void 0;if(ni!==null){var s=ni.memoizedState;if(o=s.destroy,r!==null&&jb(r,s.deps)){i.memoizedState=D6(e,n,o,r);return}}Or.flags|=t,i.memoizedState=D6(1|e,n,o,r)}function yE(t,e){return y3(8390656,8,t,e)}function Xb(t,e){return q5(2048,8,t,e)}function NO(t,e){return q5(4,2,t,e)}function LO(t,e){return q5(4,4,t,e)}function PO(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function BO(t,e,n){return n=n!=null?n.concat([t]):null,q5(4,4,PO.bind(null,e,t),n)}function Yb(){}function FO(t,e){var n=ms();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&jb(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function UO(t,e){var n=ms();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&jb(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function HO(t,e,n){return ju&21?(Ys(n,e)||(n=zM(),Or.lanes|=n,zu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ho=!0),t.memoizedState=n)}function eX(t,e){var n=ir;ir=n!==0&&4>n?n:4,t(!0);var r=gm.transition;gm.transition={};try{t(!1),e()}finally{ir=n,gm.transition=r}}function VO(){return ms().memoizedState}function tX(t,e,n){var r=gl(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},jO(t))zO(e,n);else if(n=CO(t,e,n,r),n!==null){var i=Gi();Hs(n,t,r,i),WO(n,e,r)}}function nX(t,e,n){var r=gl(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(jO(t))zO(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Ys(a,s)){var l=e.interleaved;l===null?(i.next=i,Bb(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=CO(t,e,i,r),n!==null&&(i=Gi(),Hs(n,t,r,i),WO(n,e,r))}}function jO(t){var e=t.alternate;return t===Or||e!==null&&e===Or}function zO(t,e){zd=Oh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function WO(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,wb(t,n)}}var Th={readContext:fs,useCallback:Mi,useContext:Mi,useEffect:Mi,useImperativeHandle:Mi,useInsertionEffect:Mi,useLayoutEffect:Mi,useMemo:Mi,useReducer:Mi,useRef:Mi,useState:Mi,useDebugValue:Mi,useDeferredValue:Mi,useTransition:Mi,useMutableSource:Mi,useSyncExternalStore:Mi,useId:Mi,unstable_isNewReconciler:!1},rX={readContext:fs,useCallback:function(t,e){return ua().memoizedState=[t,e===void 0?null:e],t},useContext:fs,useEffect:yE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,y3(4194308,4,PO.bind(null,e,t),n)},useLayoutEffect:function(t,e){return y3(4194308,4,t,e)},useInsertionEffect:function(t,e){return y3(4,2,t,e)},useMemo:function(t,e){var n=ua();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ua();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=tX.bind(null,Or,t),[r.memoizedState,t]},useRef:function(t){var e=ua();return t={current:t},e.memoizedState=t},useState:CE,useDebugValue:Yb,useDeferredValue:function(t){return ua().memoizedState=t},useTransition:function(){var t=CE(!1),e=t[0];return t=eX.bind(null,t[1]),ua().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Or,i=ua();if(Rr){if(n===void 0)throw Error(ct(407));n=n()}else{if(n=e(),hi===null)throw Error(ct(349));ju&30||MO(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,yE(TO.bind(null,r,o,t),[t]),r.flags|=2048,D6(9,OO.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=ua(),e=hi.identifierPrefix;if(Rr){var n=o1,r=i1;n=(r&~(1<<32-Us(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=w6++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=JW++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},iX={readContext:fs,useCallback:FO,useContext:fs,useEffect:Xb,useImperativeHandle:BO,useInsertionEffect:NO,useLayoutEffect:LO,useMemo:UO,useReducer:vm,useRef:AO,useState:function(){return vm(R6)},useDebugValue:Yb,useDeferredValue:function(t){var e=ms();return HO(e,ni.memoizedState,t)},useTransition:function(){var t=vm(R6)[0],e=ms().memoizedState;return[t,e]},useMutableSource:IO,useSyncExternalStore:xO,useId:VO,unstable_isNewReconciler:!1},oX={readContext:fs,useCallback:FO,useContext:fs,useEffect:Xb,useImperativeHandle:BO,useInsertionEffect:NO,useLayoutEffect:LO,useMemo:UO,useReducer:_m,useRef:AO,useState:function(){return _m(R6)},useDebugValue:Yb,useDeferredValue:function(t){var e=ms();return ni===null?e.memoizedState=t:HO(e,ni.memoizedState,t)},useTransition:function(){var t=_m(R6)[0],e=ms().memoizedState;return[t,e]},useMutableSource:IO,useSyncExternalStore:xO,useId:VO,unstable_isNewReconciler:!1};function V2(t,e){try{var n="",r=e;do n+=kz(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function bm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Lg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var sX=typeof WeakMap=="function"?WeakMap:Map;function XO(t,e,n){n=u1(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){kh||(kh=!0,Xg=r),Lg(t,e)},n}function YO(t,e,n){n=u1(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Lg(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Lg(t,e),typeof r!="function"&&(pl===null?pl=new Set([this]):pl.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function SE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new sX;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=CX.bind(null,t,e,n),e.then(t,t))}function EE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function wE(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=u1(-1,1),e.tag=2,ml(n,e,1))),n.lanes|=1),t)}var aX=w1.ReactCurrentOwner,ho=!1;function ji(t,e,n,r){e.child=t===null?RO(e,null,n,r):U2(e,t.child,n,r)}function RE(t,e,n,r,i){n=n.render;var o=e.ref;return I2(e,i),r=zb(t,e,n,r,o,i),n=Wb(),t!==null&&!ho?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,p1(t,e,i)):(Rr&&n&&$b(e),e.flags|=1,ji(t,e,r,i),e.child)}function DE(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!tC(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,GO(t,e,o,r,i)):(t=R3(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:_6,n(s,r)&&t.ref===e.ref)return p1(t,e,i)}return e.flags|=1,t=vl(o,r),t.ref=e.ref,t.return=e,e.child=t}function GO(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(_6(o,r)&&t.ref===e.ref)if(ho=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(ho=!0);else return e.lanes=t.lanes,p1(t,e,i)}return Pg(t,e,n,r,i)}function KO(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},fr(h2,To),To|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,fr(h2,To),To|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,fr(h2,To),To|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,fr(h2,To),To|=r;return ji(t,e,i,n),e.child}function ZO(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Pg(t,e,n,r,i){var o=po(n)?Hu:Pi.current;return o=B2(e,o),I2(e,i),n=zb(t,e,n,r,o,i),r=Wb(),t!==null&&!ho?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,p1(t,e,i)):(Rr&&r&&$b(e),e.flags|=1,ji(t,e,n,i),e.child)}function IE(t,e,n,r,i){if(po(n)){var o=!0;Eh(e)}else o=!1;if(I2(e,i),e.stateNode===null)S3(t,e),EO(e,n,r),Ng(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,u=n.contextType;typeof u=="object"&&u!==null?u=fs(u):(u=po(n)?Hu:Pi.current,u=B2(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==u)&&_E(e,s,r,u),G1=!1;var h=e.memoizedState;s.state=h,xh(e,r,s,i),l=e.memoizedState,a!==r||h!==l||mo.current||G1?(typeof c=="function"&&(Ag(e,n,c,r),l=e.memoizedState),(a=G1||vE(e,n,a,r,h,l,u))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=u,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,yO(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Ds(e.type,a),s.props=u,d=e.pendingProps,h=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=fs(l):(l=po(n)?Hu:Pi.current,l=B2(e,l));var f=n.getDerivedStateFromProps;(c=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||h!==l)&&_E(e,s,r,l),G1=!1,h=e.memoizedState,s.state=h,xh(e,r,s,i);var m=e.memoizedState;a!==d||h!==m||mo.current||G1?(typeof f=="function"&&(Ag(e,n,f,r),m=e.memoizedState),(u=G1||vE(e,n,u,r,h,m,l)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,m,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,m,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),s.props=r,s.state=m,s.context=l,r=u):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Bg(t,e,n,r,o,i)}function Bg(t,e,n,r,i,o){ZO(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&hE(e,n,!1),p1(t,e,o);r=e.stateNode,aX.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=U2(e,t.child,null,o),e.child=U2(e,null,a,o)):ji(t,e,a,o),e.memoizedState=r.state,i&&hE(e,n,!0),e.child}function qO(t){var e=t.stateNode;e.pendingContext?dE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&dE(t,e.context,!1),Ub(t,e.containerInfo)}function xE(t,e,n,r,i){return F2(),Ab(i),e.flags|=256,ji(t,e,n,r),e.child}var Fg={dehydrated:null,treeContext:null,retryLane:0};function Ug(t){return{baseLanes:t,cachePool:null,transitions:null}}function QO(t,e,n){var r=e.pendingProps,i=xr.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),fr(xr,i&1),t===null)return $g(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=e9(s,r,0,null),t=$u(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Ug(n),e.memoizedState=Fg,t):Gb(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return lX(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=vl(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=vl(a,o):(o=$u(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?Ug(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=Fg,r}return o=t.child,t=o.sibling,r=vl(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Gb(t,e){return e=e9({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function y7(t,e,n,r){return r!==null&&Ab(r),U2(e,t.child,null,n),t=Gb(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function lX(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=bm(Error(ct(422))),y7(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=e9({mode:"visible",children:r.children},i,0,null),o=$u(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&U2(e,t.child,null,s),e.child.memoizedState=Ug(s),e.memoizedState=Fg,o);if(!(e.mode&1))return y7(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(ct(419)),r=bm(o,r,void 0),y7(t,e,s,r)}if(a=(s&t.childLanes)!==0,ho||a){if(r=hi,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,m1(t,i),Hs(r,t,i,-1))}return eC(),r=bm(Error(ct(421))),y7(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=yX.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,No=fl(i.nextSibling),Po=e,Rr=!0,$s=null,t!==null&&(Jo[es++]=i1,Jo[es++]=o1,Jo[es++]=Vu,i1=t.id,o1=t.overflow,Vu=e),e=Gb(e,r.children),e.flags|=4096,e)}function ME(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),kg(t.return,e,n)}function Cm(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function JO(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(ji(t,e,r.children,n),r=xr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ME(t,n,e);else if(t.tag===19)ME(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(fr(xr,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Mh(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Cm(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Mh(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Cm(e,!0,n,null,o);break;case"together":Cm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function S3(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function p1(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),zu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ct(153));if(e.child!==null){for(t=e.child,n=vl(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=vl(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function uX(t,e,n){switch(e.tag){case 3:qO(e),F2();break;case 5:DO(e);break;case 1:po(e.type)&&Eh(e);break;case 4:Ub(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;fr(Dh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(fr(xr,xr.current&1),e.flags|=128,null):n&e.child.childLanes?QO(t,e,n):(fr(xr,xr.current&1),t=p1(t,e,n),t!==null?t.sibling:null);fr(xr,xr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return JO(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),fr(xr,xr.current),r)break;return null;case 22:case 23:return e.lanes=0,KO(t,e,n)}return p1(t,e,n)}var eT,Hg,tT,nT;eT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Hg=function(){};tT=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,wu(ya.current);var o=null;switch(n){case"input":i=ug(t,i),r=ug(t,r),o=[];break;case"select":i=$r({},i,{value:void 0}),r=$r({},r,{value:void 0}),o=[];break;case"textarea":i=hg(t,i),r=hg(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=yh)}mg(n,r);var s;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(d6.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(d6.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&_r("scroll",t),o||a===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};nT=function(t,e,n,r){n!==r&&(e.flags|=4)};function K0(t,e){if(!Rr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Oi(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function cX(t,e,n){var r=e.pendingProps;switch(kb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oi(e),null;case 1:return po(e.type)&&Sh(),Oi(e),null;case 3:return r=e.stateNode,H2(),Sr(mo),Sr(Pi),Vb(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(b7(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,$s!==null&&(Kg($s),$s=null))),Hg(t,e),Oi(e),null;case 5:Hb(e);var i=wu(E6.current);if(n=e.type,t!==null&&e.stateNode!=null)tT(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ct(166));return Oi(e),null}if(t=wu(ya.current),b7(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[pa]=e,r[y6]=o,t=(e.mode&1)!==0,n){case"dialog":_r("cancel",r),_r("close",r);break;case"iframe":case"object":case"embed":_r("load",r);break;case"video":case"audio":for(i=0;i<wd.length;i++)_r(wd[i],r);break;case"source":_r("error",r);break;case"img":case"image":case"link":_r("error",r),_r("load",r);break;case"details":_r("toggle",r);break;case"input":BS(r,o),_r("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},_r("invalid",r);break;case"textarea":US(r,o),_r("invalid",r)}mg(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&_7(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&_7(r.textContent,a,t),i=["children",""+a]):d6.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&_r("scroll",r)}switch(n){case"input":c7(r),FS(r,o,!0);break;case"textarea":c7(r),HS(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=yh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=MM(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[pa]=e,t[y6]=r,eT(t,e,!1,!1),e.stateNode=t;e:{switch(s=pg(n,r),n){case"dialog":_r("cancel",t),_r("close",t),i=r;break;case"iframe":case"object":case"embed":_r("load",t),i=r;break;case"video":case"audio":for(i=0;i<wd.length;i++)_r(wd[i],t);i=r;break;case"source":_r("error",t),i=r;break;case"img":case"image":case"link":_r("error",t),_r("load",t),i=r;break;case"details":_r("toggle",t),i=r;break;case"input":BS(t,r),i=ug(t,r),_r("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=$r({},r,{value:void 0}),_r("invalid",t);break;case"textarea":US(t,r),i=hg(t,r),_r("invalid",t);break;default:i=r}mg(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?$M(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&OM(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&h6(t,l):typeof l=="number"&&h6(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(d6.hasOwnProperty(o)?l!=null&&o==="onScroll"&&_r("scroll",t):l!=null&&_b(t,o,l,s))}switch(n){case"input":c7(t),FS(t,r,!1);break;case"textarea":c7(t),HS(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Dl(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?E2(t,!!r.multiple,o,!1):r.defaultValue!=null&&E2(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=yh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Oi(e),null;case 6:if(t&&e.stateNode!=null)nT(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ct(166));if(n=wu(E6.current),wu(ya.current),b7(e)){if(r=e.stateNode,n=e.memoizedProps,r[pa]=e,(o=r.nodeValue!==n)&&(t=Po,t!==null))switch(t.tag){case 3:_7(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_7(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[pa]=e,e.stateNode=r}return Oi(e),null;case 13:if(Sr(xr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Rr&&No!==null&&e.mode&1&&!(e.flags&128))bO(),F2(),e.flags|=98560,o=!1;else if(o=b7(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(ct(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ct(317));o[pa]=e}else F2(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Oi(e),o=!1}else $s!==null&&(Kg($s),$s=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||xr.current&1?oi===0&&(oi=3):eC())),e.updateQueue!==null&&(e.flags|=4),Oi(e),null);case 4:return H2(),Hg(t,e),t===null&&b6(e.stateNode.containerInfo),Oi(e),null;case 10:return Pb(e.type._context),Oi(e),null;case 17:return po(e.type)&&Sh(),Oi(e),null;case 19:if(Sr(xr),o=e.memoizedState,o===null)return Oi(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)K0(o,!1);else{if(oi!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Mh(t),s!==null){for(e.flags|=128,K0(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return fr(xr,xr.current&1|2),e.child}t=t.sibling}o.tail!==null&&Vr()>j2&&(e.flags|=128,r=!0,K0(o,!1),e.lanes=4194304)}else{if(!r)if(t=Mh(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),K0(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Rr)return Oi(e),null}else 2*Vr()-o.renderingStartTime>j2&&n!==1073741824&&(e.flags|=128,r=!0,K0(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Vr(),e.sibling=null,n=xr.current,fr(xr,r?n&1|2:n&1),e):(Oi(e),null);case 22:case 23:return Jb(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?To&1073741824&&(Oi(e),e.subtreeFlags&6&&(e.flags|=8192)):Oi(e),null;case 24:return null;case 25:return null}throw Error(ct(156,e.tag))}function dX(t,e){switch(kb(e),e.tag){case 1:return po(e.type)&&Sh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return H2(),Sr(mo),Sr(Pi),Vb(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Hb(e),null;case 13:if(Sr(xr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ct(340));F2()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Sr(xr),null;case 4:return H2(),null;case 10:return Pb(e.type._context),null;case 22:case 23:return Jb(),null;case 24:return null;default:return null}}var S7=!1,Li=!1,hX=typeof WeakSet=="function"?WeakSet:Set,Tt=null;function d2(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Nr(t,e,r)}else n.current=null}function Vg(t,e,n){try{n()}catch(r){Nr(t,e,r)}}var OE=!1;function fX(t,e){if(Rg=_h,t=sO(),Tb(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,u=0,c=0,d=t,h=null;t:for(;;){for(var f;d!==n||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++u===i&&(a=s),h===o&&++c===r&&(l=s),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Dg={focusedElem:t,selectionRange:n},_h=!1,Tt=e;Tt!==null;)if(e=Tt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Tt=t;else for(;Tt!==null;){e=Tt;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,g=m.memoizedState,v=e.stateNode,_=v.getSnapshotBeforeUpdate(e.elementType===e.type?p:Ds(e.type,p),g);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ct(163))}}catch(y){Nr(e,e.return,y)}if(t=e.sibling,t!==null){t.return=e.return,Tt=t;break}Tt=e.return}return m=OE,OE=!1,m}function Wd(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Vg(e,n,o)}i=i.next}while(i!==r)}}function Q5(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function jg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function rT(t){var e=t.alternate;e!==null&&(t.alternate=null,rT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[pa],delete e[y6],delete e[Mg],delete e[KW],delete e[ZW])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function iT(t){return t.tag===5||t.tag===3||t.tag===4}function TE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||iT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function zg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=yh));else if(r!==4&&(t=t.child,t!==null))for(zg(t,e,n),t=t.sibling;t!==null;)zg(t,e,n),t=t.sibling}function Wg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Wg(t,e,n),t=t.sibling;t!==null;)Wg(t,e,n),t=t.sibling}var bi=null,Is=!1;function L1(t,e,n){for(n=n.child;n!==null;)oT(t,e,n),n=n.sibling}function oT(t,e,n){if(Ca&&typeof Ca.onCommitFiberUnmount=="function")try{Ca.onCommitFiberUnmount(z5,n)}catch{}switch(n.tag){case 5:Li||d2(n,e);case 6:var r=bi,i=Is;bi=null,L1(t,e,n),bi=r,Is=i,bi!==null&&(Is?(t=bi,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):bi.removeChild(n.stateNode));break;case 18:bi!==null&&(Is?(t=bi,n=n.stateNode,t.nodeType===8?fm(t.parentNode,n):t.nodeType===1&&fm(t,n),g6(t)):fm(bi,n.stateNode));break;case 4:r=bi,i=Is,bi=n.stateNode.containerInfo,Is=!0,L1(t,e,n),bi=r,Is=i;break;case 0:case 11:case 14:case 15:if(!Li&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Vg(n,e,s),i=i.next}while(i!==r)}L1(t,e,n);break;case 1:if(!Li&&(d2(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Nr(n,e,a)}L1(t,e,n);break;case 21:L1(t,e,n);break;case 22:n.mode&1?(Li=(r=Li)||n.memoizedState!==null,L1(t,e,n),Li=r):L1(t,e,n);break;default:L1(t,e,n)}}function $E(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new hX),e.forEach(function(r){var i=SX.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function bs(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:bi=a.stateNode,Is=!1;break e;case 3:bi=a.stateNode.containerInfo,Is=!0;break e;case 4:bi=a.stateNode.containerInfo,Is=!0;break e}a=a.return}if(bi===null)throw Error(ct(160));oT(o,s,i),bi=null,Is=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Nr(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)sT(e,t),e=e.sibling}function sT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(bs(e,t),ta(t),r&4){try{Wd(3,t,t.return),Q5(3,t)}catch(p){Nr(t,t.return,p)}try{Wd(5,t,t.return)}catch(p){Nr(t,t.return,p)}}break;case 1:bs(e,t),ta(t),r&512&&n!==null&&d2(n,n.return);break;case 5:if(bs(e,t),ta(t),r&512&&n!==null&&d2(n,n.return),t.flags&32){var i=t.stateNode;try{h6(i,"")}catch(p){Nr(t,t.return,p)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&IM(i,o),pg(a,s);var u=pg(a,o);for(s=0;s<l.length;s+=2){var c=l[s],d=l[s+1];c==="style"?$M(i,d):c==="dangerouslySetInnerHTML"?OM(i,d):c==="children"?h6(i,d):_b(i,c,d,u)}switch(a){case"input":cg(i,o);break;case"textarea":xM(i,o);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?E2(i,!!o.multiple,f,!1):h!==!!o.multiple&&(o.defaultValue!=null?E2(i,!!o.multiple,o.defaultValue,!0):E2(i,!!o.multiple,o.multiple?[]:"",!1))}i[y6]=o}catch(p){Nr(t,t.return,p)}}break;case 6:if(bs(e,t),ta(t),r&4){if(t.stateNode===null)throw Error(ct(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(p){Nr(t,t.return,p)}}break;case 3:if(bs(e,t),ta(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{g6(e.containerInfo)}catch(p){Nr(t,t.return,p)}break;case 4:bs(e,t),ta(t);break;case 13:bs(e,t),ta(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(qb=Vr())),r&4&&$E(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Li=(u=Li)||c,bs(e,t),Li=u):bs(e,t),ta(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(Tt=t,c=t.child;c!==null;){for(d=Tt=c;Tt!==null;){switch(h=Tt,f=h.child,h.tag){case 0:case 11:case 14:case 15:Wd(4,h,h.return);break;case 1:d2(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){Nr(r,n,p)}}break;case 5:d2(h,h.return);break;case 22:if(h.memoizedState!==null){AE(d);continue}}f!==null?(f.return=h,Tt=f):AE(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{i=d.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=TM("display",s))}catch(p){Nr(t,t.return,p)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(p){Nr(t,t.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:bs(e,t),ta(t),r&4&&$E(t);break;case 21:break;default:bs(e,t),ta(t)}}function ta(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(iT(n)){var r=n;break e}n=n.return}throw Error(ct(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(h6(i,""),r.flags&=-33);var o=TE(t);Wg(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=TE(t);zg(t,a,s);break;default:throw Error(ct(161))}}catch(l){Nr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function mX(t,e,n){Tt=t,aT(t)}function aT(t,e,n){for(var r=(t.mode&1)!==0;Tt!==null;){var i=Tt,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||S7;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Li;a=S7;var u=Li;if(S7=s,(Li=l)&&!u)for(Tt=i;Tt!==null;)s=Tt,l=s.child,s.tag===22&&s.memoizedState!==null?NE(i):l!==null?(l.return=s,Tt=l):NE(i);for(;o!==null;)Tt=o,aT(o),o=o.sibling;Tt=i,S7=a,Li=u}kE(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Tt=o):kE(t)}}function kE(t){for(;Tt!==null;){var e=Tt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Li||Q5(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Li)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Ds(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&gE(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}gE(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&g6(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ct(163))}Li||e.flags&512&&jg(e)}catch(h){Nr(e,e.return,h)}}if(e===t){Tt=null;break}if(n=e.sibling,n!==null){n.return=e.return,Tt=n;break}Tt=e.return}}function AE(t){for(;Tt!==null;){var e=Tt;if(e===t){Tt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Tt=n;break}Tt=e.return}}function NE(t){for(;Tt!==null;){var e=Tt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Q5(4,e)}catch(l){Nr(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Nr(e,i,l)}}var o=e.return;try{jg(e)}catch(l){Nr(e,o,l)}break;case 5:var s=e.return;try{jg(e)}catch(l){Nr(e,s,l)}}}catch(l){Nr(e,e.return,l)}if(e===t){Tt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Tt=a;break}Tt=e.return}}var pX=Math.ceil,$h=w1.ReactCurrentDispatcher,Kb=w1.ReactCurrentOwner,ds=w1.ReactCurrentBatchConfig,zn=0,hi=null,Gr=null,yi=0,To=0,h2=Ul(0),oi=0,I6=null,zu=0,J5=0,Zb=0,Xd=null,ao=null,qb=0,j2=1/0,e1=null,kh=!1,Xg=null,pl=null,E7=!1,J1=null,Ah=0,Yd=0,Yg=null,E3=-1,w3=0;function Gi(){return zn&6?Vr():E3!==-1?E3:E3=Vr()}function gl(t){return t.mode&1?zn&2&&yi!==0?yi&-yi:QW.transition!==null?(w3===0&&(w3=zM()),w3):(t=ir,t!==0||(t=window.event,t=t===void 0?16:qM(t.type)),t):1}function Hs(t,e,n,r){if(50<Yd)throw Yd=0,Yg=null,Error(ct(185));n4(t,n,r),(!(zn&2)||t!==hi)&&(t===hi&&(!(zn&2)&&(J5|=n),oi===4&&Z1(t,yi)),go(t,r),n===1&&zn===0&&!(e.mode&1)&&(j2=Vr()+500,K5&&Hl()))}function go(t,e){var n=t.callbackNode;Qz(t,e);var r=vh(t,t===hi?yi:0);if(r===0)n!==null&&zS(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&zS(n),e===1)t.tag===0?qW(LE.bind(null,t)):gO(LE.bind(null,t)),YW(function(){!(zn&6)&&Hl()}),n=null;else{switch(WM(r)){case 1:n=Eb;break;case 4:n=VM;break;case 16:n=gh;break;case 536870912:n=jM;break;default:n=gh}n=pT(n,lT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function lT(t,e){if(E3=-1,w3=0,zn&6)throw Error(ct(327));var n=t.callbackNode;if(x2()&&t.callbackNode!==n)return null;var r=vh(t,t===hi?yi:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Nh(t,r);else{e=r;var i=zn;zn|=2;var o=cT();(hi!==t||yi!==e)&&(e1=null,j2=Vr()+500,Tu(t,e));do try{_X();break}catch(a){uT(t,a)}while(1);Lb(),$h.current=o,zn=i,Gr!==null?e=0:(hi=null,yi=0,e=oi)}if(e!==0){if(e===2&&(i=Cg(t),i!==0&&(r=i,e=Gg(t,i))),e===1)throw n=I6,Tu(t,0),Z1(t,r),go(t,Vr()),n;if(e===6)Z1(t,r);else{if(i=t.current.alternate,!(r&30)&&!gX(i)&&(e=Nh(t,r),e===2&&(o=Cg(t),o!==0&&(r=o,e=Gg(t,o))),e===1))throw n=I6,Tu(t,0),Z1(t,r),go(t,Vr()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ct(345));case 2:du(t,ao,e1);break;case 3:if(Z1(t,r),(r&130023424)===r&&(e=qb+500-Vr(),10<e)){if(vh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Gi(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=xg(du.bind(null,t,ao,e1),e);break}du(t,ao,e1);break;case 4:if(Z1(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-Us(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=Vr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*pX(r/1960))-r,10<r){t.timeoutHandle=xg(du.bind(null,t,ao,e1),r);break}du(t,ao,e1);break;case 5:du(t,ao,e1);break;default:throw Error(ct(329))}}}return go(t,Vr()),t.callbackNode===n?lT.bind(null,t):null}function Gg(t,e){var n=Xd;return t.current.memoizedState.isDehydrated&&(Tu(t,e).flags|=256),t=Nh(t,e),t!==2&&(e=ao,ao=n,e!==null&&Kg(e)),t}function Kg(t){ao===null?ao=t:ao.push.apply(ao,t)}function gX(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Ys(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Z1(t,e){for(e&=~Zb,e&=~J5,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Us(e),r=1<<n;t[n]=-1,e&=~r}}function LE(t){if(zn&6)throw Error(ct(327));x2();var e=vh(t,0);if(!(e&1))return go(t,Vr()),null;var n=Nh(t,e);if(t.tag!==0&&n===2){var r=Cg(t);r!==0&&(e=r,n=Gg(t,r))}if(n===1)throw n=I6,Tu(t,0),Z1(t,e),go(t,Vr()),n;if(n===6)throw Error(ct(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,du(t,ao,e1),go(t,Vr()),null}function Qb(t,e){var n=zn;zn|=1;try{return t(e)}finally{zn=n,zn===0&&(j2=Vr()+500,K5&&Hl())}}function Wu(t){J1!==null&&J1.tag===0&&!(zn&6)&&x2();var e=zn;zn|=1;var n=ds.transition,r=ir;try{if(ds.transition=null,ir=1,t)return t()}finally{ir=r,ds.transition=n,zn=e,!(zn&6)&&Hl()}}function Jb(){To=h2.current,Sr(h2)}function Tu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,XW(n)),Gr!==null)for(n=Gr.return;n!==null;){var r=n;switch(kb(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Sh();break;case 3:H2(),Sr(mo),Sr(Pi),Vb();break;case 5:Hb(r);break;case 4:H2();break;case 13:Sr(xr);break;case 19:Sr(xr);break;case 10:Pb(r.type._context);break;case 22:case 23:Jb()}n=n.return}if(hi=t,Gr=t=vl(t.current,null),yi=To=e,oi=0,I6=null,Zb=J5=zu=0,ao=Xd=null,Eu!==null){for(e=0;e<Eu.length;e++)if(n=Eu[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Eu=null}return t}function uT(t,e){do{var n=Gr;try{if(Lb(),C3.current=Th,Oh){for(var r=Or.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Oh=!1}if(ju=0,ui=ni=Or=null,zd=!1,w6=0,Kb.current=null,n===null||n.return===null){oi=1,I6=e,Gr=null;break}e:{var o=t,s=n.return,a=n,l=e;if(e=yi,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=EE(s);if(f!==null){f.flags&=-257,wE(f,s,a,o,e),f.mode&1&&SE(o,u,e),e=f,l=u;var m=e.updateQueue;if(m===null){var p=new Set;p.add(l),e.updateQueue=p}else m.add(l);break e}else{if(!(e&1)){SE(o,u,e),eC();break e}l=Error(ct(426))}}else if(Rr&&a.mode&1){var g=EE(s);if(g!==null){!(g.flags&65536)&&(g.flags|=256),wE(g,s,a,o,e),Ab(V2(l,a));break e}}o=l=V2(l,a),oi!==4&&(oi=2),Xd===null?Xd=[o]:Xd.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var v=XO(o,l,e);pE(o,v);break e;case 1:a=l;var _=o.type,C=o.stateNode;if(!(o.flags&128)&&(typeof _.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(pl===null||!pl.has(C)))){o.flags|=65536,e&=-e,o.lanes|=e;var y=YO(o,a,e);pE(o,y);break e}}o=o.return}while(o!==null)}hT(n)}catch(S){e=S,Gr===n&&n!==null&&(Gr=n=n.return);continue}break}while(1)}function cT(){var t=$h.current;return $h.current=Th,t===null?Th:t}function eC(){(oi===0||oi===3||oi===2)&&(oi=4),hi===null||!(zu&268435455)&&!(J5&268435455)||Z1(hi,yi)}function Nh(t,e){var n=zn;zn|=2;var r=cT();(hi!==t||yi!==e)&&(e1=null,Tu(t,e));do try{vX();break}catch(i){uT(t,i)}while(1);if(Lb(),zn=n,$h.current=r,Gr!==null)throw Error(ct(261));return hi=null,yi=0,oi}function vX(){for(;Gr!==null;)dT(Gr)}function _X(){for(;Gr!==null&&!jz();)dT(Gr)}function dT(t){var e=mT(t.alternate,t,To);t.memoizedProps=t.pendingProps,e===null?hT(t):Gr=e,Kb.current=null}function hT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=dX(n,e),n!==null){n.flags&=32767,Gr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{oi=6,Gr=null;return}}else if(n=cX(n,e,To),n!==null){Gr=n;return}if(e=e.sibling,e!==null){Gr=e;return}Gr=e=t}while(e!==null);oi===0&&(oi=5)}function du(t,e,n){var r=ir,i=ds.transition;try{ds.transition=null,ir=1,bX(t,e,n,r)}finally{ds.transition=i,ir=r}return null}function bX(t,e,n,r){do x2();while(J1!==null);if(zn&6)throw Error(ct(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ct(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(Jz(t,o),t===hi&&(Gr=hi=null,yi=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||E7||(E7=!0,pT(gh,function(){return x2(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=ds.transition,ds.transition=null;var s=ir;ir=1;var a=zn;zn|=4,Kb.current=null,fX(t,n),sT(n,t),FW(Dg),_h=!!Rg,Dg=Rg=null,t.current=n,mX(n),zz(),zn=a,ir=s,ds.transition=o}else t.current=n;if(E7&&(E7=!1,J1=t,Ah=i),o=t.pendingLanes,o===0&&(pl=null),Yz(n.stateNode),go(t,Vr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(kh)throw kh=!1,t=Xg,Xg=null,t;return Ah&1&&t.tag!==0&&x2(),o=t.pendingLanes,o&1?t===Yg?Yd++:(Yd=0,Yg=t):Yd=0,Hl(),null}function x2(){if(J1!==null){var t=WM(Ah),e=ds.transition,n=ir;try{if(ds.transition=null,ir=16>t?16:t,J1===null)var r=!1;else{if(t=J1,J1=null,Ah=0,zn&6)throw Error(ct(331));var i=zn;for(zn|=4,Tt=t.current;Tt!==null;){var o=Tt,s=o.child;if(Tt.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Tt=u;Tt!==null;){var c=Tt;switch(c.tag){case 0:case 11:case 15:Wd(8,c,o)}var d=c.child;if(d!==null)d.return=c,Tt=d;else for(;Tt!==null;){c=Tt;var h=c.sibling,f=c.return;if(rT(c),c===u){Tt=null;break}if(h!==null){h.return=f,Tt=h;break}Tt=f}}}var m=o.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(p!==null)}}Tt=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,Tt=s;else e:for(;Tt!==null;){if(o=Tt,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Wd(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,Tt=v;break e}Tt=o.return}}var _=t.current;for(Tt=_;Tt!==null;){s=Tt;var C=s.child;if(s.subtreeFlags&2064&&C!==null)C.return=s,Tt=C;else e:for(s=_;Tt!==null;){if(a=Tt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Q5(9,a)}}catch(S){Nr(a,a.return,S)}if(a===s){Tt=null;break e}var y=a.sibling;if(y!==null){y.return=a.return,Tt=y;break e}Tt=a.return}}if(zn=i,Hl(),Ca&&typeof Ca.onPostCommitFiberRoot=="function")try{Ca.onPostCommitFiberRoot(z5,t)}catch{}r=!0}return r}finally{ir=n,ds.transition=e}}return!1}function PE(t,e,n){e=V2(n,e),e=XO(t,e,1),t=ml(t,e,1),e=Gi(),t!==null&&(n4(t,1,e),go(t,e))}function Nr(t,e,n){if(t.tag===3)PE(t,t,n);else for(;e!==null;){if(e.tag===3){PE(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(pl===null||!pl.has(r))){t=V2(n,t),t=YO(e,t,1),e=ml(e,t,1),t=Gi(),e!==null&&(n4(e,1,t),go(e,t));break}}e=e.return}}function CX(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Gi(),t.pingedLanes|=t.suspendedLanes&n,hi===t&&(yi&n)===n&&(oi===4||oi===3&&(yi&130023424)===yi&&500>Vr()-qb?Tu(t,0):Zb|=n),go(t,e)}function fT(t,e){e===0&&(t.mode&1?(e=f7,f7<<=1,!(f7&130023424)&&(f7=4194304)):e=1);var n=Gi();t=m1(t,e),t!==null&&(n4(t,e,n),go(t,n))}function yX(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),fT(t,n)}function SX(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ct(314))}r!==null&&r.delete(e),fT(t,n)}var mT;mT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||mo.current)ho=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ho=!1,uX(t,e,n);ho=!!(t.flags&131072)}else ho=!1,Rr&&e.flags&1048576&&vO(e,Rh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;S3(t,e),t=e.pendingProps;var i=B2(e,Pi.current);I2(e,n),i=zb(null,e,r,t,i,n);var o=Wb();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,po(r)?(o=!0,Eh(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Fb(e),i.updater=Z5,e.stateNode=i,i._reactInternals=e,Ng(e,r,t,n),e=Bg(null,e,r,!0,o,n)):(e.tag=0,Rr&&o&&$b(e),ji(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(S3(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=wX(r),t=Ds(r,t),i){case 0:e=Pg(null,e,r,t,n);break e;case 1:e=IE(null,e,r,t,n);break e;case 11:e=RE(null,e,r,t,n);break e;case 14:e=DE(null,e,r,Ds(r.type,t),n);break e}throw Error(ct(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ds(r,i),Pg(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ds(r,i),IE(t,e,r,i,n);case 3:e:{if(qO(e),t===null)throw Error(ct(387));r=e.pendingProps,o=e.memoizedState,i=o.element,yO(t,e),xh(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=V2(Error(ct(423)),e),e=xE(t,e,r,n,i);break e}else if(r!==i){i=V2(Error(ct(424)),e),e=xE(t,e,r,n,i);break e}else for(No=fl(e.stateNode.containerInfo.firstChild),Po=e,Rr=!0,$s=null,n=RO(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(F2(),r===i){e=p1(t,e,n);break e}ji(t,e,r,n)}e=e.child}return e;case 5:return DO(e),t===null&&$g(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,Ig(r,i)?s=null:o!==null&&Ig(r,o)&&(e.flags|=32),ZO(t,e),ji(t,e,s,n),e.child;case 6:return t===null&&$g(e),null;case 13:return QO(t,e,n);case 4:return Ub(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=U2(e,null,r,n):ji(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ds(r,i),RE(t,e,r,i,n);case 7:return ji(t,e,e.pendingProps,n),e.child;case 8:return ji(t,e,e.pendingProps.children,n),e.child;case 12:return ji(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,fr(Dh,r._currentValue),r._currentValue=s,o!==null)if(Ys(o.value,s)){if(o.children===i.children&&!mo.current){e=p1(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=u1(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),kg(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(ct(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),kg(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}ji(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,I2(e,n),i=fs(i),r=r(i),e.flags|=1,ji(t,e,r,n),e.child;case 14:return r=e.type,i=Ds(r,e.pendingProps),i=Ds(r.type,i),DE(t,e,r,i,n);case 15:return GO(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ds(r,i),S3(t,e),e.tag=1,po(r)?(t=!0,Eh(e)):t=!1,I2(e,n),EO(e,r,i),Ng(e,r,i,n),Bg(null,e,r,!0,t,n);case 19:return JO(t,e,n);case 22:return KO(t,e,n)}throw Error(ct(156,e.tag))};function pT(t,e){return HM(t,e)}function EX(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function as(t,e,n,r){return new EX(t,e,n,r)}function tC(t){return t=t.prototype,!(!t||!t.isReactComponent)}function wX(t){if(typeof t=="function")return tC(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Cb)return 11;if(t===yb)return 14}return 2}function vl(t,e){var n=t.alternate;return n===null?(n=as(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function R3(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")tC(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case n2:return $u(n.children,i,o,e);case bb:s=8,i|=8;break;case og:return t=as(12,n,e,i|2),t.elementType=og,t.lanes=o,t;case sg:return t=as(13,n,e,i),t.elementType=sg,t.lanes=o,t;case ag:return t=as(19,n,e,i),t.elementType=ag,t.lanes=o,t;case wM:return e9(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case SM:s=10;break e;case EM:s=9;break e;case Cb:s=11;break e;case yb:s=14;break e;case Y1:s=16,r=null;break e}throw Error(ct(130,t==null?t:typeof t,""))}return e=as(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function $u(t,e,n,r){return t=as(7,t,r,e),t.lanes=n,t}function e9(t,e,n,r){return t=as(22,t,r,e),t.elementType=wM,t.lanes=n,t.stateNode={isHidden:!1},t}function ym(t,e,n){return t=as(6,t,null,e),t.lanes=n,t}function Sm(t,e,n){return e=as(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function RX(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nm(0),this.expirationTimes=nm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nm(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function nC(t,e,n,r,i,o,s,a,l){return t=new RX(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=as(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fb(o),t}function DX(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:t2,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function gT(t){if(!t)return Il;t=t._reactInternals;e:{if(sc(t)!==t||t.tag!==1)throw Error(ct(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(po(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ct(171))}if(t.tag===1){var n=t.type;if(po(n))return pO(t,n,e)}return e}function vT(t,e,n,r,i,o,s,a,l){return t=nC(n,r,!0,t,i,o,s,a,l),t.context=gT(null),n=t.current,r=Gi(),i=gl(n),o=u1(r,i),o.callback=e??null,ml(n,o,i),t.current.lanes=i,n4(t,i,r),go(t,r),t}function t9(t,e,n,r){var i=e.current,o=Gi(),s=gl(i);return n=gT(n),e.context===null?e.context=n:e.pendingContext=n,e=u1(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ml(i,e,s),t!==null&&(Hs(t,i,s,o),b3(t,i,s)),s}function Lh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function BE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function rC(t,e){BE(t,e),(t=t.alternate)&&BE(t,e)}function IX(){return null}var _T=typeof reportError=="function"?reportError:function(t){console.error(t)};function iC(t){this._internalRoot=t}n9.prototype.render=iC.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ct(409));t9(t,e,null,null)};n9.prototype.unmount=iC.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Wu(function(){t9(null,t,null,null)}),e[f1]=null}};function n9(t){this._internalRoot=t}n9.prototype.unstable_scheduleHydration=function(t){if(t){var e=GM();t={blockedOn:null,target:t,priority:e};for(var n=0;n<K1.length&&e!==0&&e<K1[n].priority;n++);K1.splice(n,0,t),n===0&&ZM(t)}};function oC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function r9(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function FE(){}function xX(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var u=Lh(s);o.call(u)}}var s=vT(e,r,t,0,null,!1,!1,"",FE);return t._reactRootContainer=s,t[f1]=s.current,b6(t.nodeType===8?t.parentNode:t),Wu(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Lh(l);a.call(u)}}var l=nC(t,0,!1,null,null,!1,!1,"",FE);return t._reactRootContainer=l,t[f1]=l.current,b6(t.nodeType===8?t.parentNode:t),Wu(function(){t9(e,l,n,r)}),l}function i9(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=Lh(s);a.call(l)}}t9(e,s,t,i)}else s=xX(n,e,t,i,r);return Lh(s)}XM=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ed(e.pendingLanes);n!==0&&(wb(e,n|1),go(e,Vr()),!(zn&6)&&(j2=Vr()+500,Hl()))}break;case 13:Wu(function(){var r=m1(t,1);if(r!==null){var i=Gi();Hs(r,t,1,i)}}),rC(t,1)}};Rb=function(t){if(t.tag===13){var e=m1(t,134217728);if(e!==null){var n=Gi();Hs(e,t,134217728,n)}rC(t,134217728)}};YM=function(t){if(t.tag===13){var e=gl(t),n=m1(t,e);if(n!==null){var r=Gi();Hs(n,t,e,r)}rC(t,e)}};GM=function(){return ir};KM=function(t,e){var n=ir;try{return ir=t,e()}finally{ir=n}};vg=function(t,e,n){switch(e){case"input":if(cg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=G5(r);if(!i)throw Error(ct(90));DM(r),cg(r,i)}}}break;case"textarea":xM(t,n);break;case"select":e=n.value,e!=null&&E2(t,!!n.multiple,e,!1)}};NM=Qb;LM=Wu;var MX={usingClientEntryPoint:!1,Events:[i4,s2,G5,kM,AM,Qb]},Z0={findFiberByHostInstance:Su,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},OX={bundleType:Z0.bundleType,version:Z0.version,rendererPackageName:Z0.rendererPackageName,rendererConfig:Z0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w1.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=FM(t),t===null?null:t.stateNode},findFiberByHostInstance:Z0.findFiberByHostInstance||IX,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var w7=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!w7.isDisabled&&w7.supportsFiber)try{z5=w7.inject(OX),Ca=w7}catch{}}zo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MX;zo.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!oC(e))throw Error(ct(200));return DX(t,e,null,n)};zo.createRoot=function(t,e){if(!oC(t))throw Error(ct(299));var n=!1,r="",i=_T;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=nC(t,1,!1,null,null,n,!1,r,i),t[f1]=e.current,b6(t.nodeType===8?t.parentNode:t),new iC(e)};zo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ct(188)):(t=Object.keys(t).join(","),Error(ct(268,t)));return t=FM(e),t=t===null?null:t.stateNode,t};zo.flushSync=function(t){return Wu(t)};zo.hydrate=function(t,e,n){if(!r9(e))throw Error(ct(200));return i9(null,t,e,!0,n)};zo.hydrateRoot=function(t,e,n){if(!oC(t))throw Error(ct(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=_T;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=vT(e,null,t,1,n??null,i,!1,o,s),t[f1]=e.current,b6(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new n9(e)};zo.render=function(t,e,n){if(!r9(e))throw Error(ct(200));return i9(null,t,e,!1,n)};zo.unmountComponentAtNode=function(t){if(!r9(t))throw Error(ct(40));return t._reactRootContainer?(Wu(function(){i9(null,null,t,!1,function(){t._reactRootContainer=null,t[f1]=null})}),!0):!1};zo.unstable_batchedUpdates=Qb;zo.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!r9(n))throw Error(ct(200));if(t==null||t._reactInternals===void 0)throw Error(ct(38));return i9(t,e,n,!1,r)};zo.version="18.2.0-next-9e3b772b8-20220608";function bT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bT)}catch(t){console.error(t)}}bT(),vM.exports=zo;var Xu=vM.exports;const _a=aM(Xu);var TX=Object.defineProperty,$X=(t,e,n)=>e in t?TX(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ph=(t,e,n)=>($X(t,typeof e!="symbol"?e+"":e,n),n);function CT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var yT={exports:{}},o9={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kX=Qe,AX=Symbol.for("react.element"),NX=Symbol.for("react.fragment"),LX=Object.prototype.hasOwnProperty,PX=kX.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,BX={key:!0,ref:!0,__self:!0,__source:!0};function ST(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)LX.call(e,r)&&!BX.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:AX,type:t,key:o,ref:s,props:i,_owner:PX.current}}o9.Fragment=NX;o9.jsx=ST;o9.jsxs=ST;yT.exports=o9;var $t=yT.exports;const FX="univer-button",UX="univer-button-default",HX="univer-button-primary",VX="univer-button-text",jX="univer-button-link",zX="univer-button-small",WX="univer-button-middle",XX="univer-button-large",YX="univer-button-block",Wa={button:FX,buttonDefault:UX,buttonPrimary:HX,buttonText:VX,buttonLink:jX,buttonSmall:zX,buttonMiddle:WX,buttonLarge:XX,buttonBlock:YX};function c1(t){const{children:e,className:n,style:r,type:i="default",size:o="middle",block:s,htmlType:a,disabled:l=!1,onClick:u,...c}=t,d=wi(Wa.button,{[Wa.buttonPrimary]:i==="primary",[Wa.buttonDefault]:i==="default",[Wa.buttonText]:i==="text",[Wa.buttonLink]:i==="link",[Wa.buttonSmall]:o==="small",[Wa.buttonMiddle]:o==="middle",[Wa.buttonLarge]:o==="large",[Wa.buttonBlock]:s},n);return $t.jsx("button",{className:d,style:r,type:a,onClick:u,disabled:l,...c,children:e})}var ts=function(){return ts=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},ts.apply(this,arguments)},GX=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},Aa=b.forwardRef(function(t,e){var n=t.icon,r=t.id,i=t.className,o=t.extend,s=GX(t,["icon","id","className","extend"]),a="univerjs-icon univerjs-icon-".concat(r," ").concat(i||"").trim(),l=b.useRef("_".concat(qX()));return ET(n,"".concat(r),{defIds:n.defIds,idSuffix:l.current},ts({ref:e,className:a},s),o)});function ET(t,e,n,r,i){return b.createElement(t.tag,ts(ts({key:e},KX(t,n,i)),r),(ZX(t,n).children||[]).map(function(o,s){return ET(o,"".concat(e,"-").concat(t.tag,"-").concat(s),n,void 0,i)}))}function KX(t,e,n){var r=ts({},t.attrs);n!=null&&n.colorChannel1&&r.fill==="colorChannel1"&&(r.fill=n.colorChannel1);var i=e.defIds;return!i||i.length===0||(t.tag==="use"&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+e.idSuffix),Object.entries(r).forEach(function(o){var s=o[0],a=o[1];typeof a=="string"&&(r[s]=a.replace(/url\(#(.*)\)/,"url(#$1".concat(e.idSuffix,")")))})),r}function ZX(t,e){var n,r=e.defIds;return!r||r.length===0?t:t.tag==="defs"&&!((n=t.children)===null||n===void 0)&&n.length?ts(ts({},t),{children:t.children.map(function(i){return typeof i.attrs.id=="string"&&r&&r.indexOf(i.attrs.id)>-1?ts(ts({},i),{attrs:ts(ts({},i.attrs),{id:i.attrs.id+e.idSuffix})}):i})}):t}function qX(){return Math.random().toString(36).substring(2,8)}Aa.displayName="UniverIcon";var QX={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.6152 4.52067C14.8732 4.77869 14.8732 5.19703 14.6152 5.45505L6.61862 13.4514C6.46241 13.6077 6.20915 13.6077 6.05294 13.4514L1.73512 9.13354C1.4771 8.87551 1.4771 8.45718 1.73513 8.19915C1.99315 7.94113 2.41149 7.94114 2.66951 8.19916L6.19436 11.7241C6.27247 11.8022 6.3991 11.8022 6.47721 11.7241L13.6808 4.52067C13.9388 4.26264 14.3571 4.26264 14.6152 4.52067Z",fillRule:"evenodd",clipRule:"evenodd"}}]},wT=b.forwardRef(function(t,e){return b.createElement(Aa,Object.assign({},t,{id:"check-mark-single",ref:e,icon:QX}))});wT.displayName="CheckMarkSingle";const JX=wT;var eY={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.48712 4.59907C5.23328 4.34523 4.82172 4.34523 4.56788 4.59907C4.31404 4.85291 4.31404 5.26447 4.56788 5.51831L7.9973 8.94773L4.56773 12.3773C4.31389 12.6311 4.31389 13.0427 4.56773 13.2965C4.82157 13.5504 5.23313 13.5504 5.48697 13.2965L8.91654 9.86697L12.3461 13.2965C12.5999 13.5503 13.0114 13.5503 13.2653 13.2965C13.5191 13.0426 13.5191 12.6311 13.2653 12.3772L9.83577 8.94773L13.2651 5.51836C13.519 5.26452 13.519 4.85296 13.2651 4.59912C13.0113 4.34528 12.5997 4.34528 12.3459 4.59912L8.91654 8.02849L5.48712 4.59907Z"}}]},RT=b.forwardRef(function(t,e){return b.createElement(Aa,Object.assign({},t,{id:"close-single",ref:e,icon:eY}))});RT.displayName="CloseSingle";const tY=RT;var nY={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_371_77",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.87 0.63H16.87V16.63H0.87z"}}]},{tag:"g",attrs:{mask:"url(#mask0_371_77)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M9.72636 13.5549C9.25212 14.1041 8.48323 14.1041 8.00899 13.5549L1.22579 5.70056C0.46078 4.81474 1.00259 3.30013 2.08448 3.30013L15.6509 3.30013C16.7328 3.30013 17.2746 4.81474 16.5096 5.70056L9.72636 13.5549Z"}}]}]},rY=b.forwardRef(function(t,e){return b.createElement(Aa,Object.assign({},t,{id:"dropdown-single",ref:e,icon:nY}))});rY.displayName="DropdownSingle";var iY={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.39 0.21H16.39V16.21H0.39z",opacity:.01}},{tag:"path",attrs:{fill:"currentColor",d:"M8.48755 1.7124C4.89804 1.7124 1.98755 4.62289 1.98755 8.2124C1.98755 11.8019 4.89804 14.7124 8.48755 14.7124C12.0771 14.7124 14.9875 11.8019 14.9875 8.2124C14.9875 4.62289 12.0771 1.7124 8.48755 1.7124ZM10.8873 10.682L9.92972 10.6777L8.48753 8.95834L7.04679 10.6762L6.08775 10.6806C6.02391 10.6806 5.97168 10.6298 5.97168 10.5645C5.97168 10.5369 5.98184 10.5108 5.99925 10.489L7.88686 8.24015L5.99925 5.99272C5.98184 5.97095 5.97168 5.94484 5.97168 5.91727C5.97168 5.85343 6.02391 5.8012 6.08775 5.8012L7.04679 5.80555L8.48753 7.52486L9.92826 5.807L10.8859 5.80265C10.9497 5.80265 11.0019 5.85343 11.0019 5.91872C11.0019 5.94629 10.9918 5.97241 10.9744 5.99417L9.08965 8.2416L10.9758 10.4905C10.9932 10.5122 11.0034 10.5384 11.0034 10.5659C11.0034 10.6298 10.9511 10.682 10.8873 10.682Z",fillRule:"evenodd",clipRule:"evenodd"}}]},DT=b.forwardRef(function(t,e){return b.createElement(Aa,Object.assign({},t,{id:"error-single",ref:e,icon:iY}))});DT.displayName="ErrorSingle";const oY=DT;var sY={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_249",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.37 0.77H16.37V16.77H0.37z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_249)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M9.12107 2.86418C9.12107 2.45648 8.78669 2.12598 8.37422 2.12598C7.96175 2.12598 7.62737 2.45648 7.62737 2.86418V8.03164H2.39931C1.98684 8.03164 1.65247 8.36214 1.65247 8.76984C1.65247 9.17754 1.98684 9.50805 2.39931 9.50805H7.62737V14.6754C7.62737 15.0831 7.96175 15.4136 8.37422 15.4136C8.78669 15.4136 9.12107 15.0831 9.12107 14.6754V9.50805H14.3489C14.7613 9.50805 15.0957 9.17754 15.0957 8.76984C15.0957 8.36214 14.7613 8.03164 14.3489 8.03164H9.12107V2.86418Z"}}]}]},IT=b.forwardRef(function(t,e){return b.createElement(Aa,Object.assign({},t,{id:"increase-single",ref:e,icon:sY}))});IT.displayName="IncreaseSingle";const aY=IT;var lY={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_556",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.56 0.77H16.56V16.77H0.56z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_556)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.19318 4.76988C1.70089 4.26222 2.524 4.26226 3.03166 4.76997L8.13929 9.87808C8.3736 10.1124 8.75352 10.1124 8.98784 9.8781L14.0959 4.77C14.6036 4.26232 15.4267 4.26232 15.9344 4.77C16.4421 5.27768 16.4421 6.1008 15.9344 6.60848L9.97775 12.5651C9.19667 13.3462 7.93029 13.3462 7.14925 12.5651L1.1931 6.60836C0.685438 6.10065 0.685477 5.27753 1.19318 4.76988Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},xT=b.forwardRef(function(t,e){return b.createElement(Aa,Object.assign({},t,{id:"more-down-single",ref:e,icon:lY}))});xT.displayName="MoreDownSingle";const uY=xT;var cY={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_252",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.54 0.77H16.54V16.77H0.54z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_252)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.81702 8.76994C1.81702 8.36224 2.15139 8.03174 2.56386 8.03174H14.5134C14.9259 8.03174 15.2603 8.36224 15.2603 8.76994C15.2603 9.17764 14.9259 9.50815 14.5134 9.50815H2.56386C2.15139 9.50815 1.81702 9.17764 1.81702 8.76994Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},MT=b.forwardRef(function(t,e){return b.createElement(Aa,Object.assign({},t,{id:"reduce-single",ref:e,icon:cY}))});MT.displayName="ReduceSingle";const dY=MT;var hY={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.39 0.21H16.39V16.21H0.39z",opacity:.01}},{tag:"path",attrs:{fill:"currentColor",d:"M8.38843 1.8125C4.79892 1.8125 1.88843 4.72299 1.88843 8.3125C1.88843 11.902 4.79892 14.8125 8.38843 14.8125C11.9779 14.8125 14.8884 11.902 14.8884 8.3125C14.8884 4.72299 11.9779 1.8125 8.38843 1.8125ZM11.196 6.18984L8.1404 10.4265C7.95614 10.6833 7.57456 10.6833 7.39029 10.4265L5.58103 7.91931C5.5259 7.84241 5.58103 7.73504 5.67534 7.73504H6.35581C6.5038 7.73504 6.64453 7.80614 6.73159 7.92801L7.76462 9.3615L10.0454 6.19855C10.1325 6.07813 10.2718 6.00558 10.4212 6.00558H11.1017C11.196 6.00558 11.2511 6.11295 11.196 6.18984Z",fillRule:"evenodd",clipRule:"evenodd"}}]},OT=b.forwardRef(function(t,e){return b.createElement(Aa,Object.assign({},t,{id:"success-single",ref:e,icon:hY}))});OT.displayName="SuccessSingle";const fY=OT;var mY={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.78833 8.2124C1.78833 4.62289 4.69882 1.7124 8.28833 1.7124C11.8778 1.7124 14.7883 4.62289 14.7883 8.2124C14.7883 11.8019 11.8778 14.7124 8.28833 14.7124C4.69882 14.7124 1.78833 11.8019 1.78833 8.2124ZM7.7015 5.54982L7.94869 9.54615H8.62848L8.88598 5.54982L8.90658 4.33444H7.6706L7.7015 5.54982ZM7.4646 11.2765C7.4646 11.7812 7.83539 12.0902 8.28859 12.0902C8.74178 12.0902 9.11257 11.7812 9.11257 11.2765C9.11257 10.7924 8.74178 10.4731 8.28859 10.4731C7.83539 10.4731 7.4646 10.7924 7.4646 11.2765Z",fillRule:"evenodd",clipRule:"evenodd"}}]},TT=b.forwardRef(function(t,e){return b.createElement(Aa,Object.assign({},t,{id:"warning-single",ref:e,icon:mY}))});TT.displayName="WarningSingle";const pY=TT;function Wt(){return Wt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Wt.apply(this,arguments)}function pr(t){"@babel/helpers - typeof";return pr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pr(t)}function gY(t,e){if(pr(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(pr(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $T(t){var e=gY(t,"string");return pr(e)==="symbol"?e:String(e)}function at(t,e,n){return e=$T(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kT(t){if(Array.isArray(t))return t}function vY(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}function Zg(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function sC(t,e){if(t){if(typeof t=="string")return Zg(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zg(t,e)}}function AT(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ze(t,e){return kT(t)||vY(t,e)||sC(t,e)||AT()}function UE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Oe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UE(Object(n),!0).forEach(function(r){at(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UE(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Vl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function HE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$T(r.key),r)}}function jl(t,e,n){return e&&HE(t.prototype,e),n&&HE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Bh(t,e){return Bh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Bh(t,e)}function s4(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bh(t,e)}function Fh(t){return Fh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Fh(t)}function _Y(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Uh(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bY(t,e){if(e&&(pr(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uh(t)}function a4(t){var e=_Y();return function(){var n=Fh(t),r;if(e){var i=Fh(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return bY(this,r)}}function s9(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function Pn(t,e){if(t==null)return{};var n=s9(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Si(t,e){CY(t)&&(t="100%");var n=yY(t);return t=e===360?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:(e===360?t=(t<0?t%e+e:t%e)/parseFloat(String(e)):t=t%e/parseFloat(String(e)),t)}function R7(t){return Math.min(1,Math.max(0,t))}function CY(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function yY(t){return typeof t=="string"&&t.indexOf("%")!==-1}function NT(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function D7(t){return t<=1?"".concat(Number(t)*100,"%"):t}function Ru(t){return t.length===1?"0"+t:String(t)}function SY(t,e,n){return{r:Si(t,255)*255,g:Si(e,255)*255,b:Si(n,255)*255}}function VE(t,e,n){t=Si(t,255),e=Si(e,255),n=Si(n,255);var r=Math.max(t,e,n),i=Math.min(t,e,n),o=0,s=0,a=(r+i)/2;if(r===i)s=0,o=0;else{var l=r-i;switch(s=a>.5?l/(2-r-i):l/(r+i),r){case t:o=(e-n)/l+(e<n?6:0);break;case e:o=(n-t)/l+2;break;case n:o=(t-e)/l+4;break}o/=6}return{h:o,s,l:a}}function Em(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*(6*n):n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function EY(t,e,n){var r,i,o;if(t=Si(t,360),e=Si(e,100),n=Si(n,100),e===0)i=n,o=n,r=n;else{var s=n<.5?n*(1+e):n+e-n*e,a=2*n-s;r=Em(a,s,t+1/3),i=Em(a,s,t),o=Em(a,s,t-1/3)}return{r:r*255,g:i*255,b:o*255}}function jE(t,e,n){t=Si(t,255),e=Si(e,255),n=Si(n,255);var r=Math.max(t,e,n),i=Math.min(t,e,n),o=0,s=r,a=r-i,l=r===0?0:a/r;if(r===i)o=0;else{switch(r){case t:o=(e-n)/a+(e<n?6:0);break;case e:o=(n-t)/a+2;break;case n:o=(t-e)/a+4;break}o/=6}return{h:o,s:l,v:s}}function wY(t,e,n){t=Si(t,360)*6,e=Si(e,100),n=Si(n,100);var r=Math.floor(t),i=t-r,o=n*(1-e),s=n*(1-i*e),a=n*(1-(1-i)*e),l=r%6,u=[n,s,o,o,a,n][l],c=[a,n,n,s,o,o][l],d=[o,o,a,n,n,s][l];return{r:u*255,g:c*255,b:d*255}}function zE(t,e,n,r){var i=[Ru(Math.round(t).toString(16)),Ru(Math.round(e).toString(16)),Ru(Math.round(n).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function RY(t,e,n,r,i){var o=[Ru(Math.round(t).toString(16)),Ru(Math.round(e).toString(16)),Ru(Math.round(n).toString(16)),Ru(DY(r))];return i&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))&&o[3].startsWith(o[3].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function DY(t){return Math.round(parseFloat(t)*255).toString(16)}function WE(t){return xo(t)/255}function xo(t){return parseInt(t,16)}function IY(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var qg={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function xY(t){var e={r:0,g:0,b:0},n=1,r=null,i=null,o=null,s=!1,a=!1;return typeof t=="string"&&(t=TY(t)),typeof t=="object"&&(Xa(t.r)&&Xa(t.g)&&Xa(t.b)?(e=SY(t.r,t.g,t.b),s=!0,a=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Xa(t.h)&&Xa(t.s)&&Xa(t.v)?(r=D7(t.s),i=D7(t.v),e=wY(t.h,r,i),s=!0,a="hsv"):Xa(t.h)&&Xa(t.s)&&Xa(t.l)&&(r=D7(t.s),o=D7(t.l),e=EY(t.h,r,o),s=!0,a="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(n=t.a)),n=NT(n),{ok:s,format:t.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}var MY="[-\\+]?\\d+%?",OY="[-\\+]?\\d*\\.\\d+%?",el="(?:".concat(OY,")|(?:").concat(MY,")"),wm="[\\s|\\(]+(".concat(el,")[,|\\s]+(").concat(el,")[,|\\s]+(").concat(el,")\\s*\\)?"),Rm="[\\s|\\(]+(".concat(el,")[,|\\s]+(").concat(el,")[,|\\s]+(").concat(el,")[,|\\s]+(").concat(el,")\\s*\\)?"),Ss={CSS_UNIT:new RegExp(el),rgb:new RegExp("rgb"+wm),rgba:new RegExp("rgba"+Rm),hsl:new RegExp("hsl"+wm),hsla:new RegExp("hsla"+Rm),hsv:new RegExp("hsv"+wm),hsva:new RegExp("hsva"+Rm),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function TY(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var e=!1;if(qg[t])t=qg[t],e=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n=Ss.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=Ss.rgba.exec(t),n?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Ss.hsl.exec(t),n?{h:n[1],s:n[2],l:n[3]}:(n=Ss.hsla.exec(t),n?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Ss.hsv.exec(t),n?{h:n[1],s:n[2],v:n[3]}:(n=Ss.hsva.exec(t),n?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Ss.hex8.exec(t),n?{r:xo(n[1]),g:xo(n[2]),b:xo(n[3]),a:WE(n[4]),format:e?"name":"hex8"}:(n=Ss.hex6.exec(t),n?{r:xo(n[1]),g:xo(n[2]),b:xo(n[3]),format:e?"name":"hex"}:(n=Ss.hex4.exec(t),n?{r:xo(n[1]+n[1]),g:xo(n[2]+n[2]),b:xo(n[3]+n[3]),a:WE(n[4]+n[4]),format:e?"name":"hex8"}:(n=Ss.hex3.exec(t),n?{r:xo(n[1]+n[1]),g:xo(n[2]+n[2]),b:xo(n[3]+n[3]),format:e?"name":"hex"}:!1)))))))))}function Xa(t){return!!Ss.CSS_UNIT.exec(String(t))}var $Y=function(){function t(e,n){e===void 0&&(e=""),n===void 0&&(n={});var r;if(e instanceof t)return e;typeof e=="number"&&(e=IY(e)),this.originalInput=e;var i=xY(e);this.originalInput=e,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=(r=n.format)!==null&&r!==void 0?r:i.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},t.prototype.getLuminance=function(){var e=this.toRgb(),n,r,i,o=e.r/255,s=e.g/255,a=e.b/255;return o<=.03928?n=o/12.92:n=Math.pow((o+.055)/1.055,2.4),s<=.03928?r=s/12.92:r=Math.pow((s+.055)/1.055,2.4),a<=.03928?i=a/12.92:i=Math.pow((a+.055)/1.055,2.4),.2126*n+.7152*r+.0722*i},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(e){return this.a=NT(e),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},t.prototype.toHsv=function(){var e=jE(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},t.prototype.toHsvString=function(){var e=jE(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.v*100);return this.a===1?"hsv(".concat(n,", ").concat(r,"%, ").concat(i,"%)"):"hsva(".concat(n,", ").concat(r,"%, ").concat(i,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var e=VE(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},t.prototype.toHslString=function(){var e=VE(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.l*100);return this.a===1?"hsl(".concat(n,", ").concat(r,"%, ").concat(i,"%)"):"hsla(".concat(n,", ").concat(r,"%, ").concat(i,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(e){return e===void 0&&(e=!1),zE(this.r,this.g,this.b,e)},t.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},t.prototype.toHex8=function(e){return e===void 0&&(e=!1),RY(this.r,this.g,this.b,this.a,e)},t.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},t.prototype.toHexShortString=function(e){return e===void 0&&(e=!1),this.a===1?this.toHexString(e):this.toHex8String(e)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var e=Math.round(this.r),n=Math.round(this.g),r=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(n,", ").concat(r,")"):"rgba(".concat(e,", ").concat(n,", ").concat(r,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var e=function(n){return"".concat(Math.round(Si(n,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var e=function(n){return Math.round(Si(n,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+zE(this.r,this.g,this.b,!1),n=0,r=Object.entries(qg);n<r.length;n++){var i=r[n],o=i[0],s=i[1];if(e===s)return o}return!1},t.prototype.toString=function(e){var n=!!e;e=e??this.format;var r=!1,i=this.a<1&&this.a>=0,o=!n&&i&&(e.startsWith("hex")||e==="name");return o?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l+=e/100,n.l=R7(n.l),new t(n)},t.prototype.brighten=function(e){e===void 0&&(e=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),new t(n)},t.prototype.darken=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l-=e/100,n.l=R7(n.l),new t(n)},t.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},t.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},t.prototype.desaturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s-=e/100,n.s=R7(n.s),new t(n)},t.prototype.saturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s+=e/100,n.s=R7(n.s),new t(n)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var n=this.toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,new t(n)},t.prototype.mix=function(e,n){n===void 0&&(n=50);var r=this.toRgb(),i=new t(e).toRgb(),o=n/100,s={r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a};return new t(s)},t.prototype.analogous=function(e,n){e===void 0&&(e=6),n===void 0&&(n=30);var r=this.toHsl(),i=360/n,o=[this];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,o.push(new t(r));return o},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var n=this.toHsv(),r=n.h,i=n.s,o=n.v,s=[],a=1/e;e--;)s.push(new t({h:r,s:i,v:o})),o=(o+a)%1;return s},t.prototype.splitcomplement=function(){var e=this.toHsl(),n=e.h;return[this,new t({h:(n+72)%360,s:e.s,l:e.l}),new t({h:(n+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var n=this.toRgb(),r=new t(e).toRgb(),i=n.a+r.a*(1-n.a);return new t({r:(n.r*n.a+r.r*r.a*(1-n.a))/i,g:(n.g*n.a+r.g*r.a*(1-n.a))/i,b:(n.b*n.a+r.b*r.a*(1-n.a))/i,a:i})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var n=this.toHsl(),r=n.h,i=[this],o=360/e,s=1;s<e;s++)i.push(new t({h:(r+s*o)%360,s:n.s,l:n.l}));return i},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t}(),kY=["b"],AY=["v"],Dm=function(t){return Math.round(Number(t||0))},NY=function(t){if(t&&pr(t)==="object"&&"h"in t&&"b"in t){var e=t,n=e.b,r=Pn(e,kY);return Oe(Oe({},r),{},{v:n})}return typeof t=="string"&&/hsb/.test(t)?t.replace(/hsb/,"hsv"):t},XE=function(t){s4(n,t);var e=a4(n);function n(r){return Vl(this,n),e.call(this,NY(r))}return jl(n,[{key:"toHsbString",value:function(){var r=this.toHsb(),i=Dm(r.s*100),o=Dm(r.b*100),s=Dm(r.h),a=r.a,l="hsb(".concat(s,", ").concat(i,"%, ").concat(o,"%)"),u="hsba(".concat(s,", ").concat(i,"%, ").concat(o,"%, ").concat(a.toFixed(a===0?0:2),")");return a===1?l:u}},{key:"toHsb",value:function(){var r=this.toHsv();pr(this.originalInput)==="object"&&this.originalInput&&"h"in this.originalInput&&(r=this.originalInput);var i=r;i.v;var o=Pn(i,AY);return Oe(Oe({},o),{},{b:r.v})}}]),n}($Y),LY="rc-color-picker",_l=function(t){return t instanceof XE?t:new XE(t)},PY=_l("#1677ff"),LT=function(t){var e=t.offset,n=t.targetRef,r=t.containerRef,i=t.color,o=t.type,s=r.current.getBoundingClientRect(),a=s.width,l=s.height,u=n.current.getBoundingClientRect(),c=u.width,d=u.height,h=c/2,f=d/2,m=(e.x+h)/a,p=1-(e.y+f)/l,g=i.toHsb(),v=m,_=(e.x+h)/a*360;if(o)switch(o){case"hue":return _l(Oe(Oe({},g),{},{h:_<=0?0:_}));case"alpha":return _l(Oe(Oe({},g),{},{a:v<=0?0:v}))}return _l({h:g.h,s:m<=0?0:m,b:p>=1?1:p,a:g.a})},PT=function(t,e,n,r){var i=t.current.getBoundingClientRect(),o=i.width,s=i.height,a=e.current.getBoundingClientRect(),l=a.width,u=a.height,c=l/2,d=u/2,h=n.toHsb();if(!(l===0&&u===0||l!==u)){if(r)switch(r){case"hue":return{x:h.h/360*o-c,y:-d/3};case"alpha":return{x:h.a/1*o-c,y:-d/3}}return{x:h.s*o-c,y:(1-h.b)*s-d}}},BT={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var r=[],i=0;i<arguments.length;i++){var o=arguments[i];if(o){var s=typeof o;if(s==="string"||s==="number")r.push(o);else if(Array.isArray(o)){if(o.length){var a=n.apply(null,o);a&&r.push(a)}}else if(s==="object"){if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]")){r.push(o.toString());continue}for(var l in o)e.call(o,l)&&o[l]&&r.push(l)}}}return r.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(BT);var BY=BT.exports;const Lt=CT(BY);var FT=function(t){var e=t.color,n=t.prefixCls,r=t.className,i=t.style,o=t.onClick,s="".concat(n,"-color-block");return Qe.createElement("div",{className:Lt(s,r),style:i,onClick:o},Qe.createElement("div",{className:"".concat(s,"-inner"),style:{background:e}}))};function FY(t){var e="touches"in t?t.touches[0]:t,n=document.documentElement.scrollLeft||document.body.scrollLeft||window.pageXOffset,r=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset;return{pageX:e.pageX-n,pageY:e.pageY-r}}function UT(t){var e=t.offset,n=t.targetRef,r=t.containerRef,i=t.direction,o=t.onDragChange,s=t.onDragChangeComplete,a=t.calculate,l=t.color,u=t.disabledDrag,c=b.useState(e||{x:0,y:0}),d=ze(c,2),h=d[0],f=d[1],m=b.useRef(null),p=b.useRef(null),g=b.useRef({flag:!1});b.useEffect(function(){if(g.current.flag===!1){var S=a==null?void 0:a(r);S&&f(S)}},[l,r]),b.useEffect(function(){return function(){document.removeEventListener("mousemove",m.current),document.removeEventListener("mouseup",p.current),document.removeEventListener("touchmove",m.current),document.removeEventListener("touchend",p.current),m.current=null,p.current=null}},[]);var v=function(S){var E=FY(S),w=E.pageX,R=E.pageY,D=r.current.getBoundingClientRect(),I=D.x,k=D.y,O=D.width,$=D.height,N=n.current.getBoundingClientRect(),H=N.width,X=N.height,te=H/2,z=X/2,A=Math.max(0,Math.min(w-I,O))-te,T=Math.max(0,Math.min(R-k,$))-z,P={x:A,y:i==="x"?h.y:T};if(H===0&&X===0||H!==X)return!1;f(P),o==null||o(P)},_=function(S){S.preventDefault(),v(S)},C=function(S){S.preventDefault(),g.current.flag=!1,document.removeEventListener("mousemove",m.current),document.removeEventListener("mouseup",p.current),document.removeEventListener("touchmove",m.current),document.removeEventListener("touchend",p.current),m.current=null,p.current=null,s==null||s()},y=function(S){document.removeEventListener("mousemove",m.current),document.removeEventListener("mouseup",p.current),!u&&(v(S),g.current.flag=!0,document.addEventListener("mousemove",_),document.addEventListener("mouseup",C),document.addEventListener("touchmove",_),document.addEventListener("touchend",C),m.current=_,p.current=C)};return[h,y]}var HT=function(t){var e=t.size,n=e===void 0?"default":e,r=t.color,i=t.prefixCls;return Qe.createElement("div",{className:Lt("".concat(i,"-handler"),at({},"".concat(i,"-handler-sm"),n==="small")),style:{backgroundColor:r}})},VT=function(t){var e=t.children,n=t.style,r=t.prefixCls;return Qe.createElement("div",{className:"".concat(r,"-palette"),style:Oe({position:"relative"},n)},e)},jT=b.forwardRef(function(t,e){var n=t.children,r=t.offset;return Qe.createElement("div",{ref:e,style:{position:"absolute",left:r.x,top:r.y,zIndex:1}},n)}),UY=function(t){var e=t.color,n=t.onChange,r=t.prefixCls,i=t.onChangeComplete,o=t.disabled,s=b.useRef(),a=b.useRef(),l=b.useRef(e),u=UT({color:e,containerRef:s,targetRef:a,calculate:function(f){return PT(f,a,e)},onDragChange:function(f){var m=LT({offset:f,targetRef:a,containerRef:s,color:e});l.current=m,n(m)},onDragChangeComplete:function(){return i==null?void 0:i(l.current)},disabledDrag:o}),c=ze(u,2),d=c[0],h=c[1];return Qe.createElement("div",{ref:s,className:"".concat(r,"-select"),onMouseDown:h,onTouchStart:h},Qe.createElement(VT,{prefixCls:r},Qe.createElement(jT,{offset:d,ref:a},Qe.createElement(HT,{color:e.toRgbString(),prefixCls:r})),Qe.createElement("div",{className:"".concat(r,"-saturation"),style:{backgroundColor:"hsl(".concat(e.toHsb().h,",100%, 50%)"),backgroundImage:"linear-gradient(0deg, #000, transparent),linear-gradient(90deg, #fff, hsla(0, 0%, 100%, 0))"}})))},HY=function(t){var e=t.colors,n=t.children,r=t.direction,i=r===void 0?"to right":r,o=t.type,s=t.prefixCls,a=b.useMemo(function(){return e.map(function(l,u){var c=_l(l);return o==="alpha"&&u===e.length-1&&c.setAlpha(1),c.toRgbString()}).join(",")},[e,o]);return Qe.createElement("div",{className:"".concat(s,"-gradient"),style:{position:"absolute",inset:0,background:"linear-gradient(".concat(i,", ").concat(a,")")}},n)},YE=function(t){var e=t.gradientColors,n=t.direction,r=t.type,i=r===void 0?"hue":r,o=t.color,s=t.value,a=t.onChange,l=t.onChangeComplete,u=t.disabled,c=t.prefixCls,d=b.useRef(),h=b.useRef(),f=b.useRef(o),m=UT({color:o,targetRef:h,containerRef:d,calculate:function(_){return PT(_,h,o,i)},onDragChange:function(_){var C=LT({offset:_,targetRef:h,containerRef:d,color:o,type:i});f.current=C,a(C)},onDragChangeComplete:function(){l==null||l(f.current,i)},direction:"x",disabledDrag:u}),p=ze(m,2),g=p[0],v=p[1];return Qe.createElement("div",{ref:d,className:Lt("".concat(c,"-slider"),"".concat(c,"-slider-").concat(i)),onMouseDown:v,onTouchStart:v},Qe.createElement(VT,{prefixCls:c},Qe.createElement(jT,{offset:g,ref:h},Qe.createElement(HT,{size:"small",color:s,prefixCls:c})),Qe.createElement(HY,{colors:e,direction:n,type:i,prefixCls:c})))};function GE(t){return t!==void 0}var VY=function(t,e){var n=e.defaultValue,r=e.value,i=b.useState(function(){var l;return GE(r)?l=r:GE(n)?l=n:l=t,_l(l)}),o=ze(i,2),s=o[0],a=o[1];return b.useEffect(function(){r&&a(_l(r))},[r]),[s,a]},jY=["rgb(255, 0, 0) 0%","rgb(255, 255, 0) 17%","rgb(0, 255, 0) 33%","rgb(0, 255, 255) 50%","rgb(0, 0, 255) 67%","rgb(255, 0, 255) 83%","rgb(255, 0, 0) 100%"];const zY=b.forwardRef(function(t,e){var n=t.value,r=t.defaultValue,i=t.prefixCls,o=i===void 0?LY:i,s=t.onChange,a=t.onChangeComplete,l=t.className,u=t.style,c=t.panelRender,d=t.disabledAlpha,h=d===void 0?!1:d,f=t.disabled,m=f===void 0?!1:f,p=VY(PY,{value:n,defaultValue:r}),g=ze(p,2),v=g[0],_=g[1],C=b.useMemo(function(){var R=_l(v.toRgbString());return R.setAlpha(1),R.toRgbString()},[v]),y=Lt("".concat(o,"-panel"),l,at({},"".concat(o,"-panel-disabled"),m)),S={prefixCls:o,onChangeComplete:a,disabled:m},E=function(R,D){n||_(R),s==null||s(R,D)},w=Qe.createElement(Qe.Fragment,null,Qe.createElement(UY,Wt({color:v,onChange:E},S)),Qe.createElement("div",{className:"".concat(o,"-slider-container")},Qe.createElement("div",{className:Lt("".concat(o,"-slider-group"),at({},"".concat(o,"-slider-group-disabled-alpha"),h))},Qe.createElement(YE,Wt({gradientColors:jY,color:v,value:"hsl(".concat(v.toHsb().h,",100%, 50%)"),onChange:function(R){return E(R,"hue")}},S)),!h&&Qe.createElement(YE,Wt({type:"alpha",gradientColors:["rgba(255, 0, 4, 0) 0%",C],color:v,value:v.toRgbString(),onChange:function(R){return E(R,"alpha")}},S))),Qe.createElement(FT,{color:v.toRgbString(),prefixCls:o})));return Qe.createElement("div",{className:y,style:u,ref:e},typeof c=="function"?c(w):w)}),WY="univer-color-picker",XY="univer-color-picker-hidden",YY="univer-color-picker-panel",GY="univer-color-picker-panel-disabled",KY="univer-color-picker-select",ZY="univer-color-picker-palette",qY="univer-color-picker-gradient",QY="univer-color-picker-saturation",JY="univer-color-picker-handler",eG="univer-color-picker-slider",tG="univer-color-picker-color-blocks",nG="univer-color-picker-color-block",rG="univer-color-picker-color-block-inner",iG="univer-color-picker-slider-container",oG="univer-color-picker-slider-group",sG="univer-color-picker-slider-group-disabled-alpha",Im={colorPicker:WY,colorPickerHidden:XY,colorPickerPanel:YY,colorPickerPanelDisabled:GY,colorPickerSelect:KY,colorPickerPalette:ZY,colorPickerGradient:qY,colorPickerSaturation:QY,colorPickerHandler:JY,colorPickerSlider:eG,colorPickerColorBlocks:tG,colorPickerColorBlock:nG,colorPickerColorBlockInner:rG,colorPickerSliderContainer:iG,colorPickerSliderGroup:oG,colorPickerSliderGroupDisabledAlpha:sG},aG=["#35322B","#505050","#606060","#6F6F6F","#8B8B8B","#B2B2B2","#CCCCCC","#E5E5E5","#F5F5F5","#FFFFFF","#9D0000","#B20000","#CD0F0F","#E30909","#F30B0B","#FE4B4B","#FA7979","#FB9D9D","#FDCECE","#FEE7E7","#B24000","#CC4F10","#DF5D00","#F96800","#FB8937","#FF8C51","#FCA669","#FDC49B","#FEE1CD","#FEF0E6","#B19401","#C5A300","#D8B300","#EBC301","#F9D700","#FBE137","#FCE869","#FDF09B","#FEF7CD","#FEFBE6","#58770A","#688C0D","#7AA017","#8BBB11","#A4DC16","#BEEE44","#CEF273","#DEF6A2","#EFFBD0","#F7FDE8","#007676","#008A8A","#009E9E","#00BBBB","#1CD8D8","#2AEAEA","#76EFEF","#A3F5F5","#D1FAFA","#E8FCFC","#001F9C","#0025B7","#012BD2","#133DE3","#2F55EB","#4567ED","#738DF2","#A2B3F6","#D0D9FB","#E8ECFD","#3F0198","#510EB0","#6721CB","#7735D4","#894EDE","#9E6DE3","#AA82E3","#C7ABED","#E3D5F6","#F1EAFA","#8F0550","#A1095C","#C1026B","#D4157E","#E7258F","#F248A6","#F273B9","#F6A2D0","#FBD0E8","#FDE8F3"];function zT(t){const{onChange:e}=t;function n(i){i.stopPropagation()}function r(i){const o=(typeof i=="string"?i:i.toHexString())??"";e==null||e(o)}return $t.jsxs("section",{children:[$t.jsx("div",{children:$t.jsx("div",{className:Im.colorPickerColorBlocks,children:aG.map(i=>$t.jsx(FT,{prefixCls:Im.colorPicker,color:i,onClick:()=>r(i)},i))})}),$t.jsx("section",{onClick:n,children:$t.jsx(zY,{prefixCls:Im.colorPicker,disabledAlpha:!0,onChangeComplete:r})})]})}const lG={design:{Confirm:{cancel:"cancel",confirm:"ok"},Slider:{resetTo:"Reset to"}}},WT=lG,R1=b.createContext({locale:WT,mountContainer:document.body});function uG(t){const{children:e,locale:n,mountContainer:r}=t;let i;return Object.prototype.hasOwnProperty.call(n,"design")?i=n:i=WT,$t.jsx(R1.Provider,{value:{locale:i,mountContainer:r},children:e})}function Ma(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Qg={},cG=function(t){};function dG(t,e){}function hG(t,e){}function fG(){Qg={}}function XT(t,e,n){!e&&!Qg[n]&&(t(!1,n),Qg[n]=!0)}function zl(t,e){XT(dG,t,e)}function mG(t,e){XT(hG,t,e)}zl.preMessage=cG;zl.resetWarned=fG;zl.noteOnce=mG;var YT={exports:{}},ar={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aC=Symbol.for("react.element"),lC=Symbol.for("react.portal"),a9=Symbol.for("react.fragment"),l9=Symbol.for("react.strict_mode"),u9=Symbol.for("react.profiler"),c9=Symbol.for("react.provider"),d9=Symbol.for("react.context"),pG=Symbol.for("react.server_context"),h9=Symbol.for("react.forward_ref"),f9=Symbol.for("react.suspense"),m9=Symbol.for("react.suspense_list"),p9=Symbol.for("react.memo"),g9=Symbol.for("react.lazy"),gG=Symbol.for("react.offscreen"),GT;GT=Symbol.for("react.module.reference");function gs(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case aC:switch(t=t.type,t){case a9:case u9:case l9:case f9:case m9:return t;default:switch(t=t&&t.$$typeof,t){case pG:case d9:case h9:case g9:case p9:case c9:return t;default:return e}}case lC:return e}}}ar.ContextConsumer=d9;ar.ContextProvider=c9;ar.Element=aC;ar.ForwardRef=h9;ar.Fragment=a9;ar.Lazy=g9;ar.Memo=p9;ar.Portal=lC;ar.Profiler=u9;ar.StrictMode=l9;ar.Suspense=f9;ar.SuspenseList=m9;ar.isAsyncMode=function(){return!1};ar.isConcurrentMode=function(){return!1};ar.isContextConsumer=function(t){return gs(t)===d9};ar.isContextProvider=function(t){return gs(t)===c9};ar.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===aC};ar.isForwardRef=function(t){return gs(t)===h9};ar.isFragment=function(t){return gs(t)===a9};ar.isLazy=function(t){return gs(t)===g9};ar.isMemo=function(t){return gs(t)===p9};ar.isPortal=function(t){return gs(t)===lC};ar.isProfiler=function(t){return gs(t)===u9};ar.isStrictMode=function(t){return gs(t)===l9};ar.isSuspense=function(t){return gs(t)===f9};ar.isSuspenseList=function(t){return gs(t)===m9};ar.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===a9||t===u9||t===l9||t===f9||t===m9||t===gG||typeof t=="object"&&t!==null&&(t.$$typeof===g9||t.$$typeof===p9||t.$$typeof===c9||t.$$typeof===d9||t.$$typeof===h9||t.$$typeof===GT||t.getModuleId!==void 0)};ar.typeOf=gs;YT.exports=ar;var KT=YT.exports;function uC(t,e,n){var r=b.useRef({});return(!("value"in r.current)||n(r.current.condition,e))&&(r.current.value=t(),r.current.condition=e),r.current.value}function cC(t,e){typeof t=="function"?t(e):pr(t)==="object"&&t&&"current"in t&&(t.current=e)}function ac(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.filter(function(i){return i});return r.length<=1?r[0]:function(i){e.forEach(function(o){cC(o,i)})}}function g0(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return uC(function(){return ac.apply(void 0,e)},e,function(r,i){return r.length!==i.length||r.every(function(o,s){return o!==i[s]})})}function v0(t){var e,n,r=KT.isMemo(t)?t.type.type:t.type;return!(typeof r=="function"&&!((e=r.prototype)!==null&&e!==void 0&&e.render)||typeof t=="function"&&!((n=t.prototype)!==null&&n!==void 0&&n.render))}var ZT=b.createContext(null);function vG(t){if(Array.isArray(t))return Zg(t)}function qT(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _G(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mr(t){return vG(t)||qT(t)||sC(t)||_G()}var KE=Ma()?b.useLayoutEffect:b.useEffect,Lr=function(t,e){var n=b.useRef(!0);KE(function(){return t(n.current)},e),KE(function(){return n.current=!1,function(){n.current=!0}},[])},Gd=function(t,e){Lr(function(n){if(!n)return t()},e)},ZE=[];function bG(t,e){var n=b.useState(function(){if(!Ma())return null;var m=document.createElement("div");return m}),r=ze(n,1),i=r[0],o=b.useRef(!1),s=b.useContext(ZT),a=b.useState(ZE),l=ze(a,2),u=l[0],c=l[1],d=s||(o.current?void 0:function(m){c(function(p){var g=[m].concat(Mr(p));return g})});function h(){i.parentElement||document.body.appendChild(i),o.current=!0}function f(){var m;(m=i.parentElement)===null||m===void 0||m.removeChild(i),o.current=!1}return Lr(function(){return t?s?s(h):h():f(),f},[t]),Lr(function(){u.length&&(u.forEach(function(m){return m()}),c(ZE))},[u]),[i,d]}function Jg(t,e){if(!t)return!1;if(t.contains)return t.contains(e);for(var n=e;n;){if(n===t)return!0;n=n.parentNode}return!1}var qE="data-rc-order",QE="data-rc-priority",CG="rc-util-key",ev=new Map;function QT(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.mark;return e?e.startsWith("data-")?e:"data-".concat(e):CG}function v9(t){if(t.attachTo)return t.attachTo;var e=document.querySelector("head");return e||document.body}function yG(t){return t==="queue"?"prependQueue":t?"prepend":"append"}function JT(t){return Array.from((ev.get(t)||t).children).filter(function(e){return e.tagName==="STYLE"})}function e$(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Ma())return null;var n=e.csp,r=e.prepend,i=e.priority,o=i===void 0?0:i,s=yG(r),a=s==="prependQueue",l=document.createElement("style");l.setAttribute(qE,s),a&&o&&l.setAttribute(QE,"".concat(o)),n!=null&&n.nonce&&(l.nonce=n==null?void 0:n.nonce),l.innerHTML=t;var u=v9(e),c=u.firstChild;if(r){if(a){var d=JT(u).filter(function(h){if(!["prepend","prependQueue"].includes(h.getAttribute(qE)))return!1;var f=Number(h.getAttribute(QE)||0);return o>=f});if(d.length)return u.insertBefore(l,d[d.length-1].nextSibling),l}u.insertBefore(l,c)}else u.appendChild(l);return l}function t$(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=v9(e);return JT(n).find(function(r){return r.getAttribute(QT(e))===t})}function JE(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t$(t,e);if(n){var r=v9(e);r.removeChild(n)}}function SG(t,e){var n=ev.get(t);if(!n||!Jg(document,n)){var r=e$("",e),i=r.parentNode;ev.set(t,i),t.removeChild(r)}}function EG(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=v9(n);SG(r,n);var i=t$(e,n);if(i){var o,s;if((o=n.csp)!==null&&o!==void 0&&o.nonce&&i.nonce!==((s=n.csp)===null||s===void 0?void 0:s.nonce)){var a;i.nonce=(a=n.csp)===null||a===void 0?void 0:a.nonce}return i.innerHTML!==t&&(i.innerHTML=t),i}var l=e$(t,n);return l.setAttribute(QT(n),e),l}var xm;function wG(t){if(typeof document>"u")return 0;if(t||xm===void 0){var e=document.createElement("div");e.style.width="100%",e.style.height="200px";var n=document.createElement("div"),r=n.style;r.position="absolute",r.top="0",r.left="0",r.pointerEvents="none",r.visibility="hidden",r.width="200px",r.height="150px",r.overflow="hidden",n.appendChild(e),document.body.appendChild(n);var i=e.offsetWidth;n.style.overflow="scroll";var o=e.offsetWidth;i===o&&(o=n.clientWidth),document.body.removeChild(n),xm=i-o}return xm}function ew(t){var e=t.match(/^(.*)px$/),n=Number(e==null?void 0:e[1]);return Number.isNaN(n)?wG():n}function RG(t){if(typeof document>"u"||!t||!(t instanceof Element))return{width:0,height:0};var e=getComputedStyle(t,"::-webkit-scrollbar"),n=e.width,r=e.height;return{width:ew(n),height:ew(r)}}function DG(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var IG="rc-util-locker-".concat(Date.now()),tw=0;function xG(t){var e=!!t,n=b.useState(function(){return tw+=1,"".concat(IG,"_").concat(tw)}),r=ze(n,1),i=r[0];Lr(function(){if(e){var o=RG(document.body).width,s=DG();EG(`
html body {
  overflow-y: hidden;
  `.concat(s?"width: calc(100% - ".concat(o,"px);"):"",`
}`),i)}else JE(i);return function(){JE(i)}},[e,i])}var nw=!1;function MG(t){return typeof t=="boolean"&&(nw=t),nw}var rw=function(t){return t===!1?!1:!Ma()||!t?null:typeof t=="string"?document.querySelector(t):typeof t=="function"?t():t},dC=b.forwardRef(function(t,e){var n=t.open,r=t.autoLock,i=t.getContainer;t.debug;var o=t.autoDestroy,s=o===void 0?!0:o,a=t.children,l=b.useState(n),u=ze(l,2),c=u[0],d=u[1],h=c||n;b.useEffect(function(){(s||n)&&d(n)},[n,s]);var f=b.useState(function(){return rw(i)}),m=ze(f,2),p=m[0],g=m[1];b.useEffect(function(){var k=rw(i);g(k??null)});var v=bG(h&&!p),_=ze(v,2),C=_[0],y=_[1],S=p??C;xG(r&&n&&Ma()&&(S===C||S===document.body));var E=null;if(a&&v0(a)&&e){var w=a;E=w.ref}var R=g0(E,e);if(!h||!Ma()||p===void 0)return null;var D=S===!1||MG(),I=a;return e&&(I=b.cloneElement(a,{ref:R})),b.createElement(ZT.Provider,{value:y},D?I:Xu.createPortal(I,S))}),n$=b.createContext({});function OG(){var t=Oe({},Iz);return t.useId}var iw=0,ow=OG();const r$=ow?function(t){var e=ow();return t||e}:function(t){var e=b.useState("ssr-id"),n=ze(e,2),r=n[0],i=n[1];return b.useEffect(function(){var o=iw;iw+=1,i("rc_unique_".concat(o))},[]),t||r};var ot={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(t){var e=t.keyCode;if(t.altKey&&!t.ctrlKey||t.metaKey||e>=ot.F1&&e<=ot.F12)return!1;switch(e){case ot.ALT:case ot.CAPS_LOCK:case ot.CONTEXT_MENU:case ot.CTRL:case ot.DOWN:case ot.END:case ot.ESC:case ot.HOME:case ot.INSERT:case ot.LEFT:case ot.MAC_FF_META:case ot.META:case ot.NUMLOCK:case ot.NUM_CENTER:case ot.PAGE_DOWN:case ot.PAGE_UP:case ot.PAUSE:case ot.PRINT_SCREEN:case ot.RIGHT:case ot.SHIFT:case ot.UP:case ot.WIN_KEY:case ot.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(t){if(t>=ot.ZERO&&t<=ot.NINE||t>=ot.NUM_ZERO&&t<=ot.NUM_MULTIPLY||t>=ot.A&&t<=ot.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&t===0)return!0;switch(t){case ot.SPACE:case ot.QUESTION_MARK:case ot.NUM_PLUS:case ot.NUM_MINUS:case ot.NUM_PERIOD:case ot.NUM_DIVISION:case ot.SEMICOLON:case ot.DASH:case ot.EQUALS:case ot.COMMA:case ot.PERIOD:case ot.SLASH:case ot.APOSTROPHE:case ot.SINGLE_QUOTE:case ot.OPEN_SQUARE_BRACKET:case ot.BACKSLASH:case ot.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},TG=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,$G=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,kG="".concat(TG," ").concat($G).split(/[\s\n]+/),AG="aria-",NG="data-";function sw(t,e){return t.indexOf(e)===0}function x6(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n;e===!1?n={aria:!0,data:!0,attr:!0}:e===!0?n={aria:!0}:n=Oe({},e);var r={};return Object.keys(t).forEach(function(i){(n.aria&&(i==="role"||sw(i,AG))||n.data&&sw(i,NG)||n.attr&&kG.includes(i))&&(r[i]=t[i])}),r}function aw(t,e,n){var r=e;return!r&&n&&(r="".concat(t,"-").concat(n)),r}function lw(t,e){var n=t["page".concat(e?"Y":"X","Offset")],r="scroll".concat(e?"Top":"Left");if(typeof n!="number"){var i=t.document;n=i.documentElement[r],typeof n!="number"&&(n=i.body[r])}return n}function LG(t){var e=t.getBoundingClientRect(),n={left:e.left,top:e.top},r=t.ownerDocument,i=r.defaultView||r.parentWindow;return n.left+=lw(i),n.top+=lw(i,!0),n}function Hh(t){return t instanceof HTMLElement||t instanceof SVGElement}function Kd(t){return Hh(t)?t:t instanceof Qe.Component?_a.findDOMNode(t):null}var PG=b.createContext({}),BG=function(t){s4(n,t);var e=a4(n);function n(){return Vl(this,n),e.apply(this,arguments)}return jl(n,[{key:"render",value:function(){return this.props.children}}]),n}(b.Component);function M2(t){var e=b.useRef(!1),n=b.useState(t),r=ze(n,2),i=r[0],o=r[1];b.useEffect(function(){return e.current=!1,function(){e.current=!0}},[]);function s(a,l){l&&e.current||o(a)}return[i,s]}var hu="none",I7="appear",x7="enter",M7="leave",uw="none",xs="prepare",f2="start",m2="active",hC="end",i$="prepared";function cw(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit".concat(t)]="webkit".concat(e),n["Moz".concat(t)]="moz".concat(e),n["ms".concat(t)]="MS".concat(e),n["O".concat(t)]="o".concat(e.toLowerCase()),n}function FG(t,e){var n={animationend:cw("Animation","AnimationEnd"),transitionend:cw("Transition","TransitionEnd")};return t&&("AnimationEvent"in e||delete n.animationend.animation,"TransitionEvent"in e||delete n.transitionend.transition),n}var UG=FG(Ma(),typeof window<"u"?window:{}),o$={};if(Ma()){var HG=document.createElement("div");o$=HG.style}var O7={};function s$(t){if(O7[t])return O7[t];var e=UG[t];if(e)for(var n=Object.keys(e),r=n.length,i=0;i<r;i+=1){var o=n[i];if(Object.prototype.hasOwnProperty.call(e,o)&&o in o$)return O7[t]=e[o],O7[t]}return""}var a$=s$("animationend"),l$=s$("transitionend"),u$=!!(a$&&l$),dw=a$||"animationend",hw=l$||"transitionend";function fw(t,e){if(!t)return null;if(pr(t)==="object"){var n=e.replace(/-\w/g,function(r){return r[1].toUpperCase()});return t[n]}return"".concat(t,"-").concat(e)}const VG=function(t){var e=b.useRef(),n=b.useRef(t);n.current=t;var r=b.useCallback(function(s){n.current(s)},[]);function i(s){s&&(s.removeEventListener(hw,r),s.removeEventListener(dw,r))}function o(s){e.current&&e.current!==s&&i(e.current),s&&s!==e.current&&(s.addEventListener(hw,r),s.addEventListener(dw,r),e.current=s)}return b.useEffect(function(){return function(){i(e.current)}},[]),[o,i]};var c$=Ma()?b.useLayoutEffect:b.useEffect,d$=function(t){return+setTimeout(t,16)},h$=function(t){return clearTimeout(t)};typeof window<"u"&&"requestAnimationFrame"in window&&(d$=function(t){return window.requestAnimationFrame(t)},h$=function(t){return window.cancelAnimationFrame(t)});var mw=0,fC=new Map;function f$(t){fC.delete(t)}var mr=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;mw+=1;var n=mw;function r(i){if(i===0)f$(n),t();else{var o=d$(function(){r(i-1)});fC.set(n,o)}}return r(e),n};mr.cancel=function(t){var e=fC.get(t);return f$(t),h$(e)};const jG=function(){var t=b.useRef(null);function e(){mr.cancel(t.current)}function n(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;e();var o=mr(function(){i<=1?r({isCanceled:function(){return o!==t.current}}):n(r,i-1)});t.current=o}return b.useEffect(function(){return function(){e()}},[]),[n,e]};var zG=[xs,f2,m2,hC],WG=[xs,i$],m$=!1,XG=!0;function p$(t){return t===m2||t===hC}const YG=function(t,e,n){var r=M2(uw),i=ze(r,2),o=i[0],s=i[1],a=jG(),l=ze(a,2),u=l[0],c=l[1];function d(){s(xs,!0)}var h=e?WG:zG;return c$(function(){if(o!==uw&&o!==hC){var f=h.indexOf(o),m=h[f+1],p=n(o);p===m$?s(m,!0):m&&u(function(g){function v(){g.isCanceled()||s(m,!0)}p===!0?v():Promise.resolve(p).then(v)})}},[t,o]),b.useEffect(function(){return function(){c()}},[]),[d,o]};function GG(t,e,n,r){var i=r.motionEnter,o=i===void 0?!0:i,s=r.motionAppear,a=s===void 0?!0:s,l=r.motionLeave,u=l===void 0?!0:l,c=r.motionDeadline,d=r.motionLeaveImmediately,h=r.onAppearPrepare,f=r.onEnterPrepare,m=r.onLeavePrepare,p=r.onAppearStart,g=r.onEnterStart,v=r.onLeaveStart,_=r.onAppearActive,C=r.onEnterActive,y=r.onLeaveActive,S=r.onAppearEnd,E=r.onEnterEnd,w=r.onLeaveEnd,R=r.onVisibleChanged,D=M2(),I=ze(D,2),k=I[0],O=I[1],$=M2(hu),N=ze($,2),H=N[0],X=N[1],te=M2(null),z=ze(te,2),A=z[0],T=z[1],P=b.useRef(!1),K=b.useRef(null);function ee(){return n()}var ue=b.useRef(!1);function fe(){X(hu,!0),T(null,!0)}function Ee(ve){var Pe=ee();if(!(ve&&!ve.deadline&&ve.target!==Pe)){var Ye=ue.current,bt;H===I7&&Ye?bt=S==null?void 0:S(Pe,ve):H===x7&&Ye?bt=E==null?void 0:E(Pe,ve):H===M7&&Ye&&(bt=w==null?void 0:w(Pe,ve)),H!==hu&&Ye&&bt!==!1&&fe()}}var Q=VG(Ee),re=ze(Q,1),Se=re[0],_e=function(ve){var Pe,Ye,bt;switch(ve){case I7:return Pe={},at(Pe,xs,h),at(Pe,f2,p),at(Pe,m2,_),Pe;case x7:return Ye={},at(Ye,xs,f),at(Ye,f2,g),at(Ye,m2,C),Ye;case M7:return bt={},at(bt,xs,m),at(bt,f2,v),at(bt,m2,y),bt;default:return{}}},He=b.useMemo(function(){return _e(H)},[H]),Ne=YG(H,!t,function(ve){if(ve===xs){var Pe=He[xs];return Pe?Pe(ee()):m$}if(mt in He){var Ye;T(((Ye=He[mt])===null||Ye===void 0?void 0:Ye.call(He,ee(),null))||null)}return mt===m2&&(Se(ee()),c>0&&(clearTimeout(K.current),K.current=setTimeout(function(){Ee({deadline:!0})},c))),mt===i$&&fe(),XG}),we=ze(Ne,2),Me=we[0],mt=we[1],vt=p$(mt);ue.current=vt,c$(function(){O(e);var ve=P.current;P.current=!0;var Pe;!ve&&e&&a&&(Pe=I7),ve&&e&&o&&(Pe=x7),(ve&&!e&&u||!ve&&d&&!e&&u)&&(Pe=M7);var Ye=_e(Pe);Pe&&(t||Ye[xs])?(X(Pe),Me()):X(hu)},[e]),b.useEffect(function(){(H===I7&&!a||H===x7&&!o||H===M7&&!u)&&X(hu)},[a,o,u]),b.useEffect(function(){return function(){P.current=!1,clearTimeout(K.current)}},[]);var ft=b.useRef(!1);b.useEffect(function(){k&&(ft.current=!0),k!==void 0&&H===hu&&((ft.current||k)&&(R==null||R(k)),ft.current=!0)},[k,H]);var et=A;return He[xs]&&mt===f2&&(et=Oe({transition:"none"},et)),[H,mt,et,k??e]}function KG(t){var e=t;pr(t)==="object"&&(e=t.transitionSupport);function n(i,o){return!!(i.motionName&&e&&o!==!1)}var r=b.forwardRef(function(i,o){var s=i.visible,a=s===void 0?!0:s,l=i.removeOnLeave,u=l===void 0?!0:l,c=i.forceRender,d=i.children,h=i.motionName,f=i.leavedClassName,m=i.eventProps,p=b.useContext(PG),g=p.motion,v=n(i,g),_=b.useRef(),C=b.useRef();function y(){try{return _.current instanceof HTMLElement?_.current:Kd(C.current)}catch{return null}}var S=GG(v,a,y,i),E=ze(S,4),w=E[0],R=E[1],D=E[2],I=E[3],k=b.useRef(I);I&&(k.current=!0);var O=b.useCallback(function(T){_.current=T,cC(o,T)},[o]),$,N=Oe(Oe({},m),{},{visible:a});if(!d)$=null;else if(w===hu)I?$=d(Oe({},N),O):!u&&k.current&&f?$=d(Oe(Oe({},N),{},{className:f}),O):c||!u&&!f?$=d(Oe(Oe({},N),{},{style:{display:"none"}}),O):$=null;else{var H,X;R===xs?X="prepare":p$(R)?X="active":R===f2&&(X="start");var te=fw(h,"".concat(w,"-").concat(X));$=d(Oe(Oe({},N),{},{className:Lt(fw(h,w),(H={},at(H,te,te&&X),at(H,h,typeof h=="string"),H)),style:D}),O)}if(b.isValidElement($)&&v0($)){var z=$,A=z.ref;A||($=b.cloneElement($,{ref:O}))}return b.createElement(BG,{ref:C},$)});return r.displayName="CSSMotion",r}const _0=KG(u$);var tv="add",nv="keep",rv="remove",Mm="removed";function ZG(t){var e;return t&&pr(t)==="object"&&"key"in t?e=t:e={key:t},Oe(Oe({},e),{},{key:String(e.key)})}function iv(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return t.map(ZG)}function qG(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=[],r=0,i=e.length,o=iv(t),s=iv(e);o.forEach(function(u){for(var c=!1,d=r;d<i;d+=1){var h=s[d];if(h.key===u.key){r<d&&(n=n.concat(s.slice(r,d).map(function(f){return Oe(Oe({},f),{},{status:tv})})),r=d),n.push(Oe(Oe({},h),{},{status:nv})),r+=1,c=!0;break}}c||n.push(Oe(Oe({},u),{},{status:rv}))}),r<i&&(n=n.concat(s.slice(r).map(function(u){return Oe(Oe({},u),{},{status:tv})})));var a={};n.forEach(function(u){var c=u.key;a[c]=(a[c]||0)+1});var l=Object.keys(a).filter(function(u){return a[u]>1});return l.forEach(function(u){n=n.filter(function(c){var d=c.key,h=c.status;return d!==u||h!==rv}),n.forEach(function(c){c.key===u&&(c.status=nv)})}),n}var QG=["component","children","onVisibleChanged","onAllRemoved"],JG=["status"],eK=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function tK(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_0,n=function(r){s4(o,r);var i=a4(o);function o(){var s;Vl(this,o);for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return s=i.call.apply(i,[this].concat(l)),at(Uh(s),"state",{keyEntities:[]}),at(Uh(s),"removeKey",function(c){var d=s.state.keyEntities,h=d.map(function(f){return f.key!==c?f:Oe(Oe({},f),{},{status:Mm})});return s.setState({keyEntities:h}),h.filter(function(f){var m=f.status;return m!==Mm}).length}),s}return jl(o,[{key:"render",value:function(){var s=this,a=this.state.keyEntities,l=this.props,u=l.component,c=l.children,d=l.onVisibleChanged,h=l.onAllRemoved,f=Pn(l,QG),m=u||b.Fragment,p={};return eK.forEach(function(g){p[g]=f[g],delete f[g]}),delete f.keys,b.createElement(m,f,a.map(function(g,v){var _=g.status,C=Pn(g,JG),y=_===tv||_===nv;return b.createElement(e,Wt({},p,{key:C.key,visible:y,eventProps:C,onVisibleChanged:function(S){if(d==null||d(S,{key:C.key}),!S){var E=s.removeKey(C.key);E===0&&h&&h()}}}),function(S,E){return c(Oe(Oe({},S),{},{index:v}),E)})}))}}],[{key:"getDerivedStateFromProps",value:function(s,a){var l=s.keys,u=a.keyEntities,c=iv(l),d=qG(u,c);return{keyEntities:d.filter(function(h){var f=u.find(function(m){var p=m.key;return h.key===p});return!(f&&f.status===Mm&&h.status===rv)})}}}]),o}(b.Component);return at(n,"defaultProps",{component:"div"}),n}tK(u$);const nK=b.memo(function(t){var e=t.children;return e},function(t,e){var n=e.shouldUpdate;return!n});var pw={width:0,height:0,overflow:"hidden",outline:"none"},rK=Qe.forwardRef(function(t,e){var n=t.prefixCls,r=t.className,i=t.style,o=t.title,s=t.ariaId,a=t.footer,l=t.closable,u=t.closeIcon,c=t.onClose,d=t.children,h=t.bodyStyle,f=t.bodyProps,m=t.modalRender,p=t.onMouseDown,g=t.onMouseUp,v=t.holderRef,_=t.visible,C=t.forceRender,y=t.width,S=t.height,E=t.classNames,w=t.styles,R=Qe.useContext(n$),D=R.panel,I=g0(v,D),k=b.useRef(),O=b.useRef();Qe.useImperativeHandle(e,function(){return{focus:function(){var z;(z=k.current)===null||z===void 0||z.focus()},changeActive:function(z){var A=document,T=A.activeElement;z&&T===O.current?k.current.focus():!z&&T===k.current&&O.current.focus()}}});var $={};y!==void 0&&($.width=y),S!==void 0&&($.height=S);var N;a&&(N=Qe.createElement("div",{className:Lt("".concat(n,"-footer"),E==null?void 0:E.footer),style:Oe({},w==null?void 0:w.footer)},a));var H;o&&(H=Qe.createElement("div",{className:Lt("".concat(n,"-header"),E==null?void 0:E.header),style:Oe({},w==null?void 0:w.header)},Qe.createElement("div",{className:"".concat(n,"-title"),id:s},o)));var X;l&&(X=Qe.createElement("button",{type:"button",onClick:c,"aria-label":"Close",className:"".concat(n,"-close")},u||Qe.createElement("span",{className:"".concat(n,"-close-x")})));var te=Qe.createElement("div",{className:Lt("".concat(n,"-content"),E==null?void 0:E.content),style:w==null?void 0:w.content},X,H,Qe.createElement("div",Wt({className:Lt("".concat(n,"-body"),E==null?void 0:E.body),style:Oe(Oe({},h),w==null?void 0:w.body)},f),d),N);return Qe.createElement("div",{key:"dialog-element",role:"dialog","aria-labelledby":o?s:null,"aria-modal":"true",ref:I,style:Oe(Oe({},i),$),className:Lt(n,r),onMouseDown:p,onMouseUp:g},Qe.createElement("div",{tabIndex:0,ref:k,style:pw,"aria-hidden":"true"}),Qe.createElement(nK,{shouldUpdate:_||C},m?m(te):te),Qe.createElement("div",{tabIndex:0,ref:O,style:pw,"aria-hidden":"true"}))}),g$=b.forwardRef(function(t,e){var n=t.prefixCls,r=t.title,i=t.style,o=t.className,s=t.visible,a=t.forceRender,l=t.destroyOnClose,u=t.motionName,c=t.ariaId,d=t.onVisibleChanged,h=t.mousePosition,f=b.useRef(),m=b.useState(),p=ze(m,2),g=p[0],v=p[1],_={};g&&(_.transformOrigin=g);function C(){var y=LG(f.current);v(h?"".concat(h.x-y.left,"px ").concat(h.y-y.top,"px"):"")}return b.createElement(_0,{visible:s,onVisibleChanged:d,onAppearPrepare:C,onEnterPrepare:C,forceRender:a,motionName:u,removeOnLeave:l,ref:f},function(y,S){var E=y.className,w=y.style;return b.createElement(rK,Wt({},t,{ref:e,title:r,ariaId:c,prefixCls:n,holderRef:S,style:Oe(Oe(Oe({},w),i),_),className:Lt(o,E)}))})});g$.displayName="Content";function iK(t){var e=t.prefixCls,n=t.style,r=t.visible,i=t.maskProps,o=t.motionName,s=t.className;return b.createElement(_0,{key:"mask",visible:r,motionName:o,leavedClassName:"".concat(e,"-mask-hidden")},function(a,l){var u=a.className,c=a.style;return b.createElement("div",Wt({ref:l,style:Oe(Oe({},c),n),className:Lt("".concat(e,"-mask"),u,s)},i))})}function oK(t){var e=t.prefixCls,n=e===void 0?"rc-dialog":e,r=t.zIndex,i=t.visible,o=i===void 0?!1:i,s=t.keyboard,a=s===void 0?!0:s,l=t.focusTriggerAfterClose,u=l===void 0?!0:l,c=t.wrapStyle,d=t.wrapClassName,h=t.wrapProps,f=t.onClose,m=t.afterOpenChange,p=t.afterClose,g=t.transitionName,v=t.animation,_=t.closable,C=_===void 0?!0:_,y=t.mask,S=y===void 0?!0:y,E=t.maskTransitionName,w=t.maskAnimation,R=t.maskClosable,D=R===void 0?!0:R,I=t.maskStyle,k=t.maskProps,O=t.rootClassName,$=t.classNames,N=t.styles,H=b.useRef(),X=b.useRef(),te=b.useRef(),z=b.useState(o),A=ze(z,2),T=A[0],P=A[1],K=r$();function ee(){Jg(X.current,document.activeElement)||(H.current=document.activeElement)}function ue(){if(!Jg(X.current,document.activeElement)){var we;(we=te.current)===null||we===void 0||we.focus()}}function fe(we){if(we)ue();else{if(P(!1),S&&H.current&&u){try{H.current.focus({preventScroll:!0})}catch{}H.current=null}T&&(p==null||p())}m==null||m(we)}function Ee(we){f==null||f(we)}var Q=b.useRef(!1),re=b.useRef(),Se=function(){clearTimeout(re.current),Q.current=!0},_e=function(){re.current=setTimeout(function(){Q.current=!1})},He=null;D&&(He=function(we){Q.current?Q.current=!1:X.current===we.target&&Ee(we)});function Ne(we){if(a&&we.keyCode===ot.ESC){we.stopPropagation(),Ee(we);return}o&&we.keyCode===ot.TAB&&te.current.changeActive(!we.shiftKey)}return b.useEffect(function(){o&&(P(!0),ee())},[o]),b.useEffect(function(){return function(){clearTimeout(re.current)}},[]),b.createElement("div",Wt({className:Lt("".concat(n,"-root"),O)},x6(t,{data:!0})),b.createElement(iK,{prefixCls:n,visible:S&&o,motionName:aw(n,E,w),style:Oe(Oe({zIndex:r},I),N==null?void 0:N.mask),maskProps:k,className:$==null?void 0:$.mask}),b.createElement("div",Wt({tabIndex:-1,onKeyDown:Ne,className:Lt("".concat(n,"-wrap"),d,$==null?void 0:$.wrapper),ref:X,onClick:He,style:Oe(Oe(Oe({zIndex:r},c),N==null?void 0:N.wrapper),{},{display:T?null:"none"})},h),b.createElement(g$,Wt({},t,{onMouseDown:Se,onMouseUp:_e,ref:te,closable:C,ariaId:K,prefixCls:n,visible:o&&T,onClose:Ee,onVisibleChanged:fe,motionName:aw(n,g,v)}))))}var v$=function(t){var e=t.visible,n=t.getContainer,r=t.forceRender,i=t.destroyOnClose,o=i===void 0?!1:i,s=t.afterClose,a=t.panelRef,l=b.useState(e),u=ze(l,2),c=u[0],d=u[1],h=b.useMemo(function(){return{panel:a}},[a]);return b.useEffect(function(){e&&d(!0)},[e]),!r&&o&&!c?null:b.createElement(n$.Provider,{value:h},b.createElement(dC,{open:e||r||c,autoDestroy:!1,getContainer:n,autoLock:e||c},b.createElement(oK,Wt({},t,{destroyOnClose:o,afterClose:function(){s==null||s(),d(!1)}}))))};v$.displayName="Dialog";var _9={exports:{}},_$={},b$={exports:{}},sK="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",aK=sK,lK=aK;function C$(){}function y$(){}y$.resetWarningCache=C$;var uK=function(){function t(r,i,o,s,a,l){if(l!==lK){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:y$,resetWarningCache:C$};return n.PropTypes=n,n};b$.exports=uK();var S$=b$.exports,Br={},Na={};Object.defineProperty(Na,"__esModule",{value:!0});Na.dontSetMe=mK;Na.findInArray=cK;Na.int=fK;Na.isFunction=dK;Na.isNum=hK;function cK(t,e){for(let n=0,r=t.length;n<r;n++)if(e.apply(e,[t[n],n,t]))return t[n]}function dK(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function hK(t){return typeof t=="number"&&!isNaN(t)}function fK(t){return parseInt(t,10)}function mK(t,e,n){if(t[e])return new Error("Invalid prop ".concat(e," passed to ").concat(n," - do not set this, set it on the child."))}var lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.browserPrefixToKey=w$;lc.browserPrefixToStyle=pK;lc.default=void 0;lc.getPrefix=E$;const Om=["Moz","Webkit","O","ms"];function E$(){var t;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const n=(t=window.document)===null||t===void 0||(t=t.documentElement)===null||t===void 0?void 0:t.style;if(!n||e in n)return"";for(let r=0;r<Om.length;r++)if(w$(e,Om[r])in n)return Om[r];return""}function w$(t,e){return e?"".concat(e).concat(gK(t)):t}function pK(t,e){return e?"-".concat(e.toLowerCase(),"-").concat(t):t}function gK(t){let e="",n=!0;for(let r=0;r<t.length;r++)n?(e+=t[r].toUpperCase(),n=!1):t[r]==="-"?n=!0:e+=t[r];return e}lc.default=E$();Object.defineProperty(Br,"__esModule",{value:!0});Br.addClassName=I$;Br.addEvent=bK;Br.addUserSelectStyles=OK;Br.createCSSTransform=DK;Br.createSVGTransform=IK;Br.getTouch=xK;Br.getTouchIdentifier=MK;Br.getTranslation=mC;Br.innerHeight=EK;Br.innerWidth=wK;Br.matchesSelector=D$;Br.matchesSelectorAndParentsTo=_K;Br.offsetXYFromParent=RK;Br.outerHeight=yK;Br.outerWidth=SK;Br.removeClassName=x$;Br.removeEvent=CK;Br.removeUserSelectStyles=TK;var Bo=Na,gw=vK(lc);function R$(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(R$=function(r){return r?n:e})(t)}function vK(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=R$(e);if(n&&n.has(t))return n.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=t[o]}return r.default=t,n&&n.set(t,r),r}let T7="";function D$(t,e){return T7||(T7=(0,Bo.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(n){return(0,Bo.isFunction)(t[n])})),(0,Bo.isFunction)(t[T7])?t[T7](e):!1}function _K(t,e,n){let r=t;do{if(D$(r,e))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1}function bK(t,e,n,r){if(!t)return;const i={capture:!0,...r};t.addEventListener?t.addEventListener(e,n,i):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n}function CK(t,e,n,r){if(!t)return;const i={capture:!0,...r};t.removeEventListener?t.removeEventListener(e,n,i):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null}function yK(t){let e=t.clientHeight;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,Bo.int)(n.borderTopWidth),e+=(0,Bo.int)(n.borderBottomWidth),e}function SK(t){let e=t.clientWidth;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,Bo.int)(n.borderLeftWidth),e+=(0,Bo.int)(n.borderRightWidth),e}function EK(t){let e=t.clientHeight;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,Bo.int)(n.paddingTop),e-=(0,Bo.int)(n.paddingBottom),e}function wK(t){let e=t.clientWidth;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,Bo.int)(n.paddingLeft),e-=(0,Bo.int)(n.paddingRight),e}function RK(t,e,n){const r=e===e.ownerDocument.body?{left:0,top:0}:e.getBoundingClientRect(),i=(t.clientX+e.scrollLeft-r.left)/n,o=(t.clientY+e.scrollTop-r.top)/n;return{x:i,y:o}}function DK(t,e){const n=mC(t,e,"px");return{[(0,gw.browserPrefixToKey)("transform",gw.default)]:n}}function IK(t,e){return mC(t,e,"")}function mC(t,e,n){let{x:r,y:i}=t,o="translate(".concat(r).concat(n,",").concat(i).concat(n,")");if(e){const s="".concat(typeof e.x=="string"?e.x:e.x+n),a="".concat(typeof e.y=="string"?e.y:e.y+n);o="translate(".concat(s,", ").concat(a,")")+o}return o}function xK(t,e){return t.targetTouches&&(0,Bo.findInArray)(t.targetTouches,n=>e===n.identifier)||t.changedTouches&&(0,Bo.findInArray)(t.changedTouches,n=>e===n.identifier)}function MK(t){if(t.targetTouches&&t.targetTouches[0])return t.targetTouches[0].identifier;if(t.changedTouches&&t.changedTouches[0])return t.changedTouches[0].identifier}function OK(t){if(!t)return;let e=t.getElementById("react-draggable-style-el");e||(e=t.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,t.getElementsByTagName("head")[0].appendChild(e)),t.body&&I$(t.body,"react-draggable-transparent-selection")}function TK(t){if(t)try{if(t.body&&x$(t.body,"react-draggable-transparent-selection"),t.selection)t.selection.empty();else{const e=(t.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch{}}function I$(t,e){t.classList?t.classList.add(e):t.className.match(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)")))||(t.className+=" ".concat(e))}function x$(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g"),"")}var La={};Object.defineProperty(La,"__esModule",{value:!0});La.canDragX=AK;La.canDragY=NK;La.createCoreData=PK;La.createDraggableData=BK;La.getBoundPosition=$K;La.getControlPosition=LK;La.snapToGrid=kK;var Mo=Na,p2=Br;function $K(t,e,n){if(!t.props.bounds)return[e,n];let{bounds:r}=t.props;r=typeof r=="string"?r:FK(r);const i=pC(t);if(typeof r=="string"){const{ownerDocument:o}=i,s=o.defaultView;let a;if(r==="parent"?a=i.parentNode:a=o.querySelector(r),!(a instanceof s.HTMLElement))throw new Error('Bounds selector "'+r+'" could not find an element.');const l=a,u=s.getComputedStyle(i),c=s.getComputedStyle(l);r={left:-i.offsetLeft+(0,Mo.int)(c.paddingLeft)+(0,Mo.int)(u.marginLeft),top:-i.offsetTop+(0,Mo.int)(c.paddingTop)+(0,Mo.int)(u.marginTop),right:(0,p2.innerWidth)(l)-(0,p2.outerWidth)(i)-i.offsetLeft+(0,Mo.int)(c.paddingRight)-(0,Mo.int)(u.marginRight),bottom:(0,p2.innerHeight)(l)-(0,p2.outerHeight)(i)-i.offsetTop+(0,Mo.int)(c.paddingBottom)-(0,Mo.int)(u.marginBottom)}}return(0,Mo.isNum)(r.right)&&(e=Math.min(e,r.right)),(0,Mo.isNum)(r.bottom)&&(n=Math.min(n,r.bottom)),(0,Mo.isNum)(r.left)&&(e=Math.max(e,r.left)),(0,Mo.isNum)(r.top)&&(n=Math.max(n,r.top)),[e,n]}function kK(t,e,n){const r=Math.round(e/t[0])*t[0],i=Math.round(n/t[1])*t[1];return[r,i]}function AK(t){return t.props.axis==="both"||t.props.axis==="x"}function NK(t){return t.props.axis==="both"||t.props.axis==="y"}function LK(t,e,n){const r=typeof e=="number"?(0,p2.getTouch)(t,e):null;if(typeof e=="number"&&!r)return null;const i=pC(n),o=n.props.offsetParent||i.offsetParent||i.ownerDocument.body;return(0,p2.offsetXYFromParent)(r||t,o,n.props.scale)}function PK(t,e,n){const r=!(0,Mo.isNum)(t.lastX),i=pC(t);return r?{node:i,deltaX:0,deltaY:0,lastX:e,lastY:n,x:e,y:n}:{node:i,deltaX:e-t.lastX,deltaY:n-t.lastY,lastX:t.lastX,lastY:t.lastY,x:e,y:n}}function BK(t,e){const n=t.props.scale;return{node:e.node,x:t.state.x+e.deltaX/n,y:t.state.y+e.deltaY/n,deltaX:e.deltaX/n,deltaY:e.deltaY/n,lastX:t.state.x,lastY:t.state.y}}function FK(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}function pC(t){const e=t.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var b9={},C9={};Object.defineProperty(C9,"__esModule",{value:!0});C9.default=UK;function UK(){}Object.defineProperty(b9,"__esModule",{value:!0});b9.default=void 0;var Tm=VK(Qe),no=gC(S$),HK=gC(_a),Ti=Br,P1=La,$m=Na,q0=gC(C9);function gC(t){return t&&t.__esModule?t:{default:t}}function M$(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(M$=function(r){return r?n:e})(t)}function VK(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=M$(e);if(n&&n.has(t))return n.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=t[o]}return r.default=t,n&&n.set(t,r),r}function Vi(t,e,n){return e=jK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jK(t){var e=zK(t,"string");return typeof e=="symbol"?e:String(e)}function zK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Es={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let B1=Es.mouse,y9=class extends Tm.Component{constructor(){super(...arguments),Vi(this,"dragging",!1),Vi(this,"lastX",NaN),Vi(this,"lastY",NaN),Vi(this,"touchIdentifier",null),Vi(this,"mounted",!1),Vi(this,"handleDragStart",e=>{if(this.props.onMouseDown(e),!this.props.allowAnyClick&&typeof e.button=="number"&&e.button!==0)return!1;const n=this.findDOMNode();if(!n||!n.ownerDocument||!n.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:r}=n;if(this.props.disabled||!(e.target instanceof r.defaultView.Node)||this.props.handle&&!(0,Ti.matchesSelectorAndParentsTo)(e.target,this.props.handle,n)||this.props.cancel&&(0,Ti.matchesSelectorAndParentsTo)(e.target,this.props.cancel,n))return;e.type==="touchstart"&&e.preventDefault();const i=(0,Ti.getTouchIdentifier)(e);this.touchIdentifier=i;const o=(0,P1.getControlPosition)(e,i,this);if(o==null)return;const{x:s,y:a}=o,l=(0,P1.createCoreData)(this,s,a);(0,q0.default)("DraggableCore: handleDragStart: %j",l),(0,q0.default)("calling",this.props.onStart),!(this.props.onStart(e,l)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,Ti.addUserSelectStyles)(r),this.dragging=!0,this.lastX=s,this.lastY=a,(0,Ti.addEvent)(r,B1.move,this.handleDrag),(0,Ti.addEvent)(r,B1.stop,this.handleDragStop))}),Vi(this,"handleDrag",e=>{const n=(0,P1.getControlPosition)(e,this.touchIdentifier,this);if(n==null)return;let{x:r,y:i}=n;if(Array.isArray(this.props.grid)){let s=r-this.lastX,a=i-this.lastY;if([s,a]=(0,P1.snapToGrid)(this.props.grid,s,a),!s&&!a)return;r=this.lastX+s,i=this.lastY+a}const o=(0,P1.createCoreData)(this,r,i);if((0,q0.default)("DraggableCore: handleDrag: %j",o),this.props.onDrag(e,o)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const s=document.createEvent("MouseEvents");s.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(s)}return}this.lastX=r,this.lastY=i}),Vi(this,"handleDragStop",e=>{if(!this.dragging)return;const n=(0,P1.getControlPosition)(e,this.touchIdentifier,this);if(n==null)return;let{x:r,y:i}=n;if(Array.isArray(this.props.grid)){let a=r-this.lastX||0,l=i-this.lastY||0;[a,l]=(0,P1.snapToGrid)(this.props.grid,a,l),r=this.lastX+a,i=this.lastY+l}const o=(0,P1.createCoreData)(this,r,i);if(this.props.onStop(e,o)===!1||this.mounted===!1)return!1;const s=this.findDOMNode();s&&this.props.enableUserSelectHack&&(0,Ti.removeUserSelectStyles)(s.ownerDocument),(0,q0.default)("DraggableCore: handleDragStop: %j",o),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,s&&((0,q0.default)("DraggableCore: Removing handlers"),(0,Ti.removeEvent)(s.ownerDocument,B1.move,this.handleDrag),(0,Ti.removeEvent)(s.ownerDocument,B1.stop,this.handleDragStop))}),Vi(this,"onMouseDown",e=>(B1=Es.mouse,this.handleDragStart(e))),Vi(this,"onMouseUp",e=>(B1=Es.mouse,this.handleDragStop(e))),Vi(this,"onTouchStart",e=>(B1=Es.touch,this.handleDragStart(e))),Vi(this,"onTouchEnd",e=>(B1=Es.touch,this.handleDragStop(e)))}componentDidMount(){this.mounted=!0;const e=this.findDOMNode();e&&(0,Ti.addEvent)(e,Es.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const e=this.findDOMNode();if(e){const{ownerDocument:n}=e;(0,Ti.removeEvent)(n,Es.mouse.move,this.handleDrag),(0,Ti.removeEvent)(n,Es.touch.move,this.handleDrag),(0,Ti.removeEvent)(n,Es.mouse.stop,this.handleDragStop),(0,Ti.removeEvent)(n,Es.touch.stop,this.handleDragStop),(0,Ti.removeEvent)(e,Es.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,Ti.removeUserSelectStyles)(n)}}findDOMNode(){var e,n;return(e=this.props)!==null&&e!==void 0&&e.nodeRef?(n=this.props)===null||n===void 0||(n=n.nodeRef)===null||n===void 0?void 0:n.current:HK.default.findDOMNode(this)}render(){return Tm.cloneElement(Tm.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};b9.default=y9;Vi(y9,"displayName","DraggableCore");Vi(y9,"propTypes",{allowAnyClick:no.default.bool,children:no.default.node.isRequired,disabled:no.default.bool,enableUserSelectHack:no.default.bool,offsetParent:function(t,e){if(t[e]&&t[e].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:no.default.arrayOf(no.default.number),handle:no.default.string,cancel:no.default.string,nodeRef:no.default.object,onStart:no.default.func,onDrag:no.default.func,onStop:no.default.func,onMouseDown:no.default.func,scale:no.default.number,className:$m.dontSetMe,style:$m.dontSetMe,transform:$m.dontSetMe});Vi(y9,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return l.default}}),t.default=void 0;var e=h(Qe),n=c(S$),r=c(_a),i=c(wi),o=Br,s=La,a=Na,l=c(b9),u=c(C9);function c(_){return _&&_.__esModule?_:{default:_}}function d(_){if(typeof WeakMap!="function")return null;var C=new WeakMap,y=new WeakMap;return(d=function(S){return S?y:C})(_)}function h(_,C){if(!C&&_&&_.__esModule)return _;if(_===null||typeof _!="object"&&typeof _!="function")return{default:_};var y=d(C);if(y&&y.has(_))return y.get(_);var S={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in _)if(w!=="default"&&Object.prototype.hasOwnProperty.call(_,w)){var R=E?Object.getOwnPropertyDescriptor(_,w):null;R&&(R.get||R.set)?Object.defineProperty(S,w,R):S[w]=_[w]}return S.default=_,y&&y.set(_,S),S}function f(){return f=Object.assign?Object.assign.bind():function(_){for(var C=1;C<arguments.length;C++){var y=arguments[C];for(var S in y)Object.prototype.hasOwnProperty.call(y,S)&&(_[S]=y[S])}return _},f.apply(this,arguments)}function m(_,C,y){return C=p(C),C in _?Object.defineProperty(_,C,{value:y,enumerable:!0,configurable:!0,writable:!0}):_[C]=y,_}function p(_){var C=g(_,"string");return typeof C=="symbol"?C:String(C)}function g(_,C){if(typeof _!="object"||_===null)return _;var y=_[Symbol.toPrimitive];if(y!==void 0){var S=y.call(_,C||"default");if(typeof S!="object")return S;throw new TypeError("@@toPrimitive must return a primitive value.")}return(C==="string"?String:Number)(_)}class v extends e.Component{static getDerivedStateFromProps(C,y){let{position:S}=C,{prevPropsPosition:E}=y;return S&&(!E||S.x!==E.x||S.y!==E.y)?((0,u.default)("Draggable: getDerivedStateFromProps %j",{position:S,prevPropsPosition:E}),{x:S.x,y:S.y,prevPropsPosition:{...S}}):null}constructor(C){super(C),m(this,"onDragStart",(y,S)=>{if((0,u.default)("Draggable: onDragStart: %j",S),this.props.onStart(y,(0,s.createDraggableData)(this,S))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),m(this,"onDrag",(y,S)=>{if(!this.state.dragging)return!1;(0,u.default)("Draggable: onDrag: %j",S);const E=(0,s.createDraggableData)(this,S),w={x:E.x,y:E.y,slackX:0,slackY:0};if(this.props.bounds){const{x:R,y:D}=w;w.x+=this.state.slackX,w.y+=this.state.slackY;const[I,k]=(0,s.getBoundPosition)(this,w.x,w.y);w.x=I,w.y=k,w.slackX=this.state.slackX+(R-w.x),w.slackY=this.state.slackY+(D-w.y),E.x=w.x,E.y=w.y,E.deltaX=w.x-this.state.x,E.deltaY=w.y-this.state.y}if(this.props.onDrag(y,E)===!1)return!1;this.setState(w)}),m(this,"onDragStop",(y,S)=>{if(!this.state.dragging||this.props.onStop(y,(0,s.createDraggableData)(this,S))===!1)return!1;(0,u.default)("Draggable: onDragStop: %j",S);const E={dragging:!1,slackX:0,slackY:0};if(this.props.position){const{x:w,y:R}=this.props.position;E.x=w,E.y=R}this.setState(E)}),this.state={dragging:!1,dragged:!1,x:C.position?C.position.x:C.defaultPosition.x,y:C.position?C.position.y:C.defaultPosition.y,prevPropsPosition:{...C.position},slackX:0,slackY:0,isElementSVG:!1},C.position&&!(C.onDrag||C.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var C,y;return(C=(y=this.props)===null||y===void 0||(y=y.nodeRef)===null||y===void 0?void 0:y.current)!==null&&C!==void 0?C:r.default.findDOMNode(this)}render(){const{axis:C,bounds:y,children:S,defaultPosition:E,defaultClassName:w,defaultClassNameDragging:R,defaultClassNameDragged:D,position:I,positionOffset:k,scale:O,...$}=this.props;let N={},H=null;const X=!I||this.state.dragging,te=I||E,z={x:(0,s.canDragX)(this)&&X?this.state.x:te.x,y:(0,s.canDragY)(this)&&X?this.state.y:te.y};this.state.isElementSVG?H=(0,o.createSVGTransform)(z,k):N=(0,o.createCSSTransform)(z,k);const A=(0,i.default)(S.props.className||"",w,{[R]:this.state.dragging,[D]:this.state.dragged});return e.createElement(l.default,f({},$,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(S),{className:A,style:{...S.props.style,...N},transform:H}))}}t.default=v,m(v,"displayName","Draggable"),m(v,"propTypes",{...l.default.propTypes,axis:n.default.oneOf(["both","x","y","none"]),bounds:n.default.oneOfType([n.default.shape({left:n.default.number,right:n.default.number,top:n.default.number,bottom:n.default.number}),n.default.string,n.default.oneOf([!1])]),defaultClassName:n.default.string,defaultClassNameDragging:n.default.string,defaultClassNameDragged:n.default.string,defaultPosition:n.default.shape({x:n.default.number,y:n.default.number}),positionOffset:n.default.shape({x:n.default.oneOfType([n.default.number,n.default.string]),y:n.default.oneOfType([n.default.number,n.default.string])}),position:n.default.shape({x:n.default.number,y:n.default.number}),className:a.dontSetMe,style:a.dontSetMe,transform:a.dontSetMe}),m(v,"defaultProps",{...l.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(_$);const{default:O$,DraggableCore:WK}=_$;_9.exports=O$;_9.exports.default=O$;_9.exports.DraggableCore=WK;var XK=_9.exports;const YK=CT(XK),GK="univer-dialog",KK="univer-dialog-wrap",ZK="univer-dialog-title",qK="univer-dialog-content",QK="univer-dialog-close",JK="univer-dialog-header",eZ="univer-dialog-body",tZ="univer-dialog-footer",nZ="univer-dialog-zoom-enter",rZ="univer-dialog-zoom-appear",iZ="univer-dialog-zoom-leave",oZ="univer-dialog-zoom-enter-active",sZ="univer-dialog-zoom-appear-active",aZ="univer-dialog-zoom-in",lZ="univer-dialog-zoom-leave-active",uZ="univer-dialog-zoom-out",cZ="univer-dialog-mask",dZ="univer-dialog-mask-hidden",hZ="univer-dialog-fade-enter",fZ="univer-dialog-fade-appear",mZ="univer-dialog-fade-leave",pZ="univer-dialog-fade-enter-active",gZ="univer-dialog-fade-appear-active",vZ="univer-dialog-fade-in",_Z="univer-dialog-fade-leave-active",bZ="univer-dialog-fade-out",CZ={dialog:GK,dialogWrap:KK,dialogTitle:ZK,dialogContent:qK,dialogClose:QK,dialogHeader:JK,dialogBody:eZ,dialogFooter:tZ,dialogZoomEnter:nZ,dialogZoomAppear:rZ,dialogZoomLeave:iZ,dialogZoomEnterActive:oZ,dialogZoomAppearActive:sZ,dialogZoomIn:aZ,dialogZoomLeaveActive:lZ,dialogZoomOut:uZ,dialogMask:cZ,dialogMaskHidden:dZ,dialogFadeEnter:hZ,dialogFadeAppear:fZ,dialogFadeLeave:mZ,dialogFadeEnterActive:pZ,dialogFadeAppearActive:gZ,dialogFadeIn:vZ,dialogFadeLeaveActive:_Z,dialogFadeOut:bZ};function T$(t){const{children:e,visible:n=!1,title:r,draggable:i=!1,closeIcon:o,footer:s,onClose:a}=t,[l,u]=b.useState(!1),{mountContainer:c}=b.useContext(R1),d=i?$t.jsx("div",{style:{width:"100%",cursor:"pointer"},onMouseOver:()=>{l&&u(!1)},onMouseOut:()=>{u(!0)},onFocus:()=>{},onBlur:()=>{},children:r}):r,h=f=>i?$t.jsx(YK,{disabled:l,children:f}):f;return $t.jsx(v$,{prefixCls:CZ.dialog,getContainer:()=>c,visible:n,title:d,modalRender:h,closeIcon:o,footer:s,onClose:a,children:e})}const yZ="univer-confirm-footer",SZ={confirmFooter:yZ};function EZ(t){const{children:e,visible:n=!1,title:r,cancelText:i,confirmText:o,onClose:s,onConfirm:a}=t,{locale:l}=b.useContext(R1);function u(){return $t.jsxs("footer",{className:SZ.confirmFooter,children:[$t.jsx(c1,{onClick:s,children:i??l.design.Confirm.cancel}),$t.jsx(c1,{type:"primary",onClick:a,children:o??l.design.Confirm.confirm})]})}return $t.jsx(T$,{visible:n,title:r,footer:$t.jsx(u,{}),onClose:s,children:e})}b.forwardRef((t,e)=>{const{children:n,className:r,style:i,onClick:o,onContextMenu:s}=t;return $t.jsx("section",{ref:e,className:r,style:i,onClick:o,onContextMenu:s,children:n})});function M6(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[];return Qe.Children.forEach(t,function(r){r==null&&!e.keepEmpty||(Array.isArray(r)?n=n.concat(M6(r)):KT.isFragment(r)&&r.props?n=n.concat(M6(r.props.children,e)):n.push(r))}),n}var ov=b.createContext(null);function wZ(t){var e=t.children,n=t.onBatchResize,r=b.useRef(0),i=b.useRef([]),o=b.useContext(ov),s=b.useCallback(function(a,l,u){r.current+=1;var c=r.current;i.current.push({size:a,element:l,data:u}),Promise.resolve().then(function(){c===r.current&&(n==null||n(i.current),i.current=[])}),o==null||o(a,l,u)},[n,o]);return b.createElement(ov.Provider,{value:s},e)}var $$=function(){if(typeof Map<"u")return Map;function t(e,n){var r=-1;return e.some(function(i,o){return i[0]===n?(r=o,!0):!1}),r}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(n){var r=t(this.__entries__,n),i=this.__entries__[r];return i&&i[1]},e.prototype.set=function(n,r){var i=t(this.__entries__,n);~i?this.__entries__[i][1]=r:this.__entries__.push([n,r])},e.prototype.delete=function(n){var r=this.__entries__,i=t(r,n);~i&&r.splice(i,1)},e.prototype.has=function(n){return!!~t(this.__entries__,n)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(n,r){r===void 0&&(r=null);for(var i=0,o=this.__entries__;i<o.length;i++){var s=o[i];n.call(r,s[1],s[0])}},e}()}(),sv=typeof window<"u"&&typeof document<"u"&&window.document===document,Vh=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),RZ=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Vh):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)}}(),DZ=2;function IZ(t,e){var n=!1,r=!1,i=0;function o(){n&&(n=!1,t()),r&&a()}function s(){RZ(o)}function a(){var l=Date.now();if(n){if(l-i<DZ)return;r=!0}else n=!0,r=!1,setTimeout(s,e);i=l}return a}var xZ=20,MZ=["top","right","bottom","left","width","height","size","weight"],OZ=typeof MutationObserver<"u",TZ=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=IZ(this.refresh.bind(this),xZ)}return t.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},t.prototype.removeObserver=function(e){var n=this.observers_,r=n.indexOf(e);~r&&n.splice(r,1),!n.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},t.prototype.updateObservers_=function(){var e=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return e.forEach(function(n){return n.broadcastActive()}),e.length>0},t.prototype.connect_=function(){!sv||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),OZ?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){!sv||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(e){var n=e.propertyName,r=n===void 0?"":n,i=MZ.some(function(o){return!!~r.indexOf(o)});i&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),k$=function(t,e){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];Object.defineProperty(t,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return t},z2=function(t){var e=t&&t.ownerDocument&&t.ownerDocument.defaultView;return e||Vh},A$=S9(0,0,0,0);function jh(t){return parseFloat(t)||0}function vw(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce(function(r,i){var o=t["border-"+i+"-width"];return r+jh(o)},0)}function $Z(t){for(var e=["top","right","bottom","left"],n={},r=0,i=e;r<i.length;r++){var o=i[r],s=t["padding-"+o];n[o]=jh(s)}return n}function kZ(t){var e=t.getBBox();return S9(0,0,e.width,e.height)}function AZ(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return A$;var r=z2(t).getComputedStyle(t),i=$Z(r),o=i.left+i.right,s=i.top+i.bottom,a=jh(r.width),l=jh(r.height);if(r.boxSizing==="border-box"&&(Math.round(a+o)!==e&&(a-=vw(r,"left","right")+o),Math.round(l+s)!==n&&(l-=vw(r,"top","bottom")+s)),!LZ(t)){var u=Math.round(a+o)-e,c=Math.round(l+s)-n;Math.abs(u)!==1&&(a-=u),Math.abs(c)!==1&&(l-=c)}return S9(i.left,i.top,a,l)}var NZ=function(){return typeof SVGGraphicsElement<"u"?function(t){return t instanceof z2(t).SVGGraphicsElement}:function(t){return t instanceof z2(t).SVGElement&&typeof t.getBBox=="function"}}();function LZ(t){return t===z2(t).document.documentElement}function PZ(t){return sv?NZ(t)?kZ(t):AZ(t):A$}function BZ(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,s=Object.create(o.prototype);return k$(s,{x:e,y:n,width:r,height:i,top:n,right:e+r,bottom:i+n,left:e}),s}function S9(t,e,n,r){return{x:t,y:e,width:n,height:r}}var FZ=function(){function t(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=S9(0,0,0,0),this.target=e}return t.prototype.isActive=function(){var e=PZ(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},t}(),UZ=function(){function t(e,n){var r=BZ(n);k$(this,{target:e,contentRect:r})}return t}(),HZ=function(){function t(e,n,r){if(this.activeObservations_=[],this.observations_=new $$,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=n,this.callbackCtx_=r}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof z2(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)||(n.set(e,new FZ(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof z2(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)&&(n.delete(e),n.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&e.activeObservations_.push(n)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,n=this.activeObservations_.map(function(r){return new UZ(r.target,r.broadcastRect())});this.callback_.call(e,n,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),N$=typeof WeakMap<"u"?new WeakMap:new $$,L$=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=TZ.getInstance(),r=new HZ(e,n,this);N$.set(this,r)}return t}();["observe","unobserve","disconnect"].forEach(function(t){L$.prototype[t]=function(){var e;return(e=N$.get(this))[t].apply(e,arguments)}});var VZ=function(){return typeof Vh.ResizeObserver<"u"?Vh.ResizeObserver:L$}(),tl=new Map;function jZ(t){t.forEach(function(e){var n,r=e.target;(n=tl.get(r))===null||n===void 0||n.forEach(function(i){return i(r)})})}var P$=new VZ(jZ);function zZ(t,e){tl.has(t)||(tl.set(t,new Set),P$.observe(t)),tl.get(t).add(e)}function WZ(t,e){tl.has(t)&&(tl.get(t).delete(e),tl.get(t).size||(P$.unobserve(t),tl.delete(t)))}var XZ=function(t){s4(n,t);var e=a4(n);function n(){return Vl(this,n),e.apply(this,arguments)}return jl(n,[{key:"render",value:function(){return this.props.children}}]),n}(b.Component);function YZ(t,e){var n=t.children,r=t.disabled,i=b.useRef(null),o=b.useRef(null),s=b.useContext(ov),a=typeof n=="function",l=a?n(i):n,u=b.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),c=!a&&b.isValidElement(l)&&v0(l),d=c?l.ref:null,h=g0(d,i),f=function(){var g;return Kd(i.current)||(i.current&&pr(i.current)==="object"?Kd((g=i.current)===null||g===void 0?void 0:g.nativeElement):null)||Kd(o.current)};b.useImperativeHandle(e,function(){return f()});var m=b.useRef(t);m.current=t;var p=b.useCallback(function(g){var v=m.current,_=v.onResize,C=v.data,y=g.getBoundingClientRect(),S=y.width,E=y.height,w=g.offsetWidth,R=g.offsetHeight,D=Math.floor(S),I=Math.floor(E);if(u.current.width!==D||u.current.height!==I||u.current.offsetWidth!==w||u.current.offsetHeight!==R){var k={width:D,height:I,offsetWidth:w,offsetHeight:R};u.current=k;var O=w===Math.round(S)?S:w,$=R===Math.round(E)?E:R,N=Oe(Oe({},k),{},{offsetWidth:O,offsetHeight:$});s==null||s(N,g,C),_&&Promise.resolve().then(function(){_(N,g)})}},[]);return b.useEffect(function(){var g=f();return g&&!r&&zZ(g,p),function(){return WZ(g,p)}},[i.current,r]),b.createElement(XZ,{ref:o},c?b.cloneElement(l,{ref:h}):l)}var GZ=b.forwardRef(YZ),KZ="rc-observer-key";function ZZ(t,e){var n=t.children,r=typeof n=="function"?[n]:M6(n);return r.map(function(i,o){var s=(i==null?void 0:i.key)||"".concat(KZ,"-").concat(o);return b.createElement(GZ,Wt({},t,{key:s,ref:o===0?e:void 0}),i)})}var uc=b.forwardRef(ZZ);uc.Collection=wZ;function B$(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}function qZ(t){return B$(t)instanceof ShadowRoot}function av(t){return qZ(t)?B$(t):null}function ns(t){var e=b.useRef();e.current=t;var n=b.useCallback(function(){for(var r,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(r=e.current)===null||r===void 0?void 0:r.call.apply(r,[e].concat(o))},[]);return n}const vC=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t==null?void 0:t.substr(0,4))};function QZ(t){var e=t.prefixCls,n=t.align,r=t.arrow,i=t.arrowPos,o=r||{},s=o.className,a=o.content,l=i.x,u=l===void 0?0:l,c=i.y,d=c===void 0?0:c,h=b.useRef();if(!n||!n.points)return null;var f={position:"absolute"};if(n.autoArrow!==!1){var m=n.points[0],p=n.points[1],g=m[0],v=m[1],_=p[0],C=p[1];g===_||!["t","b"].includes(g)?f.top=d:g==="t"?f.top=0:f.bottom=0,v===C||!["l","r"].includes(v)?f.left=u:v==="l"?f.left=0:f.right=0}return b.createElement("div",{ref:h,className:Lt("".concat(e,"-arrow"),s),style:f},a)}function JZ(t){var e=t.prefixCls,n=t.open,r=t.zIndex,i=t.mask,o=t.motion;return i?b.createElement(_0,Wt({},o,{motionAppear:!0,visible:n,removeOnLeave:!0}),function(s){var a=s.className;return b.createElement("div",{style:{zIndex:r},className:Lt("".concat(e,"-mask"),a)})}):null}var eq=b.memo(function(t){var e=t.children;return e},function(t,e){return e.cache}),tq=b.forwardRef(function(t,e){var n=t.popup,r=t.className,i=t.prefixCls,o=t.style,s=t.target,a=t.onVisibleChanged,l=t.open,u=t.keepDom,c=t.fresh,d=t.onClick,h=t.mask,f=t.arrow,m=t.arrowPos,p=t.align,g=t.motion,v=t.maskMotion,_=t.forceRender,C=t.getPopupContainer,y=t.autoDestroy,S=t.portal,E=t.zIndex,w=t.onMouseEnter,R=t.onMouseLeave,D=t.onPointerEnter,I=t.ready,k=t.offsetX,O=t.offsetY,$=t.offsetR,N=t.offsetB,H=t.onAlign,X=t.onPrepare,te=t.stretch,z=t.targetWidth,A=t.targetHeight,T=typeof n=="function"?n():n,P=l||u,K=(C==null?void 0:C.length)>0,ee=b.useState(!C||!K),ue=ze(ee,2),fe=ue[0],Ee=ue[1];if(Lr(function(){!fe&&K&&s&&Ee(!0)},[fe,K,s]),!fe)return null;var Q="auto",re={left:"-1000vw",top:"-1000vh",right:Q,bottom:Q};if(I||!l){var Se,_e=p.points,He=p.dynamicInset||((Se=p._experimental)===null||Se===void 0?void 0:Se.dynamicInset),Ne=He&&_e[0][1]==="r",we=He&&_e[0][0]==="b";Ne?(re.right=$,re.left=Q):(re.left=k,re.right=Q),we?(re.bottom=N,re.top=Q):(re.top=O,re.bottom=Q)}var Me={};return te&&(te.includes("height")&&A?Me.height=A:te.includes("minHeight")&&A&&(Me.minHeight=A),te.includes("width")&&z?Me.width=z:te.includes("minWidth")&&z&&(Me.minWidth=z)),l||(Me.pointerEvents="none"),b.createElement(S,{open:_||P,getContainer:C&&function(){return C(s)},autoDestroy:y},b.createElement(JZ,{prefixCls:i,open:l,zIndex:E,mask:h,motion:v}),b.createElement(uc,{onResize:H,disabled:!l},function(mt){return b.createElement(_0,Wt({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:_,leavedClassName:"".concat(i,"-hidden")},g,{onAppearPrepare:X,onEnterPrepare:X,visible:l,onVisibleChanged:function(vt){var ft;g==null||(ft=g.onVisibleChanged)===null||ft===void 0||ft.call(g,vt),a(vt)}}),function(vt,ft){var et=vt.className,ve=vt.style,Pe=Lt(i,et,r);return b.createElement("div",{ref:ac(mt,e,ft),className:Pe,style:Oe(Oe(Oe(Oe({"--arrow-x":"".concat(m.x||0,"px"),"--arrow-y":"".concat(m.y||0,"px")},re),Me),ve),{},{boxSizing:"border-box",zIndex:E},o),onMouseEnter:w,onMouseLeave:R,onPointerEnter:D,onClick:d},f&&b.createElement(QZ,{prefixCls:i,arrow:f,arrowPos:m,align:p}),b.createElement(eq,{cache:!l&&!c},T))})}))}),nq=b.forwardRef(function(t,e){var n=t.children,r=t.getTriggerDOMNode,i=v0(n),o=b.useCallback(function(a){cC(e,r?r(a):a)},[r]),s=g0(o,n.ref);return i?b.cloneElement(n,{ref:s}):n}),_w=b.createContext(null);function bw(t){return t?Array.isArray(t)?t:[t]:[]}function rq(t,e,n,r){return b.useMemo(function(){var i=bw(n??e),o=bw(r??e),s=new Set(i),a=new Set(o);return t&&(s.has("hover")&&(s.delete("hover"),s.add("click")),a.has("hover")&&(a.delete("hover"),a.add("click"))),[s,a]},[t,e,n,r])}const F$=function(t){if(!t)return!1;if(t instanceof Element){if(t.offsetParent)return!0;if(t.getBBox){var e=t.getBBox(),n=e.width,r=e.height;if(n||r)return!0}if(t.getBoundingClientRect){var i=t.getBoundingClientRect(),o=i.width,s=i.height;if(o||s)return!0}}return!1};function iq(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return n?t[0]===e[0]:t[0]===e[0]&&t[1]===e[1]}function oq(t,e,n,r){for(var i=n.points,o=Object.keys(t),s=0;s<o.length;s+=1){var a,l=o[s];if(iq((a=t[l])===null||a===void 0?void 0:a.points,i,r))return"".concat(e,"-placement-").concat(l)}return""}function Cw(t,e,n,r){return e||(n?{motionName:"".concat(t,"-").concat(n)}:r?{motionName:r}:null)}function l4(t){return t.ownerDocument.defaultView}function lv(t){for(var e=[],n=t==null?void 0:t.parentElement,r=["hidden","scroll","clip","auto"];n;){var i=l4(n).getComputedStyle(n),o=i.overflowX,s=i.overflowY,a=i.overflow;[o,s,a].some(function(l){return r.includes(l)})&&e.push(n),n=n.parentElement}return e}function O6(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Number.isNaN(t)?e:t}function Q0(t){return O6(parseFloat(t),0)}function yw(t,e){var n=Oe({},t);return(e||[]).forEach(function(r){if(!(r instanceof HTMLBodyElement||r instanceof HTMLHtmlElement)){var i=l4(r).getComputedStyle(r),o=i.overflow,s=i.overflowClipMargin,a=i.borderTopWidth,l=i.borderBottomWidth,u=i.borderLeftWidth,c=i.borderRightWidth,d=r.getBoundingClientRect(),h=r.offsetHeight,f=r.clientHeight,m=r.offsetWidth,p=r.clientWidth,g=Q0(a),v=Q0(l),_=Q0(u),C=Q0(c),y=O6(Math.round(d.width/m*1e3)/1e3),S=O6(Math.round(d.height/h*1e3)/1e3),E=(m-p-_-C)*y,w=(h-f-g-v)*S,R=g*S,D=v*S,I=_*y,k=C*y,O=0,$=0;if(o==="clip"){var N=Q0(s);O=N*y,$=N*S}var H=d.x+I-O,X=d.y+R-$,te=H+d.width+2*O-I-k-E,z=X+d.height+2*$-R-D-w;n.left=Math.max(n.left,H),n.top=Math.max(n.top,X),n.right=Math.min(n.right,te),n.bottom=Math.min(n.bottom,z)}}),n}function Sw(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n="".concat(e),r=n.match(/^(.*)\%$/);return r?t*(parseFloat(r[1])/100):parseFloat(n)}function Ew(t,e){var n=e||[],r=ze(n,2),i=r[0],o=r[1];return[Sw(t.width,i),Sw(t.height,o)]}function ww(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[t[0],t[1]]}function Ec(t,e){var n=e[0],r=e[1],i,o;return n==="t"?o=t.y:n==="b"?o=t.y+t.height:o=t.y+t.height/2,r==="l"?i=t.x:r==="r"?i=t.x+t.width:i=t.x+t.width/2,{x:i,y:o}}function F1(t,e){var n={t:"b",b:"t",l:"r",r:"l"};return t.map(function(r,i){return i===e?n[r]||"c":r}).join("")}function sq(t,e,n,r,i,o,s){var a=b.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:i[r]||{}}),l=ze(a,2),u=l[0],c=l[1],d=b.useRef(0),h=b.useMemo(function(){return e?lv(e):[]},[e]),f=b.useRef({}),m=function(){f.current={}};t||m();var p=ns(function(){if(e&&n&&t){let xn=function(Ii,Kl){var T1=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pe,$1=T.x+Ii,k1=T.y+Kl,H0=$1+Se,Q4=k1+re,Tf=Math.max($1,T1.left),$f=Math.max(k1,T1.top),kf=Math.min(H0,T1.right),Af=Math.min(Q4,T1.bottom);return Math.max(0,(kf-Tf)*(Af-$f))},gi=function(){ht=T.y+ye,Dn=ht+re,Gn=T.x+xe,zt=Gn+Se};var _,C,y=e,S=y.ownerDocument,E=l4(y),w=E.getComputedStyle(y),R=w.width,D=w.height,I=w.position,k=y.style.left,O=y.style.top,$=y.style.right,N=y.style.bottom,H=y.style.overflow,X=Oe(Oe({},i[r]),o),te=S.createElement("div");(_=y.parentElement)===null||_===void 0||_.appendChild(te),te.style.left="".concat(y.offsetLeft,"px"),te.style.top="".concat(y.offsetTop,"px"),te.style.position=I,te.style.height="".concat(y.offsetHeight,"px"),te.style.width="".concat(y.offsetWidth,"px"),y.style.left="0",y.style.top="0",y.style.right="auto",y.style.bottom="auto",y.style.overflow="hidden";var z;if(Array.isArray(n))z={x:n[0],y:n[1],width:0,height:0};else{var A=n.getBoundingClientRect();z={x:A.x,y:A.y,width:A.width,height:A.height}}var T=y.getBoundingClientRect(),P=S.documentElement,K=P.clientWidth,ee=P.clientHeight,ue=P.scrollWidth,fe=P.scrollHeight,Ee=P.scrollTop,Q=P.scrollLeft,re=T.height,Se=T.width,_e=z.height,He=z.width,Ne={left:0,top:0,right:K,bottom:ee},we={left:-Q,top:-Ee,right:ue-Q,bottom:fe-Ee},Me=X.htmlRegion,mt="visible",vt="visibleFirst";Me!=="scroll"&&Me!==vt&&(Me=mt);var ft=Me===vt,et=yw(we,h),ve=yw(Ne,h),Pe=Me===mt?ve:et,Ye=ft?ve:Pe;y.style.left="auto",y.style.top="auto",y.style.right="0",y.style.bottom="0";var bt=y.getBoundingClientRect();y.style.left=k,y.style.top=O,y.style.right=$,y.style.bottom=N,y.style.overflow=H,(C=y.parentElement)===null||C===void 0||C.removeChild(te);var Jt=O6(Math.round(Se/parseFloat(R)*1e3)/1e3),Ht=O6(Math.round(re/parseFloat(D)*1e3)/1e3);if(Jt===0||Ht===0||Hh(n)&&!F$(n))return;var Zt=X.offset,kt=X.targetOffset,gn=Ew(T,Zt),vn=ze(gn,2),Xt=vn[0],Vt=vn[1],jt=Ew(z,kt),Nt=ze(jt,2),Bn=Nt[0],W=Nt[1];z.x-=Bn,z.y-=W;var j=X.points||[],q=ze(j,2),pe=q[0],Ae=q[1],We=ww(Ae),Re=ww(pe),Te=Ec(z,We),G=Ec(T,Re),be=Oe({},X),xe=Te.x-G.x+Xt,ye=Te.y-G.y+Vt,st=xn(xe,ye),Ge=xn(xe,ye,ve),lt=Ec(z,["t","l"]),de=Ec(T,["t","l"]),Le=Ec(z,["b","r"]),Ve=Ec(T,["b","r"]),Ze=X.overflow||{},Dt=Ze.adjustX,Mt=Ze.adjustY,pn=Ze.shiftX,Yn=Ze.shiftY,Hn=function(Ii){return typeof Ii=="boolean"?Ii:Ii>=0},ht,Dn,Gn,zt;gi();var Ke=Hn(Mt),$e=Re[0]===We[0];if(Ke&&Re[0]==="t"&&(Dn>Ye.bottom||f.current.bt)){var hn=ye;$e?hn-=re-_e:hn=lt.y-Ve.y-Vt;var an=xn(xe,hn),Qn=xn(xe,hn,ve);an>st||an===st&&(!ft||Qn>=Ge)?(f.current.bt=!0,ye=hn,Vt=-Vt,be.points=[F1(Re,0),F1(We,0)]):f.current.bt=!1}if(Ke&&Re[0]==="b"&&(ht<Ye.top||f.current.tb)){var vr=ye;$e?vr+=re-_e:vr=Le.y-de.y-Vt;var mi=xn(xe,vr),wo=xn(xe,vr,ve);mi>st||mi===st&&(!ft||wo>=Ge)?(f.current.tb=!0,ye=vr,Vt=-Vt,be.points=[F1(Re,0),F1(We,0)]):f.current.tb=!1}var Fi=Hn(Dt),pi=Re[1]===We[1];if(Fi&&Re[1]==="l"&&(zt>Ye.right||f.current.rl)){var Qr=xe;pi?Qr-=Se-He:Qr=lt.x-Ve.x-Xt;var Ui=xn(Qr,ye),_s=xn(Qr,ye,ve);Ui>st||Ui===st&&(!ft||_s>=Ge)?(f.current.rl=!0,xe=Qr,Xt=-Xt,be.points=[F1(Re,1),F1(We,1)]):f.current.rl=!1}if(Fi&&Re[1]==="r"&&(Gn<Ye.left||f.current.lr)){var zr=xe;pi?zr+=Se-He:zr=Le.x-de.x-Xt;var Go=xn(zr,ye),Ro=xn(zr,ye,ve);Go>st||Go===st&&(!ft||Ro>=Ge)?(f.current.lr=!0,xe=zr,Xt=-Xt,be.points=[F1(Re,1),F1(We,1)]):f.current.lr=!1}gi();var Hi=pn===!0?0:pn;typeof Hi=="number"&&(Gn<ve.left&&(xe-=Gn-ve.left-Xt,z.x+He<ve.left+Hi&&(xe+=z.x-ve.left+He-Hi)),zt>ve.right&&(xe-=zt-ve.right-Xt,z.x>ve.right-Hi&&(xe+=z.x-ve.right+Hi)));var Di=Yn===!0?0:Yn;typeof Di=="number"&&(ht<ve.top&&(ye-=ht-ve.top-Vt,z.y+_e<ve.top+Di&&(ye+=z.y-ve.top+_e-Di)),Dn>ve.bottom&&(ye-=Dn-ve.bottom-Vt,z.y>ve.bottom-Di&&(ye+=z.y-ve.bottom+Di)));var Ko=T.x+xe,Zo=Ko+Se,B=T.y+ye,Y=B+re,U=z.x,J=U+He,ie=z.y,ae=ie+_e,Ce=Math.max(Ko,U),Ue=Math.min(Zo,J),rt=(Ce+Ue)/2,Je=rt-Ko,qe=Math.max(B,ie),It=Math.min(Y,ae),on=(qe+It)/2,An=on-B;s==null||s(e,be);var In=bt.right-T.x-(xe+T.width),wr=bt.bottom-T.y-(ye+T.height);c({ready:!0,offsetX:xe/Jt,offsetY:ye/Ht,offsetR:In/Jt,offsetB:wr/Ht,arrowX:Je/Jt,arrowY:An/Ht,scaleX:Jt,scaleY:Ht,align:be})}}),g=function(){d.current+=1;var _=d.current;Promise.resolve().then(function(){d.current===_&&p()})},v=function(){c(function(_){return Oe(Oe({},_),{},{ready:!1})})};return Lr(v,[r]),Lr(function(){t||v()},[t]),[u.ready,u.offsetX,u.offsetY,u.offsetR,u.offsetB,u.arrowX,u.arrowY,u.scaleX,u.scaleY,u.align,g]}function aq(t,e,n,r,i){Lr(function(){if(t&&e&&n){let d=function(){r(),i()};var o=e,s=n,a=lv(o),l=lv(s),u=l4(s),c=new Set([u].concat(Mr(a),Mr(l)));return c.forEach(function(h){h.addEventListener("scroll",d,{passive:!0})}),u.addEventListener("resize",d,{passive:!0}),r(),function(){c.forEach(function(h){h.removeEventListener("scroll",d),u.removeEventListener("resize",d)})}}},[t,e,n])}function lq(t,e,n,r,i,o,s,a){var l=b.useRef(t),u=b.useRef(!1);l.current!==t&&(u.current=!0,l.current=t),b.useEffect(function(){var c=mr(function(){u.current=!1});return function(){mr.cancel(c)}},[t]),b.useEffect(function(){if(e&&r&&(!i||o)){var c=function(){var S=!1,E=function(R){var D=R.target;S=s(D)},w=function(R){var D=R.target;!u.current&&l.current&&!S&&!s(D)&&a(!1)};return[E,w]},d=c(),h=ze(d,2),f=h[0],m=h[1],p=c(),g=ze(p,2),v=g[0],_=g[1],C=l4(r);C.addEventListener("mousedown",f,!0),C.addEventListener("click",m,!0),C.addEventListener("contextmenu",m,!0);var y=av(n);return y&&(y.addEventListener("mousedown",v,!0),y.addEventListener("click",_,!0),y.addEventListener("contextmenu",_,!0)),function(){C.removeEventListener("mousedown",f,!0),C.removeEventListener("click",m,!0),C.removeEventListener("contextmenu",m,!0),y&&(y.removeEventListener("mousedown",v,!0),y.removeEventListener("click",_,!0),y.removeEventListener("contextmenu",_,!0))}}},[e,n,r,i,o])}var uq=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function cq(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dC,e=b.forwardRef(function(n,r){var i=n.prefixCls,o=i===void 0?"rc-trigger-popup":i,s=n.children,a=n.action,l=a===void 0?"hover":a,u=n.showAction,c=n.hideAction,d=n.popupVisible,h=n.defaultPopupVisible,f=n.onPopupVisibleChange,m=n.afterPopupVisibleChange,p=n.mouseEnterDelay,g=n.mouseLeaveDelay,v=g===void 0?.1:g,_=n.focusDelay,C=n.blurDelay,y=n.mask,S=n.maskClosable,E=S===void 0?!0:S,w=n.getPopupContainer,R=n.forceRender,D=n.autoDestroy,I=n.destroyPopupOnHide,k=n.popup,O=n.popupClassName,$=n.popupStyle,N=n.popupPlacement,H=n.builtinPlacements,X=H===void 0?{}:H,te=n.popupAlign,z=n.zIndex,A=n.stretch,T=n.getPopupClassNameFromAlign,P=n.fresh,K=n.alignPoint,ee=n.onPopupClick,ue=n.onPopupAlign,fe=n.arrow,Ee=n.popupMotion,Q=n.maskMotion,re=n.popupTransitionName,Se=n.popupAnimation,_e=n.maskTransitionName,He=n.maskAnimation,Ne=n.className,we=n.getTriggerDOMNode,Me=Pn(n,uq),mt=D||I||!1,vt=b.useState(!1),ft=ze(vt,2),et=ft[0],ve=ft[1];Lr(function(){ve(vC())},[]);var Pe=b.useRef({}),Ye=b.useContext(_w),bt=b.useMemo(function(){return{registerSubPopup:function(Ot,Fn){Pe.current[Ot]=Fn,Ye==null||Ye.registerSubPopup(Ot,Fn)}}},[Ye]),Jt=r$(),Ht=b.useState(null),Zt=ze(Ht,2),kt=Zt[0],gn=Zt[1],vn=ns(function(Ot){Hh(Ot)&&kt!==Ot&&gn(Ot),Ye==null||Ye.registerSubPopup(Jt,Ot)}),Xt=b.useState(null),Vt=ze(Xt,2),jt=Vt[0],Nt=Vt[1],Bn=b.useRef(null),W=ns(function(Ot){Hh(Ot)&&jt!==Ot&&(Nt(Ot),Bn.current=Ot)}),j=b.Children.only(s),q=(j==null?void 0:j.props)||{},pe={},Ae=ns(function(Ot){var Fn,xi,vi=jt;return(vi==null?void 0:vi.contains(Ot))||((Fn=av(vi))===null||Fn===void 0?void 0:Fn.host)===Ot||Ot===vi||(kt==null?void 0:kt.contains(Ot))||((xi=av(kt))===null||xi===void 0?void 0:xi.host)===Ot||Ot===kt||Object.values(Pe.current).some(function(Ur){return(Ur==null?void 0:Ur.contains(Ot))||Ot===Ur})}),We=Cw(o,Ee,Se,re),Re=Cw(o,Q,He,_e),Te=b.useState(h||!1),G=ze(Te,2),be=G[0],xe=G[1],ye=d??be,st=ns(function(Ot){d===void 0&&xe(Ot)});Lr(function(){xe(d||!1)},[d]);var Ge=b.useRef(ye);Ge.current=ye;var lt=b.useRef([]);lt.current=[];var de=ns(function(Ot){var Fn;st(Ot),((Fn=lt.current[lt.current.length-1])!==null&&Fn!==void 0?Fn:ye)!==Ot&&(lt.current.push(Ot),f==null||f(Ot))}),Le=b.useRef(),Ve=function(){clearTimeout(Le.current)},Ze=function(Ot){var Fn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;Ve(),Fn===0?de(Ot):Le.current=setTimeout(function(){de(Ot)},Fn*1e3)};b.useEffect(function(){return Ve},[]);var Dt=b.useState(!1),Mt=ze(Dt,2),pn=Mt[0],Yn=Mt[1];Lr(function(Ot){(!Ot||ye)&&Yn(!0)},[ye]);var Hn=b.useState(null),ht=ze(Hn,2),Dn=ht[0],Gn=ht[1],zt=b.useState([0,0]),Ke=ze(zt,2),$e=Ke[0],hn=Ke[1],an=function(Ot){hn([Ot.clientX,Ot.clientY])},Qn=sq(ye,kt,K?$e:jt,N,X,te,ue),vr=ze(Qn,11),mi=vr[0],wo=vr[1],Fi=vr[2],pi=vr[3],Qr=vr[4],Ui=vr[5],_s=vr[6],zr=vr[7],Go=vr[8],Ro=vr[9],Hi=vr[10],Di=rq(et,l,u,c),Ko=ze(Di,2),Zo=Ko[0],B=Ko[1],Y=Zo.has("click"),U=B.has("click")||B.has("contextMenu"),J=ns(function(){pn||Hi()}),ie=function(){Ge.current&&K&&U&&Ze(!1)};aq(ye,jt,kt,J,ie),Lr(function(){J()},[$e,N]),Lr(function(){ye&&!(X!=null&&X[N])&&J()},[JSON.stringify(te)]);var ae=b.useMemo(function(){var Ot=oq(X,o,Ro,K);return Lt(Ot,T==null?void 0:T(Ro))},[Ro,T,X,o,K]);b.useImperativeHandle(r,function(){return{nativeElement:Bn.current,forceAlign:J}});var Ce=b.useState(0),Ue=ze(Ce,2),rt=Ue[0],Je=Ue[1],qe=b.useState(0),It=ze(qe,2),on=It[0],An=It[1],In=function(){if(A&&jt){var Ot=jt.getBoundingClientRect();Je(Ot.width),An(Ot.height)}},wr=function(){In(),J()},xn=function(Ot){Yn(!1),Hi(),m==null||m(Ot)},gi=function(){return new Promise(function(Ot){In(),Gn(function(){return Ot})})};Lr(function(){Dn&&(Hi(),Dn(),Gn(null))},[Dn]);function Ii(Ot,Fn,xi,vi){pe[Ot]=function(Ur){var J4;vi==null||vi(Ur),Ze(Fn,xi);for(var Nf=arguments.length,Zy=new Array(Nf>1?Nf-1:0),e7=1;e7<Nf;e7++)Zy[e7-1]=arguments[e7];(J4=q[Ot])===null||J4===void 0||J4.call.apply(J4,[q,Ur].concat(Zy))}}(Y||U)&&(pe.onClick=function(Ot){var Fn;Ge.current&&U?Ze(!1):!Ge.current&&Y&&(an(Ot),Ze(!0));for(var xi=arguments.length,vi=new Array(xi>1?xi-1:0),Ur=1;Ur<xi;Ur++)vi[Ur-1]=arguments[Ur];(Fn=q.onClick)===null||Fn===void 0||Fn.call.apply(Fn,[q,Ot].concat(vi))}),lq(ye,U,jt,kt,y,E,Ae,Ze);var Kl=Zo.has("hover"),T1=B.has("hover"),$1,k1;Kl&&(Ii("onMouseEnter",!0,p,function(Ot){an(Ot)}),Ii("onPointerEnter",!0,p,function(Ot){an(Ot)}),$1=function(){(ye||pn)&&Ze(!0,p)},K&&(pe.onMouseMove=function(Ot){var Fn;(Fn=q.onMouseMove)===null||Fn===void 0||Fn.call(q,Ot)})),T1&&(Ii("onMouseLeave",!1,v),Ii("onPointerLeave",!1,v),k1=function(){Ze(!1,v)}),Zo.has("focus")&&Ii("onFocus",!0,_),B.has("focus")&&Ii("onBlur",!1,C),Zo.has("contextMenu")&&(pe.onContextMenu=function(Ot){var Fn;Ge.current&&B.has("contextMenu")?Ze(!1):(an(Ot),Ze(!0)),Ot.preventDefault();for(var xi=arguments.length,vi=new Array(xi>1?xi-1:0),Ur=1;Ur<xi;Ur++)vi[Ur-1]=arguments[Ur];(Fn=q.onContextMenu)===null||Fn===void 0||Fn.call.apply(Fn,[q,Ot].concat(vi))}),Ne&&(pe.className=Lt(q.className,Ne));var H0=Oe(Oe({},q),pe),Q4={},Tf=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];Tf.forEach(function(Ot){Me[Ot]&&(Q4[Ot]=function(){for(var Fn,xi=arguments.length,vi=new Array(xi),Ur=0;Ur<xi;Ur++)vi[Ur]=arguments[Ur];(Fn=H0[Ot])===null||Fn===void 0||Fn.call.apply(Fn,[H0].concat(vi)),Me[Ot].apply(Me,vi)})});var $f=b.cloneElement(j,Oe(Oe({},H0),Q4)),kf={x:Ui,y:_s},Af=fe?Oe({},fe!==!0?fe:{}):null;return b.createElement(b.Fragment,null,b.createElement(uc,{disabled:!ye,ref:W,onResize:wr},b.createElement(nq,{getTriggerDOMNode:we},$f)),b.createElement(_w.Provider,{value:bt},b.createElement(tq,{portal:t,ref:vn,prefixCls:o,popup:k,className:Lt(O,ae),style:$,target:jt,onMouseEnter:$1,onMouseLeave:k1,onPointerEnter:$1,zIndex:z,open:ye,keepDom:pn,fresh:P,onClick:ee,mask:y,motion:We,maskMotion:Re,onVisibleChanged:xn,onPrepare:gi,forceRender:R,autoDestroy:mt,getPopupContainer:w,align:Ro,arrow:Af,arrowPos:kf,ready:mi,offsetX:wo,offsetY:Fi,offsetR:pi,offsetB:Qr,onAlign:J,stretch:A,targetWidth:rt/zr,targetHeight:on/Go})))});return e}const E9=cq(dC);var dq=ot.ESC,hq=ot.TAB;function fq(t){var e=t.visible,n=t.triggerRef,r=t.onVisibleChange,i=t.autoFocus,o=t.overlayRef,s=b.useRef(!1),a=function(){if(e){var c,d;(c=n.current)===null||c===void 0||(d=c.focus)===null||d===void 0||d.call(c),r==null||r(!1)}},l=function(){var c;return(c=o.current)!==null&&c!==void 0&&c.focus?(o.current.focus(),s.current=!0,!0):!1},u=function(c){switch(c.keyCode){case dq:a();break;case hq:{var d=!1;s.current||(d=l()),d?c.preventDefault():a();break}}};b.useEffect(function(){return e?(window.addEventListener("keydown",u),i&&mr(l,3),function(){window.removeEventListener("keydown",u),s.current=!1}):function(){s.current=!1}},[e])}var mq=b.forwardRef(function(t,e){var n=t.overlay,r=t.arrow,i=t.prefixCls,o=b.useMemo(function(){var a;return typeof n=="function"?a=n():a=n,a},[n]),s=ac(e,o==null?void 0:o.ref);return Qe.createElement(Qe.Fragment,null,r&&Qe.createElement("div",{className:"".concat(i,"-arrow")}),Qe.cloneElement(o,{ref:v0(o)?s:void 0}))}),wc={adjustX:1,adjustY:1},Rc=[0,0],pq={topLeft:{points:["bl","tl"],overflow:wc,offset:[0,-4],targetOffset:Rc},top:{points:["bc","tc"],overflow:wc,offset:[0,-4],targetOffset:Rc},topRight:{points:["br","tr"],overflow:wc,offset:[0,-4],targetOffset:Rc},bottomLeft:{points:["tl","bl"],overflow:wc,offset:[0,4],targetOffset:Rc},bottom:{points:["tc","bc"],overflow:wc,offset:[0,4],targetOffset:Rc},bottomRight:{points:["tr","br"],overflow:wc,offset:[0,4],targetOffset:Rc}},gq=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function vq(t,e){var n,r=t.arrow,i=r===void 0?!1:r,o=t.prefixCls,s=o===void 0?"rc-dropdown":o,a=t.transitionName,l=t.animation,u=t.align,c=t.placement,d=c===void 0?"bottomLeft":c,h=t.placements,f=h===void 0?pq:h,m=t.getPopupContainer,p=t.showAction,g=t.hideAction,v=t.overlayClassName,_=t.overlayStyle,C=t.visible,y=t.trigger,S=y===void 0?["hover"]:y,E=t.autoFocus,w=t.overlay,R=t.children,D=t.onVisibleChange,I=Pn(t,gq),k=Qe.useState(),O=ze(k,2),$=O[0],N=O[1],H="visible"in t?C:$,X=Qe.useRef(null),te=Qe.useRef(null),z=Qe.useRef(null);Qe.useImperativeHandle(e,function(){return X.current});var A=function(Q){N(Q),D==null||D(Q)};fq({visible:H,triggerRef:z,onVisibleChange:A,autoFocus:E,overlayRef:te});var T=function(Q){var re=t.onOverlayClick;N(!1),re&&re(Q)},P=function(){return Qe.createElement(mq,{ref:te,overlay:w,prefixCls:s,arrow:i})},K=function(){return typeof w=="function"?P:P()},ee=function(){var Q=t.minOverlayWidthMatchTrigger,re=t.alignPoint;return"minOverlayWidthMatchTrigger"in t?Q:!re},ue=function(){var Q=t.openClassName;return Q!==void 0?Q:"".concat(s,"-open")},fe=Qe.cloneElement(R,{className:Lt((n=R.props)===null||n===void 0?void 0:n.className,H&&ue()),ref:v0(R)?ac(z,R.ref):void 0}),Ee=g;return!Ee&&S.indexOf("contextMenu")!==-1&&(Ee=["click"]),Qe.createElement(E9,Wt({builtinPlacements:f},I,{prefixCls:s,ref:X,popupClassName:Lt(v,at({},"".concat(s,"-show-arrow"),i)),popupStyle:_,action:S,showAction:p,hideAction:Ee,popupPlacement:d,popupAlign:u,popupTransitionName:a,popupAnimation:l,popupVisible:H,stretch:ee()?"minWidth":"",popup:K(),onPopupVisibleChange:A,onPopupClick:T,getPopupContainer:m}),fe)}const _q=Qe.forwardRef(vq),bq="univer-dropdown",Cq="univer-dropdown-hidden",yq="univer-dropdown-slide-up-enter",Sq="univer-dropdown-slide-up-appear",Eq="univer-dropdown-slide-up-leave",wq="univer-dropdown-slide-up-enter-active",Rq="univer-dropdown-placement-bottomLeft",Dq="univer-dropdown-slide-up-appear-active",Iq="univer-dropdown-placement-bottomCenter",xq="univer-dropdown-placement-bottomRight",Mq="univer-dropdown-slide-up-in",Oq="univer-dropdown-placement-topLeft",Tq="univer-dropdown-placement-topCenter",$q="univer-dropdown-placement-topRight",kq="univer-dropdown-slide-down-in",Aq="univer-dropdown-slide-up-leave-active",Nq="univer-dropdown-slide-up-out",Lq="univer-dropdown-slide-down-out",Pq={dropdown:bq,dropdownHidden:Cq,dropdownSlideUpEnter:yq,dropdownSlideUpAppear:Sq,dropdownSlideUpLeave:Eq,dropdownSlideUpEnterActive:wq,dropdownPlacementBottomLeft:Rq,dropdownSlideUpAppearActive:Dq,dropdownPlacementBottomCenter:Iq,dropdownPlacementBottomRight:xq,dropdownSlideUpIn:Mq,dropdownPlacementTopLeft:Oq,dropdownPlacementTopCenter:Tq,dropdownPlacementTopRight:$q,dropdownSlideDownIn:kq,dropdownSlideUpLeaveActive:Aq,dropdownSlideUpOut:Nq,dropdownSlideDownOut:Lq};function g1(t){const{className:e,trigger:n=["click"],placement:r,children:i,overlay:o,alignPoint:s=!1,align:a,onVisibleChange:l}=t,{mountContainer:u}=b.useContext(R1);return $t.jsx(_q,{...t,overlayClassName:e,prefixCls:Pq.dropdown,getPopupContainer:()=>u,trigger:n,animation:"slide-up",placement:r,overlay:o,alignPoint:s,align:a,onVisibleChange:l,children:i})}function Bq(t){return!!(t.addonBefore||t.addonAfter)}function Fq(t){return!!(t.prefix||t.suffix||t.allowClear)}function Rw(t,e,n,r){if(n){var i=e;if(e.type==="click"){var o=t.cloneNode(!0);i=Object.create(e,{target:{value:o},currentTarget:{value:o}}),o.value="",n(i);return}if(r!==void 0){var s=t.cloneNode(!0);i=Object.create(e,{target:{value:s},currentTarget:{value:s}}),s.type!=="file"&&(s.value=r),n(i);return}n(i)}}function U$(t,e){if(t){t.focus(e);var n=e||{},r=n.cursor;if(r){var i=t.value.length;switch(r){case"start":t.setSelectionRange(0,0);break;case"end":t.setSelectionRange(i,i);break;default:t.setSelectionRange(0,i)}}}}var H$=function(t){var e,n,r=t.inputElement,i=t.children,o=t.prefixCls,s=t.prefix,a=t.suffix,l=t.addonBefore,u=t.addonAfter,c=t.className,d=t.style,h=t.disabled,f=t.readOnly,m=t.focused,p=t.triggerFocus,g=t.allowClear,v=t.value,_=t.handleReset,C=t.hidden,y=t.classes,S=t.classNames,E=t.dataAttrs,w=t.styles,R=t.components,D=i??r,I=(R==null?void 0:R.affixWrapper)||"span",k=(R==null?void 0:R.groupWrapper)||"span",O=(R==null?void 0:R.wrapper)||"span",$=(R==null?void 0:R.groupAddon)||"span",N=b.useRef(null),H=function(Ne){var we;(we=N.current)!==null&&we!==void 0&&we.contains(Ne.target)&&(p==null||p())},X=Fq(t),te=b.cloneElement(D,{value:v,className:Lt(D.props.className,!X&&(S==null?void 0:S.variant))||null});if(X){var z,A=null;if(g){var T,P=!h&&!f&&v,K="".concat(o,"-clear-icon"),ee=pr(g)==="object"&&g!==null&&g!==void 0&&g.clearIcon?g.clearIcon:"";A=Qe.createElement("span",{onClick:_,onMouseDown:function(Ne){return Ne.preventDefault()},className:Lt(K,(T={},at(T,"".concat(K,"-hidden"),!P),at(T,"".concat(K,"-has-suffix"),!!a),T)),role:"button",tabIndex:-1},ee)}var ue="".concat(o,"-affix-wrapper"),fe=Lt(ue,(z={},at(z,"".concat(o,"-disabled"),h),at(z,"".concat(ue,"-disabled"),h),at(z,"".concat(ue,"-focused"),m),at(z,"".concat(ue,"-readonly"),f),at(z,"".concat(ue,"-input-with-clear-btn"),a&&g&&v),z),y==null?void 0:y.affixWrapper,S==null?void 0:S.affixWrapper,S==null?void 0:S.variant),Ee=(a||g)&&Qe.createElement("span",{className:Lt("".concat(o,"-suffix"),S==null?void 0:S.suffix),style:w==null?void 0:w.suffix},A,a);te=Qe.createElement(I,Wt({className:fe,style:w==null?void 0:w.affixWrapper,onClick:H},E==null?void 0:E.affixWrapper,{ref:N}),s&&Qe.createElement("span",{className:Lt("".concat(o,"-prefix"),S==null?void 0:S.prefix),style:w==null?void 0:w.prefix},s),te,Ee)}if(Bq(t)){var Q="".concat(o,"-group"),re="".concat(Q,"-addon"),Se="".concat(Q,"-wrapper"),_e=Lt("".concat(o,"-wrapper"),Q,y==null?void 0:y.wrapper,S==null?void 0:S.wrapper),He=Lt(Se,at({},"".concat(Se,"-disabled"),h),y==null?void 0:y.group,S==null?void 0:S.groupWrapper);te=Qe.createElement(k,{className:He},Qe.createElement(O,{className:_e},l&&Qe.createElement($,{className:re},l),te,u&&Qe.createElement($,{className:re},u)))}return Qe.cloneElement(te,{className:Lt((e=te.props)===null||e===void 0?void 0:e.className,c)||null,style:Oe(Oe({},(n=te.props)===null||n===void 0?void 0:n.style),d),hidden:C})};function km(t){return t!==void 0}function bl(t,e){var n=e||{},r=n.defaultValue,i=n.value,o=n.onChange,s=n.postState,a=M2(function(){return km(i)?i:km(r)?typeof r=="function"?r():r:typeof t=="function"?t():t}),l=ze(a,2),u=l[0],c=l[1],d=i!==void 0?i:u,h=s?s(d):d,f=ns(o),m=M2([d]),p=ze(m,2),g=p[0],v=p[1];Gd(function(){var C=g[0];u!==C&&f(u,C)},[g]),Gd(function(){km(i)||c(i)},[i]);var _=ns(function(C,y){c(C,y),v([d],y)});return[h,_]}function w9(t,e){var n=Oe({},t);return Array.isArray(e)&&e.forEach(function(r){delete n[r]}),n}var Uq=["show"];function Hq(t,e){return b.useMemo(function(){var n={};e&&(n.show=pr(e)==="object"&&e.formatter?e.formatter:!!e),n=Oe(Oe({},n),t);var r=n,i=r.show,o=Pn(r,Uq);return Oe(Oe({},o),{},{show:!!i,showFormatter:typeof i=="function"?i:void 0,strategy:o.strategy||function(s){return s.length}})},[t,e])}var Vq=["autoComplete","onChange","onFocus","onBlur","onPressEnter","onKeyDown","prefixCls","disabled","htmlSize","className","maxLength","suffix","showCount","count","type","classes","classNames","styles","onCompositionStart","onCompositionEnd"],jq=b.forwardRef(function(t,e){var n=t.autoComplete,r=t.onChange,i=t.onFocus,o=t.onBlur,s=t.onPressEnter,a=t.onKeyDown,l=t.prefixCls,u=l===void 0?"rc-input":l,c=t.disabled,d=t.htmlSize,h=t.className,f=t.maxLength,m=t.suffix,p=t.showCount,g=t.count,v=t.type,_=v===void 0?"text":v,C=t.classes,y=t.classNames,S=t.styles,E=t.onCompositionStart,w=t.onCompositionEnd,R=Pn(t,Vq),D=b.useState(!1),I=ze(D,2),k=I[0],O=I[1],$=Qe.useRef(!1),N=b.useRef(null),H=function(ve){N.current&&U$(N.current,ve)},X=bl(t.defaultValue,{value:t.value}),te=ze(X,2),z=te[0],A=te[1],T=z==null?"":String(z),P=Qe.useState(null),K=ze(P,2),ee=K[0],ue=K[1],fe=Hq(g,p),Ee=fe.max||f,Q=fe.strategy(T),re=!!Ee&&Q>Ee;b.useImperativeHandle(e,function(){return{focus:H,blur:function(){var ve;(ve=N.current)===null||ve===void 0||ve.blur()},setSelectionRange:function(ve,Pe,Ye){var bt;(bt=N.current)===null||bt===void 0||bt.setSelectionRange(ve,Pe,Ye)},select:function(){var ve;(ve=N.current)===null||ve===void 0||ve.select()},input:N.current}}),b.useEffect(function(){O(function(ve){return ve&&c?!1:ve})},[c]);var Se=function(ve,Pe){var Ye=Pe;if(!$.current&&fe.exceedFormatter&&fe.max&&fe.strategy(Pe)>fe.max&&(Ye=fe.exceedFormatter(Pe,{max:fe.max}),Pe!==Ye)){var bt,Jt;ue([((bt=N.current)===null||bt===void 0?void 0:bt.selectionStart)||0,((Jt=N.current)===null||Jt===void 0?void 0:Jt.selectionEnd)||0])}A(Ye),N.current&&Rw(N.current,ve,r,Ye)};Qe.useEffect(function(){if(ee){var ve;(ve=N.current)===null||ve===void 0||ve.setSelectionRange.apply(ve,Mr(ee))}},[ee]);var _e=function(ve){Se(ve,ve.target.value)},He=function(ve){$.current=!1,Se(ve,ve.currentTarget.value),w==null||w(ve)},Ne=function(ve){s&&ve.key==="Enter"&&s(ve),a==null||a(ve)},we=function(ve){O(!0),i==null||i(ve)},Me=function(ve){O(!1),o==null||o(ve)},mt=function(ve){A(""),H(),N.current&&Rw(N.current,ve,r)},vt=re&&"".concat(u,"-out-of-range"),ft=function(){var ve=w9(t,["prefixCls","onPressEnter","addonBefore","addonAfter","prefix","suffix","allowClear","defaultValue","showCount","count","classes","htmlSize","styles","classNames"]);return Qe.createElement("input",Wt({autoComplete:n},ve,{onChange:_e,onFocus:we,onBlur:Me,onKeyDown:Ne,className:Lt(u,at({},"".concat(u,"-disabled"),c),y==null?void 0:y.input),style:S==null?void 0:S.input,ref:N,size:d,type:_,onCompositionStart:function(Pe){$.current=!0,E==null||E(Pe)},onCompositionEnd:He}))},et=function(){var ve=Number(Ee)>0;if(m||fe.show){var Pe=fe.showFormatter?fe.showFormatter({value:T,count:Q,maxLength:Ee}):"".concat(Q).concat(ve?" / ".concat(Ee):"");return Qe.createElement(Qe.Fragment,null,fe.show&&Qe.createElement("span",{className:Lt("".concat(u,"-show-count-suffix"),at({},"".concat(u,"-show-count-has-suffix"),!!m),y==null?void 0:y.count),style:Oe({},S==null?void 0:S.count)},Pe),m)}return null};return Qe.createElement(H$,Wt({},R,{prefixCls:u,className:Lt(h,vt),handleReset:mt,value:T,focused:k,triggerFocus:H,suffix:et(),disabled:c,classes:C,classNames:y,styles:S}),ft())});const zq="univer-input",Wq="univer-input-affix-wrapper",Xq="univer-input-affix-wrapper-mini",Yq="univer-input-affix-wrapper-small",Gq="univer-input-affix-wrapper-middle",Kq="univer-input-affix-wrapper-large",Zq="univer-input-affix-wrapper-disabled",qq="univer-input-suffix",Qq="univer-input-clear-icon",Jq="univer-input-clear-icon-hidden",J0={input:zq,inputAffixWrapper:Wq,inputAffixWrapperMini:Xq,inputAffixWrapperSmall:Yq,inputAffixWrapperMiddle:Gq,inputAffixWrapperLarge:Kq,inputAffixWrapperDisabled:Zq,inputSuffix:qq,inputClearIcon:Qq,inputClearIconHidden:Jq};function eQ(t){const{affixWrapperStyle:e,type:n="text",placeholder:r,value:i,size:o="middle",allowClear:s,disabled:a=!1,onClick:l,onKeyDown:u,onChange:c}=t;function d(f){const{value:m}=f.target;c==null||c(m)}const h=wi({[J0.inputAffixWrapperMini]:o==="mini",[J0.inputAffixWrapperSmall]:o==="small",[J0.inputAffixWrapperMiddle]:o==="middle",[J0.inputAffixWrapperLarge]:o==="large"});return $t.jsx(jq,{prefixCls:J0.input,classNames:{affixWrapper:h},styles:{affixWrapper:e},type:n,placeholder:r,value:i,disabled:a,onClick:l,onKeyDown:u,onChange:d,allowClear:{clearIcon:s?$t.jsx(tY,{}):$t.jsx($t.Fragment,{})}})}function uv(){return typeof BigInt=="function"}function V$(t){return!t&&t!==0&&!Number.isNaN(t)||!String(t).trim()}function ku(t){var e=t.trim(),n=e.startsWith("-");n&&(e=e.slice(1)),e=e.replace(/(\.\d*[^0])0*$/,"$1").replace(/\.0*$/,"").replace(/^0+/,""),e.startsWith(".")&&(e="0".concat(e));var r=e||"0",i=r.split("."),o=i[0]||"0",s=i[1]||"0";o==="0"&&s==="0"&&(n=!1);var a=n?"-":"";return{negative:n,negativeStr:a,trimStr:r,integerStr:o,decimalStr:s,fullStr:"".concat(a).concat(r)}}function _C(t){var e=String(t);return!Number.isNaN(Number(e))&&e.includes("e")}function Du(t){var e=String(t);if(_C(t)){var n=Number(e.slice(e.indexOf("e-")+2)),r=e.match(/\.(\d+)/);return r!=null&&r[1]&&(n+=r[1].length),n}return e.includes(".")&&bC(e)?e.length-e.indexOf(".")-1:0}function R9(t){var e=String(t);if(_C(t)){if(t>Number.MAX_SAFE_INTEGER)return String(uv()?BigInt(t).toString():Number.MAX_SAFE_INTEGER);if(t<Number.MIN_SAFE_INTEGER)return String(uv()?BigInt(t).toString():Number.MIN_SAFE_INTEGER);e=t.toFixed(Du(e))}return ku(e).fullStr}function bC(t){return typeof t=="number"?!Number.isNaN(t):t?/^\s*-?\d+(\.\d+)?\s*$/.test(t)||/^\s*-?\d+\.\s*$/.test(t)||/^\s*-?\.\d+\s*$/.test(t):!1}var tQ=function(){function t(e){if(Vl(this,t),at(this,"origin",""),at(this,"negative",void 0),at(this,"integer",void 0),at(this,"decimal",void 0),at(this,"decimalLen",void 0),at(this,"empty",void 0),at(this,"nan",void 0),V$(e)){this.empty=!0;return}if(this.origin=String(e),e==="-"||Number.isNaN(e)){this.nan=!0;return}var n=e;if(_C(n)&&(n=Number(n)),n=typeof n=="string"?n:R9(n),bC(n)){var r=ku(n);this.negative=r.negative;var i=r.trimStr.split(".");this.integer=BigInt(i[0]);var o=i[1]||"0";this.decimal=BigInt(o),this.decimalLen=o.length}else this.nan=!0}return jl(t,[{key:"getMark",value:function(){return this.negative?"-":""}},{key:"getIntegerStr",value:function(){return this.integer.toString()}},{key:"getDecimalStr",value:function(){return this.decimal.toString().padStart(this.decimalLen,"0")}},{key:"alignDecimal",value:function(e){var n="".concat(this.getMark()).concat(this.getIntegerStr()).concat(this.getDecimalStr().padEnd(e,"0"));return BigInt(n)}},{key:"negate",value:function(){var e=new t(this.toString());return e.negative=!e.negative,e}},{key:"cal",value:function(e,n,r){var i=Math.max(this.getDecimalStr().length,e.getDecimalStr().length),o=this.alignDecimal(i),s=e.alignDecimal(i),a=n(o,s).toString(),l=r(i),u=ku(a),c=u.negativeStr,d=u.trimStr,h="".concat(c).concat(d.padStart(l+1,"0"));return new t("".concat(h.slice(0,-l),".").concat(h.slice(-l)))}},{key:"add",value:function(e){if(this.isInvalidate())return new t(e);var n=new t(e);return n.isInvalidate()?this:this.cal(n,function(r,i){return r+i},function(r){return r})}},{key:"multi",value:function(e){var n=new t(e);return this.isInvalidate()||n.isInvalidate()?new t(NaN):this.cal(n,function(r,i){return r*i},function(r){return r*2})}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return this.nan}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(e){return this.toString()===(e==null?void 0:e.toString())}},{key:"lessEquals",value:function(e){return this.add(e.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.isNaN()?NaN:Number(this.toString())}},{key:"toString",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return e?this.isInvalidate()?"":ku("".concat(this.getMark()).concat(this.getIntegerStr(),".").concat(this.getDecimalStr())).fullStr:this.origin}}]),t}(),nQ=function(){function t(e){if(Vl(this,t),at(this,"origin",""),at(this,"number",void 0),at(this,"empty",void 0),V$(e)){this.empty=!0;return}this.origin=String(e),this.number=Number(e)}return jl(t,[{key:"negate",value:function(){return new t(-this.toNumber())}},{key:"add",value:function(e){if(this.isInvalidate())return new t(e);var n=Number(e);if(Number.isNaN(n))return this;var r=this.number+n;if(r>Number.MAX_SAFE_INTEGER)return new t(Number.MAX_SAFE_INTEGER);if(r<Number.MIN_SAFE_INTEGER)return new t(Number.MIN_SAFE_INTEGER);var i=Math.max(Du(this.number),Du(n));return new t(r.toFixed(i))}},{key:"multi",value:function(e){var n=Number(e);if(this.isInvalidate()||Number.isNaN(n))return new t(NaN);var r=this.number*n;if(r>Number.MAX_SAFE_INTEGER)return new t(Number.MAX_SAFE_INTEGER);if(r<Number.MIN_SAFE_INTEGER)return new t(Number.MIN_SAFE_INTEGER);var i=Math.max(Du(this.number),Du(n));return new t(r.toFixed(i))}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return Number.isNaN(this.number)}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(e){return this.toNumber()===(e==null?void 0:e.toNumber())}},{key:"lessEquals",value:function(e){return this.add(e.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.number}},{key:"toString",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return e?this.isInvalidate()?"":R9(this.number):this.origin}}]),t}();function ws(t){return uv()?new tQ(t):new nQ(t)}function D3(t,e,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(t==="")return"";var i=ku(t),o=i.negativeStr,s=i.integerStr,a=i.decimalStr,l="".concat(e).concat(a),u="".concat(o).concat(s);if(n>=0){var c=Number(a[n]);if(c>=5&&!r){var d=ws(t).add("".concat(o,"0.").concat("0".repeat(n)).concat(10-c));return D3(d.toString(),e,n,r)}return n===0?u:"".concat(u).concat(e).concat(a.padEnd(n,"0").slice(0,n))}return l===".0"?u:"".concat(u).concat(l)}function rQ(t,e){var n=b.useRef(null);function r(){try{var o=t.selectionStart,s=t.selectionEnd,a=t.value,l=a.substring(0,o),u=a.substring(s);n.current={start:o,end:s,value:a,beforeTxt:l,afterTxt:u}}catch{}}function i(){if(t&&n.current&&e)try{var o=t.value,s=n.current,a=s.beforeTxt,l=s.afterTxt,u=s.start,c=o.length;if(o.endsWith(l))c=o.length-n.current.afterTxt.length;else if(o.startsWith(a))c=a.length;else{var d=a[u-1],h=o.indexOf(d,u-1);h!==-1&&(c=h+1)}t.setSelectionRange(c,c)}catch(f){zl(!1,"Something warning of cursor restore. Please fire issue about this: ".concat(f.message))}}return[r,i]}var iQ=function(){var t=b.useState(!1),e=ze(t,2),n=e[0],r=e[1];return Lr(function(){r(vC())},[]),n},oQ=200,sQ=600;function aQ(t){var e=t.prefixCls,n=t.upNode,r=t.downNode,i=t.upDisabled,o=t.downDisabled,s=t.onStep,a=b.useRef(),l=b.useRef([]),u=b.useRef();u.current=s;var c=function(){clearTimeout(a.current)},d=function(_,C){_.preventDefault(),c(),u.current(C);function y(){u.current(C),a.current=setTimeout(y,oQ)}a.current=setTimeout(y,sQ)};b.useEffect(function(){return function(){c(),l.current.forEach(function(_){return mr.cancel(_)})}},[]);var h=iQ();if(h)return null;var f="".concat(e,"-handler"),m=Lt(f,"".concat(f,"-up"),at({},"".concat(f,"-up-disabled"),i)),p=Lt(f,"".concat(f,"-down"),at({},"".concat(f,"-down-disabled"),o)),g=function(){return l.current.push(mr(c))},v={unselectable:"on",role:"button",onMouseUp:g,onMouseLeave:g};return b.createElement("div",{className:"".concat(f,"-wrap")},b.createElement("span",Wt({},v,{onMouseDown:function(_){d(_,!0)},"aria-label":"Increase Value","aria-disabled":i,className:m}),n||b.createElement("span",{unselectable:"on",className:"".concat(e,"-handler-up-inner")})),b.createElement("span",Wt({},v,{onMouseDown:function(_){d(_,!1)},"aria-label":"Decrease Value","aria-disabled":o,className:p}),r||b.createElement("span",{unselectable:"on",className:"".concat(e,"-handler-down-inner")})))}function Dw(t){var e=typeof t=="number"?R9(t):ku(t).fullStr,n=e.includes(".");return n?ku(e.replace(/(\d)\.(\d)/g,"$1$2.")).fullStr:t+"0"}const lQ=function(){var t=b.useRef(0),e=function(){mr.cancel(t.current)};return b.useEffect(function(){return e},[]),function(n){e(),t.current=mr(function(){n()})}};var uQ=["prefixCls","className","style","min","max","step","defaultValue","value","disabled","readOnly","upHandler","downHandler","keyboard","wheel","controls","classNames","stringMode","parser","formatter","precision","decimalSeparator","onChange","onInput","onPressEnter","onStep","changeOnBlur"],cQ=["disabled","style","prefixCls","value","prefix","suffix","addonBefore","addonAfter","className","classNames"],Iw=function(t,e){return t||e.isEmpty()?e.toString():e.toNumber()},xw=function(t){var e=ws(t);return e.isInvalidate()?null:e},dQ=b.forwardRef(function(t,e){var n,r=t.prefixCls,i=r===void 0?"rc-input-number":r,o=t.className,s=t.style,a=t.min,l=t.max,u=t.step,c=u===void 0?1:u,d=t.defaultValue,h=t.value,f=t.disabled,m=t.readOnly,p=t.upHandler,g=t.downHandler,v=t.keyboard,_=t.wheel,C=t.controls,y=C===void 0?!0:C;t.classNames;var S=t.stringMode,E=t.parser,w=t.formatter,R=t.precision,D=t.decimalSeparator,I=t.onChange,k=t.onInput,O=t.onPressEnter,$=t.onStep,N=t.changeOnBlur,H=N===void 0?!0:N,X=Pn(t,uQ),te="".concat(i,"-input"),z=b.useRef(null),A=b.useState(!1),T=ze(A,2),P=T[0],K=T[1],ee=b.useRef(!1),ue=b.useRef(!1),fe=b.useRef(!1),Ee=b.useState(function(){return ws(h??d)}),Q=ze(Ee,2),re=Q[0],Se=Q[1];function _e(G){h===void 0&&Se(G)}var He=b.useCallback(function(G,be){if(!be)return R>=0?R:Math.max(Du(G),Du(c))},[R,c]),Ne=b.useCallback(function(G){var be=String(G);if(E)return E(be);var xe=be;return D&&(xe=xe.replace(D,".")),xe.replace(/[^\w.-]+/g,"")},[E,D]),we=b.useRef(""),Me=b.useCallback(function(G,be){if(w)return w(G,{userTyping:be,input:String(we.current)});var xe=typeof G=="number"?R9(G):G;if(!be){var ye=He(xe,be);if(bC(xe)&&(D||ye>=0)){var st=D||".";xe=D3(xe,st,ye)}}return xe},[w,He,D]),mt=b.useState(function(){var G=d??h;return re.isInvalidate()&&["string","number"].includes(pr(G))?Number.isNaN(G)?"":G:Me(re.toString(),!1)}),vt=ze(mt,2),ft=vt[0],et=vt[1];we.current=ft;function ve(G,be){et(Me(G.isInvalidate()?G.toString(!1):G.toString(!be),be))}var Pe=b.useMemo(function(){return xw(l)},[l,R]),Ye=b.useMemo(function(){return xw(a)},[a,R]),bt=b.useMemo(function(){return!Pe||!re||re.isInvalidate()?!1:Pe.lessEquals(re)},[Pe,re]),Jt=b.useMemo(function(){return!Ye||!re||re.isInvalidate()?!1:re.lessEquals(Ye)},[Ye,re]),Ht=rQ(z.current,P),Zt=ze(Ht,2),kt=Zt[0],gn=Zt[1],vn=function(G){return Pe&&!G.lessEquals(Pe)?Pe:Ye&&!Ye.lessEquals(G)?Ye:null},Xt=function(G){return!vn(G)},Vt=function(G,be){var xe=G,ye=Xt(xe)||xe.isEmpty();if(!xe.isEmpty()&&!be&&(xe=vn(xe)||xe,ye=!0),!m&&!f&&ye){var st=xe.toString(),Ge=He(st,be);return Ge>=0&&(xe=ws(D3(st,".",Ge)),Xt(xe)||(xe=ws(D3(st,".",Ge,!0)))),xe.equals(re)||(_e(xe),I==null||I(xe.isEmpty()?null:Iw(S,xe)),h===void 0&&ve(xe,be)),xe}return re},jt=lQ(),Nt=function G(be){if(kt(),we.current=be,et(be),!ue.current){var xe=Ne(be),ye=ws(xe);ye.isNaN()||Vt(ye,!0)}k==null||k(be),jt(function(){var st=be;E||(st=be.replace(//g,".")),st!==be&&G(st)})},Bn=function(){ue.current=!0},W=function(){ue.current=!1,Nt(z.current.value)},j=function(G){Nt(G.target.value)},q=function(G){var be;if(!(G&&bt||!G&&Jt)){ee.current=!1;var xe=ws(fe.current?Dw(c):c);G||(xe=xe.negate());var ye=(re||ws(0)).add(xe.toString()),st=Vt(ye,!1);$==null||$(Iw(S,st),{offset:fe.current?Dw(c):c,type:G?"up":"down"}),(be=z.current)===null||be===void 0||be.focus()}},pe=function(G){var be=ws(Ne(ft)),xe=be;be.isNaN()?xe=Vt(re,G):xe=Vt(be,G),h!==void 0?ve(re,!1):xe.isNaN()||ve(xe,!1)},Ae=function(){ee.current=!0},We=function(G){var be=G.key,xe=G.shiftKey;ee.current=!0,fe.current=xe,be==="Enter"&&(ue.current||(ee.current=!1),pe(!1),O==null||O(G)),v!==!1&&!ue.current&&["Up","ArrowUp","Down","ArrowDown"].includes(be)&&(q(be==="Up"||be==="ArrowUp"),G.preventDefault())},Re=function(){ee.current=!1,fe.current=!1};b.useEffect(function(){var G=function(xe){_!==!1&&(q(xe.deltaY<0),xe.preventDefault())},be=z.current;if(be)return be.addEventListener("wheel",G),function(){return be.removeEventListener("wheel",G)}},[q]);var Te=function(){H&&pe(!1),K(!1),ee.current=!1};return Gd(function(){re.isInvalidate()||ve(re,!1)},[R,w]),Gd(function(){var G=ws(h);Se(G);var be=ws(Ne(ft));(!G.equals(be)||!ee.current||w)&&ve(G,ee.current)},[h]),Gd(function(){w&&gn()},[ft]),b.createElement("div",{className:Lt(i,o,(n={},at(n,"".concat(i,"-focused"),P),at(n,"".concat(i,"-disabled"),f),at(n,"".concat(i,"-readonly"),m),at(n,"".concat(i,"-not-a-number"),re.isNaN()),at(n,"".concat(i,"-out-of-range"),!re.isInvalidate()&&!Xt(re)),n)),style:s,onFocus:function(){K(!0)},onBlur:Te,onKeyDown:We,onKeyUp:Re,onCompositionStart:Bn,onCompositionEnd:W,onBeforeInput:Ae},y&&b.createElement(aQ,{prefixCls:i,upNode:p,downNode:g,upDisabled:bt,downDisabled:Jt,onStep:q}),b.createElement("div",{className:"".concat(te,"-wrap")},b.createElement("input",Wt({autoComplete:"off",role:"spinbutton","aria-valuemin":a,"aria-valuemax":l,"aria-valuenow":re.isInvalidate()?null:re.toString(),step:c},X,{ref:ac(z,e),className:te,value:ft,onChange:j,disabled:f,readOnly:m}))))}),j$=b.forwardRef(function(t,e){var n=t.disabled,r=t.style,i=t.prefixCls,o=t.value,s=t.prefix,a=t.suffix,l=t.addonBefore,u=t.addonAfter,c=t.className,d=t.classNames,h=Pn(t,cQ),f=b.useRef(null),m=function(p){f.current&&U$(f.current,p)};return b.createElement(H$,{className:c,triggerFocus:m,prefixCls:i,value:o,disabled:n,style:r,prefix:s,suffix:a,addonAfter:u,addonBefore:l,classNames:d,components:{affixWrapper:"div",groupWrapper:"div",wrapper:"div",groupAddon:"div"}},b.createElement(dQ,Wt({prefixCls:i,disabled:n,ref:ac(f,e),className:d==null?void 0:d.input},h)))});j$.displayName="InputNumber";const hQ="univer-input-number",fQ="univer-input-number-focused",mQ="univer-input-number-handler-up",pQ="univer-input-number-handler-wrap",gQ="univer-input-number-handler",vQ="univer-input-number-handler-up-inner",_Q="univer-input-number-handler-down-inner",bQ="univer-input-number-disabled",CQ="univer-input-number-input-wrap",yQ="univer-input-number-input",SQ="univer-input-number-handler-down",EQ="univer-input-number-handler-down-disabled",wQ="univer-input-number-handler-up-disabled",RQ={inputNumber:hQ,inputNumberFocused:fQ,inputNumberHandlerUp:mQ,inputNumberHandlerWrap:pQ,inputNumberHandler:gQ,inputNumberHandlerUpInner:vQ,inputNumberHandlerDownInner:_Q,inputNumberDisabled:bQ,inputNumberInputWrap:CQ,inputNumberInput:yQ,inputNumberHandlerDown:SQ,inputNumberHandlerDownDisabled:EQ,inputNumberHandlerUpDisabled:wQ};function u4(t){const{className:e,value:n,max:r,min:i,step:o=1,precision:s,disabled:a=!1,controls:l=!0,onClick:u,onKeyDown:c,onChange:d,onPressEnter:h}=t;function f(m){m!==null&&(d==null||d(m))}return $t.jsx(j$,{prefixCls:RQ.inputNumber,className:e,value:n,max:r,min:i,step:o,precision:s,disabled:a,controls:l,onClick:u,onKeyDown:c,onChange:f,onPressEnter:h})}var DQ=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],Dc=void 0;function IQ(t,e){var n=t.prefixCls,r=t.invalidate,i=t.item,o=t.renderItem,s=t.responsive,a=t.responsiveDisabled,l=t.registerSize,u=t.itemKey,c=t.className,d=t.style,h=t.children,f=t.display,m=t.order,p=t.component,g=p===void 0?"div":p,v=Pn(t,DQ),_=s&&!f;function C(R){l(u,R)}b.useEffect(function(){return function(){C(null)}},[]);var y=o&&i!==Dc?o(i):h,S;r||(S={opacity:_?0:1,height:_?0:Dc,overflowY:_?"hidden":Dc,order:s?m:Dc,pointerEvents:_?"none":Dc,position:_?"absolute":Dc});var E={};_&&(E["aria-hidden"]=!0);var w=b.createElement(g,Wt({className:Lt(!r&&n,c),style:Oe(Oe({},S),d)},E,v,{ref:e}),y);return s&&(w=b.createElement(uc,{onResize:function(R){var D=R.offsetWidth;C(D)},disabled:a},w)),w}var Zd=b.forwardRef(IQ);Zd.displayName="Item";function xQ(t){if(typeof MessageChannel>"u")mr(t);else{var e=new MessageChannel;e.port1.onmessage=function(){return t()},e.port2.postMessage(void 0)}}function MQ(){var t=b.useRef(null),e=function(n){t.current||(t.current=[],xQ(function(){Xu.unstable_batchedUpdates(function(){t.current.forEach(function(r){r()}),t.current=null})})),t.current.push(n)};return e}function ed(t,e){var n=b.useState(e),r=ze(n,2),i=r[0],o=r[1],s=ns(function(a){t(function(){o(a)})});return[i,s]}var zh=Qe.createContext(null),OQ=["component"],TQ=["className"],$Q=["className"],kQ=function(t,e){var n=b.useContext(zh);if(!n){var r=t.component,i=r===void 0?"div":r,o=Pn(t,OQ);return b.createElement(i,Wt({},o,{ref:e}))}var s=n.className,a=Pn(n,TQ),l=t.className,u=Pn(t,$Q);return b.createElement(zh.Provider,{value:null},b.createElement(Zd,Wt({ref:e,className:Lt(s,l)},a,u)))},z$=b.forwardRef(kQ);z$.displayName="RawItem";var AQ=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],W$="responsive",X$="invalidate";function NQ(t){return"+ ".concat(t.length," ...")}function LQ(t,e){var n=t.prefixCls,r=n===void 0?"rc-overflow":n,i=t.data,o=i===void 0?[]:i,s=t.renderItem,a=t.renderRawItem,l=t.itemKey,u=t.itemWidth,c=u===void 0?10:u,d=t.ssr,h=t.style,f=t.className,m=t.maxCount,p=t.renderRest,g=t.renderRawRest,v=t.suffix,_=t.component,C=_===void 0?"div":_,y=t.itemComponent,S=t.onVisibleChange,E=Pn(t,AQ),w=d==="full",R=MQ(),D=ed(R,null),I=ze(D,2),k=I[0],O=I[1],$=k||0,N=ed(R,new Map),H=ze(N,2),X=H[0],te=H[1],z=ed(R,0),A=ze(z,2),T=A[0],P=A[1],K=ed(R,0),ee=ze(K,2),ue=ee[0],fe=ee[1],Ee=ed(R,0),Q=ze(Ee,2),re=Q[0],Se=Q[1],_e=b.useState(null),He=ze(_e,2),Ne=He[0],we=He[1],Me=b.useState(null),mt=ze(Me,2),vt=mt[0],ft=mt[1],et=b.useMemo(function(){return vt===null&&w?Number.MAX_SAFE_INTEGER:vt||0},[vt,k]),ve=b.useState(!1),Pe=ze(ve,2),Ye=Pe[0],bt=Pe[1],Jt="".concat(r,"-item"),Ht=Math.max(T,ue),Zt=m===W$,kt=o.length&&Zt,gn=m===X$,vn=kt||typeof m=="number"&&o.length>m,Xt=b.useMemo(function(){var Ge=o;return kt?k===null&&w?Ge=o:Ge=o.slice(0,Math.min(o.length,$/c)):typeof m=="number"&&(Ge=o.slice(0,m)),Ge},[o,c,k,m,kt]),Vt=b.useMemo(function(){return kt?o.slice(et+1):o.slice(Xt.length)},[o,Xt,kt,et]),jt=b.useCallback(function(Ge,lt){var de;return typeof l=="function"?l(Ge):(de=l&&(Ge==null?void 0:Ge[l]))!==null&&de!==void 0?de:lt},[l]),Nt=b.useCallback(s||function(Ge){return Ge},[s]);function Bn(Ge,lt,de){vt===Ge&&(lt===void 0||lt===Ne)||(ft(Ge),de||(bt(Ge<o.length-1),S==null||S(Ge)),lt!==void 0&&we(lt))}function W(Ge,lt){O(lt.clientWidth)}function j(Ge,lt){te(function(de){var Le=new Map(de);return lt===null?Le.delete(Ge):Le.set(Ge,lt),Le})}function q(Ge,lt){fe(lt),P(ue)}function pe(Ge,lt){Se(lt)}function Ae(Ge){return X.get(jt(Xt[Ge],Ge))}Lr(function(){if($&&typeof Ht=="number"&&Xt){var Ge=re,lt=Xt.length,de=lt-1;if(!lt){Bn(0,null);return}for(var Le=0;Le<lt;Le+=1){var Ve=Ae(Le);if(w&&(Ve=Ve||0),Ve===void 0){Bn(Le-1,void 0,!0);break}if(Ge+=Ve,de===0&&Ge<=$||Le===de-1&&Ge+Ae(de)<=$){Bn(de,null);break}else if(Ge+Ht>$){Bn(Le-1,Ge-Ve-re+ue);break}}v&&Ae(0)+re>$&&we(null)}},[$,X,ue,re,jt,Xt]);var We=Ye&&!!Vt.length,Re={};Ne!==null&&kt&&(Re={position:"absolute",left:Ne,top:0});var Te={prefixCls:Jt,responsive:kt,component:y,invalidate:gn},G=a?function(Ge,lt){var de=jt(Ge,lt);return b.createElement(zh.Provider,{key:de,value:Oe(Oe({},Te),{},{order:lt,item:Ge,itemKey:de,registerSize:j,display:lt<=et})},a(Ge,lt))}:function(Ge,lt){var de=jt(Ge,lt);return b.createElement(Zd,Wt({},Te,{order:lt,key:de,item:Ge,renderItem:Nt,itemKey:de,registerSize:j,display:lt<=et}))},be,xe={order:We?et:Number.MAX_SAFE_INTEGER,className:"".concat(Jt,"-rest"),registerSize:q,display:We};if(g)g&&(be=b.createElement(zh.Provider,{value:Oe(Oe({},Te),xe)},g(Vt)));else{var ye=p||NQ;be=b.createElement(Zd,Wt({},Te,xe),typeof ye=="function"?ye(Vt):ye)}var st=b.createElement(C,Wt({className:Lt(!gn&&r,f),style:h,ref:e},E),Xt.map(G),vn?be:null,v&&b.createElement(Zd,Wt({},Te,{responsive:Zt,responsiveDisabled:!kt,order:et,className:"".concat(Jt,"-suffix"),registerSize:pe,display:!0,style:Re}),v));return Zt&&(st=b.createElement(uc,{onResize:W,disabled:!kt},st)),st}var Sa=b.forwardRef(LQ);Sa.displayName="Overflow";Sa.Item=z$;Sa.RESPONSIVE=W$;Sa.INVALIDATE=X$;function Y$(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=new Set;function i(o,s){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,l=r.has(o);if(zl(!l,"Warning: There may be circular references"),l)return!1;if(o===s)return!0;if(n&&a>1)return!1;r.add(o);var u=a+1;if(Array.isArray(o)){if(!Array.isArray(s)||o.length!==s.length)return!1;for(var c=0;c<o.length;c++)if(!i(o[c],s[c],u))return!1;return!0}if(o&&s&&pr(o)==="object"&&pr(s)==="object"){var d=Object.keys(o);return d.length!==Object.keys(s).length?!1:d.every(function(h){return i(o[h],s[h],u)})}return!1}return i(t,e)}var G$=b.createContext(null);function K$(t,e){return t===void 0?null:"".concat(t,"-").concat(e)}function Z$(t){var e=b.useContext(G$);return K$(e,t)}var PQ=["children","locked"],Gs=b.createContext(null);function BQ(t,e){var n=Oe({},t);return Object.keys(e).forEach(function(r){var i=e[r];i!==void 0&&(n[r]=i)}),n}function T6(t){var e=t.children,n=t.locked,r=Pn(t,PQ),i=b.useContext(Gs),o=uC(function(){return BQ(i,r)},[i,r],function(s,a){return!n&&(s[0]!==a[0]||!Y$(s[1],a[1],!0))});return b.createElement(Gs.Provider,{value:o},e)}var FQ=[],q$=b.createContext(null);function D9(){return b.useContext(q$)}var Q$=b.createContext(FQ);function c4(t){var e=b.useContext(Q$);return b.useMemo(function(){return t!==void 0?[].concat(Mr(e),[t]):e},[e,t])}var J$=b.createContext(null),CC=b.createContext({});function Mw(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(F$(t)){var n=t.nodeName.toLowerCase(),r=["input","select","textarea","button"].includes(n)||t.isContentEditable||n==="a"&&!!t.getAttribute("href"),i=t.getAttribute("tabindex"),o=Number(i),s=null;return i&&!Number.isNaN(o)?s=o:r&&s===null&&(s=0),r&&t.disabled&&(s=null),s!==null&&(s>=0||e&&s<0)}return!1}function UQ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=Mr(t.querySelectorAll("*")).filter(function(r){return Mw(r,e)});return Mw(t,e)&&n.unshift(t),n}var cv=ot.LEFT,dv=ot.RIGHT,hv=ot.UP,I3=ot.DOWN,x3=ot.ENTER,ek=ot.ESC,td=ot.HOME,nd=ot.END,Ow=[hv,I3,cv,dv];function HQ(t,e,n,r){var i,o,s,a,l="prev",u="next",c="children",d="parent";if(t==="inline"&&r===x3)return{inlineTrigger:!0};var h=(i={},at(i,hv,l),at(i,I3,u),i),f=(o={},at(o,cv,n?u:l),at(o,dv,n?l:u),at(o,I3,c),at(o,x3,c),o),m=(s={},at(s,hv,l),at(s,I3,u),at(s,x3,c),at(s,ek,d),at(s,cv,n?c:d),at(s,dv,n?d:c),s),p={inline:h,horizontal:f,vertical:m,inlineSub:h,horizontalSub:m,verticalSub:m},g=(a=p["".concat(t).concat(e?"":"Sub")])===null||a===void 0?void 0:a[r];switch(g){case l:return{offset:-1,sibling:!0};case u:return{offset:1,sibling:!0};case d:return{offset:-1,sibling:!1};case c:return{offset:1,sibling:!1};default:return null}}function VQ(t){for(var e=t;e;){if(e.getAttribute("data-menu-list"))return e;e=e.parentElement}return null}function jQ(t,e){for(var n=t||document.activeElement;n;){if(e.has(n))return n;n=n.parentElement}return null}function yC(t,e){var n=UQ(t,!0);return n.filter(function(r){return e.has(r)})}function Tw(t,e,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(!t)return null;var i=yC(t,e),o=i.length,s=i.findIndex(function(a){return n===a});return r<0?s===-1?s=o-1:s-=1:r>0&&(s+=1),s=(s+o)%o,i[s]}var fv=function(t,e){var n=new Set,r=new Map,i=new Map;return t.forEach(function(o){var s=document.querySelector("[data-menu-id='".concat(K$(e,o),"']"));s&&(n.add(s),i.set(s,o),r.set(o,s))}),{elements:n,key2element:r,element2key:i}};function zQ(t,e,n,r,i,o,s,a,l,u){var c=b.useRef(),d=b.useRef();d.current=e;var h=function(){mr.cancel(c.current)};return b.useEffect(function(){return function(){h()}},[]),function(f){var m=f.which;if([].concat(Ow,[x3,ek,td,nd]).includes(m)){var p=o(),g=fv(p,r),v=g,_=v.elements,C=v.key2element,y=v.element2key,S=C.get(e),E=jQ(S,_),w=y.get(E),R=HQ(t,s(w,!0).length===1,n,m);if(!R&&m!==td&&m!==nd)return;(Ow.includes(m)||[td,nd].includes(m))&&f.preventDefault();var D=function(X){if(X){var te=X,z=X.querySelector("a");z!=null&&z.getAttribute("href")&&(te=z);var A=y.get(X);a(A),h(),c.current=mr(function(){d.current===A&&te.focus()})}};if([td,nd].includes(m)||R.sibling||!E){var I;!E||t==="inline"?I=i.current:I=VQ(E);var k,O=yC(I,_);m===td?k=O[0]:m===nd?k=O[O.length-1]:k=Tw(I,_,E,R.offset),D(k)}else if(R.inlineTrigger)l(w);else if(R.offset>0)l(w,!0),h(),c.current=mr(function(){g=fv(p,r);var X=E.getAttribute("aria-controls"),te=document.getElementById(X),z=Tw(te,g.elements);D(z)},5);else if(R.offset<0){var $=s(w,!0),N=$[$.length-2],H=C.get(N);l(N,!1),D(H)}}u==null||u(f)}}function WQ(t){Promise.resolve().then(t)}var SC="__RC_UTIL_PATH_SPLIT__",$w=function(t){return t.join(SC)},XQ=function(t){return t.split(SC)},mv="rc-menu-more";function YQ(){var t=b.useState({}),e=ze(t,2),n=e[1],r=b.useRef(new Map),i=b.useRef(new Map),o=b.useState([]),s=ze(o,2),a=s[0],l=s[1],u=b.useRef(0),c=b.useRef(!1),d=function(){c.current||n({})},h=b.useCallback(function(C,y){var S=$w(y);i.current.set(S,C),r.current.set(C,S),u.current+=1;var E=u.current;WQ(function(){E===u.current&&d()})},[]),f=b.useCallback(function(C,y){var S=$w(y);i.current.delete(S),r.current.delete(C)},[]),m=b.useCallback(function(C){l(C)},[]),p=b.useCallback(function(C,y){var S=r.current.get(C)||"",E=XQ(S);return y&&a.includes(E[0])&&E.unshift(mv),E},[a]),g=b.useCallback(function(C,y){return C.some(function(S){var E=p(S,!0);return E.includes(y)})},[p]),v=function(){var C=Mr(r.current.keys());return a.length&&C.push(mv),C},_=b.useCallback(function(C){var y="".concat(r.current.get(C)).concat(SC),S=new Set;return Mr(i.current.keys()).forEach(function(E){E.startsWith(y)&&S.add(i.current.get(E))}),S},[]);return b.useEffect(function(){return function(){c.current=!0}},[]),{registerPath:h,unregisterPath:f,refreshOverflowKeys:m,isSubPathKey:g,getKeyPath:p,getKeys:v,getSubPathKeys:_}}function Rd(t){var e=b.useRef(t);e.current=t;var n=b.useCallback(function(){for(var r,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(r=e.current)===null||r===void 0?void 0:r.call.apply(r,[e].concat(o))},[]);return t?n:void 0}var GQ=Math.random().toFixed(5).toString().slice(2),kw=0;function KQ(t){var e=bl(t,{value:t}),n=ze(e,2),r=n[0],i=n[1];return b.useEffect(function(){kw+=1;var o="".concat(GQ,"-").concat(kw);i("rc-menu-uuid-".concat(o))},[]),r}function tk(t,e,n,r){var i=b.useContext(Gs),o=i.activeKey,s=i.onActive,a=i.onInactive,l={active:o===t};return e||(l.onMouseEnter=function(u){n==null||n({key:t,domEvent:u}),s(t)},l.onMouseLeave=function(u){r==null||r({key:t,domEvent:u}),a(t)}),l}function nk(t){var e=b.useContext(Gs),n=e.mode,r=e.rtl,i=e.inlineIndent;if(n!=="inline")return null;var o=t;return r?{paddingRight:o*i}:{paddingLeft:o*i}}function rk(t){var e=t.icon,n=t.props,r=t.children,i;return e===null||e===!1?null:(typeof e=="function"?i=b.createElement(e,Oe({},n)):typeof e!="boolean"&&(i=e),i||r||null)}var ZQ=["item"];function Wh(t){var e=t.item,n=Pn(t,ZQ);return Object.defineProperty(n,"item",{get:function(){return zl(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),e}}),n}var qQ=["title","attribute","elementRef"],QQ=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],JQ=["active"],eJ=function(t){s4(n,t);var e=a4(n);function n(){return Vl(this,n),e.apply(this,arguments)}return jl(n,[{key:"render",value:function(){var r=this.props,i=r.title,o=r.attribute,s=r.elementRef,a=Pn(r,qQ),l=w9(a,["eventKey","popupClassName","popupOffset","onTitleClick"]);return zl(!o,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),b.createElement(Sa.Item,Wt({},o,{title:typeof i=="string"?i:void 0},l,{ref:s}))}}]),n}(b.Component),tJ=b.forwardRef(function(t,e){var n,r=t.style,i=t.className,o=t.eventKey;t.warnKey;var s=t.disabled,a=t.itemIcon,l=t.children,u=t.role,c=t.onMouseEnter,d=t.onMouseLeave,h=t.onClick,f=t.onKeyDown,m=t.onFocus,p=Pn(t,QQ),g=Z$(o),v=b.useContext(Gs),_=v.prefixCls,C=v.onItemClick,y=v.disabled,S=v.overflowDisabled,E=v.itemIcon,w=v.selectedKeys,R=v.onActive,D=b.useContext(CC),I=D._internalRenderMenuItem,k="".concat(_,"-item"),O=b.useRef(),$=b.useRef(),N=y||s,H=g0(e,$),X=c4(o),te=function(Se){return{key:o,keyPath:Mr(X).reverse(),item:O.current,domEvent:Se}},z=a||E,A=tk(o,N,c,d),T=A.active,P=Pn(A,JQ),K=w.includes(o),ee=nk(X.length),ue=function(Se){if(!N){var _e=te(Se);h==null||h(Wh(_e)),C(_e)}},fe=function(Se){if(f==null||f(Se),Se.which===ot.ENTER){var _e=te(Se);h==null||h(Wh(_e)),C(_e)}},Ee=function(Se){R(o),m==null||m(Se)},Q={};t.role==="option"&&(Q["aria-selected"]=K);var re=b.createElement(eJ,Wt({ref:O,elementRef:H,role:u===null?"none":u||"menuitem",tabIndex:s?null:-1,"data-menu-id":S&&g?null:g},p,P,Q,{component:"li","aria-disabled":s,style:Oe(Oe({},ee),r),className:Lt(k,(n={},at(n,"".concat(k,"-active"),T),at(n,"".concat(k,"-selected"),K),at(n,"".concat(k,"-disabled"),N),n),i),onClick:ue,onKeyDown:fe,onFocus:Ee}),l,b.createElement(rk,{props:Oe(Oe({},t),{},{isSelected:K}),icon:z}));return I&&(re=I(re,t,{selected:K})),re});function nJ(t,e){var n=t.eventKey,r=D9(),i=c4(n);return b.useEffect(function(){if(r)return r.registerPath(n,i),function(){r.unregisterPath(n,i)}},[i]),r?null:b.createElement(tJ,Wt({},t,{ref:e}))}const I9=b.forwardRef(nJ);var rJ=["className","children"],iJ=function(t,e){var n=t.className,r=t.children,i=Pn(t,rJ),o=b.useContext(Gs),s=o.prefixCls,a=o.mode,l=o.rtl;return b.createElement("ul",Wt({className:Lt(s,l&&"".concat(s,"-rtl"),"".concat(s,"-sub"),"".concat(s,"-").concat(a==="inline"?"inline":"vertical"),n),role:"menu"},i,{"data-menu-list":!0,ref:e}),r)},EC=b.forwardRef(iJ);EC.displayName="SubMenuList";function wC(t,e){return M6(t).map(function(n,r){if(b.isValidElement(n)){var i,o,s=n.key,a=(i=(o=n.props)===null||o===void 0?void 0:o.eventKey)!==null&&i!==void 0?i:s,l=a==null;l&&(a="tmp_key-".concat([].concat(Mr(e),[r]).join("-")));var u={key:a,eventKey:a};return b.cloneElement(n,u)}return n})}var Ni={adjustX:1,adjustY:1},oJ={topLeft:{points:["bl","tl"],overflow:Ni},topRight:{points:["br","tr"],overflow:Ni},bottomLeft:{points:["tl","bl"],overflow:Ni},bottomRight:{points:["tr","br"],overflow:Ni},leftTop:{points:["tr","tl"],overflow:Ni},leftBottom:{points:["br","bl"],overflow:Ni},rightTop:{points:["tl","tr"],overflow:Ni},rightBottom:{points:["bl","br"],overflow:Ni}},sJ={topLeft:{points:["bl","tl"],overflow:Ni},topRight:{points:["br","tr"],overflow:Ni},bottomLeft:{points:["tl","bl"],overflow:Ni},bottomRight:{points:["tr","br"],overflow:Ni},rightTop:{points:["tr","tl"],overflow:Ni},rightBottom:{points:["br","bl"],overflow:Ni},leftTop:{points:["tl","tr"],overflow:Ni},leftBottom:{points:["bl","br"],overflow:Ni}};function ik(t,e,n){if(e)return e;if(n)return n[t]||n.other}var aJ={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function lJ(t){var e=t.prefixCls,n=t.visible,r=t.children,i=t.popup,o=t.popupStyle,s=t.popupClassName,a=t.popupOffset,l=t.disabled,u=t.mode,c=t.onVisibleChange,d=b.useContext(Gs),h=d.getPopupContainer,f=d.rtl,m=d.subMenuOpenDelay,p=d.subMenuCloseDelay,g=d.builtinPlacements,v=d.triggerSubMenuAction,_=d.forceSubMenuRender,C=d.rootClassName,y=d.motion,S=d.defaultMotions,E=b.useState(!1),w=ze(E,2),R=w[0],D=w[1],I=Oe(f?Oe({},sJ):Oe({},oJ),g),k=aJ[u],O=ik(u,y,S),$=b.useRef(O);u!=="inline"&&($.current=O);var N=Oe(Oe({},$.current),{},{leavedClassName:"".concat(e,"-hidden"),removeOnLeave:!1,motionAppear:!0}),H=b.useRef();return b.useEffect(function(){return H.current=mr(function(){D(n)}),function(){mr.cancel(H.current)}},[n]),b.createElement(E9,{prefixCls:e,popupClassName:Lt("".concat(e,"-popup"),at({},"".concat(e,"-rtl"),f),s,C),stretch:u==="horizontal"?"minWidth":null,getPopupContainer:h,builtinPlacements:I,popupPlacement:k,popupVisible:R,popup:i,popupStyle:o,popupAlign:a&&{offset:a},action:l?[]:[v],mouseEnterDelay:m,mouseLeaveDelay:p,onPopupVisibleChange:c,forceRender:_,popupMotion:N,fresh:!0},r)}function uJ(t){var e=t.id,n=t.open,r=t.keyPath,i=t.children,o="inline",s=b.useContext(Gs),a=s.prefixCls,l=s.forceSubMenuRender,u=s.motion,c=s.defaultMotions,d=s.mode,h=b.useRef(!1);h.current=d===o;var f=b.useState(!h.current),m=ze(f,2),p=m[0],g=m[1],v=h.current?n:!1;b.useEffect(function(){h.current&&g(!1)},[d]);var _=Oe({},ik(o,u,c));r.length>1&&(_.motionAppear=!1);var C=_.onVisibleChanged;return _.onVisibleChanged=function(y){return!h.current&&!y&&g(!0),C==null?void 0:C(y)},p?null:b.createElement(T6,{mode:o,locked:!h.current},b.createElement(_0,Wt({visible:v},_,{forceRender:l,removeOnLeave:!1,leavedClassName:"".concat(a,"-hidden")}),function(y){var S=y.className,E=y.style;return b.createElement(EC,{id:e,className:S,style:E},i)}))}var cJ=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","popupStyle","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],dJ=["active"],hJ=function(t){var e,n=t.style,r=t.className,i=t.title,o=t.eventKey;t.warnKey;var s=t.disabled,a=t.internalPopupClose,l=t.children,u=t.itemIcon,c=t.expandIcon,d=t.popupClassName,h=t.popupOffset,f=t.popupStyle,m=t.onClick,p=t.onMouseEnter,g=t.onMouseLeave,v=t.onTitleClick,_=t.onTitleMouseEnter,C=t.onTitleMouseLeave,y=Pn(t,cJ),S=Z$(o),E=b.useContext(Gs),w=E.prefixCls,R=E.mode,D=E.openKeys,I=E.disabled,k=E.overflowDisabled,O=E.activeKey,$=E.selectedKeys,N=E.itemIcon,H=E.expandIcon,X=E.onItemClick,te=E.onOpenChange,z=E.onActive,A=b.useContext(CC),T=A._internalRenderSubMenuItem,P=b.useContext(J$),K=P.isSubPathKey,ee=c4(),ue="".concat(w,"-submenu"),fe=I||s,Ee=b.useRef(),Q=b.useRef(),re=u??N,Se=c??H,_e=D.includes(o),He=!k&&_e,Ne=K($,o),we=tk(o,fe,_,C),Me=we.active,mt=Pn(we,dJ),vt=b.useState(!1),ft=ze(vt,2),et=ft[0],ve=ft[1],Pe=function(W){fe||ve(W)},Ye=function(W){Pe(!0),p==null||p({key:o,domEvent:W})},bt=function(W){Pe(!1),g==null||g({key:o,domEvent:W})},Jt=b.useMemo(function(){return Me||(R!=="inline"?et||K([O],o):!1)},[R,Me,O,et,o,K]),Ht=nk(ee.length),Zt=function(W){fe||(v==null||v({key:o,domEvent:W}),R==="inline"&&te(o,!_e))},kt=Rd(function(W){m==null||m(Wh(W)),X(W)}),gn=function(W){R!=="inline"&&te(o,W)},vn=function(){z(o)},Xt=S&&"".concat(S,"-popup"),Vt=b.createElement("div",Wt({role:"menuitem",style:Ht,className:"".concat(ue,"-title"),tabIndex:fe?null:-1,ref:Ee,title:typeof i=="string"?i:null,"data-menu-id":k&&S?null:S,"aria-expanded":He,"aria-haspopup":!0,"aria-controls":Xt,"aria-disabled":fe,onClick:Zt,onFocus:vn},mt),i,b.createElement(rk,{icon:R!=="horizontal"?Se:void 0,props:Oe(Oe({},t),{},{isOpen:He,isSubMenu:!0})},b.createElement("i",{className:"".concat(ue,"-arrow")}))),jt=b.useRef(R);if(R!=="inline"&&ee.length>1?jt.current="vertical":jt.current=R,!k){var Nt=jt.current;Vt=b.createElement(lJ,{mode:Nt,prefixCls:ue,visible:!a&&He&&R!=="inline",popupClassName:d,popupOffset:h,popupStyle:f,popup:b.createElement(T6,{mode:Nt==="horizontal"?"vertical":Nt},b.createElement(EC,{id:Xt,ref:Q},l)),disabled:fe,onVisibleChange:gn},Vt)}var Bn=b.createElement(Sa.Item,Wt({role:"none"},y,{component:"li",style:n,className:Lt(ue,"".concat(ue,"-").concat(R),r,(e={},at(e,"".concat(ue,"-open"),He),at(e,"".concat(ue,"-active"),Jt),at(e,"".concat(ue,"-selected"),Ne),at(e,"".concat(ue,"-disabled"),fe),e)),onMouseEnter:Ye,onMouseLeave:bt}),Vt,!k&&b.createElement(uJ,{id:Xt,open:He,keyPath:ee},l));return T&&(Bn=T(Bn,t,{selected:Ne,active:Jt,open:He,disabled:fe})),b.createElement(T6,{onItemClick:kt,mode:R==="horizontal"?"vertical":R,itemIcon:re,expandIcon:Se},Bn)};function x9(t){var e=t.eventKey,n=t.children,r=c4(e),i=wC(n,r),o=D9();b.useEffect(function(){if(o)return o.registerPath(e,r),function(){o.unregisterPath(e,r)}},[r]);var s;return o?s=i:s=b.createElement(hJ,t,i),b.createElement(Q$.Provider,{value:r},s)}var fJ=["className","title","eventKey","children"],mJ=["children"],pJ=function(t){var e=t.className,n=t.title;t.eventKey;var r=t.children,i=Pn(t,fJ),o=b.useContext(Gs),s=o.prefixCls,a="".concat(s,"-item-group");return b.createElement("li",Wt({role:"presentation"},i,{onClick:function(l){return l.stopPropagation()},className:Lt(a,e)}),b.createElement("div",{role:"presentation",className:"".concat(a,"-title"),title:typeof n=="string"?n:void 0},n),b.createElement("ul",{role:"group",className:"".concat(a,"-list")},r))};function RC(t){var e=t.children,n=Pn(t,mJ),r=c4(n.eventKey),i=wC(e,r),o=D9();return o?i:b.createElement(pJ,w9(n,["warnKey"]),i)}function ok(t){var e=t.className,n=t.style,r=b.useContext(Gs),i=r.prefixCls,o=D9();return o?null:b.createElement("li",{role:"separator",className:Lt("".concat(i,"-item-divider"),e),style:n})}var gJ=["label","children","key","type"];function pv(t){return(t||[]).map(function(e,n){if(e&&pr(e)==="object"){var r=e,i=r.label,o=r.children,s=r.key,a=r.type,l=Pn(r,gJ),u=s??"tmp-".concat(n);return o||a==="group"?a==="group"?b.createElement(RC,Wt({key:u},l,{title:i}),pv(o)):b.createElement(x9,Wt({key:u},l,{title:i}),pv(o)):a==="divider"?b.createElement(ok,Wt({key:u},l)):b.createElement(I9,Wt({key:u},l),i)}return null}).filter(function(e){return e})}function vJ(t,e,n){var r=t;return e&&(r=pv(e)),wC(r,n)}var _J=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem"],Ic=[],bJ=b.forwardRef(function(t,e){var n,r,i=t,o=i.prefixCls,s=o===void 0?"rc-menu":o,a=i.rootClassName,l=i.style,u=i.className,c=i.tabIndex,d=c===void 0?0:c,h=i.items,f=i.children,m=i.direction,p=i.id,g=i.mode,v=g===void 0?"vertical":g,_=i.inlineCollapsed,C=i.disabled,y=i.disabledOverflow,S=i.subMenuOpenDelay,E=S===void 0?.1:S,w=i.subMenuCloseDelay,R=w===void 0?.1:w,D=i.forceSubMenuRender,I=i.defaultOpenKeys,k=i.openKeys,O=i.activeKey,$=i.defaultActiveFirst,N=i.selectable,H=N===void 0?!0:N,X=i.multiple,te=X===void 0?!1:X,z=i.defaultSelectedKeys,A=i.selectedKeys,T=i.onSelect,P=i.onDeselect,K=i.inlineIndent,ee=K===void 0?24:K,ue=i.motion,fe=i.defaultMotions,Ee=i.triggerSubMenuAction,Q=Ee===void 0?"hover":Ee,re=i.builtinPlacements,Se=i.itemIcon,_e=i.expandIcon,He=i.overflowedIndicator,Ne=He===void 0?"...":He,we=i.overflowedIndicatorPopupClassName,Me=i.getPopupContainer,mt=i.onClick,vt=i.onOpenChange,ft=i.onKeyDown;i.openAnimation,i.openTransitionName;var et=i._internalRenderMenuItem,ve=i._internalRenderSubMenuItem,Pe=Pn(i,_J),Ye=b.useMemo(function(){return vJ(f,h,Ic)},[f,h]),bt=b.useState(!1),Jt=ze(bt,2),Ht=Jt[0],Zt=Jt[1],kt=b.useRef(),gn=KQ(p),vn=m==="rtl",Xt=bl(I,{value:k,postState:function(J){return J||Ic}}),Vt=ze(Xt,2),jt=Vt[0],Nt=Vt[1],Bn=function(J){var ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;function ae(){Nt(J),vt==null||vt(J)}ie?Xu.flushSync(ae):ae()},W=b.useState(jt),j=ze(W,2),q=j[0],pe=j[1],Ae=b.useRef(!1),We=b.useMemo(function(){return(v==="inline"||v==="vertical")&&_?["vertical",_]:[v,!1]},[v,_]),Re=ze(We,2),Te=Re[0],G=Re[1],be=Te==="inline",xe=b.useState(Te),ye=ze(xe,2),st=ye[0],Ge=ye[1],lt=b.useState(G),de=ze(lt,2),Le=de[0],Ve=de[1];b.useEffect(function(){Ge(Te),Ve(G),Ae.current&&(be?Nt(q):Bn(Ic))},[Te,G]);var Ze=b.useState(0),Dt=ze(Ze,2),Mt=Dt[0],pn=Dt[1],Yn=Mt>=Ye.length-1||st!=="horizontal"||y;b.useEffect(function(){be&&pe(jt)},[jt]),b.useEffect(function(){return Ae.current=!0,function(){Ae.current=!1}},[]);var Hn=YQ(),ht=Hn.registerPath,Dn=Hn.unregisterPath,Gn=Hn.refreshOverflowKeys,zt=Hn.isSubPathKey,Ke=Hn.getKeyPath,$e=Hn.getKeys,hn=Hn.getSubPathKeys,an=b.useMemo(function(){return{registerPath:ht,unregisterPath:Dn}},[ht,Dn]),Qn=b.useMemo(function(){return{isSubPathKey:zt}},[zt]);b.useEffect(function(){Gn(Yn?Ic:Ye.slice(Mt+1).map(function(J){return J.key}))},[Mt,Yn]);var vr=bl(O||$&&((n=Ye[0])===null||n===void 0?void 0:n.key),{value:O}),mi=ze(vr,2),wo=mi[0],Fi=mi[1],pi=Rd(function(J){Fi(J)}),Qr=Rd(function(){Fi(void 0)});b.useImperativeHandle(e,function(){return{list:kt.current,focus:function(J){var ie,ae=$e(),Ce=fv(ae,gn),Ue=Ce.elements,rt=Ce.key2element,Je=Ce.element2key,qe=yC(kt.current,Ue),It=wo??(qe[0]?Je.get(qe[0]):(ie=Ye.find(function(In){return!In.props.disabled}))===null||ie===void 0?void 0:ie.key),on=rt.get(It);if(It&&on){var An;on==null||(An=on.focus)===null||An===void 0||An.call(on,J)}}}});var Ui=bl(z||[],{value:A,postState:function(J){return Array.isArray(J)?J:J==null?Ic:[J]}}),_s=ze(Ui,2),zr=_s[0],Go=_s[1],Ro=function(J){if(H){var ie=J.key,ae=zr.includes(ie),Ce;te?ae?Ce=zr.filter(function(rt){return rt!==ie}):Ce=[].concat(Mr(zr),[ie]):Ce=[ie],Go(Ce);var Ue=Oe(Oe({},J),{},{selectedKeys:Ce});ae?P==null||P(Ue):T==null||T(Ue)}!te&&jt.length&&st!=="inline"&&Bn(Ic)},Hi=Rd(function(J){mt==null||mt(Wh(J)),Ro(J)}),Di=Rd(function(J,ie){var ae=jt.filter(function(Ue){return Ue!==J});if(ie)ae.push(J);else if(st!=="inline"){var Ce=hn(J);ae=ae.filter(function(Ue){return!Ce.has(Ue)})}Y$(jt,ae,!0)||Bn(ae,!0)}),Ko=function(J,ie){var ae=ie??!jt.includes(J);Di(J,ae)},Zo=zQ(st,wo,vn,gn,kt,$e,Ke,Fi,Ko,ft);b.useEffect(function(){Zt(!0)},[]);var B=b.useMemo(function(){return{_internalRenderMenuItem:et,_internalRenderSubMenuItem:ve}},[et,ve]),Y=st!=="horizontal"||y?Ye:Ye.map(function(J,ie){return b.createElement(T6,{key:J.key,overflowDisabled:ie>Mt},J)}),U=b.createElement(Sa,Wt({id:p,ref:kt,prefixCls:"".concat(s,"-overflow"),component:"ul",itemComponent:I9,className:Lt(s,"".concat(s,"-root"),"".concat(s,"-").concat(st),u,(r={},at(r,"".concat(s,"-inline-collapsed"),Le),at(r,"".concat(s,"-rtl"),vn),r),a),dir:m,style:l,role:"menu",tabIndex:d,data:Y,renderRawItem:function(J){return J},renderRawRest:function(J){var ie=J.length,ae=ie?Ye.slice(-ie):null;return b.createElement(x9,{eventKey:mv,title:Ne,disabled:Yn,internalPopupClose:ie===0,popupClassName:we},ae)},maxCount:st!=="horizontal"||y?Sa.INVALIDATE:Sa.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(J){pn(J)},onKeyDown:Zo},Pe));return b.createElement(CC.Provider,{value:B},b.createElement(G$.Provider,{value:gn},b.createElement(T6,{prefixCls:s,rootClassName:a,mode:st,openKeys:jt,rtl:vn,disabled:C,motion:Ht?ue:null,defaultMotions:Ht?fe:null,activeKey:wo,onActive:pi,onInactive:Qr,selectedKeys:zr,inlineIndent:ee,subMenuOpenDelay:E,subMenuCloseDelay:R,forceSubMenuRender:D,builtinPlacements:re,triggerSubMenuAction:Q,getPopupContainer:Me,itemIcon:Se,expandIcon:_e,onItemClick:Hi,onOpenChange:Di},b.createElement(J$.Provider,{value:Qn},U),b.createElement("div",{style:{display:"none"},"aria-hidden":!0},b.createElement(q$.Provider,{value:an},Ye)))))}),d4=bJ;d4.Item=I9;d4.SubMenu=x9;d4.ItemGroup=RC;d4.Divider=ok;const CJ="univer-menu",yJ="univer-menu-vertical",SJ="univer-menu-hidden",EJ="univer-menu-submenu-hidden",wJ="univer-menu-item-group",RJ="univer-menu-item-group-list",DJ="univer-menu-item-group-title",IJ="univer-menu-item-active",xJ="univer-menu-submenu-active",MJ="univer-menu-item-selected",OJ="univer-menu-submenu-selected",TJ="univer-menu-submenu",$J="univer-menu-horizontal",kJ="univer-menu-sub",AJ="univer-menu-vertical-left",NJ="univer-menu-vertical-right",LJ="univer-menu-item",PJ="univer-menu-item-disabled",BJ="univer-menu-submenu-disabled",FJ="univer-menu-submenu-popup",UJ="univer-submenu-title-wrapper",HJ="univer-menu-submenu-title",VJ="univer-menu-submenu-title-more-icon",jJ="univer-menu-item-more-icon",zJ="univer-menu-inline",WJ="univer-menu-submenu-arrow",XJ="univer-menu-open-slide-up-enter",YJ="univer-menu-open-slide-up-appear",GJ="univer-menu-open-slide-up-leave",KJ="univer-menu-open-slide-up-enter-active",ZJ="univer-menu-open-slide-up-appear-active",qJ="univer-menu-open-slide-up-in",QJ="univer-menu-open-slide-up-leave-active",JJ="univer-menu-open-slide-up-out",eee="univer-menu-open-zoom-enter",tee="univer-menu-open-zoom-appear",nee="univer-menu-open-zoom-leave",ree="univer-menu-open-zoom-enter-active",iee="univer-menu-open-zoom-appear-active",oee="univer-menu-open-zoom-in",see="univer-menu-open-zoom-leave-active",aee="univer-menu-open-zoom-out",lee={menu:CJ,menuVertical:yJ,menuHidden:SJ,menuSubmenuHidden:EJ,menuItemGroup:wJ,menuItemGroupList:RJ,menuItemGroupTitle:DJ,menuItemActive:IJ,menuSubmenuActive:xJ,menuItemSelected:MJ,menuSubmenuSelected:OJ,menuSubmenu:TJ,menuHorizontal:$J,menuSub:kJ,menuVerticalLeft:AJ,menuVerticalRight:NJ,menuItem:LJ,menuItemDisabled:PJ,menuSubmenuDisabled:BJ,menuSubmenuPopup:FJ,submenuTitleWrapper:UJ,menuSubmenuTitle:HJ,menuSubmenuTitleMoreIcon:VJ,menuItemMoreIcon:jJ,menuInline:zJ,menuSubmenuArrow:WJ,menuOpenSlideUpEnter:XJ,menuOpenSlideUpAppear:YJ,menuOpenSlideUpLeave:GJ,menuOpenSlideUpEnterActive:KJ,menuOpenSlideUpAppearActive:ZJ,menuOpenSlideUpIn:qJ,menuOpenSlideUpLeaveActive:QJ,menuOpenSlideUpOut:JJ,menuOpenZoomEnter:eee,menuOpenZoomAppear:tee,menuOpenZoomLeave:nee,menuOpenZoomEnterActive:ree,menuOpenZoomAppearActive:iee,menuOpenZoomIn:oee,menuOpenZoomLeaveActive:see,menuOpenZoomOut:aee};function sk(t){const{mountContainer:e}=b.useContext(R1);return Qe.cloneElement($t.jsx(d4,{prefixCls:lee.menu,getPopupContainer:()=>e}),{...t})}function Xh(t){return Qe.cloneElement($t.jsx(I9,{}),{...t})}function Aw(t){return Qe.cloneElement($t.jsx(x9,{}),{...t})}function uee(t){return Qe.cloneElement($t.jsx(RC,{}),{...t})}var h4={},ak={exports:{}},lk={exports:{}};(function(t){function e(n){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(lk);var f4=lk.exports;(function(t){var e=f4.default;function n(i){if(typeof WeakMap!="function")return null;var o=new WeakMap,s=new WeakMap;return(n=function(a){return a?s:o})(i)}function r(i,o){if(!o&&i&&i.__esModule)return i;if(i===null||e(i)!="object"&&typeof i!="function")return{default:i};var s=n(o);if(s&&s.has(i))return s.get(i);var a={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in i)if(u!=="default"&&Object.prototype.hasOwnProperty.call(i,u)){var c=l?Object.getOwnPropertyDescriptor(i,u):null;c&&(c.get||c.set)?Object.defineProperty(a,u,c):a[u]=i[u]}return a.default=i,s&&s.set(i,a),a}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(ak);var cee=ak.exports,uk={exports:{}};(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(uk);var dee=uk.exports,ck={exports:{}};(function(t){var e=f4.default;function n(){t.exports=n=function(){return i},t.exports.__esModule=!0,t.exports.default=t.exports;var r,i={},o=Object.prototype,s=o.hasOwnProperty,a=Object.defineProperty||function(A,T,P){A[T]=P.value},l=typeof Symbol=="function"?Symbol:{},u=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",d=l.toStringTag||"@@toStringTag";function h(A,T,P){return Object.defineProperty(A,T,{value:P,enumerable:!0,configurable:!0,writable:!0}),A[T]}try{h({},"")}catch{h=function(A,T,P){return A[T]=P}}function f(A,T,P,K){var ee=T&&T.prototype instanceof y?T:y,ue=Object.create(ee.prototype),fe=new te(K||[]);return a(ue,"_invoke",{value:$(A,P,fe)}),ue}function m(A,T,P){try{return{type:"normal",arg:A.call(T,P)}}catch(K){return{type:"throw",arg:K}}}i.wrap=f;var p="suspendedStart",g="suspendedYield",v="executing",_="completed",C={};function y(){}function S(){}function E(){}var w={};h(w,u,function(){return this});var R=Object.getPrototypeOf,D=R&&R(R(z([])));D&&D!==o&&s.call(D,u)&&(w=D);var I=E.prototype=y.prototype=Object.create(w);function k(A){["next","throw","return"].forEach(function(T){h(A,T,function(P){return this._invoke(T,P)})})}function O(A,T){function P(ee,ue,fe,Ee){var Q=m(A[ee],A,ue);if(Q.type!=="throw"){var re=Q.arg,Se=re.value;return Se&&e(Se)=="object"&&s.call(Se,"__await")?T.resolve(Se.__await).then(function(_e){P("next",_e,fe,Ee)},function(_e){P("throw",_e,fe,Ee)}):T.resolve(Se).then(function(_e){re.value=_e,fe(re)},function(_e){return P("throw",_e,fe,Ee)})}Ee(Q.arg)}var K;a(this,"_invoke",{value:function(ee,ue){function fe(){return new T(function(Ee,Q){P(ee,ue,Ee,Q)})}return K=K?K.then(fe,fe):fe()}})}function $(A,T,P){var K=p;return function(ee,ue){if(K===v)throw new Error("Generator is already running");if(K===_){if(ee==="throw")throw ue;return{value:r,done:!0}}for(P.method=ee,P.arg=ue;;){var fe=P.delegate;if(fe){var Ee=N(fe,P);if(Ee){if(Ee===C)continue;return Ee}}if(P.method==="next")P.sent=P._sent=P.arg;else if(P.method==="throw"){if(K===p)throw K=_,P.arg;P.dispatchException(P.arg)}else P.method==="return"&&P.abrupt("return",P.arg);K=v;var Q=m(A,T,P);if(Q.type==="normal"){if(K=P.done?_:g,Q.arg===C)continue;return{value:Q.arg,done:P.done}}Q.type==="throw"&&(K=_,P.method="throw",P.arg=Q.arg)}}}function N(A,T){var P=T.method,K=A.iterator[P];if(K===r)return T.delegate=null,P==="throw"&&A.iterator.return&&(T.method="return",T.arg=r,N(A,T),T.method==="throw")||P!=="return"&&(T.method="throw",T.arg=new TypeError("The iterator does not provide a '"+P+"' method")),C;var ee=m(K,A.iterator,T.arg);if(ee.type==="throw")return T.method="throw",T.arg=ee.arg,T.delegate=null,C;var ue=ee.arg;return ue?ue.done?(T[A.resultName]=ue.value,T.next=A.nextLoc,T.method!=="return"&&(T.method="next",T.arg=r),T.delegate=null,C):ue:(T.method="throw",T.arg=new TypeError("iterator result is not an object"),T.delegate=null,C)}function H(A){var T={tryLoc:A[0]};1 in A&&(T.catchLoc=A[1]),2 in A&&(T.finallyLoc=A[2],T.afterLoc=A[3]),this.tryEntries.push(T)}function X(A){var T=A.completion||{};T.type="normal",delete T.arg,A.completion=T}function te(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(H,this),this.reset(!0)}function z(A){if(A||A===""){var T=A[u];if(T)return T.call(A);if(typeof A.next=="function")return A;if(!isNaN(A.length)){var P=-1,K=function ee(){for(;++P<A.length;)if(s.call(A,P))return ee.value=A[P],ee.done=!1,ee;return ee.value=r,ee.done=!0,ee};return K.next=K}}throw new TypeError(e(A)+" is not iterable")}return S.prototype=E,a(I,"constructor",{value:E,configurable:!0}),a(E,"constructor",{value:S,configurable:!0}),S.displayName=h(E,d,"GeneratorFunction"),i.isGeneratorFunction=function(A){var T=typeof A=="function"&&A.constructor;return!!T&&(T===S||(T.displayName||T.name)==="GeneratorFunction")},i.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,E):(A.__proto__=E,h(A,d,"GeneratorFunction")),A.prototype=Object.create(I),A},i.awrap=function(A){return{__await:A}},k(O.prototype),h(O.prototype,c,function(){return this}),i.AsyncIterator=O,i.async=function(A,T,P,K,ee){ee===void 0&&(ee=Promise);var ue=new O(f(A,T,P,K),ee);return i.isGeneratorFunction(T)?ue:ue.next().then(function(fe){return fe.done?fe.value:ue.next()})},k(I),h(I,d,"Generator"),h(I,u,function(){return this}),h(I,"toString",function(){return"[object Generator]"}),i.keys=function(A){var T=Object(A),P=[];for(var K in T)P.push(K);return P.reverse(),function ee(){for(;P.length;){var ue=P.pop();if(ue in T)return ee.value=ue,ee.done=!1,ee}return ee.done=!0,ee}},i.values=z,te.prototype={constructor:te,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(X),!A)for(var T in this)T.charAt(0)==="t"&&s.call(this,T)&&!isNaN(+T.slice(1))&&(this[T]=r)},stop:function(){this.done=!0;var A=this.tryEntries[0].completion;if(A.type==="throw")throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var T=this;function P(Q,re){return ue.type="throw",ue.arg=A,T.next=Q,re&&(T.method="next",T.arg=r),!!re}for(var K=this.tryEntries.length-1;K>=0;--K){var ee=this.tryEntries[K],ue=ee.completion;if(ee.tryLoc==="root")return P("end");if(ee.tryLoc<=this.prev){var fe=s.call(ee,"catchLoc"),Ee=s.call(ee,"finallyLoc");if(fe&&Ee){if(this.prev<ee.catchLoc)return P(ee.catchLoc,!0);if(this.prev<ee.finallyLoc)return P(ee.finallyLoc)}else if(fe){if(this.prev<ee.catchLoc)return P(ee.catchLoc,!0)}else{if(!Ee)throw new Error("try statement without catch or finally");if(this.prev<ee.finallyLoc)return P(ee.finallyLoc)}}}},abrupt:function(A,T){for(var P=this.tryEntries.length-1;P>=0;--P){var K=this.tryEntries[P];if(K.tryLoc<=this.prev&&s.call(K,"finallyLoc")&&this.prev<K.finallyLoc){var ee=K;break}}ee&&(A==="break"||A==="continue")&&ee.tryLoc<=T&&T<=ee.finallyLoc&&(ee=null);var ue=ee?ee.completion:{};return ue.type=A,ue.arg=T,ee?(this.method="next",this.next=ee.finallyLoc,C):this.complete(ue)},complete:function(A,T){if(A.type==="throw")throw A.arg;return A.type==="break"||A.type==="continue"?this.next=A.arg:A.type==="return"?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):A.type==="normal"&&T&&(this.next=T),C},finish:function(A){for(var T=this.tryEntries.length-1;T>=0;--T){var P=this.tryEntries[T];if(P.finallyLoc===A)return this.complete(P.completion,P.afterLoc),X(P),C}},catch:function(A){for(var T=this.tryEntries.length-1;T>=0;--T){var P=this.tryEntries[T];if(P.tryLoc===A){var K=P.completion;if(K.type==="throw"){var ee=K.arg;X(P)}return ee}}throw new Error("illegal catch attempt")},delegateYield:function(A,T,P){return this.delegate={iterator:z(A),resultName:T,nextLoc:P},this.method==="next"&&(this.arg=r),C}},i}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(ck);var hee=ck.exports,dk={exports:{}};(function(t){function e(r,i,o,s,a,l,u){try{var c=r[l](u),d=c.value}catch(h){o(h);return}c.done?i(d):Promise.resolve(d).then(s,a)}function n(r){return function(){var i=this,o=arguments;return new Promise(function(s,a){var l=r.apply(i,o);function u(d){e(l,s,a,u,c,"next",d)}function c(d){e(l,s,a,u,c,"throw",d)}u(void 0)})}}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(dk);var fee=dk.exports,hk={exports:{}},fk={exports:{}},mk={exports:{}},pk={exports:{}};(function(t){var e=f4.default;function n(r,i){if(e(r)!=="object"||r===null)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var s=o.call(r,i||"default");if(e(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(r)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(pk);var mee=pk.exports;(function(t){var e=f4.default,n=mee;function r(i){var o=n(i,"string");return e(o)==="symbol"?o:String(o)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(mk);var pee=mk.exports;(function(t){var e=pee;function n(r,i,o){return i=e(i),i in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o,r}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(fk);var gee=fk.exports;(function(t){var e=gee;function n(i,o){var s=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);o&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),s.push.apply(s,a)}return s}function r(i){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?n(Object(s),!0).forEach(function(a){e(i,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(s,a))})}return i}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(hk);var vee=hk.exports,_ee=cee.default,M9=dee.default;Object.defineProperty(h4,"__esModule",{value:!0});h4._r=Mee;h4._u=kee;var bee=h4.render=Oee;h4.unmount=Aee;var Yh=M9(hee),gk=M9(fee),Cee=M9(f4),yee=M9(vee),See=_ee(_a),m4=(0,yee.default)({},See),Eee=m4.version,wee=m4.render,Ree=m4.unmountComponentAtNode,O9;try{var Dee=Number((Eee||"").split(".")[0]);Dee>=18&&(O9=m4.createRoot)}catch{}function Nw(t){var e=m4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;e&&(0,Cee.default)(e)==="object"&&(e.usingClientEntryPoint=t)}var Gh="__rc_react_root__";function Iee(t,e){Nw(!0);var n=e[Gh]||O9(e);Nw(!1),n.render(t),e[Gh]=n}function xee(t,e){wee(t,e)}function Mee(t,e){}function Oee(t,e){if(O9){Iee(t,e);return}xee(t,e)}function Tee(t){return gv.apply(this,arguments)}function gv(){return gv=(0,gk.default)((0,Yh.default)().mark(function t(e){return(0,Yh.default)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Promise.resolve().then(function(){var r;(r=e[Gh])===null||r===void 0||r.unmount(),delete e[Gh]}));case 1:case"end":return n.stop()}},t)})),gv.apply(this,arguments)}function $ee(t){Ree(t)}function kee(t){}function Aee(t){return vv.apply(this,arguments)}function vv(){return vv=(0,gk.default)((0,Yh.default)().mark(function t(e){return(0,Yh.default)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(O9===void 0){n.next=2;break}return n.abrupt("return",Tee(e));case 2:$ee(e);case 3:case"end":return n.stop()}},t)})),vv.apply(this,arguments)}function DC(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Bh(t,e)}function Nee(t,e){return t.classList?!!e&&t.classList.contains(e):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+e+" ")!==-1}function Lee(t,e){t.classList?t.classList.add(e):Nee(t,e)||(typeof t.className=="string"?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e))}function Lw(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Pee(t,e){t.classList?t.classList.remove(e):typeof t.className=="string"?t.className=Lw(t.className,e):t.setAttribute("class",Lw(t.className&&t.className.baseVal||"",e))}const Pw={disabled:!1},Kh=Qe.createContext(null);var vk=function(t){return t.scrollTop},Dd="unmounted",fu="exited",mu="entering",Zc="entered",_v="exiting",D1=function(t){DC(e,t);function e(r,i){var o;o=t.call(this,r,i)||this;var s=i,a=s&&!s.isMounting?r.enter:r.appear,l;return o.appearStatus=null,r.in?a?(l=fu,o.appearStatus=mu):l=Zc:r.unmountOnExit||r.mountOnEnter?l=Dd:l=fu,o.state={status:l},o.nextCallback=null,o}e.getDerivedStateFromProps=function(r,i){var o=r.in;return o&&i.status===Dd?{status:fu}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(r){var i=null;if(r!==this.props){var o=this.state.status;this.props.in?o!==mu&&o!==Zc&&(i=mu):(o===mu||o===Zc)&&(i=_v)}this.updateStatus(!1,i)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var r=this.props.timeout,i,o,s;return i=o=s=r,r!=null&&typeof r!="number"&&(i=r.exit,o=r.enter,s=r.appear!==void 0?r.appear:o),{exit:i,enter:o,appear:s}},n.updateStatus=function(r,i){if(r===void 0&&(r=!1),i!==null)if(this.cancelNextCallback(),i===mu){if(this.props.unmountOnExit||this.props.mountOnEnter){var o=this.props.nodeRef?this.props.nodeRef.current:_a.findDOMNode(this);o&&vk(o)}this.performEnter(r)}else this.performExit();else this.props.unmountOnExit&&this.state.status===fu&&this.setState({status:Dd})},n.performEnter=function(r){var i=this,o=this.props.enter,s=this.context?this.context.isMounting:r,a=this.props.nodeRef?[s]:[_a.findDOMNode(this),s],l=a[0],u=a[1],c=this.getTimeouts(),d=s?c.appear:c.enter;if(!r&&!o||Pw.disabled){this.safeSetState({status:Zc},function(){i.props.onEntered(l)});return}this.props.onEnter(l,u),this.safeSetState({status:mu},function(){i.props.onEntering(l,u),i.onTransitionEnd(d,function(){i.safeSetState({status:Zc},function(){i.props.onEntered(l,u)})})})},n.performExit=function(){var r=this,i=this.props.exit,o=this.getTimeouts(),s=this.props.nodeRef?void 0:_a.findDOMNode(this);if(!i||Pw.disabled){this.safeSetState({status:fu},function(){r.props.onExited(s)});return}this.props.onExit(s),this.safeSetState({status:_v},function(){r.props.onExiting(s),r.onTransitionEnd(o.exit,function(){r.safeSetState({status:fu},function(){r.props.onExited(s)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(r,i){i=this.setNextCallback(i),this.setState(r,i)},n.setNextCallback=function(r){var i=this,o=!0;return this.nextCallback=function(s){o&&(o=!1,i.nextCallback=null,r(s))},this.nextCallback.cancel=function(){o=!1},this.nextCallback},n.onTransitionEnd=function(r,i){this.setNextCallback(i);var o=this.props.nodeRef?this.props.nodeRef.current:_a.findDOMNode(this),s=r==null&&!this.props.addEndListener;if(!o||s){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var a=this.props.nodeRef?[this.nextCallback]:[o,this.nextCallback],l=a[0],u=a[1];this.props.addEndListener(l,u)}r!=null&&setTimeout(this.nextCallback,r)},n.render=function(){var r=this.state.status;if(r===Dd)return null;var i=this.props,o=i.children;i.in,i.mountOnEnter,i.unmountOnExit,i.appear,i.enter,i.exit,i.timeout,i.addEndListener,i.onEnter,i.onEntering,i.onEntered,i.onExit,i.onExiting,i.onExited,i.nodeRef;var s=s9(i,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Qe.createElement(Kh.Provider,{value:null},typeof o=="function"?o(r,s):Qe.cloneElement(Qe.Children.only(o),s))},e}(Qe.Component);D1.contextType=Kh;D1.propTypes={};function xc(){}D1.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:xc,onEntering:xc,onEntered:xc,onExit:xc,onExiting:xc,onExited:xc};D1.UNMOUNTED=Dd;D1.EXITED=fu;D1.ENTERING=mu;D1.ENTERED=Zc;D1.EXITING=_v;const Bee=D1;var Fee=function(t,e){return t&&e&&e.split(" ").forEach(function(n){return Lee(t,n)})},Am=function(t,e){return t&&e&&e.split(" ").forEach(function(n){return Pee(t,n)})},IC=function(t){DC(e,t);function e(){for(var r,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r=t.call.apply(t,[this].concat(o))||this,r.appliedClasses={appear:{},enter:{},exit:{}},r.onEnter=function(a,l){var u=r.resolveArguments(a,l),c=u[0],d=u[1];r.removeClasses(c,"exit"),r.addClass(c,d?"appear":"enter","base"),r.props.onEnter&&r.props.onEnter(a,l)},r.onEntering=function(a,l){var u=r.resolveArguments(a,l),c=u[0],d=u[1],h=d?"appear":"enter";r.addClass(c,h,"active"),r.props.onEntering&&r.props.onEntering(a,l)},r.onEntered=function(a,l){var u=r.resolveArguments(a,l),c=u[0],d=u[1],h=d?"appear":"enter";r.removeClasses(c,h),r.addClass(c,h,"done"),r.props.onEntered&&r.props.onEntered(a,l)},r.onExit=function(a){var l=r.resolveArguments(a),u=l[0];r.removeClasses(u,"appear"),r.removeClasses(u,"enter"),r.addClass(u,"exit","base"),r.props.onExit&&r.props.onExit(a)},r.onExiting=function(a){var l=r.resolveArguments(a),u=l[0];r.addClass(u,"exit","active"),r.props.onExiting&&r.props.onExiting(a)},r.onExited=function(a){var l=r.resolveArguments(a),u=l[0];r.removeClasses(u,"exit"),r.addClass(u,"exit","done"),r.props.onExited&&r.props.onExited(a)},r.resolveArguments=function(a,l){return r.props.nodeRef?[r.props.nodeRef.current,a]:[a,l]},r.getClassNames=function(a){var l=r.props.classNames,u=typeof l=="string",c=u&&l?l+"-":"",d=u?""+c+a:l[a],h=u?d+"-active":l[a+"Active"],f=u?d+"-done":l[a+"Done"];return{baseClassName:d,activeClassName:h,doneClassName:f}},r}var n=e.prototype;return n.addClass=function(r,i,o){var s=this.getClassNames(i)[o+"ClassName"],a=this.getClassNames("enter"),l=a.doneClassName;i==="appear"&&o==="done"&&l&&(s+=" "+l),o==="active"&&r&&vk(r),s&&(this.appliedClasses[i][o]=s,Fee(r,s))},n.removeClasses=function(r,i){var o=this.appliedClasses[i],s=o.base,a=o.active,l=o.done;this.appliedClasses[i]={},s&&Am(r,s),a&&Am(r,a),l&&Am(r,l)},n.render=function(){var r=this.props;r.classNames;var i=s9(r,["classNames"]);return Qe.createElement(Bee,Wt({},i,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},e}(Qe.Component);IC.defaultProps={classNames:""};IC.propTypes={};const _k=IC;function xC(t,e){var n=function(i){return e&&b.isValidElement(i)?e(i):i},r=Object.create(null);return t&&b.Children.map(t,function(i){return i}).forEach(function(i){r[i.key]=n(i)}),r}function Uee(t,e){t=t||{},e=e||{};function n(c){return c in e?e[c]:t[c]}var r=Object.create(null),i=[];for(var o in t)o in e?i.length&&(r[o]=i,i=[]):i.push(o);var s,a={};for(var l in e){if(r[l])for(s=0;s<r[l].length;s++){var u=r[l][s];a[r[l][s]]=n(u)}a[l]=n(l)}for(s=0;s<i.length;s++)a[i[s]]=n(i[s]);return a}function Iu(t,e,n){return n[e]!=null?n[e]:t.props[e]}function Hee(t,e){return xC(t.children,function(n){return b.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:Iu(n,"appear",t),enter:Iu(n,"enter",t),exit:Iu(n,"exit",t)})})}function Vee(t,e,n){var r=xC(t.children),i=Uee(e,r);return Object.keys(i).forEach(function(o){var s=i[o];if(b.isValidElement(s)){var a=o in e,l=o in r,u=e[o],c=b.isValidElement(u)&&!u.props.in;l&&(!a||c)?i[o]=b.cloneElement(s,{onExited:n.bind(null,s),in:!0,exit:Iu(s,"exit",t),enter:Iu(s,"enter",t)}):!l&&a&&!c?i[o]=b.cloneElement(s,{in:!1}):l&&a&&b.isValidElement(u)&&(i[o]=b.cloneElement(s,{onExited:n.bind(null,s),in:u.props.in,exit:Iu(s,"exit",t),enter:Iu(s,"enter",t)}))}}),i}var jee=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},zee={component:"div",childFactory:function(t){return t}},MC=function(t){DC(e,t);function e(r,i){var o;o=t.call(this,r,i)||this;var s=o.handleExited.bind(Uh(o));return o.state={contextValue:{isMounting:!0},handleExited:s,firstRender:!0},o}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(r,i){var o=i.children,s=i.handleExited,a=i.firstRender;return{children:a?Hee(r,s):Vee(r,o,s),firstRender:!1}},n.handleExited=function(r,i){var o=xC(this.props.children);r.key in o||(r.props.onExited&&r.props.onExited(i),this.mounted&&this.setState(function(s){var a=Wt({},s.children);return delete a[r.key],{children:a}}))},n.render=function(){var r=this.props,i=r.component,o=r.childFactory,s=s9(r,["component","childFactory"]),a=this.state.contextValue,l=jee(this.state.children).map(o);return delete s.appear,delete s.enter,delete s.exit,i===null?Qe.createElement(Kh.Provider,{value:a},l):Qe.createElement(Kh.Provider,{value:a},Qe.createElement(i,s,l))},e}(Qe.Component);MC.propTypes={};MC.defaultProps=zee;const Wee=MC,Xee="univer-message",Yee="univer-message-item",Gee="univer-enter-active",Kee="univer-enter-done",Zee="univer-exit",qee="univer-exit-active",Qee="univer-message-icon",Jee="univer-message-icon-success",ete="univer-message-icon-warning",tte="univer-message-icon-error",nte="univer-message-content",ks={message:Xee,messageItem:Yee,enterActive:Gee,enterDone:Kee,exit:Zee,exitActive:qee,messageIcon:Qee,messageIconSuccess:Jee,messageIconWarning:ete,messageIconError:tte,messageContent:nte};var T9=(t=>(t.Success="success",t.Warning="warning",t.Error="error",t))(T9||{});const rte={success:$t.jsx(fY,{className:ks.messageIconSuccess}),warning:$t.jsx(pY,{className:ks.messageIconWarning}),error:$t.jsx(oY,{className:ks.messageIconError})},ite=t=>{const{type:e,content:n}=t;return $t.jsx("div",{className:ks.messageItem,children:$t.jsxs("div",{className:ks.messageContent,children:[$t.jsx("span",{className:ks.messageIcon,children:rte[e]}),$t.jsx("span",{children:n})]})})},ote=t=>{const{messages:e}=t;return $t.jsx(Wee,{className:ks.message,children:e.map(n=>$t.jsx(_k,{timeout:200,classNames:{enterActive:ks.enterActive,enterDone:ks.enterDone,exitActive:ks.exit,exitDone:ks.exitActive},children:$t.jsx(ite,{...n})},n.key))})};class ste{constructor(e){Ph(this,"_div"),Ph(this,"_messages",[]),this._div=document.createElement("div"),e.appendChild(this._div),this.render()}append(e,n){const{content:r,delay:i=3e3}=n,o=Date.now();this._messages.push({key:o,type:e,content:r}),setTimeout(()=>{this.teardown(o)},i),this.render()}teardown(e){this._messages=this._messages.filter(n=>n.key!==e),this.render()}render(){bee($t.jsx(ote,{messages:this._messages}),this._div)}success(e){this.append("success",e)}warning(e){this.append("warning",e)}error(e){this.append("error",e)}}const ate="univer-popup",lte="univer-popup-enter",ute="univer-popup-enter-active",cte="univer-popup-slide-up-in",dte="univer-popup-exit",hte="univer-popup-slide-up-out",fte="univer-popup-exit-active",Mc={popup:ate,popupEnter:lte,popupEnterActive:ute,popupSlideUpIn:cte,popupExit:dte,popupSlideUpOut:hte,popupExitActive:fte};function OC(t){const{children:e,visible:n=!1,offset:r=[0,0]}=t,i=b.useRef(null),[o,s]=b.useState(r);b.useEffect(()=>{if(!n){s([-9999,-9999]);return}const[l,u]=r,{clientWidth:c,clientHeight:d}=i.current,{innerWidth:h,innerHeight:f}=window,m=l+c>h?h-c:l,p=u+d>f?f-d:u;s([m,p])},[r,n]);function a(l){l.preventDefault()}return $t.jsx(_k,{in:n,nodeRef:i,timeout:300,classNames:{enter:Mc.popupEnter,enterActive:Mc.popupEnterActive,enterDone:Mc.popupEnterDone,exitActive:Mc.popupExit,exitDone:Mc.popupExitActive},children:$t.jsx("section",{ref:i,className:Mc.popup,style:{left:o[0],top:o[1]},onContextMenu:a,children:e})})}var $9=function(t){var e=t.className,n=t.customizeIcon,r=t.customizeIconProps,i=t.onMouseDown,o=t.onClick,s=t.children,a;return typeof n=="function"?a=n(r):a=n,b.createElement("span",{className:e,onMouseDown:function(l){l.preventDefault(),i&&i(l)},style:{userSelect:"none",WebkitUserSelect:"none"},unselectable:"on",onClick:o,"aria-hidden":!0},a!==void 0?a:b.createElement("span",{className:Lt(e.split(/\s+/).map(function(l){return"".concat(l,"-icon")}))},s))};function mte(t,e,n,r,i){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,s=arguments.length>6?arguments[6]:void 0,a=arguments.length>7?arguments[7]:void 0,l=Qe.useMemo(function(){if(pr(r)==="object")return r.clearIcon;if(i)return i},[r,i]),u=Qe.useMemo(function(){return!!(!o&&r&&(n.length||s)&&!(a==="combobox"&&s===""))},[r,o,n.length,s,a]);return{allowClear:u,clearIcon:Qe.createElement($9,{className:"".concat(t,"-clear"),onMouseDown:e,customizeIcon:l},"")}}var bk=b.createContext(null);function pte(){return b.useContext(bk)}function gte(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10,e=b.useState(!1),n=ze(e,2),r=n[0],i=n[1],o=b.useRef(null),s=function(){window.clearTimeout(o.current)};b.useEffect(function(){return s},[]);var a=function(l,u){s(),o.current=window.setTimeout(function(){i(l),u&&u()},t)};return[r,a,s]}function Ck(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:250,e=b.useRef(null),n=b.useRef(null);b.useEffect(function(){return function(){window.clearTimeout(n.current)}},[]);function r(i){(i||e.current===null)&&(e.current=i),window.clearTimeout(n.current),n.current=window.setTimeout(function(){e.current=null},t)}return[function(){return e.current},r]}function vte(t,e,n,r){var i=b.useRef(null);i.current={open:e,triggerOpen:n,customizedTrigger:r},b.useEffect(function(){function o(s){var a;if(!((a=i.current)!==null&&a!==void 0&&a.customizedTrigger)){var l=s.target;l.shadowRoot&&s.composed&&(l=s.composedPath()[0]||l),i.current.open&&t().filter(function(u){return u}).every(function(u){return!u.contains(l)&&u!==l})&&i.current.triggerOpen(!1)}}return window.addEventListener("mousedown",o),function(){return window.removeEventListener("mousedown",o)}},[])}var _te=function(t,e){var n,r=t.prefixCls,i=t.id,o=t.inputElement,s=t.disabled,a=t.tabIndex,l=t.autoFocus,u=t.autoComplete,c=t.editable,d=t.activeDescendantId,h=t.value,f=t.maxLength,m=t.onKeyDown,p=t.onMouseDown,g=t.onChange,v=t.onPaste,_=t.onCompositionStart,C=t.onCompositionEnd,y=t.open,S=t.attrs,E=o||b.createElement("input",null),w=E,R=w.ref,D=w.props,I=D.onKeyDown,k=D.onChange,O=D.onMouseDown,$=D.onCompositionStart,N=D.onCompositionEnd,H=D.style;return"maxLength"in E.props,E=b.cloneElement(E,Oe(Oe(Oe({type:"search"},D),{},{id:i,ref:ac(e,R),disabled:s,tabIndex:a,autoComplete:u||"off",autoFocus:l,className:Lt("".concat(r,"-selection-search-input"),(n=E)===null||n===void 0||(n=n.props)===null||n===void 0?void 0:n.className),role:"combobox","aria-expanded":y||!1,"aria-haspopup":"listbox","aria-owns":"".concat(i,"_list"),"aria-autocomplete":"list","aria-controls":"".concat(i,"_list"),"aria-activedescendant":y?d:void 0},S),{},{value:c?h:"",maxLength:f,readOnly:!c,unselectable:c?null:"on",style:Oe(Oe({},H),{},{opacity:c?null:0}),onKeyDown:function(X){m(X),I&&I(X)},onMouseDown:function(X){p(X),O&&O(X)},onChange:function(X){g(X),k&&k(X)},onCompositionStart:function(X){_(X),$&&$(X)},onCompositionEnd:function(X){C(X),N&&N(X)},onPaste:v})),E},TC=b.forwardRef(_te);TC.displayName="Input";function yk(t){return Array.isArray(t)?t:t!==void 0?[t]:[]}var bte=typeof window<"u"&&window.document&&window.document.documentElement,Cte=bte;function yte(t){return t!=null}function Ste(t){return!t&&t!==0}function Bw(t){return["string","number"].includes(pr(t))}function Sk(t){var e=void 0;return t&&(Bw(t.title)?e=t.title.toString():Bw(t.label)&&(e=t.label.toString())),e}function Ete(t,e){Cte?b.useLayoutEffect(t,e):b.useEffect(t,e)}function wte(t){var e;return(e=t.key)!==null&&e!==void 0?e:t.value}var Fw=function(t){t.preventDefault(),t.stopPropagation()},Rte=function(t){var e=t.id,n=t.prefixCls,r=t.values,i=t.open,o=t.searchValue,s=t.autoClearSearchValue,a=t.inputRef,l=t.placeholder,u=t.disabled,c=t.mode,d=t.showSearch,h=t.autoFocus,f=t.autoComplete,m=t.activeDescendantId,p=t.tabIndex,g=t.removeIcon,v=t.maxTagCount,_=t.maxTagTextLength,C=t.maxTagPlaceholder,y=C===void 0?function(Ne){return"+ ".concat(Ne.length," ...")}:C,S=t.tagRender,E=t.onToggleOpen,w=t.onRemove,R=t.onInputChange,D=t.onInputPaste,I=t.onInputKeyDown,k=t.onInputMouseDown,O=t.onInputCompositionStart,$=t.onInputCompositionEnd,N=b.useRef(null),H=b.useState(0),X=ze(H,2),te=X[0],z=X[1],A=b.useState(!1),T=ze(A,2),P=T[0],K=T[1],ee="".concat(n,"-selection"),ue=i||c==="multiple"&&s===!1||c==="tags"?o:"",fe=c==="tags"||c==="multiple"&&s===!1||d&&(i||P);Ete(function(){z(N.current.scrollWidth)},[ue]);function Ee(Ne,we,Me,mt,vt){return b.createElement("span",{className:Lt("".concat(ee,"-item"),at({},"".concat(ee,"-item-disabled"),Me)),title:Sk(Ne)},b.createElement("span",{className:"".concat(ee,"-item-content")},we),mt&&b.createElement($9,{className:"".concat(ee,"-item-remove"),onMouseDown:Fw,onClick:vt,customizeIcon:g},""))}function Q(Ne,we,Me,mt,vt){var ft=function(et){Fw(et),E(!i)};return b.createElement("span",{onMouseDown:ft},S({label:we,value:Ne,disabled:Me,closable:mt,onClose:vt}))}function re(Ne){var we=Ne.disabled,Me=Ne.label,mt=Ne.value,vt=!u&&!we,ft=Me;if(typeof _=="number"&&(typeof Me=="string"||typeof Me=="number")){var et=String(ft);et.length>_&&(ft="".concat(et.slice(0,_),"..."))}var ve=function(Pe){Pe&&Pe.stopPropagation(),w(Ne)};return typeof S=="function"?Q(mt,ft,we,vt,ve):Ee(Ne,ft,we,vt,ve)}function Se(Ne){var we=typeof y=="function"?y(Ne):y;return Ee({title:we},we,!1)}var _e=b.createElement("div",{className:"".concat(ee,"-search"),style:{width:te},onFocus:function(){K(!0)},onBlur:function(){K(!1)}},b.createElement(TC,{ref:a,open:i,prefixCls:n,id:e,inputElement:null,disabled:u,autoFocus:h,autoComplete:f,editable:fe,activeDescendantId:m,value:ue,onKeyDown:I,onMouseDown:k,onChange:R,onPaste:D,onCompositionStart:O,onCompositionEnd:$,tabIndex:p,attrs:x6(t,!0)}),b.createElement("span",{ref:N,className:"".concat(ee,"-search-mirror"),"aria-hidden":!0},ue,"")),He=b.createElement(Sa,{prefixCls:"".concat(ee,"-overflow"),data:r,renderItem:re,renderRest:Se,suffix:_e,itemKey:wte,maxCount:v});return b.createElement(b.Fragment,null,He,!r.length&&!ue&&b.createElement("span",{className:"".concat(ee,"-placeholder")},l))},Dte=function(t){var e=t.inputElement,n=t.prefixCls,r=t.id,i=t.inputRef,o=t.disabled,s=t.autoFocus,a=t.autoComplete,l=t.activeDescendantId,u=t.mode,c=t.open,d=t.values,h=t.placeholder,f=t.tabIndex,m=t.showSearch,p=t.searchValue,g=t.activeValue,v=t.maxLength,_=t.onInputKeyDown,C=t.onInputMouseDown,y=t.onInputChange,S=t.onInputPaste,E=t.onInputCompositionStart,w=t.onInputCompositionEnd,R=t.title,D=b.useState(!1),I=ze(D,2),k=I[0],O=I[1],$=u==="combobox",N=$||m,H=d[0],X=p||"";$&&g&&!k&&(X=g),b.useEffect(function(){$&&O(!1)},[$,g]);var te=u!=="combobox"&&!c&&!m?!1:!!X,z=R===void 0?Sk(H):R,A=function(){if(H)return null;var T=te?{visibility:"hidden"}:void 0;return b.createElement("span",{className:"".concat(n,"-selection-placeholder"),style:T},h)};return b.createElement(b.Fragment,null,b.createElement("span",{className:"".concat(n,"-selection-search")},b.createElement(TC,{ref:i,prefixCls:n,id:r,open:c,inputElement:e,disabled:o,autoFocus:s,autoComplete:a,editable:N,activeDescendantId:l,value:X,onKeyDown:_,onMouseDown:C,onChange:function(T){O(!0),y(T)},onPaste:S,onCompositionStart:E,onCompositionEnd:w,tabIndex:f,attrs:x6(t,!0),maxLength:$?v:void 0})),!$&&H?b.createElement("span",{className:"".concat(n,"-selection-item"),title:z,style:te?{visibility:"hidden"}:void 0},H.label):null,A())};function Ite(t){return![ot.ESC,ot.SHIFT,ot.BACKSPACE,ot.TAB,ot.WIN_KEY,ot.ALT,ot.META,ot.WIN_KEY_RIGHT,ot.CTRL,ot.SEMICOLON,ot.EQUALS,ot.CAPS_LOCK,ot.CONTEXT_MENU,ot.F1,ot.F2,ot.F3,ot.F4,ot.F5,ot.F6,ot.F7,ot.F8,ot.F9,ot.F10,ot.F11,ot.F12].includes(t)}var xte=function(t,e){var n=b.useRef(null),r=b.useRef(!1),i=t.prefixCls,o=t.open,s=t.mode,a=t.showSearch,l=t.tokenWithEnter,u=t.autoClearSearchValue,c=t.onSearch,d=t.onSearchSubmit,h=t.onToggleOpen,f=t.onInputKeyDown,m=t.domRef;b.useImperativeHandle(e,function(){return{focus:function(){n.current.focus()},blur:function(){n.current.blur()}}});var p=Ck(0),g=ze(p,2),v=g[0],_=g[1],C=function(H){var X=H.which;(X===ot.UP||X===ot.DOWN)&&H.preventDefault(),f&&f(H),X===ot.ENTER&&s==="tags"&&!r.current&&!o&&(d==null||d(H.target.value)),Ite(X)&&h(!0)},y=function(){_(!0)},S=b.useRef(null),E=function(H){c(H,!0,r.current)!==!1&&h(!0)},w=function(){r.current=!0},R=function(H){r.current=!1,s!=="combobox"&&E(H.target.value)},D=function(H){var X=H.target.value;if(l&&S.current&&/[\r\n]/.test(S.current)){var te=S.current.replace(/[\r\n]+$/,"").replace(/\r\n/g," ").replace(/[\r\n]/g," ");X=X.replace(te,S.current)}S.current=null,E(X)},I=function(H){var X=H.clipboardData,te=X.getData("text");S.current=te},k=function(H){var X=H.target;if(X!==n.current){var te=document.body.style.msTouchAction!==void 0;te?setTimeout(function(){n.current.focus()}):n.current.focus()}},O=function(H){var X=v();H.target!==n.current&&!X&&s!=="combobox"&&H.preventDefault(),(s!=="combobox"&&(!a||!X)||!o)&&(o&&u!==!1&&c("",!0,!1),h())},$={inputRef:n,onInputKeyDown:C,onInputMouseDown:y,onInputChange:D,onInputPaste:I,onInputCompositionStart:w,onInputCompositionEnd:R},N=s==="multiple"||s==="tags"?b.createElement(Rte,Wt({},t,$)):b.createElement(Dte,Wt({},t,$));return b.createElement("div",{ref:m,className:"".concat(i,"-selector"),onClick:k,onMouseDown:O},N)},Ek=b.forwardRef(xte);Ek.displayName="Selector";var Mte=["prefixCls","disabled","visible","children","popupElement","animation","transitionName","dropdownStyle","dropdownClassName","direction","placement","builtinPlacements","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","getPopupContainer","empty","getTriggerDOMNode","onPopupVisibleChange","onPopupMouseEnter"],Ote=function(t){var e=t===!0?0:1;return{bottomLeft:{points:["tl","bl"],offset:[0,4],overflow:{adjustX:e,adjustY:1},htmlRegion:"scroll"},bottomRight:{points:["tr","br"],offset:[0,4],overflow:{adjustX:e,adjustY:1},htmlRegion:"scroll"},topLeft:{points:["bl","tl"],offset:[0,-4],overflow:{adjustX:e,adjustY:1},htmlRegion:"scroll"},topRight:{points:["br","tr"],offset:[0,-4],overflow:{adjustX:e,adjustY:1},htmlRegion:"scroll"}}},Tte=function(t,e){var n=t.prefixCls;t.disabled;var r=t.visible,i=t.children,o=t.popupElement,s=t.animation,a=t.transitionName,l=t.dropdownStyle,u=t.dropdownClassName,c=t.direction,d=c===void 0?"ltr":c,h=t.placement,f=t.builtinPlacements,m=t.dropdownMatchSelectWidth,p=t.dropdownRender,g=t.dropdownAlign,v=t.getPopupContainer,_=t.empty,C=t.getTriggerDOMNode,y=t.onPopupVisibleChange,S=t.onPopupMouseEnter,E=Pn(t,Mte),w="".concat(n,"-dropdown"),R=o;p&&(R=p(o));var D=b.useMemo(function(){return f||Ote(m)},[f,m]),I=s?"".concat(w,"-").concat(s):a,k=typeof m=="number",O=b.useMemo(function(){return k?null:m===!1?"minWidth":"width"},[m,k]),$=l;k&&($=Oe(Oe({},$),{},{width:m}));var N=b.useRef(null);return b.useImperativeHandle(e,function(){return{getPopupElement:function(){return N.current}}}),b.createElement(E9,Wt({},E,{showAction:y?["click"]:[],hideAction:y?["click"]:[],popupPlacement:h||(d==="rtl"?"bottomRight":"bottomLeft"),builtinPlacements:D,prefixCls:w,popupTransitionName:I,popup:b.createElement("div",{ref:N,onMouseEnter:S},R),stretch:O,popupAlign:g,popupVisible:r,getPopupContainer:v,popupClassName:Lt(u,at({},"".concat(w,"-empty"),_)),popupStyle:$,getTriggerDOMNode:C,onPopupVisibleChange:y}),i)},wk=b.forwardRef(Tte);wk.displayName="SelectTrigger";function $te(t){return kT(t)||qT(t)||sC(t)||AT()}function Uw(t,e){var n=t.key,r;return"value"in t&&(r=t.value),n??(r!==void 0?r:"rc-index-key-".concat(e))}function Rk(t,e){var n=t||{},r=n.label,i=n.value,o=n.options,s=n.groupLabel,a=r||(e?"children":"label");return{label:a,value:i||"value",options:o||"options",groupLabel:s||a}}function kte(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.fieldNames,r=e.childrenAsData,i=[],o=Rk(n,!1),s=o.label,a=o.value,l=o.options,u=o.groupLabel;function c(d,h){d.forEach(function(f){if(h||!(l in f)){var m=f[a];i.push({key:Uw(f,i.length),groupOption:h,data:f,label:f[s],value:m})}else{var p=f[u];p===void 0&&r&&(p=f.label),i.push({key:Uw(f,i.length),group:!0,data:f,label:p}),c(f[l],!0)}})}return c(t,!1),i}function bv(t){var e=Oe({},t);return"props"in e||Object.defineProperty(e,"props",{get:function(){return zl(!1,"Return type is option instead of Option instance. Please read value directly instead of reading from `props`."),e}}),e}function Ate(t,e){if(!e||!e.length)return null;var n=!1;function r(o,s){var a=$te(s),l=a[0],u=a.slice(1);if(!l)return[o];var c=o.split(l);return n=n||c.length>1,c.reduce(function(d,h){return[].concat(Mr(d),Mr(r(h,u)))},[]).filter(function(d){return d})}var i=r(t,e);return n?i:null}var Nte=["id","prefixCls","className","showSearch","tagRender","direction","omitDomProps","displayValues","onDisplayValuesChange","emptyOptions","notFoundContent","onClear","mode","disabled","loading","getInputElement","getRawInputElement","open","defaultOpen","onDropdownVisibleChange","activeValue","onActiveValueChange","activeDescendantId","searchValue","autoClearSearchValue","onSearch","onSearchSplit","tokenSeparators","allowClear","suffixIcon","clearIcon","OptionList","animation","transitionName","dropdownStyle","dropdownClassName","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","placement","builtinPlacements","getPopupContainer","showAction","onFocus","onBlur","onKeyUp","onKeyDown","onMouseDown"],Lte=["value","onChange","removeIcon","placeholder","autoFocus","maxTagCount","maxTagTextLength","maxTagPlaceholder","choiceTransitionName","onInputKeyDown","onPopupScroll","tabIndex"];function Cv(t){return t==="tags"||t==="multiple"}var Pte=b.forwardRef(function(t,e){var n,r,i=t.id,o=t.prefixCls,s=t.className,a=t.showSearch,l=t.tagRender,u=t.direction,c=t.omitDomProps,d=t.displayValues,h=t.onDisplayValuesChange,f=t.emptyOptions,m=t.notFoundContent,p=m===void 0?"Not Found":m,g=t.onClear,v=t.mode,_=t.disabled,C=t.loading,y=t.getInputElement,S=t.getRawInputElement,E=t.open,w=t.defaultOpen,R=t.onDropdownVisibleChange,D=t.activeValue,I=t.onActiveValueChange,k=t.activeDescendantId,O=t.searchValue,$=t.autoClearSearchValue,N=t.onSearch,H=t.onSearchSplit,X=t.tokenSeparators,te=t.allowClear,z=t.suffixIcon,A=t.clearIcon,T=t.OptionList,P=t.animation,K=t.transitionName,ee=t.dropdownStyle,ue=t.dropdownClassName,fe=t.dropdownMatchSelectWidth,Ee=t.dropdownRender,Q=t.dropdownAlign,re=t.placement,Se=t.builtinPlacements,_e=t.getPopupContainer,He=t.showAction,Ne=He===void 0?[]:He,we=t.onFocus,Me=t.onBlur,mt=t.onKeyUp,vt=t.onKeyDown,ft=t.onMouseDown,et=Pn(t,Nte),ve=Cv(v),Pe=(a!==void 0?a:ve)||v==="combobox",Ye=Oe({},et);Lte.forEach(function(U){delete Ye[U]}),c==null||c.forEach(function(U){delete Ye[U]});var bt=b.useState(!1),Jt=ze(bt,2),Ht=Jt[0],Zt=Jt[1];b.useEffect(function(){Zt(vC())},[]);var kt=b.useRef(null),gn=b.useRef(null),vn=b.useRef(null),Xt=b.useRef(null),Vt=b.useRef(null),jt=b.useRef(!1),Nt=gte(),Bn=ze(Nt,3),W=Bn[0],j=Bn[1],q=Bn[2];b.useImperativeHandle(e,function(){var U,J;return{focus:(U=Xt.current)===null||U===void 0?void 0:U.focus,blur:(J=Xt.current)===null||J===void 0?void 0:J.blur,scrollTo:function(ie){var ae;return(ae=Vt.current)===null||ae===void 0?void 0:ae.scrollTo(ie)}}});var pe=b.useMemo(function(){var U;if(v!=="combobox")return O;var J=(U=d[0])===null||U===void 0?void 0:U.value;return typeof J=="string"||typeof J=="number"?String(J):""},[O,v,d]),Ae=v==="combobox"&&typeof y=="function"&&y()||null,We=typeof S=="function"&&S(),Re=g0(gn,We==null||(n=We.props)===null||n===void 0?void 0:n.ref),Te=b.useState(!1),G=ze(Te,2),be=G[0],xe=G[1];Lr(function(){xe(!0)},[]);var ye=bl(!1,{defaultValue:w,value:E}),st=ze(ye,2),Ge=st[0],lt=st[1],de=be?Ge:!1,Le=!p&&f;(_||Le&&de&&v==="combobox")&&(de=!1);var Ve=Le?!1:de,Ze=b.useCallback(function(U){var J=U!==void 0?U:!de;_||(lt(J),de!==J&&(R==null||R(J)))},[_,de,lt,R]),Dt=b.useMemo(function(){return(X||[]).some(function(U){return[`
`,`\r
`].includes(U)})},[X]),Mt=function(U,J,ie){var ae=!0,Ce=U;I==null||I(null);var Ue=ie?null:Ate(U,X);return v!=="combobox"&&Ue&&(Ce="",H==null||H(Ue),Ze(!1),ae=!1),N&&pe!==Ce&&N(Ce,{source:J?"typing":"effect"}),ae},pn=function(U){!U||!U.trim()||N(U,{source:"submit"})};b.useEffect(function(){!de&&!ve&&v!=="combobox"&&Mt("",!1,!1)},[de]),b.useEffect(function(){Ge&&_&&lt(!1),_&&!jt.current&&j(!1)},[_]);var Yn=Ck(),Hn=ze(Yn,2),ht=Hn[0],Dn=Hn[1],Gn=function(U){var J=ht(),ie=U.which;if(ie===ot.ENTER&&(v!=="combobox"&&U.preventDefault(),de||Ze(!0)),Dn(!!pe),ie===ot.BACKSPACE&&!J&&ve&&!pe&&d.length){for(var ae=Mr(d),Ce=null,Ue=ae.length-1;Ue>=0;Ue-=1){var rt=ae[Ue];if(!rt.disabled){ae.splice(Ue,1),Ce=rt;break}}Ce&&h(ae,{type:"remove",values:[Ce]})}for(var Je=arguments.length,qe=new Array(Je>1?Je-1:0),It=1;It<Je;It++)qe[It-1]=arguments[It];if(de&&Vt.current){var on;(on=Vt.current).onKeyDown.apply(on,[U].concat(qe))}vt==null||vt.apply(void 0,[U].concat(qe))},zt=function(U){for(var J=arguments.length,ie=new Array(J>1?J-1:0),ae=1;ae<J;ae++)ie[ae-1]=arguments[ae];if(de&&Vt.current){var Ce;(Ce=Vt.current).onKeyUp.apply(Ce,[U].concat(ie))}mt==null||mt.apply(void 0,[U].concat(ie))},Ke=function(U){var J=d.filter(function(ie){return ie!==U});h(J,{type:"remove",values:[U]})},$e=b.useRef(!1),hn=function(){j(!0),_||(we&&!$e.current&&we.apply(void 0,arguments),Ne.includes("focus")&&Ze(!0)),$e.current=!0},an=function(){jt.current=!0,j(!1,function(){$e.current=!1,jt.current=!1,Ze(!1)}),!_&&(pe&&(v==="tags"?N(pe,{source:"submit"}):v==="multiple"&&N("",{source:"blur"})),Me&&Me.apply(void 0,arguments))},Qn=[];b.useEffect(function(){return function(){Qn.forEach(function(U){return clearTimeout(U)}),Qn.splice(0,Qn.length)}},[]);var vr=function(U){var J,ie=U.target,ae=(J=vn.current)===null||J===void 0?void 0:J.getPopupElement();if(ae&&ae.contains(ie)){var Ce=setTimeout(function(){var qe=Qn.indexOf(Ce);if(qe!==-1&&Qn.splice(qe,1),q(),!Ht&&!ae.contains(document.activeElement)){var It;(It=Xt.current)===null||It===void 0||It.focus()}});Qn.push(Ce)}for(var Ue=arguments.length,rt=new Array(Ue>1?Ue-1:0),Je=1;Je<Ue;Je++)rt[Je-1]=arguments[Je];ft==null||ft.apply(void 0,[U].concat(rt))},mi=b.useState({}),wo=ze(mi,2),Fi=wo[1];function pi(){Fi({})}var Qr;We&&(Qr=function(U){Ze(U)}),vte(function(){var U;return[kt.current,(U=vn.current)===null||U===void 0?void 0:U.getPopupElement()]},Ve,Ze,!!We);var Ui=b.useMemo(function(){return Oe(Oe({},t),{},{notFoundContent:p,open:de,triggerOpen:Ve,id:i,showSearch:Pe,multiple:ve,toggleOpen:Ze})},[t,p,Ve,de,i,Pe,ve,Ze]),_s=!!z||C,zr;_s&&(zr=b.createElement($9,{className:Lt("".concat(o,"-arrow"),at({},"".concat(o,"-arrow-loading"),C)),customizeIcon:z,customizeIconProps:{loading:C,searchValue:pe,open:de,focused:W,showSearch:Pe}}));var Go=function(){var U;g==null||g(),(U=Xt.current)===null||U===void 0||U.focus(),h([],{type:"clear",values:d}),Mt("",!1,!1)},Ro=mte(o,Go,d,te,A,_,pe,v),Hi=Ro.allowClear,Di=Ro.clearIcon,Ko=b.createElement(T,{ref:Vt}),Zo=Lt(o,s,(r={},at(r,"".concat(o,"-focused"),W),at(r,"".concat(o,"-multiple"),ve),at(r,"".concat(o,"-single"),!ve),at(r,"".concat(o,"-allow-clear"),te),at(r,"".concat(o,"-show-arrow"),_s),at(r,"".concat(o,"-disabled"),_),at(r,"".concat(o,"-loading"),C),at(r,"".concat(o,"-open"),de),at(r,"".concat(o,"-customize-input"),Ae),at(r,"".concat(o,"-show-search"),Pe),r)),B=b.createElement(wk,{ref:vn,disabled:_,prefixCls:o,visible:Ve,popupElement:Ko,animation:P,transitionName:K,dropdownStyle:ee,dropdownClassName:ue,direction:u,dropdownMatchSelectWidth:fe,dropdownRender:Ee,dropdownAlign:Q,placement:re,builtinPlacements:Se,getPopupContainer:_e,empty:f,getTriggerDOMNode:function(){return gn.current},onPopupVisibleChange:Qr,onPopupMouseEnter:pi},We?b.cloneElement(We,{ref:Re}):b.createElement(Ek,Wt({},t,{domRef:gn,prefixCls:o,inputElement:Ae,ref:Xt,id:i,showSearch:Pe,autoClearSearchValue:$,mode:v,activeDescendantId:k,tagRender:l,values:d,open:de,onToggleOpen:Ze,activeValue:D,searchValue:pe,onSearch:Mt,onSearchSubmit:pn,onRemove:Ke,tokenWithEnter:Dt}))),Y;return We?Y=B:Y=b.createElement("div",Wt({className:Zo},Ye,{ref:kt,onMouseDown:vr,onKeyDown:Gn,onKeyUp:zt,onFocus:hn,onBlur:an}),W&&!de&&b.createElement("span",{style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0},"aria-live":"polite"},"".concat(d.map(function(U){var J=U.label,ie=U.value;return["number","string"].includes(pr(J))?J:ie}).join(", "))),B,zr,Hi&&Di),b.createElement(bk.Provider,{value:Ui},Y)}),Dk=function(){return null};Dk.isSelectOptGroup=!0;var Ik=function(){return null};Ik.isSelectOption=!0;var xk=b.forwardRef(function(t,e){var n=t.height,r=t.offsetY,i=t.offsetX,o=t.children,s=t.prefixCls,a=t.onInnerResize,l=t.innerProps,u=t.rtl,c=t.extra,d={},h={display:"flex",flexDirection:"column"};if(r!==void 0){var f;d={height:n,position:"relative",overflow:"hidden"},h=Oe(Oe({},h),{},(f={transform:"translateY(".concat(r,"px)")},at(f,u?"marginRight":"marginLeft",-i),at(f,"position","absolute"),at(f,"left",0),at(f,"right",0),at(f,"top",0),f))}return b.createElement("div",{style:d},b.createElement(uc,{onResize:function(m){var p=m.offsetHeight;p&&a&&a()}},b.createElement("div",Wt({style:h,className:Lt(at({},"".concat(s,"-holder-inner"),s)),ref:e},l),o,c)))});xk.displayName="Filler";function Hw(t,e){var n="touches"in t?t.touches[0]:t;return n[e?"pageX":"pageY"]}var Vw=b.forwardRef(function(t,e){var n,r=t.prefixCls,i=t.rtl,o=t.scrollOffset,s=t.scrollRange,a=t.onStartMove,l=t.onStopMove,u=t.onScroll,c=t.horizontal,d=t.spinSize,h=t.containerSize,f=t.style,m=t.thumbStyle,p=b.useState(!1),g=ze(p,2),v=g[0],_=g[1],C=b.useState(null),y=ze(C,2),S=y[0],E=y[1],w=b.useState(null),R=ze(w,2),D=R[0],I=R[1],k=!i,O=b.useRef(),$=b.useRef(),N=b.useState(!1),H=ze(N,2),X=H[0],te=H[1],z=b.useRef(),A=function(){clearTimeout(z.current),te(!0),z.current=setTimeout(function(){te(!1)},3e3)},T=s-h||0,P=h-d||0,K=T>0,ee=b.useMemo(function(){if(o===0||T===0)return 0;var Ne=o/T;return Ne*P},[o,T,P]),ue=function(Ne){Ne.stopPropagation(),Ne.preventDefault()},fe=b.useRef({top:ee,dragging:v,pageY:S,startTop:D});fe.current={top:ee,dragging:v,pageY:S,startTop:D};var Ee=function(Ne){_(!0),E(Hw(Ne,c)),I(fe.current.top),a(),Ne.stopPropagation(),Ne.preventDefault()};b.useEffect(function(){var Ne=function(mt){mt.preventDefault()},we=O.current,Me=$.current;return we.addEventListener("touchstart",Ne),Me.addEventListener("touchstart",Ee),function(){we.removeEventListener("touchstart",Ne),Me.removeEventListener("touchstart",Ee)}},[]);var Q=b.useRef();Q.current=T;var re=b.useRef();re.current=P,b.useEffect(function(){if(v){var Ne,we=function(mt){var vt=fe.current,ft=vt.dragging,et=vt.pageY,ve=vt.startTop;if(mr.cancel(Ne),ft){var Pe=Hw(mt,c)-et,Ye=ve;!k&&c?Ye-=Pe:Ye+=Pe;var bt=Q.current,Jt=re.current,Ht=Jt?Ye/Jt:0,Zt=Math.ceil(Ht*bt);Zt=Math.max(Zt,0),Zt=Math.min(Zt,bt),Ne=mr(function(){u(Zt,c)})}},Me=function(){_(!1),l()};return window.addEventListener("mousemove",we),window.addEventListener("touchmove",we),window.addEventListener("mouseup",Me),window.addEventListener("touchend",Me),function(){window.removeEventListener("mousemove",we),window.removeEventListener("touchmove",we),window.removeEventListener("mouseup",Me),window.removeEventListener("touchend",Me),mr.cancel(Ne)}}},[v]),b.useEffect(function(){A()},[o]),b.useImperativeHandle(e,function(){return{delayHidden:A}});var Se="".concat(r,"-scrollbar"),_e={position:"absolute",visibility:X&&K?null:"hidden"},He={position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"};return c?(_e.height=8,_e.left=0,_e.right=0,_e.bottom=0,He.height="100%",He.width=d,k?He.left=ee:He.right=ee):(_e.width=8,_e.top=0,_e.bottom=0,k?_e.right=0:_e.left=0,He.width="100%",He.height=d,He.top=ee),b.createElement("div",{ref:O,className:Lt(Se,(n={},at(n,"".concat(Se,"-horizontal"),c),at(n,"".concat(Se,"-vertical"),!c),at(n,"".concat(Se,"-visible"),X),n)),style:Oe(Oe({},_e),f),onMouseDown:ue,onMouseMove:A},b.createElement("div",{ref:$,className:Lt("".concat(Se,"-thumb"),at({},"".concat(Se,"-thumb-moving"),v)),style:Oe(Oe({},He),m),onMouseDown:Ee}))});function Bte(t){var e=t.children,n=t.setRef,r=b.useCallback(function(i){n(i)},[]);return b.cloneElement(e,{ref:r})}function Fte(t,e,n,r,i,o,s){var a=s.getKey;return t.slice(e,n+1).map(function(l,u){var c=e+u,d=o(l,c,{style:{width:r}}),h=a(l);return b.createElement(Bte,{key:h,setRef:function(f){return i(l,f)}},d)})}var Ute=function(){function t(){Vl(this,t),this.maps=void 0,this.id=0,this.maps=Object.create(null)}return jl(t,[{key:"set",value:function(e,n){this.maps[e]=n,this.id+=1}},{key:"get",value:function(e){return this.maps[e]}}]),t}();function Hte(t,e,n){var r=b.useState(0),i=ze(r,2),o=i[0],s=i[1],a=b.useRef(new Map),l=b.useRef(new Ute),u=b.useRef();function c(){mr.cancel(u.current)}function d(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;c();var m=function(){a.current.forEach(function(p,g){if(p&&p.offsetParent){var v=Kd(p),_=v.offsetHeight;l.current.get(g)!==_&&l.current.set(g,v.offsetHeight)}}),s(function(p){return p+1})};f?m():u.current=mr(m)}function h(f,m){var p=t(f),g=a.current.get(p);m?(a.current.set(p,m),d()):a.current.delete(p),!g!=!m&&(m?e==null||e(f):n==null||n(f))}return b.useEffect(function(){return c},[]),[h,d,l.current,o]}var Vte=10;function jte(t,e,n,r,i,o,s,a){var l=b.useRef(),u=b.useState(null),c=ze(u,2),d=c[0],h=c[1];return Lr(function(){if(d&&d.times<Vte){if(!t.current){h(function(A){return Oe({},A)});return}o();var f=d.targetAlign,m=d.originAlign,p=d.index,g=d.offset,v=t.current.clientHeight,_=!1,C=f,y=null;if(v){for(var S=f||m,E=0,w=0,R=0,D=Math.min(e.length-1,p),I=0;I<=D;I+=1){var k=i(e[I]);w=E;var O=n.get(k);R=w+(O===void 0?r:O),E=R}for(var $=S==="top"?g:v-g,N=D;N>=0;N-=1){var H=i(e[N]),X=n.get(H);if(X===void 0){_=!0;break}if($-=X,$<=0)break}switch(S){case"top":y=w-g;break;case"bottom":y=R-v+g;break;default:{var te=t.current.scrollTop,z=te+v;w<te?C="top":R>z&&(C="bottom")}}y!==null&&s(y),y!==d.lastTop&&(_=!0)}_&&h(Oe(Oe({},d),{},{times:d.times+1,targetAlign:C,lastTop:y}))}},[d,t.current]),function(f){if(f==null){a();return}if(mr.cancel(l.current),typeof f=="number")s(f);else if(f&&pr(f)==="object"){var m,p=f.align;"index"in f?m=f.index:m=e.findIndex(function(_){return i(_)===f.key});var g=f.offset,v=g===void 0?0:g;h({times:0,index:m,offset:v,originAlign:p})}}}function zte(t,e,n){var r=t.length,i=e.length,o,s;if(r===0&&i===0)return null;r<i?(o=t,s=e):(o=e,s=t);var a={__EMPTY_ITEM__:!0};function l(m){return m!==void 0?n(m):a}for(var u=null,c=Math.abs(r-i)!==1,d=0;d<s.length;d+=1){var h=l(o[d]),f=l(s[d]);if(h!==f){u=d,c=c||h!==l(s[d+1]);break}}return u===null?null:{index:u,multiple:c}}function Wte(t,e,n){var r=b.useState(t),i=ze(r,2),o=i[0],s=i[1],a=b.useState(null),l=ze(a,2),u=l[0],c=l[1];return b.useEffect(function(){var d=zte(o||[],t||[],e);(d==null?void 0:d.index)!==void 0&&(n==null||n(d.index),c(t[d.index])),s(t)},[t]),[u]}var jw=(typeof navigator>"u"?"undefined":pr(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const Mk=function(t,e){var n=b.useRef(!1),r=b.useRef(null);function i(){clearTimeout(r.current),n.current=!0,r.current=setTimeout(function(){n.current=!1},50)}var o=b.useRef({top:t,bottom:e});return o.current.top=t,o.current.bottom=e,function(s){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=s<0&&o.current.top||s>0&&o.current.bottom;return a&&l?(clearTimeout(r.current),n.current=!1):(!l||n.current)&&i(),!n.current&&l}};function Xte(t,e,n,r,i){var o=b.useRef(0),s=b.useRef(null),a=b.useRef(null),l=b.useRef(!1),u=Mk(e,n);function c(g,v){mr.cancel(s.current),o.current+=v,a.current=v,!u(v)&&(jw||g.preventDefault(),s.current=mr(function(){var _=l.current?10:1;i(o.current*_),o.current=0}))}function d(g,v){i(v,!0),jw||g.preventDefault()}var h=b.useRef(null),f=b.useRef(null);function m(g){if(t){mr.cancel(f.current),f.current=mr(function(){h.current=null},2);var v=g.deltaX,_=g.deltaY,C=g.shiftKey,y=v,S=_;(h.current==="sx"||!h.current&&C&&_&&!v)&&(y=_,S=0,h.current="sx");var E=Math.abs(y),w=Math.abs(S);h.current===null&&(h.current=r&&E>w?"x":"y"),h.current==="y"?c(g,S):d(g,y)}}function p(g){t&&(l.current=g.detail===a.current)}return[m,p]}var Yte=14/15;function Gte(t,e,n){var r=b.useRef(!1),i=b.useRef(0),o=b.useRef(null),s=b.useRef(null),a,l=function(d){if(r.current){var h=Math.ceil(d.touches[0].pageY),f=i.current-h;i.current=h,n(f)&&d.preventDefault(),clearInterval(s.current),s.current=setInterval(function(){f*=Yte,(!n(f,!0)||Math.abs(f)<=.1)&&clearInterval(s.current)},16)}},u=function(){r.current=!1,a()},c=function(d){a(),d.touches.length===1&&!r.current&&(r.current=!0,i.current=Math.ceil(d.touches[0].pageY),o.current=d.target,o.current.addEventListener("touchmove",l),o.current.addEventListener("touchend",u))};a=function(){o.current&&(o.current.removeEventListener("touchmove",l),o.current.removeEventListener("touchend",u))},Lr(function(){return t&&e.current.addEventListener("touchstart",c),function(){var d;(d=e.current)===null||d===void 0||d.removeEventListener("touchstart",c),a(),clearInterval(s.current)}},[t])}var Kte=20;function zw(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t/e*100;return isNaN(n)&&(n=0),n=Math.max(n,Kte),n=Math.min(n,t/2),Math.floor(n)}function Zte(t,e,n,r){var i=b.useMemo(function(){return[new Map,[]]},[t,n.id,r]),o=ze(i,2),s=o[0],a=o[1],l=function(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:u,d=s.get(u),h=s.get(c);if(d===void 0||h===void 0)for(var f=t.length,m=a.length;m<f;m+=1){var p,g=t[m],v=e(g);s.set(v,m);var _=(p=n.get(v))!==null&&p!==void 0?p:r;if(a[m]=(a[m-1]||0)+_,v===u&&(d=m),v===c&&(h=m),d!==void 0&&h!==void 0)break}return{top:a[d-1]||0,bottom:a[h]}};return l}var qte=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles"],Qte=[],Jte={overflowY:"auto",overflowAnchor:"none"};function ene(t,e){var n=t.prefixCls,r=n===void 0?"rc-virtual-list":n,i=t.className,o=t.height,s=t.itemHeight,a=t.fullHeight,l=a===void 0?!0:a,u=t.style,c=t.data,d=t.children,h=t.itemKey,f=t.virtual,m=t.direction,p=t.scrollWidth,g=t.component,v=g===void 0?"div":g,_=t.onScroll,C=t.onVirtualScroll,y=t.onVisibleChange,S=t.innerProps,E=t.extraRender,w=t.styles,R=Pn(t,qte),D=!!(f!==!1&&o&&s),I=D&&c&&(s*c.length>o||!!p),k=m==="rtl",O=Lt(r,at({},"".concat(r,"-rtl"),k),i),$=c||Qte,N=b.useRef(),H=b.useRef(),X=b.useState(0),te=ze(X,2),z=te[0],A=te[1],T=b.useState(0),P=ze(T,2),K=P[0],ee=P[1],ue=b.useState(!1),fe=ze(ue,2),Ee=fe[0],Q=fe[1],re=function(){Q(!0)},Se=function(){Q(!1)},_e=b.useCallback(function(Ke){return typeof h=="function"?h(Ke):Ke==null?void 0:Ke[h]},[h]),He={getKey:_e};function Ne(Ke){A(function($e){var hn;typeof Ke=="function"?hn=Ke($e):hn=Ke;var an=Re(hn);return N.current.scrollTop=an,an})}var we=b.useRef({start:0,end:$.length}),Me=b.useRef(),mt=Wte($,_e),vt=ze(mt,1),ft=vt[0];Me.current=ft;var et=Hte(_e,null,null),ve=ze(et,4),Pe=ve[0],Ye=ve[1],bt=ve[2],Jt=ve[3],Ht=b.useMemo(function(){if(!D)return{scrollHeight:void 0,start:0,end:$.length-1,offset:void 0};if(!I){var Ke;return{scrollHeight:((Ke=H.current)===null||Ke===void 0?void 0:Ke.offsetHeight)||0,start:0,end:$.length-1,offset:void 0}}for(var $e=0,hn,an,Qn,vr=$.length,mi=0;mi<vr;mi+=1){var wo=$[mi],Fi=_e(wo),pi=bt.get(Fi),Qr=$e+(pi===void 0?s:pi);Qr>=z&&hn===void 0&&(hn=mi,an=$e),Qr>z+o&&Qn===void 0&&(Qn=mi),$e=Qr}return hn===void 0&&(hn=0,an=0,Qn=Math.ceil(o/s)),Qn===void 0&&(Qn=$.length-1),Qn=Math.min(Qn+1,$.length-1),{scrollHeight:$e,start:hn,end:Qn,offset:an}},[I,D,z,$,Jt,o]),Zt=Ht.scrollHeight,kt=Ht.start,gn=Ht.end,vn=Ht.offset;we.current.start=kt,we.current.end=gn;var Xt=b.useState({width:0,height:o}),Vt=ze(Xt,2),jt=Vt[0],Nt=Vt[1],Bn=function(Ke){Nt({width:Ke.width||Ke.offsetWidth,height:Ke.height||Ke.offsetHeight})},W=b.useRef(),j=b.useRef(),q=b.useMemo(function(){return zw(jt.width,p)},[jt.width,p]),pe=b.useMemo(function(){return zw(jt.height,Zt)},[jt.height,Zt]),Ae=Zt-o,We=b.useRef(Ae);We.current=Ae;function Re(Ke){var $e=Ke;return Number.isNaN(We.current)||($e=Math.min($e,We.current)),$e=Math.max($e,0),$e}var Te=z<=0,G=z>=Ae,be=Mk(Te,G),xe=function(){return{x:k?-K:K,y:z}},ye=b.useRef(xe()),st=ns(function(){if(C){var Ke=xe();(ye.current.x!==Ke.x||ye.current.y!==Ke.y)&&(C(Ke),ye.current=Ke)}});function Ge(Ke,$e){var hn=Ke;$e?(Xu.flushSync(function(){ee(hn)}),st()):Ne(hn)}function lt(Ke){var $e=Ke.currentTarget.scrollTop;$e!==z&&Ne($e),_==null||_(Ke),st()}var de=function(Ke){var $e=Ke,hn=p-jt.width;return $e=Math.max($e,0),$e=Math.min($e,hn),$e},Le=ns(function(Ke,$e){$e?(Xu.flushSync(function(){ee(function(hn){var an=hn+(k?-Ke:Ke);return de(an)})}),st()):Ne(function(hn){var an=hn+Ke;return an})}),Ve=Xte(D,Te,G,!!p,Le),Ze=ze(Ve,2),Dt=Ze[0],Mt=Ze[1];Gte(D,N,function(Ke,$e){return be(Ke,$e)?!1:(Dt({preventDefault:function(){},deltaY:Ke}),!0)}),Lr(function(){function Ke(hn){D&&hn.preventDefault()}var $e=N.current;return $e.addEventListener("wheel",Dt),$e.addEventListener("DOMMouseScroll",Mt),$e.addEventListener("MozMousePixelScroll",Ke),function(){$e.removeEventListener("wheel",Dt),$e.removeEventListener("DOMMouseScroll",Mt),$e.removeEventListener("MozMousePixelScroll",Ke)}},[D]),Lr(function(){p&&ee(function(Ke){return de(Ke)})},[jt.width,p]);var pn=function(){var Ke,$e;(Ke=W.current)===null||Ke===void 0||Ke.delayHidden(),($e=j.current)===null||$e===void 0||$e.delayHidden()},Yn=jte(N,$,bt,s,_e,function(){return Ye(!0)},Ne,pn);b.useImperativeHandle(e,function(){return{getScrollInfo:xe,scrollTo:function(Ke){function $e(hn){return hn&&pr(hn)==="object"&&("left"in hn||"top"in hn)}$e(Ke)?(Ke.left!==void 0&&ee(de(Ke.left)),Yn(Ke.top)):Yn(Ke)}}}),Lr(function(){if(y){var Ke=$.slice(kt,gn+1);y(Ke,$)}},[kt,gn,$]);var Hn=Zte($,_e,bt,s),ht=E==null?void 0:E({start:kt,end:gn,virtual:I,offsetX:K,offsetY:vn,rtl:k,getSize:Hn}),Dn=Fte($,kt,gn,p,Pe,d,He),Gn=null;o&&(Gn=Oe(at({},l?"height":"maxHeight",o),Jte),D&&(Gn.overflowY="hidden",p&&(Gn.overflowX="hidden"),Ee&&(Gn.pointerEvents="none")));var zt={};return k&&(zt.dir="rtl"),b.createElement("div",Wt({style:Oe(Oe({},u),{},{position:"relative"}),className:O},zt,R),b.createElement(uc,{onResize:Bn},b.createElement(v,{className:"".concat(r,"-holder"),style:Gn,ref:N,onScroll:lt,onMouseEnter:pn},b.createElement(xk,{prefixCls:r,height:Zt,offsetX:K,offsetY:vn,scrollWidth:p,onInnerResize:Ye,ref:H,innerProps:S,rtl:k,extra:ht},Dn))),I&&Zt>o&&b.createElement(Vw,{ref:W,prefixCls:r,scrollOffset:z,scrollRange:Zt,rtl:k,onScroll:Ge,onStartMove:re,onStopMove:Se,spinSize:pe,containerSize:jt.height,style:w==null?void 0:w.verticalScrollBar,thumbStyle:w==null?void 0:w.verticalScrollBarThumb}),I&&p&&b.createElement(Vw,{ref:j,prefixCls:r,scrollOffset:K,scrollRange:p,rtl:k,onScroll:Ge,onStartMove:re,onStopMove:Se,spinSize:q,containerSize:jt.width,horizontal:!0,style:w==null?void 0:w.horizontalScrollBar,thumbStyle:w==null?void 0:w.horizontalScrollBarThumb}))}var Ok=b.forwardRef(ene);Ok.displayName="List";var Tk=b.createContext(null);function tne(){return/(mac\sos|macintosh)/i.test(navigator.appVersion)}var nne=["disabled","title","children","style","className"];function Ww(t){return typeof t=="string"||typeof t=="number"}var rne=function(t,e){var n=pte(),r=n.prefixCls,i=n.id,o=n.open,s=n.multiple,a=n.mode,l=n.searchValue,u=n.toggleOpen,c=n.notFoundContent,d=n.onPopupScroll,h=b.useContext(Tk),f=h.flattenOptions,m=h.onActiveValue,p=h.defaultActiveFirstOption,g=h.onSelect,v=h.menuItemSelectedIcon,_=h.rawValues,C=h.fieldNames,y=h.virtual,S=h.direction,E=h.listHeight,w=h.listItemHeight,R=h.optionRender,D="".concat(r,"-item"),I=uC(function(){return f},[o,f],function(Q,re){return re[0]&&Q[1]!==re[1]}),k=b.useRef(null),O=function(Q){Q.preventDefault()},$=function(Q){k.current&&k.current.scrollTo(typeof Q=="number"?{index:Q}:Q)},N=function(Q){for(var re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Se=I.length,_e=0;_e<Se;_e+=1){var He=(Q+_e*re+Se)%Se,Ne=I[He],we=Ne.group,Me=Ne.data;if(!we&&!Me.disabled)return He}return-1},H=b.useState(function(){return N(0)}),X=ze(H,2),te=X[0],z=X[1],A=function(Q){var re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;z(Q);var Se={source:re?"keyboard":"mouse"},_e=I[Q];if(!_e){m(null,-1,Se);return}m(_e.value,Q,Se)};b.useEffect(function(){A(p!==!1?N(0):-1)},[I.length,l]);var T=b.useCallback(function(Q){return _.has(Q)&&a!=="combobox"},[a,Mr(_).toString(),_.size]);b.useEffect(function(){var Q=setTimeout(function(){if(!s&&o&&_.size===1){var Se=Array.from(_)[0],_e=I.findIndex(function(He){var Ne=He.data;return Ne.value===Se});_e!==-1&&(A(_e),$(_e))}});if(o){var re;(re=k.current)===null||re===void 0||re.scrollTo(void 0)}return function(){return clearTimeout(Q)}},[o,l]);var P=function(Q){Q!==void 0&&g(Q,{selected:!_.has(Q)}),s||u(!1)};if(b.useImperativeHandle(e,function(){return{onKeyDown:function(Q){var re=Q.which,Se=Q.ctrlKey;switch(re){case ot.N:case ot.P:case ot.UP:case ot.DOWN:{var _e=0;if(re===ot.UP?_e=-1:re===ot.DOWN?_e=1:tne()&&Se&&(re===ot.N?_e=1:re===ot.P&&(_e=-1)),_e!==0){var He=N(te+_e,_e);$(He),A(He,!0)}break}case ot.ENTER:{var Ne=I[te];Ne&&!Ne.data.disabled?P(Ne.value):P(void 0),o&&Q.preventDefault();break}case ot.ESC:u(!1),o&&Q.stopPropagation()}},onKeyUp:function(){},scrollTo:function(Q){$(Q)}}}),I.length===0)return b.createElement("div",{role:"listbox",id:"".concat(i,"_list"),className:"".concat(D,"-empty"),onMouseDown:O},c);var K=Object.keys(C).map(function(Q){return C[Q]}),ee=function(Q){return Q.label};function ue(Q,re){var Se=Q.group;return{role:Se?"presentation":"option",id:"".concat(i,"_list_").concat(re)}}var fe=function(Q){var re=I[Q];if(!re)return null;var Se=re.data||{},_e=Se.value,He=re.group,Ne=x6(Se,!0),we=ee(re);return re?b.createElement("div",Wt({"aria-label":typeof we=="string"&&!He?we:null},Ne,{key:Q},ue(re,Q),{"aria-selected":T(_e)}),_e):null},Ee={role:"listbox",id:"".concat(i,"_list")};return b.createElement(b.Fragment,null,y&&b.createElement("div",Wt({},Ee,{style:{height:0,width:0,overflow:"hidden"}}),fe(te-1),fe(te),fe(te+1)),b.createElement(Ok,{itemKey:"key",ref:k,data:I,height:E,itemHeight:w,fullHeight:!1,onMouseDown:O,onScroll:d,virtual:y,direction:S,innerProps:y?null:Ee},function(Q,re){var Se,_e=Q.group,He=Q.groupOption,Ne=Q.data,we=Q.label,Me=Q.value,mt=Ne.key;if(_e){var vt,ft=(vt=Ne.title)!==null&&vt!==void 0?vt:Ww(we)?we.toString():void 0;return b.createElement("div",{className:Lt(D,"".concat(D,"-group")),title:ft},we!==void 0?we:mt)}var et=Ne.disabled,ve=Ne.title;Ne.children;var Pe=Ne.style,Ye=Ne.className,bt=Pn(Ne,nne),Jt=w9(bt,K),Ht=T(Me),Zt="".concat(D,"-option"),kt=Lt(D,Zt,Ye,(Se={},at(Se,"".concat(Zt,"-grouped"),He),at(Se,"".concat(Zt,"-active"),te===re&&!et),at(Se,"".concat(Zt,"-disabled"),et),at(Se,"".concat(Zt,"-selected"),Ht),Se)),gn=ee(Q),vn=!v||typeof v=="function"||Ht,Xt=typeof gn=="number"?gn:gn||Me,Vt=Ww(Xt)?Xt.toString():void 0;return ve!==void 0&&(Vt=ve),b.createElement("div",Wt({},x6(Jt),y?{}:ue(Q,re),{"aria-selected":Ht,className:kt,title:Vt,onMouseMove:function(){te===re||et||A(re)},onClick:function(){et||P(Me)},style:Pe}),b.createElement("div",{className:"".concat(Zt,"-content")},typeof R=="function"?R(Q,{index:re}):Xt),b.isValidElement(v)||Ht,vn&&b.createElement($9,{className:"".concat(D,"-option-state"),customizeIcon:v,customizeIconProps:{value:Me,disabled:et,isSelected:Ht}},Ht?"":null))}))},$k=b.forwardRef(rne);$k.displayName="OptionList";const ine=function(t,e){var n=b.useRef({values:new Map,options:new Map}),r=b.useMemo(function(){var o=n.current,s=o.values,a=o.options,l=t.map(function(d){if(d.label===void 0){var h;return Oe(Oe({},d),{},{label:(h=s.get(d.value))===null||h===void 0?void 0:h.label})}return d}),u=new Map,c=new Map;return l.forEach(function(d){u.set(d.value,d),c.set(d.value,e.get(d.value)||a.get(d.value))}),n.current.values=u,n.current.options=c,l},[t,e]),i=b.useCallback(function(o){return e.get(o)||n.current.options.get(o)},[e]);return[r,i]};function Nm(t,e){return yk(t).join("").toUpperCase().includes(e)}const one=function(t,e,n,r,i){return b.useMemo(function(){if(!n||r===!1)return t;var o=e.options,s=e.label,a=e.value,l=[],u=typeof r=="function",c=n.toUpperCase(),d=u?r:function(f,m){return i?Nm(m[i],c):m[o]?Nm(m[s!=="children"?s:"label"],c):Nm(m[a],c)},h=u?function(f){return bv(f)}:function(f){return f};return t.forEach(function(f){if(f[o]){var m=d(n,h(f));if(m)l.push(f);else{var p=f[o].filter(function(g){return d(n,h(g))});p.length&&l.push(Oe(Oe({},f),{},at({},o,p)))}return}d(n,h(f))&&l.push(f)}),l},[t,r,i,n,e])};var Xw=0,sne=Ma();function ane(){var t;return sne?(t=Xw,Xw+=1):t="TEST_OR_SSR",t}function lne(t){var e=b.useState(),n=ze(e,2),r=n[0],i=n[1];return b.useEffect(function(){i("rc_select_".concat(ane()))},[]),t||r}var une=["children","value"],cne=["children"];function dne(t){var e=t,n=e.key,r=e.props,i=r.children,o=r.value,s=Pn(r,une);return Oe({key:n,value:o!==void 0?o:n,children:i},s)}function kk(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return M6(t).map(function(n,r){if(!b.isValidElement(n)||!n.type)return null;var i=n,o=i.type.isSelectOptGroup,s=i.key,a=i.props,l=a.children,u=Pn(a,cne);return e||!o?dne(n):Oe(Oe({key:"__RC_SELECT_GRP__".concat(s===null?r:s,"__"),label:s},u),{},{options:kk(l)})}).filter(function(n){return n})}function hne(t,e,n,r,i){return b.useMemo(function(){var o=t,s=!t;s&&(o=kk(e));var a=new Map,l=new Map,u=function(d,h,f){f&&typeof f=="string"&&d.set(h[f],h)};function c(d){for(var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,f=0;f<d.length;f+=1){var m=d[f];!m[n.options]||h?(a.set(m[n.value],m),u(l,m,n.label),u(l,m,r),u(l,m,i)):c(m[n.options],!0)}}return c(o),{options:o,valueOptions:a,labelOptions:l}},[t,e,n,r,i])}function Yw(t){var e=b.useRef();e.current=t;var n=b.useCallback(function(){return e.current.apply(e,arguments)},[]);return n}var fne=["id","mode","prefixCls","backfill","fieldNames","inputValue","searchValue","onSearch","autoClearSearchValue","onSelect","onDeselect","dropdownMatchSelectWidth","filterOption","filterSort","optionFilterProp","optionLabelProp","options","optionRender","children","defaultActiveFirstOption","menuItemSelectedIcon","virtual","direction","listHeight","listItemHeight","value","defaultValue","labelInValue","onChange"],mne=["inputValue"];function pne(t){return!t||pr(t)!=="object"}var gne=b.forwardRef(function(t,e){var n=t.id,r=t.mode,i=t.prefixCls,o=i===void 0?"rc-select":i,s=t.backfill,a=t.fieldNames,l=t.inputValue,u=t.searchValue,c=t.onSearch,d=t.autoClearSearchValue,h=d===void 0?!0:d,f=t.onSelect,m=t.onDeselect,p=t.dropdownMatchSelectWidth,g=p===void 0?!0:p,v=t.filterOption,_=t.filterSort,C=t.optionFilterProp,y=t.optionLabelProp,S=t.options,E=t.optionRender,w=t.children,R=t.defaultActiveFirstOption,D=t.menuItemSelectedIcon,I=t.virtual,k=t.direction,O=t.listHeight,$=O===void 0?200:O,N=t.listItemHeight,H=N===void 0?20:N,X=t.value,te=t.defaultValue,z=t.labelInValue,A=t.onChange,T=Pn(t,fne),P=lne(n),K=Cv(r),ee=!!(!S&&w),ue=b.useMemo(function(){return v===void 0&&r==="combobox"?!1:v},[v,r]),fe=b.useMemo(function(){return Rk(a,ee)},[JSON.stringify(a),ee]),Ee=bl("",{value:u!==void 0?u:l,postState:function(de){return de||""}}),Q=ze(Ee,2),re=Q[0],Se=Q[1],_e=hne(S,w,fe,C,y),He=_e.valueOptions,Ne=_e.labelOptions,we=_e.options,Me=b.useCallback(function(de){var Le=yk(de);return Le.map(function(Ve){var Ze,Dt,Mt,pn,Yn;if(pne(Ve))Ze=Ve;else{var Hn;Mt=Ve.key,Dt=Ve.label,Ze=(Hn=Ve.value)!==null&&Hn!==void 0?Hn:Mt}var ht=He.get(Ze);if(ht){var Dn;Dt===void 0&&(Dt=ht==null?void 0:ht[y||fe.label]),Mt===void 0&&(Mt=(Dn=ht==null?void 0:ht.key)!==null&&Dn!==void 0?Dn:Ze),pn=ht==null?void 0:ht.disabled,Yn=ht==null?void 0:ht.title}return{label:Dt,value:Ze,key:Mt,disabled:pn,title:Yn}})},[fe,y,He]),mt=bl(te,{value:X}),vt=ze(mt,2),ft=vt[0],et=vt[1],ve=b.useMemo(function(){var de,Le=Me(ft);return r==="combobox"&&Ste((de=Le[0])===null||de===void 0?void 0:de.value)?[]:Le},[ft,Me,r]),Pe=ine(ve,He),Ye=ze(Pe,2),bt=Ye[0],Jt=Ye[1],Ht=b.useMemo(function(){if(!r&&bt.length===1){var de=bt[0];if(de.value===null&&(de.label===null||de.label===void 0))return[]}return bt.map(function(Le){var Ve;return Oe(Oe({},Le),{},{label:(Ve=Le.label)!==null&&Ve!==void 0?Ve:Le.value})})},[r,bt]),Zt=b.useMemo(function(){return new Set(bt.map(function(de){return de.value}))},[bt]);b.useEffect(function(){if(r==="combobox"){var de,Le=(de=bt[0])===null||de===void 0?void 0:de.value;Se(yte(Le)?String(Le):"")}},[bt]);var kt=Yw(function(de,Le){var Ve,Ze=Le??de;return Ve={},at(Ve,fe.value,de),at(Ve,fe.label,Ze),Ve}),gn=b.useMemo(function(){if(r!=="tags")return we;var de=Mr(we),Le=function(Ve){return He.has(Ve)};return Mr(bt).sort(function(Ve,Ze){return Ve.value<Ze.value?-1:1}).forEach(function(Ve){var Ze=Ve.value;Le(Ze)||de.push(kt(Ze,Ve.label))}),de},[kt,we,He,bt,r]),vn=one(gn,fe,re,ue,C),Xt=b.useMemo(function(){return r!=="tags"||!re||vn.some(function(de){return de[C||"value"]===re})||vn.some(function(de){return de[fe.value]===re})?vn:[kt(re)].concat(Mr(vn))},[kt,C,r,vn,re,fe]),Vt=b.useMemo(function(){return _?Mr(Xt).sort(function(de,Le){return _(de,Le)}):Xt},[Xt,_]),jt=b.useMemo(function(){return kte(Vt,{fieldNames:fe,childrenAsData:ee})},[Vt,fe,ee]),Nt=function(de){var Le=Me(de);if(et(Le),A&&(Le.length!==bt.length||Le.some(function(Dt,Mt){var pn;return((pn=bt[Mt])===null||pn===void 0?void 0:pn.value)!==(Dt==null?void 0:Dt.value)}))){var Ve=z?Le:Le.map(function(Dt){return Dt.value}),Ze=Le.map(function(Dt){return bv(Jt(Dt.value))});A(K?Ve:Ve[0],K?Ze:Ze[0])}},Bn=b.useState(null),W=ze(Bn,2),j=W[0],q=W[1],pe=b.useState(0),Ae=ze(pe,2),We=Ae[0],Re=Ae[1],Te=R!==void 0?R:r!=="combobox",G=b.useCallback(function(de,Le){var Ve=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Ze=Ve.source,Dt=Ze===void 0?"keyboard":Ze;Re(Le),s&&r==="combobox"&&de!==null&&Dt==="keyboard"&&q(String(de))},[s,r]),be=function(de,Le,Ve){var Ze=function(){var zt,Ke=Jt(de);return[z?{label:Ke==null?void 0:Ke[fe.label],value:de,key:(zt=Ke==null?void 0:Ke.key)!==null&&zt!==void 0?zt:de}:de,bv(Ke)]};if(Le&&f){var Dt=Ze(),Mt=ze(Dt,2),pn=Mt[0],Yn=Mt[1];f(pn,Yn)}else if(!Le&&m&&Ve!=="clear"){var Hn=Ze(),ht=ze(Hn,2),Dn=ht[0],Gn=ht[1];m(Dn,Gn)}},xe=Yw(function(de,Le){var Ve,Ze=K?Le.selected:!0;Ze?Ve=K?[].concat(Mr(bt),[de]):[de]:Ve=bt.filter(function(Dt){return Dt.value!==de}),Nt(Ve),be(de,Ze),r==="combobox"?q(""):(!Cv||h)&&(Se(""),q(""))}),ye=function(de,Le){Nt(de);var Ve=Le.type,Ze=Le.values;(Ve==="remove"||Ve==="clear")&&Ze.forEach(function(Dt){be(Dt.value,!1,Ve)})},st=function(de,Le){if(Se(de),q(null),Le.source==="submit"){var Ve=(de||"").trim();if(Ve){var Ze=Array.from(new Set([].concat(Mr(Zt),[Ve])));Nt(Ze),be(Ve,!0),Se("")}return}Le.source!=="blur"&&(r==="combobox"&&Nt(de),c==null||c(de))},Ge=function(de){var Le=de;r!=="tags"&&(Le=de.map(function(Ze){var Dt=Ne.get(Ze);return Dt==null?void 0:Dt.value}).filter(function(Ze){return Ze!==void 0}));var Ve=Array.from(new Set([].concat(Mr(Zt),Mr(Le))));Nt(Ve),Ve.forEach(function(Ze){be(Ze,!0)})},lt=b.useMemo(function(){var de=I!==!1&&g!==!1;return Oe(Oe({},_e),{},{flattenOptions:jt,onActiveValue:G,defaultActiveFirstOption:Te,onSelect:xe,menuItemSelectedIcon:D,rawValues:Zt,fieldNames:fe,virtual:de,direction:k,listHeight:$,listItemHeight:H,childrenAsData:ee,optionRender:E})},[_e,jt,G,Te,xe,D,Zt,fe,I,g,$,H,ee,E]);return b.createElement(Tk.Provider,{value:lt},b.createElement(Pte,Wt({},T,{id:P,prefixCls:o,ref:e,omitDomProps:mne,mode:r,displayValues:Ht,onDisplayValuesChange:ye,direction:k,searchValue:re,onSearch:st,autoClearSearchValue:h,onSearchSplit:Ge,dropdownMatchSelectWidth:g,OptionList:$k,emptyOptions:!jt.length,activeValue:j,activeDescendantId:"".concat(P,"_list_").concat(We)})))}),$C=gne;$C.Option=Ik;$C.OptGroup=Dk;const vne="univer-select",_ne="univer-select-disabled",bne="univer-select-selector",Cne="univer-select-show-arrow",yne="univer-select-loading",Sne="univer-select-arrow-icon",Ene="univer-select-loading-icon",wne="univer-select-selection-placeholder",Rne="univer-select-selection-search-input",Dne="univer-select-single",Ine="univer-select-selection-search",xne="univer-select-selection-item",Mne="univer-select-customize-input",One="univer-select-multiple",Tne="univer-select-selection-item-disabled",$ne="univer-select-selection-overflow",kne="univer-select-selection-overflow-item",Ane="univer-select-selection-search-mirror",Nne="univer-select-allow-clear",Lne="univer-select-clear",Pne="univer-select-arrow",Bne="univer-select-focused",Fne="univer-select-dropdown",Une="univer-select-dropdown-hidden",Hne="univer-select-item",Vne="univer-select-item-group",jne="univer-select-item-option",zne="univer-select-item-option-state",Wne="univer-select-item-option-active",Xne="univer-select-item-option-disabled",Yne="univer-select-item-empty",Gne="univer-select-selection__choice-zoom",Kne="univer-select-selection__choice-zoom-appear",Zne="univer-select-selection__choice-zoom-appear-active",qne="univer-select-selection__choice-zoom-leave",Qne="univer-select-selection__choice-zoom-leave-active",Jne="univer-select-dropdown-slide-up-enter",ere="univer-select-dropdown-slide-up-appear",tre="univer-select-dropdown-slide-up-leave",nre="univer-select-dropdown-slide-up-enter-active",rre="univer-select-dropdown-placement-bottomLeft",ire="univer-select-dropdown-slide-up-appear-active",ore="univer-select-dropdown-placement-bottomRight",sre="univer-select-dropdown-slide-up-in",are="univer-select-dropdown-slide-up-leave-active",lre="univer-select-dropdown-slide-up-out",ure="univer-select-dropdown-placement-topLeft",cre="univer-select-dropdown-placement-topRight",dre="univer-select-dropdown-slide-down-in",hre="univer-select-dropdown-slide-down-out",fre={select:vne,selectDisabled:_ne,selectSelector:bne,selectShowArrow:Cne,selectLoading:yne,selectArrowIcon:Sne,selectLoadingIcon:Ene,selectSelectionPlaceholder:wne,selectSelectionSearchInput:Rne,selectSingle:Dne,selectSelectionSearch:Ine,selectSelectionItem:xne,selectCustomizeInput:Mne,selectMultiple:One,selectSelectionItemDisabled:Tne,selectSelectionOverflow:$ne,selectSelectionOverflowItem:kne,selectSelectionSearchMirror:Ane,selectAllowClear:Nne,selectClear:Lne,selectArrow:Pne,selectFocused:Bne,selectDropdown:Fne,selectDropdownHidden:Une,selectItem:Hne,selectItemGroup:Vne,selectItemOption:jne,selectItemOptionState:zne,selectItemOptionActive:Wne,selectItemOptionDisabled:Xne,selectItemEmpty:Yne,selectSelectionChoiceZoom:Gne,selectSelectionChoiceZoomAppear:Kne,selectSelectionChoiceZoomAppearActive:Zne,selectSelectionChoiceZoomLeave:qne,selectSelectionChoiceZoomLeaveActive:Qne,selectDropdownSlideUpEnter:Jne,selectDropdownSlideUpAppear:ere,selectDropdownSlideUpLeave:tre,selectDropdownSlideUpEnterActive:nre,selectDropdownPlacementBottomLeft:rre,selectDropdownSlideUpAppearActive:ire,selectDropdownPlacementBottomRight:ore,selectDropdownSlideUpIn:sre,selectDropdownSlideUpLeaveActive:are,selectDropdownSlideUpOut:lre,selectDropdownPlacementTopLeft:ure,selectDropdownPlacementTopRight:cre,selectDropdownSlideDownIn:dre,selectDropdownSlideDownOut:hre};function k9(t){const{value:e,options:n=[],onChange:r}=t,{mountContainer:i}=b.useContext(R1);return $t.jsx($C,{prefixCls:fre.select,getPopupContainer:()=>i,options:n,value:e,menuItemSelectedIcon:null,suffixIcon:$t.jsx(uY,{}),onChange:r})}const mre="univer-select-list",pre="univer-select-list-item",gre="univer-select-list-item-icon",vre="univer-select-list-item-select",$7={selectList:mre,selectListItem:pre,selectListItemIcon:gre,selectListItemSelect:vre};function kC(t){const{value:e,options:n=[],hideCheckMark:r=!1,onChange:i}=t;function o(s){i(s)}return $t.jsx("ul",{className:$7.selectList,children:n.map((s,a)=>$t.jsx("li",{className:wi($7.selectListItem,{[$7.selectListItemSelect]:e===s.value}),children:$t.jsxs("a",{onClick:()=>o(s.value),children:[!r&&$t.jsx("span",{className:$7.selectListItemIcon,children:e===s.value&&$t.jsx(JX,{})}),$t.jsx("span",{style:{color:s.color},children:s.label})]})},a))})}function _re(t){var e=t.children,n=t.prefixCls,r=t.id,i=t.overlayInnerStyle,o=t.className,s=t.style;return b.createElement("div",{className:Lt("".concat(n,"-content"),o),style:s},b.createElement("div",{className:"".concat(n,"-inner"),id:r,role:"tooltip",style:i},typeof e=="function"?e():e))}var Oc={shiftX:64,adjustY:1},Tc={adjustX:1,shiftY:!0},qo=[0,0],bre={left:{points:["cr","cl"],overflow:Tc,offset:[-4,0],targetOffset:qo},right:{points:["cl","cr"],overflow:Tc,offset:[4,0],targetOffset:qo},top:{points:["bc","tc"],overflow:Oc,offset:[0,-4],targetOffset:qo},bottom:{points:["tc","bc"],overflow:Oc,offset:[0,4],targetOffset:qo},topLeft:{points:["bl","tl"],overflow:Oc,offset:[0,-4],targetOffset:qo},leftTop:{points:["tr","tl"],overflow:Tc,offset:[-4,0],targetOffset:qo},topRight:{points:["br","tr"],overflow:Oc,offset:[0,-4],targetOffset:qo},rightTop:{points:["tl","tr"],overflow:Tc,offset:[4,0],targetOffset:qo},bottomRight:{points:["tr","br"],overflow:Oc,offset:[0,4],targetOffset:qo},rightBottom:{points:["bl","br"],overflow:Tc,offset:[4,0],targetOffset:qo},bottomLeft:{points:["tl","bl"],overflow:Oc,offset:[0,4],targetOffset:qo},leftBottom:{points:["br","bl"],overflow:Tc,offset:[-4,0],targetOffset:qo}},Cre=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow"],yre=function(t,e){var n=t.overlayClassName,r=t.trigger,i=r===void 0?["hover"]:r,o=t.mouseEnterDelay,s=o===void 0?0:o,a=t.mouseLeaveDelay,l=a===void 0?.1:a,u=t.overlayStyle,c=t.prefixCls,d=c===void 0?"rc-tooltip":c,h=t.children,f=t.onVisibleChange,m=t.afterVisibleChange,p=t.transitionName,g=t.animation,v=t.motion,_=t.placement,C=_===void 0?"right":_,y=t.align,S=y===void 0?{}:y,E=t.destroyTooltipOnHide,w=E===void 0?!1:E,R=t.defaultVisible,D=t.getTooltipContainer,I=t.overlayInnerStyle;t.arrowContent;var k=t.overlay,O=t.id,$=t.showArrow,N=$===void 0?!0:$,H=Pn(t,Cre),X=b.useRef(null);b.useImperativeHandle(e,function(){return X.current});var te=Oe({},H);"visible"in t&&(te.popupVisible=t.visible);var z=function(){return b.createElement(_re,{key:"content",prefixCls:d,id:O,overlayInnerStyle:I},k)};return b.createElement(E9,Wt({popupClassName:n,prefixCls:d,popup:z,action:i,builtinPlacements:bre,popupPlacement:C,ref:X,popupAlign:S,getPopupContainer:D,onPopupVisibleChange:f,afterPopupVisibleChange:m,popupTransitionName:p,popupAnimation:g,popupMotion:v,defaultPopupVisible:R,autoDestroy:w,mouseLeaveDelay:l,popupStyle:u,mouseEnterDelay:s,arrow:N},te),h)};const Sre=b.forwardRef(yre),Ere="univer-tooltip",wre="univer-tooltip-hidden",Rre="univer-tooltip-placement-top",Dre="univer-tooltip-placement-right",Ire="univer-tooltip-placement-bottom",xre="univer-tooltip-placement-left",Mre="univer-tooltip-arrow",Ore="univer-tooltip-placement-topLeft",Tre="univer-tooltip-placement-topRight",$re="univer-tooltip-inner",Gw={tooltip:Ere,tooltipHidden:wre,tooltipPlacementTop:Rre,tooltipPlacementRight:Dre,tooltipPlacementBottom:Ire,tooltipPlacementLeft:xre,tooltipArrow:Mre,tooltipPlacementTopLeft:Ore,tooltipPlacementTopRight:Tre,tooltipInner:$re},Kw={shiftX:0,adjustY:1},Zw={adjustX:1,shiftY:!0},k7=[0,0],kre={left:{points:["cr","cl"],overflow:Zw,offset:[-4,0],targetOffset:k7},right:{points:["cl","cr"],overflow:Zw,offset:[4,0],targetOffset:k7},top:{points:["bc","tc"],overflow:Kw,offset:[0,-4],targetOffset:k7},bottom:{points:["tc","bc"],overflow:Kw,offset:[0,4],targetOffset:k7}},p4=b.forwardRef((t,e)=>{const{children:n,placement:r="top",title:i}=t,{mountContainer:o}=b.useContext(R1);return $t.jsx(Sre,{ref:e,prefixCls:Gw.tooltip,getTooltipContainer:()=>o,overlay:$t.jsx("div",{className:Gw.tooltipContent,children:typeof i=="function"?i():i}),builtinPlacements:kre,placement:r,mouseEnterDelay:.2,showArrow:!0,destroyTooltipOnHide:!0,children:n})}),Are="116",Nre="12",Lre="univer-slider",Pre="univer-slider-rail",Bre="univer-slider-inner-rail",Fre="univer-slider-handle",Ure="univer-slider-reset-point",Hre="univer-slider-value",Vre="univer-dropdown-open",jre="univer-slider-shortcuts",zre="univer-slider-shortcut",Wre="univer-slider-shortcut-icon",Xre="univer-slider-shortcut-active",Do={sliderWidth:Are,sliderHandleSize:Nre,slider:Lre,sliderRail:Pre,sliderInnerRail:Bre,sliderHandle:Fre,sliderResetPoint:Ure,sliderValue:Hre,dropdownOpen:Vre,sliderShortcuts:jre,sliderShortcut:zre,sliderShortcutIcon:Wre,sliderShortcutActive:Xre};function Yre(t){const{value:e,min:n=0,max:r=400,resetPoint:i=100,shortcuts:o,onChange:s}=t,a=b.useRef(null),{locale:l}=b.useContext(R1);function u(){s&&s(i)}function c(f){let m=e+f;e+f<=n?m=n:e+f>=r&&(m=r),s&&s(m)}const d=b.useMemo(()=>{if(e<=i){const f=50/(i-n);return(e-n)*f}if(e<=r)return i*.5+(e-i)/(r-i)*50},[n,r,i,e]);function h(f){f.preventDefault();const m=a.current;let p=!0;function g(C){if(p){let y=C.clientX-m.getBoundingClientRect().x;y<=0?y=0:y>=+Do.sliderWidth&&(y=+Do.sliderWidth);const S=y/+Do.sliderWidth;let E=0;S<=.5?E=n+S*(i-n)*2:E=i+(S-.5)*(r-i)*2,s&&s(Math.ceil(E))}}function v(){p=!1,document.removeEventListener("mousemove",g),window.removeEventListener("mouseup",v)}function _(C){C.relatedTarget===null&&v()}document.addEventListener("mousemove",g),window.addEventListener("mouseup",v),window.addEventListener("mouseout",_)}return $t.jsxs("div",{className:Do.slider,children:[$t.jsx(c1,{type:"text",size:"small",disabled:e<=n,onClick:()=>c(-10),children:$t.jsx(dY,{})}),$t.jsx("div",{className:Do.sliderRail,children:$t.jsxs("div",{ref:a,role:"track",className:Do.sliderInnerRail,children:[$t.jsx(p4,{title:`${l.design.Slider.resetTo} ${i}%`,children:$t.jsx("a",{className:Do.sliderResetPoint,role:"reset button",onClick:u})}),$t.jsx("div",{className:Do.sliderHandle,role:"handle",style:{left:`${d}%`},onMouseDown:h})]})}),$t.jsx(c1,{type:"text",size:"small",disabled:e>=r,onClick:()=>c(10),children:$t.jsx(aY,{})}),$t.jsx(g1,{placement:"topLeft",overlay:$t.jsx("div",{className:Do.sliderShortcuts,children:o==null?void 0:o.map(f=>$t.jsxs("a",{className:wi(Do.sliderShortcut,f===e?Do.sliderShortcutActive:""),onClick:()=>s&&s(f),children:[f===e&&$t.jsx("span",{className:Do.sliderShortcutIcon,children:""}),$t.jsxs("span",{children:[f,"%"]})]},f))}),children:$t.jsxs("a",{className:Do.sliderValue,children:[e,"%"]})})]})}const Gre="#fee7e7",Kre="#fdcece",Zre="#fb9d9d",qre="#fa7979",Qre="#fe4b4b",Jre="#f30b0b",eie="#e30909",tie="#cd0f0f",nie="#b20000",rie="#9d0000",iie="#fef0e6",oie="#fee1cd",sie="#fdc49b",aie="#fca669",lie="#ff8c51",uie="#fb8937",cie="#f96800",die="#df5d00",hie="#cc4f10",fie="#b24000",mie="#fef6e6",pie="#feeecd",gie="#fddc9b",vie="#fccb69",_ie="#ffbd37",bie="#faad14",Cie="#e59b07",yie="#c68400",Sie="#a97100",Eie="#8f5f00",wie="#fefbe6",Rie="#fef7cd",Die="#fdf09b",Iie="#fce869",xie="#fbe137",Mie="#f9d700",Oie="#ebc301",Tie="#d8b300",$ie="#c5a300",kie="#b19401",Aie="#f7fde8",Nie="#effbd0",Lie="#def6a2",Pie="#cef273",Bie="#beee44",Fie="#a4dc16",Uie="#8bbb11",Hie="#7aa017",Vie="#688c0d",jie="#58770a",zie="#effce8",Wie="#dff9d2",Xie="#bff3a5",Yie="#9fed78",Gie="#7fe74b",Kie="#59d01e",Zie="#49b811",qie="#409f11",Qie="#398712",Jie="#317310",eoe="#e5fffb",toe="#ccfff7",noe="#a9fff2",roe="#78fce8",ioe="#2afede",ooe="#10e8c7",soe="#00d2b2",aoe="#00b298",loe="#009e87",uoe="#008b76",coe="#e4f4fe",doe="#d0edff",hoe="#9fdaff",foe="#62c2ff",moe="#2daeff",poe="#0b9efb",goe="#0493ee",voe="#0080d2",_oe="#006cae",boe="#005f9a",Coe="#e8ecfd",yoe="#d0d9fb",Soe="#a2b3f6",Eoe="#738df2",woe="#3a60f7",Roe="#274fee",Doe="#143ee3",Ioe="#012bd2",xoe="#0025b7",Moe="#001f9c",Ooe="#f1eafa",Toe="#e3d5f6",$oe="#c7abed",koe="#aa82e3",Aoe="#9e6de3",Noe="#894ede",Loe="#7735d4",Poe="#6721cb",Boe="#510eb0",Foe="#3f0198",Uoe="#fde8f3",Hoe="#fbd0e8",Voe="#f6a2d0",joe="#f273b9",zoe="#f248a6",Woe="#e7258f",Xoe="#d4157e",Yoe="#c1026b",Goe="#a1095c",Koe="#8f0550",Zoe="#f5f5f5",qoe="#ececec",Qoe="#e5e5e5",Joe="#d8d8d8",ese="#bcbcbc",tse="#999999",nse="#7a7a7a",rse="#656565",ise="#565656",ose="#4b4b4b",sse="#1e222b",ase="#ffffff",lse="0 4px 12px rgba(30, 34, 43, 0.08)",use="0 4px 24px 0 rgba(30, 34, 43, 0.08)",cse="#ececec",dse="#d8d8d8",hse="#ffffff",fse="#1e222b",mse="#7a7a7a",pse="#4b4b4b",gse="#bcbcbc",vse="#e5e5e5",_se="#bcbcbc",bse="#999999",Cse="#7a7a7a",yse="4px",Sse="8px",Ese="12px",wse="24px",Rse="20px",Dse="16px",Ise="12px",xse="8px",Mse="4px",Ose="20px",Tse="16px",$se="12px",kse="8px",Ase="4px",Nse="20px",Lse="18px",Pse="16px",Bse="15px",Fse="14px",Use="13px",Hse="12px",Vse="768px",jse="1024px",zse="1280px",Wse="1536px",Xse="#2daeff",Yse="#59d01e",Gse="#ffbd37",Kse="#fe4b4b",Zse="#274fee",qse="#3a60f7",Qse="#0b9efb",Jse="#9e6de3",eae="#49b811",tae="#0b9efb",nae="#ffbd37",rae="#f273b9",iae="#00d2b2",oae="#ff8c51",sae="#565656",aae="#274fee",lae="#fa7979",uae="#8bbb11",cae="#d8b300",Ak={red50:Gre,red100:Kre,red200:Zre,red300:qre,red400:Qre,red500:Jre,red600:eie,red700:tie,red800:nie,red900:rie,orange50:iie,orange100:oie,orange200:sie,orange300:aie,orange400:lie,orange500:uie,orange600:cie,orange700:die,orange800:hie,orange900:fie,gold50:mie,gold100:pie,gold200:gie,gold300:vie,gold400:_ie,gold500:bie,gold600:Cie,gold700:yie,gold800:Sie,gold900:Eie,yellow50:wie,yellow100:Rie,yellow200:Die,yellow300:Iie,yellow400:xie,yellow500:Mie,yellow600:Oie,yellow700:Tie,yellow800:$ie,yellow900:kie,verdancy50:Aie,verdancy100:Nie,verdancy200:Lie,verdancy300:Pie,verdancy400:Bie,verdancy500:Fie,verdancy600:Uie,verdancy700:Hie,verdancy800:Vie,verdancy900:jie,green50:zie,green100:Wie,green200:Xie,green300:Yie,green400:Gie,green500:Kie,green600:Zie,green700:qie,green800:Qie,green900:Jie,jiqing50:eoe,jiqing100:toe,jiqing200:noe,jiqing300:roe,jiqing400:ioe,jiqing500:ooe,jiqing600:soe,jiqing700:aoe,jiqing800:loe,jiqing900:uoe,blue50:coe,blue100:doe,blue200:hoe,blue300:foe,blue400:moe,blue500:poe,blue600:goe,blue700:voe,blue800:_oe,blue900:boe,hyacinth50:Coe,hyacinth100:yoe,hyacinth200:Soe,hyacinth300:Eoe,hyacinth400:woe,hyacinth500:Roe,hyacinth600:Doe,hyacinth700:Ioe,hyacinth800:xoe,hyacinth900:Moe,purple50:Ooe,purple100:Toe,purple200:$oe,purple300:koe,purple400:Aoe,purple500:Noe,purple600:Loe,purple700:Poe,purple800:Boe,purple900:Foe,magenta50:Uoe,magenta100:Hoe,magenta200:Voe,magenta300:joe,magenta400:zoe,magenta500:Woe,magenta600:Xoe,magenta700:Yoe,magenta800:Goe,magenta900:Koe,grey50:Zoe,grey100:qoe,grey200:Qoe,grey300:Joe,grey400:ese,grey500:tse,grey600:nse,grey700:rse,grey800:ise,grey900:ose,colorBlack:sse,colorWhite:ase,boxShadowBase:lse,boxShadowLg:use,bgColor:cse,bgColorHover:dse,bgColorSecondary:hse,textColor:fse,textColorSecondary:mse,textColorSecondaryDarker:pse,textColorTertiary:gse,borderColor:vse,scrollbarColor:_se,scrollbarColorHover:bse,scrollbarColorActive:Cse,borderRadiusBase:yse,borderRadiusLg:Sse,borderRadiusXl:Ese,marginXl:wse,marginLg:Rse,marginBase:Dse,marginSm:Ise,marginXs:xse,marginXxs:Mse,paddingXl:Ose,paddingLg:Tse,paddingBase:$se,paddingSm:kse,paddingXs:Ase,fontSizeXxl:Nse,fontSizeXl:Lse,fontSizeLg:Pse,fontSizeBase:Bse,fontSizeSm:Fse,fontSizeXs:Use,fontSizeXxs:Hse,breakpointXs:Vse,breakpointSm:jse,breakpointBase:zse,breakpointLg:Wse,infoColor:Xse,successColor:Yse,warningColor:Gse,errorColor:Kse,primaryColor:Zse,primaryColorHover:qse,linkColor:Qse,loopColor1:Jse,loopColor2:eae,loopColor3:tae,loopColor4:nae,loopColor5:rae,loopColor6:iae,loopColor7:oae,loopColor8:sae,loopColor9:aae,loopColor10:lae,loopColor11:uae,loopColor12:cae},dae="univer-theme",hae={theme:dae};function fae(t){return`--${t.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`).replace(/(\d+)/g,"-$1")}`}function mae(t){if(t.startsWith("#")){const e=t.replace("#",""),n=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),i=parseInt(e.substring(4,6),16);return`${n}, ${r}, ${i}`}return t}class pae{constructor(){Ph(this,"_styleSheet",null),Ph(this,"_themeRootName",hae.theme);const e=document.createElement("style");e.id=this._themeRootName,document.head.appendChild(e),this._styleSheet=e}setTheme(e,n){this._styleSheet&&(e.classList.remove(this._themeRootName),e.classList.add(this._themeRootName),this._styleSheet.innerHTML="",this._styleSheet.innerHTML=`.${this._themeRootName} {${Object.keys(n).map(r=>`${fae(r)}: ${mae(n[r])};`).join("")}}`)}}const qw=new pae;var gae=Object.defineProperty,vae=(t,e,n)=>e in t?gae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,M=(t,e,n)=>(vae(t,typeof e!="symbol"?e+"":e,n),n),Nk=(t=>(t.RECT="rect",t.CIRCLE="circle",t.PATH="path",t))(Nk||{}),ca=(t=>(t.PointerMove="PointerMove",t.PointerDown="PointerDown",t.PointerUp="PointerUp",t.PointerOut="PointerOut",t.PointerLeave="PointerLeave",t.PointerOver="PointerOver",t.PointerEnter="PointerEnter",t.wheel="MouseWheel",t.KeyDown="KeyDown",t.KeyUp="KeyUp",t))(ca||{});const Lk=1,AC='"Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',_ae="0",Qw=1,bae=14;var Yt=(t=>(t.DEFAULT="default",t.AUTO="auto",t.CROSSHAIR="crosshair",t.POINTER="pointer",t.MOVE="move",t.EAST_RESIZE="e-resize",t.NORTH_EAST_RESIZE="ne-resize",t.NORTH_WEST_RESIZE="nw-resize",t.NORTH_RESIZE="n-resize",t.SOUTH_EAST_RESIZE="se-resize",t.SOUTH_WEST_RESIZE="sw-resize",t.SOUTH_RESIZE="s-resize",t.WEST_RESIZE="w-resize",t.TEXT="text",t.WAIT="wait",t.HELP="help",t.CELL="cell",t.NONE="none",t.VERTICAL_TEXT="vertical-text",t.NO_DROP="no-drop",t.GRAB="grab",t.GRABBING="grabbing",t.ALL_SCROLL="all-scroll",t.COLUMN_RESIZE="col-resize",t.ROW_RESIZE="row-resize",t.PROGRESS="progress",t.NOT_ALLOWED="not-allowed",t.ZOOM_IN="zoom-in",t.ZOOM_OUT="zoom-out",t))(Yt||{});const W2="rgb(0,0,0)";var jn=(t=>(t.TOP="t",t.BOTTOM="b",t.LEFT="l",t.RIGHT="r",t.TL_BR="tl_br",t.TL_BC="tl_bc",t.TL_MR="tl_mr",t.BL_TR="bl_tr",t.ML_TR="ml_tr",t.BC_TR="bc_tr",t))(jn||{}),Zh=(t=>(t[t.UP=0]="UP",t[t.DOWN=1]="DOWN",t))(Zh||{}),Bt=(t=>(t.ENGINE="Engine",t.SCENE="Scene",t.BASE_OBJECT="BaseObject",t.SCENE_VIEWER="SceneViewer",t.CANVAS="Canvas",t.VIEWPORT="Viewport",t.LAYER="Layer",t.GROUP="Group",t))(Bt||{});const Cae=1e3,yae=2e3,ii=.5;var lo=(t=>(t[t.translate=0]="translate",t[t.resize=1]="resize",t[t.scale=2]="scale",t[t.skew=3]="skew",t[t.flip=4]="flip",t[t.all=5]="all",t))(lo||{});let Sae=class{isEmpty(){return this._isEmpty()}toString(e){if(this.isEmpty())throw new Error("Output is empty.");return this._toString(e)}toRegExp(e){return new RegExp(this.toString(e),e)}},$6=class Id extends Sae{constructor(...e){super(),this.data=[];for(const n of e)n instanceof Id?this.data.push(...n.data):this.data.push(wae(n));this._unique()}union(...e){return new Id(this,...e)}subtract(...e){const n=this.data.slice(),r=[];let i=0;const{data:o}=new Id(...e);for(;n.length!==0;){const s=n.shift(),[a,l]=s;let u;do{u=!0;const c=o[i];if(c===void 0){r.push(s);break}const[d,h]=c;h<a?(u=!1,i++):l<d?r.push(s):d<=a&&h<l?(i++,n.unshift([h+1,l])):a<d&&h<l?(i++,r.push([a,d-1]),n.unshift([h+1,l])):a<d&&l<=h&&r.push([a,d-1])}while(!u)}return new Id(...r)}intersect(...e){return this.subtract(this.subtract(...e))}_isEmpty(){return this.data.length===0}_toString(e){return Dae(this.data,e)}_unique(){this.data.sort(Rae);const e=[];let n=null;for(const r of this.data)n===null||n[1]+1<r[0]?(e.push(r),n=r):(e.splice(-1,1,[Math.min(r[0],n[0]),Math.max(r[1],n[1])]),n=e[e.length-1]);this.data=e}};const NC=(...t)=>new $6(...t);function Eae(t){if(t.length!==1){const e=`${t.length} (${JSON.stringify(t)})`;throw new Error(`Expected length = 1, but received ${e}.`)}return t.charCodeAt(0)}function wae(t){if(typeof t=="number"&&(t<0||t>1114111))throw new Error(`Invalid unicode code point detected: ${t<0?t:`0x${t.toString(16)}`}`);const[e]=[t].map(n=>typeof n!="object"?[n,n]:n).map(n=>n.map(r=>typeof r=="string"?Eae(r):r));return e}function Rae(t,e){return t[0]-e[0]}function Dae(t,e=""){if(e.includes("u"))return Jw(t,!0);const{normal:n,surrogate:r}=xae(t),i=[];return n.length!==0&&i.push(Jw(n,!1)),i.push(...Iae(r)),i.join("|")}function Jw(t,e){return`[${t.map(([n,r])=>n===r?qd(n,e):`${qd(n,e)}-${qd(r,e)}`).join("")}]`}function Iae(t){const e=[];if(t.entire.data.length!==0){const n=t.entire.toString(),r=`[${[56320,57343].map(i=>qd(i,!1)).join("-")}]`;e.push(`${n}${r}`)}for(const{h:n,l:r}of t.partial){const i=qd(n,!1),o=r.toString();e.push(`${i}${o}`)}return e}function xae(t){const e=[],n=[];for(let r=0;r<t.length;r++){const i=t[r],[o,s]=i;if(o>=65536){n.push(...t.slice(r));break}if(s>=65536){e.push([o,65535]),n.push([65536,s],...t.slice(r+1));break}e.push(i)}return{normal:e,surrogate:Mae(n)}}function Mae(t){const e=[],n=[];for(const[o,s]of t){const a=eR(o),l=eR(s);if(a.h===l.h){i(a.h,a.l,l.l);continue}a.l===56320?r(a.h):i(a.h,a.l,57343);for(let u=a.h+1;u<l.h;u++)r(u);l.l===57343?r(l.h):i(l.h,56320,l.l)}return{entire:new $6(...e),partial:n.map(({h:o,l:s})=>({h:o,l:new $6(...s)}))};function r(o){e.push(o)}function i(o,s,a){const l=n[n.length-1];l!==void 0&&l.h===o?l.l.push([s,a]):n.push({h:o,l:[[s,a]]})}}function eR(t){return{h:Math.floor((t-65536)/1024)+55296,l:(t-65536)%1024+56320}}function qd(t,e){const n=t.toString(16);return e?`\\u{${n}}`:`\\u${"0".repeat(4-n.length)}${n}`}const Oae=[[0,127]],Tae=[[48,57],[65,70],[97,102]],$ae=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,705],[710,721],[736,740],748,750,837,[880,884],[886,887],[890,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],1369,[1376,1416],[1456,1469],1471,[1473,1474],[1476,1477],1479,[1488,1514],[1519,1522],[1552,1562],[1568,1623],[1625,1631],[1646,1747],[1749,1756],[1761,1768],[1773,1775],[1786,1788],1791,[1808,1855],[1869,1969],[1994,2026],[2036,2037],2042,[2048,2071],[2074,2092],[2112,2136],[2144,2154],[2160,2183],[2185,2190],[2208,2249],[2260,2271],[2275,2281],[2288,2363],[2365,2380],[2382,2384],[2389,2403],[2417,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2493,2500],[2503,2504],[2507,2508],2510,2519,[2524,2525],[2527,2531],[2544,2545],2556,[2561,2563],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2622,2626],[2631,2632],[2635,2636],2641,[2649,2652],2654,[2672,2677],[2689,2691],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2749,2757],[2759,2761],[2763,2764],2768,[2784,2787],[2809,2812],[2817,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2877,2884],[2887,2888],[2891,2892],[2902,2903],[2908,2909],[2911,2915],2929,[2946,2947],[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3010],[3014,3016],[3018,3020],3024,3031,[3072,3084],[3086,3088],[3090,3112],[3114,3129],[3133,3140],[3142,3144],[3146,3148],[3157,3158],[3160,3162],3165,[3168,3171],[3200,3203],[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3261,3268],[3270,3272],[3274,3276],[3285,3286],[3293,3294],[3296,3299],[3313,3315],[3328,3340],[3342,3344],[3346,3386],[3389,3396],[3398,3400],[3402,3404],3406,[3412,3415],[3423,3427],[3450,3455],[3457,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3535,3540],3542,[3544,3551],[3570,3571],[3585,3642],[3648,3654],3661,[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3769],[3771,3773],[3776,3780],3782,3789,[3804,3807],3840,[3904,3911],[3913,3948],[3953,3971],[3976,3991],[3993,4028],[4096,4150],4152,[4155,4159],[4176,4239],[4250,4253],[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5907],[5919,5939],[5952,5971],[5984,5996],[5998,6e3],[6002,6003],[6016,6067],[6070,6088],6103,6108,[6176,6264],[6272,6314],[6320,6389],[6400,6430],[6432,6443],[6448,6456],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6683],[6688,6750],[6753,6772],6823,[6847,6848],[6860,6862],[6912,6963],[6965,6979],[6981,6988],[7040,7081],[7084,7087],[7098,7141],[7143,7153],[7168,7222],[7245,7247],[7258,7293],[7296,7304],[7312,7354],[7357,7359],[7401,7404],[7406,7411],[7413,7414],7418,[7424,7615],[7655,7668],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8473,8477],8484,8486,8488,[8490,8493],[8495,8505],[8508,8511],[8517,8521],8526,[8544,8584],[9398,9449],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[11568,11623],11631,[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[11744,11775],11823,[12293,12295],[12321,12329],[12337,12341],[12344,12348],[12353,12438],[12445,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,42124],[42192,42237],[42240,42508],[42512,42527],[42538,42539],[42560,42606],[42612,42619],[42623,42735],[42775,42783],[42786,42888],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43013],[43015,43047],[43072,43123],[43136,43203],43205,[43250,43255],43259,[43261,43263],[43274,43306],[43312,43346],[43360,43388],[43392,43442],[43444,43455],43471,[43488,43503],[43514,43518],[43520,43574],[43584,43597],[43616,43638],[43642,43710],43712,43714,[43739,43741],[43744,43759],[43762,43765],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43866],[43868,43881],[43888,44010],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],[64285,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65313,65338],[65345,65370],[65382,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65856,65908],[66176,66204],[66208,66256],[66304,66335],[66349,66378],[66384,66426],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],[68096,68099],[68101,68102],[68108,68115],[68117,68119],[68121,68149],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68903],[69248,69289],[69291,69292],[69296,69297],[69376,69404],69415,[69424,69445],[69488,69505],[69552,69572],[69600,69622],[69632,69701],[69745,69749],[69760,69816],69826,[69840,69864],[69888,69938],[69956,69959],[69968,70002],70006,[70016,70079],[70081,70084],[70094,70095],70106,70108,[70144,70161],[70163,70196],70199,[70206,70209],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70376],[70400,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70461,70468],[70471,70472],[70475,70476],70480,70487,[70493,70499],[70656,70721],[70723,70725],[70727,70730],[70751,70753],[70784,70849],[70852,70853],70855,[71040,71093],[71096,71102],[71128,71133],[71168,71230],71232,71236,[71296,71349],71352,[71424,71450],[71453,71466],[71488,71494],[71680,71736],[71840,71903],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],[71995,71996],[71999,72002],[72096,72103],[72106,72151],[72154,72159],72161,[72163,72164],[72192,72242],[72245,72254],[72272,72343],72349,[72368,72440],[72704,72712],[72714,72758],[72760,72766],72768,[72818,72847],[72850,72871],[72873,72886],[72960,72966],[72968,72969],[72971,73014],73018,[73020,73021],[73023,73025],73027,[73030,73031],[73056,73061],[73063,73064],[73066,73102],[73104,73105],[73107,73110],73112,[73440,73462],[73472,73488],[73490,73530],[73534,73536],73648,[73728,74649],[74752,74862],[74880,75075],[77712,77808],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[92992,92995],[93027,93047],[93053,93071],[93760,93823],[93952,94026],[94031,94087],[94095,94111],[94176,94177],94179,[94192,94193],[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],113822,[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122654],[122661,122666],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[122928,122989],123023,[123136,123180],[123191,123197],123214,[123536,123565],[123584,123627],[124112,124139],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125184,125251],125255,125259,[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[127280,127305],[127312,127337],[127344,127369],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],kae=[[0,1114111]],Aae=[[0,887],[890,895],[900,906],908,[910,929],[931,1327],[1329,1366],[1369,1418],[1421,1423],[1425,1479],[1488,1514],[1519,1524],[1536,1805],[1807,1866],[1869,1969],[1984,2042],[2045,2093],[2096,2110],[2112,2139],2142,[2144,2154],[2160,2190],[2192,2193],[2200,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2492,2500],[2503,2504],[2507,2510],2519,[2524,2525],[2527,2531],[2534,2558],[2561,2563],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2649,2652],2654,[2662,2678],[2689,2691],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2748,2757],[2759,2761],[2763,2765],2768,[2784,2787],[2790,2801],[2809,2815],[2817,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2876,2884],[2887,2888],[2891,2893],[2901,2903],[2908,2909],[2911,2915],[2918,2935],[2946,2947],[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3010],[3014,3016],[3018,3021],3024,3031,[3046,3066],[3072,3084],[3086,3088],[3090,3112],[3114,3129],[3132,3140],[3142,3144],[3146,3149],[3157,3158],[3160,3162],3165,[3168,3171],[3174,3183],[3191,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3260,3268],[3270,3272],[3274,3277],[3285,3286],[3293,3294],[3296,3299],[3302,3311],[3313,3315],[3328,3340],[3342,3344],[3346,3396],[3398,3400],[3402,3407],[3412,3427],[3430,3455],[3457,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3530,[3535,3540],3542,[3544,3551],[3558,3567],[3570,3572],[3585,3642],[3647,3675],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3773],[3776,3780],3782,[3784,3790],[3792,3801],[3804,3807],[3840,3911],[3913,3948],[3953,3991],[3993,4028],[4030,4044],[4046,4058],[4096,4293],4295,4301,[4304,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4957,4988],[4992,5017],[5024,5109],[5112,5117],[5120,5788],[5792,5880],[5888,5909],[5919,5942],[5952,5971],[5984,5996],[5998,6e3],[6002,6003],[6016,6109],[6112,6121],[6128,6137],[6144,6169],[6176,6264],[6272,6314],[6320,6389],[6400,6430],[6432,6443],[6448,6459],6464,[6468,6509],[6512,6516],[6528,6571],[6576,6601],[6608,6618],[6622,6683],[6686,6750],[6752,6780],[6783,6793],[6800,6809],[6816,6829],[6832,6862],[6912,6988],[6992,7038],[7040,7155],[7164,7223],[7227,7241],[7245,7304],[7312,7354],[7357,7367],[7376,7418],[7424,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8132],[8134,8147],[8150,8155],[8157,8175],[8178,8180],[8182,8190],[8192,8292],[8294,8305],[8308,8334],[8336,8348],[8352,8384],[8400,8432],[8448,8587],[8592,9254],[9280,9290],[9312,11123],[11126,11157],[11159,11507],[11513,11557],11559,11565,[11568,11623],[11631,11632],[11647,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[11744,11869],[11904,11929],[11931,12019],[12032,12245],[12272,12283],[12288,12351],[12353,12438],[12441,12543],[12549,12591],[12593,12686],[12688,12771],[12784,12830],[12832,42124],[42128,42182],[42192,42539],[42560,42743],[42752,42954],[42960,42961],42963,[42965,42969],[42994,43052],[43056,43065],[43072,43127],[43136,43205],[43214,43225],[43232,43347],[43359,43388],[43392,43469],[43471,43481],[43486,43518],[43520,43574],[43584,43597],[43600,43609],[43612,43714],[43739,43766],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43883],[43888,44013],[44016,44025],[44032,55203],[55216,55238],[55243,55291],[55296,64109],[64112,64217],[64256,64262],[64275,64279],[64285,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64450],[64467,64911],[64914,64967],64975,[65008,65049],[65056,65106],[65108,65126],[65128,65131],[65136,65140],[65142,65276],65279,[65281,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65504,65510],[65512,65518],[65529,65533],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65792,65794],[65799,65843],[65847,65934],[65936,65948],65952,[66e3,66045],[66176,66204],[66208,66256],[66272,66299],[66304,66339],[66349,66378],[66384,66426],[66432,66461],[66463,66499],[66504,66517],[66560,66717],[66720,66729],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66927,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67671,67742],[67751,67759],[67808,67826],[67828,67829],[67835,67867],[67871,67897],67903,[67968,68023],[68028,68047],[68050,68099],[68101,68102],[68108,68115],[68117,68119],[68121,68149],[68152,68154],[68159,68168],[68176,68184],[68192,68255],[68288,68326],[68331,68342],[68352,68405],[68409,68437],[68440,68466],[68472,68497],[68505,68508],[68521,68527],[68608,68680],[68736,68786],[68800,68850],[68858,68903],[68912,68921],[69216,69246],[69248,69289],[69291,69293],[69296,69297],[69373,69415],[69424,69465],[69488,69513],[69552,69579],[69600,69622],[69632,69709],[69714,69749],[69759,69826],69837,[69840,69864],[69872,69881],[69888,69940],[69942,69959],[69968,70006],[70016,70111],[70113,70132],[70144,70161],[70163,70209],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70313],[70320,70378],[70384,70393],[70400,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70459,70468],[70471,70472],[70475,70477],70480,70487,[70493,70499],[70502,70508],[70512,70516],[70656,70747],[70749,70753],[70784,70855],[70864,70873],[71040,71093],[71096,71133],[71168,71236],[71248,71257],[71264,71276],[71296,71353],[71360,71369],[71424,71450],[71453,71467],[71472,71494],[71680,71739],[71840,71922],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],[71995,72006],[72016,72025],[72096,72103],[72106,72151],[72154,72164],[72192,72263],[72272,72354],[72368,72440],[72448,72457],[72704,72712],[72714,72758],[72760,72773],[72784,72812],[72816,72847],[72850,72871],[72873,72886],[72960,72966],[72968,72969],[72971,73014],73018,[73020,73021],[73023,73031],[73040,73049],[73056,73061],[73063,73064],[73066,73102],[73104,73105],[73107,73112],[73120,73129],[73440,73464],[73472,73488],[73490,73530],[73534,73561],73648,[73664,73713],[73727,74649],[74752,74862],[74864,74868],[74880,75075],[77712,77810],[77824,78933],[82944,83526],[92160,92728],[92736,92766],[92768,92777],[92782,92862],[92864,92873],[92880,92909],[92912,92917],[92928,92997],[93008,93017],[93019,93025],[93027,93047],[93053,93071],[93760,93850],[93952,94026],[94031,94087],[94095,94111],[94176,94180],[94192,94193],[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[113820,113827],[118528,118573],[118576,118598],[118608,118723],[118784,119029],[119040,119078],[119081,119274],[119296,119365],[119488,119507],[119520,119539],[119552,119638],[119648,119672],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120782,121483],[121499,121503],[121505,121519],[122624,122654],[122661,122666],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[122928,122989],123023,[123136,123180],[123184,123197],[123200,123209],[123214,123215],[123536,123566],[123584,123641],123647,[124112,124153],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125127,125142],[125184,125259],[125264,125273],[125278,125279],[126065,126132],[126209,126269],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[126704,126705],[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127232,127405],[127462,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994],[130032,130041],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743],917505,[917536,917631],[917760,917999],[983040,1048573],[1048576,1114109]],Nae=[1564,[8206,8207],[8234,8238],[8294,8297]],Lae=[[40,41],60,62,91,93,123,125,171,187,[3898,3901],[5787,5788],[8249,8250],[8261,8262],[8317,8318],[8333,8334],8512,[8705,8708],[8712,8717],8721,[8725,8726],[8730,8733],[8735,8738],8740,8742,[8747,8755],8761,[8763,8780],[8786,8789],[8799,8800],8802,[8804,8811],[8814,8844],[8847,8850],8856,[8866,8867],[8870,8888],[8894,8895],[8905,8909],[8912,8913],[8918,8941],[8944,8959],[8968,8971],[8992,8993],[9001,9002],[10088,10101],10176,[10179,10182],[10184,10185],[10187,10189],[10195,10198],[10204,10206],[10210,10223],[10627,10648],[10651,10656],[10658,10671],10680,[10688,10693],10697,[10702,10706],[10708,10709],[10712,10716],10721,[10723,10725],[10728,10729],[10740,10745],[10748,10749],[10762,10780],[10782,10785],10788,10790,10793,[10795,10798],[10804,10805],[10812,10814],[10839,10840],[10852,10853],[10858,10861],[10863,10864],[10867,10868],[10873,10915],[10918,10925],[10927,10966],10972,10974,[10978,10982],[10988,10990],10995,[10999,11003],11005,11262,[11778,11781],[11785,11786],[11788,11789],[11804,11805],[11808,11817],[11861,11868],[12296,12305],[12308,12315],[65113,65118],[65124,65125],[65288,65289],65308,65310,65339,65341,65371,65373,[65375,65376],[65378,65379],120539,120597,120655,120713,120771],Pae=[39,46,58,94,96,168,173,175,180,[183,184],[688,879],[884,885],890,[900,901],903,[1155,1161],1369,1375,[1425,1469],1471,[1473,1474],[1476,1477],1479,1524,[1536,1541],[1552,1562],1564,1600,[1611,1631],1648,[1750,1757],[1759,1768],[1770,1773],1807,1809,[1840,1866],[1958,1968],[2027,2037],2042,2045,[2070,2093],[2137,2139],2184,[2192,2193],[2200,2207],[2249,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2417,2433,2492,[2497,2500],2509,[2530,2531],2558,[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,2879,[2881,2884],2893,[2901,2902],[2914,2915],2946,3008,3021,3072,3076,3132,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,3263,3270,[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],3405,[3426,3427],3457,3530,[3538,3540],3542,3633,[3636,3642],[3654,3662],3761,[3764,3772],3782,[3784,3790],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,4348,[4957,4959],[5906,5908],[5938,5939],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6103,6109,[6155,6159],6211,[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,6823,[6832,6862],[6912,6915],6964,[6966,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7288,7293],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7468,7530],7544,[7579,7679],8125,[8127,8129],[8141,8143],[8157,8159],[8173,8175],[8189,8190],[8203,8207],[8216,8217],8228,8231,[8234,8238],[8288,8292],[8294,8303],8305,8319,[8336,8348],[8400,8432],[11388,11389],[11503,11505],11631,11647,[11744,11775],11823,12293,[12330,12333],[12337,12341],12347,[12441,12446],[12540,12542],40981,[42232,42237],42508,[42607,42610],[42612,42621],42623,[42652,42655],[42736,42737],[42752,42785],42864,[42888,42890],[42994,42996],[43e3,43001],43010,43014,43019,[43045,43046],43052,[43204,43205],[43232,43249],43263,[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],[43452,43453],43471,[43493,43494],[43561,43566],[43569,43570],[43573,43574],43587,43596,43632,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,43741,[43756,43757],[43763,43764],43766,[43867,43871],[43881,43883],44005,44008,44013,64286,[64434,64450],[65024,65039],65043,[65056,65071],65106,65109,65279,65287,65294,65306,65342,65344,65392,[65438,65439],65507,[65529,65531],66045,66272,[66422,66426],[67456,67461],[67463,67504],[67506,67514],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],69633,[69688,69702],69744,[69747,69748],[69759,69761],[69811,69814],[69817,69818],69821,69826,69837,[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70089,70092],70095,[70191,70193],70196,[70198,70199],70206,70209,70367,[70371,70378],[70400,70401],[70459,70460],70464,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,70750,[70835,70840],70842,[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[71727,71735],[71737,71738],[71995,71996],71998,72003,[72148,72151],[72154,72155],72160,[72193,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],72767,[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73104,73105],73109,73111,[73459,73460],[73472,73473],[73526,73530],73536,73538,[78896,78912],[78919,78933],[92912,92916],[92976,92982],[92992,92995],94031,[94095,94111],[94176,94177],[94179,94180],[110576,110579],[110581,110587],[110589,110590],[113821,113822],[113824,113827],[118528,118573],[118576,118598],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[122928,122989],123023,[123184,123197],123566,[123628,123631],[124139,124143],[125136,125142],[125252,125259],[127995,127999],917505,[917536,917631],[917760,917999]],Bae=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,442],[444,447],[452,659],[661,696],[704,705],[736,740],837,[880,883],[886,887],[890,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],[1376,1416],[4256,4293],4295,4301,[4304,4346],[4348,4351],[5024,5109],[5112,5117],[7296,7304],[7312,7354],[7357,7359],[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8473,8477],8484,8486,8488,[8490,8493],[8495,8500],8505,[8508,8511],[8517,8521],8526,[8544,8575],[8579,8580],[9398,9449],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[42560,42605],[42624,42653],[42786,42887],[42891,42894],[42896,42954],[42960,42961],42963,[42965,42969],[42994,42998],[43e3,43002],[43824,43866],[43868,43881],[43888,43967],[64256,64262],[64275,64279],[65313,65338],[65345,65370],[66560,66639],[66736,66771],[66776,66811],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],67456,[67459,67461],[67463,67504],[67506,67514],[68736,68786],[68800,68850],[71840,71903],[93760,93823],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122633],[122635,122654],[122661,122666],[122928,122989],[125184,125251],[127280,127305],[127312,127337],[127344,127369]],Fae=[[65,90],181,[192,214],[216,223],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,[329,330],332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,383,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,[452,453],[455,456],[458,459],461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,[497,498],500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,837,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],962,[975,977],[981,982],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,[1008,1009],[1012,1013],1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],1415,[4256,4293],4295,4301,[5112,5117],[7296,7304],[7312,7354],[7357,7359],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,[7834,7835],7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8064,8111],[8114,8116],[8119,8124],[8130,8132],[8135,8140],[8152,8155],[8168,8172],[8178,8180],[8183,8188],8486,[8490,8491],8498,[8544,8559],8579,[9398,9423],[11264,11311],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,42936,42938,42940,42942,42944,42946,[42948,42951],42953,42960,42966,42968,42997,[43888,43967],[64256,64262],[64275,64279],[65313,65338],[66560,66599],[66736,66771],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[68736,68786],[71840,71871],[93760,93791],[125184,125217]],Uae=[[65,90],[97,122],181,[192,214],[216,246],[248,311],[313,396],[398,410],[412,425],[428,441],[444,445],447,[452,544],[546,563],[570,596],[598,599],601,[603,604],[608,609],611,[613,614],[616,620],623,[625,626],629,637,640,[642,643],[647,652],658,[669,670],837,[880,883],[886,887],[891,893],895,902,[904,906],908,[910,929],[931,977],[981,1013],[1015,1019],[1021,1153],[1162,1327],[1329,1366],[1377,1415],[4256,4293],4295,4301,[4304,4346],[4349,4351],[5024,5109],[5112,5117],[7296,7304],[7312,7354],[7357,7359],7545,7549,7566,[7680,7835],7838,[7840,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8486,[8490,8491],8498,8526,[8544,8575],[8579,8580],[9398,9449],[11264,11376],[11378,11379],[11381,11382],[11390,11491],[11499,11502],[11506,11507],[11520,11557],11559,11565,[42560,42605],[42624,42651],[42786,42799],[42802,42863],[42873,42887],[42891,42893],[42896,42900],[42902,42926],[42928,42954],[42960,42961],[42966,42969],[42997,42998],43859,[43888,43967],[64256,64262],[64275,64279],[65313,65338],[65345,65370],[66560,66639],[66736,66771],[66776,66811],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[68736,68786],[68800,68850],[71840,71903],[93760,93823],[125184,125251]],Hae=[[65,90],[192,214],[216,222],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,330,332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,[452,453],[455,456],[458,459],461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,[497,498],500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],975,984,986,988,990,992,994,996,998,1e3,1002,1004,1006,1012,1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],[4256,4293],4295,4301,[5024,5109],[7312,7354],[7357,7359],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8072,8079],[8088,8095],[8104,8111],[8120,8124],[8136,8140],[8152,8155],[8168,8172],[8184,8188],8486,[8490,8491],8498,[8544,8559],8579,[9398,9423],[11264,11311],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,42936,42938,42940,42942,42944,42946,[42948,42951],42953,42960,42966,42968,42997,[65313,65338],[66560,66599],[66736,66771],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[68736,68786],[71840,71871],[93760,93791],[125184,125217]],Vae=[[65,90],160,168,170,173,175,[178,181],[184,186],[188,190],[192,214],[216,223],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,[306,308],310,313,315,317,[319,321],323,325,327,[329,330],332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,383,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,[452,461],463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,[497,500],[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,[688,696],[728,733],[736,740],[832,833],[835,837],847,880,882,884,886,890,[894,895],[900,906],908,[910,911],[913,929],[931,939],962,[975,982],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,[1008,1010],[1012,1013],1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],1415,1564,[1653,1656],[2392,2399],[2524,2525],2527,2611,2614,[2649,2651],2654,[2908,2909],3635,3763,[3804,3805],3852,3907,3917,3922,3927,3932,3945,3955,[3957,3961],3969,3987,3997,4002,4007,4012,4025,[4256,4293],4295,4301,4348,[4447,4448],[5112,5117],[6068,6069],[6155,6159],[7296,7304],[7312,7354],[7357,7359],[7468,7470],[7472,7482],[7484,7501],[7503,7530],7544,[7579,7615],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,[7834,7835],7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],8049,8051,8053,8055,8057,8059,8061,[8064,8111],[8114,8116],[8119,8132],[8135,8143],8147,[8152,8155],[8157,8159],8163,[8168,8175],[8178,8180],[8183,8190],[8192,8207],8209,8215,[8228,8230],[8234,8239],[8243,8244],[8246,8247],8252,8254,[8263,8265],8279,[8287,8305],[8308,8334],[8336,8348],8360,[8448,8451],[8453,8455],[8457,8467],[8469,8470],[8473,8477],[8480,8482],8484,8486,8488,[8490,8493],[8495,8505],[8507,8512],[8517,8521],[8528,8575],8579,8585,[8748,8749],[8751,8752],[9001,9002],[9312,9450],10764,[10868,10870],10972,[11264,11311],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11388,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,11631,11935,12019,[12032,12245],12288,12342,[12344,12346],[12443,12444],12447,12543,[12593,12686],[12690,12703],[12800,12830],[12832,12871],[12880,12926],[12928,13311],42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,[42652,42653],42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42864,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,42936,42938,42940,42942,42944,42946,[42948,42951],42953,42960,42966,42968,[42994,42997],[43e3,43001],[43868,43871],43881,[43888,43967],[63744,64013],64016,64018,[64021,64030],64032,64034,[64037,64038],[64042,64109],[64112,64217],[64256,64262],[64275,64279],64285,[64287,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65024,65049],[65072,65092],[65095,65106],[65108,65126],[65128,65131],[65136,65138],65140,[65142,65276],65279,[65281,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65504,65510],[65512,65518],[65520,65528],[66560,66599],[66736,66771],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[67457,67461],[67463,67504],[67506,67514],[68736,68786],[71840,71871],[93760,93791],[113824,113827],[119134,119140],[119155,119162],[119227,119232],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120782,120831],[122928,122989],[125184,125217],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[127232,127242],[127248,127278],[127280,127311],[127338,127340],127376,[127488,127490],[127504,127547],[127552,127560],[127568,127569],[130032,130041],[194560,195101],[917504,921599]],jae=[[97,122],181,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,311,314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,396,402,405,[409,410],414,417,419,421,424,429,432,436,438,441,445,447,452,[454,455],[457,458],460,462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,497],499,501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,547,549,551,553,555,557,559,561,563,572,[575,576],578,583,585,587,589,[591,596],[598,599],601,[603,604],[608,609],611,[613,614],[616,620],623,[625,626],629,637,640,[642,643],[647,652],658,[669,670],837,881,883,887,[891,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,1019,[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1377,1415],[5112,5117],[7296,7304],7545,7549,7566,7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7835],7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8071],[8080,8087],[8096,8103],[8112,8116],[8118,8119],8126,[8130,8132],[8134,8135],[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8526,[8560,8575],8580,[9424,9449],[11312,11359],11361,[11365,11366],11368,11370,11372,11379,11382,11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,11491,11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,42581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,42651,42787,42789,42791,42793,42795,42797,42799,42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,42863,42874,42876,42879,42881,42883,42885,42887,42892,42897,[42899,42900],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42933,42935,42937,42939,42941,42943,42945,42947,42952,42954,42961,42967,42969,42998,43859,[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[68800,68850],[71872,71903],[93792,93823],[125218,125251]],zae=[[97,122],181,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,311,314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,396,402,405,[409,410],414,417,419,421,424,429,432,436,438,441,445,447,[453,454],[456,457],[459,460],462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,496],[498,499],501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,547,549,551,553,555,557,559,561,563,572,[575,576],578,583,585,587,589,[591,596],[598,599],601,[603,604],[608,609],611,[613,614],[616,620],623,[625,626],629,637,640,[642,643],[647,652],658,[669,670],837,881,883,887,[891,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,1019,[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1377,1415],[4304,4346],[4349,4351],[5112,5117],[7296,7304],7545,7549,7566,7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7835],7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8116],[8118,8119],8124,8126,[8130,8132],[8134,8135],8140,[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8188,8526,[8560,8575],8580,[9424,9449],[11312,11359],11361,[11365,11366],11368,11370,11372,11379,11382,11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,11491,11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,42581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,42651,42787,42789,42791,42793,42795,42797,42799,42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,42863,42874,42876,42879,42881,42883,42885,42887,42892,42897,[42899,42900],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42933,42935,42937,42939,42941,42943,42945,42947,42952,42954,42961,42967,42969,42998,43859,[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[68800,68850],[71872,71903],[93792,93823],[125218,125251]],Wae=[[2392,2399],[2524,2525],2527,2611,2614,[2649,2651],2654,[2908,2909],3907,3917,3922,3927,3932,3945,3958,3960,3987,3997,4002,4007,4012,4025,10972,64285,64287,[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64334],[119134,119140],[119227,119232]],Xae=[45,1418,1470,5120,6150,[8208,8213],8275,8315,8331,8722,11799,11802,[11834,11835],11840,11869,12316,12336,12448,[65073,65074],65112,65123,65293,69293],Yae=[173,847,1564,[4447,4448],[6068,6069],[6155,6159],[8203,8207],[8234,8238],[8288,8303],12644,[65024,65039],65279,65440,[65520,65528],[113824,113827],[119155,119162],[917504,921599]],Gae=[329,1651,3959,3961,[6051,6052],[8298,8303],[9001,9002],917505],Kae=[94,96,168,175,180,[183,184],[688,846],[848,855],[861,866],[884,885],890,[900,901],[1155,1159],1369,[1425,1441],[1443,1469],1471,[1473,1474],1476,[1611,1618],[1623,1624],[1759,1760],[1765,1766],[1770,1772],[1840,1866],[1958,1968],[2027,2037],[2072,2073],[2200,2207],[2249,2258],[2275,2302],2364,2381,[2385,2388],2417,2492,2509,2620,2637,2748,2765,[2813,2815],2876,2893,2901,3021,3132,3149,3260,3277,[3387,3388],3405,3530,[3655,3660],3662,3770,[3784,3788],[3864,3865],3893,3895,3897,[3902,3903],[3970,3972],[3974,3975],4038,4151,[4153,4154],[4195,4196],[4201,4205],[4231,4237],4239,[4250,4251],[4957,4959],[5908,5909],[6089,6099],6109,[6457,6459],[6773,6780],6783,[6832,6846],[6849,6859],6964,6980,[7019,7027],[7082,7083],[7222,7223],[7288,7293],[7376,7400],7405,7412,[7415,7417],[7468,7530],[7620,7631],[7669,7679],8125,[8127,8129],[8141,8143],[8157,8159],[8173,8175],[8189,8190],[11503,11505],11823,[12330,12335],[12441,12444],12540,42607,[42620,42621],42623,[42652,42653],[42736,42737],[42752,42785],[42888,42890],[43e3,43001],43204,[43232,43249],[43307,43310],43347,43443,43456,43493,[43643,43645],[43711,43714],43766,[43867,43871],[43881,43883],[44012,44013],64286,[65056,65071],65342,65344,65392,[65438,65439],65507,66272,[67456,67461],[67463,67504],[67506,67514],[68325,68326],[68898,68903],[69373,69375],[69446,69456],[69506,69509],69702,69744,[69817,69818],[69939,69940],70003,70080,[70090,70092],[70197,70198],[70377,70378],70460,70477,[70502,70508],[70512,70516],70722,70726,[70850,70851],[71103,71104],71231,[71350,71351],71467,[71737,71738],[71997,71998],72003,72160,72244,72263,72345,72767,73026,[73028,73029],73111,[78919,78933],[92912,92916],[92976,92982],[94095,94111],[94192,94193],[110576,110579],[110581,110587],[110589,110590],[118528,118573],[118576,118598],[119143,119145],[119149,119154],[119163,119170],[119173,119179],[119210,119213],[122928,122989],[123184,123190],123566,[123628,123631],[125136,125142],[125252,125254],[125256,125258]],Zae=[35,42,[48,57],169,174,8252,8265,8482,8505,[8596,8601],[8617,8618],[8986,8987],9e3,9167,[9193,9203],[9208,9210],9410,[9642,9643],9654,9664,[9723,9726],[9728,9732],9742,9745,[9748,9749],9752,9757,9760,[9762,9763],9766,9770,[9774,9775],[9784,9786],9792,9794,[9800,9811],[9823,9824],9827,[9829,9830],9832,9851,[9854,9855],[9874,9879],9881,[9883,9884],[9888,9889],9895,[9898,9899],[9904,9905],[9917,9918],[9924,9925],9928,[9934,9935],9937,[9939,9940],[9961,9962],[9968,9973],[9975,9978],9981,9986,9989,[9992,9997],9999,10002,10004,10006,10013,10017,10024,[10035,10036],10052,10055,10060,10062,[10067,10069],10071,[10083,10084],[10133,10135],10145,10160,10175,[10548,10549],[11013,11015],[11035,11036],11088,11093,12336,12349,12951,12953,126980,127183,[127344,127345],[127358,127359],127374,[127377,127386],[127462,127487],[127489,127490],127514,127535,[127538,127546],[127568,127569],[127744,127777],[127780,127891],[127894,127895],[127897,127899],[127902,127984],[127987,127989],[127991,128253],[128255,128317],[128329,128334],[128336,128359],[128367,128368],[128371,128378],128391,[128394,128397],128400,[128405,128406],[128420,128421],128424,[128433,128434],128444,[128450,128452],[128465,128467],[128476,128478],128481,128483,128488,128495,128499,[128506,128591],[128640,128709],[128715,128722],[128725,128727],[128732,128741],128745,[128747,128748],128752,[128755,128764],[128992,129003],129008,[129292,129338],[129340,129349],[129351,129535],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784]],qae=[35,42,[48,57],8205,8419,65039,[127462,127487],[127995,127999],[129456,129459],[917536,917631]],Qae=[[127995,127999]],Jae=[9757,9977,[9994,9997],127877,[127938,127940],127943,[127946,127948],[128066,128067],[128070,128080],[128102,128120],128124,[128129,128131],[128133,128135],128143,128145,128170,[128372,128373],128378,128400,[128405,128406],[128581,128583],[128587,128591],128675,[128692,128694],128704,128716,129292,129295,[129304,129311],129318,[129328,129337],[129340,129342],129399,[129461,129462],[129464,129465],129467,[129485,129487],[129489,129501],[129731,129733],[129776,129784]],e1e=[[8986,8987],[9193,9196],9200,9203,[9725,9726],[9748,9749],[9800,9811],9855,9875,9889,[9898,9899],[9917,9918],[9924,9925],9934,9940,9962,[9970,9971],9973,9978,9981,9989,[9994,9995],10024,10060,10062,[10067,10069],10071,[10133,10135],10160,10175,[11035,11036],11088,11093,126980,127183,127374,[127377,127386],[127462,127487],127489,127514,127535,[127538,127542],[127544,127546],[127568,127569],[127744,127776],[127789,127797],[127799,127868],[127870,127891],[127904,127946],[127951,127955],[127968,127984],127988,[127992,128062],128064,[128066,128252],[128255,128317],[128331,128334],[128336,128359],128378,[128405,128406],128420,[128507,128591],[128640,128709],128716,[128720,128722],[128725,128727],[128732,128735],[128747,128748],[128756,128764],[128992,129003],129008,[129292,129338],[129340,129349],[129351,129535],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784]],t1e=[836,[2392,2399],[2524,2525],2527,2611,2614,[2649,2651],2654,[2908,2909],3907,3917,3922,3927,3932,3945,3955,[3957,3958],3960,3969,3987,3997,4002,4007,4012,4025,10972,64285,64287,[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64334],[119134,119140],[119227,119232]],n1e=[[192,197],[199,207],[209,214],[217,221],[224,229],[231,239],[241,246],[249,253],[255,271],[274,293],[296,304],[308,311],[313,318],[323,328],[332,337],[340,357],[360,382],[416,417],[431,432],[461,476],[478,483],[486,496],[500,501],[504,539],[542,543],[550,563],836,[901,902],[904,906],908,[910,912],[938,944],[970,974],[979,980],[1024,1025],1027,1031,[1036,1038],1049,1081,[1104,1105],1107,1111,[1116,1118],[1142,1143],[1217,1218],[1232,1235],[1238,1239],[1242,1247],[1250,1255],[1258,1269],[1272,1273],[1570,1574],1728,1730,1747,2345,2353,2356,[2392,2399],[2507,2508],[2524,2525],2527,2611,2614,[2649,2651],2654,2888,[2891,2892],[2908,2909],2964,[3018,3020],3144,3264,[3271,3272],[3274,3275],[3402,3404],3546,[3548,3550],3907,3917,3922,3927,3932,3945,3955,[3957,3958],3960,3969,3987,3997,4002,4007,4012,4025,4134,6918,6920,6922,6924,6926,6930,6971,6973,[6976,6977],6979,[7680,7833],7835,[7840,7929],[7936,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],[8129,8132],[8134,8147],[8150,8155],[8157,8174],[8178,8180],[8182,8188],8491,[8602,8603],8622,[8653,8655],8708,8713,8716,8740,8742,8769,8772,8775,8777,8800,8802,[8813,8817],[8820,8821],[8824,8825],[8832,8833],[8836,8837],[8840,8841],[8876,8879],[8928,8931],[8938,8941],10972,12364,12366,12368,12370,12372,12374,12376,12378,12380,12382,12384,12386,12389,12391,12393,[12400,12401],[12403,12404],[12406,12407],[12409,12410],[12412,12413],12436,12446,12460,12462,12464,12466,12468,12470,12472,12474,12476,12478,12480,12482,12485,12487,12489,[12496,12497],[12499,12500],[12502,12503],[12505,12506],[12508,12509],12532,[12535,12538],12542,[44032,55203],64285,64287,[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64334],69786,69788,69803,[69934,69935],[70475,70476],[70843,70844],70846,[71098,71099],71992,[119134,119140],[119227,119232]],r1e=[168,175,180,184,[188,190],[306,307],[319,320],329,[452,460],[497,499],[728,733],836,890,[900,901],1415,[1653,1656],[2392,2399],[2524,2525],2527,2611,2614,[2649,2651],2654,[2908,2909],3635,3763,[3804,3805],3907,3917,3922,3927,3932,3945,3955,[3957,3961],3969,3987,3997,4002,4007,4012,4025,7834,8125,[8127,8129],[8141,8143],[8157,8159],[8173,8174],[8189,8190],8215,[8229,8230],[8243,8244],[8246,8247],8252,8254,[8263,8265],8279,8360,[8448,8449],8451,[8453,8454],8457,8470,[8480,8482],8507,[8528,8543],[8545,8547],[8549,8552],[8554,8555],[8561,8563],[8565,8568],[8570,8571],8585,[8748,8749],[8751,8752],[9321,9397],10764,[10868,10870],10972,[12443,12444],12447,12543,[12800,12830],[12832,12867],[12880,12895],[12924,12925],[12977,13007],[13055,13311],[64256,64262],[64275,64279],64285,64287,[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335],64477,[64490,64507],[64512,64829],[64848,64911],[64914,64967],[65008,65020],65049,65072,[65097,65100],[65136,65138],65140,[65142,65151],[65269,65276],65507,[119134,119140],[119227,119232],[127232,127242],[127248,127274],[127277,127278],[127306,127311],[127338,127340],127376,[127488,127489],[127552,127560]],i1e=[168,175,180,184,[188,190],[192,197],[199,207],[209,214],[217,221],[224,229],[231,239],[241,246],[249,253],[255,271],[274,293],[296,304],[306,311],[313,320],[323,329],[332,337],[340,357],[360,382],[416,417],[431,432],[452,476],[478,483],[486,501],[504,539],[542,543],[550,563],[728,733],836,890,[900,902],[904,906],908,[910,912],[938,944],[970,974],[979,980],[1024,1025],1027,1031,[1036,1038],1049,1081,[1104,1105],1107,1111,[1116,1118],[1142,1143],[1217,1218],[1232,1235],[1238,1239],[1242,1247],[1250,1255],[1258,1269],[1272,1273],1415,[1570,1574],[1653,1656],1728,1730,1747,2345,2353,2356,[2392,2399],[2507,2508],[2524,2525],2527,2611,2614,[2649,2651],2654,2888,[2891,2892],[2908,2909],2964,[3018,3020],3144,3264,[3271,3272],[3274,3275],[3402,3404],3546,[3548,3550],3635,3763,[3804,3805],3907,3917,3922,3927,3932,3945,3955,[3957,3961],3969,3987,3997,4002,4007,4012,4025,4134,6918,6920,6922,6924,6926,6930,6971,6973,[6976,6977],6979,[7680,7835],[7840,7929],[7936,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8125],[8127,8132],[8134,8147],[8150,8155],[8157,8174],[8178,8180],[8182,8190],8215,[8229,8230],[8243,8244],[8246,8247],8252,8254,[8263,8265],8279,8360,[8448,8449],8451,[8453,8454],8457,8470,[8480,8482],8491,8507,[8528,8543],[8545,8547],[8549,8552],[8554,8555],[8561,8563],[8565,8568],[8570,8571],8585,[8602,8603],8622,[8653,8655],8708,8713,8716,8740,8742,[8748,8749],[8751,8752],8769,8772,8775,8777,8800,8802,[8813,8817],[8820,8821],[8824,8825],[8832,8833],[8836,8837],[8840,8841],[8876,8879],[8928,8931],[8938,8941],[9321,9397],10764,[10868,10870],10972,12364,12366,12368,12370,12372,12374,12376,12378,12380,12382,12384,12386,12389,12391,12393,[12400,12401],[12403,12404],[12406,12407],[12409,12410],[12412,12413],12436,[12443,12444],[12446,12447],12460,12462,12464,12466,12468,12470,12472,12474,12476,12478,12480,12482,12485,12487,12489,[12496,12497],[12499,12500],[12502,12503],[12505,12506],[12508,12509],12532,[12535,12538],[12542,12543],[12800,12830],[12832,12867],[12880,12895],[12910,12926],[12977,13007],[13055,13311],[44032,55203],[64256,64262],[64275,64279],64285,64287,[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335],[64420,64421],[64432,64433],64477,[64490,64507],[64512,64829],[64848,64911],[64914,64967],[65008,65020],65049,65072,[65097,65100],[65136,65138],65140,[65142,65151],[65153,65164],[65269,65276],65507,69786,69788,69803,[69934,69935],[70475,70476],[70843,70844],70846,[71098,71099],71992,[119134,119140],[119227,119232],[127232,127242],[127248,127274],[127277,127278],[127306,127311],[127338,127340],127376,[127488,127489],127507,[127552,127560]],o1e=[169,174,8252,8265,8482,8505,[8596,8601],[8617,8618],[8986,8987],9e3,9096,9167,[9193,9203],[9208,9210],9410,[9642,9643],9654,9664,[9723,9726],[9728,9733],[9735,9746],[9748,9861],[9872,9989],[9992,10002],10004,10006,10013,10017,10024,[10035,10036],10052,10055,10060,10062,[10067,10069],10071,[10083,10087],[10133,10135],10145,10160,10175,[10548,10549],[11013,11015],[11035,11036],11088,11093,12336,12349,12951,12953,[126976,127231],[127245,127247],127279,[127340,127345],[127358,127359],127374,[127377,127386],[127405,127461],[127489,127503],127514,127535,[127538,127546],[127548,127551],[127561,127994],[128e3,128317],[128326,128591],[128640,128767],[128884,128895],[128981,129023],[129036,129039],[129096,129103],[129114,129119],[129160,129167],[129198,129279],[129292,129338],[129340,129349],[129351,129791],[130048,131069]],s1e=[183,[720,721],1600,2042,2901,3654,3782,6154,6211,6823,7222,7291,12293,[12337,12341],[12445,12446],[12540,12542],40981,42508,43471,43494,43632,43741,[43763,43764],65392,[67457,67458],70493,[71110,71112],72344,[92994,92995],[94176,94177],94179,[123196,123197],[125252,125254]],a1e=[[832,833],[835,836],884,894,903,[2392,2399],[2524,2525],2527,2611,2614,[2649,2651],2654,[2908,2909],3907,3917,3922,3927,3932,3945,3955,[3957,3958],3960,3969,3987,3997,4002,4007,4012,4025,8049,8051,8053,8055,8057,8059,8061,8123,8126,8137,8139,8147,8155,8163,8171,[8174,8175],8185,8187,8189,[8192,8193],8486,[8490,8491],[9001,9002],10972,[63744,64013],64016,64018,[64021,64030],64032,64034,[64037,64038],[64042,64109],[64112,64217],64285,64287,[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64334],[119134,119140],[119227,119232],[194560,195101]],l1e=[[32,126],[160,172],[174,767],[880,887],[890,895],[900,906],908,[910,929],[931,1154],[1162,1327],[1329,1366],[1369,1418],[1421,1423],1470,1472,1475,1478,[1488,1514],[1519,1524],[1542,1551],1563,[1565,1610],[1632,1647],[1649,1749],1758,[1765,1766],1769,[1774,1805],1808,[1810,1839],[1869,1957],1969,[1984,2026],[2036,2042],[2046,2069],2074,2084,2088,[2096,2110],[2112,2136],2142,[2144,2154],[2160,2190],[2208,2249],[2307,2361],2363,[2365,2368],[2377,2380],[2382,2384],[2392,2401],[2404,2432],[2434,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,[2495,2496],[2503,2504],[2507,2508],2510,[2524,2525],[2527,2529],[2534,2557],2563,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2622,2624],[2649,2652],2654,[2662,2671],[2674,2676],2678,2691,[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2749,2752],2761,[2763,2764],2768,[2784,2785],[2790,2801],2809,[2818,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,2880,[2887,2888],[2891,2892],[2908,2909],[2911,2913],[2918,2935],2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3007,[3009,3010],[3014,3016],[3018,3020],3024,[3046,3066],[3073,3075],[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3137,3140],[3160,3162],3165,[3168,3169],[3174,3183],[3191,3200],[3202,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3261,3262],[3264,3265],[3267,3268],[3271,3272],[3274,3275],[3293,3294],[3296,3297],[3302,3311],[3313,3315],[3330,3340],[3342,3344],[3346,3386],3389,[3391,3392],[3398,3400],[3402,3404],[3406,3407],[3412,3414],[3416,3425],[3430,3455],[3458,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3536,3537],[3544,3550],[3558,3567],[3570,3572],[3585,3632],[3634,3635],[3647,3654],[3663,3675],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3760],[3762,3763],3773,[3776,3780],3782,[3792,3801],[3804,3807],[3840,3863],[3866,3892],3894,3896,[3898,3911],[3913,3948],3967,3973,[3976,3980],[4030,4037],[4039,4044],[4046,4058],[4096,4140],4145,4152,[4155,4156],[4159,4183],[4186,4189],[4193,4208],[4213,4225],[4227,4228],[4231,4236],[4238,4252],[4254,4293],4295,4301,[4304,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4960,4988],[4992,5017],[5024,5109],[5112,5117],[5120,5788],[5792,5880],[5888,5905],5909,[5919,5937],[5940,5942],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6070,[6078,6085],[6087,6088],[6100,6108],[6112,6121],[6128,6137],[6144,6154],[6160,6169],[6176,6264],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6435,6438],[6441,6443],[6448,6449],[6451,6456],6464,[6468,6509],[6512,6516],[6528,6571],[6576,6601],[6608,6618],[6622,6678],[6681,6682],[6686,6741],6743,6753,[6755,6756],[6765,6770],[6784,6793],[6800,6809],[6816,6829],[6916,6963],6971,[6973,6977],[6979,6988],[6992,7018],[7028,7038],[7042,7073],[7078,7079],7082,[7086,7141],7143,[7146,7148],7150,[7154,7155],[7164,7211],[7220,7221],[7227,7241],[7245,7304],[7312,7354],[7357,7367],7379,7393,[7401,7404],[7406,7411],[7413,7415],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8132],[8134,8147],[8150,8155],[8157,8175],[8178,8180],[8182,8190],[8192,8202],[8208,8231],[8239,8287],[8304,8305],[8308,8334],[8336,8348],[8352,8384],[8448,8587],[8592,9254],[9280,9290],[9312,11123],[11126,11157],[11159,11502],[11506,11507],[11513,11557],11559,11565,[11568,11623],[11631,11632],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[11776,11869],[11904,11929],[11931,12019],[12032,12245],[12272,12283],[12288,12329],[12336,12351],[12353,12438],[12443,12543],[12549,12591],[12593,12686],[12688,12771],[12784,12830],[12832,42124],[42128,42182],[42192,42539],[42560,42606],42611,[42622,42653],[42656,42735],[42738,42743],[42752,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43044],[43047,43051],[43056,43065],[43072,43127],[43136,43203],[43214,43225],[43250,43262],[43264,43301],[43310,43334],[43346,43347],[43359,43388],[43395,43442],[43444,43445],[43450,43451],[43454,43469],[43471,43481],[43486,43492],[43494,43518],[43520,43560],[43567,43568],[43571,43572],[43584,43586],[43588,43595],43597,[43600,43609],[43612,43643],[43645,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43755],[43758,43765],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43883],[43888,44004],[44006,44007],[44009,44012],[44016,44025],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],64285,[64287,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64450],[64467,64911],[64914,64967],64975,[65008,65023],[65040,65049],[65072,65106],[65108,65126],[65128,65131],[65136,65140],[65142,65276],[65281,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65504,65510],[65512,65518],[65532,65533],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65792,65794],[65799,65843],[65847,65934],[65936,65948],65952,[66e3,66044],[66176,66204],[66208,66256],[66273,66299],[66304,66339],[66349,66378],[66384,66421],[66432,66461],[66463,66499],[66504,66517],[66560,66717],[66720,66729],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66927,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67671,67742],[67751,67759],[67808,67826],[67828,67829],[67835,67867],[67871,67897],67903,[67968,68023],[68028,68047],[68050,68096],[68112,68115],[68117,68119],[68121,68149],[68160,68168],[68176,68184],[68192,68255],[68288,68324],[68331,68342],[68352,68405],[68409,68437],[68440,68466],[68472,68497],[68505,68508],[68521,68527],[68608,68680],[68736,68786],[68800,68850],[68858,68899],[68912,68921],[69216,69246],[69248,69289],69293,[69296,69297],[69376,69415],[69424,69445],[69457,69465],[69488,69505],[69510,69513],[69552,69579],[69600,69622],69632,[69634,69687],[69703,69709],[69714,69743],[69745,69746],69749,[69762,69810],[69815,69816],[69819,69820],[69822,69825],[69840,69864],[69872,69881],[69891,69926],69932,[69942,69959],[69968,70002],[70004,70006],[70018,70069],[70079,70088],[70093,70094],[70096,70111],[70113,70132],[70144,70161],[70163,70190],[70194,70195],70197,[70200,70205],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70313],[70320,70366],[70368,70370],[70384,70393],[70402,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70463,[70465,70468],[70471,70472],[70475,70477],70480,[70493,70499],[70656,70711],[70720,70721],70725,[70727,70747],70749,[70751,70753],[70784,70831],[70833,70834],70841,[70843,70844],70846,70849,[70852,70855],[70864,70873],[71040,71086],[71088,71089],[71096,71099],71102,[71105,71131],[71168,71218],[71227,71228],71230,[71233,71236],[71248,71257],[71264,71276],[71296,71338],71340,[71342,71343],71350,[71352,71353],[71360,71369],[71424,71450],[71456,71457],71462,[71472,71494],[71680,71726],71736,71739,[71840,71922],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],[71985,71989],[71991,71992],71997,[71999,72002],[72004,72006],[72016,72025],[72096,72103],[72106,72147],[72156,72159],[72161,72164],72192,[72203,72242],[72249,72250],[72255,72262],72272,[72279,72280],[72284,72329],72343,[72346,72354],[72368,72440],[72448,72457],[72704,72712],[72714,72751],72766,[72768,72773],[72784,72812],[72816,72847],72873,72881,72884,[72960,72966],[72968,72969],[72971,73008],73030,[73040,73049],[73056,73061],[73063,73064],[73066,73102],[73107,73108],73110,73112,[73120,73129],[73440,73458],[73461,73464],[73474,73488],[73490,73525],[73534,73535],73537,[73539,73561],73648,[73664,73713],[73727,74649],[74752,74862],[74864,74868],[74880,75075],[77712,77810],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92768,92777],[92782,92862],[92864,92873],[92880,92909],92917,[92928,92975],[92983,92997],[93008,93017],[93019,93025],[93027,93047],[93053,93071],[93760,93850],[93952,94026],[94032,94087],[94099,94111],[94176,94179],[94192,94193],[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],113820,113823,[118608,118723],[118784,119029],[119040,119078],[119081,119140],119142,[119146,119149],[119171,119172],[119180,119209],[119214,119274],[119296,119361],119365,[119488,119507],[119520,119539],[119552,119638],[119648,119672],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120782,121343],[121399,121402],[121453,121460],[121462,121475],[121477,121483],[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],[123200,123209],[123214,123215],[123536,123565],[123584,123627],[123632,123641],123647,[124112,124139],[124144,124153],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125127,125135],[125184,125251],125259,[125264,125273],[125278,125279],[126065,126132],[126209,126269],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[126704,126705],[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127232,127405],[127462,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994],[130032,130041],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],u1e=[[768,879],[1155,1161],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],2045,[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2200,2207],[2250,2273],[2275,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2433,2492,2494,[2497,2500],2509,2519,[2530,2531],2558,[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,[2878,2879],[2881,2884],2893,[2901,2903],[2914,2915],2946,3006,3008,3021,3031,3072,3076,3132,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,3263,3266,3270,[3276,3277],[3285,3286],[3298,3299],[3328,3329],[3387,3388],3390,[3393,3396],3405,3415,[3426,3427],3457,3530,3535,[3538,3540],3542,3551,3633,[3636,3642],[3655,3662],3761,[3764,3772],[3784,3790],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,[4957,4959],[5906,5908],[5938,5939],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6109,[6155,6157],6159,[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,[6832,6862],[6912,6915],[6964,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7679],8204,[8400,8432],[11503,11505],11647,[11744,11775],[12330,12335],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43045,43046],43052,[43204,43205],[43232,43249],43263,[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],[43452,43453],43493,[43561,43566],[43569,43570],[43573,43574],43587,43596,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,[43756,43757],43766,44005,44008,44013,64286,[65024,65039],[65056,65071],[65438,65439],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],69633,[69688,69702],69744,[69747,69748],[69759,69761],[69811,69814],[69817,69818],69826,[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70089,70092],70095,[70191,70193],70196,[70198,70199],70206,70209,70367,[70371,70378],[70400,70401],[70459,70460],70462,70464,70487,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,70750,70832,[70835,70840],70842,70845,[70847,70848],[70850,70851],71087,[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[71727,71735],[71737,71738],71984,[71995,71996],71998,72003,[72148,72151],[72154,72155],72160,[72193,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],72767,[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73104,73105],73109,73111,[73459,73460],[73472,73473],[73526,73530],73536,73538,78912,[78919,78933],[92912,92916],[92976,92982],94031,[94095,94098],94180,[113821,113822],[118528,118573],[118576,118598],119141,[119143,119145],[119150,119154],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,[123184,123190],123566,[123628,123631],[124140,124143],[125136,125142],[125252,125258],[917536,917631],[917760,917999]],c1e=[2381,2509,2637,2765,2893,3021,3149,3277,[3387,3388],3405,3530,3642,3770,3972,[4153,4154],[5908,5909],5940,6098,6752,6980,[7082,7083],[7154,7155],11647,43014,43052,43204,43347,43456,43766,44013,68159,69702,69744,69759,69817,[69939,69940],70080,70197,70378,70477,70722,70850,71103,71231,71350,71467,71737,[71997,71998],72160,72244,72263,72345,72767,[73028,73029],73111,[73537,73538]],d1e=[[48,57],[65,70],[97,102],[65296,65305],[65313,65318],[65345,65350]],h1e=[45,173,1418,6150,[8208,8209],11799,12539,65123,65293,65381],f1e=[[12272,12273],[12276,12283]],m1e=[[12274,12275]],p1e=[[48,57],[65,90],95,[97,122],170,181,183,186,[192,214],[216,246],[248,705],[710,721],[736,740],748,750,[768,884],[886,887],[890,893],895,[902,906],908,[910,929],[931,1013],[1015,1153],[1155,1159],[1162,1327],[1329,1366],1369,[1376,1416],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1488,1514],[1519,1522],[1552,1562],[1568,1641],[1646,1747],[1749,1756],[1759,1768],[1770,1788],1791,[1808,1866],[1869,1969],[1984,2037],2042,2045,[2048,2093],[2112,2139],[2144,2154],[2160,2183],[2185,2190],[2200,2273],[2275,2403],[2406,2415],[2417,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2492,2500],[2503,2504],[2507,2510],2519,[2524,2525],[2527,2531],[2534,2545],2556,2558,[2561,2563],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2649,2652],2654,[2662,2677],[2689,2691],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2748,2757],[2759,2761],[2763,2765],2768,[2784,2787],[2790,2799],[2809,2815],[2817,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2876,2884],[2887,2888],[2891,2893],[2901,2903],[2908,2909],[2911,2915],[2918,2927],2929,[2946,2947],[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3010],[3014,3016],[3018,3021],3024,3031,[3046,3055],[3072,3084],[3086,3088],[3090,3112],[3114,3129],[3132,3140],[3142,3144],[3146,3149],[3157,3158],[3160,3162],3165,[3168,3171],[3174,3183],[3200,3203],[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3260,3268],[3270,3272],[3274,3277],[3285,3286],[3293,3294],[3296,3299],[3302,3311],[3313,3315],[3328,3340],[3342,3344],[3346,3396],[3398,3400],[3402,3406],[3412,3415],[3423,3427],[3430,3439],[3450,3455],[3457,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3530,[3535,3540],3542,[3544,3551],[3558,3567],[3570,3571],[3585,3642],[3648,3662],[3664,3673],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3773],[3776,3780],3782,[3784,3790],[3792,3801],[3804,3807],3840,[3864,3865],[3872,3881],3893,3895,3897,[3902,3911],[3913,3948],[3953,3972],[3974,3991],[3993,4028],4038,[4096,4169],[4176,4253],[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4957,4959],[4969,4977],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5909],[5919,5940],[5952,5971],[5984,5996],[5998,6e3],[6002,6003],[6016,6099],6103,[6108,6109],[6112,6121],[6155,6157],[6159,6169],[6176,6264],[6272,6314],[6320,6389],[6400,6430],[6432,6443],[6448,6459],[6470,6509],[6512,6516],[6528,6571],[6576,6601],[6608,6618],[6656,6683],[6688,6750],[6752,6780],[6783,6793],[6800,6809],6823,[6832,6845],[6847,6862],[6912,6988],[6992,7001],[7019,7027],[7040,7155],[7168,7223],[7232,7241],[7245,7293],[7296,7304],[7312,7354],[7357,7359],[7376,7378],[7380,7418],[7424,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],[8255,8256],8276,8305,8319,[8336,8348],[8400,8412],8417,[8421,8432],8450,8455,[8458,8467],8469,[8472,8477],8484,8486,8488,[8490,8505],[8508,8511],[8517,8521],8526,[8544,8584],[11264,11492],[11499,11507],[11520,11557],11559,11565,[11568,11623],11631,[11647,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[11744,11775],[12293,12295],[12321,12335],[12337,12341],[12344,12348],[12353,12438],[12441,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,42124],[42192,42237],[42240,42508],[42512,42539],[42560,42607],[42612,42621],[42623,42737],[42775,42783],[42786,42888],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43047],43052,[43072,43123],[43136,43205],[43216,43225],[43232,43255],43259,[43261,43309],[43312,43347],[43360,43388],[43392,43456],[43471,43481],[43488,43518],[43520,43574],[43584,43597],[43600,43609],[43616,43638],[43642,43714],[43739,43741],[43744,43759],[43762,43766],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43866],[43868,43881],[43888,44010],[44012,44013],[44016,44025],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],[64285,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65024,65039],[65056,65071],[65075,65076],[65101,65103],[65136,65140],[65142,65276],[65296,65305],[65313,65338],65343,[65345,65370],[65382,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65856,65908],66045,[66176,66204],[66208,66256],66272,[66304,66335],[66349,66378],[66384,66426],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66720,66729],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],[68096,68099],[68101,68102],[68108,68115],[68117,68119],[68121,68149],[68152,68154],68159,[68192,68220],[68224,68252],[68288,68295],[68297,68326],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68903],[68912,68921],[69248,69289],[69291,69292],[69296,69297],[69373,69404],69415,[69424,69456],[69488,69509],[69552,69572],[69600,69622],[69632,69702],[69734,69749],[69759,69818],69826,[69840,69864],[69872,69881],[69888,69940],[69942,69951],[69956,69959],[69968,70003],70006,[70016,70084],[70089,70092],[70094,70106],70108,[70144,70161],[70163,70199],[70206,70209],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70378],[70384,70393],[70400,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70459,70468],[70471,70472],[70475,70477],70480,70487,[70493,70499],[70502,70508],[70512,70516],[70656,70730],[70736,70745],[70750,70753],[70784,70853],70855,[70864,70873],[71040,71093],[71096,71104],[71128,71133],[71168,71232],71236,[71248,71257],[71296,71352],[71360,71369],[71424,71450],[71453,71467],[71472,71481],[71488,71494],[71680,71738],[71840,71913],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],[71995,72003],[72016,72025],[72096,72103],[72106,72151],[72154,72161],[72163,72164],[72192,72254],72263,[72272,72345],72349,[72368,72440],[72704,72712],[72714,72758],[72760,72768],[72784,72793],[72818,72847],[72850,72871],[72873,72886],[72960,72966],[72968,72969],[72971,73014],73018,[73020,73021],[73023,73031],[73040,73049],[73056,73061],[73063,73064],[73066,73102],[73104,73105],[73107,73112],[73120,73129],[73440,73462],[73472,73488],[73490,73530],[73534,73538],[73552,73561],73648,[73728,74649],[74752,74862],[74880,75075],[77712,77808],[77824,78895],[78912,78933],[82944,83526],[92160,92728],[92736,92766],[92768,92777],[92784,92862],[92864,92873],[92880,92909],[92912,92916],[92928,92982],[92992,92995],[93008,93017],[93027,93047],[93053,93071],[93760,93823],[93952,94026],[94031,94087],[94095,94111],[94176,94177],[94179,94180],[94192,94193],[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[113821,113822],[118528,118573],[118576,118598],[119141,119145],[119149,119154],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[120782,120831],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122624,122654],[122661,122666],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[122928,122989],123023,[123136,123180],[123184,123197],[123200,123209],123214,[123536,123566],[123584,123641],[124112,124153],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125136,125142],[125184,125259],[125264,125273],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[130032,130041],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743],[917760,917999]],g1e=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,705],[710,721],[736,740],748,750,[880,884],[886,887],[890,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],1369,[1376,1416],[1488,1514],[1519,1522],[1568,1610],[1646,1647],[1649,1747],1749,[1765,1766],[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2036,2037],2042,[2048,2069],2074,2084,2088,[2112,2136],[2144,2154],[2160,2183],[2185,2190],[2208,2249],[2308,2361],2365,2384,[2392,2401],[2417,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],3165,[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,[3293,3294],[3296,3297],[3313,3314],[3332,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],[3634,3635],[3648,3654],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3760],[3762,3763],3773,[3776,3780],3782,[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5905],[5919,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6103,6108,[6176,6264],[6272,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],6823,[6917,6963],[6981,6988],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7293],[7296,7304],[7312,7354],[7357,7359],[7401,7404],[7406,7411],[7413,7414],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8472,8477],8484,8486,8488,[8490,8505],[8508,8511],[8517,8521],8526,[8544,8584],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[11568,11623],11631,[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[12293,12295],[12321,12329],[12337,12341],[12344,12348],[12353,12438],[12443,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,42124],[42192,42237],[42240,42508],[42512,42527],[42538,42539],[42560,42606],[42623,42653],[42656,42735],[42775,42783],[42786,42888],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,[43261,43262],[43274,43301],[43312,43334],[43360,43388],[43396,43442],43471,[43488,43492],[43494,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43741],[43744,43754],[43762,43764],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43866],[43868,43881],[43888,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65313,65338],[65345,65370],[65382,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65856,65908],[66176,66204],[66208,66256],[66304,66335],[66349,66378],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68149],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68899],[69248,69289],[69296,69297],[69376,69404],69415,[69424,69445],[69488,69505],[69552,69572],[69600,69622],[69635,69687],[69745,69746],69749,[69763,69807],[69840,69864],[69891,69926],69956,69959,[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70751,70753],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],71352,[71424,71450],[71488,71494],[71680,71723],[71840,71903],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],71999,72001,[72096,72103],[72106,72144],72161,72163,72192,[72203,72242],72250,72272,[72284,72329],72349,[72368,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73056,73061],[73063,73064],[73066,73097],73112,[73440,73458],73474,[73476,73488],[73490,73523],73648,[73728,74649],[74752,74862],[74880,75075],[77712,77808],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[92992,92995],[93027,93047],[93053,93071],[93760,93823],[93952,94026],94032,[94099,94111],[94176,94177],94179,[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],123214,[123536,123565],[123584,123627],[124112,124139],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125184,125251],125259,[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],v1e=[[12294,12295],[12321,12329],[12344,12346],[13312,19903],[19968,40959],[63744,64109],[64112,64217],94180,[94208,100343],[100352,101589],[101632,101640],[110960,111355],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],_1e=[[8204,8205]],b1e=[[3648,3652],[3776,3780],[6581,6583],6586,[43701,43702],43705,[43707,43708]],C1e=[[97,122],170,181,186,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,[311,312],314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,[396,397],402,405,[409,411],414,417,419,421,424,[426,427],429,432,436,438,[441,442],[445,447],454,457,460,462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,496],499,501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,545,547,549,551,553,555,557,559,561,[563,569],572,[575,576],578,583,585,587,589,[591,659],[661,696],[704,705],[736,740],837,881,883,887,[890,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,[1019,1020],[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1376,1416],[4304,4346],[4348,4351],[5112,5117],[7296,7304],[7424,7615],7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7837],7839,7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8071],[8080,8087],[8096,8103],[8112,8116],[8118,8119],8126,[8130,8132],[8134,8135],[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8305,8319,[8336,8348],8458,[8462,8463],8467,8495,8500,8505,[8508,8509],[8518,8521],8526,[8560,8575],8580,[9424,9449],[11312,11359],11361,[11365,11366],11368,11370,11372,11377,[11379,11380],[11382,11389],11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,[11491,11492],11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,42581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,[42651,42653],42787,42789,42791,42793,42795,42797,[42799,42801],42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,[42863,42872],42874,42876,42879,42881,42883,42885,42887,42892,42894,42897,[42899,42901],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42927,42933,42935,42937,42939,42941,42943,42945,42947,42952,42954,42961,42963,42965,42967,42969,[42994,42996],42998,[43e3,43002],[43824,43866],[43868,43881],[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[66967,66977],[66979,66993],[66995,67001],[67003,67004],67456,[67459,67461],[67463,67504],[67506,67514],[68800,68850],[71872,71903],[93792,93823],[119834,119859],[119886,119892],[119894,119911],[119938,119963],[119990,119993],119995,[119997,120003],[120005,120015],[120042,120067],[120094,120119],[120146,120171],[120198,120223],[120250,120275],[120302,120327],[120354,120379],[120406,120431],[120458,120485],[120514,120538],[120540,120545],[120572,120596],[120598,120603],[120630,120654],[120656,120661],[120688,120712],[120714,120719],[120746,120770],[120772,120777],120779,[122624,122633],[122635,122654],[122661,122666],[122928,122989],[125218,125251]],y1e=[43,[60,62],94,124,126,172,177,215,247,[976,978],981,[1008,1009],[1012,1014],[1542,1544],8214,[8242,8244],8256,8260,8274,[8289,8292],[8314,8318],[8330,8334],[8400,8412],8417,[8421,8422],[8427,8431],8450,8455,[8458,8467],8469,[8472,8477],8484,[8488,8489],[8492,8493],[8495,8497],[8499,8504],[8508,8521],8523,[8592,8615],[8617,8622],[8624,8625],[8630,8631],[8636,8667],8669,[8676,8677],[8692,8959],[8968,8971],[8992,8993],9084,[9115,9141],9143,9168,[9180,9186],[9632,9633],[9646,9655],[9660,9665],[9670,9671],[9674,9675],[9679,9683],9698,9700,[9703,9708],[9720,9727],[9733,9734],9792,9794,[9824,9827],[9837,9839],[10176,10239],[10496,11007],[11056,11076],[11079,11084],64297,[65121,65126],65128,65291,[65308,65310],65340,65342,65372,65374,65506,[65513,65516],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120782,120831],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[126704,126705]],S1e=[[64976,65007],[65534,65535],[131070,131071],[196606,196607],[262142,262143],[327678,327679],[393214,393215],[458750,458751],[524286,524287],[589822,589823],[655358,655359],[720894,720895],[786430,786431],[851966,851967],[917502,917503],[983038,983039],[1048574,1048575],[1114110,1114111]],E1e=[837,[1456,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1623],[1625,1631],1648,[1750,1756],[1761,1764],[1767,1768],1773,1809,[1840,1855],[1958,1968],[2070,2071],[2075,2083],[2085,2087],[2089,2092],[2260,2271],[2275,2281],[2288,2307],[2362,2363],[2366,2380],[2382,2383],[2389,2391],[2402,2403],[2433,2435],[2494,2500],[2503,2504],[2507,2508],2519,[2530,2531],[2561,2563],[2622,2626],[2631,2632],[2635,2636],2641,[2672,2673],2677,[2689,2691],[2750,2757],[2759,2761],[2763,2764],[2786,2787],[2810,2812],[2817,2819],[2878,2884],[2887,2888],[2891,2892],[2902,2903],[2914,2915],2946,[3006,3010],[3014,3016],[3018,3020],3031,[3072,3076],[3134,3140],[3142,3144],[3146,3148],[3157,3158],[3170,3171],[3201,3203],[3262,3268],[3270,3272],[3274,3276],[3285,3286],[3298,3299],3315,[3328,3331],[3390,3396],[3398,3400],[3402,3404],3415,[3426,3427],[3457,3459],[3535,3540],3542,[3544,3551],[3570,3571],3633,[3636,3642],3661,3761,[3764,3769],[3771,3772],3789,[3953,3971],[3981,3991],[3993,4028],[4139,4150],4152,[4155,4158],[4182,4185],[4190,4192],[4194,4196],[4199,4205],[4209,4212],[4226,4237],4239,[4250,4253],[5906,5907],[5938,5939],[5970,5971],[6002,6003],[6070,6088],[6277,6278],6313,[6432,6443],[6448,6456],[6679,6683],[6741,6750],[6753,6772],[6847,6848],[6860,6862],[6912,6916],[6965,6979],[7040,7042],[7073,7081],[7084,7085],[7143,7153],[7204,7222],[7655,7668],[9398,9449],[11744,11775],[42612,42619],[42654,42655],43010,43019,[43043,43047],[43136,43137],[43188,43203],43205,43263,[43302,43306],[43335,43346],[43392,43395],[43444,43455],43493,[43561,43574],43587,[43596,43597],[43643,43645],43696,[43698,43700],[43703,43704],43710,[43755,43759],43765,[44003,44010],64286,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68900,68903],[69291,69292],[69632,69634],[69688,69701],[69747,69748],[69760,69762],[69808,69816],69826,[69888,69890],[69927,69938],[69957,69958],[70016,70018],[70067,70079],[70094,70095],[70188,70196],70199,70206,70209,[70367,70376],[70400,70403],[70462,70468],[70471,70472],[70475,70476],70487,[70498,70499],[70709,70721],[70723,70725],[70832,70849],[71087,71093],[71096,71102],[71132,71133],[71216,71230],71232,[71339,71349],[71453,71466],[71724,71736],[71984,71989],[71991,71992],[71995,71996],72e3,72002,[72145,72151],[72154,72159],72164,[72193,72202],[72245,72249],[72251,72254],[72273,72283],[72330,72343],[72751,72758],[72760,72766],[72850,72871],[72873,72886],[73009,73014],73018,[73020,73021],[73023,73025],73027,73031,[73098,73102],[73104,73105],[73107,73110],[73459,73462],[73472,73473],73475,[73524,73530],[73534,73536],94031,[94033,94087],[94095,94098],[94192,94193],113822,[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,125255,[127280,127305],[127312,127337],[127344,127369]],w1e=[847,[4447,4448],[6068,6069],8293,12644,65440,[65520,65528],917504,[917506,917535],[917632,917759],[918e3,921599]],R1e=[2494,2519,2878,2903,3006,3031,3266,[3285,3286],3390,3415,3535,3551,6965,8204,[12334,12335],[65438,65439],70462,70487,70832,70845,71087,71984,119141,[119150,119154],[917536,917631]],D1e=[183,903,[4969,4977],6618],I1e=[[6277,6278],8472,8494,[12443,12444]],x1e=[170,186,[688,696],[704,705],[736,740],837,890,4348,[7468,7530],7544,[7579,7615],8305,8319,[8336,8348],[8560,8575],[9424,9449],[11388,11389],[42652,42653],42864,[42994,42996],[43e3,43001],[43868,43871],43881,67456,[67459,67461],[67463,67504],[67506,67514],[122928,122989]],M1e=[94,[976,978],981,[1008,1009],[1012,1013],8214,[8242,8244],8256,[8289,8292],[8317,8318],[8333,8334],[8400,8412],8417,[8421,8422],[8427,8431],8450,8455,[8458,8467],8469,[8473,8477],8484,[8488,8489],[8492,8493],[8495,8497],[8499,8504],[8508,8511],[8517,8521],[8597,8601],[8604,8607],[8609,8610],[8612,8613],8615,[8617,8621],[8624,8625],[8630,8631],[8636,8653],[8656,8657],8659,[8661,8667],8669,[8676,8677],[8968,8971],[9140,9141],9143,9168,9186,[9632,9633],[9646,9654],[9660,9664],[9670,9671],[9674,9675],[9679,9683],9698,9700,[9703,9708],[9733,9734],9792,9794,[9824,9827],[9837,9838],[10181,10182],[10214,10223],[10627,10648],[10712,10715],[10748,10749],65121,65123,65128,65340,65342,[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[120782,120831],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651]],O1e=[[8544,8559],[9398,9423],[127280,127305],[127312,127337],[127344,127369]],T1e=[[33,47],[58,64],[91,94],96,[123,126],[161,167],169,[171,172],174,[176,177],182,187,191,215,247,[8208,8231],[8240,8254],[8257,8275],[8277,8286],[8592,9311],[9472,10101],[10132,11263],[11776,11903],[12289,12291],[12296,12320],12336,[64830,64831],[65093,65094]],$1e=[[9,13],32,133,[8206,8207],[8232,8233]],k1e=[[1536,1541],1757,1807,[2192,2193],2274,69821,69837],A1e=[34,39,171,187,[8216,8223],[8249,8250],11842,[12300,12303],[12317,12319],[65089,65092],65282,65287,[65378,65379]],N1e=[[11904,11929],[11931,12019],[12032,12245]],L1e=[[127462,127487]],P1e=[33,46,63,1417,[1565,1567],1748,[1792,1794],2041,2103,2105,[2109,2110],[2404,2405],[4170,4171],4962,[4967,4968],5742,[5941,5942],6147,6153,[6468,6469],[6824,6827],[7002,7003],[7006,7007],[7037,7038],[7227,7228],[7294,7295],[8252,8253],[8263,8265],11822,11836,[11859,11860],12290,42239,[42510,42511],42739,42743,[43126,43127],[43214,43215],43311,[43464,43465],[43613,43615],[43760,43761],44011,65106,[65110,65111],65281,65294,65311,65377,[68182,68183],[69461,69465],[69510,69513],[69703,69704],[69822,69825],[69953,69955],[70085,70086],70093,[70110,70111],[70200,70201],[70203,70204],70313,[70731,70732],[71106,71107],[71113,71127],[71233,71234],[71484,71486],72004,72006,[72258,72259],[72347,72348],[72769,72770],[73463,73464],[73539,73540],[92782,92783],92917,[92983,92984],92996,93848,113823,121480],B1e=[[105,106],303,585,616,669,690,1011,1110,1112,7522,7574,7588,7592,7725,7883,8305,[8520,8521],11388,[119842,119843],[119894,119895],[119946,119947],[119998,119999],[120050,120051],[120102,120103],[120154,120155],[120206,120207],[120258,120259],[120310,120311],[120362,120363],[120414,120415],[120466,120467],122650,[122956,122957],122984],F1e=[33,44,46,[58,59],63,894,903,1417,1475,1548,1563,[1565,1567],1748,[1792,1802],1804,[2040,2041],[2096,2110],2142,[2404,2405],[3674,3675],3848,[3853,3858],[4170,4171],[4961,4968],5742,[5867,5869],[5941,5942],[6100,6102],6106,[6146,6149],[6152,6153],[6468,6469],[6824,6827],[7002,7003],[7005,7007],[7037,7038],[7227,7231],[7294,7295],[8252,8253],[8263,8265],11822,11836,11841,11852,[11854,11855],[11859,11860],[12289,12290],[42238,42239],[42509,42511],[42739,42743],[43126,43127],[43214,43215],43311,[43463,43465],[43613,43615],43743,[43760,43761],44011,[65104,65106],[65108,65111],65281,65292,65294,[65306,65307],65311,65377,65380,66463,66512,67671,67871,[68182,68183],[68336,68341],[68410,68415],[68505,68508],[69461,69465],[69510,69513],[69703,69709],[69822,69825],[69953,69955],[70085,70086],70093,[70110,70111],[70200,70204],70313,[70731,70733],[70746,70747],[71106,71109],[71113,71127],[71233,71234],[71484,71486],72004,72006,[72258,72259],[72347,72348],[72353,72354],[72769,72771],72817,[73463,73464],[73539,73540],[74864,74868],[92782,92783],92917,[92983,92985],92996,[93847,93848],113823,[121479,121482]],U1e=[[13312,19903],[19968,40959],[64014,64015],64017,[64019,64020],64031,64033,[64035,64036],[64039,64041],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[196608,201546],[201552,205743]],H1e=[[65,90],[192,214],[216,222],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,330,332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,452,455,458,461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,497,500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],975,[978,980],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,1012,1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],[4256,4293],4295,4301,[5024,5109],[7312,7354],[7357,7359],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8120,8123],[8136,8139],[8152,8155],[8168,8172],[8184,8187],8450,8455,[8459,8461],[8464,8466],8469,[8473,8477],8484,8486,8488,[8490,8493],[8496,8499],[8510,8511],8517,[8544,8559],8579,[9398,9423],[11264,11311],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,42936,42938,42940,42942,42944,42946,[42948,42951],42953,42960,42966,42968,42997,[65313,65338],[66560,66599],[66736,66771],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[68736,68786],[71840,71871],[93760,93791],[119808,119833],[119860,119885],[119912,119937],119964,[119966,119967],119970,[119973,119974],[119977,119980],[119982,119989],[120016,120041],[120068,120069],[120071,120074],[120077,120084],[120086,120092],[120120,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120172,120197],[120224,120249],[120276,120301],[120328,120353],[120380,120405],[120432,120457],[120488,120512],[120546,120570],[120604,120628],[120662,120686],[120720,120744],120778,[125184,125217],[127280,127305],[127312,127337],[127344,127369]],V1e=[[6155,6157],6159,[65024,65039],[917760,917999]],j1e=[[9,13],32,133,160,5760,[8192,8202],[8232,8233],8239,8287,12288],z1e=[[48,57],[65,90],95,[97,122],170,181,183,186,[192,214],[216,246],[248,705],[710,721],[736,740],748,750,[768,884],[886,887],[891,893],895,[902,906],908,[910,929],[931,1013],[1015,1153],[1155,1159],[1162,1327],[1329,1366],1369,[1376,1416],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1488,1514],[1519,1522],[1552,1562],[1568,1641],[1646,1747],[1749,1756],[1759,1768],[1770,1788],1791,[1808,1866],[1869,1969],[1984,2037],2042,2045,[2048,2093],[2112,2139],[2144,2154],[2160,2183],[2185,2190],[2200,2273],[2275,2403],[2406,2415],[2417,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2492,2500],[2503,2504],[2507,2510],2519,[2524,2525],[2527,2531],[2534,2545],2556,2558,[2561,2563],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2649,2652],2654,[2662,2677],[2689,2691],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2748,2757],[2759,2761],[2763,2765],2768,[2784,2787],[2790,2799],[2809,2815],[2817,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2876,2884],[2887,2888],[2891,2893],[2901,2903],[2908,2909],[2911,2915],[2918,2927],2929,[2946,2947],[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3010],[3014,3016],[3018,3021],3024,3031,[3046,3055],[3072,3084],[3086,3088],[3090,3112],[3114,3129],[3132,3140],[3142,3144],[3146,3149],[3157,3158],[3160,3162],3165,[3168,3171],[3174,3183],[3200,3203],[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3260,3268],[3270,3272],[3274,3277],[3285,3286],[3293,3294],[3296,3299],[3302,3311],[3313,3315],[3328,3340],[3342,3344],[3346,3396],[3398,3400],[3402,3406],[3412,3415],[3423,3427],[3430,3439],[3450,3455],[3457,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3530,[3535,3540],3542,[3544,3551],[3558,3567],[3570,3571],[3585,3642],[3648,3662],[3664,3673],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3773],[3776,3780],3782,[3784,3790],[3792,3801],[3804,3807],3840,[3864,3865],[3872,3881],3893,3895,3897,[3902,3911],[3913,3948],[3953,3972],[3974,3991],[3993,4028],4038,[4096,4169],[4176,4253],[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4957,4959],[4969,4977],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5909],[5919,5940],[5952,5971],[5984,5996],[5998,6e3],[6002,6003],[6016,6099],6103,[6108,6109],[6112,6121],[6155,6157],[6159,6169],[6176,6264],[6272,6314],[6320,6389],[6400,6430],[6432,6443],[6448,6459],[6470,6509],[6512,6516],[6528,6571],[6576,6601],[6608,6618],[6656,6683],[6688,6750],[6752,6780],[6783,6793],[6800,6809],6823,[6832,6845],[6847,6862],[6912,6988],[6992,7001],[7019,7027],[7040,7155],[7168,7223],[7232,7241],[7245,7293],[7296,7304],[7312,7354],[7357,7359],[7376,7378],[7380,7418],[7424,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],[8255,8256],8276,8305,8319,[8336,8348],[8400,8412],8417,[8421,8432],8450,8455,[8458,8467],8469,[8472,8477],8484,8486,8488,[8490,8505],[8508,8511],[8517,8521],8526,[8544,8584],[11264,11492],[11499,11507],[11520,11557],11559,11565,[11568,11623],11631,[11647,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[11744,11775],[12293,12295],[12321,12335],[12337,12341],[12344,12348],[12353,12438],[12441,12442],[12445,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,42124],[42192,42237],[42240,42508],[42512,42539],[42560,42607],[42612,42621],[42623,42737],[42775,42783],[42786,42888],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43047],43052,[43072,43123],[43136,43205],[43216,43225],[43232,43255],43259,[43261,43309],[43312,43347],[43360,43388],[43392,43456],[43471,43481],[43488,43518],[43520,43574],[43584,43597],[43600,43609],[43616,43638],[43642,43714],[43739,43741],[43744,43759],[43762,43766],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43866],[43868,43881],[43888,44010],[44012,44013],[44016,44025],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],[64285,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64605],[64612,64829],[64848,64911],[64914,64967],[65008,65017],[65024,65039],[65056,65071],[65075,65076],[65101,65103],65137,65139,65143,65145,65147,65149,[65151,65276],[65296,65305],[65313,65338],65343,[65345,65370],[65382,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65856,65908],66045,[66176,66204],[66208,66256],66272,[66304,66335],[66349,66378],[66384,66426],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66720,66729],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],[68096,68099],[68101,68102],[68108,68115],[68117,68119],[68121,68149],[68152,68154],68159,[68192,68220],[68224,68252],[68288,68295],[68297,68326],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68903],[68912,68921],[69248,69289],[69291,69292],[69296,69297],[69373,69404],69415,[69424,69456],[69488,69509],[69552,69572],[69600,69622],[69632,69702],[69734,69749],[69759,69818],69826,[69840,69864],[69872,69881],[69888,69940],[69942,69951],[69956,69959],[69968,70003],70006,[70016,70084],[70089,70092],[70094,70106],70108,[70144,70161],[70163,70199],[70206,70209],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70378],[70384,70393],[70400,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70459,70468],[70471,70472],[70475,70477],70480,70487,[70493,70499],[70502,70508],[70512,70516],[70656,70730],[70736,70745],[70750,70753],[70784,70853],70855,[70864,70873],[71040,71093],[71096,71104],[71128,71133],[71168,71232],71236,[71248,71257],[71296,71352],[71360,71369],[71424,71450],[71453,71467],[71472,71481],[71488,71494],[71680,71738],[71840,71913],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],[71995,72003],[72016,72025],[72096,72103],[72106,72151],[72154,72161],[72163,72164],[72192,72254],72263,[72272,72345],72349,[72368,72440],[72704,72712],[72714,72758],[72760,72768],[72784,72793],[72818,72847],[72850,72871],[72873,72886],[72960,72966],[72968,72969],[72971,73014],73018,[73020,73021],[73023,73031],[73040,73049],[73056,73061],[73063,73064],[73066,73102],[73104,73105],[73107,73112],[73120,73129],[73440,73462],[73472,73488],[73490,73530],[73534,73538],[73552,73561],73648,[73728,74649],[74752,74862],[74880,75075],[77712,77808],[77824,78895],[78912,78933],[82944,83526],[92160,92728],[92736,92766],[92768,92777],[92784,92862],[92864,92873],[92880,92909],[92912,92916],[92928,92982],[92992,92995],[93008,93017],[93027,93047],[93053,93071],[93760,93823],[93952,94026],[94031,94087],[94095,94111],[94176,94177],[94179,94180],[94192,94193],[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[113821,113822],[118528,118573],[118576,118598],[119141,119145],[119149,119154],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[120782,120831],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122624,122654],[122661,122666],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[122928,122989],123023,[123136,123180],[123184,123197],[123200,123209],123214,[123536,123566],[123584,123641],[124112,124153],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125136,125142],[125184,125259],[125264,125273],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[130032,130041],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743],[917760,917999]],W1e=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,705],[710,721],[736,740],748,750,[880,884],[886,887],[891,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],1369,[1376,1416],[1488,1514],[1519,1522],[1568,1610],[1646,1647],[1649,1747],1749,[1765,1766],[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2036,2037],2042,[2048,2069],2074,2084,2088,[2112,2136],[2144,2154],[2160,2183],[2185,2190],[2208,2249],[2308,2361],2365,2384,[2392,2401],[2417,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],3165,[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,[3293,3294],[3296,3297],[3313,3314],[3332,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],3634,[3648,3654],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3760],3762,3773,[3776,3780],3782,[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5905],[5919,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6103,6108,[6176,6264],[6272,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],6823,[6917,6963],[6981,6988],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7293],[7296,7304],[7312,7354],[7357,7359],[7401,7404],[7406,7411],[7413,7414],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8472,8477],8484,8486,8488,[8490,8505],[8508,8511],[8517,8521],8526,[8544,8584],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[11568,11623],11631,[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[12293,12295],[12321,12329],[12337,12341],[12344,12348],[12353,12438],[12445,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,42124],[42192,42237],[42240,42508],[42512,42527],[42538,42539],[42560,42606],[42623,42653],[42656,42735],[42775,42783],[42786,42888],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,[43261,43262],[43274,43301],[43312,43334],[43360,43388],[43396,43442],43471,[43488,43492],[43494,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43741],[43744,43754],[43762,43764],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43866],[43868,43881],[43888,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64605],[64612,64829],[64848,64911],[64914,64967],[65008,65017],65137,65139,65143,65145,65147,65149,[65151,65276],[65313,65338],[65345,65370],[65382,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65856,65908],[66176,66204],[66208,66256],[66304,66335],[66349,66378],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68149],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68899],[69248,69289],[69296,69297],[69376,69404],69415,[69424,69445],[69488,69505],[69552,69572],[69600,69622],[69635,69687],[69745,69746],69749,[69763,69807],[69840,69864],[69891,69926],69956,69959,[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70751,70753],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],71352,[71424,71450],[71488,71494],[71680,71723],[71840,71903],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],71999,72001,[72096,72103],[72106,72144],72161,72163,72192,[72203,72242],72250,72272,[72284,72329],72349,[72368,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73056,73061],[73063,73064],[73066,73097],73112,[73440,73458],73474,[73476,73488],[73490,73523],73648,[73728,74649],[74752,74862],[74880,75075],[77712,77808],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[92992,92995],[93027,93047],[93053,93071],[93760,93823],[93952,94026],94032,[94099,94111],[94176,94177],94179,[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],123214,[123536,123565],[123584,123627],[124112,124139],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125184,125251],125259,[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],X1e=Object.freeze(Object.defineProperty({__proto__:null,ASCII:Oae,ASCII_Hex_Digit:Tae,Alphabetic:$ae,Any:kae,Assigned:Aae,Bidi_Control:Nae,Bidi_Mirrored:Lae,Case_Ignorable:Pae,Cased:Bae,Changes_When_Casefolded:Fae,Changes_When_Casemapped:Uae,Changes_When_Lowercased:Hae,Changes_When_NFKC_Casefolded:Vae,Changes_When_Titlecased:jae,Changes_When_Uppercased:zae,Composition_Exclusion:Wae,Dash:Xae,Default_Ignorable_Code_Point:Yae,Deprecated:Gae,Diacritic:Kae,Emoji:Zae,Emoji_Component:qae,Emoji_Modifier:Qae,Emoji_Modifier_Base:Jae,Emoji_Presentation:e1e,Expands_On_NFC:t1e,Expands_On_NFD:n1e,Expands_On_NFKC:r1e,Expands_On_NFKD:i1e,Extended_Pictographic:o1e,Extender:s1e,Full_Composition_Exclusion:a1e,Grapheme_Base:l1e,Grapheme_Extend:u1e,Grapheme_Link:c1e,Hex_Digit:d1e,Hyphen:h1e,IDS_Binary_Operator:f1e,IDS_Trinary_Operator:m1e,ID_Continue:p1e,ID_Start:g1e,Ideographic:v1e,Join_Control:_1e,Logical_Order_Exception:b1e,Lowercase:C1e,Math:y1e,Noncharacter_Code_Point:S1e,Other_Alphabetic:E1e,Other_Default_Ignorable_Code_Point:w1e,Other_Grapheme_Extend:R1e,Other_ID_Continue:D1e,Other_ID_Start:I1e,Other_Lowercase:x1e,Other_Math:M1e,Other_Uppercase:O1e,Pattern_Syntax:T1e,Pattern_White_Space:$1e,Prepended_Concatenation_Mark:k1e,Quotation_Mark:A1e,Radical:N1e,Regional_Indicator:L1e,Sentence_Terminal:P1e,Soft_Dotted:B1e,Terminal_Punctuation:F1e,Unified_Ideograph:U1e,Uppercase:H1e,Variation_Selector:V1e,White_Space:j1e,XID_Continue:z1e,XID_Start:W1e},Symbol.toStringTag,{value:"Module"})),Y1e=[[65,90],[97,122],181,[192,214],[216,246],[248,442],[444,447],[452,659],[661,687],[880,883],[886,887],[891,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],[1376,1416],[4256,4293],4295,4301,[4304,4346],[4349,4351],[5024,5109],[5112,5117],[7296,7304],[7312,7354],[7357,7359],[7424,7467],[7531,7543],[7545,7578],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8450,8455,[8458,8467],8469,[8473,8477],8484,8486,8488,[8490,8493],[8495,8500],8505,[8508,8511],[8517,8521],8526,[8579,8580],[11264,11387],[11390,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[42560,42605],[42624,42651],[42786,42863],[42865,42887],[42891,42894],[42896,42954],[42960,42961],42963,[42965,42969],[42997,42998],43002,[43824,43866],[43872,43880],[43888,43967],[64256,64262],[64275,64279],[65313,65338],[65345,65370],[66560,66639],[66736,66771],[66776,66811],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[68736,68786],[68800,68850],[71840,71903],[93760,93823],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122633],[122635,122654],[122661,122666],[125184,125251]],G1e=[41,93,125,3899,3901,5788,8262,8318,8334,8969,8971,9002,10089,10091,10093,10095,10097,10099,10101,10182,10215,10217,10219,10221,10223,10628,10630,10632,10634,10636,10638,10640,10642,10644,10646,10648,10713,10715,10749,11811,11813,11815,11817,11862,11864,11866,11868,12297,12299,12301,12303,12305,12309,12311,12313,12315,[12318,12319],64830,65048,65078,65080,65082,65084,65086,65088,65090,65092,65096,65114,65116,65118,65289,65341,65373,65376,65379],K1e=[95,[8255,8256],8276,[65075,65076],[65101,65103],65343],Z1e=[[0,31],[127,159]],q1e=[36,[162,165],1423,1547,[2046,2047],[2546,2547],2555,2801,3065,3647,6107,[8352,8384],43064,65020,65129,65284,[65504,65505],[65509,65510],[73693,73696],123647,126128],Q1e=[45,1418,1470,5120,6150,[8208,8213],11799,11802,[11834,11835],11840,11869,12316,12336,12448,[65073,65074],65112,65123,65293,69293],J1e=[[48,57],[1632,1641],[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2662,2671],[2790,2799],[2918,2927],[3046,3055],[3174,3183],[3302,3311],[3430,3439],[3558,3567],[3664,3673],[3792,3801],[3872,3881],[4160,4169],[4240,4249],[6112,6121],[6160,6169],[6470,6479],[6608,6617],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],[42528,42537],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[65296,65305],[66720,66729],[68912,68921],[69734,69743],[69872,69881],[69942,69951],[70096,70105],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71481],[71904,71913],[72016,72025],[72784,72793],[73040,73049],[73120,73129],[73552,73561],[92768,92777],[92864,92873],[93008,93017],[120782,120831],[123200,123209],[123632,123641],[124144,124153],[125264,125273],[130032,130041]],ele=[[1160,1161],6846,[8413,8416],[8418,8420],[42608,42610]],tle=[187,8217,8221,8250,11779,11781,11786,11789,11805,11809],nle=[173,[1536,1541],1564,1757,1807,[2192,2193],2274,6158,[8203,8207],[8234,8238],[8288,8292],[8294,8303],65279,[65529,65531],69821,69837,[78896,78911],[113824,113827],[119155,119162],917505,[917536,917631]],rle=[171,8216,[8219,8220],8223,8249,11778,11780,11785,11788,11804,11808],ile=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,705],[710,721],[736,740],748,750,[880,884],[886,887],[890,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],1369,[1376,1416],[1488,1514],[1519,1522],[1568,1610],[1646,1647],[1649,1747],1749,[1765,1766],[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2036,2037],2042,[2048,2069],2074,2084,2088,[2112,2136],[2144,2154],[2160,2183],[2185,2190],[2208,2249],[2308,2361],2365,2384,[2392,2401],[2417,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],3165,[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,[3293,3294],[3296,3297],[3313,3314],[3332,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],[3634,3635],[3648,3654],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3760],[3762,3763],3773,[3776,3780],3782,[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5873,5880],[5888,5905],[5919,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6103,6108,[6176,6264],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],6823,[6917,6963],[6981,6988],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7293],[7296,7304],[7312,7354],[7357,7359],[7401,7404],[7406,7411],[7413,7414],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8473,8477],8484,8486,8488,[8490,8493],[8495,8505],[8508,8511],[8517,8521],8526,[8579,8580],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[11568,11623],11631,[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],11823,[12293,12294],[12337,12341],[12347,12348],[12353,12438],[12445,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,42124],[42192,42237],[42240,42508],[42512,42527],[42538,42539],[42560,42606],[42623,42653],[42656,42725],[42775,42783],[42786,42888],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,[43261,43262],[43274,43301],[43312,43334],[43360,43388],[43396,43442],43471,[43488,43492],[43494,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43741],[43744,43754],[43762,43764],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43866],[43868,43881],[43888,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65313,65338],[65345,65370],[65382,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[66176,66204],[66208,66256],[66304,66335],[66349,66368],[66370,66377],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66560,66717],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68149],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68899],[69248,69289],[69296,69297],[69376,69404],69415,[69424,69445],[69488,69505],[69552,69572],[69600,69622],[69635,69687],[69745,69746],69749,[69763,69807],[69840,69864],[69891,69926],69956,69959,[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70751,70753],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],71352,[71424,71450],[71488,71494],[71680,71723],[71840,71903],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],71999,72001,[72096,72103],[72106,72144],72161,72163,72192,[72203,72242],72250,72272,[72284,72329],72349,[72368,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73056,73061],[73063,73064],[73066,73097],73112,[73440,73458],73474,[73476,73488],[73490,73523],73648,[73728,74649],[74880,75075],[77712,77808],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[92992,92995],[93027,93047],[93053,93071],[93760,93823],[93952,94026],94032,[94099,94111],[94176,94177],94179,[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],123214,[123536,123565],[123584,123627],[124112,124139],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125184,125251],125259,[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],ole=[[5870,5872],[8544,8578],[8581,8584],12295,[12321,12329],[12344,12346],[42726,42735],[65856,65908],66369,66378,[66513,66517],[74752,74862]],sle=[8232],ale=[[97,122],181,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,[311,312],314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,[396,397],402,405,[409,411],414,417,419,421,424,[426,427],429,432,436,438,[441,442],[445,447],454,457,460,462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,496],499,501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,545,547,549,551,553,555,557,559,561,[563,569],572,[575,576],578,583,585,587,589,[591,659],[661,687],881,883,887,[891,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,[1019,1020],[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1376,1416],[4304,4346],[4349,4351],[5112,5117],[7296,7304],[7424,7467],[7531,7543],[7545,7578],7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7837],7839,7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8071],[8080,8087],[8096,8103],[8112,8116],[8118,8119],8126,[8130,8132],[8134,8135],[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8458,[8462,8463],8467,8495,8500,8505,[8508,8509],[8518,8521],8526,8580,[11312,11359],11361,[11365,11366],11368,11370,11372,11377,[11379,11380],[11382,11387],11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,[11491,11492],11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,42581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,42651,42787,42789,42791,42793,42795,42797,[42799,42801],42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,42863,[42865,42872],42874,42876,42879,42881,42883,42885,42887,42892,42894,42897,[42899,42901],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42927,42933,42935,42937,42939,42941,42943,42945,42947,42952,42954,42961,42963,42965,42967,42969,42998,43002,[43824,43866],[43872,43880],[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[68800,68850],[71872,71903],[93792,93823],[119834,119859],[119886,119892],[119894,119911],[119938,119963],[119990,119993],119995,[119997,120003],[120005,120015],[120042,120067],[120094,120119],[120146,120171],[120198,120223],[120250,120275],[120302,120327],[120354,120379],[120406,120431],[120458,120485],[120514,120538],[120540,120545],[120572,120596],[120598,120603],[120630,120654],[120656,120661],[120688,120712],[120714,120719],[120746,120770],[120772,120777],120779,[122624,122633],[122635,122654],[122661,122666],[125218,125251]],lle=[[768,879],[1155,1161],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],2045,[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2200,2207],[2250,2273],[2275,2307],[2362,2364],[2366,2383],[2385,2391],[2402,2403],[2433,2435],2492,[2494,2500],[2503,2504],[2507,2509],2519,[2530,2531],2558,[2561,2563],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2691],2748,[2750,2757],[2759,2761],[2763,2765],[2786,2787],[2810,2815],[2817,2819],2876,[2878,2884],[2887,2888],[2891,2893],[2901,2903],[2914,2915],2946,[3006,3010],[3014,3016],[3018,3021],3031,[3072,3076],3132,[3134,3140],[3142,3144],[3146,3149],[3157,3158],[3170,3171],[3201,3203],3260,[3262,3268],[3270,3272],[3274,3277],[3285,3286],[3298,3299],3315,[3328,3331],[3387,3388],[3390,3396],[3398,3400],[3402,3405],3415,[3426,3427],[3457,3459],3530,[3535,3540],3542,[3544,3551],[3570,3571],3633,[3636,3642],[3655,3662],3761,[3764,3772],[3784,3790],[3864,3865],3893,3895,3897,[3902,3903],[3953,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4139,4158],[4182,4185],[4190,4192],[4194,4196],[4199,4205],[4209,4212],[4226,4237],4239,[4250,4253],[4957,4959],[5906,5909],[5938,5940],[5970,5971],[6002,6003],[6068,6099],6109,[6155,6157],6159,[6277,6278],6313,[6432,6443],[6448,6459],[6679,6683],[6741,6750],[6752,6780],6783,[6832,6862],[6912,6916],[6964,6980],[7019,7027],[7040,7042],[7073,7085],[7142,7155],[7204,7223],[7376,7378],[7380,7400],7405,7412,[7415,7417],[7616,7679],[8400,8432],[11503,11505],11647,[11744,11775],[12330,12335],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43043,43047],43052,[43136,43137],[43188,43205],[43232,43249],43263,[43302,43309],[43335,43347],[43392,43395],[43443,43456],43493,[43561,43574],43587,[43596,43597],[43643,43645],43696,[43698,43700],[43703,43704],[43710,43711],43713,[43755,43759],[43765,43766],[44003,44010],[44012,44013],64286,[65024,65039],[65056,65071],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],[69632,69634],[69688,69702],69744,[69747,69748],[69759,69762],[69808,69818],69826,[69888,69890],[69927,69940],[69957,69958],70003,[70016,70018],[70067,70080],[70089,70092],[70094,70095],[70188,70199],70206,70209,[70367,70378],[70400,70403],[70459,70460],[70462,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70502,70508],[70512,70516],[70709,70726],70750,[70832,70851],[71087,71093],[71096,71104],[71132,71133],[71216,71232],[71339,71351],[71453,71467],[71724,71738],[71984,71989],[71991,71992],[71995,71998],72e3,[72002,72003],[72145,72151],[72154,72160],72164,[72193,72202],[72243,72249],[72251,72254],72263,[72273,72283],[72330,72345],[72751,72758],[72760,72767],[72850,72871],[72873,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73098,73102],[73104,73105],[73107,73111],[73459,73462],[73472,73473],73475,[73524,73530],[73534,73538],78912,[78919,78933],[92912,92916],[92976,92982],94031,[94033,94087],[94095,94098],94180,[94192,94193],[113821,113822],[118528,118573],[118576,118598],[119141,119145],[119149,119154],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,[123184,123190],123566,[123628,123631],[124140,124143],[125136,125142],[125252,125258],[917760,917999]],ule=[43,[60,62],124,126,172,177,215,247,1014,[1542,1544],8260,8274,[8314,8316],[8330,8332],8472,[8512,8516],8523,[8592,8596],[8602,8603],8608,8611,8614,8622,[8654,8655],8658,8660,[8692,8959],[8992,8993],9084,[9115,9139],[9180,9185],9655,9665,[9720,9727],9839,[10176,10180],[10183,10213],[10224,10239],[10496,10626],[10649,10711],[10716,10747],[10750,11007],[11056,11076],[11079,11084],64297,65122,[65124,65126],65291,[65308,65310],65372,65374,65506,[65513,65516],120513,120539,120571,120597,120629,120655,120687,120713,120745,120771,[126704,126705]],cle=[[688,705],[710,721],[736,740],748,750,884,890,1369,1600,[1765,1766],[2036,2037],2042,2074,2084,2088,2249,2417,3654,3782,4348,6103,6211,6823,[7288,7293],[7468,7530],7544,[7579,7615],8305,8319,[8336,8348],[11388,11389],11631,11823,12293,[12337,12341],12347,[12445,12446],[12540,12542],40981,[42232,42237],42508,42623,[42652,42653],[42775,42783],42864,42888,[42994,42996],[43e3,43001],43471,43494,43632,43741,[43763,43764],[43868,43871],43881,65392,[65438,65439],[67456,67461],[67463,67504],[67506,67514],[92992,92995],[94099,94111],[94176,94177],94179,[110576,110579],[110581,110587],[110589,110590],[122928,122989],[123191,123197],124139,125259],dle=[94,96,168,175,180,184,[706,709],[722,735],[741,747],749,[751,767],885,[900,901],2184,8125,[8127,8129],[8141,8143],[8157,8159],[8173,8175],[8189,8190],[12443,12444],[42752,42774],[42784,42785],[42889,42890],43867,[43882,43883],[64434,64450],65342,65344,65507,[127995,127999]],hle=[[768,879],[1155,1159],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],2045,[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2200,2207],[2250,2273],[2275,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2433,2492,[2497,2500],2509,[2530,2531],2558,[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,2879,[2881,2884],2893,[2901,2902],[2914,2915],2946,3008,3021,3072,3076,3132,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,3263,3270,[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],3405,[3426,3427],3457,3530,[3538,3540],3542,3633,[3636,3642],[3655,3662],3761,[3764,3772],[3784,3790],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,[4957,4959],[5906,5908],[5938,5939],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6109,[6155,6157],6159,[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,[6832,6845],[6847,6862],[6912,6915],6964,[6966,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7679],[8400,8412],8417,[8421,8432],[11503,11505],11647,[11744,11775],[12330,12333],[12441,12442],42607,[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43045,43046],43052,[43204,43205],[43232,43249],43263,[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],[43452,43453],43493,[43561,43566],[43569,43570],[43573,43574],43587,43596,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,[43756,43757],43766,44005,44008,44013,64286,[65024,65039],[65056,65071],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],69633,[69688,69702],69744,[69747,69748],[69759,69761],[69811,69814],[69817,69818],69826,[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70089,70092],70095,[70191,70193],70196,[70198,70199],70206,70209,70367,[70371,70378],[70400,70401],[70459,70460],70464,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,70750,[70835,70840],70842,[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[71727,71735],[71737,71738],[71995,71996],71998,72003,[72148,72151],[72154,72155],72160,[72193,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],72767,[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73104,73105],73109,73111,[73459,73460],[73472,73473],[73526,73530],73536,73538,78912,[78919,78933],[92912,92916],[92976,92982],94031,[94095,94098],94180,[113821,113822],[118528,118573],[118576,118598],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,[123184,123190],123566,[123628,123631],[124140,124143],[125136,125142],[125252,125258],[917760,917999]],fle=[[48,57],[178,179],185,[188,190],[1632,1641],[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2548,2553],[2662,2671],[2790,2799],[2918,2927],[2930,2935],[3046,3058],[3174,3183],[3192,3198],[3302,3311],[3416,3422],[3430,3448],[3558,3567],[3664,3673],[3792,3801],[3872,3891],[4160,4169],[4240,4249],[4969,4988],[5870,5872],[6112,6121],[6128,6137],[6160,6169],[6470,6479],[6608,6618],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],8304,[8308,8313],[8320,8329],[8528,8578],[8581,8585],[9312,9371],[9450,9471],[10102,10131],11517,12295,[12321,12329],[12344,12346],[12690,12693],[12832,12841],[12872,12879],[12881,12895],[12928,12937],[12977,12991],[42528,42537],[42726,42735],[43056,43061],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[65296,65305],[65799,65843],[65856,65912],[65930,65931],[66273,66299],[66336,66339],66369,66378,[66513,66517],[66720,66729],[67672,67679],[67705,67711],[67751,67759],[67835,67839],[67862,67867],[68028,68029],[68032,68047],[68050,68095],[68160,68168],[68221,68222],[68253,68255],[68331,68335],[68440,68447],[68472,68479],[68521,68527],[68858,68863],[68912,68921],[69216,69246],[69405,69414],[69457,69460],[69573,69579],[69714,69743],[69872,69881],[69942,69951],[70096,70105],[70113,70132],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71483],[71904,71922],[72016,72025],[72784,72812],[73040,73049],[73120,73129],[73552,73561],[73664,73684],[74752,74862],[92768,92777],[92864,92873],[93008,93017],[93019,93025],[93824,93846],[119488,119507],[119520,119539],[119648,119672],[120782,120831],[123200,123209],[123632,123641],[124144,124153],[125127,125135],[125264,125273],[126065,126123],[126125,126127],[126129,126132],[126209,126253],[126255,126269],[127232,127244],[130032,130041]],mle=[40,91,123,3898,3900,5787,8218,8222,8261,8317,8333,8968,8970,9001,10088,10090,10092,10094,10096,10098,10100,10181,10214,10216,10218,10220,10222,10627,10629,10631,10633,10635,10637,10639,10641,10643,10645,10647,10712,10714,10748,11810,11812,11814,11816,11842,11861,11863,11865,11867,12296,12298,12300,12302,12304,12308,12310,12312,12314,12317,64831,65047,65077,65079,65081,65083,65085,65087,65089,65091,65095,65113,65115,65117,65288,65339,65371,65375,65378],ple=[[0,31],[127,159],173,[888,889],[896,899],907,909,930,1328,[1367,1368],[1419,1420],1424,[1480,1487],[1515,1518],[1525,1541],1564,1757,[1806,1807],[1867,1868],[1970,1983],[2043,2044],[2094,2095],2111,[2140,2141],2143,[2155,2159],[2191,2199],2274,2436,[2445,2446],[2449,2450],2473,2481,[2483,2485],[2490,2491],[2501,2502],[2505,2506],[2511,2518],[2520,2523],2526,[2532,2533],[2559,2560],2564,[2571,2574],[2577,2578],2601,2609,2612,2615,[2618,2619],2621,[2627,2630],[2633,2634],[2638,2640],[2642,2648],2653,[2655,2661],[2679,2688],2692,2702,2706,2729,2737,2740,[2746,2747],2758,2762,[2766,2767],[2769,2783],[2788,2789],[2802,2808],2816,2820,[2829,2830],[2833,2834],2857,2865,2868,[2874,2875],[2885,2886],[2889,2890],[2894,2900],[2904,2907],2910,[2916,2917],[2936,2945],2948,[2955,2957],2961,[2966,2968],2971,2973,[2976,2978],[2981,2983],[2987,2989],[3002,3005],[3011,3013],3017,[3022,3023],[3025,3030],[3032,3045],[3067,3071],3085,3089,3113,[3130,3131],3141,3145,[3150,3156],3159,[3163,3164],[3166,3167],[3172,3173],[3184,3190],3213,3217,3241,3252,[3258,3259],3269,3273,[3278,3284],[3287,3292],3295,[3300,3301],3312,[3316,3327],3341,3345,3397,3401,[3408,3411],[3428,3429],3456,3460,[3479,3481],3506,3516,[3518,3519],[3527,3529],[3531,3534],3541,3543,[3552,3557],[3568,3569],[3573,3584],[3643,3646],[3676,3712],3715,3717,3723,3748,3750,[3774,3775],3781,3783,3791,[3802,3803],[3808,3839],3912,[3949,3952],3992,4029,4045,[4059,4095],4294,[4296,4300],[4302,4303],4681,[4686,4687],4695,4697,[4702,4703],4745,[4750,4751],4785,[4790,4791],4799,4801,[4806,4807],4823,4881,[4886,4887],[4955,4956],[4989,4991],[5018,5023],[5110,5111],[5118,5119],[5789,5791],[5881,5887],[5910,5918],[5943,5951],[5972,5983],5997,6001,[6004,6015],[6110,6111],[6122,6127],[6138,6143],6158,[6170,6175],[6265,6271],[6315,6319],[6390,6399],6431,[6444,6447],[6460,6463],[6465,6467],[6510,6511],[6517,6527],[6572,6575],[6602,6607],[6619,6621],[6684,6685],6751,[6781,6782],[6794,6799],[6810,6815],[6830,6831],[6863,6911],[6989,6991],7039,[7156,7163],[7224,7226],[7242,7244],[7305,7311],[7355,7356],[7368,7375],[7419,7423],[7958,7959],[7966,7967],[8006,8007],[8014,8015],8024,8026,8028,8030,[8062,8063],8117,8133,[8148,8149],8156,[8176,8177],8181,8191,[8203,8207],[8234,8238],[8288,8303],[8306,8307],8335,[8349,8351],[8385,8399],[8433,8447],[8588,8591],[9255,9279],[9291,9311],[11124,11125],11158,[11508,11512],11558,[11560,11564],[11566,11567],[11624,11630],[11633,11646],[11671,11679],11687,11695,11703,11711,11719,11727,11735,11743,[11870,11903],11930,[12020,12031],[12246,12271],[12284,12287],12352,[12439,12440],[12544,12548],12592,12687,[12772,12783],12831,[42125,42127],[42183,42191],[42540,42559],[42744,42751],[42955,42959],42962,42964,[42970,42993],[43053,43055],[43066,43071],[43128,43135],[43206,43213],[43226,43231],[43348,43358],[43389,43391],43470,[43482,43485],43519,[43575,43583],[43598,43599],[43610,43611],[43715,43738],[43767,43776],[43783,43784],[43791,43792],[43799,43807],43815,43823,[43884,43887],[44014,44015],[44026,44031],[55204,55215],[55239,55242],[55292,63743],[64110,64111],[64218,64255],[64263,64274],[64280,64284],64311,64317,64319,64322,64325,[64451,64466],[64912,64913],[64968,64974],[64976,65007],[65050,65055],65107,65127,[65132,65135],65141,[65277,65280],[65471,65473],[65480,65481],[65488,65489],[65496,65497],[65501,65503],65511,[65519,65531],[65534,65535],65548,65575,65595,65598,[65614,65615],[65630,65663],[65787,65791],[65795,65798],[65844,65846],65935,[65949,65951],[65953,65999],[66046,66175],[66205,66207],[66257,66271],[66300,66303],[66340,66348],[66379,66383],[66427,66431],66462,[66500,66503],[66518,66559],[66718,66719],[66730,66735],[66772,66775],[66812,66815],[66856,66863],[66916,66926],66939,66955,66963,66966,66978,66994,67002,[67005,67071],[67383,67391],[67414,67423],[67432,67455],67462,67505,[67515,67583],[67590,67591],67593,67638,[67641,67643],[67645,67646],67670,[67743,67750],[67760,67807],67827,[67830,67834],[67868,67870],[67898,67902],[67904,67967],[68024,68027],[68048,68049],68100,[68103,68107],68116,68120,[68150,68151],[68155,68158],[68169,68175],[68185,68191],[68256,68287],[68327,68330],[68343,68351],[68406,68408],[68438,68439],[68467,68471],[68498,68504],[68509,68520],[68528,68607],[68681,68735],[68787,68799],[68851,68857],[68904,68911],[68922,69215],69247,69290,[69294,69295],[69298,69372],[69416,69423],[69466,69487],[69514,69551],[69580,69599],[69623,69631],[69710,69713],[69750,69758],69821,[69827,69839],[69865,69871],[69882,69887],69941,[69960,69967],[70007,70015],70112,[70133,70143],70162,[70210,70271],70279,70281,70286,70302,[70314,70319],[70379,70383],[70394,70399],70404,[70413,70414],[70417,70418],70441,70449,70452,70458,[70469,70470],[70473,70474],[70478,70479],[70481,70486],[70488,70492],[70500,70501],[70509,70511],[70517,70655],70748,[70754,70783],[70856,70863],[70874,71039],[71094,71095],[71134,71167],[71237,71247],[71258,71263],[71277,71295],[71354,71359],[71370,71423],[71451,71452],[71468,71471],[71495,71679],[71740,71839],[71923,71934],[71943,71944],[71946,71947],71956,71959,71990,[71993,71994],[72007,72015],[72026,72095],[72104,72105],[72152,72153],[72165,72191],[72264,72271],[72355,72367],[72441,72447],[72458,72703],72713,72759,[72774,72783],[72813,72815],[72848,72849],72872,[72887,72959],72967,72970,[73015,73017],73019,73022,[73032,73039],[73050,73055],73062,73065,73103,73106,[73113,73119],[73130,73439],[73465,73471],73489,[73531,73533],[73562,73647],[73649,73663],[73714,73726],[74650,74751],74863,[74869,74879],[75076,77711],[77811,77823],[78896,78911],[78934,82943],[83527,92159],[92729,92735],92767,[92778,92781],92863,[92874,92879],[92910,92911],[92918,92927],[92998,93007],93018,93026,[93048,93052],[93072,93759],[93851,93951],[94027,94030],[94088,94094],[94112,94175],[94181,94191],[94194,94207],[100344,100351],[101590,101631],[101641,110575],110580,110588,110591,[110883,110897],[110899,110927],[110931,110932],[110934,110947],[110952,110959],[111356,113663],[113771,113775],[113789,113791],[113801,113807],[113818,113819],[113824,118527],[118574,118575],[118599,118607],[118724,118783],[119030,119039],[119079,119080],[119155,119162],[119275,119295],[119366,119487],[119508,119519],[119540,119551],[119639,119647],[119673,119807],119893,119965,[119968,119969],[119971,119972],[119975,119976],119981,119994,119996,120004,120070,[120075,120076],120085,120093,120122,120127,120133,[120135,120137],120145,[120486,120487],[120780,120781],[121484,121498],121504,[121520,122623],[122655,122660],[122667,122879],122887,[122905,122906],122914,122917,[122923,122927],[122990,123022],[123024,123135],[123181,123183],[123198,123199],[123210,123213],[123216,123535],[123567,123583],[123642,123646],[123648,124111],[124154,124895],124903,124908,124911,124927,[125125,125126],[125143,125183],[125260,125263],[125274,125277],[125280,126064],[126133,126208],[126270,126463],126468,126496,126499,[126501,126502],126504,126515,126520,126522,[126524,126529],[126531,126534],126536,126538,126540,126544,126547,[126549,126550],126552,126554,126556,126558,126560,126563,[126565,126566],126571,126579,126584,126589,126591,126602,[126620,126624],126628,126634,[126652,126703],[126706,126975],[127020,127023],[127124,127135],[127151,127152],127168,127184,[127222,127231],[127406,127461],[127491,127503],[127548,127551],[127561,127567],[127570,127583],[127590,127743],[128728,128731],[128749,128751],[128765,128767],[128887,128890],[128986,128991],[129004,129007],[129009,129023],[129036,129039],[129096,129103],[129114,129119],[129160,129167],[129198,129199],[129202,129279],[129620,129631],[129646,129647],[129661,129663],[129673,129679],129726,[129734,129741],[129756,129759],[129769,129775],[129785,129791],129939,[129995,130031],[130042,131071],[173792,173823],[177978,177983],[178206,178207],[183970,183983],[191457,194559],[195102,196607],[201547,201551],[205744,917759],[918e3,1114111]],gle=[170,186,443,[448,451],660,[1488,1514],[1519,1522],[1568,1599],[1601,1610],[1646,1647],[1649,1747],1749,[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2048,2069],[2112,2136],[2144,2154],[2160,2183],[2185,2190],[2208,2248],[2308,2361],2365,2384,[2392,2401],[2418,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],3165,[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,[3293,3294],[3296,3297],[3313,3314],[3332,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],[3634,3635],[3648,3653],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3760],[3762,3763],3773,[3776,3780],[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4352,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5873,5880],[5888,5905],[5919,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6108,[6176,6210],[6212,6264],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],[6917,6963],[6981,6988],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7287],[7401,7404],[7406,7411],[7413,7414],7418,[8501,8504],[11568,11623],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],12294,12348,[12353,12438],12447,[12449,12538],12543,[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,40980],[40982,42124],[42192,42231],[42240,42507],[42512,42527],[42538,42539],42606,[42656,42725],42895,42999,[43003,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,[43261,43262],[43274,43301],[43312,43334],[43360,43388],[43396,43442],[43488,43492],[43495,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43631],[43633,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43740],[43744,43754],43762,[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43968,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65382,65391],[65393,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[66176,66204],[66208,66256],[66304,66335],[66349,66368],[66370,66377],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66640,66717],[66816,66855],[66864,66915],[67072,67382],[67392,67413],[67424,67431],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68149],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68864,68899],[69248,69289],[69296,69297],[69376,69404],69415,[69424,69445],[69488,69505],[69552,69572],[69600,69622],[69635,69687],[69745,69746],69749,[69763,69807],[69840,69864],[69891,69926],69956,69959,[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70751,70753],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],71352,[71424,71450],[71488,71494],[71680,71723],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],71999,72001,[72096,72103],[72106,72144],72161,72163,72192,[72203,72242],72250,72272,[72284,72329],72349,[72368,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73056,73061],[73063,73064],[73066,73097],73112,[73440,73458],73474,[73476,73488],[73490,73523],73648,[73728,74649],[74880,75075],[77712,77808],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[93027,93047],[93053,93071],[93952,94026],94032,[94208,100343],[100352,101589],[101632,101640],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],122634,[123136,123180],123214,[123536,123565],[123584,123627],[124112,124138],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],vle=[[178,179],185,[188,190],[2548,2553],[2930,2935],[3056,3058],[3192,3198],[3416,3422],[3440,3448],[3882,3891],[4969,4988],[6128,6137],6618,8304,[8308,8313],[8320,8329],[8528,8543],8585,[9312,9371],[9450,9471],[10102,10131],11517,[12690,12693],[12832,12841],[12872,12879],[12881,12895],[12928,12937],[12977,12991],[43056,43061],[65799,65843],[65909,65912],[65930,65931],[66273,66299],[66336,66339],[67672,67679],[67705,67711],[67751,67759],[67835,67839],[67862,67867],[68028,68029],[68032,68047],[68050,68095],[68160,68168],[68221,68222],[68253,68255],[68331,68335],[68440,68447],[68472,68479],[68521,68527],[68858,68863],[69216,69246],[69405,69414],[69457,69460],[69573,69579],[69714,69733],[70113,70132],[71482,71483],[71914,71922],[72794,72812],[73664,73684],[93019,93025],[93824,93846],[119488,119507],[119520,119539],[119648,119672],[125127,125135],[126065,126123],[126125,126127],[126129,126132],[126209,126253],[126255,126269],[127232,127244]],_le=[[33,35],[37,39],42,44,[46,47],[58,59],[63,64],92,161,167,[182,183],191,894,903,[1370,1375],1417,1472,1475,1478,[1523,1524],[1545,1546],[1548,1549],1563,[1565,1567],[1642,1645],1748,[1792,1805],[2039,2041],[2096,2110],2142,[2404,2405],2416,2557,2678,2800,3191,3204,3572,3663,[3674,3675],[3844,3858],3860,3973,[4048,4052],[4057,4058],[4170,4175],4347,[4960,4968],5742,[5867,5869],[5941,5942],[6100,6102],[6104,6106],[6144,6149],[6151,6154],[6468,6469],[6686,6687],[6816,6822],[6824,6829],[7002,7008],[7037,7038],[7164,7167],[7227,7231],[7294,7295],[7360,7367],7379,[8214,8215],[8224,8231],[8240,8248],[8251,8254],[8257,8259],[8263,8273],8275,[8277,8286],[11513,11516],[11518,11519],11632,[11776,11777],[11782,11784],11787,[11790,11798],[11800,11801],11803,[11806,11807],[11818,11822],[11824,11833],[11836,11839],11841,[11843,11855],[11858,11860],[12289,12291],12349,12539,[42238,42239],[42509,42511],42611,42622,[42738,42743],[43124,43127],[43214,43215],[43256,43258],43260,[43310,43311],43359,[43457,43469],[43486,43487],[43612,43615],[43742,43743],[43760,43761],44011,[65040,65046],65049,65072,[65093,65094],[65097,65100],[65104,65106],[65108,65111],[65119,65121],65128,[65130,65131],[65281,65283],[65285,65287],65290,65292,[65294,65295],[65306,65307],[65311,65312],65340,65377,[65380,65381],[65792,65794],66463,66512,66927,67671,67871,67903,[68176,68184],68223,[68336,68342],[68409,68415],[68505,68508],[69461,69465],[69510,69513],[69703,69709],[69819,69820],[69822,69825],[69952,69955],[70004,70005],[70085,70088],70093,70107,[70109,70111],[70200,70205],70313,[70731,70735],[70746,70747],70749,70854,[71105,71127],[71233,71235],[71264,71276],71353,[71484,71486],71739,[72004,72006],72162,[72255,72262],[72346,72348],[72350,72354],[72448,72457],[72769,72773],[72816,72817],[73463,73464],[73539,73551],73727,[74864,74868],[77809,77810],[92782,92783],92917,[92983,92987],92996,[93847,93850],94178,113823,[121479,121483],[125278,125279]],ble=[166,169,174,176,1154,[1421,1422],[1550,1551],1758,1769,[1789,1790],2038,2554,2928,[3059,3064],3066,3199,3407,3449,[3841,3843],3859,[3861,3863],[3866,3871],3892,3894,3896,[4030,4037],[4039,4044],[4046,4047],[4053,4056],[4254,4255],[5008,5017],5741,6464,[6622,6655],[7009,7018],[7028,7036],[8448,8449],[8451,8454],[8456,8457],8468,[8470,8471],[8478,8483],8485,8487,8489,8494,[8506,8507],8522,[8524,8525],8527,[8586,8587],[8597,8601],[8604,8607],[8609,8610],[8612,8613],[8615,8621],[8623,8653],[8656,8657],8659,[8661,8691],[8960,8967],[8972,8991],[8994,9e3],[9003,9083],[9085,9114],[9140,9179],[9186,9254],[9280,9290],[9372,9449],[9472,9654],[9656,9664],[9666,9719],[9728,9838],[9840,10087],[10132,10175],[10240,10495],[11008,11055],[11077,11078],[11085,11123],[11126,11157],[11159,11263],[11493,11498],[11856,11857],[11904,11929],[11931,12019],[12032,12245],[12272,12283],12292,[12306,12307],12320,[12342,12343],[12350,12351],[12688,12689],[12694,12703],[12736,12771],[12800,12830],[12842,12871],12880,[12896,12927],[12938,12976],[12992,13311],[19904,19967],[42128,42182],[43048,43051],[43062,43063],43065,[43639,43641],[64832,64847],64975,[65021,65023],65508,65512,[65517,65518],[65532,65533],[65847,65855],[65913,65929],[65932,65934],[65936,65948],65952,[66e3,66044],[67703,67704],68296,71487,[73685,73692],[73697,73713],[92988,92991],92997,113820,[118608,118723],[118784,119029],[119040,119078],[119081,119140],[119146,119148],[119171,119172],[119180,119209],[119214,119274],[119296,119361],119365,[119552,119638],[120832,121343],[121399,121402],[121453,121460],[121462,121475],[121477,121478],123215,126124,126254,[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127245,127405],[127462,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,127994],[128e3,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994]],Cle=[8233],yle=[[57344,63743],[983040,1048573],[1048576,1114109]],Sle=[[33,35],[37,42],[44,47],[58,59],[63,64],[91,93],95,123,125,161,167,171,[182,183],187,191,894,903,[1370,1375],[1417,1418],1470,1472,1475,1478,[1523,1524],[1545,1546],[1548,1549],1563,[1565,1567],[1642,1645],1748,[1792,1805],[2039,2041],[2096,2110],2142,[2404,2405],2416,2557,2678,2800,3191,3204,3572,3663,[3674,3675],[3844,3858],3860,[3898,3901],3973,[4048,4052],[4057,4058],[4170,4175],4347,[4960,4968],5120,5742,[5787,5788],[5867,5869],[5941,5942],[6100,6102],[6104,6106],[6144,6154],[6468,6469],[6686,6687],[6816,6822],[6824,6829],[7002,7008],[7037,7038],[7164,7167],[7227,7231],[7294,7295],[7360,7367],7379,[8208,8231],[8240,8259],[8261,8273],[8275,8286],[8317,8318],[8333,8334],[8968,8971],[9001,9002],[10088,10101],[10181,10182],[10214,10223],[10627,10648],[10712,10715],[10748,10749],[11513,11516],[11518,11519],11632,[11776,11822],[11824,11855],[11858,11869],[12289,12291],[12296,12305],[12308,12319],12336,12349,12448,12539,[42238,42239],[42509,42511],42611,42622,[42738,42743],[43124,43127],[43214,43215],[43256,43258],43260,[43310,43311],43359,[43457,43469],[43486,43487],[43612,43615],[43742,43743],[43760,43761],44011,[64830,64831],[65040,65049],[65072,65106],[65108,65121],65123,65128,[65130,65131],[65281,65283],[65285,65290],[65292,65295],[65306,65307],[65311,65312],[65339,65341],65343,65371,65373,[65375,65381],[65792,65794],66463,66512,66927,67671,67871,67903,[68176,68184],68223,[68336,68342],[68409,68415],[68505,68508],69293,[69461,69465],[69510,69513],[69703,69709],[69819,69820],[69822,69825],[69952,69955],[70004,70005],[70085,70088],70093,70107,[70109,70111],[70200,70205],70313,[70731,70735],[70746,70747],70749,70854,[71105,71127],[71233,71235],[71264,71276],71353,[71484,71486],71739,[72004,72006],72162,[72255,72262],[72346,72348],[72350,72354],[72448,72457],[72769,72773],[72816,72817],[73463,73464],[73539,73551],73727,[74864,74868],[77809,77810],[92782,92783],92917,[92983,92987],92996,[93847,93850],94178,113823,[121479,121483],[125278,125279]],Ele=[32,160,5760,[8192,8202],[8232,8233],8239,8287,12288],wle=[32,160,5760,[8192,8202],8239,8287,12288],Rle=[2307,2363,[2366,2368],[2377,2380],[2382,2383],[2434,2435],[2494,2496],[2503,2504],[2507,2508],2519,2563,[2622,2624],2691,[2750,2752],2761,[2763,2764],[2818,2819],2878,2880,[2887,2888],[2891,2892],2903,[3006,3007],[3009,3010],[3014,3016],[3018,3020],3031,[3073,3075],[3137,3140],[3202,3203],3262,[3264,3268],[3271,3272],[3274,3275],[3285,3286],3315,[3330,3331],[3390,3392],[3398,3400],[3402,3404],3415,[3458,3459],[3535,3537],[3544,3551],[3570,3571],[3902,3903],3967,[4139,4140],4145,4152,[4155,4156],[4182,4183],[4194,4196],[4199,4205],[4227,4228],[4231,4236],4239,[4250,4252],5909,5940,6070,[6078,6085],[6087,6088],[6435,6438],[6441,6443],[6448,6449],[6451,6456],[6681,6682],6741,6743,6753,[6755,6756],[6765,6770],6916,6965,6971,[6973,6977],[6979,6980],7042,7073,[7078,7079],7082,7143,[7146,7148],7150,[7154,7155],[7204,7211],[7220,7221],7393,7415,[12334,12335],[43043,43044],43047,[43136,43137],[43188,43203],[43346,43347],43395,[43444,43445],[43450,43451],[43454,43456],[43567,43568],[43571,43572],43597,43643,43645,43755,[43758,43759],43765,[44003,44004],[44006,44007],[44009,44010],44012,69632,69634,69762,[69808,69810],[69815,69816],69932,[69957,69958],70018,[70067,70069],[70079,70080],70094,[70188,70190],[70194,70195],70197,[70368,70370],[70402,70403],[70462,70463],[70465,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70709,70711],[70720,70721],70725,[70832,70834],70841,[70843,70846],70849,[71087,71089],[71096,71099],71102,[71216,71218],[71227,71228],71230,71340,[71342,71343],71350,[71456,71457],71462,[71724,71726],71736,[71984,71989],[71991,71992],71997,72e3,72002,[72145,72147],[72156,72159],72164,72249,[72279,72280],72343,72751,72766,72873,72881,72884,[73098,73102],[73107,73108],73110,[73461,73462],73475,[73524,73525],[73534,73535],73537,[94033,94087],[94192,94193],[119141,119142],[119149,119154]],Dle=[[55296,57343]],Ile=[36,43,[60,62],94,96,124,126,[162,166],[168,169],172,[174,177],180,184,215,247,[706,709],[722,735],[741,747],749,[751,767],885,[900,901],1014,1154,[1421,1423],[1542,1544],1547,[1550,1551],1758,1769,[1789,1790],2038,[2046,2047],2184,[2546,2547],[2554,2555],2801,2928,[3059,3066],3199,3407,3449,3647,[3841,3843],3859,[3861,3863],[3866,3871],3892,3894,3896,[4030,4037],[4039,4044],[4046,4047],[4053,4056],[4254,4255],[5008,5017],5741,6107,6464,[6622,6655],[7009,7018],[7028,7036],8125,[8127,8129],[8141,8143],[8157,8159],[8173,8175],[8189,8190],8260,8274,[8314,8316],[8330,8332],[8352,8384],[8448,8449],[8451,8454],[8456,8457],8468,[8470,8472],[8478,8483],8485,8487,8489,8494,[8506,8507],[8512,8516],[8522,8525],8527,[8586,8587],[8592,8967],[8972,9e3],[9003,9254],[9280,9290],[9372,9449],[9472,10087],[10132,10180],[10183,10213],[10224,10626],[10649,10711],[10716,10747],[10750,11123],[11126,11157],[11159,11263],[11493,11498],[11856,11857],[11904,11929],[11931,12019],[12032,12245],[12272,12283],12292,[12306,12307],12320,[12342,12343],[12350,12351],[12443,12444],[12688,12689],[12694,12703],[12736,12771],[12800,12830],[12842,12871],12880,[12896,12927],[12938,12976],[12992,13311],[19904,19967],[42128,42182],[42752,42774],[42784,42785],[42889,42890],[43048,43051],[43062,43065],[43639,43641],43867,[43882,43883],64297,[64434,64450],[64832,64847],64975,[65020,65023],65122,[65124,65126],65129,65284,65291,[65308,65310],65342,65344,65372,65374,[65504,65510],[65512,65518],[65532,65533],[65847,65855],[65913,65929],[65932,65934],[65936,65948],65952,[66e3,66044],[67703,67704],68296,71487,[73685,73713],[92988,92991],92997,113820,[118608,118723],[118784,119029],[119040,119078],[119081,119140],[119146,119148],[119171,119172],[119180,119209],[119214,119274],[119296,119361],119365,[119552,119638],120513,120539,120571,120597,120629,120655,120687,120713,120745,120771,[120832,121343],[121399,121402],[121453,121460],[121462,121475],[121477,121478],123215,123647,126124,126128,126254,[126704,126705],[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127245,127405],[127462,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994]],xle=[453,456,459,498,[8072,8079],[8088,8095],[8104,8111],8124,8140,8188],Mle=[[888,889],[896,899],907,909,930,1328,[1367,1368],[1419,1420],1424,[1480,1487],[1515,1518],[1525,1535],1806,[1867,1868],[1970,1983],[2043,2044],[2094,2095],2111,[2140,2141],2143,[2155,2159],2191,[2194,2199],2436,[2445,2446],[2449,2450],2473,2481,[2483,2485],[2490,2491],[2501,2502],[2505,2506],[2511,2518],[2520,2523],2526,[2532,2533],[2559,2560],2564,[2571,2574],[2577,2578],2601,2609,2612,2615,[2618,2619],2621,[2627,2630],[2633,2634],[2638,2640],[2642,2648],2653,[2655,2661],[2679,2688],2692,2702,2706,2729,2737,2740,[2746,2747],2758,2762,[2766,2767],[2769,2783],[2788,2789],[2802,2808],2816,2820,[2829,2830],[2833,2834],2857,2865,2868,[2874,2875],[2885,2886],[2889,2890],[2894,2900],[2904,2907],2910,[2916,2917],[2936,2945],2948,[2955,2957],2961,[2966,2968],2971,2973,[2976,2978],[2981,2983],[2987,2989],[3002,3005],[3011,3013],3017,[3022,3023],[3025,3030],[3032,3045],[3067,3071],3085,3089,3113,[3130,3131],3141,3145,[3150,3156],3159,[3163,3164],[3166,3167],[3172,3173],[3184,3190],3213,3217,3241,3252,[3258,3259],3269,3273,[3278,3284],[3287,3292],3295,[3300,3301],3312,[3316,3327],3341,3345,3397,3401,[3408,3411],[3428,3429],3456,3460,[3479,3481],3506,3516,[3518,3519],[3527,3529],[3531,3534],3541,3543,[3552,3557],[3568,3569],[3573,3584],[3643,3646],[3676,3712],3715,3717,3723,3748,3750,[3774,3775],3781,3783,3791,[3802,3803],[3808,3839],3912,[3949,3952],3992,4029,4045,[4059,4095],4294,[4296,4300],[4302,4303],4681,[4686,4687],4695,4697,[4702,4703],4745,[4750,4751],4785,[4790,4791],4799,4801,[4806,4807],4823,4881,[4886,4887],[4955,4956],[4989,4991],[5018,5023],[5110,5111],[5118,5119],[5789,5791],[5881,5887],[5910,5918],[5943,5951],[5972,5983],5997,6001,[6004,6015],[6110,6111],[6122,6127],[6138,6143],[6170,6175],[6265,6271],[6315,6319],[6390,6399],6431,[6444,6447],[6460,6463],[6465,6467],[6510,6511],[6517,6527],[6572,6575],[6602,6607],[6619,6621],[6684,6685],6751,[6781,6782],[6794,6799],[6810,6815],[6830,6831],[6863,6911],[6989,6991],7039,[7156,7163],[7224,7226],[7242,7244],[7305,7311],[7355,7356],[7368,7375],[7419,7423],[7958,7959],[7966,7967],[8006,8007],[8014,8015],8024,8026,8028,8030,[8062,8063],8117,8133,[8148,8149],8156,[8176,8177],8181,8191,8293,[8306,8307],8335,[8349,8351],[8385,8399],[8433,8447],[8588,8591],[9255,9279],[9291,9311],[11124,11125],11158,[11508,11512],11558,[11560,11564],[11566,11567],[11624,11630],[11633,11646],[11671,11679],11687,11695,11703,11711,11719,11727,11735,11743,[11870,11903],11930,[12020,12031],[12246,12271],[12284,12287],12352,[12439,12440],[12544,12548],12592,12687,[12772,12783],12831,[42125,42127],[42183,42191],[42540,42559],[42744,42751],[42955,42959],42962,42964,[42970,42993],[43053,43055],[43066,43071],[43128,43135],[43206,43213],[43226,43231],[43348,43358],[43389,43391],43470,[43482,43485],43519,[43575,43583],[43598,43599],[43610,43611],[43715,43738],[43767,43776],[43783,43784],[43791,43792],[43799,43807],43815,43823,[43884,43887],[44014,44015],[44026,44031],[55204,55215],[55239,55242],[55292,55295],[64110,64111],[64218,64255],[64263,64274],[64280,64284],64311,64317,64319,64322,64325,[64451,64466],[64912,64913],[64968,64974],[64976,65007],[65050,65055],65107,65127,[65132,65135],65141,[65277,65278],65280,[65471,65473],[65480,65481],[65488,65489],[65496,65497],[65501,65503],65511,[65519,65528],[65534,65535],65548,65575,65595,65598,[65614,65615],[65630,65663],[65787,65791],[65795,65798],[65844,65846],65935,[65949,65951],[65953,65999],[66046,66175],[66205,66207],[66257,66271],[66300,66303],[66340,66348],[66379,66383],[66427,66431],66462,[66500,66503],[66518,66559],[66718,66719],[66730,66735],[66772,66775],[66812,66815],[66856,66863],[66916,66926],66939,66955,66963,66966,66978,66994,67002,[67005,67071],[67383,67391],[67414,67423],[67432,67455],67462,67505,[67515,67583],[67590,67591],67593,67638,[67641,67643],[67645,67646],67670,[67743,67750],[67760,67807],67827,[67830,67834],[67868,67870],[67898,67902],[67904,67967],[68024,68027],[68048,68049],68100,[68103,68107],68116,68120,[68150,68151],[68155,68158],[68169,68175],[68185,68191],[68256,68287],[68327,68330],[68343,68351],[68406,68408],[68438,68439],[68467,68471],[68498,68504],[68509,68520],[68528,68607],[68681,68735],[68787,68799],[68851,68857],[68904,68911],[68922,69215],69247,69290,[69294,69295],[69298,69372],[69416,69423],[69466,69487],[69514,69551],[69580,69599],[69623,69631],[69710,69713],[69750,69758],[69827,69836],[69838,69839],[69865,69871],[69882,69887],69941,[69960,69967],[70007,70015],70112,[70133,70143],70162,[70210,70271],70279,70281,70286,70302,[70314,70319],[70379,70383],[70394,70399],70404,[70413,70414],[70417,70418],70441,70449,70452,70458,[70469,70470],[70473,70474],[70478,70479],[70481,70486],[70488,70492],[70500,70501],[70509,70511],[70517,70655],70748,[70754,70783],[70856,70863],[70874,71039],[71094,71095],[71134,71167],[71237,71247],[71258,71263],[71277,71295],[71354,71359],[71370,71423],[71451,71452],[71468,71471],[71495,71679],[71740,71839],[71923,71934],[71943,71944],[71946,71947],71956,71959,71990,[71993,71994],[72007,72015],[72026,72095],[72104,72105],[72152,72153],[72165,72191],[72264,72271],[72355,72367],[72441,72447],[72458,72703],72713,72759,[72774,72783],[72813,72815],[72848,72849],72872,[72887,72959],72967,72970,[73015,73017],73019,73022,[73032,73039],[73050,73055],73062,73065,73103,73106,[73113,73119],[73130,73439],[73465,73471],73489,[73531,73533],[73562,73647],[73649,73663],[73714,73726],[74650,74751],74863,[74869,74879],[75076,77711],[77811,77823],[78934,82943],[83527,92159],[92729,92735],92767,[92778,92781],92863,[92874,92879],[92910,92911],[92918,92927],[92998,93007],93018,93026,[93048,93052],[93072,93759],[93851,93951],[94027,94030],[94088,94094],[94112,94175],[94181,94191],[94194,94207],[100344,100351],[101590,101631],[101641,110575],110580,110588,110591,[110883,110897],[110899,110927],[110931,110932],[110934,110947],[110952,110959],[111356,113663],[113771,113775],[113789,113791],[113801,113807],[113818,113819],[113828,118527],[118574,118575],[118599,118607],[118724,118783],[119030,119039],[119079,119080],[119275,119295],[119366,119487],[119508,119519],[119540,119551],[119639,119647],[119673,119807],119893,119965,[119968,119969],[119971,119972],[119975,119976],119981,119994,119996,120004,120070,[120075,120076],120085,120093,120122,120127,120133,[120135,120137],120145,[120486,120487],[120780,120781],[121484,121498],121504,[121520,122623],[122655,122660],[122667,122879],122887,[122905,122906],122914,122917,[122923,122927],[122990,123022],[123024,123135],[123181,123183],[123198,123199],[123210,123213],[123216,123535],[123567,123583],[123642,123646],[123648,124111],[124154,124895],124903,124908,124911,124927,[125125,125126],[125143,125183],[125260,125263],[125274,125277],[125280,126064],[126133,126208],[126270,126463],126468,126496,126499,[126501,126502],126504,126515,126520,126522,[126524,126529],[126531,126534],126536,126538,126540,126544,126547,[126549,126550],126552,126554,126556,126558,126560,126563,[126565,126566],126571,126579,126584,126589,126591,126602,[126620,126624],126628,126634,[126652,126703],[126706,126975],[127020,127023],[127124,127135],[127151,127152],127168,127184,[127222,127231],[127406,127461],[127491,127503],[127548,127551],[127561,127567],[127570,127583],[127590,127743],[128728,128731],[128749,128751],[128765,128767],[128887,128890],[128986,128991],[129004,129007],[129009,129023],[129036,129039],[129096,129103],[129114,129119],[129160,129167],[129198,129199],[129202,129279],[129620,129631],[129646,129647],[129661,129663],[129673,129679],129726,[129734,129741],[129756,129759],[129769,129775],[129785,129791],129939,[129995,130031],[130042,131071],[173792,173823],[177978,177983],[178206,178207],[183970,183983],[191457,194559],[195102,196607],[201547,201551],[205744,917504],[917506,917535],[917632,917759],[918e3,983039],[1048574,1048575],[1114110,1114111]],Ole=[[65,90],[192,214],[216,222],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,330,332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,452,455,458,461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,497,500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],975,[978,980],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,1012,1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],[4256,4293],4295,4301,[5024,5109],[7312,7354],[7357,7359],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8120,8123],[8136,8139],[8152,8155],[8168,8172],[8184,8187],8450,8455,[8459,8461],[8464,8466],8469,[8473,8477],8484,8486,8488,[8490,8493],[8496,8499],[8510,8511],8517,8579,[11264,11311],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,42936,42938,42940,42942,42944,42946,[42948,42951],42953,42960,42966,42968,42997,[65313,65338],[66560,66599],[66736,66771],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[68736,68786],[71840,71871],[93760,93791],[119808,119833],[119860,119885],[119912,119937],119964,[119966,119967],119970,[119973,119974],[119977,119980],[119982,119989],[120016,120041],[120068,120069],[120071,120074],[120077,120084],[120086,120092],[120120,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120172,120197],[120224,120249],[120276,120301],[120328,120353],[120380,120405],[120432,120457],[120488,120512],[120546,120570],[120604,120628],[120662,120686],[120720,120744],120778,[125184,125217]],Tle=Object.freeze(Object.defineProperty({__proto__:null,Cased_Letter:Y1e,Close_Punctuation:G1e,Connector_Punctuation:K1e,Control:Z1e,Currency_Symbol:q1e,Dash_Punctuation:Q1e,Decimal_Number:J1e,Enclosing_Mark:ele,Final_Punctuation:tle,Format:nle,Initial_Punctuation:rle,Letter:ile,Letter_Number:ole,Line_Separator:sle,Lowercase_Letter:ale,Mark:lle,Math_Symbol:ule,Modifier_Letter:cle,Modifier_Symbol:dle,Nonspacing_Mark:hle,Number:fle,Open_Punctuation:mle,Other:ple,Other_Letter:gle,Other_Number:vle,Other_Punctuation:_le,Other_Symbol:ble,Paragraph_Separator:Cle,Private_Use:yle,Punctuation:Sle,Separator:Ele,Space_Separator:wle,Spacing_Mark:Rle,Surrogate:Dle,Symbol:Ile,Titlecase_Letter:xle,Unassigned:Mle,Uppercase_Letter:Ole},Symbol.toStringTag,{value:"Module"})),$le=[1544,1547,1549,[1563,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],1969,[2144,2154],[2160,2190],[2208,2249],[64336,64450],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[68864,68899],[69424,69445],[69457,69465],[126065,126132],[126209,126269],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651]],kle=[[1536,1541],[1632,1641],[1643,1644],1757,[2192,2193],2274,[68912,68921],[69216,69246]],Ale=[[0,8],[14,27],[127,132],[134,159],173,6158,[8203,8205],[8288,8292],[8298,8303],65279,[113824,113827],[119155,119162],917505,[917536,917631]],Nle=[44,[46,47],58,160,1548,8239,8260,65104,65106,65109,65292,[65294,65295],65306],Lle=[[48,57],[178,179],185,[1776,1785],8304,[8308,8313],[8320,8329],[9352,9371],[65296,65305],[66273,66299],[120782,120831],[127232,127242],[130032,130041]],Ple=[43,45,[8314,8315],[8330,8331],8722,64297,[65122,65123],65291,65293],Ble=[[35,37],[162,165],[176,177],1423,[1545,1546],1642,[2546,2547],2555,2801,3065,3647,6107,[8240,8244],[8352,8384],8494,8723,[43064,43065],65119,[65129,65130],[65283,65285],[65504,65505],[65509,65510],[73693,73696],123647],Fle=[8296],Ule=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,696],[699,705],[720,721],[736,740],750,[880,883],[886,887],[890,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1154],[1162,1327],[1329,1366],[1369,1417],[2307,2361],2363,[2365,2368],[2377,2380],[2382,2384],[2392,2401],[2404,2432],[2434,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2493,2496],[2503,2504],[2507,2508],2510,2519,[2524,2525],[2527,2529],[2534,2545],[2548,2554],[2556,2557],2563,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2622,2624],[2649,2652],2654,[2662,2671],[2674,2676],2678,2691,[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2749,2752],2761,[2763,2764],2768,[2784,2785],[2790,2800],2809,[2818,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2877,2878],2880,[2887,2888],[2891,2892],2903,[2908,2909],[2911,2913],[2918,2935],2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3007],[3009,3010],[3014,3016],[3018,3020],3024,3031,[3046,3058],[3073,3075],[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3137,3140],[3160,3162],3165,[3168,3169],[3174,3183],3191,[3199,3200],[3202,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3261,3268],[3270,3272],[3274,3275],[3285,3286],[3293,3294],[3296,3297],[3302,3311],[3313,3315],[3330,3340],[3342,3344],[3346,3386],[3389,3392],[3398,3400],[3402,3404],[3406,3407],[3412,3425],[3430,3455],[3458,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3535,3537],[3544,3551],[3558,3567],[3570,3572],[3585,3632],[3634,3635],[3648,3654],[3663,3675],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3760],[3762,3763],3773,[3776,3780],3782,[3792,3801],[3804,3807],[3840,3863],[3866,3892],3894,3896,[3902,3911],[3913,3948],3967,3973,[3976,3980],[4030,4037],[4039,4044],[4046,4058],[4096,4140],4145,4152,[4155,4156],[4159,4183],[4186,4189],[4193,4208],[4213,4225],[4227,4228],[4231,4236],[4238,4252],[4254,4293],4295,4301,[4304,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4960,4988],[4992,5007],[5024,5109],[5112,5117],[5121,5759],[5761,5786],[5792,5880],[5888,5905],5909,[5919,5937],[5940,5942],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6070,[6078,6085],[6087,6088],[6100,6106],6108,[6112,6121],[6160,6169],[6176,6264],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6435,6438],[6441,6443],[6448,6449],[6451,6456],[6470,6509],[6512,6516],[6528,6571],[6576,6601],[6608,6618],[6656,6678],[6681,6682],[6686,6741],6743,6753,[6755,6756],[6765,6770],[6784,6793],[6800,6809],[6816,6829],[6916,6963],6965,6971,[6973,6977],[6979,6988],[6992,7018],[7028,7038],[7042,7073],[7078,7079],7082,[7086,7141],7143,[7146,7148],7150,[7154,7155],[7164,7211],[7220,7221],[7227,7241],[7245,7304],[7312,7354],[7357,7367],7379,7393,[7401,7404],[7406,7411],[7413,7415],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8206,8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8473,8477],8484,8486,8488,[8490,8493],[8495,8505],[8508,8511],[8517,8521],[8526,8527],[8544,8584],[9014,9082],9109,[9372,9449],9900,[10240,10495],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[11568,11623],[11631,11632],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[12293,12295],[12321,12329],[12334,12335],[12337,12341],[12344,12348],[12353,12438],[12445,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12688,12735],[12784,12828],[12832,12879],[12896,12923],[12927,12976],[12992,13003],[13008,13174],[13179,13277],[13280,13310],[13312,19903],[19968,42124],[42192,42508],[42512,42539],[42560,42606],[42624,42653],[42656,42735],[42738,42743],[42786,42887],[42889,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43044],43047,[43056,43063],[43072,43123],[43136,43203],[43214,43225],[43250,43262],[43264,43301],[43310,43334],[43346,43347],[43359,43388],[43395,43442],[43444,43445],[43450,43451],[43454,43469],[43471,43481],[43486,43492],[43494,43518],[43520,43560],[43567,43568],[43571,43572],[43584,43586],[43588,43595],43597,[43600,43609],[43612,43643],[43645,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43755],[43758,43765],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43881],[43888,44004],[44006,44007],[44009,44012],[44016,44025],[44032,55203],[55216,55238],[55243,55291],[55296,64109],[64112,64217],[64256,64262],[64275,64279],[65313,65338],[65345,65370],[65382,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],65792,65794,[65799,65843],[65847,65855],[65933,65934],[66e3,66044],[66176,66204],[66208,66256],[66304,66339],[66349,66378],[66384,66421],[66432,66461],[66463,66499],[66504,66517],[66560,66717],[66720,66729],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66927,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],69632,[69634,69687],[69703,69709],[69734,69743],[69745,69746],69749,[69762,69810],[69815,69816],[69819,69825],69837,[69840,69864],[69872,69881],[69891,69926],69932,[69942,69959],[69968,70002],[70004,70006],[70018,70069],[70079,70088],[70093,70094],[70096,70111],[70113,70132],[70144,70161],[70163,70190],[70194,70195],70197,[70200,70205],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70313],[70320,70366],[70368,70370],[70384,70393],[70402,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70461,70463],[70465,70468],[70471,70472],[70475,70477],70480,70487,[70493,70499],[70656,70711],[70720,70721],70725,[70727,70747],70749,[70751,70753],[70784,70834],70841,[70843,70846],70849,[70852,70855],[70864,70873],[71040,71089],[71096,71099],71102,[71105,71131],[71168,71218],[71227,71228],71230,[71233,71236],[71248,71257],[71296,71338],71340,[71342,71343],71350,[71352,71353],[71360,71369],[71424,71450],[71456,71457],71462,[71472,71494],[71680,71726],71736,71739,[71840,71922],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],71997,[71999,72002],[72004,72006],[72016,72025],[72096,72103],[72106,72147],[72156,72159],[72161,72164],72192,[72199,72200],[72203,72242],[72249,72250],[72255,72262],72272,[72279,72280],[72284,72329],72343,[72346,72354],[72368,72440],[72448,72457],[72704,72712],[72714,72751],[72766,72773],[72784,72812],[72816,72847],72873,72881,72884,[72960,72966],[72968,72969],[72971,73008],73030,[73040,73049],[73056,73061],[73063,73064],[73066,73102],[73107,73108],73110,73112,[73120,73129],[73440,73458],[73461,73464],[73474,73488],[73490,73525],[73534,73535],73537,[73539,73561],73648,[73664,73684],[73727,74649],[74752,74862],[74864,74868],[74880,75075],[77712,77810],[77824,78911],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92768,92777],[92782,92862],[92864,92873],[92880,92909],92917,[92928,92975],[92983,92997],[93008,93017],[93019,93025],[93027,93047],[93053,93071],[93760,93850],[93952,94026],[94032,94087],[94099,94111],[94176,94177],94179,[94192,94193],[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],113820,113823,[118608,118723],[118784,119029],[119040,119078],[119081,119142],[119146,119154],[119171,119172],[119180,119209],[119214,119272],[119488,119507],[119520,119539],[119648,119672],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120538],[120540,120596],[120598,120654],[120656,120712],[120714,120770],[120772,120779],[120832,121343],[121399,121402],[121453,121460],[121462,121475],[121477,121483],[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],[123200,123209],[123214,123215],[123536,123565],[123584,123627],[123632,123641],[124112,124139],[124144,124153],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[127248,127278],[127280,127337],[127344,127404],[127462,127490],[127504,127547],[127552,127560],[127568,127569],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743],[983040,1048573],[1048576,1114109]],Hle=[8234],Vle=[8294],jle=[8237],zle=[[768,879],[1155,1161],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],2045,[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2200,2207],[2250,2273],[2275,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2433,2492,[2497,2500],2509,[2530,2531],2558,[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,2879,[2881,2884],2893,[2901,2902],[2914,2915],2946,3008,3021,3072,3076,3132,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],3405,[3426,3427],3457,3530,[3538,3540],3542,3633,[3636,3642],[3655,3662],3761,[3764,3772],[3784,3790],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,[4957,4959],[5906,5908],[5938,5939],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6109,[6155,6157],6159,[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,[6832,6862],[6912,6915],6964,[6966,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7679],[8400,8432],[11503,11505],11647,[11744,11775],[12330,12333],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43045,43046],43052,[43204,43205],[43232,43249],43263,[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],[43452,43453],43493,[43561,43566],[43569,43570],[43573,43574],43587,43596,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,[43756,43757],43766,44005,44008,44013,64286,[65024,65039],[65056,65071],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],69633,[69688,69702],69744,[69747,69748],[69759,69761],[69811,69814],[69817,69818],69826,[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70089,70092],70095,[70191,70193],70196,[70198,70199],70206,70209,70367,[70371,70378],[70400,70401],[70459,70460],70464,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,70750,[70835,70840],70842,[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[71727,71735],[71737,71738],[71995,71996],71998,72003,[72148,72151],[72154,72155],72160,[72193,72198],[72201,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73104,73105],73109,73111,[73459,73460],[73472,73473],[73526,73530],73536,73538,78912,[78919,78933],[92912,92916],[92976,92982],94031,[94095,94098],94180,[113821,113822],[118528,118573],[118576,118598],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,[123184,123190],123566,[123628,123631],[124140,124143],[125136,125142],[125252,125258],[917760,917999]],Wle=[[33,34],[38,42],[59,64],[91,96],[123,126],161,[166,169],[171,172],[174,175],180,[182,184],[187,191],215,247,[697,698],[706,719],[722,735],[741,749],[751,767],[884,885],894,[900,901],903,1014,1418,[1421,1422],[1542,1543],[1550,1551],1758,1769,[2038,2041],[3059,3064],3066,[3192,3198],[3898,3901],[5008,5017],5120,[5787,5788],[6128,6137],[6144,6154],6464,[6468,6469],[6622,6655],8125,[8127,8129],[8141,8143],[8157,8159],[8173,8175],[8189,8190],[8208,8231],[8245,8259],[8261,8286],[8316,8318],[8332,8334],[8448,8449],[8451,8454],[8456,8457],8468,[8470,8472],[8478,8483],8485,8487,8489,[8506,8507],[8512,8516],[8522,8525],[8528,8543],[8585,8587],[8592,8721],[8724,9013],[9083,9108],[9110,9254],[9280,9290],[9312,9351],[9450,9899],[9901,10239],[10496,11123],[11126,11157],[11159,11263],[11493,11498],[11513,11519],[11776,11869],[11904,11929],[11931,12019],[12032,12245],[12272,12283],[12289,12292],[12296,12320],12336,[12342,12343],[12349,12351],[12443,12444],12448,12539,[12736,12771],[12829,12830],[12880,12895],[12924,12926],[12977,12991],[13004,13007],[13175,13178],[13278,13279],13311,[19904,19967],[42128,42182],[42509,42511],42611,[42622,42623],[42752,42785],42888,[43048,43051],[43124,43127],[43882,43883],[64830,64847],64975,[65021,65023],[65040,65049],[65072,65103],65105,65108,[65110,65118],[65120,65121],[65124,65126],65128,65131,[65281,65282],[65286,65290],[65307,65312],[65339,65344],[65371,65381],[65506,65508],[65512,65518],[65529,65533],65793,[65856,65932],[65936,65948],65952,67871,[68409,68415],[69714,69733],[71264,71276],[73685,73692],[73697,73713],94178,[119273,119274],[119296,119361],119365,[119552,119638],120539,120597,120655,120713,120771,[126704,126705],[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127243,127247],127279,[127338,127343],127405,[127584,127589],[127744,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994]],Xle=[10,13,[28,30],133,8233],Yle=[8236],Gle=[8297],Kle=[1470,1472,1475,1478,[1488,1514],[1519,1524],[1984,2026],[2036,2037],2042,[2046,2069],2074,2084,2088,[2096,2110],[2112,2136],2142,8207,64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67671,67742],[67751,67759],[67808,67826],[67828,67829],[67835,67867],[67872,67897],67903,[67968,68023],[68028,68047],[68050,68096],[68112,68115],[68117,68119],[68121,68149],[68160,68168],[68176,68184],[68192,68255],[68288,68324],[68331,68342],[68352,68405],[68416,68437],[68440,68466],[68472,68497],[68505,68508],[68521,68527],[68608,68680],[68736,68786],[68800,68850],[68858,68863],[69248,69289],69293,[69296,69297],[69376,69415],[69488,69505],[69510,69513],[69552,69579],[69600,69622],[124928,125124],[125127,125135],[125184,125251],125259,[125264,125273],[125278,125279]],Zle=[8235],qle=[8295],Qle=[8238],Jle=[9,11,31],eue=[12,32,5760,[8192,8202],8232,8287,12288],tue=Object.freeze(Object.defineProperty({__proto__:null,Arabic_Letter:$le,Arabic_Number:kle,Boundary_Neutral:Ale,Common_Separator:Nle,European_Number:Lle,European_Separator:Ple,European_Terminator:Ble,First_Strong_Isolate:Fle,Left_To_Right:Ule,Left_To_Right_Embedding:Hle,Left_To_Right_Isolate:Vle,Left_To_Right_Override:jle,Nonspacing_Mark:zle,Other_Neutral:Wle,Paragraph_Separator:Xle,Pop_Directional_Format:Yle,Pop_Directional_Isolate:Gle,Right_To_Left:Kle,Right_To_Left_Embedding:Zle,Right_To_Left_Isolate:qle,Right_To_Left_Override:Qle,Segment_Separator:Jle,White_Space:eue},Symbol.toStringTag,{value:"Module"})),nue=[[125184,125259],[125264,125273],[125278,125279]],rue=[[71424,71450],[71453,71467],[71472,71494]],iue=[[82944,83526]],oue=[[1536,1540],[1542,1547],[1549,1562],[1564,1566],[1568,1599],[1601,1610],[1622,1647],[1649,1756],[1758,1791],[1872,1919],[2160,2190],[2192,2193],[2200,2273],[2275,2303],[64336,64450],[64467,64829],[64832,64911],[64914,64967],64975,[65008,65023],[65136,65140],[65142,65276],[69216,69246],[69373,69375],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[126704,126705]],sue=[[1329,1366],[1369,1418],[1421,1423],[64275,64279]],aue=[[68352,68405],[68409,68415]],lue=[[6912,6988],[6992,7038]],uue=[[42656,42743],[92160,92728]],cue=[[92880,92909],[92912,92917]],due=[[7104,7155],[7164,7167]],hue=[[2432,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2492,2500],[2503,2504],[2507,2510],2519,[2524,2525],[2527,2531],[2534,2558]],fue=[[72704,72712],[72714,72758],[72760,72773],[72784,72812]],mue=[[746,747],[12549,12591],[12704,12735]],pue=[[69632,69709],[69714,69749],69759],gue=[[10240,10495]],vue=[[6656,6683],[6686,6687]],_ue=[[5952,5971]],bue=[[5120,5759],[6320,6389],[72368,72383]],Cue=[[66208,66256]],yue=[[66864,66915],66927],Sue=[[69888,69940],[69942,69959]],Eue=[[43520,43574],[43584,43597],[43600,43609],[43612,43615]],wue=[[5024,5109],[5112,5117],[43888,43967]],Rue=[[69552,69579]],Due=[[0,64],[91,96],[123,169],[171,185],[187,191],215,247,[697,735],[741,745],[748,767],884,894,901,903,1541,1548,1563,1567,1600,1757,2274,[2404,2405],3647,[4053,4056],4347,[5867,5869],[5941,5942],[6146,6147],6149,7379,7393,[7401,7404],[7406,7411],[7413,7415],7418,[8192,8203],[8206,8292],[8294,8304],[8308,8318],[8320,8334],[8352,8384],[8448,8485],[8487,8489],[8492,8497],[8499,8525],[8527,8543],[8585,8587],[8592,9254],[9280,9290],[9312,10239],[10496,11123],[11126,11157],[11159,11263],[11776,11869],[12272,12283],[12288,12292],12294,[12296,12320],[12336,12343],[12348,12351],[12443,12444],12448,[12539,12540],[12688,12703],[12736,12771],[12832,12895],[12927,13007],13055,[13144,13311],[19904,19967],[42752,42785],[42888,42890],[43056,43065],43310,43471,43867,[43882,43883],[64830,64831],[65040,65049],[65072,65106],[65108,65126],[65128,65131],65279,[65281,65312],[65339,65344],[65371,65381],65392,[65438,65439],[65504,65510],[65512,65518],[65529,65533],[65792,65794],[65799,65843],[65847,65855],[65936,65948],[66e3,66044],[66273,66299],[113824,113827],[118608,118723],[118784,119029],[119040,119078],[119081,119142],[119146,119162],[119171,119172],[119180,119209],[119214,119274],[119488,119507],[119520,119539],[119552,119638],[119648,119672],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120782,120831],[126065,126132],[126209,126269],[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127232,127405],[127462,127487],[127489,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994],[130032,130041],917505,[917536,917631]],Iue=[[994,1007],[11392,11507],[11513,11519]],xue=[[73728,74649],[74752,74862],[74864,74868],[74880,75075]],Mue=[[67584,67589],67592,[67594,67637],[67639,67640],67644,67647],Oue=[[77712,77810]],Tue=[[1024,1156],[1159,1327],[7296,7304],7467,7544,[11744,11775],[42560,42655],[65070,65071],[122928,122989],123023],$ue=[[66560,66639]],kue=[[2304,2384],[2389,2403],[2406,2431],[43232,43263],[72448,72457]],Aue=[[71936,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],[71995,72006],[72016,72025]],Nue=[[71680,71739]],Lue=[[113664,113770],[113776,113788],[113792,113800],[113808,113817],[113820,113823]],Pue=[[77824,78933]],Bue=[[66816,66855]],Fue=[[69600,69622]],Uue=[[4608,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4957,4988],[4992,5017],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[124896,124902],[124904,124907],[124909,124910],[124912,124926]],Hue=[[4256,4293],4295,4301,[4304,4346],[4348,4351],[7312,7354],[7357,7359],[11520,11557],11559,11565],Vue=[[11264,11359],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922]],jue=[[66352,66378]],zue=[[70400,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70460,70468],[70471,70472],[70475,70477],70480,70487,[70493,70499],[70502,70508],[70512,70516]],Wue=[[880,883],[885,887],[890,893],895,900,902,[904,906],908,[910,929],[931,993],[1008,1023],[7462,7466],[7517,7521],[7526,7530],7615,[7936,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8132],[8134,8147],[8150,8155],[8157,8175],[8178,8180],[8182,8190],8486,43877,[65856,65934],65952,[119296,119365]],Xue=[[2689,2691],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2748,2757],[2759,2761],[2763,2765],2768,[2784,2787],[2790,2801],[2809,2815]],Yue=[[73056,73061],[73063,73064],[73066,73102],[73104,73105],[73107,73112],[73120,73129]],Gue=[[2561,2563],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2649,2652],2654,[2662,2678]],Kue=[[11904,11929],[11931,12019],[12032,12245],12293,12295,[12321,12329],[12344,12347],[13312,19903],[19968,40959],[63744,64109],[64112,64217],[94178,94179],[94192,94193],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],Zue=[[4352,4607],[12334,12335],[12593,12686],[12800,12830],[12896,12926],[43360,43388],[44032,55203],[55216,55238],[55243,55291],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500]],que=[[68864,68903],[68912,68921]],Que=[[5920,5940]],Jue=[[67808,67826],[67828,67829],[67835,67839]],ece=[[1425,1479],[1488,1514],[1519,1524],[64285,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335]],tce=[[12353,12438],[12445,12447],[110593,110879],110898,[110928,110930],127488],nce=[[67648,67669],[67671,67679]],rce=[[768,879],[1157,1158],[1611,1621],1648,[2385,2388],[6832,6862],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7679],[8204,8205],[8400,8432],[12330,12333],[12441,12442],[65024,65039],[65056,65069],66045,66272,70459,[118528,118573],[118576,118598],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[917760,917999]],ice=[[68448,68466],[68472,68479]],oce=[[68416,68437],[68440,68447]],sce=[[43392,43469],[43472,43481],[43486,43487]],ace=[[69760,69826],69837],lce=[[3200,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3260,3268],[3270,3272],[3274,3277],[3285,3286],[3293,3294],[3296,3299],[3302,3311],[3313,3315]],uce=[[12449,12538],[12541,12543],[12784,12799],[13008,13054],[13056,13143],[65382,65391],[65393,65437],[110576,110579],[110581,110587],[110589,110590],110592,[110880,110882],110933,[110948,110951]],cce=[[73472,73488],[73490,73530],[73534,73561]],dce=[[43264,43309],43311],hce=[[68096,68099],[68101,68102],[68108,68115],[68117,68119],[68121,68149],[68152,68154],[68159,68168],[68176,68184]],fce=[94180,[101120,101589]],mce=[[6016,6109],[6112,6121],[6128,6137],[6624,6655]],pce=[[70144,70161],[70163,70209]],gce=[[70320,70378],[70384,70393]],vce=[[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3773],[3776,3780],3782,[3784,3790],[3792,3801],[3804,3807]],_ce=[[65,90],[97,122],170,186,[192,214],[216,246],[248,696],[736,740],[7424,7461],[7468,7516],[7522,7525],[7531,7543],[7545,7614],[7680,7935],8305,8319,[8336,8348],[8490,8491],8498,8526,[8544,8584],[11360,11391],[42786,42887],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43007],[43824,43866],[43868,43876],[43878,43881],[64256,64262],[65313,65338],[65345,65370],[67456,67461],[67463,67504],[67506,67514],[122624,122654],[122661,122666]],bce=[[7168,7223],[7227,7241],[7245,7247]],Cce=[[6400,6430],[6432,6443],[6448,6459],6464,[6468,6479]],yce=[[67072,67382],[67392,67413],[67424,67431]],Sce=[[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786]],Ece=[[42192,42239],73648],wce=[[66176,66204]],Rce=[[67872,67897],67903],Dce=[[69968,70006]],Ice=[[73440,73464]],xce=[[3328,3340],[3342,3344],[3346,3396],[3398,3400],[3402,3407],[3412,3427],[3430,3455]],Mce=[[2112,2139],2142],Oce=[[68288,68326],[68331,68342]],Tce=[[72816,72847],[72850,72871],[72873,72886]],$ce=[[72960,72966],[72968,72969],[72971,73014],73018,[73020,73021],[73023,73031],[73040,73049]],kce=[[93760,93850]],Ace=[[43744,43766],[43968,44013],[44016,44025]],Nce=[[124928,125124],[125127,125142]],Lce=[[68e3,68023],[68028,68047],[68050,68095]],Pce=[[67968,67999]],Bce=[[93952,94026],[94031,94087],[94095,94111]],Fce=[[71168,71236],[71248,71257]],Uce=[[6144,6145],6148,[6150,6169],[6176,6264],[6272,6314],[71264,71276]],Hce=[[92736,92766],[92768,92777],[92782,92783]],Vce=[[70272,70278],70280,[70282,70285],[70287,70301],[70303,70313]],jce=[[4096,4255],[43488,43518],[43616,43647]],zce=[[67712,67742],[67751,67759]],Wce=[[124112,124153]],Xce=[[72096,72103],[72106,72151],[72154,72164]],Yce=[[6528,6571],[6576,6601],[6608,6618],[6622,6623]],Gce=[[70656,70747],[70749,70753]],Kce=[[1984,2042],[2045,2047]],Zce=[94177,[110960,111355]],qce=[[123136,123180],[123184,123197],[123200,123209],[123214,123215]],Qce=[[5760,5788]],Jce=[[7248,7295]],e2e=[[68736,68786],[68800,68850],[68858,68863]],t2e=[[66304,66339],[66349,66351]],n2e=[[68224,68255]],r2e=[[66384,66426]],i2e=[[66464,66499],[66504,66517]],o2e=[[69376,69415]],s2e=[[68192,68223]],a2e=[[68608,68680]],l2e=[[69488,69513]],u2e=[[2817,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2876,2884],[2887,2888],[2891,2893],[2901,2903],[2908,2909],[2911,2915],[2918,2935]],c2e=[[66736,66771],[66776,66811]],d2e=[[66688,66717],[66720,66729]],h2e=[[92928,92997],[93008,93017],[93019,93025],[93027,93047],[93053,93071]],f2e=[[67680,67711]],m2e=[[72384,72440]],p2e=[[43072,43127]],g2e=[[67840,67867],67871],v2e=[[68480,68497],[68505,68508],[68521,68527]],_2e=[[43312,43347],43359],b2e=[[5792,5866],[5870,5880]],C2e=[[2048,2093],[2096,2110]],y2e=[[43136,43205],[43214,43225]],S2e=[[70016,70111]],E2e=[[66640,66687]],w2e=[[71040,71093],[71096,71133]],R2e=[[120832,121483],[121499,121503],[121505,121519]],D2e=[[3457,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3530,[3535,3540],3542,[3544,3551],[3558,3567],[3570,3572],[70113,70132]],I2e=[[69424,69465]],x2e=[[69840,69864],[69872,69881]],M2e=[[72272,72354]],O2e=[[7040,7103],[7360,7367]],T2e=[[43008,43052]],$2e=[[1792,1805],[1807,1866],[1869,1871],[2144,2154]],k2e=[[5888,5909],5919],A2e=[[5984,5996],[5998,6e3],[6002,6003]],N2e=[[6480,6509],[6512,6516]],L2e=[[6688,6750],[6752,6780],[6783,6793],[6800,6809],[6816,6829]],P2e=[[43648,43714],[43739,43743]],B2e=[[71296,71353],[71360,71369]],F2e=[[2946,2947],[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3010],[3014,3016],[3018,3021],3024,3031,[3046,3066],[73664,73713],73727],U2e=[[92784,92862],[92864,92873]],H2e=[94176,[94208,100343],[100352,101119],[101632,101640]],V2e=[[3072,3084],[3086,3088],[3090,3112],[3114,3129],[3132,3140],[3142,3144],[3146,3149],[3157,3158],[3160,3162],3165,[3168,3171],[3174,3183],[3191,3199]],j2e=[[1920,1969]],z2e=[[3585,3642],[3648,3675]],W2e=[[3840,3911],[3913,3948],[3953,3991],[3993,4028],[4030,4044],[4046,4052],[4057,4058]],X2e=[[11568,11623],[11631,11632],11647],Y2e=[[70784,70855],[70864,70873]],G2e=[[123536,123566]],K2e=[[66432,66461],66463],Z2e=[[42240,42539]],q2e=[[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004]],Q2e=[[123584,123641],123647],J2e=[[71840,71922],71935],e0e=[[69248,69289],[69291,69293],[69296,69297]],t0e=[[40960,42124],[42128,42182]],n0e=[[72192,72263]],r0e=Object.freeze(Object.defineProperty({__proto__:null,Adlam:nue,Ahom:rue,Anatolian_Hieroglyphs:iue,Arabic:oue,Armenian:sue,Avestan:aue,Balinese:lue,Bamum:uue,Bassa_Vah:cue,Batak:due,Bengali:hue,Bhaiksuki:fue,Bopomofo:mue,Brahmi:pue,Braille:gue,Buginese:vue,Buhid:_ue,Canadian_Aboriginal:bue,Carian:Cue,Caucasian_Albanian:yue,Chakma:Sue,Cham:Eue,Cherokee:wue,Chorasmian:Rue,Common:Due,Coptic:Iue,Cuneiform:xue,Cypriot:Mue,Cypro_Minoan:Oue,Cyrillic:Tue,Deseret:$ue,Devanagari:kue,Dives_Akuru:Aue,Dogra:Nue,Duployan:Lue,Egyptian_Hieroglyphs:Pue,Elbasan:Bue,Elymaic:Fue,Ethiopic:Uue,Georgian:Hue,Glagolitic:Vue,Gothic:jue,Grantha:zue,Greek:Wue,Gujarati:Xue,Gunjala_Gondi:Yue,Gurmukhi:Gue,Han:Kue,Hangul:Zue,Hanifi_Rohingya:que,Hanunoo:Que,Hatran:Jue,Hebrew:ece,Hiragana:tce,Imperial_Aramaic:nce,Inherited:rce,Inscriptional_Pahlavi:ice,Inscriptional_Parthian:oce,Javanese:sce,Kaithi:ace,Kannada:lce,Katakana:uce,Kawi:cce,Kayah_Li:dce,Kharoshthi:hce,Khitan_Small_Script:fce,Khmer:mce,Khojki:pce,Khudawadi:gce,Lao:vce,Latin:_ce,Lepcha:bce,Limbu:Cce,Linear_A:yce,Linear_B:Sce,Lisu:Ece,Lycian:wce,Lydian:Rce,Mahajani:Dce,Makasar:Ice,Malayalam:xce,Mandaic:Mce,Manichaean:Oce,Marchen:Tce,Masaram_Gondi:$ce,Medefaidrin:kce,Meetei_Mayek:Ace,Mende_Kikakui:Nce,Meroitic_Cursive:Lce,Meroitic_Hieroglyphs:Pce,Miao:Bce,Modi:Fce,Mongolian:Uce,Mro:Hce,Multani:Vce,Myanmar:jce,Nabataean:zce,Nag_Mundari:Wce,Nandinagari:Xce,New_Tai_Lue:Yce,Newa:Gce,Nko:Kce,Nushu:Zce,Nyiakeng_Puachue_Hmong:qce,Ogham:Qce,Ol_Chiki:Jce,Old_Hungarian:e2e,Old_Italic:t2e,Old_North_Arabian:n2e,Old_Permic:r2e,Old_Persian:i2e,Old_Sogdian:o2e,Old_South_Arabian:s2e,Old_Turkic:a2e,Old_Uyghur:l2e,Oriya:u2e,Osage:c2e,Osmanya:d2e,Pahawh_Hmong:h2e,Palmyrene:f2e,Pau_Cin_Hau:m2e,Phags_Pa:p2e,Phoenician:g2e,Psalter_Pahlavi:v2e,Rejang:_2e,Runic:b2e,Samaritan:C2e,Saurashtra:y2e,Sharada:S2e,Shavian:E2e,Siddham:w2e,SignWriting:R2e,Sinhala:D2e,Sogdian:I2e,Sora_Sompeng:x2e,Soyombo:M2e,Sundanese:O2e,Syloti_Nagri:T2e,Syriac:$2e,Tagalog:k2e,Tagbanwa:A2e,Tai_Le:N2e,Tai_Tham:L2e,Tai_Viet:P2e,Takri:B2e,Tamil:F2e,Tangsa:U2e,Tangut:H2e,Telugu:V2e,Thaana:j2e,Thai:z2e,Tibetan:W2e,Tifinagh:X2e,Tirhuta:Y2e,Toto:G2e,Ugaritic:K2e,Vai:Z2e,Vithkuqi:q2e,Wancho:Q2e,Warang_Citi:J2e,Yezidi:e0e,Yi:t0e,Zanabazar_Square:n0e},Symbol.toStringTag,{value:"Module"})),i0e=[1567,1600,[125184,125259],[125264,125273],[125278,125279]],o0e=[[71424,71450],[71453,71467],[71472,71494]],s0e=[[82944,83526]],a0e=[[1536,1540],[1542,1756],[1758,1791],[1872,1919],[2160,2190],[2192,2193],[2200,2273],[2275,2303],[64336,64450],[64467,64911],[64914,64967],64975,[65008,65023],[65136,65140],[65142,65276],[66272,66299],[69216,69246],[69373,69375],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[126704,126705]],l0e=[[1329,1366],[1369,1418],[1421,1423],[64275,64279]],u0e=[[68352,68405],[68409,68415]],c0e=[[6912,6988],[6992,7038]],d0e=[[42656,42743],[92160,92728]],h0e=[[92880,92909],[92912,92917]],f0e=[[7104,7155],[7164,7167]],m0e=[[2385,2386],[2404,2405],[2432,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2492,2500],[2503,2504],[2507,2510],2519,[2524,2525],[2527,2531],[2534,2558],7376,7378,[7381,7382],7384,7393,7402,7405,7410,[7413,7415],43249],p0e=[[72704,72712],[72714,72758],[72760,72773],[72784,72812]],g0e=[[746,747],[12289,12291],[12296,12305],[12307,12319],[12330,12333],12336,12343,12539,[12549,12591],[12704,12735],[65093,65094],[65377,65381]],v0e=[[69632,69709],[69714,69749],69759],_0e=[[10240,10495]],b0e=[[6656,6683],[6686,6687],43471],C0e=[[5941,5942],[5952,5971]],y0e=[[5120,5759],[6320,6389],[72368,72383]],S0e=[[66208,66256]],E0e=[[66864,66915],66927],w0e=[[2534,2543],[4160,4169],[69888,69940],[69942,69959]],R0e=[[43520,43574],[43584,43597],[43600,43609],[43612,43615]],D0e=[[5024,5109],[5112,5117],[43888,43967]],I0e=[[69552,69579]],x0e=[[0,64],[91,96],[123,169],[171,185],[187,191],215,247,[697,735],[741,745],[748,767],884,894,901,903,1541,1757,2274,3647,[4053,4056],[5867,5869],[8192,8203],[8206,8238],[8240,8292],[8294,8304],[8308,8318],[8320,8334],[8352,8384],[8448,8485],[8487,8489],[8492,8497],[8499,8525],[8527,8543],[8585,8587],[8592,9254],[9280,9290],[9312,10239],[10496,11123],[11126,11157],[11159,11263],[11776,11842],[11844,11869],[12272,12283],12288,12292,12306,12320,12342,[12872,12895],12927,[12977,12991],[13004,13007],[13169,13178],[13184,13279],13311,[19904,19967],[42760,42785],[42888,42890],43867,[43882,43883],[65040,65049],[65072,65092],[65095,65106],[65108,65126],[65128,65131],65279,[65281,65312],[65339,65344],[65371,65376],[65504,65510],[65512,65518],[65529,65533],[65936,65948],[66e3,66044],[118608,118723],[118784,119029],[119040,119078],[119081,119142],[119146,119162],[119171,119172],[119180,119209],[119214,119274],[119488,119507],[119520,119539],[119552,119638],[119666,119672],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120782,120831],[126065,126132],[126209,126269],[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127232,127405],[127462,127487],[127489,127490],[127504,127547],[127552,127560],[127584,127589],[127744,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994],[130032,130041],917505,[917536,917631]],M0e=[[994,1007],[11392,11507],[11513,11519],[66272,66299]],O0e=[[73728,74649],[74752,74862],[74864,74868],[74880,75075]],T0e=[[65792,65794],[65799,65843],[65847,65855],[67584,67589],67592,[67594,67637],[67639,67640],67644,67647],$0e=[[65792,65793],[77712,77810]],k0e=[[1024,1327],[7296,7304],7467,7544,7672,[11744,11775],11843,[42560,42655],[65070,65071],[122928,122989],123023],A0e=[[66560,66639]],N0e=[[2304,2386],[2389,2431],[7376,7414],[7416,7417],8432,[43056,43065],[43232,43263],[72448,72457]],L0e=[[71936,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],[71995,72006],[72016,72025]],P0e=[[2404,2415],[43056,43065],[71680,71739]],B0e=[[113664,113770],[113776,113788],[113792,113800],[113808,113817],[113820,113827]],F0e=[[77824,78933]],U0e=[[66816,66855]],H0e=[[69600,69622]],V0e=[[4608,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4957,4988],[4992,5017],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[124896,124902],[124904,124907],[124909,124910],[124912,124926]],j0e=[[4256,4293],4295,4301,[4304,4351],[7312,7354],[7357,7359],[11520,11557],11559,11565],z0e=[1156,1159,[11264,11359],11843,42607,[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922]],W0e=[[66352,66378]],X0e=[[2385,2386],[2404,2405],[3046,3059],7376,[7378,7379],[7410,7412],[7416,7417],8432,[70400,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70459,70468],[70471,70472],[70475,70477],70480,70487,[70493,70499],[70502,70508],[70512,70516],[73680,73681],73683],Y0e=[834,837,[880,883],[885,887],[890,893],895,900,902,[904,906],908,[910,929],[931,993],[1008,1023],[7462,7466],[7517,7521],[7526,7530],[7615,7617],[7936,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8132],[8134,8147],[8150,8155],[8157,8175],[8178,8180],[8182,8190],8486,43877,[65856,65934],65952,[119296,119365]],G0e=[[2385,2386],[2404,2405],[2689,2691],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2748,2757],[2759,2761],[2763,2765],2768,[2784,2787],[2790,2801],[2809,2815],[43056,43065]],K0e=[[2404,2405],[73056,73061],[73063,73064],[73066,73102],[73104,73105],[73107,73112],[73120,73129]],Z0e=[[2385,2386],[2404,2405],[2561,2563],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2649,2652],2654,[2662,2678],[43056,43065]],q0e=[[11904,11929],[11931,12019],[12032,12245],[12289,12291],[12293,12305],[12307,12319],[12321,12333],12336,[12343,12351],12539,[12688,12703],[12736,12771],[12832,12871],[12928,12976],[12992,13003],13055,[13144,13168],[13179,13183],[13280,13310],[13312,19903],[19968,40959],[42752,42759],[63744,64109],[64112,64217],[65093,65094],[65377,65381],[94178,94179],[94192,94193],[119648,119665],[127568,127569],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],Q0e=[[4352,4607],[12289,12291],[12296,12305],[12307,12319],[12334,12336],12343,12539,[12593,12686],[12800,12830],[12896,12926],[43360,43388],[44032,55203],[55216,55238],[55243,55291],[65093,65094],[65377,65381],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500]],J0e=[1548,1563,1567,1600,1748,[68864,68903],[68912,68921]],ede=[[5920,5942]],tde=[[67808,67826],[67828,67829],[67835,67839]],nde=[[1425,1479],[1488,1514],[1519,1524],[64285,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335]],rde=[[12289,12291],[12296,12305],[12307,12319],[12336,12341],12343,[12348,12349],[12353,12438],[12441,12448],[12539,12540],[65093,65094],[65377,65381],65392,[65438,65439],[110593,110879],110898,[110928,110930],127488],ide=[[67648,67669],[67671,67679]],ode=[[768,833],[835,836],[838,866],[2387,2388],[6832,6862],[7618,7671],7673,[7675,7679],[8204,8205],[8400,8431],[65024,65039],[65056,65069],66045,[118528,118573],[118576,118598],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[917760,917999]],sde=[[68448,68466],[68472,68479]],ade=[[68416,68437],[68440,68447]],lde=[[43392,43469],[43471,43481],[43486,43487]],ude=[[2406,2415],[43056,43065],[69760,69826],69837],cde=[[2385,2386],[2404,2405],[3200,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3260,3268],[3270,3272],[3274,3277],[3285,3286],[3293,3294],[3296,3299],[3302,3311],[3313,3315],7376,7378,7386,7410,7412,[43056,43061]],dde=[[12289,12291],[12296,12305],[12307,12319],[12336,12341],12343,[12348,12349],[12441,12444],[12448,12543],[12784,12799],[13008,13054],[13056,13143],[65093,65094],[65377,65439],[110576,110579],[110581,110587],[110589,110590],110592,[110880,110882],110933,[110948,110951]],hde=[[73472,73488],[73490,73530],[73534,73561]],fde=[[43264,43311]],mde=[[68096,68099],[68101,68102],[68108,68115],[68117,68119],[68121,68149],[68152,68154],[68159,68168],[68176,68184]],pde=[94180,[101120,101589]],gde=[[6016,6109],[6112,6121],[6128,6137],[6624,6655]],vde=[[2790,2799],[43056,43065],[70144,70161],[70163,70209]],_de=[[2404,2405],[43056,43065],[70320,70378],[70384,70393]],bde=[[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3773],[3776,3780],3782,[3784,3790],[3792,3801],[3804,3807]],Cde=[[65,90],[97,122],170,186,[192,214],[216,246],[248,696],[736,740],[867,879],[1157,1158],[2385,2386],4347,[7424,7461],[7468,7516],[7522,7525],[7531,7543],[7545,7614],[7680,7935],8239,8305,8319,[8336,8348],8432,[8490,8491],8498,8526,[8544,8584],[11360,11391],[42752,42759],[42786,42887],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43007],43310,[43824,43866],[43868,43876],[43878,43881],[64256,64262],[65313,65338],[65345,65370],[67456,67461],[67463,67504],[67506,67514],[122624,122654],[122661,122666]],yde=[[7168,7223],[7227,7241],[7245,7247]],Sde=[2405,[6400,6430],[6432,6443],[6448,6459],6464,[6468,6479]],Ede=[[65799,65843],[67072,67382],[67392,67413],[67424,67431]],wde=[[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65792,65794],[65799,65843],[65847,65855]],Rde=[[42192,42239],73648],Dde=[[66176,66204]],Ide=[[67872,67897],67903],xde=[[2404,2415],[43056,43065],[69968,70006]],Mde=[[73440,73464]],Ode=[[2385,2386],[2404,2405],[3328,3340],[3342,3344],[3346,3396],[3398,3400],[3402,3407],[3412,3427],[3430,3455],7386,[43056,43058]],Tde=[1600,[2112,2139],2142],$de=[1600,[68288,68326],[68331,68342]],kde=[[72816,72847],[72850,72871],[72873,72886]],Ade=[[2404,2405],[72960,72966],[72968,72969],[72971,73014],73018,[73020,73021],[73023,73031],[73040,73049]],Nde=[[93760,93850]],Lde=[[43744,43766],[43968,44013],[44016,44025]],Pde=[[124928,125124],[125127,125142]],Bde=[[68e3,68023],[68028,68047],[68050,68095]],Fde=[[67968,67999]],Ude=[[93952,94026],[94031,94087],[94095,94111]],Hde=[[43056,43065],[71168,71236],[71248,71257]],Vde=[[6144,6169],[6176,6264],[6272,6314],8239,[71264,71276]],jde=[[92736,92766],[92768,92777],[92782,92783]],zde=[[2662,2671],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70313]],Wde=[[4096,4255],43310,[43488,43518],[43616,43647]],Xde=[[67712,67742],[67751,67759]],Yde=[[124112,124153]],Gde=[[2404,2405],[3302,3311],7401,7410,7418,[43056,43061],[72096,72103],[72106,72151],[72154,72164]],Kde=[[6528,6571],[6576,6601],[6608,6618],[6622,6623]],Zde=[[70656,70747],[70749,70753]],qde=[1548,1563,1567,[1984,2042],[2045,2047],[64830,64831]],Qde=[94177,[110960,111355]],Jde=[[123136,123180],[123184,123197],[123200,123209],[123214,123215]],e6e=[[5760,5788]],t6e=[[7248,7295]],n6e=[[68736,68786],[68800,68850],[68858,68863]],r6e=[[66304,66339],[66349,66351]],i6e=[[68224,68255]],o6e=[1155,[66384,66426]],s6e=[[66464,66499],[66504,66517]],a6e=[[69376,69415]],l6e=[[68192,68223]],u6e=[[68608,68680]],c6e=[1600,68338,[69488,69513]],d6e=[[2385,2386],[2404,2405],[2817,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2876,2884],[2887,2888],[2891,2893],[2901,2903],[2908,2909],[2911,2915],[2918,2935],7386,7410],h6e=[[66736,66771],[66776,66811]],f6e=[[66688,66717],[66720,66729]],m6e=[[92928,92997],[93008,93017],[93019,93025],[93027,93047],[93053,93071]],p6e=[[67680,67711]],g6e=[[72384,72440]],v6e=[[6146,6147],6149,[43072,43127]],_6e=[[67840,67867],67871],b6e=[1600,[68480,68497],[68505,68508],[68521,68527]],C6e=[[43312,43347],43359],y6e=[[5792,5866],[5870,5880]],S6e=[[2048,2093],[2096,2110]],E6e=[[43136,43205],[43214,43225]],w6e=[2385,7383,7385,[7388,7389],7392,[70016,70111]],R6e=[[66640,66687]],D6e=[[71040,71093],[71096,71133]],I6e=[[120832,121483],[121499,121503],[121505,121519]],x6e=[[2404,2405],[3457,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3530,[3535,3540],3542,[3544,3551],[3558,3567],[3570,3572],[70113,70132]],M6e=[1600,[69424,69465]],O6e=[[69840,69864],[69872,69881]],T6e=[[72272,72354]],$6e=[[7040,7103],[7360,7367]],k6e=[[2404,2405],[2534,2543],[43008,43052]],A6e=[1548,[1563,1564],1567,1600,[1611,1621],1648,[1792,1805],[1807,1866],[1869,1871],[2144,2154],7672,7674],N6e=[[5888,5909],5919,[5941,5942]],L6e=[[5941,5942],[5984,5996],[5998,6e3],[6002,6003]],P6e=[[4160,4169],[6480,6509],[6512,6516]],B6e=[[6688,6750],[6752,6780],[6783,6793],[6800,6809],[6816,6829]],F6e=[[43648,43714],[43739,43743]],U6e=[[2404,2405],[43056,43065],[71296,71353],[71360,71369]],H6e=[[2385,2386],[2404,2405],[2946,2947],[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3010],[3014,3016],[3018,3021],3024,3031,[3046,3066],7386,43251,70401,70403,[70459,70460],[73664,73713],73727],V6e=[[92784,92862],[92864,92873]],j6e=[94176,[94208,100343],[100352,101119],[101632,101640]],z6e=[[2385,2386],[2404,2405],[3072,3084],[3086,3088],[3090,3112],[3114,3129],[3132,3140],[3142,3144],[3146,3149],[3157,3158],[3160,3162],3165,[3168,3171],[3174,3183],[3191,3199],7386,7410],W6e=[1548,[1563,1564],1567,[1632,1641],[1920,1969],65010,65021],X6e=[[3585,3642],[3648,3675]],Y6e=[[3840,3911],[3913,3948],[3953,3991],[3993,4028],[4030,4044],[4046,4052],[4057,4058]],G6e=[[11568,11623],[11631,11632],11647],K6e=[[2385,2386],[2404,2405],7410,[43056,43065],[70784,70855],[70864,70873]],Z6e=[[123536,123566]],q6e=[[66432,66461],66463],Q6e=[[42240,42539]],J6e=[[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004]],e4e=[[123584,123641],123647],t4e=[[71840,71922],71935],n4e=[1548,1563,1567,[1632,1641],[69248,69289],[69291,69293],[69296,69297]],r4e=[[12289,12290],[12296,12305],[12308,12315],12539,[40960,42124],[42128,42182],[65377,65381]],i4e=[[72192,72263]],o4e=Object.freeze(Object.defineProperty({__proto__:null,Adlam:i0e,Ahom:o0e,Anatolian_Hieroglyphs:s0e,Arabic:a0e,Armenian:l0e,Avestan:u0e,Balinese:c0e,Bamum:d0e,Bassa_Vah:h0e,Batak:f0e,Bengali:m0e,Bhaiksuki:p0e,Bopomofo:g0e,Brahmi:v0e,Braille:_0e,Buginese:b0e,Buhid:C0e,Canadian_Aboriginal:y0e,Carian:S0e,Caucasian_Albanian:E0e,Chakma:w0e,Cham:R0e,Cherokee:D0e,Chorasmian:I0e,Common:x0e,Coptic:M0e,Cuneiform:O0e,Cypriot:T0e,Cypro_Minoan:$0e,Cyrillic:k0e,Deseret:A0e,Devanagari:N0e,Dives_Akuru:L0e,Dogra:P0e,Duployan:B0e,Egyptian_Hieroglyphs:F0e,Elbasan:U0e,Elymaic:H0e,Ethiopic:V0e,Georgian:j0e,Glagolitic:z0e,Gothic:W0e,Grantha:X0e,Greek:Y0e,Gujarati:G0e,Gunjala_Gondi:K0e,Gurmukhi:Z0e,Han:q0e,Hangul:Q0e,Hanifi_Rohingya:J0e,Hanunoo:ede,Hatran:tde,Hebrew:nde,Hiragana:rde,Imperial_Aramaic:ide,Inherited:ode,Inscriptional_Pahlavi:sde,Inscriptional_Parthian:ade,Javanese:lde,Kaithi:ude,Kannada:cde,Katakana:dde,Kawi:hde,Kayah_Li:fde,Kharoshthi:mde,Khitan_Small_Script:pde,Khmer:gde,Khojki:vde,Khudawadi:_de,Lao:bde,Latin:Cde,Lepcha:yde,Limbu:Sde,Linear_A:Ede,Linear_B:wde,Lisu:Rde,Lycian:Dde,Lydian:Ide,Mahajani:xde,Makasar:Mde,Malayalam:Ode,Mandaic:Tde,Manichaean:$de,Marchen:kde,Masaram_Gondi:Ade,Medefaidrin:Nde,Meetei_Mayek:Lde,Mende_Kikakui:Pde,Meroitic_Cursive:Bde,Meroitic_Hieroglyphs:Fde,Miao:Ude,Modi:Hde,Mongolian:Vde,Mro:jde,Multani:zde,Myanmar:Wde,Nabataean:Xde,Nag_Mundari:Yde,Nandinagari:Gde,New_Tai_Lue:Kde,Newa:Zde,Nko:qde,Nushu:Qde,Nyiakeng_Puachue_Hmong:Jde,Ogham:e6e,Ol_Chiki:t6e,Old_Hungarian:n6e,Old_Italic:r6e,Old_North_Arabian:i6e,Old_Permic:o6e,Old_Persian:s6e,Old_Sogdian:a6e,Old_South_Arabian:l6e,Old_Turkic:u6e,Old_Uyghur:c6e,Oriya:d6e,Osage:h6e,Osmanya:f6e,Pahawh_Hmong:m6e,Palmyrene:p6e,Pau_Cin_Hau:g6e,Phags_Pa:v6e,Phoenician:_6e,Psalter_Pahlavi:b6e,Rejang:C6e,Runic:y6e,Samaritan:S6e,Saurashtra:E6e,Sharada:w6e,Shavian:R6e,Siddham:D6e,SignWriting:I6e,Sinhala:x6e,Sogdian:M6e,Sora_Sompeng:O6e,Soyombo:T6e,Sundanese:$6e,Syloti_Nagri:k6e,Syriac:A6e,Tagalog:N6e,Tagbanwa:L6e,Tai_Le:P6e,Tai_Tham:B6e,Tai_Viet:F6e,Takri:U6e,Tamil:H6e,Tangsa:V6e,Tangut:j6e,Telugu:z6e,Thaana:W6e,Thai:X6e,Tibetan:Y6e,Tifinagh:G6e,Tirhuta:K6e,Toto:Z6e,Ugaritic:q6e,Vai:Q6e,Vithkuqi:J6e,Wancho:e4e,Warang_Citi:t4e,Yezidi:n4e,Yi:r4e,Zanabazar_Square:i4e},Symbol.toStringTag,{value:"Module"})),s4e=[],a4e=[],l4e=[],u4e=[],c4e=Object.freeze(Object.defineProperty({__proto__:null,C:s4e,F:a4e,S:l4e,T:u4e},Symbol.toStringTag,{value:"Module"})),d4e=[[125184,125279]],h4e=[[65792,65855]],f4e=[[71424,71503]],m4e=[[128768,128895]],p4e=[[64256,64335]],g4e=[[82944,83583]],v4e=[[119296,119375]],_4e=[[65856,65935]],b4e=[[65936,65999]],C4e=[[1536,1791]],y4e=[[2208,2303]],S4e=[[126464,126719]],E4e=[[64336,65023]],w4e=[[65136,65279]],R4e=[[1872,1919]],D4e=[[1328,1423]],I4e=[[8592,8703]],x4e=[[68352,68415]],M4e=[[6912,7039]],O4e=[[42656,42751]],T4e=[[92160,92735]],$4e=[[0,127]],k4e=[[92880,92927]],A4e=[[7104,7167]],N4e=[[2432,2559]],L4e=[[72704,72815]],P4e=[[9600,9631]],B4e=[[12544,12591]],F4e=[[12704,12735]],U4e=[[9472,9599]],H4e=[[69632,69759]],V4e=[[10240,10495]],j4e=[[6656,6687]],z4e=[[5952,5983]],W4e=[[118784,119039]],X4e=[[13056,13311]],Y4e=[[65072,65103]],G4e=[[63744,64255]],K4e=[[194560,195103]],Z4e=[[11904,12031]],q4e=[[12736,12783]],Q4e=[[12288,12351]],J4e=[[19968,40959]],e7e=[[13312,19903]],t7e=[[131072,173791]],n7e=[[173824,177983]],r7e=[[177984,178207]],i7e=[[178208,183983]],o7e=[[183984,191471]],s7e=[[66208,66271]],a7e=[[66864,66927]],l7e=[[69888,69967]],u7e=[[43520,43615]],c7e=[[5024,5119]],d7e=[[43888,43967]],h7e=[[129536,129647]],f7e=[[768,879]],m7e=[[6832,6911]],p7e=[[8400,8447]],g7e=[[7616,7679]],v7e=[[65056,65071]],_7e=[[43056,43071]],b7e=[[9216,9279]],C7e=[[11392,11519]],y7e=[[66272,66303]],S7e=[[119648,119679]],E7e=[[73728,74751]],w7e=[[74752,74879]],R7e=[[8352,8399]],D7e=[[67584,67647]],I7e=[[1024,1279]],x7e=[[11744,11775]],M7e=[[42560,42655]],O7e=[[7296,7311]],T7e=[[1280,1327]],$7e=[[66560,66639]],k7e=[[2304,2431]],A7e=[[43232,43263]],N7e=[[9984,10175]],L7e=[[71680,71759]],P7e=[[127024,127135]],B7e=[[113664,113823]],F7e=[[74880,75087]],U7e=[[77824,78895]],H7e=[[66816,66863]],V7e=[[128512,128591]],j7e=[[127232,127487]],z7e=[[9312,9471]],W7e=[[12800,13055]],X7e=[[127488,127743]],Y7e=[[4608,4991]],G7e=[[11648,11743]],K7e=[[43776,43823]],Z7e=[[4992,5023]],q7e=[[8192,8303]],Q7e=[[9632,9727]],J7e=[[128896,129023]],e3e=[[4256,4351]],t3e=[[7312,7359]],n3e=[[11520,11567]],r3e=[[11264,11359]],i3e=[[122880,122927]],o3e=[[66352,66383]],s3e=[[70400,70527]],a3e=[[880,1023]],l3e=[[7936,8191]],u3e=[[2688,2815]],c3e=[[73056,73135]],d3e=[[2560,2687]],h3e=[[65280,65519]],f3e=[[12592,12687]],m3e=[[4352,4607]],p3e=[[43360,43391]],g3e=[[55216,55295]],v3e=[[44032,55215]],_3e=[[68864,68927]],b3e=[[5920,5951]],C3e=[[67808,67839]],y3e=[[1424,1535]],S3e=[[56192,56319]],E3e=[[55296,56191]],w3e=[[12352,12447]],R3e=[[592,687]],D3e=[[12272,12287]],I3e=[[94176,94207]],x3e=[[67648,67679]],M3e=[[126064,126143]],O3e=[[68448,68479]],T3e=[[68416,68447]],$3e=[[43392,43487]],k3e=[[69760,69839]],A3e=[[110848,110895]],N3e=[[110592,110847]],L3e=[[12688,12703]],P3e=[[12032,12255]],B3e=[[3200,3327]],F3e=[[12448,12543]],U3e=[[12784,12799]],H3e=[[43264,43311]],V3e=[[68096,68191]],j3e=[[6016,6143]],z3e=[[6624,6655]],W3e=[[70144,70223]],X3e=[[70320,70399]],Y3e=[[3712,3839]],G3e=[[128,255]],K3e=[[256,383]],Z3e=[[7680,7935]],q3e=[[384,591]],Q3e=[[11360,11391]],J3e=[[42784,43007]],e8e=[[43824,43887]],t8e=[[7168,7247]],n8e=[[8448,8527]],r8e=[[6400,6479]],i8e=[[67072,67455]],o8e=[[65664,65791]],s8e=[[65536,65663]],a8e=[[42192,42239]],l8e=[[56320,57343]],u8e=[[66176,66207]],c8e=[[67872,67903]],d8e=[[69968,70015]],h8e=[[126976,127023]],f8e=[[73440,73471]],m8e=[[3328,3455]],p8e=[[2112,2143]],g8e=[[68288,68351]],v8e=[[72816,72895]],_8e=[[72960,73055]],b8e=[[119808,120831]],C8e=[[8704,8959]],y8e=[[119520,119551]],S8e=[[93760,93855]],E8e=[[43968,44031]],w8e=[[43744,43775]],R8e=[[124928,125151]],D8e=[[68e3,68095]],I8e=[[67968,67999]],x8e=[[93952,94111]],M8e=[[10176,10223]],O8e=[[10624,10751]],T8e=[[9728,9983]],$8e=[[11008,11263]],k8e=[[127744,128511]],A8e=[[8960,9215]],N8e=[[71168,71263]],L8e=[[42752,42783]],P8e=[[6144,6319]],B8e=[[71264,71295]],F8e=[[92736,92783]],U8e=[[70272,70319]],H8e=[[119040,119295]],V8e=[[4096,4255]],j8e=[[43616,43647]],z8e=[[43488,43519]],W8e=[[1984,2047]],X8e=[[67712,67759]],Y8e=[[6528,6623]],G8e=[[70656,70783]],K8e=[[8528,8591]],Z8e=[[110960,111359]],q8e=[[5760,5791]],Q8e=[[7248,7295]],J8e=[[68736,68863]],ehe=[[66304,66351]],the=[[68224,68255]],nhe=[[66384,66431]],rhe=[[66464,66527]],ihe=[[69376,69423]],ohe=[[68192,68223]],she=[[68608,68687]],ahe=[[9280,9311]],lhe=[[2816,2943]],uhe=[[128592,128639]],che=[[66736,66815]],dhe=[[66688,66735]],hhe=[[92928,93071]],fhe=[[67680,67711]],mhe=[[72384,72447]],phe=[[43072,43135]],ghe=[[66e3,66047]],vhe=[[67840,67871]],_he=[[7424,7551]],bhe=[[7552,7615]],Che=[[127136,127231]],yhe=[[57344,63743]],She=[[68480,68527]],Ehe=[[43312,43359]],whe=[[69216,69247]],Rhe=[[5792,5887]],Dhe=[[2048,2111]],Ihe=[[43136,43231]],xhe=[[70016,70111]],Mhe=[[66640,66687]],Ohe=[[113824,113839]],The=[[71040,71167]],$he=[[3456,3583]],khe=[[70112,70143]],Ahe=[[65104,65135]],Nhe=[[69424,69487]],Lhe=[[69840,69887]],Phe=[[72272,72367]],Bhe=[[688,767]],Fhe=[[65520,65535]],Uhe=[[7040,7103]],Hhe=[[7360,7375]],Vhe=[[8304,8351]],jhe=[[10224,10239]],zhe=[[10496,10623]],Whe=[[129024,129279]],Xhe=[[10752,11007]],Yhe=[[11776,11903]],Ghe=[[129280,129535]],Khe=[[983040,1048575]],Zhe=[[1048576,1114111]],qhe=[[120832,121519]],Qhe=[[43008,43055]],Jhe=[[1792,1871]],e5e=[[2144,2159]],t5e=[[5888,5919]],n5e=[[5984,6015]],r5e=[[917504,917631]],i5e=[[6480,6527]],o5e=[[6688,6831]],s5e=[[43648,43743]],a5e=[[119552,119647]],l5e=[[71296,71375]],u5e=[[2944,3071]],c5e=[[94208,100351]],d5e=[[100352,101119]],h5e=[[3072,3199]],f5e=[[1920,1983]],m5e=[[3584,3711]],p5e=[[3840,4095]],g5e=[[11568,11647]],v5e=[[70784,70879]],_5e=[[128640,128767]],b5e=[[66432,66463]],C5e=[[5120,5759]],y5e=[[6320,6399]],S5e=[[42240,42559]],E5e=[[65024,65039]],w5e=[[917760,917999]],R5e=[[7376,7423]],D5e=[[65040,65055]],I5e=[[71840,71935]],x5e=[[42128,42191]],M5e=[[40960,42127]],O5e=[[19904,19967]],T5e=[[72192,72271]],$5e=[[2160,2207],[66928,67007],[67456,67519],[69248,69375],[69488,69631],[71936,72031],[72096,72191],[72368,72383],[72448,72543],[73472,73567],[73648,73727],[77712,77823],[78896,78943],[92784,92879],[101120,101759],[110576,110591],[110896,110959],[118528,118735],[119488,119519],[122624,122879],[122928,123023],[123136,123215],[123536,123647],[124112,124159],[124896,124927],[126208,126287],[129648,130047],[196608,205743]],k5e=Object.freeze(Object.defineProperty({__proto__:null,Adlam:d4e,Aegean_Numbers:h4e,Ahom:f4e,Alchemical_Symbols:m4e,Alphabetic_Presentation_Forms:p4e,Anatolian_Hieroglyphs:g4e,Ancient_Greek_Musical_Notation:v4e,Ancient_Greek_Numbers:_4e,Ancient_Symbols:b4e,Arabic:C4e,Arabic_Extended_A:y4e,Arabic_Mathematical_Alphabetic_Symbols:S4e,Arabic_Presentation_Forms_A:E4e,Arabic_Presentation_Forms_B:w4e,Arabic_Supplement:R4e,Armenian:D4e,Arrows:I4e,Avestan:x4e,Balinese:M4e,Bamum:O4e,Bamum_Supplement:T4e,Basic_Latin:$4e,Bassa_Vah:k4e,Batak:A4e,Bengali:N4e,Bhaiksuki:L4e,Block_Elements:P4e,Bopomofo:B4e,Bopomofo_Extended:F4e,Box_Drawing:U4e,Brahmi:H4e,Braille_Patterns:V4e,Buginese:j4e,Buhid:z4e,Byzantine_Musical_Symbols:W4e,CJK_Compatibility:X4e,CJK_Compatibility_Forms:Y4e,CJK_Compatibility_Ideographs:G4e,CJK_Compatibility_Ideographs_Supplement:K4e,CJK_Radicals_Supplement:Z4e,CJK_Strokes:q4e,CJK_Symbols_And_Punctuation:Q4e,CJK_Unified_Ideographs:J4e,CJK_Unified_Ideographs_Extension_A:e7e,CJK_Unified_Ideographs_Extension_B:t7e,CJK_Unified_Ideographs_Extension_C:n7e,CJK_Unified_Ideographs_Extension_D:r7e,CJK_Unified_Ideographs_Extension_E:i7e,CJK_Unified_Ideographs_Extension_F:o7e,Carian:s7e,Caucasian_Albanian:a7e,Chakma:l7e,Cham:u7e,Cherokee:c7e,Cherokee_Supplement:d7e,Chess_Symbols:h7e,Combining_Diacritical_Marks:f7e,Combining_Diacritical_Marks_Extended:m7e,Combining_Diacritical_Marks_For_Symbols:p7e,Combining_Diacritical_Marks_Supplement:g7e,Combining_Half_Marks:v7e,Common_Indic_Number_Forms:_7e,Control_Pictures:b7e,Coptic:C7e,Coptic_Epact_Numbers:y7e,Counting_Rod_Numerals:S7e,Cuneiform:E7e,Cuneiform_Numbers_And_Punctuation:w7e,Currency_Symbols:R7e,Cypriot_Syllabary:D7e,Cyrillic:I7e,Cyrillic_Extended_A:x7e,Cyrillic_Extended_B:M7e,Cyrillic_Extended_C:O7e,Cyrillic_Supplement:T7e,Deseret:$7e,Devanagari:k7e,Devanagari_Extended:A7e,Dingbats:N7e,Dogra:L7e,Domino_Tiles:P7e,Duployan:B7e,Early_Dynastic_Cuneiform:F7e,Egyptian_Hieroglyphs:U7e,Elbasan:H7e,Emoticons:V7e,Enclosed_Alphanumeric_Supplement:j7e,Enclosed_Alphanumerics:z7e,Enclosed_CJK_Letters_And_Months:W7e,Enclosed_Ideographic_Supplement:X7e,Ethiopic:Y7e,Ethiopic_Extended:G7e,Ethiopic_Extended_A:K7e,Ethiopic_Supplement:Z7e,General_Punctuation:q7e,Geometric_Shapes:Q7e,Geometric_Shapes_Extended:J7e,Georgian:e3e,Georgian_Extended:t3e,Georgian_Supplement:n3e,Glagolitic:r3e,Glagolitic_Supplement:i3e,Gothic:o3e,Grantha:s3e,Greek_And_Coptic:a3e,Greek_Extended:l3e,Gujarati:u3e,Gunjala_Gondi:c3e,Gurmukhi:d3e,Halfwidth_And_Fullwidth_Forms:h3e,Hangul_Compatibility_Jamo:f3e,Hangul_Jamo:m3e,Hangul_Jamo_Extended_A:p3e,Hangul_Jamo_Extended_B:g3e,Hangul_Syllables:v3e,Hanifi_Rohingya:_3e,Hanunoo:b3e,Hatran:C3e,Hebrew:y3e,High_Private_Use_Surrogates:S3e,High_Surrogates:E3e,Hiragana:w3e,IPA_Extensions:R3e,Ideographic_Description_Characters:D3e,Ideographic_Symbols_And_Punctuation:I3e,Imperial_Aramaic:x3e,Indic_Siyaq_Numbers:M3e,Inscriptional_Pahlavi:O3e,Inscriptional_Parthian:T3e,Javanese:$3e,Kaithi:k3e,Kana_Extended_A:A3e,Kana_Supplement:N3e,Kanbun:L3e,Kangxi_Radicals:P3e,Kannada:B3e,Katakana:F3e,Katakana_Phonetic_Extensions:U3e,Kayah_Li:H3e,Kharoshthi:V3e,Khmer:j3e,Khmer_Symbols:z3e,Khojki:W3e,Khudawadi:X3e,Lao:Y3e,Latin_1_Supplement:G3e,Latin_Extended_A:K3e,Latin_Extended_Additional:Z3e,Latin_Extended_B:q3e,Latin_Extended_C:Q3e,Latin_Extended_D:J3e,Latin_Extended_E:e8e,Lepcha:t8e,Letterlike_Symbols:n8e,Limbu:r8e,Linear_A:i8e,Linear_B_Ideograms:o8e,Linear_B_Syllabary:s8e,Lisu:a8e,Low_Surrogates:l8e,Lycian:u8e,Lydian:c8e,Mahajani:d8e,Mahjong_Tiles:h8e,Makasar:f8e,Malayalam:m8e,Mandaic:p8e,Manichaean:g8e,Marchen:v8e,Masaram_Gondi:_8e,Mathematical_Alphanumeric_Symbols:b8e,Mathematical_Operators:C8e,Mayan_Numerals:y8e,Medefaidrin:S8e,Meetei_Mayek:E8e,Meetei_Mayek_Extensions:w8e,Mende_Kikakui:R8e,Meroitic_Cursive:D8e,Meroitic_Hieroglyphs:I8e,Miao:x8e,Miscellaneous_Mathematical_Symbols_A:M8e,Miscellaneous_Mathematical_Symbols_B:O8e,Miscellaneous_Symbols:T8e,Miscellaneous_Symbols_And_Arrows:$8e,Miscellaneous_Symbols_And_Pictographs:k8e,Miscellaneous_Technical:A8e,Modi:N8e,Modifier_Tone_Letters:L8e,Mongolian:P8e,Mongolian_Supplement:B8e,Mro:F8e,Multani:U8e,Musical_Symbols:H8e,Myanmar:V8e,Myanmar_Extended_A:j8e,Myanmar_Extended_B:z8e,NKo:W8e,Nabataean:X8e,New_Tai_Lue:Y8e,Newa:G8e,Number_Forms:K8e,Nushu:Z8e,Ogham:q8e,Ol_Chiki:Q8e,Old_Hungarian:J8e,Old_Italic:ehe,Old_North_Arabian:the,Old_Permic:nhe,Old_Persian:rhe,Old_Sogdian:ihe,Old_South_Arabian:ohe,Old_Turkic:she,Optical_Character_Recognition:ahe,Oriya:lhe,Ornamental_Dingbats:uhe,Osage:che,Osmanya:dhe,Pahawh_Hmong:hhe,Palmyrene:fhe,Pau_Cin_Hau:mhe,Phags_Pa:phe,Phaistos_Disc:ghe,Phoenician:vhe,Phonetic_Extensions:_he,Phonetic_Extensions_Supplement:bhe,Playing_Cards:Che,Private_Use_Area:yhe,Psalter_Pahlavi:She,Rejang:Ehe,Rumi_Numeral_Symbols:whe,Runic:Rhe,Samaritan:Dhe,Saurashtra:Ihe,Sharada:xhe,Shavian:Mhe,Shorthand_Format_Controls:Ohe,Siddham:The,Sinhala:$he,Sinhala_Archaic_Numbers:khe,Small_Form_Variants:Ahe,Sogdian:Nhe,Sora_Sompeng:Lhe,Soyombo:Phe,Spacing_Modifier_Letters:Bhe,Specials:Fhe,Sundanese:Uhe,Sundanese_Supplement:Hhe,Superscripts_And_Subscripts:Vhe,Supplemental_Arrows_A:jhe,Supplemental_Arrows_B:zhe,Supplemental_Arrows_C:Whe,Supplemental_Mathematical_Operators:Xhe,Supplemental_Punctuation:Yhe,Supplemental_Symbols_And_Pictographs:Ghe,Supplementary_Private_Use_Area_A:Khe,Supplementary_Private_Use_Area_B:Zhe,Sutton_SignWriting:qhe,Syloti_Nagri:Qhe,Syriac:Jhe,Syriac_Supplement:e5e,Tagalog:t5e,Tagbanwa:n5e,Tags:r5e,Tai_Le:i5e,Tai_Tham:o5e,Tai_Viet:s5e,Tai_Xuan_Jing_Symbols:a5e,Takri:l5e,Tamil:u5e,Tangut:c5e,Tangut_Components:d5e,Telugu:h5e,Thaana:f5e,Thai:m5e,Tibetan:p5e,Tifinagh:g5e,Tirhuta:v5e,Transport_And_Map_Symbols:_5e,Ugaritic:b5e,Unified_Canadian_Aboriginal_Syllabics:C5e,Unified_Canadian_Aboriginal_Syllabics_Extended:y5e,Vai:S5e,Variation_Selectors:E5e,Variation_Selectors_Supplement:w5e,Vedic_Extensions:R5e,Vertical_Forms:D5e,Warang_Citi:I5e,Yi_Radicals:x5e,Yi_Syllables:M5e,Yijing_Hexagram_Symbols:O5e,Zanabazar_Square:T5e,undefined:$5e},Symbol.toStringTag,{value:"Module"})),A5e=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),N5e=[41,93,125,3899,3901,5788,8262,8318,8334,8969,8971,9002,10089,10091,10093,10095,10097,10099,10101,10182,10215,10217,10219,10221,10223,10628,10630,10632,10634,10636,10638,10640,10642,10644,10646,10648,10713,10715,10749,11811,11813,11815,11817,11862,11864,11866,11868,12297,12299,12301,12303,12305,12309,12311,12313,12315,65114,65116,65118,65289,65341,65373,65376,65379],L5e=[[0,39],[42,90],92,[94,122],124,[126,3897],[3902,5786],[5789,8260],[8263,8316],[8319,8332],[8335,8967],[8972,9e3],[9003,10087],[10102,10180],[10183,10213],[10224,10626],[10649,10711],[10716,10747],[10750,11809],[11818,11860],[11869,12295],[12306,12307],[12316,65112],[65119,65287],[65290,65338],65340,[65342,65370],65372,65374,65377,[65380,1114111]],P5e=[40,91,123,3898,3900,5787,8261,8317,8333,8968,8970,9001,10088,10090,10092,10094,10096,10098,10100,10181,10214,10216,10218,10220,10222,10627,10629,10631,10633,10635,10637,10639,10641,10643,10645,10647,10712,10714,10748,11810,11812,11814,11816,11861,11863,11865,11867,12296,12298,12300,12302,12304,12308,12310,12312,12314,65113,65115,65117,65288,65339,65371,65375,65378],B5e=Object.freeze(Object.defineProperty({__proto__:null,Close:N5e,None:L5e,Open:P5e},Symbol.toStringTag,{value:"Module"})),F5e=[35,38,42,[60,62],[64,90],[94,122],126,166,169,172,[174,175],181,[192,214],[216,246],[248,710],[718,719],[721,727],732,734,[736,767],[880,887],[890,893],895,[900,906],908,[910,929],[931,1154],[1162,1327],[1329,1366],[1369,1416],[1421,1422],1472,1475,[1523,1524],[1536,1544],[1550,1551],[1568,1610],[1645,1647],[1649,1747],1749,[1757,1758],[1765,1766],1769,[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],1969,[1994,2026],[2036,2039],2042,[2048,2069],2074,2084,2088,[2096,2110],[2112,2136],2142,[2144,2154],[2160,2190],[2192,2193],[2208,2249],2274,[2308,2361],2365,2384,[2392,2401],[2416,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],[2548,2552],2554,[2556,2557],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],2678,[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2800,2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],[2928,2935],2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3056,3064],3066,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],3165,[3168,3169],[3192,3200],[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,[3293,3294],[3296,3297],[3313,3314],[3332,3340],[3342,3344],[3346,3386],3389,[3406,3407],[3412,3414],[3416,3425],[3440,3448],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3572,3663,3840,3845,3859,[3861,3863],[3866,3871],[3882,3891],3894,3896,[3904,3911],[3913,3948],[3976,3980],[4032,4037],[4039,4044],[4046,4047],[4052,4056],[4172,4175],[4256,4293],4295,4301,[4304,4351],[4608,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],4960,[4962,4988],[4992,5017],[5024,5109],[5112,5117],[5121,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5905],[5919,5937],[5952,5969],[5984,5996],[5998,6e3],6105,[6128,6137],[6144,6145],6151,6154,[6176,6264],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],6464,[6624,6678],[6686,6687],[6917,6963],[6981,6988],7004,[7009,7018],[7028,7036],[7043,7072],[7086,7087],[7098,7141],[7164,7203],[7245,7247],[7258,7293],[7296,7304],[7312,7354],[7357,7367],7379,[7401,7404],[7406,7411],[7413,7414],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8132],[8134,8147],[8150,8155],[8157,8175],[8178,8180],[8182,8188],8190,8215,[8226,8227],8248,[8254,8259],[8266,8277],8284,[8289,8292],[8304,8305],[8309,8316],8320,[8325,8332],[8336,8348],[8448,8450],8452,[8454,8456],[8458,8466],[8468,8469],[8471,8480],[8483,8490],[8492,8531],[8534,8538],[8540,8541],8543,[8556,8559],[8570,8584],[8586,8587],[8602,8657],8659,[8661,8703],8705,[8708,8710],[8713,8714],[8716,8718],8720,8724,[8726,8729],[8731,8732],[8737,8738],8740,8742,8749,[8751,8755],[8760,8763],[8766,8775],[8777,8779],[8781,8785],[8787,8799],[8802,8803],[8808,8809],[8812,8813],[8816,8833],[8836,8837],[8840,8852],[8854,8856],[8858,8868],[8870,8894],[8896,8942],[8944,8967],[8972,8977],[8979,8985],[8988,9e3],[9003,9199],[9204,9254],[9280,9290],9471,[9548,9551],[9589,9599],[9616,9617],[9622,9631],9634,[9642,9649],[9652,9653],[9656,9659],[9662,9663],[9666,9669],[9673,9674],[9676,9677],[9682,9697],[9702,9710],[9712,9727],9732,[9735,9736],[9738,9741],[9744,9747],9753,[9760,9784],[9788,9791],9793,[9795,9823],9826,9830,9835,9838,[9840,9854],[9856,9885],[9888,9916],9934,9954,[9956,9959],[9989,9991],[9998,10070],[10072,10074],10081,[10085,10087],[10132,10180],[10183,10213],[10224,10626],[10649,10711],[10716,10747],[10750,11092],[11098,11123],[11126,11157],[11159,11502],[11506,11507],11517,[11520,11557],11559,11565,[11568,11623],11631,[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],11798,[11802,11803],[11806,11807],11823,11826,[11829,11833],11839,11851,11853,[11856,11858],[19904,19967],[42192,42237],[42240,42508],[42512,42527],[42538,42539],[42560,42606],42611,[42622,42653],[42656,42735],42738,[42752,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43042],[43048,43051],[43056,43063],43065,[43072,43123],[43138,43187],[43250,43259],[43261,43262],[43274,43301],[43312,43334],43359,[43396,43442],[43457,43462],[43466,43469],43471,[43486,43487],[43520,43560],[43584,43586],[43588,43595],43612,[43744,43754],[43762,43764],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43883],[43888,44002],[64256,64262],[64275,64279],64297,[64336,64450],[64467,64829],[64832,64911],[64914,64967],64975,[65008,65019],[65021,65023],[65136,65140],[65142,65276],[65512,65518],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65799,65843],[65847,65934],[65936,65948],65952,[66e3,66044],[66176,66204],[66208,66256],[66273,66299],[66304,66339],[66349,66378],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66927,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67672,67742],[67751,67759],[67808,67826],[67828,67829],[67835,67867],[67872,67897],67903,[67968,68023],[68028,68047],[68050,68096],[68112,68115],[68117,68119],[68121,68149],[68160,68168],68184,[68192,68255],[68288,68324],[68331,68335],[68352,68405],[68416,68437],[68440,68466],[68472,68497],[68505,68508],[68521,68527],[68608,68680],[68736,68786],[68800,68850],[68858,68899],[69216,69246],[69248,69289],[69296,69297],[69376,69415],[69424,69445],[69457,69465],[69488,69505],[69510,69513],[69552,69579],[69600,69622],[69635,69687],[69705,69709],[69714,69733],[69745,69746],69749,[69763,69807],[69819,69821],69837,[69840,69864],[69891,69926],69956,69959,[69968,70002],70004,70006,[70019,70066],[70081,70084],70087,70093,70106,70108,[70113,70132],[70144,70161],[70163,70187],70202,70205,[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],70735,70749,[70751,70753],[70784,70831],[70852,70855],[71040,71086],[71110,71112],[71128,71131],[71168,71215],[71235,71236],[71296,71338],[71352,71353],[71680,71723],71739,[71840,71903],[71914,71922],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],71999,72001,[72096,72103],[72106,72144],72161,72163,72192,[72203,72242],72250,72256,72262,72272,[72284,72329],72349,[72368,72440],[72704,72712],[72714,72750],72768,[72794,72812],[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73056,73061],[73063,73064],[73066,73097],73112,[73440,73458],[73463,73464],73474,[73476,73488],[73490,73523],73648,[73664,73692],[73697,73713],[73728,74649],[74752,74862],[74880,75075],[77712,77810],[77824,78423],[78430,78465],[78467,78469],[78474,78712],[78716,78895],[78913,78918],[82944,83405],[83408,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[92986,92995],92997,[93019,93025],[93027,93047],[93053,93071],[93760,93846],[93849,93850],[93952,94026],94032,[94099,94111],[101120,101589],[110576,110579],[110581,110587],[110589,110590],[113664,113770],[113776,113788],[113792,113800],[113808,113817],113820,[118608,118723],[118784,119029],[119040,119078],[119081,119140],[119146,119148],[119171,119172],[119180,119209],[119214,119274],[119296,119361],119365,[119488,119507],[119520,119539],[119552,119638],[119648,119672],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120832,121343],[121399,121402],[121453,121460],[121462,121475],[121477,121478],121483,[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],[123214,123215],[123536,123565],[123584,123627],[124112,124139],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125127,125135],[125184,125251],125259,[126065,126123],[126125,126127],[126129,126132],[126209,126269],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[126704,126705],[127278,127279],[127338,127340],[127900,127901],[127925,127926],127932,128160,128162,128164,128175,[128177,128178],[128256,128262],[128279,128292],[128306,128329],[128468,128475],[128500,128505],[128592,128629],[128636,128639],[128768,128883],[128896,128980],[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129280,129291],[129536,129619],[129792,129938],[129940,129994]],U5e=[[167,168],170,[178,179],[182,186],[188,190],215,247,711,[713,715],717,720,[728,731],733,[8213,8214],[8224,8225],8251,8308,8319,[8321,8324],8453,8467,[8481,8482],8491,[8532,8533],8539,8542,[8544,8555],[8560,8569],8585,[8592,8601],8658,8660,8704,[8706,8707],[8711,8712],8715,8719,8721,8725,8730,[8733,8736],8739,8741,[8743,8748],8750,[8756,8759],[8764,8765],8776,8780,8786,[8800,8801],[8804,8807],[8810,8811],[8814,8815],[8834,8835],[8838,8839],8853,8857,8869,8895,8978,[9312,9470],[9472,9547],[9552,9588],[9600,9615],[9618,9621],[9632,9633],[9635,9641],[9650,9651],[9654,9655],[9660,9661],[9664,9665],[9670,9672],9675,[9678,9681],[9698,9701],9711,[9733,9734],9737,[9742,9743],[9750,9751],9792,9794,[9824,9825],[9827,9829],9831,[9833,9834],[9836,9837],9839,[9886,9887],[9929,9932],9938,[9941,9943],[9946,9947],[9949,9950],9955,[9960,9961],[9963,9968],9974,[9979,9980],10071,[10102,10131],[11093,11097],[12872,12879],65533,[127232,127244],[127248,127277],[127280,127337],[127344,127404]],H5e=[9,124,173,1418,1470,[2404,2405],[3674,3675],3851,3892,3967,3973,[4030,4031],4050,[4170,4171],4961,5120,5760,[5867,5869],[5941,5942],[6100,6101],6104,6106,[6148,6149],[7002,7003],[7005,7008],[7037,7038],[7227,7231],[7294,7295],[8192,8198],[8200,8202],8208,[8210,8211],8231,8278,[8280,8283],[8285,8287],[11514,11516],11519,11632,[11790,11797],11799,11801,[11818,11821],[11824,11825],[11827,11828],[11836,11838],[11840,11841],[11843,11850],11852,[11854,11855],11869,12288,[42238,42239],42509,42511,[42739,42743],[43214,43215],[43310,43311],[43463,43465],[43613,43615],[43760,43761],44011,[65792,65794],66463,66512,67671,67871,[68176,68183],[68336,68341],[68409,68415],69293,[69703,69704],[69822,69825],[69952,69955],[70085,70086],70088,[70109,70111],[70200,70201],[70203,70204],70313,[70731,70734],[70746,70747],[71106,71107],[71113,71127],[71233,71234],[71484,71486],[72004,72006],[72257,72260],[72346,72348],[72353,72354],[72769,72773],[73539,73540],73727,[74864,74868],[92782,92783],92917,[92983,92985],92996,[93847,93848],113823,[121479,121482]],V5e=[180,712,716,735,3191,3204,[3841,3844],[3846,3847],[3849,3850],[4048,4049],4051,6150,8189,[43124,43125],43260,70005,70107,71105,[71264,71276],72162,72255,72261,[72350,72352],[72448,72457],72816],j5e=[8212,[11834,11835]],z5e=[47],W5e=[13],X5e=[41,93],Y5e=[125,3899,3901,5788,8262,8318,8334,8969,8971,9002,10089,10091,10093,10095,10097,10099,10101,10182,10215,10217,10219,10221,10223,10628,10630,10632,10634,10636,10638,10640,10642,10644,10646,10648,10713,10715,10749,11811,11813,11815,11817,11862,11864,11866,11868,[12289,12290],12297,12299,12301,12303,12305,12309,12311,12313,12315,[12318,12319],64830,[65041,65042],65048,65078,65080,65082,65084,65086,65088,65090,65092,65096,65104,65106,65114,65116,65118,65289,65292,65294,65341,65373,[65376,65377],[65379,65380],[78427,78429],78466,78471,78473,[78714,78715],78904,78909,78911,83407],G5e=[[0,8],[14,31],[127,132],[134,159],[768,846],[848,859],[867,879],[1155,1161],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],1564,[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],2045,[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2200,2207],[2250,2273],[2275,2307],[2362,2364],[2366,2383],[2385,2391],[2402,2403],[2433,2435],2492,[2494,2500],[2503,2504],[2507,2509],2519,[2530,2531],2558,[2561,2563],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2691],2748,[2750,2757],[2759,2761],[2763,2765],[2786,2787],[2810,2815],[2817,2819],2876,[2878,2884],[2887,2888],[2891,2893],[2901,2903],[2914,2915],2946,[3006,3010],[3014,3016],[3018,3021],3031,[3072,3076],3132,[3134,3140],[3142,3144],[3146,3149],[3157,3158],[3170,3171],[3201,3203],3260,[3262,3268],[3270,3272],[3274,3277],[3285,3286],[3298,3299],3315,[3328,3331],[3387,3388],[3390,3396],[3398,3400],[3402,3405],3415,[3426,3427],[3457,3459],3530,[3535,3540],3542,[3544,3551],[3570,3571],[3864,3865],3893,3895,3897,[3902,3903],[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4957,4959],[5906,5909],[5938,5940],[5970,5971],[6002,6003],[6155,6157],6159,[6277,6278],6313,[6432,6443],[6448,6459],[6679,6683],6783,[6832,6862],[6912,6916],[6964,6980],[7019,7027],[7040,7042],[7073,7085],[7142,7155],[7204,7223],[7376,7378],[7380,7400],7405,7412,[7415,7417],[7616,7628],[7630,7675],[7677,7679],8204,[8206,8207],[8234,8238],[8294,8303],[8400,8432],[11503,11505],11647,[11744,11775],[12330,12335],12341,[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43043,43047],43052,[43136,43137],[43188,43205],[43232,43249],43263,[43302,43309],[43335,43347],[43392,43395],[43443,43456],[43561,43574],43587,[43596,43597],[43755,43759],[43765,43766],[44003,44010],[44012,44013],64286,[65024,65039],[65056,65071],[65529,65531],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],[69632,69634],[69688,69702],69744,[69747,69748],[69759,69762],[69808,69818],69826,[69888,69890],[69927,69940],[69957,69958],70003,[70016,70018],[70067,70080],[70089,70092],[70094,70095],[70188,70199],70206,70209,[70367,70378],[70400,70403],[70459,70460],[70462,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70502,70508],[70512,70516],[70709,70726],70750,[70832,70851],[71087,71093],[71096,71104],[71132,71133],[71216,71232],[71339,71351],[71724,71738],[71984,71989],[71991,71992],[71995,71998],72e3,[72002,72003],[72145,72151],[72154,72160],72164,[72193,72202],[72243,72249],[72251,72254],72263,[72273,72283],[72330,72345],[72751,72758],[72760,72767],[72850,72871],[72873,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73098,73102],[73104,73105],[73107,73111],[73459,73462],[73472,73473],73475,[73524,73530],[73534,73538],78912,[78919,78933],[92912,92916],[92976,92982],94031,[94033,94087],[94095,94098],[94192,94193],[113821,113822],[113824,113827],[118528,118573],[118576,118598],[119141,119145],[119149,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,[123184,123190],123566,[123628,123631],[124140,124143],[125136,125142],[125252,125258],917505,[917536,917631],[917760,917999]],K5e=[[3585,3642],[3648,3662],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3773],[3776,3780],3782,[3784,3790],[3804,3807],[4096,4159],[4176,4239],[4250,4255],[6016,6099],6103,[6108,6109],[6480,6509],[6512,6516],[6528,6571],[6576,6601],6618,[6622,6623],[6688,6750],[6752,6780],[6816,6829],[43488,43503],[43514,43518],[43616,43714],[43739,43743],[71424,71450],[71453,71467],[71482,71483],[71487,71494]],Z5e=[12353,12355,12357,12359,12361,12387,12419,12421,12423,12430,[12437,12438],12449,12451,12453,12455,12457,12483,12515,12517,12519,12526,[12533,12534],12540,[12784,12799],[65383,65392],110898,[110928,110930],110933,[110948,110951]],q5e=[65532],Q5e=[9757,9977,[9994,9997],127877,[127938,127940],127943,[127946,127948],[128066,128067],[128070,128080],[128102,128120],128124,[128129,128131],[128133,128135],128143,128145,128170,[128372,128373],128378,128400,[128405,128406],[128581,128583],[128587,128591],128675,[128692,128694],128704,128716,129292,129295,[129304,129311],129318,[129328,129337],[129340,129342],129399,[129461,129462],[129464,129465],129467,[129485,129487],[129489,129501],[129731,129733],[129776,129784]],J5e=[[127995,127999]],e9e=[33,63,1478,1563,[1565,1567],1748,2041,[3853,3857],3860,[6146,6147],[6152,6153],[6468,6469],[10082,10083],11513,11518,11822,[11859,11860],42510,[43126,43127],[65045,65046],[65110,65111],65281,65311,[71108,71109],72817],t9e=[160,847,[860,866],3848,3852,3858,[4057,4058],6158,7629,7676,8199,8209,8239,[78896,78902],[78905,78907],94180],n9e=[44032,44060,44088,44116,44144,44172,44200,44228,44256,44284,44312,44340,44368,44396,44424,44452,44480,44508,44536,44564,44592,44620,44648,44676,44704,44732,44760,44788,44816,44844,44872,44900,44928,44956,44984,45012,45040,45068,45096,45124,45152,45180,45208,45236,45264,45292,45320,45348,45376,45404,45432,45460,45488,45516,45544,45572,45600,45628,45656,45684,45712,45740,45768,45796,45824,45852,45880,45908,45936,45964,45992,46020,46048,46076,46104,46132,46160,46188,46216,46244,46272,46300,46328,46356,46384,46412,46440,46468,46496,46524,46552,46580,46608,46636,46664,46692,46720,46748,46776,46804,46832,46860,46888,46916,46944,46972,47e3,47028,47056,47084,47112,47140,47168,47196,47224,47252,47280,47308,47336,47364,47392,47420,47448,47476,47504,47532,47560,47588,47616,47644,47672,47700,47728,47756,47784,47812,47840,47868,47896,47924,47952,47980,48008,48036,48064,48092,48120,48148,48176,48204,48232,48260,48288,48316,48344,48372,48400,48428,48456,48484,48512,48540,48568,48596,48624,48652,48680,48708,48736,48764,48792,48820,48848,48876,48904,48932,48960,48988,49016,49044,49072,49100,49128,49156,49184,49212,49240,49268,49296,49324,49352,49380,49408,49436,49464,49492,49520,49548,49576,49604,49632,49660,49688,49716,49744,49772,49800,49828,49856,49884,49912,49940,49968,49996,50024,50052,50080,50108,50136,50164,50192,50220,50248,50276,50304,50332,50360,50388,50416,50444,50472,50500,50528,50556,50584,50612,50640,50668,50696,50724,50752,50780,50808,50836,50864,50892,50920,50948,50976,51004,51032,51060,51088,51116,51144,51172,51200,51228,51256,51284,51312,51340,51368,51396,51424,51452,51480,51508,51536,51564,51592,51620,51648,51676,51704,51732,51760,51788,51816,51844,51872,51900,51928,51956,51984,52012,52040,52068,52096,52124,52152,52180,52208,52236,52264,52292,52320,52348,52376,52404,52432,52460,52488,52516,52544,52572,52600,52628,52656,52684,52712,52740,52768,52796,52824,52852,52880,52908,52936,52964,52992,53020,53048,53076,53104,53132,53160,53188,53216,53244,53272,53300,53328,53356,53384,53412,53440,53468,53496,53524,53552,53580,53608,53636,53664,53692,53720,53748,53776,53804,53832,53860,53888,53916,53944,53972,54e3,54028,54056,54084,54112,54140,54168,54196,54224,54252,54280,54308,54336,54364,54392,54420,54448,54476,54504,54532,54560,54588,54616,54644,54672,54700,54728,54756,54784,54812,54840,54868,54896,54924,54952,54980,55008,55036,55064,55092,55120,55148,55176],r9e=[[44033,44059],[44061,44087],[44089,44115],[44117,44143],[44145,44171],[44173,44199],[44201,44227],[44229,44255],[44257,44283],[44285,44311],[44313,44339],[44341,44367],[44369,44395],[44397,44423],[44425,44451],[44453,44479],[44481,44507],[44509,44535],[44537,44563],[44565,44591],[44593,44619],[44621,44647],[44649,44675],[44677,44703],[44705,44731],[44733,44759],[44761,44787],[44789,44815],[44817,44843],[44845,44871],[44873,44899],[44901,44927],[44929,44955],[44957,44983],[44985,45011],[45013,45039],[45041,45067],[45069,45095],[45097,45123],[45125,45151],[45153,45179],[45181,45207],[45209,45235],[45237,45263],[45265,45291],[45293,45319],[45321,45347],[45349,45375],[45377,45403],[45405,45431],[45433,45459],[45461,45487],[45489,45515],[45517,45543],[45545,45571],[45573,45599],[45601,45627],[45629,45655],[45657,45683],[45685,45711],[45713,45739],[45741,45767],[45769,45795],[45797,45823],[45825,45851],[45853,45879],[45881,45907],[45909,45935],[45937,45963],[45965,45991],[45993,46019],[46021,46047],[46049,46075],[46077,46103],[46105,46131],[46133,46159],[46161,46187],[46189,46215],[46217,46243],[46245,46271],[46273,46299],[46301,46327],[46329,46355],[46357,46383],[46385,46411],[46413,46439],[46441,46467],[46469,46495],[46497,46523],[46525,46551],[46553,46579],[46581,46607],[46609,46635],[46637,46663],[46665,46691],[46693,46719],[46721,46747],[46749,46775],[46777,46803],[46805,46831],[46833,46859],[46861,46887],[46889,46915],[46917,46943],[46945,46971],[46973,46999],[47001,47027],[47029,47055],[47057,47083],[47085,47111],[47113,47139],[47141,47167],[47169,47195],[47197,47223],[47225,47251],[47253,47279],[47281,47307],[47309,47335],[47337,47363],[47365,47391],[47393,47419],[47421,47447],[47449,47475],[47477,47503],[47505,47531],[47533,47559],[47561,47587],[47589,47615],[47617,47643],[47645,47671],[47673,47699],[47701,47727],[47729,47755],[47757,47783],[47785,47811],[47813,47839],[47841,47867],[47869,47895],[47897,47923],[47925,47951],[47953,47979],[47981,48007],[48009,48035],[48037,48063],[48065,48091],[48093,48119],[48121,48147],[48149,48175],[48177,48203],[48205,48231],[48233,48259],[48261,48287],[48289,48315],[48317,48343],[48345,48371],[48373,48399],[48401,48427],[48429,48455],[48457,48483],[48485,48511],[48513,48539],[48541,48567],[48569,48595],[48597,48623],[48625,48651],[48653,48679],[48681,48707],[48709,48735],[48737,48763],[48765,48791],[48793,48819],[48821,48847],[48849,48875],[48877,48903],[48905,48931],[48933,48959],[48961,48987],[48989,49015],[49017,49043],[49045,49071],[49073,49099],[49101,49127],[49129,49155],[49157,49183],[49185,49211],[49213,49239],[49241,49267],[49269,49295],[49297,49323],[49325,49351],[49353,49379],[49381,49407],[49409,49435],[49437,49463],[49465,49491],[49493,49519],[49521,49547],[49549,49575],[49577,49603],[49605,49631],[49633,49659],[49661,49687],[49689,49715],[49717,49743],[49745,49771],[49773,49799],[49801,49827],[49829,49855],[49857,49883],[49885,49911],[49913,49939],[49941,49967],[49969,49995],[49997,50023],[50025,50051],[50053,50079],[50081,50107],[50109,50135],[50137,50163],[50165,50191],[50193,50219],[50221,50247],[50249,50275],[50277,50303],[50305,50331],[50333,50359],[50361,50387],[50389,50415],[50417,50443],[50445,50471],[50473,50499],[50501,50527],[50529,50555],[50557,50583],[50585,50611],[50613,50639],[50641,50667],[50669,50695],[50697,50723],[50725,50751],[50753,50779],[50781,50807],[50809,50835],[50837,50863],[50865,50891],[50893,50919],[50921,50947],[50949,50975],[50977,51003],[51005,51031],[51033,51059],[51061,51087],[51089,51115],[51117,51143],[51145,51171],[51173,51199],[51201,51227],[51229,51255],[51257,51283],[51285,51311],[51313,51339],[51341,51367],[51369,51395],[51397,51423],[51425,51451],[51453,51479],[51481,51507],[51509,51535],[51537,51563],[51565,51591],[51593,51619],[51621,51647],[51649,51675],[51677,51703],[51705,51731],[51733,51759],[51761,51787],[51789,51815],[51817,51843],[51845,51871],[51873,51899],[51901,51927],[51929,51955],[51957,51983],[51985,52011],[52013,52039],[52041,52067],[52069,52095],[52097,52123],[52125,52151],[52153,52179],[52181,52207],[52209,52235],[52237,52263],[52265,52291],[52293,52319],[52321,52347],[52349,52375],[52377,52403],[52405,52431],[52433,52459],[52461,52487],[52489,52515],[52517,52543],[52545,52571],[52573,52599],[52601,52627],[52629,52655],[52657,52683],[52685,52711],[52713,52739],[52741,52767],[52769,52795],[52797,52823],[52825,52851],[52853,52879],[52881,52907],[52909,52935],[52937,52963],[52965,52991],[52993,53019],[53021,53047],[53049,53075],[53077,53103],[53105,53131],[53133,53159],[53161,53187],[53189,53215],[53217,53243],[53245,53271],[53273,53299],[53301,53327],[53329,53355],[53357,53383],[53385,53411],[53413,53439],[53441,53467],[53469,53495],[53497,53523],[53525,53551],[53553,53579],[53581,53607],[53609,53635],[53637,53663],[53665,53691],[53693,53719],[53721,53747],[53749,53775],[53777,53803],[53805,53831],[53833,53859],[53861,53887],[53889,53915],[53917,53943],[53945,53971],[53973,53999],[54001,54027],[54029,54055],[54057,54083],[54085,54111],[54113,54139],[54141,54167],[54169,54195],[54197,54223],[54225,54251],[54253,54279],[54281,54307],[54309,54335],[54337,54363],[54365,54391],[54393,54419],[54421,54447],[54449,54475],[54477,54503],[54505,54531],[54533,54559],[54561,54587],[54589,54615],[54617,54643],[54645,54671],[54673,54699],[54701,54727],[54729,54755],[54757,54783],[54785,54811],[54813,54839],[54841,54867],[54869,54895],[54897,54923],[54925,54951],[54953,54979],[54981,55007],[55009,55035],[55037,55063],[55065,55091],[55093,55119],[55121,55147],[55149,55175],[55177,55203]],i9e=[[1488,1514],[1519,1522],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335]],o9e=[45],s9e=[[8986,8987],[9200,9203],[9728,9731],[9748,9749],9752,[9754,9756],[9758,9759],[9785,9787],9832,9855,[9917,9928],9933,[9935,9937],[9939,9940],[9944,9945],9948,[9951,9953],9962,[9969,9973],[9975,9976],9978,[9981,9988],[9992,9993],10084,[11904,11929],[11931,12019],[12032,12245],[12272,12283],[12291,12292],[12294,12295],[12306,12307],[12320,12329],[12336,12340],[12342,12346],[12349,12351],12354,12356,12358,12360,[12362,12386],[12388,12418],12420,12422,[12424,12429],[12431,12436],12447,12450,12452,12454,12456,[12458,12482],[12484,12514],12516,12518,[12520,12525],[12527,12532],[12535,12538],12543,[12549,12591],[12593,12686],[12688,12771],[12800,12830],[12832,12871],[12880,19903],[19968,40980],[40982,42124],[42128,42182],[63744,64255],[65072,65076],[65093,65094],[65097,65103],65105,65112,[65119,65126],65128,65131,[65282,65283],[65286,65287],[65290,65291],65293,[65295,65305],[65308,65310],[65312,65338],65340,[65342,65370],65372,65374,65382,[65393,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65506,65508],[73541,73551],[94208,100343],[100352,101119],[101632,101640],[110592,110882],[110960,111355],[126976,127231],[127245,127247],[127341,127343],[127405,127461],[127488,127876],[127878,127899],[127902,127924],[127927,127931],[127933,127937],[127941,127942],[127944,127945],[127949,127994],[128e3,128065],[128068,128069],[128081,128101],[128121,128123],[128125,128128],128132,[128136,128142],128144,[128146,128159],128161,128163,[128165,128169],[128171,128174],128176,[128179,128255],[128263,128278],[128293,128305],[128330,128371],[128374,128377],[128379,128399],[128401,128404],[128407,128467],[128476,128499],[128506,128580],[128584,128586],[128640,128674],[128676,128691],[128695,128703],[128705,128715],[128717,128767],[128884,128895],[128981,129023],[129036,129039],[129096,129103],[129114,129119],[129160,129167],[129198,129279],[129293,129294],[129296,129303],[129312,129317],[129319,129327],[129338,129339],[129343,129398],[129400,129460],129463,129466,[129468,129484],129488,[129502,129535],[129620,129730],[129734,129775],[129785,129791],[130048,131069],[131072,196605],[196608,262141]],a9e=[44,46,[58,59],894,1417,[1548,1549],2040,8260,65040,[65043,65044]],l9e=[[8228,8230],8943,65049,68342],u9e=[[4352,4447],[43360,43388]],c9e=[[4520,4607],[55243,55291]],d9e=[[4448,4519],[55216,55238]],h9e=[10],f9e=[[11,12],[8232,8233]],m9e=[133],p9e=[6102,[8252,8253],[8263,8265],12293,12316,[12347,12348],[12443,12446],12448,12539,[12541,12542],40981,[65108,65109],[65306,65307],65381,[65438,65439],[94176,94179],[128633,128635]],g9e=[[48,57],[1632,1641],[1643,1644],[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2662,2671],[2790,2799],[2918,2927],[3046,3055],[3174,3183],[3302,3311],[3430,3439],[3558,3567],[3664,3673],[3792,3801],[3872,3881],[4160,4169],[4240,4249],[6112,6121],[6160,6169],[6470,6479],[6608,6617],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],[42528,42537],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[66720,66729],[68912,68921],[69734,69743],[69872,69881],[69942,69951],[70096,70105],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71481],[71904,71913],[72016,72025],[72784,72793],[73040,73049],[73120,73129],[73552,73561],[92768,92777],[92864,92873],[93008,93017],[120782,120831],[123200,123209],[123632,123641],[124144,124153],[125264,125273],[130032,130041]],v9e=[40,91,123,161,191,3898,3900,5787,8218,8222,8261,8317,8333,8968,8970,9001,10088,10090,10092,10094,10096,10098,10100,10181,10214,10216,10218,10220,10222,10627,10629,10631,10633,10635,10637,10639,10641,10643,10645,10647,10712,10714,10748,11800,11810,11812,11814,11816,11842,11861,11863,11865,11867,12296,12298,12300,12302,12304,12308,12310,12312,12314,12317,64831,65047,65077,65079,65081,65083,65085,65087,65089,65091,65095,65113,65115,65117,65288,65339,65371,65375,65378,[78424,78426],78470,78472,78713,78903,78908,78910,83406,[125278,125279]],_9e=[37,162,176,[1545,1547],1642,[2546,2547],2553,3449,[8240,8247],8279,8359,8374,8379,8382,8384,8451,8457,43064,65020,65130,65285,65504,[73693,73696],126124,126128],b9e=[36,43,92,[163,165],177,1423,[2046,2047],2555,2801,3065,3647,6107,[8352,8358],[8360,8373],[8375,8378],[8380,8381],8383,[8385,8399],8470,[8722,8723],65129,65284,65505,[65509,65510],123647],C9e=[34,39,171,187,[8216,8217],[8219,8221],8223,[8249,8250],[10075,10080],[11776,11789],[11804,11805],[11808,11809],[128630,128632]],y9e=[[127462,127487]],S9e=[32],E9e=[[55296,57343]],w9e=[[888,889],[896,899],907,909,930,1328,[1367,1368],[1419,1420],1424,[1480,1487],[1515,1518],[1525,1535],1806,[1867,1868],[1970,1983],[2043,2044],[2094,2095],2111,[2140,2141],2143,[2155,2159],2191,[2194,2199],2436,[2445,2446],[2449,2450],2473,2481,[2483,2485],[2490,2491],[2501,2502],[2505,2506],[2511,2518],[2520,2523],2526,[2532,2533],[2559,2560],2564,[2571,2574],[2577,2578],2601,2609,2612,2615,[2618,2619],2621,[2627,2630],[2633,2634],[2638,2640],[2642,2648],2653,[2655,2661],[2679,2688],2692,2702,2706,2729,2737,2740,[2746,2747],2758,2762,[2766,2767],[2769,2783],[2788,2789],[2802,2808],2816,2820,[2829,2830],[2833,2834],2857,2865,2868,[2874,2875],[2885,2886],[2889,2890],[2894,2900],[2904,2907],2910,[2916,2917],[2936,2945],2948,[2955,2957],2961,[2966,2968],2971,2973,[2976,2978],[2981,2983],[2987,2989],[3002,3005],[3011,3013],3017,[3022,3023],[3025,3030],[3032,3045],[3067,3071],3085,3089,3113,[3130,3131],3141,3145,[3150,3156],3159,[3163,3164],[3166,3167],[3172,3173],[3184,3190],3213,3217,3241,3252,[3258,3259],3269,3273,[3278,3284],[3287,3292],3295,[3300,3301],3312,[3316,3327],3341,3345,3397,3401,[3408,3411],[3428,3429],3456,3460,[3479,3481],3506,3516,[3518,3519],[3527,3529],[3531,3534],3541,3543,[3552,3557],[3568,3569],[3573,3584],[3643,3646],[3676,3712],3715,3717,3723,3748,3750,[3774,3775],3781,3783,3791,[3802,3803],[3808,3839],3912,[3949,3952],3992,4029,4045,[4059,4095],4294,[4296,4300],[4302,4303],4681,[4686,4687],4695,4697,[4702,4703],4745,[4750,4751],4785,[4790,4791],4799,4801,[4806,4807],4823,4881,[4886,4887],[4955,4956],[4989,4991],[5018,5023],[5110,5111],[5118,5119],[5789,5791],[5881,5887],[5910,5918],[5943,5951],[5972,5983],5997,6001,[6004,6015],[6110,6111],[6122,6127],[6138,6143],[6170,6175],[6265,6271],[6315,6319],[6390,6399],6431,[6444,6447],[6460,6463],[6465,6467],[6510,6511],[6517,6527],[6572,6575],[6602,6607],[6619,6621],[6684,6685],6751,[6781,6782],[6794,6799],[6810,6815],[6830,6831],[6863,6911],[6989,6991],7039,[7156,7163],[7224,7226],[7242,7244],[7305,7311],[7355,7356],[7368,7375],[7419,7423],[7958,7959],[7966,7967],[8006,8007],[8014,8015],8024,8026,8028,8030,[8062,8063],8117,8133,[8148,8149],8156,[8176,8177],8181,8191,8293,[8306,8307],8335,[8349,8351],[8433,8447],[8588,8591],[9255,9279],[9291,9311],[11124,11125],11158,[11508,11512],11558,[11560,11564],[11566,11567],[11624,11630],[11633,11646],[11671,11679],11687,11695,11703,11711,11719,11727,11735,11743,[11870,11903],11930,[12020,12031],[12246,12271],[12284,12287],12352,[12439,12440],[12544,12548],12592,12687,[12772,12783],12831,[42125,42127],[42183,42191],[42540,42559],[42744,42751],[42955,42959],42962,42964,[42970,42993],[43053,43055],[43066,43071],[43128,43135],[43206,43213],[43226,43231],[43348,43358],[43389,43391],43470,[43482,43485],43519,[43575,43583],[43598,43599],[43610,43611],[43715,43738],[43767,43776],[43783,43784],[43791,43792],[43799,43807],43815,43823,[43884,43887],[44014,44015],[44026,44031],[55204,55215],[55239,55242],[55292,55295],[57344,63743],[64263,64274],[64280,64284],64311,64317,64319,64322,64325,[64451,64466],[64912,64913],[64968,64974],[64976,65007],[65050,65055],65107,65127,[65132,65135],65141,[65277,65278],65280,[65471,65473],[65480,65481],[65488,65489],[65496,65497],[65501,65503],65511,[65519,65528],[65534,65535],65548,65575,65595,65598,[65614,65615],[65630,65663],[65787,65791],[65795,65798],[65844,65846],65935,[65949,65951],[65953,65999],[66046,66175],[66205,66207],[66257,66271],[66300,66303],[66340,66348],[66379,66383],[66427,66431],66462,[66500,66503],[66518,66559],[66718,66719],[66730,66735],[66772,66775],[66812,66815],[66856,66863],[66916,66926],66939,66955,66963,66966,66978,66994,67002,[67005,67071],[67383,67391],[67414,67423],[67432,67455],67462,67505,[67515,67583],[67590,67591],67593,67638,[67641,67643],[67645,67646],67670,[67743,67750],[67760,67807],67827,[67830,67834],[67868,67870],[67898,67902],[67904,67967],[68024,68027],[68048,68049],68100,[68103,68107],68116,68120,[68150,68151],[68155,68158],[68169,68175],[68185,68191],[68256,68287],[68327,68330],[68343,68351],[68406,68408],[68438,68439],[68467,68471],[68498,68504],[68509,68520],[68528,68607],[68681,68735],[68787,68799],[68851,68857],[68904,68911],[68922,69215],69247,69290,[69294,69295],[69298,69372],[69416,69423],[69466,69487],[69514,69551],[69580,69599],[69623,69631],[69710,69713],[69750,69758],[69827,69836],[69838,69839],[69865,69871],[69882,69887],69941,[69960,69967],[70007,70015],70112,[70133,70143],70162,[70210,70271],70279,70281,70286,70302,[70314,70319],[70379,70383],[70394,70399],70404,[70413,70414],[70417,70418],70441,70449,70452,70458,[70469,70470],[70473,70474],[70478,70479],[70481,70486],[70488,70492],[70500,70501],[70509,70511],[70517,70655],70748,[70754,70783],[70856,70863],[70874,71039],[71094,71095],[71134,71167],[71237,71247],[71258,71263],[71277,71295],[71354,71359],[71370,71423],[71451,71452],[71468,71471],[71495,71679],[71740,71839],[71923,71934],[71943,71944],[71946,71947],71956,71959,71990,[71993,71994],[72007,72015],[72026,72095],[72104,72105],[72152,72153],[72165,72191],[72264,72271],[72355,72367],[72441,72447],[72458,72703],72713,72759,[72774,72783],[72813,72815],[72848,72849],72872,[72887,72959],72967,72970,[73015,73017],73019,73022,[73032,73039],[73050,73055],73062,73065,73103,73106,[73113,73119],[73130,73439],[73465,73471],73489,[73531,73533],[73562,73647],[73649,73663],[73714,73726],[74650,74751],74863,[74869,74879],[75076,77711],[77811,77823],[78934,82943],[83527,92159],[92729,92735],92767,[92778,92781],92863,[92874,92879],[92910,92911],[92918,92927],[92998,93007],93018,93026,[93048,93052],[93072,93759],[93851,93951],[94027,94030],[94088,94094],[94112,94175],[94181,94191],[94194,94207],[100344,100351],[101590,101631],[101641,110575],110580,110588,110591,[110883,110897],[110899,110927],[110931,110932],[110934,110947],[110952,110959],[111356,113663],[113771,113775],[113789,113791],[113801,113807],[113818,113819],[113828,118527],[118574,118575],[118599,118607],[118724,118783],[119030,119039],[119079,119080],[119275,119295],[119366,119487],[119508,119519],[119540,119551],[119639,119647],[119673,119807],119893,119965,[119968,119969],[119971,119972],[119975,119976],119981,119994,119996,120004,120070,[120075,120076],120085,120093,120122,120127,120133,[120135,120137],120145,[120486,120487],[120780,120781],[121484,121498],121504,[121520,122623],[122655,122660],[122667,122879],122887,[122905,122906],122914,122917,[122923,122927],[122990,123022],[123024,123135],[123181,123183],[123198,123199],[123210,123213],[123216,123535],[123567,123583],[123642,123646],[123648,124111],[124154,124895],124903,124908,124911,124927,[125125,125126],[125143,125183],[125260,125263],[125274,125277],[125280,126064],[126133,126208],[126270,126463],126468,126496,126499,[126501,126502],126504,126515,126520,126522,[126524,126529],[126531,126534],126536,126538,126540,126544,126547,[126549,126550],126552,126554,126556,126558,126560,126563,[126565,126566],126571,126579,126584,126589,126591,126602,[126620,126624],126628,126634,[126652,126703],[126706,126975],[131070,131071],[196606,196607],[262142,917504],[917506,917535],[917632,917759],[918e3,1114111]],R9e=[8288,65279],D9e=[8205],I9e=[8203],x9e=Object.freeze(Object.defineProperty({__proto__:null,Alphabetic:F5e,Ambiguous:U5e,Break_After:H5e,Break_Before:V5e,Break_Both:j5e,Break_Symbols:z5e,Carriage_Return:W5e,Close_Parenthesis:X5e,Close_Punctuation:Y5e,Combining_Mark:G5e,Complex_Context:K5e,Conditional_Japanese_Starter:Z5e,Contingent_Break:q5e,E_Base:Q5e,E_Modifier:J5e,Exclamation:e9e,Glue:t9e,H2:n9e,H3:r9e,Hebrew_Letter:i9e,Hyphen:o9e,Ideographic:s9e,Infix_Numeric:a9e,Inseparable:l9e,JL:u9e,JT:c9e,JV:d9e,Line_Feed:h9e,Mandatory_Break:f9e,Next_Line:m9e,Nonstarter:p9e,Numeric:g9e,Open_Punctuation:v9e,Postfix_Numeric:_9e,Prefix_Numeric:b9e,Quotation:C9e,Regional_Indicator:y9e,Space:S9e,Surrogate:E9e,Unknown:w9e,Word_Joiner:R9e,ZWJ:D9e,ZWSpace:I9e},Symbol.toStringTag,{value:"Module"})),M9e=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,727],[734,767],[880,884],[886,887],[890,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],[1369,1372],1374,[1376,1416],1418,1523,[1568,1610],[1646,1647],[1649,1747],1749,[1765,1766],[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2036,2037],2042,[2048,2069],2074,2084,2088,[2112,2136],[2144,2154],[2160,2183],[2185,2190],[2208,2249],[2308,2361],2365,2384,[2392,2401],[2417,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],3165,[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,[3293,3294],[3296,3297],[3313,3314],[3332,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3840,[3904,3911],[3913,3948],[3976,3980],[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5905],[5919,5937],[5952,5969],[5984,5996],[5998,6e3],[6176,6264],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6656,6678],[6917,6963],[6981,6988],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7293],[7296,7304],[7312,7354],[7357,7359],[7401,7404],[7406,7411],[7413,7414],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8473,8477],8484,8486,8488,[8490,8493],[8495,8505],[8508,8511],[8517,8521],8526,[8544,8584],[9398,9449],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[11568,11623],11631,[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],11823,12293,[12347,12348],[12549,12591],[12593,12686],[12704,12735],[40960,42124],[42192,42237],[42240,42508],[42512,42527],[42538,42539],[42560,42606],[42623,42653],[42656,42735],[42760,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,[43261,43262],[43274,43301],[43312,43334],[43360,43388],[43396,43442],43471,[43520,43560],[43584,43586],[43588,43595],[43744,43754],[43762,43764],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43881],[43888,44002],[44032,55203],[55216,55238],[55243,55291],[64256,64262],[64275,64279],[64336,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65313,65338],[65345,65370],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65856,65908],[66176,66204],[66208,66256],[66304,66335],[66349,66378],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68149],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68899],[69248,69289],[69296,69297],[69376,69404],69415,[69424,69445],[69488,69505],[69552,69572],[69600,69622],[69635,69687],[69745,69746],69749,[69763,69807],[69840,69864],[69891,69926],69956,69959,[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70751,70753],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],71352,[71680,71723],[71840,71903],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],71999,72001,[72096,72103],[72106,72144],72161,72163,72192,[72203,72242],72250,72272,[72284,72329],72349,[72368,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73056,73061],[73063,73064],[73066,73097],73112,[73440,73458],73474,[73476,73488],[73490,73523],73648,[73728,74649],[74752,74862],[74880,75075],[77712,77808],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[92992,92995],[93027,93047],[93053,93071],[93760,93823],[93952,94026],94032,[94099,94111],[94176,94177],94179,[113664,113770],[113776,113788],[113792,113800],[113808,113817],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],123214,[123536,123565],[123584,123627],[124112,124139],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125184,125251],125259,[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[127280,127305],[127312,127337],[127344,127369]],O9e=[13],T9e=[34],$9e=[[768,879],[1155,1161],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],2045,[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2200,2207],[2250,2273],[2275,2307],[2362,2364],[2366,2383],[2385,2391],[2402,2403],[2433,2435],2492,[2494,2500],[2503,2504],[2507,2509],2519,[2530,2531],2558,[2561,2563],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2691],2748,[2750,2757],[2759,2761],[2763,2765],[2786,2787],[2810,2815],[2817,2819],2876,[2878,2884],[2887,2888],[2891,2893],[2901,2903],[2914,2915],2946,[3006,3010],[3014,3016],[3018,3021],3031,[3072,3076],3132,[3134,3140],[3142,3144],[3146,3149],[3157,3158],[3170,3171],[3201,3203],3260,[3262,3268],[3270,3272],[3274,3277],[3285,3286],[3298,3299],3315,[3328,3331],[3387,3388],[3390,3396],[3398,3400],[3402,3405],3415,[3426,3427],[3457,3459],3530,[3535,3540],3542,[3544,3551],[3570,3571],3633,[3636,3642],[3655,3662],3761,[3764,3772],[3784,3790],[3864,3865],3893,3895,3897,[3902,3903],[3953,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4139,4158],[4182,4185],[4190,4192],[4194,4196],[4199,4205],[4209,4212],[4226,4237],4239,[4250,4253],[4957,4959],[5906,5909],[5938,5940],[5970,5971],[6002,6003],[6068,6099],6109,[6155,6157],6159,[6277,6278],6313,[6432,6443],[6448,6459],[6679,6683],[6741,6750],[6752,6780],6783,[6832,6862],[6912,6916],[6964,6980],[7019,7027],[7040,7042],[7073,7085],[7142,7155],[7204,7223],[7376,7378],[7380,7400],7405,7412,[7415,7417],[7616,7679],8204,[8400,8432],[11503,11505],11647,[11744,11775],[12330,12335],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43043,43047],43052,[43136,43137],[43188,43205],[43232,43249],43263,[43302,43309],[43335,43347],[43392,43395],[43443,43456],43493,[43561,43574],43587,[43596,43597],[43643,43645],43696,[43698,43700],[43703,43704],[43710,43711],43713,[43755,43759],[43765,43766],[44003,44010],[44012,44013],64286,[65024,65039],[65056,65071],[65438,65439],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],[69632,69634],[69688,69702],69744,[69747,69748],[69759,69762],[69808,69818],69826,[69888,69890],[69927,69940],[69957,69958],70003,[70016,70018],[70067,70080],[70089,70092],[70094,70095],[70188,70199],70206,70209,[70367,70378],[70400,70403],[70459,70460],[70462,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70502,70508],[70512,70516],[70709,70726],70750,[70832,70851],[71087,71093],[71096,71104],[71132,71133],[71216,71232],[71339,71351],[71453,71467],[71724,71738],[71984,71989],[71991,71992],[71995,71998],72e3,[72002,72003],[72145,72151],[72154,72160],72164,[72193,72202],[72243,72249],[72251,72254],72263,[72273,72283],[72330,72345],[72751,72758],[72760,72767],[72850,72871],[72873,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73098,73102],[73104,73105],[73107,73111],[73459,73462],[73472,73473],73475,[73524,73530],[73534,73538],78912,[78919,78933],[92912,92916],[92976,92982],94031,[94033,94087],[94095,94098],94180,[94192,94193],[113821,113822],[118528,118573],[118576,118598],[119141,119145],[119149,119154],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,[123184,123190],123566,[123628,123631],[124140,124143],[125136,125142],[125252,125258],[127995,127999],[917536,917631],[917760,917999]],k9e=[95,8239,[8255,8256],8276,[65075,65076],[65101,65103],65343],A9e=[173,[1536,1541],1564,1757,1807,[2192,2193],2274,6158,[8206,8207],[8234,8238],[8288,8292],[8294,8303],65279,[65529,65531],69821,69837,[78896,78911],[113824,113827],[119155,119162],917505],N9e=[[1488,1514],[1519,1522],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335]],L9e=[[12337,12341],[12443,12444],[12448,12538],[12540,12543],[12784,12799],[13008,13054],[13056,13143],[65382,65437],[110576,110579],[110581,110587],[110589,110590],110592,[110880,110882],110933,[110948,110951]],P9e=[10],B9e=[58,183,903,1375,1524,8231,65043,65109,65306],F9e=[44,59,894,1417,[1548,1549],1644,2040,8260,65040,65044,65104,65108,65292,65307],U9e=[46,[8216,8217],8228,65106,65287,65294],H9e=[[11,12],133,[8232,8233]],V9e=[[48,57],[1632,1641],1643,[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2662,2671],[2790,2799],[2918,2927],[3046,3055],[3174,3183],[3302,3311],[3430,3439],[3558,3567],[3664,3673],[3792,3801],[3872,3881],[4160,4169],[4240,4249],[6112,6121],[6160,6169],[6470,6479],[6608,6617],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],[42528,42537],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[65296,65305],[66720,66729],[68912,68921],[69734,69743],[69872,69881],[69942,69951],[70096,70105],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71481],[71904,71913],[72016,72025],[72784,72793],[73040,73049],[73120,73129],[73552,73561],[92768,92777],[92864,92873],[93008,93017],[120782,120831],[123200,123209],[123632,123641],[124144,124153],[125264,125273],[130032,130041]],j9e=[[0,9],[14,31],33,[35,38],[40,43],45,47,[60,64],[91,94],96,[123,132],[134,159],[161,169],[171,172],[174,180],182,[184,185],[187,191],215,247,[728,733],885,[888,889],[896,901],907,909,930,1014,1154,1328,[1367,1368],1373,[1419,1424],1470,1472,1475,1478,[1480,1487],[1515,1518],[1525,1535],[1542,1547],[1550,1551],1563,[1565,1567],1642,1645,1748,1769,[1789,1790],[1792,1806],[1867,1868],[1970,1983],[2038,2039],2041,[2043,2044],[2046,2047],[2094,2111],[2140,2143],[2155,2159],2184,2191,[2194,2199],[2404,2405],2416,2436,[2445,2446],[2449,2450],2473,2481,[2483,2485],[2490,2491],[2501,2502],[2505,2506],[2511,2518],[2520,2523],2526,[2532,2533],[2546,2555],2557,[2559,2560],2564,[2571,2574],[2577,2578],2601,2609,2612,2615,[2618,2619],2621,[2627,2630],[2633,2634],[2638,2640],[2642,2648],2653,[2655,2661],[2678,2688],2692,2702,2706,2729,2737,2740,[2746,2747],2758,2762,[2766,2767],[2769,2783],[2788,2789],[2800,2808],2816,2820,[2829,2830],[2833,2834],2857,2865,2868,[2874,2875],[2885,2886],[2889,2890],[2894,2900],[2904,2907],2910,[2916,2917],2928,[2930,2945],2948,[2955,2957],2961,[2966,2968],2971,2973,[2976,2978],[2981,2983],[2987,2989],[3002,3005],[3011,3013],3017,[3022,3023],[3025,3030],[3032,3045],[3056,3071],3085,3089,3113,[3130,3131],3141,3145,[3150,3156],3159,[3163,3164],[3166,3167],[3172,3173],[3184,3199],3204,3213,3217,3241,3252,[3258,3259],3269,3273,[3278,3284],[3287,3292],3295,[3300,3301],3312,[3316,3327],3341,3345,3397,3401,[3407,3411],[3416,3422],[3428,3429],[3440,3449],3456,3460,[3479,3481],3506,3516,[3518,3519],[3527,3529],[3531,3534],3541,3543,[3552,3557],[3568,3569],[3572,3632],[3634,3635],[3643,3654],3663,[3674,3760],[3762,3763],[3773,3783],3791,[3802,3839],[3841,3863],[3866,3871],[3882,3892],3894,3896,[3898,3901],3912,[3949,3952],3973,3992,[4029,4037],[4039,4095],4130,4136,4159,[4170,4175],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4254,4255],4294,[4296,4300],[4302,4303],4347,4681,[4686,4687],4695,4697,[4702,4703],4745,[4750,4751],4785,[4790,4791],4799,4801,[4806,4807],4823,4881,[4886,4887],[4955,4956],[4960,4991],[5008,5023],[5110,5111],[5118,5120],[5741,5742],[5787,5791],[5867,5869],[5881,5887],[5910,5918],[5941,5951],[5972,5983],5997,6001,[6004,6015],[6100,6102],[6104,6107],[6110,6111],[6122,6154],[6170,6175],[6265,6271],[6315,6319],[6390,6399],6431,[6444,6447],[6460,6469],[6510,6511],[6517,6527],[6570,6575],[6602,6607],[6619,6655],[6684,6740],6751,[6781,6782],[6794,6799],[6810,6831],[6863,6911],[6989,6991],[7002,7018],[7028,7039],[7156,7167],[7224,7231],[7242,7244],[7294,7295],[7305,7311],[7355,7356],[7360,7375],7379,[7419,7423],[7958,7959],[7966,7967],[8006,8007],[8014,8015],8024,8026,8028,8030,[8062,8063],8117,8125,[8127,8129],8133,[8141,8143],[8148,8149],[8156,8159],[8173,8177],8181,[8189,8191],8199,[8208,8215],[8218,8227],[8229,8230],[8240,8254],[8257,8259],[8261,8275],[8277,8286],8293,8304,[8306,8318],[8320,8335],[8349,8399],[8433,8449],[8451,8454],[8456,8457],8468,[8470,8472],[8478,8483],8485,8487,8489,8494,[8506,8507],[8512,8516],[8522,8525],[8527,8543],[8585,9397],[9450,9756],[9758,9791],9793,[9795,9876],[9879,9976],[9978,9991],9993,[9998,10083],[10085,11263],[11493,11498],[11508,11519],11558,[11560,11564],[11566,11567],[11624,11630],[11632,11646],[11671,11679],11687,11695,11703,11711,11719,11727,11735,11743,[11776,11822],[11824,12287],[12289,12292],[12294,12329],12336,[12342,12346],[12349,12440],[12445,12447],12539,[12544,12548],12592,[12687,12703],[12736,12783],[12800,13007],13055,[13144,40959],[42125,42191],[42238,42239],[42509,42511],[42540,42559],42611,42622,[42738,42759],[42955,42959],42962,42964,[42970,42993],[43048,43051],[43053,43071],[43124,43135],[43206,43215],[43226,43231],[43256,43258],43260,[43310,43311],[43348,43359],[43389,43391],[43457,43470],[43482,43492],[43494,43503],[43514,43519],[43575,43583],[43598,43599],[43610,43642],[43646,43695],43697,[43701,43702],[43705,43709],43712,[43714,43743],[43760,43761],[43767,43776],[43783,43784],[43791,43792],[43799,43807],43815,43823,[43882,43887],44011,[44014,44015],[44026,44031],[55204,55215],[55239,55242],[55292,64047],[64107,64255],[64263,64274],[64280,64284],64297,64311,64317,64319,64322,64325,[64434,64466],[64830,64847],[64912,64913],[64968,65007],[65020,65023],[65041,65042],[65045,65055],[65072,65074],[65077,65100],65105,65107,[65110,65135],65141,[65277,65278],[65280,65286],[65288,65291],65293,65295,[65308,65312],[65339,65342],65344,[65371,65381],[65471,65473],[65480,65481],[65488,65489],[65496,65497],[65501,65528],[65532,65535],65548,65575,65595,65598,[65614,65615],[65630,65663],[65787,65855],[65909,66044],[66046,66175],[66205,66207],[66257,66271],[66273,66303],[66336,66348],[66379,66383],[66427,66431],[66462,66463],[66500,66503],66512,[66518,66559],[66718,66719],[66730,66735],[66772,66775],[66812,66815],[66856,66863],[66916,66927],66939,66955,66963,66966,66978,66994,67002,[67005,67071],[67383,67391],[67414,67423],[67432,67455],67462,67505,[67515,67583],[67590,67591],67593,67638,[67641,67643],[67645,67646],[67670,67679],[67703,67711],[67743,67807],67827,[67830,67839],[67862,67871],[67898,67967],[68024,68029],[68032,68095],68100,[68103,68107],68116,68120,[68150,68151],[68155,68158],[68160,68191],[68221,68223],[68253,68287],68296,[68327,68351],[68406,68415],[68438,68447],[68467,68479],[68498,68607],[68681,68735],[68787,68799],[68851,68863],[68904,68911],[68922,69247],69290,[69293,69295],[69298,69372],[69405,69414],[69416,69423],[69457,69487],[69510,69551],[69573,69599],[69623,69631],[69703,69733],[69750,69758],[69819,69820],[69822,69825],[69827,69836],[69838,69839],[69865,69871],[69882,69887],69941,[69952,69955],[69960,69967],[70004,70005],[70007,70015],[70085,70088],70093,70107,[70109,70143],70162,[70200,70205],[70210,70271],70279,70281,70286,70302,[70313,70319],[70379,70383],[70394,70399],70404,[70413,70414],[70417,70418],70441,70449,70452,70458,[70469,70470],[70473,70474],[70478,70479],[70481,70486],[70488,70492],[70500,70501],[70509,70511],[70517,70655],[70731,70735],[70746,70749],[70754,70783],70854,[70856,70863],[70874,71039],[71094,71095],[71105,71127],[71134,71167],[71233,71235],[71237,71247],[71258,71295],[71353,71359],[71370,71452],[71468,71471],[71482,71679],[71739,71839],[71914,71934],[71943,71944],[71946,71947],71956,71959,71990,[71993,71994],[72004,72015],[72026,72095],[72104,72105],[72152,72153],72162,[72165,72191],[72255,72262],[72264,72271],[72346,72348],[72350,72367],[72441,72703],72713,72759,[72769,72783],[72794,72817],[72848,72849],72872,[72887,72959],72967,72970,[73015,73017],73019,73022,[73032,73039],[73050,73055],73062,73065,73103,73106,[73113,73119],[73130,73439],[73463,73471],73489,[73531,73533],[73539,73551],[73562,73647],[73649,73727],[74650,74751],[74863,74879],[75076,77711],[77809,77823],[78934,82943],[83527,92159],[92729,92735],92767,[92778,92783],92863,[92874,92879],[92910,92911],[92917,92927],[92983,92991],[92996,93007],[93018,93026],[93048,93052],[93072,93759],[93824,93951],[94027,94030],[94088,94094],[94112,94175],94178,[94181,94191],[94194,110575],110580,110588,110591,[110593,110879],[110883,110932],[110934,110947],[110952,113663],[113771,113775],[113789,113791],[113801,113807],[113818,113820],113823,[113828,118527],[118574,118575],[118599,119140],[119146,119148],[119171,119172],[119180,119209],[119214,119361],[119365,119807],119893,119965,[119968,119969],[119971,119972],[119975,119976],119981,119994,119996,120004,120070,[120075,120076],120085,120093,120122,120127,120133,[120135,120137],120145,[120486,120487],120513,120539,120571,120597,120629,120655,120687,120713,120745,120771,[120780,120781],[120832,121343],[121399,121402],[121453,121460],[121462,121475],[121477,121498],121504,[121520,122623],[122655,122660],[122667,122879],122887,[122905,122906],122914,122917,[122923,122927],[122990,123022],[123024,123135],[123181,123183],[123198,123199],[123210,123213],[123215,123535],[123567,123583],[123642,124111],[124154,124895],124903,124908,124911,124927,[125125,125135],[125143,125183],[125260,125263],[125274,126463],126468,126496,126499,[126501,126502],126504,126515,126520,126522,[126524,126529],[126531,126534],126536,126538,126540,126544,126547,[126549,126550],126552,126554,126556,126558,126560,126563,[126565,126566],126571,126579,126584,126589,126591,126602,[126620,126624],126628,126634,[126652,127279],[127306,127311],[127338,127343],[127370,127461],[127488,127751],[127753,127805],[127807,127858],[127860,127876],[127878,127890],[127892,127907],[127909,127911],[127913,127937],[127941,127942],[127944,127945],[127949,127978],127980,[127982,127994],[128e3,128065],[128068,128069],[128081,128101],[128106,128109],128111,[128121,128123],[128125,128128],128132,[128136,128138],[128140,128169],[128171,128186],[128189,128294],[128296,128299],[128301,128371],[128374,128377],[128379,128399],[128401,128404],[128407,128487],[128489,128580],[128584,128586],[128592,128639],[128641,128657],[128659,128674],[128676,128691],[128695,128703],[128705,128715],[128717,129303],[129312,129317],[129319,129327],[129338,129339],[129343,129488],[129502,130031],[130042,917504],[917506,917535],[917632,917759],[918e3,1114111]],z9e=[[127462,127487]],W9e=[39],X9e=[32,5760,[8192,8198],[8200,8202],8287,12288],Y9e=[8205],G9e=Object.freeze(Object.defineProperty({__proto__:null,ALetter:M9e,CR:O9e,Double_Quote:T9e,Extend:$9e,ExtendNumLet:k9e,Format:A9e,Hebrew_Letter:N9e,Katakana:L9e,LF:P9e,MidLetter:B9e,MidNum:F9e,MidNumLet:U9e,Newline:H9e,Numeric:V9e,Other:j9e,Regional_Indicator:z9e,Single_Quote:W9e,WSegSpace:X9e,ZWJ:Y9e},Symbol.toStringTag,{value:"Module"})),K9e=Object.freeze(Object.defineProperty({__proto__:null,Bidi_Class:tue,Bidi_Mirroring_Glyph:A5e,Bidi_Paired_Bracket_Type:B5e,Binary_Property:X1e,Block:k5e,Case_Folding:c4e,General_Category:Tle,Line_Break:x9e,Script:r0e,Script_Extensions:o4e,Word_Break:G9e},Symbol.toStringTag,{value:"Module"}));function Pk(t){const e=Object.keys(t);if(e.length===0)throw new Error("Expected at least one category, but received 0.");if(e.some(n=>{const r=t[n];return r===void 0||r.length===0}))throw new Error("Expected at least one sub category, but received 0.");return e.map(n=>{const r=t[n].map(i=>Z9e(n,i));return new $6().union(...r)}).reduce((n,r)=>n.intersect(r))}function Z9e(t,e){const n=K9e[t][e];return new $6().union(...n)}const LC=Pk({Script:["Han","Katakana","Hiragana","Hangul","Bopomofo"],General_Category:["Other_Letter","Letter_Number","Other_Symbol","Modifier_Letter"]}),q9e=Pk({Block:["CJK_Compatibility","CJK_Symbols_And_Punctuation","Vertical_Forms","CJK_Compatibility_Forms","Small_Form_Variants","Halfwidth_And_Fullwidth_Forms","Ideographic_Description_Characters","Kanbun","CJK_Strokes","Enclosed_CJK_Letters_And_Months"]}).subtract(LC),Q9e=NC(LC,q9e);function J9e(){return NC(Q9e)}function efe(){return NC(LC)}const tR=t=>({sbr:.5,sbo:t,spr:.5,spo:t});let nl=class{static get globalFontMeasureCache(){return this._globalFontMeasureCache}static setFontMeasureCache(e,n,r){this._globalFontMeasureCache.has(e)||this._globalFontMeasureCache.set(e,new Map);const i=this._globalFontMeasureCache.get(e);i&&i.set(n,r)}static clearFontMeasureCache(e){var n;const r=e.split("/");if(r.length===1){const i=r[0];this._globalFontMeasureCache.delete(i)}else if(r.length===2){const i=r[0],o=r[1];(n=this._globalFontMeasureCache.get(i))==null||n.delete(o)}else return!1;return!0}static getFontMeasureCache(e,n){var r;return(r=this._globalFontMeasureCache.get(e))==null?void 0:r.get(n)}static autoCleanFontMeasureCache(e=1e6){let n=0,r=!1;for(const i of this._globalFontMeasureCache){const[,o]=i;if(n+=o.size,n>e){r=!0;break}}if(r){let i=0;for(const o of this._globalFontMeasureCache){const[s,a]=o;if(i+=a.size,i>e/2){const l=i-e/2;this._clearMeasureCache(l,a);break}this._globalFontMeasureCache.delete(s)}return!0}return!1}static getBaselineOffsetInfo(e,n){if(this._fontDataMap.size===0)return tR(n);const r=e.split(",");for(let i of r){i=i.replace(/'/g,"");const o=this._fontDataMap.get(i);if(!o)continue;const{subscriptSizeRatio:s,subscriptOffset:a,superscriptSizeRatio:l,superscriptOffset:u}=o;return{sbr:s,sbo:a*n,spr:l,spo:u*n}}return tR(n)}static getTextSizeByDom(e,n){if(n in this._getTextHeightCache)return this._getTextHeightCache[n];let r=document.getElementById("universheetTextSizeTest");const i="float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;";r||(r=document.createElement("span"),r.id="universheetTextSizeTest",document.getElementsByTagName("body")[0].appendChild(r)),r.style.cssText+=`${i};${n}`,r.innerText=e;const o=r.getBoundingClientRect(),s={width:o.width,height:o.height};return this._getTextHeightCache[n]=s,s}static getTextSize(e,n){const{fontString:r,fontSize:i,fontFamily:o}=n;let s=this._getBoundingBoxByFont(o,i);if(!s){const a=this.getMeasureText(e,r);s=this._calculateBoundingBoxByMeasureText(a,i)}return s}static getMeasureText(e,n){if(!this._context){const h=document.createElement("canvas");this._context=h.getContext("2d")}const r=this._context,i=this.getFontMeasureCache(n,e);if(i!=null)return i;r.font=n;const o=r.measureText(e),{width:s,fontBoundingBoxAscent:a,fontBoundingBoxDescent:l,actualBoundingBoxAscent:u,actualBoundingBoxDescent:c}=o,d={width:s,fontBoundingBoxAscent:a,fontBoundingBoxDescent:l,actualBoundingBoxAscent:u,actualBoundingBoxDescent:c};if(a==null||l==null||Number.isNaN(a)||Number.isNaN(l)){const h=this.getTextSizeByDom(_ae,n).height;r.textBaseline==="top"?(d.fontBoundingBoxAscent=d.actualBoundingBoxAscent=h,d.fontBoundingBoxDescent=d.actualBoundingBoxDescent=0):r.textBaseline==="middle"?(d.fontBoundingBoxDescent=d.actualBoundingBoxDescent=h/2,d.fontBoundingBoxAscent=d.actualBoundingBoxAscent=h/2):(d.fontBoundingBoxDescent=d.actualBoundingBoxDescent=0,d.fontBoundingBoxAscent=d.actualBoundingBoxAscent=h)}return this.setFontMeasureCache(n,e,d),d}static _clearMeasureCache(e,n){let r=0;for(const i of n){const[o]=i;if(r>e)break;n.delete(o),r++}return!0}static _getBoundingBoxByFont(e,n=28,r=""){const i=this._fontDataMap.get(e);if(!i)return;const{notDefWidth:o,ascender:s,descender:a,typoAscender:l,typoDescender:u,strikeoutPosition:c,subscriptSizeRatio:d,subscriptOffset:h,superscriptSizeRatio:f,superscriptOffset:m,hdmxData:p,glyphHorizonMap:g}=i,v=p==null?void 0:p.indexOf(Math.floor(n)),_=g.get(r.charCodeAt(0));let C=o;if(_){const{width:y,pixelsPerEm:S=[]}=_;v?C=S[v]:C=y}return{width:C*n,ba:s*n,bd:a*n,aba:l*n,abd:u*n,sp:c*n,sbr:d,sbo:h*n,spr:f,spo:m*n}}static _calculateBoundingBoxByMeasureText(e,n){const{width:r,fontBoundingBoxAscent:i,fontBoundingBoxDescent:o,actualBoundingBoxAscent:s,actualBoundingBoxDescent:a}=e;return{width:r,ba:i,bd:o,aba:s,abd:a,sp:(i+o)/2,sbr:.5,sbo:n,spr:.5,spo:n}}};M(nl,"_getTextHeightCache",{}),M(nl,"_context"),M(nl,"_fontDataMap",new Map),M(nl,"_globalFontMeasureCache",new Map);const Bk=180,tfe=Math.PI/Bk,nfe=Bk/Math.PI,nR="rgb(",rfe="rgba(",ls=(t,e)=>t?e!=null?`${rfe+t.join(",")},${e})`:`${nR+t.join(",")})`:`${nR}0,0,0)`,ife=100,rl=(t,e)=>{if(De.isNumber(t))return t;if(e&&t&&De.isString(t)&&t.substr(t.length-1,1)==="%"){const n=parseFloat(t)/ife;return e*n}return 0},ofe=16,qh=(t,e)=>(e||(e=window),e.requestPostAnimationFrame?e.requestPostAnimationFrame(t):e.requestAnimationFrame?e.requestAnimationFrame(t):e.msRequestAnimationFrame?e.msRequestAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(t):e.mozRequestAnimationFrame?e.mozRequestAnimationFrame(t):e.oRequestAnimationFrame?e.oRequestAnimationFrame(t):setTimeout(t,ofe)),sfe=(t,e)=>(e||(e=window),e.requestPostAnimationFrame?e.cancelPostAnimationFrame(t):e.requestAnimationFrame?e.cancelAnimationFrame(t):e.msRequestAnimationFrame?e.msCancelAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitCancelAnimationFrame(t):e.mozRequestAnimationFrame?e.mozCancelAnimationFrame(t):e.oRequestAnimationFrame?e.oCancelAnimationFrame(t):clearTimeout(t)),Fk=()=>{const t=document.createElement("canvas");try{t.style=t.style||{}}catch(e){console.error(e)}return t},afe=t=>t*nfe,Cl=t=>t*tfe,rR=()=>{let t="pointer";return typeof window<"u"&&!window.PointerEvent&&typeof navigator<"u"&&(t="mouse"),De.isTablet()&&!De.isIPhone()&&!(document&&"ontouchend"in document)&&(t="mouse"),t},lfe=()=>De.getBrowserType()==="safari",ufe=4,cfe=(t="obj",e=ufe)=>{const n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split("");let r="";for(let o=0;o<e;o++)r+=n[Math.round(Math.random()*(n.length-1))];const i=new Date().getTime();return`${t}_${r}_${i}`};function Uk(t){return Object.prototype.toString.apply(t)}function Hk(t){return Uk(t)==="[object Function]"}function iR(t){return Uk(t)==="[object String]"}function yv(t,e){return e=10**e,Math.round(t*e)/e}function Et(t,e){return Math.round(t*e)/e}function Qh(t,e){const n="Arial";if(!t){const c=`13px  ${n}`;return{fontCache:c,fontString:c,fontSize:13,fontFamily:n}}let r=Cd.ITALIC;(t.it===0||t.it===void 0)&&(r=Cd.NORMAL);let i=Cd.BOLD;(t.bl===0||t.bl===void 0)&&(i=Cd.NORMAL);let o=13;t.fs&&(o=Math.ceil(t.fs));let s=n;if(t.ff){let c=t.ff;c=c.replace(/"/g,"").replace(/'/g,""),c.indexOf(" ")>-1&&(c=`"${c}"`),c==null&&(c=n),s=c}const{va:a}=t;if(a===Cr.SUBSCRIPT||a===Cr.SUPERSCRIPT){const c=nl.getBaselineOffsetInfo(s,o),{sbr:d,spr:h}=c;o*=a===Cr.SUBSCRIPT?d:h}const l=`${r} ${i} ${o}px ${s}`,u=`${l}, ${AC} `;return{fontCache:l,fontString:u,fontSize:o,fontFamily:s}}const dfe=efe().toRegExp();function Sv(t){return dfe.test(t)}const hfe=J9e().toRegExp();function PC(t){return hfe.test(t)}const Vk=/^(?:[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26D3\uFE0F?(?:\u200D\uD83D\uDCA5)?|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF43\uDF45-\uDF4A\uDF4C-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDF44(?:\u200D\uD83D\uDFEB)?|\uDF4B(?:\u200D\uD83D\uDFE9)?|\uDFC3(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE41\uDE43\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC26(?:\u200D(?:\u2B1B|\uD83D\uDD25))?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?|\uDE42(?:\u200D[\u2194\u2195]\uFE0F?)?|\uDEB6(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC2\uDECE-\uDEDB\uDEE0-\uDEE8]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDCE(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1|\uDDD1\u200D\uD83E\uDDD2(?:\u200D\uD83E\uDDD2)?|\uDDD2(?:\u200D\uD83E\uDDD2)?))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?))/g;function ffe(t){return Vk.test(t)}function jk(t){return/[\u0600-\u06FF]|[\u0750-\u0750]|[\u0870-\u08FF]|[\uFB50-\uFDFF]|[\uFE70-\uFEFF]/gi.test(t)}function zk(t){return/[\u0180-\u024F]/gi.test(t)}function mfe(t){return/\s+/g.test(t)}const oR=1e3;let A7;function pfe(){if(A7)return A7;let t=56;for(;t<oR*2;t++)if(matchMedia(`(max-resolution: ${t}dpi)`).matches===!0)return t;return A7=t,setTimeout(()=>{A7=null},oR),t}const gfe=72;function vfe(t){return t*(gfe/pfe())}function A9(t){const{scaleX:e=1,scaleY:n=1}=t;return Math.max(e,n)}function g2(t,e,n,r){const i=t-1,o=e-1,s=n[i]||0,a=n[t]||n[n.length-1],l=r[o]||0,u=r[e]||r[r.length-1];return{startY:s,endY:a,startX:l,endX:u}}function k6(t,e,n,r,i){let{startY:o,endY:s,startX:a,endX:l}=g2(t,e,n,r);const{isMerged:u,isMergedMainCell:c,startRow:d,startColumn:h,endRow:f,endColumn:m}=cc(t,e,i);let p={startRow:d,startColumn:h,endRow:f,endColumn:m,startY:0,endY:0,startX:0,endX:0};const g=n.length-1,v=r.length-1;if(u&&d!==-1&&h!==-1){const _=n[d-1]||0,C=n[f]||n[g],y=r[h-1]||0,S=r[m]||r[v];p={...p,startY:_,endY:C,startX:y,endX:S}}else if(!u&&f!==-1&&m!==-1){const _=n[f]||n[g],C=r[m]||r[v];p={...p,startY:o,endY:_,startX:a,endX:C}}return{isMerged:u,isMergedMainCell:c,actualRow:t,actualColumn:e,startY:o,endY:s,startX:a,endX:l,mergeInfo:p}}function cc(t,e,n){let r=!1,i=!1,o=t,s=e,a=t,l=e;if(n==null)return{actualRow:t,actualColumn:e,isMergedMainCell:i,isMerged:r,endRow:o,endColumn:s,startRow:a,startColumn:l};for(let u=0;u<n.length;u++){const{startRow:c,endRow:d,startColumn:h,endColumn:f}=n[u];if(t===c&&e===h){o=d,s=f,a=c,l=h,i=!0;break}if(t>=c&&t<=d&&e>=h&&e<=f){o=d,s=f,a=c,l=h,r=!0;break}}return{actualRow:t,actualColumn:e,isMergedMainCell:i,isMerged:r,endRow:o,endColumn:s,startRow:a,startColumn:l}}function _fe(t,e,n,r){let i=!1;for(let o=e;o<=n;o++){const{isMerged:s,isMergedMainCell:a}=cc(t,o,r);if(!s&&!a){i=!0;break}}return i}function sR(t,e,n,r,i){const{startY:o,endY:s,startX:a,endX:l}=t;return t.startY=o+n,t.endY=s+n,t.startX=a+e,t.endX=l+e,{...t}}function Wk(t,e){return!(t.left>e.right||t.top>e.bottom||e.left>t.right||e.top>t.bottom)}function bfe(t){const e=document.createElement("style");document.head.appendChild(e);const n=e.sheet;for(const r of t)n==null||n.insertRule(r,n.cssRules.length)}function Cfe(t){for(let e=0,n=document.head.childNodes.length;e<n;e++){const r=document.head.childNodes[e];if(r.nodeName==="STYLE"&&r.textContent&&r.textContent.indexOf(t)>-1)return!0}return!1}function $c(t){return Number(t.replace(/px/gi,""))}function yfe(t){const e=getComputedStyle(t),{borderTopWidth:n,borderLeftWidth:r,borderRightWidth:i,borderBottomWidth:o,width:s,height:a}=e;return{top:$c(n),left:$c(r),right:$c(i),bottom:$c(o),width:$c(s),height:$c(a)}}let Ft=class Nn{constructor(e=0,n=0){this.x=e,this.y=n}static Zero(){return new Nn(0,0)}static One(){return new Nn(1,1)}static FromArray(e,n=0){return new Nn(e[n],e[n+1])}static FromArrayToRef(e,n,r){r.x=e[n],r.y=e[n+1]}static CatmullRom(e,n,r,i,o){const s=o*o,a=o*s,l=.5*(2*n.x+(-e.x+r.x)*o+(2*e.x-5*n.x+4*r.x-i.x)*s+(-e.x+3*n.x-3*r.x+i.x)*a),u=.5*(2*n.y+(-e.y+r.y)*o+(2*e.y-5*n.y+4*r.y-i.y)*s+(-e.y+3*n.y-3*r.y+i.y)*a);return new Nn(l,u)}static Clamp(e,n,r){let i=e.x;i=i>r.x?r.x:i,i=i<n.x?n.x:i;let o=e.y;return o=o>r.y?r.y:o,o=o<n.y?n.y:o,new Nn(i,o)}static Hermite(e,n,r,i,o){const s=o*o,a=o*s,l=2*a-3*s+1,u=-2*a+3*s,c=a-2*s+o,d=a-s,h=e.x*l+r.x*u+n.x*c+i.x*d,f=e.y*l+r.y*u+n.y*c+i.y*d;return new Nn(h,f)}static Hermite1stDerivative(e,n,r,i,o){const s=Nn.Zero();return this.Hermite1stDerivativeToRef(e,n,r,i,o,s),s}static Hermite1stDerivativeToRef(e,n,r,i,o,s){const a=o*o;s.x=(a-o)*6*e.x+(3*a-4*o+1)*n.x+(-a+o)*6*r.x+(3*a-2*o)*i.x,s.y=(a-o)*6*e.y+(3*a-4*o+1)*n.y+(-a+o)*6*r.y+(3*a-2*o)*i.y}static Lerp(e,n,r){const i=e.x+(n.x-e.x)*r,o=e.y+(n.y-e.y)*r;return new Nn(i,o)}static Dot(e,n){return e.x*n.x+e.y*n.y}static Normalize(e){const n=Nn.Zero();return this.NormalizeToRef(e,n),n}static NormalizeToRef(e,n){const r=e.length();r!==0&&(n.x=e.x/r,n.y=e.y/r)}static Minimize(e,n){const r=e.x<n.x?e.x:n.x,i=e.y<n.y?e.y:n.y;return new Nn(r,i)}static Maximize(e,n){const r=e.x>n.x?e.x:n.x,i=e.y>n.y?e.y:n.y;return new Nn(r,i)}static PointInTriangle(e,n,r,i){const o=.5*(-r.y*i.x+n.y*(-r.x+i.x)+n.x*(r.y-i.y)+r.x*i.y),s=o<0?-1:1,a=(n.y*i.x-n.x*i.y+(i.y-n.y)*e.x+(n.x-i.x)*e.y)*s,l=(n.x*r.y-n.y*r.x+(n.y-r.y)*e.x+(r.x-n.x)*e.y)*s;return a>0&&l>0&&a+l<2*o*s}static Distance(e,n){return Math.sqrt(Nn.DistanceSquared(e,n))}static DistanceSquared(e,n){const r=e.x-n.x,i=e.y-n.y;return r*r+i*i}static Center(e,n){return Nn.CenterToRef(e,n,Nn.Zero())}static CenterToRef(e,n,r){return r.copyFromFloats((e.x+n.x)/2,(e.y+n.y)/2)}static DistanceOfPointFromSegment(e,n,r){const i=Nn.DistanceSquared(n,r);if(i===0)return Nn.Distance(e,n);const o=r.subtract(n),s=Math.max(0,Math.min(1,Nn.Dot(e.subtract(n),o)/i)),a=n.add(o.multiplyByFloats(s,s));return Nn.Distance(e,a)}static create(e,n){return new Nn(e,n)}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=this.x|0;return e=e*397^(this.y|0),e}toArray(e,n=0){return e[n]=this.x,e[n+1]=this.y,this}fromArray(e,n=0){return Nn.FromArrayToRef(e,n,this),this}asArray(){const e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,n){return this.x=e,this.y=n,this}set(e,n){return this.copyFromFloats(e,n)}add(e){return new Nn(this.x+e.x,this.y+e.y)}addToRef(e,n){return n.x=this.x+e.x,n.y=this.y+e.y,this}addByPoint(e,n){return new Nn(this.x+e,this.y+n)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new Nn(this.x-e.x,this.y-e.y)}subtractByPoint(e,n){return new Nn(this.x-e,this.y-n)}subtractToRef(e,n){return n.x=this.x-e.x,n.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new Nn(this.x*e.x,this.y*e.y)}multiplyToRef(e,n){return n.x=this.x*e.x,n.y=this.y*e.y,this}multiplyByFloats(e,n){return new Nn(this.x*e,this.y*n)}divide(e){return new Nn(this.x/e.x,this.y/e.y)}divideToRef(e,n){return n.x=this.x/e.x,n.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new Nn(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(this.x*-1,this.y*-1)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){const n=new Nn(0,0);return this.scaleToRef(e,n),n}scaleToRef(e,n){return n.x=this.x*e,n.y=this.y*e,this}scaleAndAddToRef(e,n){return n.x+=this.x*e,n.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new Nn(Math.floor(this.x),Math.floor(this.y))}fract(){return new Nn(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const n=Math.cos(e),r=Math.sin(e),i=n*this.x-r*this.y,o=r*this.x+n*this.y;return this.x=i,this.y=o,this}rotateToRef(e,n){const r=Math.cos(e),i=Math.sin(e);return n.x=r*this.x-i*this.y,n.y=i*this.x+r*this.y,this}rotateByPoint(e,n=Nn.create(0,0)){const r=Math.cos(e),i=Math.sin(e),o=n.x+(this.x-n.x)*r-(this.y-n.y)*i,s=n.y+(this.x-n.x)*i+(this.y-n.y)*r;return this.x=o,this.y=s,this}transformCoordinateOnRotate(e){const n=Math.sqrt(this.x**2+this.y**2),r=Math.atan2(this.y,this.x),i=-e+r;return this.x=n*Math.cos(i),this.y=n*Math.sin(i),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return Nn.NormalizeToRef(this,this),this}clone(){return new Nn(this.x,this.y)}};const Lm=[1,0,0,1,0,0];let Ea=class pu{constructor(e=Lm){M(this,"dirty",!1),M(this,"_m"),this._m=e&&e.slice()||Lm}static create(e=Lm){return new this(e)}reset(){this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=1,this._m[4]=0,this._m[5]=0}copy(){return new pu(this._m)}copyInto(e){e._m[0]=this._m[0],e._m[1]=this._m[1],e._m[2]=this._m[2],e._m[3]=this._m[3],e._m[4]=this._m[4],e._m[5]=this._m[5]}applyPoint(e,n=!1){const r=this._m,i=r[0]*e.x+r[2]*e.y,o=r[1]*e.x+r[3]*e.y;return n?new Ft(i,o):new Ft(i+r[4],o+r[5])}translate(e,n){return this._m[4]+=this._m[0]*e+this._m[2]*n,this._m[5]+=this._m[1]*e+this._m[3]*n,this}scale(e,n){return this._m[0]*=e,this._m[1]*=e,this._m[2]*=n,this._m[3]*=n,this}rotate(e){const n=Cl(e),r=Math.cos(n),i=Math.sin(n),o=this._m[0]*r+this._m[2]*i,s=this._m[1]*r+this._m[3]*i,a=this._m[0]*-i+this._m[2]*r,l=this._m[1]*-i+this._m[3]*r;return this._m[0]=o,this._m[1]=s,this._m[2]=a,this._m[3]=l,this}getTranslation(){return{x:this._m[4],y:this._m[5]}}skew(e,n){const r=this._m[0]+this._m[2]*n,i=this._m[1]+this._m[3]*n,o=this._m[2]+this._m[0]*e,s=this._m[3]+this._m[1]*e;return this._m[0]=r,this._m[1]=i,this._m[2]=o,this._m[3]=s,this}multiply(e){const n=this._m[0]*e._m[0]+this._m[2]*e._m[1],r=this._m[1]*e._m[0]+this._m[3]*e._m[1],i=this._m[0]*e._m[2]+this._m[2]*e._m[3],o=this._m[1]*e._m[2]+this._m[3]*e._m[3],s=this._m[0]*e._m[4]+this._m[2]*e._m[5]+this._m[4],a=this._m[1]*e._m[4]+this._m[3]*e._m[5]+this._m[5];return this._m[0]=n,this._m[1]=r,this._m[2]=i,this._m[3]=o,this._m[4]=s,this._m[5]=a,this}invert(){const e=1/(this._m[0]*this._m[3]-this._m[1]*this._m[2]),n=this._m[3]*e,r=-this._m[1]*e,i=-this._m[2]*e,o=this._m[0]*e,s=e*(this._m[2]*this._m[5]-this._m[3]*this._m[4]),a=e*(this._m[1]*this._m[4]-this._m[0]*this._m[5]);return this._m[0]=n,this._m[1]=r,this._m[2]=i,this._m[3]=o,this._m[4]=s,this._m[5]=a,this}getMatrix(){return this._m}getMatrixByAccurate(e=3){return this._m.map(n=>yv(n,e))}setAbsolutePosition(e){const n=this._m[0],r=this._m[1],i=this._m[2],o=this._m[3],s=this._m[4],a=this._m[5],l=(n*(e.y-a)-r*(e.x-s))/(n*o-r*i),u=(e.x-s-i*l)/n;return this.translate(u,l)}decompose(){const e=this._m[0],n=this._m[1],r=this._m[2],i=this._m[3],o=this._m[4],s=this._m[5],a=e*i-n*r,l={x:o,y:s,angle:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!==0||n!==0){const u=Math.sqrt(e*e+n*n);l.angle=n>0?Math.acos(e/u):-Math.acos(e/u),l.scaleX=u,l.scaleY=a/u,l.skewX=(e*r+n*i)/a,l.skewY=0}else if(r!==0||i!==0){const u=Math.sqrt(r*r+i*i);l.angle=Math.PI/2-(i>0?Math.acos(-r/u):-Math.acos(r/u)),l.scaleX=a/u,l.scaleY=u,l.skewX=0,l.skewY=(e*r+n*i)/a}return l.angle=afe(l.angle),l}makeBoundingBoxFromPoints(e){if(this)for(let l=0;l<e.length;l++)e[l]=this.applyPoint(e[l]);const n=[e[0].x,e[1].x,e[2].x,e[3].x],r=Math.min(...n),i=Math.max(...n)-r,o=[e[0].y,e[1].y,e[2].y,e[3].y],s=Math.min(...o),a=Math.max(...o)-s;return{left:r,top:s,width:i,height:a,points:e}}composeMatrix(e){const n=new pu([1,0,0,1,e.left||0,e.top||0]);return e.angle&&n.rotate(e.angle),(e.scaleX!==1||e.scaleY!==1||e.skewX||e.skewY||e.flipX||e.flipY)&&n.multiply(this._calcDimensionsMatrix(e)),this._m=n.getMatrix(),this}clone(){return new pu([...this._m])}_calcDimensionsMatrix(e){const n=e.scaleX??1,r=e.scaleY??1,i=new pu([e.flipX?-n:n,0,0,e.flipY?-r:r,0,0]);return e.skewX&&i.multiply(new pu([1,0,Math.tan(Cl(e.skewX)),1,0,0])),e.skewY&&i.multiply(new pu([1,Math.tan(Cl(e.skewY)),0,1,0,0])),i}};const Ev=["top","left","width","height","angle","scaleX","scaleY","skewX","skewY","flipX","flipY","strokeWidth"];class X2{constructor(e){M(this,"groupKey"),M(this,"isInGroup",!1),M(this,"onTransformChangeObservable",new Sn),M(this,"onPointerDownObserver",new Sn),M(this,"onPointerMoveObserver",new Sn),M(this,"onPointerUpObserver",new Sn),M(this,"onDblclickObserver",new Sn),M(this,"onTripleClickObserver",new Sn),M(this,"onMouseWheelObserver",new Sn),M(this,"onPointerOutObserver",new Sn),M(this,"onPointerLeaveObserver",new Sn),M(this,"onPointerOverObserver",new Sn),M(this,"onPointerEnterObserver",new Sn),M(this,"onIsAddedToParentObserver",new Sn),M(this,"onDisposeObserver",new Sn),M(this,"_oKey"),M(this,"_dirty",!0),M(this,"_top",0),M(this,"_topOrigin",0),M(this,"_left",0),M(this,"_leftOrigin",0),M(this,"_width",0),M(this,"_widthOrigin",0),M(this,"_height",0),M(this,"_heightOrigin",0),M(this,"_angle",0),M(this,"_scaleX",1),M(this,"_scaleY",1),M(this,"_skewX",0),M(this,"_skewY",0),M(this,"_flipX",!1),M(this,"_flipY",!1),M(this,"_strokeWidth",0),M(this,"_parent"),M(this,"_zIndex",0),M(this,"_evented",!0),M(this,"_visible",!0),M(this,"_debounceParentDirty",!0),M(this,"_transform",new Ea),M(this,"_cursor",Yt.DEFAULT),M(this,"_isTransformer",!1),M(this,"_forceRender",!1),M(this,"_layer"),e?this._oKey=e:this._oKey=cfe()}get transform(){return this._transform}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get widthOrigin(){return this._widthOrigin}get heightOrigin(){return this._heightOrigin}get classType(){return Bt.BASE_OBJECT}get top(){return this._top}get left(){return this._left}get width(){return this._width}get height(){return this._height}get strokeWidth(){return this._strokeWidth}get angle(){return this._angle}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){var e;const n=((e=this.getParent())==null?void 0:e.ancestorScaleX)||1;return this.scaleX*n}get ancestorScaleY(){var e;const n=((e=this.getParent())==null?void 0:e.ancestorScaleY)||1;return this.scaleY*n}get skewX(){return this._skewX}get skewY(){return this._skewY}get flipX(){return this._flipX}get flipY(){return this._flipY}get parent(){return this._parent}get oKey(){return this._oKey}get zIndex(){return this._zIndex}get evented(){return this._evented}get visible(){return this._visible}get debounceParentDirty(){return this._debounceParentDirty}get isTransformer(){return this._isTransformer}get cursor(){return this._cursor}get layer(){return this._layer}set transform(e){this._transform=e}set zIndex(e){this._zIndex=e}set parent(e){this._parent=e}set evented(e){this._evented=e}set debounceParentDirty(e){this._debounceParentDirty=e}set isTransformer(e){this._isTransformer=e}set cursor(e){this.setCursor(e)}set layer(e){this._layer=e}set top(e){var n;this._topOrigin=e,this._top=rl(e,(n=this._parent)==null?void 0:n.height)}set left(e){var n;this._leftOrigin=e,this._left=rl(e,(n=this._parent)==null?void 0:n.width)}set width(e){var n;this._widthOrigin=e,this._width=rl(e,(n=this._parent)==null?void 0:n.width)}set height(e){var n;this._heightOrigin=e,this._height=rl(e,(n=this._parent)==null?void 0:n.height)}set strokeWidth(e){this._strokeWidth=e}set angle(e){this._angle=e}set scaleX(e){this._scaleX=e}set scaleY(e){this._scaleY=e}set skewX(e){this._skewX=e}set flipY(e){this._flipY=e}set flipX(e){this._flipX=e}set skewY(e){this._skewY=e}makeDirty(e=!0){if(this._dirty=e,e){if(this._layer==null){this._dirty=!1;return}typeof this._layer.debounceParentTimeout=="function"&&this._layer.debounceParentTimeout(),this._layer.debounceParentTimeout=rM(()=>{var n;(n=this._layer)==null||n.makeDirty(e)})}return this}makeDirtyNoDebounce(e=!0){var n;return this._dirty=e,e&&((n=this._layer)==null||n.makeDirty(e)),this}isDirty(){return this._dirty}translate(e,n){const r=this.top;n!==void 0&&(this.top=n);const i=this.left;return e!==void 0&&(this.left=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:lo.translate,value:{top:this._top,left:this._left},preValue:{top:r,left:i}}),this}resize(e,n){const r=this.width;e!==void 0&&(this.width=e);const i=this.height;return n!==void 0&&(this.height=n),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:lo.resize,value:{width:this._width,height:this._height},preValue:{width:r,height:i}}),this}scale(e,n){const r=this.scaleX;e!==void 0&&(this.scaleX=e);const i=this.scaleY;return n!==void 0&&(this.scaleY=n),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:lo.scale,value:{scaleX:this._scaleX,scaleY:this._scaleY},preValue:{scaleX:r,scaleY:i}}),this}skew(e,n){const r=e;e!==void 0&&(this.skewX=e);const i=n;return n!==void 0&&(this.skewY=n),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:lo.skew,value:{skewX:this._skewX,skewY:this._skewY},preValue:{skewX:r,skewY:i}}),this}flip(e,n){const r=e;e!==void 0&&(this.flipX=e);const i=n;return n!==void 0&&(this.flipY=n),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:lo.flip,value:{flipX:this._flipX,flipY:this._flipY},preValue:{flipX:r,flipY:i}}),this}transformByState(e){const n=Object.keys(e),r={};if(n.length!==0)return n.forEach(i=>{e[i]!==void 0&&(r[i]=this[i],this[i]=e[i])}),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:lo.all,value:e,preValue:r}),this}isRender(e){return this._forceRender?!1:e&&!this.isInGroup}getParent(){return this._parent}getState(){return{left:this.left,top:this.top,width:this.width,height:this.height,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}hide(){this._visible=!1,this._makeDirtyMix()}show(){this._visible=!0,this._makeDirtyMix()}render(e,n){}isHit(e){const n=this._getInverseCoord(e);return n.x>=-this.strokeWidth/2&&n.x<=this.width+this.strokeWidth/2&&n.y>=-this.strokeWidth/2&&n.y<=this.height+this.strokeWidth/2}on(e,n){return this[`on${e}Observer`].add(n.bind(this))}off(e,n){this[`on${e}Observer`].remove(n)}clear(e){this[`on${e}Observer`].clear()}triggerPointerMove(e){var n,r;return(n=this.onPointerMoveObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerPointerMove(e),!1)}triggerPointerDown(e){var n,r;return(n=this.onPointerDownObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerPointerDown(e),!1)}triggerPointerUp(e){var n,r;return(n=this.onPointerUpObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerPointerUp(e),!1)}triggerDblclick(e){var n,r;return(n=this.onDblclickObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerDblclick(e),!1)}triggerTripleClick(e){var n,r;return(n=this.onTripleClickObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerTripleClick(e),!1)}triggerMouseWheel(e){var n,r;return(n=this.onMouseWheelObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerMouseWheel(e),!1)}triggerPointerOut(e){var n,r;return(n=this.onPointerOutObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerPointerOut(e),!1)}triggerPointerLeave(e){var n,r;return(n=this.onPointerLeaveObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerPointerLeave(e),!1)}triggerPointerOver(e){var n;return this.onPointerOverObserver.notifyObservers(e)?!0:((n=this._parent)==null||n.triggerPointerOver(e),!1)}triggerPointerEnter(e){var n,r;return(n=this.onPointerEnterObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerPointerEnter(e),!1)}dispose(){var e;this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onMouseWheelObserver.clear(),this.onPointerOutObserver.clear(),this.onPointerLeaveObserver.clear(),this.onPointerOverObserver.clear(),this.onPointerEnterObserver.clear(),this.onDblclickObserver.clear(),this.onTripleClickObserver.clear(),this.onIsAddedToParentObserver.clear(),(e=this.parent)==null||e.removeObject(this),this.onDisposeObserver.notifyObservers(this)}toJson(){const e={};return Ev.forEach(n=>{this[n]&&(e[n]=this[n])}),e}getScene(){let e=this.parent;if(e!=null){if(e.classType===Bt.SCENE)return e;for(;e;){if(e.classType===Bt.SCENE)return e;e=e.getParent()}}}resetCursor(){var e;(e=this.getScene())==null||e.resetCursor()}setCursor(e){var n;this._cursor=e,(n=this.getScene())==null||n.setCursor(e)}getEngine(){let e=this.getParent();for(;e!=null;){if(e===Bt.ENGINE)return e;e=e.getParent()}return null}getObjects(){return[]}_getInverseCoord(e){return this._transform.clone().invert().applyPoint(e)}_setTransForm(){const e=Ea.create().composeMatrix({left:this.left+this.strokeWidth/2,top:this.top+this.strokeWidth/2,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY});this.transform=e,this._makeDirtyMix()}_makeDirtyMix(){this.debounceParentDirty?this.makeDirty(!0):this.makeDirtyNoDebounce(!0)}}var A6=(t=>(t[t.SECTION=0]="SECTION",t[t.PAGE=1]="PAGE",t[t.COLUMN=2]="COLUMN",t))(A6||{}),N9=(t=>(t[t.PARAGRAPH=0]="PARAGRAPH",t[t.BLOCK=1]="BLOCK",t))(N9||{}),bo=(t=>(t[t.LETTER=0]="LETTER",t[t.WORD=1]="WORD",t[t.LIST=2]="LIST",t[t.PLACEHOLDER=3]="PLACEHOLDER",t[t.TAB=4]="TAB",t[t.IMAGE=5]="IMAGE",t[t.AT=6]="AT",t[t.MATH=7]="MATH",t[t.MULTI_LINE=8]="MULTI_LINE",t[t.CUSTOM=9]="CUSTOM",t))(bo||{}),Vs=(t=>(t[t.VERTICAL=0]="VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL",t[t.AUTO=2]="AUTO",t))(Vs||{});function Sfe(t){var e;const n=t==null?void 0:t.parent;return n==null?!1:((e=n.spanGroup[0])==null?void 0:e.spanType)===bo.LIST}function Efe(t,e){const n=Xk(t,e);if(n==null)return!1;const{paragraphStyle:r}=n;return r==null?!1:VV(r)}function wfe(t){const e=t==null?void 0:t.parent,n=e==null?void 0:e.parent,r=e==null?void 0:e.spanGroup,i=n==null?void 0:n.divides;if(r&&t&&i&&e){const o=r.indexOf(t),s=i.indexOf(e);if(s===0&&o===0||s===0&&o===1&&r[0].spanType===bo.LIST)return!0}return!1}function Xk(t,e){var n;const r=(n=t==null?void 0:t.parent)==null?void 0:n.parent;if(r==null||e==null)return;const i=e.paragraphs;if(i!=null){for(const o of i)if(o.startIndex===r.paragraphIndex)return o}}function Rfe(){let t=1;const e=Fk().getContext("2d");return t=(()=>{const n=window.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return n/r})(),t<1?1:t}function Yk(t,e,n){let r=0,i=0,o=0,s=0;const{startX:a,startY:l,endX:u,endY:c}=n;e===jn.TOP?(r=a,i=l,o=u,s=l):e===jn.BOTTOM?(r=a,i=c,o=u,s=c):e===jn.LEFT?(r=a,i=l,o=a,s=c):e===jn.RIGHT&&(r=u,i=l,o=u,s=c),t.beginPath(),t.moveTo(r,i),t.lineTo(o,s),t.stroke()}function Dfe(t,e,n){let r=0,i=0,o=0,s=0;const{startX:a,startY:l,endX:u,endY:c}=n;e===jn.TL_BR?(r=a,i=l,o=u,s=c):e===jn.TL_BC?(r=a,i=l,o=(a+u)/2,s=c):e===jn.TL_MR?(r=a,i=l,o=u,s=(l+c)/2):e===jn.BL_TR?(r=a,i=c,o=u,s=l):e===jn.ML_TR?(r=a,i=(l+c)/2,o=u,s=l):e===jn.BC_TR&&(r=(a+u)/2,i=c,o=u,s=l),t.beginPath(),t.moveTo(r,i),t.lineTo(o,s),t.stroke()}function Ife(t,e,n,r,i){let o=0,s=0,a=0,l=0;const{startX:u,startY:c,endX:d,endY:h}=n;e===jn.TOP?(o=u,s=c,a=d,l=c):e===jn.BOTTOM?(o=u,s=h,a=d,l=h):e===jn.LEFT?(o=u,s=c,a=u,l=h):e===jn.RIGHT&&(o=d,s=c,a=d,l=h),t.beginPath(),t.clearRect(o-1/r,s-1/i,a-o+2/r,l-s+2/i)}function Gk(t,e){e===wt.HAIR?t.setLineDash([1,2]):e===wt.DASH_DOT_DOT||e===wt.MEDIUM_DASH_DOT_DOT?t.setLineDash([2,2,5,2,2]):e===wt.DASH_DOT||e===wt.MEDIUM_DASH_DOT||e===wt.SLANT_DASH_DOT?t.setLineDash([2,5,2]):e===wt.DOTTED?t.setLineDash([2]):e===wt.DASHED||e===wt.MEDIUM_DASHED?t.setLineDash([3]):t.setLineDash([0])}function Kk(t){let e=1;return t===wt.MEDIUM||t===wt.MEDIUM_DASH_DOT||t===wt.MEDIUM_DASHED||t===wt.MEDIUM_DASH_DOT_DOT?e=2:t===wt.THICK&&(e=3),e}function Jh(t,e,n,r,i=Ft.create(0,0)){const o=t.add(e).rotateByPoint(r),s=o.subtract(e),a=r-n;return s.rotateByPoint(a,o).add(i).transformCoordinateOnRotate(a)}function xfe(t){return t>0?Zh.DOWN:Zh.UP}function Zk(t,e,n){var r;const i=[];let o=0,s=0,a=0,l=0,u=0;const c=xfe(n),d=t.length;n=Math.abs(n);const h=Math.tan(n),f=Math.sin(n),m=Math.cos(n);if(c===Zh.UP){let p=0;for(let g=0;g<d;g++){const v=t[g],{lineHeight:_=0}=v;p+=g===0?0:_;const C=e*f+_*m;i.push(p/h),C>s&&(s=C),g===0&&(a+=_*f,u+=_*m)}a+=p/f+e*m,u-=s}else{let p=0,g=-1;const v=[];for(let y=d-1;y>=0;y--){const S=t[y],{lineHeight:E=0}=S,w=E/h,R=(e+w)*f;v.unshift(E/h),R>s&&(s=R,p=w,g=y),y===0?a+=E*f:y===d-1?a+=e*m+E/f:a+=E/f}let _=((r=t[g])==null?void 0:r.lineHeight)||0,C=0;for(let y=g+1;y<=d-1;y++){const S=t[y],{lineHeight:E=0}=S;_+=E,C+=v[y]||0,i[y]=-C}C=0;for(let y=g-1;y>=0;y--){const S=t[y],{lineHeight:E=0}=S;C+=v[y+1]||0,i[y]=C,o+=E}i[g]=0,d===1&&(a+=e*m),l=_/f-p*m}return{rotateTranslateXList:i,rotatedHeight:s,rotatedWidth:a,fixOffsetX:l,fixOffsetY:u,rotateTranslateY:o}}var Zn=(t=>(t[t.PointerMove=0]="PointerMove",t[t.PointerDown=1]="PointerDown",t[t.PointerUp=2]="PointerUp",t[t.Dblclick=3]="Dblclick",t[t.Keyboard=4]="Keyboard",t))(Zn||{});let Pm=class{};M(Pm,"DOM_DELTA_PIXEL",0),M(Pm,"DOM_DELTA_LINE",1),M(Pm,"DOM_DELTA_PAGE",2);var Qo=(t=>(t[t.Generic=0]="Generic",t[t.Keyboard=1]="Keyboard",t[t.Mouse=2]="Mouse",t[t.Touch=3]="Touch",t))(Qo||{}),xt=(t=>(t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical",t[t.LeftClick=2]="LeftClick",t[t.MiddleClick=3]="MiddleClick",t[t.RightClick=4]="RightClick",t[t.BrowserBack=5]="BrowserBack",t[t.BrowserForward=6]="BrowserForward",t[t.MouseWheelX=7]="MouseWheelX",t[t.MouseWheelY=8]="MouseWheelY",t[t.MouseWheelZ=9]="MouseWheelZ",t[t.DeltaHorizontal=10]="DeltaHorizontal",t[t.DeltaVertical=11]="DeltaVertical",t[t.FakeMove=12]="FakeMove",t))(xt||{});const Mfe=[new Ft(0,0),new Ft(1,1)];let Ofe=class{constructor(e=Mfe){this._lines=e}intersection(e){if(this._lines.length<1||e.length<1)return;const n=[];for(let r=1;r<this._lines.length;r++){const i=this._lines[r-1],o=this._lines[r];for(let s=1;s<e.length;s++){const a=this._lines[r-1],l=this._lines[r],u=this._intersection({from:i,to:o},{from:a,to:l});u&&n.push(u)}}return n}_intersection(e,n){const r=e.from,i=e.to,o=n.from,s=n.to,a=(r.x-o.x)*(i.y-o.y)-(r.y-o.y)*(i.x-o.x),l=(r.x-s.x)*(i.y-s.y)-(r.y-s.y)*(i.x-s.x);if(a*l>=0)return!1;const u=(o.x-r.x)*(s.y-r.y)-(o.y-r.y)*(s.x-r.x),c=u+a-l;if(u*c>=0)return!1;const d=u/(l-a),h=d*(i.x-r.x),f=d*(i.y-r.y);return new Ft(r.x+h,r.y+f)}},Tfe=class{constructor(e=30){M(this,"_enabled",!0),M(this,"_rollingFrameTime"),M(this,"_lastFrameTimeMs"),this._rollingFrameTime=new $fe(e)}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){const e=this._rollingFrameTime.history(0);return e===0?0:1e3/e}get isSaturated(){return this._rollingFrameTime.isSaturated()}get isEnabled(){return this._enabled}sampleFrame(e=this.Now()){if(this._enabled){if(this._lastFrameTimeMs!=null){const n=e-this._lastFrameTimeMs;this._rollingFrameTime.add(n)}this._lastFrameTimeMs=e}}Now(){return performance&&performance.now?performance.now():Date.now()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}},$fe=class{constructor(e){M(this,"average",0),M(this,"variance",0),M(this,"_samples",[]),M(this,"_sampleCount",0),M(this,"_pos",0),M(this,"_m2",0),this._samples=new Array(e),this.reset()}add(e){let n;if(this.isSaturated()){const r=this._samples[this._pos];n=r-this.average,this.average-=n/(this._sampleCount-1),this._m2-=n*(r-this.average)}else this._sampleCount++;n=e-this.average,this.average+=n/this._sampleCount,this._m2+=n*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length}history(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;const n=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(n-e)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(e){const n=this._samples.length;return(e%n+n)%n}};const N6={strokeWidth:1,stroke:"rgba(0,0,0, 0)",strokeActive:"rgba(0,0,0, 1)",fill:"rgba(0, 0, 0, 0.2)"};var O2=(t=>(t.NONE="none",t.BACKWARD="backward",t.FORWARD="forward",t))(O2||{});function xd(t){const e=t.getScene(),n=t.getViewportByCoord(e),r=0,i=0;if(!n)return{scrollX:r,scrollY:i};const o=n.getActualScroll(n.scrollX,n.scrollY);return{scrollX:o.x,scrollY:o.y}}let BC=class{constructor(e){M(this,"isCache",!1),M(this,"_pixelRatio",1),M(this,"_canvasEle"),M(this,"_context"),M(this,"_width",0),M(this,"_height",0),e=e||{},this._canvasEle=Fk(),this._canvasEle.style.padding="0",this._canvasEle.style.margin="0",this._canvasEle.style.border="0",this._canvasEle.style.background="transparent",this._canvasEle.style.position="absolute",this._canvasEle.style.top="0",this._canvasEle.style.left="0",this._canvasEle.tabIndex=1,this._canvasEle.style.touchAction="none",this._canvasEle.style.outline="0",this._context=this._canvasEle.getContext("2d"),this.setSize(e.width,e.height,e.pixelRatio)}getCanvasEle(){return this._canvasEle}getContext(){return this._context}getPixelRatio(){return this._pixelRatio}getWidth(){return this._width}getHeight(){return this._height}setSize(e,n,r){this._pixelRatio=r||Rfe(),e&&(this._width=e,this._canvasEle.width=e*this._pixelRatio,this._canvasEle.style.width=`${e}px`),n&&(this._height=n,this._canvasEle.height=n*this._pixelRatio,this._canvasEle.style.height=`${n}px`),this.getContext().setTransform(this._pixelRatio,0,0,this._pixelRatio,0,0)}setPixelRatio(e){this._width===0||this._height===0||(e<1&&(e=1),this.setSize(this._width,this._height,e))}dispose(){this.clear(),this._canvasEle.remove()}clear(){this.getContext().clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}toDataURL(e,n){try{return this._canvasEle.toDataURL(e,n)}catch{try{return this._canvasEle.toDataURL()}catch(r){const{message:i}=r;return console.error(`Unable to get data URL. ${i} For more info read https://universheet.net/docs/Canvas.html.`),""}}}};class qk extends X2{constructor(){super(...arguments),M(this,"_extensions",new Map)}get extensions(){return this._extensions}register(...e){for(const n of e)n.parent=this,this._extensions.set(n.uKey,n)}unRegister(...e){for(const n of e)this._extensions.delete(n)}getExtensionsByOrder(){const e=Array.from(this._extensions.values());return e.sort(Ns),e}getExtensionByKey(e){return this._extensions.get(e)}draw(e,n){}}function kfe(){return[]}function Afe(t,e,n){return Nfe(t,e,n)}function Nfe(t,e,n){return n===ha.DECIMAL?aR(t,e):n===ha.ZERO_DECIMAL?Lfe(t,e):n===ha.UPPER_ALPHA?Pfe(t,e):n===ha.ALPHA?Bfe(t,e):n===ha.UPPER_ROMAN?Ffe(t,e):n===ha.ROMAN?Ufe(t,e):aR(t,e)}function aR(t,e){return(t+e).toString()}function Lfe(t,e){const n=t+e;return n<10?`0${n}`:n.toString()}function Pfe(t,e){return Fx(t+e-1,!0)}function Bfe(t,e){return Fx(t+e-1,!1)}function Ffe(t,e){return Qk(t+e,!0)}function Ufe(t,e){return Qk(t+e,!1)}function Qk(t,e=!1){const n={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};let r={m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};e&&(r=n);let i="";for(const o in r)for(;t>=r[o];)i+=o,t-=r[o];return i}function Hfe(t,e,n,r){var i,o;if(!t||!e)return;const{listId:s,listType:a,nestingLevel:l=0,textStyle:u}=t,c=e[a];return!c||!c.nestingLevel?lR(s,(i=n==null?void 0:n[l])==null?void 0:i.startIndexItem):c.nestingLevel[l]?Vfe(s,l,c.nestingLevel,n,u):lR(s,(o=n==null?void 0:n[l])==null?void 0:o.startIndexItem)}function lR(t,e=1){return{listId:t,symbol:"",ts:{ff:"Arial",fs:9},startIndexItem:e,bBox:{width:8.4560546875,ba:7,bd:-1,aba:7,abd:-1,sp:-2,sbr:.5,sbo:0,spr:.5,spo:0},indentFirstLine:0,hanging:21,indentStart:0}}function Vfe(t,e,n,r,i,o){var s;const a=n[e],{bulletAlignment:l,glyphFormat:u,textStyle:c,startNumber:d,glyphType:h,glyphSymbol:f,indentFirstLine:m,hanging:p,indentStart:g}=a,v={...i,...c},_=Qh(v);let C;f?C=f:C=jfe(u,e,n,r);const y=nl.getTextSize(C,_),S=((s=r==null?void 0:r[e])==null?void 0:s.startIndexItem)??1;return{listId:t,symbol:C,ts:v,fontStyle:_,startIndexItem:S+1,bBox:y,nestingLevel:a,bulletAlign:l,bulletType:f?!1:!!h,indentFirstLine:m,hanging:p,indentStart:g}}function jfe(t,e,n,r){var i;const o=t.split("%"),s=[o[0]];for(let a=1;a<o.length;a++){const l=o[a],{level:u,suffix:c}=Wfe(l);let d=((i=r==null?void 0:r[u])==null?void 0:i.startIndexItem)||1;u!==e&&(r==null?void 0:r[u])!==null&&(d-=1);const h=zfe(d,n[u]);s.push(h,c)}return s.join("")}function zfe(t=1,e){const{startNumber:n,glyphType:r,glyphSymbol:i}=e;return i||(r?Afe(t,n,r):"")}function Wfe(t){if(t==="")return{level:0,suffix:""};const e=t.split("");let n="",r="",i=!1;const o=/[0-9]/g;return e.forEach(s=>{!i&&o.test(`${n}${s}`)?n+=s:(i=!0,r+=s)}),{level:parseInt(n)-1,suffix:r}}function Xfe(t,e,n,r,i){return[]}function Y2(t){return t[t.length-1]}function FC(t){var e;return(e=t.sections)==null?void 0:e[t.sections.length-1]}function Yfe(t){var e;const n=(e=e5(t))==null?void 0:e.column.lines;return n==null?void 0:n[n.length-1]}function Gfe(t){return t.lines[t.lines.length-1]}function e5(t){const e=FC(t);for(let n=0;n<e.columns.length;n++){const r=e.columns[n];if(!r.isFull)return{column:r,isLast:n===e.columns.length-1,index:n}}}function Kfe(t){const e=Yfe(t);if(e)for(let n=0;n<e.divides.length;n++){const r=e.divides[n];if(!r.isFull)return{divide:r,isLast:n===e.divides.length-1,index:n}}}function Zfe(t){const e=FC(t),n=e.columns.length;for(let r=0;r<n;r++)if(!e.columns[r].isFull)return!1;return!0}function il(t,e){if(t instanceof Object){const{v:n,u:r}=t;return r===Kx.POINT?n:n*e}return t}function UC(t=0,e,n=fo.LINES,r=ke.TRUE){let i=1;return Jk(n,r)&&(i=t),i*=e,i}function Jk(t=fo.LINES,e=ke.FALSE){return e===ke.TRUE&&(t===fo.LINES_AND_CHARS||t===fo.SNAP_TO_CHARS)}function eA(t,e){const{paragraphStyle:n={}}=e,{linePitch:r=15.6,gridType:i=fo.LINES,paragraphLineGapDefault:o=0}=t,{lineSpacing:s=1,spacingRule:a=uh.AUTO,snapToGrid:l=ke.TRUE}=n;return{paragraphLineGapDefault:o,linePitch:r,gridType:i,lineSpacing:s,spacingRule:a,snapToGrid:l}}function qfe(t,e){const{paragraphStyle:n={}}=e,{charSpace:r=0,gridType:i=fo.LINES,defaultTabStop:o=36,documentTextStyle:s={}}=t,{fs:a=bae}=s,{snapToGrid:l=ke.TRUE}=n;return{charSpace:r,documentFontSize:a,defaultTabStop:o,gridType:i,snapToGrid:l}}function wv(t,e=-1){let n=e;for(const r of t){const{sections:i}=r,o=n;let s=o,a=-1/0,l=0;for(const u of i){const{columns:c}=u,d=s;let h=d,f=-1/0,m=0;for(const p of c){const{lines:g}=p,v=h;let _=v,C=0,y=-1/0,S=null;for(const E of g){const{divides:w,lineHeight:R}=E,D=_;let I=D,k=0,O=0;C+=R;const $=w.length;for(let N=0;N<$;N++){const H=w[N],{spanGroup:X}=H,te=I;let z=te;for(const A of X){const T=A.spanType===bo.LIST?0:A.count;z+=T;const P=A.bBox,{ba:K}=P;O=Math.max(O,K),N===$-1&&(k+=A.width)}N===$-1&&(k+=H.left),X.length!==0&&(H.st=te+1,H.ed=z>=H.st?z:H.st,I=H.ed)}E.st=D+1,E.ed=I>=E.st?I:E.st,E.width=k,E.asc=O,y=Math.max(y,k),E.top=((S==null?void 0:S.top)||0)+((S==null?void 0:S.lineHeight)||0),S=E,_=E.ed}p.st=v+1,p.ed=_>=p.st?_:p.st,p.height=C,p.width=y,m+=y,f=Math.max(f,p.height),h=p.ed}u.st=d+1,u.ed=h>=u.st?h:u.st,u.height=f,l+=f,a=Math.max(a,m),s=u.ed}r.st=o+1,r.ed=s>=r.st?s:r.st,r.height=l,r.width=a,n=r.ed}}function Qfe(t,e){for(const n of t){const{sections:r}=n;for(const i of r){const{columns:o}=i;for(const s of o){const{lines:a}=s;for(const l of a)e&&Hk(e)&&e(l)}}}}function Jfe(t,e){for(const n of t){const{sections:r}=n;for(const i of r){const{columns:o}=i;for(const s of o)e&&Hk(e)&&e(s)}}}function eme(t,e,n,r,i=!1){const{relativeFrom:o,align:s,posOffset:a,percent:l}=t;if(s!=null)if(s===X1.INSIDE||s===X1.OUTSIDE)o===Ir.MARGIN||Ir.PAGE;else{if(o===Ir.COLUMN){const{width:u,left:c}=e;let d=0;return s===X1.LEFT?d=c:s===X1.RIGHT?d=c+u-r:s===X1.CENTER&&(d=c+u/2-r/2),d}if(o!==Ir.LEFT_MARGIN&&o!==Ir.MARGIN&&o!==Ir.RIGHT_MARGIN&&o!==Ir.INSIDE_MARGIN&&o!==Ir.OUTSIDE_MARGIN&&o===Ir.PAGE){const{pageWidth:u}=n;let c=0;return s===X1.RIGHT?c=u-r:s===X1.CENTER&&(c=u/2-r/2),c}}else if(a){const{pageWidth:u,marginLeft:c,marginRight:d}=n,h=u-d;let f=0;return o===Ir.COLUMN?f=(i?0:(e==null?void 0:e.left)||0)+a:o===Ir.LEFT_MARGIN||(o===Ir.MARGIN?f=a+c:o===Ir.RIGHT_MARGIN||o===Ir.INSIDE_MARGIN||o===Ir.OUTSIDE_MARGIN||o===Ir.PAGE&&(f=a)),f+r>h&&(f=h-r),f}else if(l){const{pageWidth:u,marginLeft:c,marginRight:d}=n;if(o!==Ir.LEFT_MARGIN&&o!==Ir.MARGIN&&o!==Ir.RIGHT_MARGIN&&o!==Ir.INSIDE_MARGIN&&o!==Ir.OUTSIDE_MARGIN&&o===Ir.PAGE)return l*u}}function tme(t,e,n,r,i,o,s=!1){const{relativeFrom:a,align:l,posOffset:u,percent:c}=t;if(l!=null){if(a===Ar.LINE){let d=0;return l===Kc.BOTTOM?d=n+r-i:l===Kc.TOP?d=n:l===Kc.CENTER&&(d=n+r/2-i/2),d}if(a!==Ar.TOP_MARGIN&&a!==Ar.MARGIN&&a!==Ar.BOTTOM_MARGIN&&a!==Ar.INSIDE_MARGIN&&a!==Ar.OUTSIDE_MARGIN&&a===Ar.PAGE){const{pageHeight:d}=e;let h=0;return l===Kc.BOTTOM?h=d-i:l===Kc.CENTER&&(h=d/2-i/2),h}}else if(u){let d=0;return a===Ar.LINE?d=n||0+u:a===Ar.TOP_MARGIN||a===Ar.MARGIN||a===Ar.BOTTOM_MARGIN||a===Ar.INSIDE_MARGIN||a===Ar.OUTSIDE_MARGIN||(a===Ar.PAGE?d=u:a===Ar.PARAGRAPH&&(d=(s?0:o??n)+u)),d}else if(c){const{pageHeight:d,marginBottom:h,marginTop:f}=e;if(a!==Ar.TOP_MARGIN&&a!==Ar.MARGIN&&a!==Ar.BOTTOM_MARGIN&&a!==Ar.INSIDE_MARGIN&&a!==Ar.OUTSIDE_MARGIN&&a===Ar.PAGE)return c*d}}function nme(t){const e=t.spanGroup;let n=0;for(const r of e)n+=r.width;return n}const Rv=new nt;function rme(){Rv.reset()}function G2(t,e,n,r,i){const{startIndex:o}=n,s=e.getTextRun(t+o)||{ts:{},st:0,ed:0},{ts:a={},st:l,ed:u}=s,c=Rv.getValue(l,u);if(c)return c;const{gridType:d=fo.LINES,charSpace:h=0,documentTextStyle:f={},pageSize:m={width:1/0,height:1/0},marginRight:p=0,marginLeft:g=0,localeService:v}=r,{snapToGrid:_=ke.TRUE}=i,C=Qh(a),y={...f,...a},S=m.width||1/0-g-p,E={fontStyle:C,textStyle:y,charSpace:h,gridType:d,snapToGrid:_,pageWidth:S};return Rv.setValue(l,u,E),E}function ime(t,e,n){return HC(bo.WORD,t,e,n)}function L9(t,e,n){return HC(bo.LETTER,t,e,n)}function ome(t,e){return HC(bo.TAB,en.TAB,t,e)}function HC(t,e,n,r){const{fontStyle:i,textStyle:o,charSpace:s=1,gridType:a=fo.LINES,snapToGrid:l=ke.FALSE}=n,u=[en.SECTION_BREAK,en.TABLE_START,en.TABLE_END,en.TABLE_ROW_START,en.TABLE_ROW_END,en.TABLE_CELL_START,en.TABLE_CELL_END,en.CUSTOM_RANGE_START,en.CUSTOM_RANGE_END,en.COLUMN_BREAK,en.PAGE_BREAK,en.DOCS_END,en.CUSTOM_BLOCK];let c=en.LETTER;if(u.indexOf(e)>-1)return{content:"",ts:o,fontStyle:i,width:0,bBox:{width:0,ba:0,bd:0,aba:0,abd:0,sp:0,sbr:0,sbo:0,spr:0,spo:0},paddingLeft:0,left:0,spanType:bo.PLACEHOLDER,streamType:e,count:1};e===en.PARAGRAPH&&(c=en.PARAGRAPH);const d=nl.getTextSize(e,i),{width:h=0}=d;let f=r??h,m=0;return Jk(a,l)&&(f=h+(PC(e)?s:s/2),a===fo.SNAP_TO_CHARS&&(m=(f-h)/2)),{content:e,ts:o,fontStyle:i,width:f,bBox:d,paddingLeft:m,left:0,spanType:t,streamType:c,count:e.length}}function sme(t,e,n){const{bBox:r,symbol:i,ts:o,fontStyle:s,bulletAlign:a=fa.START,bulletType:l=!1}=e,u=r.width,c=Math.ceil(u/n);let d=(c<2?2:c)*n,h=0;l&&(a===fa.CENTER?(h=-u/2,d-=h):a===fa.END&&(h=-u,d-=h));const f=lme(t,e);return{content:i,ts:o,fontStyle:s,width:d,paddingLeft:0,bBox:f,left:h,spanType:bo.LIST,streamType:en.LETTER,count:0}}function ame(t,e=0){const n=t.length;let r;for(let i=0;i<n;i++){const o=t[i];o.left=r?r.left+r.width:e,r=o}}function Bm(t,e,n=0){ame(e,n);for(const r of e)r.parent=t;t.spanGroup.push(...e)}function lme(t,e){const{ba:n,bd:r}=t.bBox,{ba:i,bd:o}=e.bBox;return n+r>i+o?t.bBox:e.bBox}function ume(t,e){if(t==null)return!1;const{content:n}=t,{content:r}=e;if(n==null||r==null)return!1;const i=/[a-z\d]/i;return i.test(n)&&Sv(r)||Sv(n)&&i.test(r)}function cme(t,e,n,r,i,o){const s=[];let a=0;for(let l=0;l<e.length;l++){const u=e[l];if(mfe(u))break;const c=G2(t+l,n,r,i,o),d=L9(u,c);s.push(d),a++}return{step:a,spanGroup:s}}function dme(t,e,n,r,i,o){const s=G2(t,n,r,i,o),a=[];let l=0;for(let u=0;u<e.length;u++){const c=e[u];if(jk(c))a.unshift(c),l++;else break}return{step:l,spanGroup:[L9(a.join(""),s)]}}function hme(t,e,n,r,i,o){const s=G2(t,n,r,i,o),a=e.match(Vk);return{step:a[0].length,spanGroup:[L9(a[0],s)]}}function fme(t,e,n,r,i,o){const s=G2(t,n,r,i,o),a=[];let l=0;for(let u=0;u<e.length;u++){const c=e[u];if(zk(c))a.push(c),l++;else break}return{step:l,spanGroup:[ime(a.join(""),s)]}}function mme(t,e,n,r,i=0,o=!1,s,a,l){const{lineHeight:u=15.6,lineTop:c=0,contentHeight:d=0,paddingLeft:h=0,paddingRight:f=0,paddingTop:m=0,paddingBottom:p=0,marginTop:g=0,spaceBelowApply:v=0}=n,_=yme(e,t);_.lineIndex=i,_.paragraphStart=o,_.contentHeight=d,_.top=c,_.lineHeight=u,_.paddingTop=m,_.paddingBottom=p,_.marginTop=g,_.spaceBelowApply=v,_.divides=gme(u,c,r,h,f,s,a,l);for(const C of _.divides)C.parent=_;return _}function pme(t=15.6,e=0,n,r,i){let o=e;return r==null||r.forEach(s=>{const a=Fm(s,t,e);a&&(o=Math.max(o,a))}),i==null||i.forEach(s=>{const a=Fm(s,t,e);a&&(o=Math.max(o,a))}),n==null||n.forEach(s=>{const a=Fm(s,t,e);a&&(o=Math.max(o,a))}),o}function Fm(t,e,n){const{aTop:r,height:i,aLeft:o,width:s,angle:a=0,drawingOrigin:l}=t,{layoutType:u,distT:c=0,distB:d=0}=l;if(u!==va.WRAP_TOP_AND_BOTTOM)return;if(a===0){const m=r-c,p=i+d;return m+p<n||m>e+n?void 0:m+i}let{top:h=0,height:f=0}=tA(a,o,s,r,i);if(h-=c,f+=d,!(h+f<n||h>e+n))return h+f}function gme(t,e,n,r,i,o,s,a){const l=[];return l.push({left:0,width:r},{left:n-i,width:i}),s==null||s.forEach((u,c)=>{const d=Um(u,t,e,n);d&&l.push(d)}),a==null||a.forEach((u,c)=>{const d=Um(u,t,e,n);d&&l.push(d)}),o==null||o.forEach((u,c)=>{const d=Um(u,t,e,n);d&&l.push(d)}),Cme(n,l)}function vme(t,e){t.isFull=e}function Um(t,e,n,r){const{aTop:i,height:o,aLeft:s,width:a,angle:l=0,drawingOrigin:u}=t,{layoutType:c}=u;if(c===va.WRAP_NONE||c===va.WRAP_TOP_AND_BOTTOM)return;if(c===va.WRAP_POLYGON){const{start:h=[0,0],lineTo:f}=u;if(!f)return;const m=[];m.push(new Ft(h[0],h[1]));for(let p=0;p<f.length;p++){const g=f[p];m.push(new Ft(g[0],g[1]))}if(l!==0){const p=new Ea().rotate(l);for(let g=0;g<m.length;g++){const v=m[g];m[g]=p.applyPoint(v)}}return uR(m,n,e,r)}if(l===0)return cR(i,o,s,a,n,e,r,u);const d=tA(l,s,a,i,o);if(c===va.WRAP_SQUARE){const{left:h,width:f,top:m,height:p}=d;return cR(m,p,h,f,n,e,r,u)}return uR(d.points,n,e,r)}function tA(t,e,n,r,i){const o=new Ea().rotate(t),s=new Ft(e,r),a=new Ft(e,r+i),l=new Ft(e+n,r),u=new Ft(e+n,r+i);return o.makeBoundingBoxFromPoints([s,a,l,u])}function uR(t,e,n,r){const i=new Ofe(t),o=i.intersection([new Ft(0,e),new Ft(r,e)]),s=i.intersection([new Ft(0,e+n),new Ft(r,e+n)]);if(!o&&!s)return;const a=_me([...t,...o||[],...s||[]]);return{left:a.min,width:a.max}}function _me(t,e=0){const n=[];for(let r=0;r<t.length;r++){const i=t[r];e===0?n.push(i.x):n.push(i.y)}return{max:Math.max(...n),min:Math.min(...n)}}function cR(t,e,n,r,i,o,s,a){const{layoutType:l,wrapText:u=Pd.BOTH_SIDES,distL:c=0,distR:d=0,distT:h=0,distB:f=0}=a,m=t-(l===va.WRAP_SQUARE?h:0),p=e+(l===va.WRAP_SQUARE?f:0);if(m+p<i||m>o+i)return;let g=n-c,v=r+d;const _=bme(u,g,v,s);return _===1?v=s-g:_===2&&(g=0,v=n+r+d),{left:g,width:v}}function bme(t,e,n,r){let i=0;return t===Pd.LEFT?i=1:t===Pd.RIGHT?i=2:t===Pd.LARGEST&&(e>r-e-n?i=1:i=2),i}function Cme(t,e){e.sort((o,s)=>o.left>s.left?1:-1);const n=[];let r=0;const i=e.length;for(let o=0;o<i;o++){const s=e[o],{left:a,width:l}=s;if(a>r){let u=a-r;u=u<t?u:t-r;const c=dR(r,u);n.push(c)}if(r=Math.max(a+l,r),o===i-1&&a+l<t){const u=dR(a+l,t-a-l);n.push(u)}}return n}function dR(t,e){return{spanGroup:[],width:e,left:t,paddingLeft:0,isFull:!1,st:0,ed:0}}function yme(t,e){return{paragraphIndex:e,type:t,divides:[],lineHeight:0,contentHeight:0,top:0,asc:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0,spaceBelowApply:0,divideLen:0,st:-1,ed:-1,lineIndex:0,paragraphStart:!1}}function Sme(t,e,n,r){if(r)if(r.has(t)){const i=r.get(t);i==null||i.elements.push(e)}else r.set(t,{elements:[e],paragraphIndex:t,top:n})}function nA(t,e,n,r,i,o){const s=[],a=new Map;for(const l of e.children){let u=[],c=n;s.length>0&&(c=s[s.length-1]),l.nodeType===Xr.PARAGRAPH?u=Epe(t,l,c,r,i):(l.nodeType,Xr.TABLE),u.length===0&&(u=kfe()),Eme(s,u)}return{pages:s,renderedBlockIdMap:a}}function Eme(t,e){const n=t.length-1,r=t[n],i=e[0];r===i&&e.splice(0,1),t.push(...e)}function rA(t=[],e=a6.NONE,n=0,r=0,i=1/0,o=1/0){const s=[];let a=0,l=0;if(t.length===0)s.push(Hm(r,i,0,a6.NONE));else for(let c=0;c<t.length;c++){const{width:d,paddingEnd:h}=t[c];l=h,a=d,s.push(Hm(r,a,l,e)),r+=a+l,c===t.length-1&&(a=i!==1/0?i-a:d,l=0,s.push(Hm(r,a,l,e)))}const u={columns:s,colCount:(t==null?void 0:t.length)||1,height:o,top:n,st:0,ed:0};return s.forEach(c=>{c.parent=u}),u}function iA(t,e){t.isFull=e}function Hm(t,e,n,r){return{lines:[],left:t,width:e,height:0,spaceWidth:n,separator:r,st:0,ed:0,drawingLRIds:[],isFull:!1}}function L6(t,e,n=1,r=A6.SECTION){var i,o,s,a;const l=wme(),{pageNumberStart:u=1,pageSize:c={width:1/0,height:1/0},pageOrient:d=H5.PORTRAIT,headerIds:h={},footerIds:f={},useFirstPageHeaderFooter:m,useEvenPageHeaderFooter:p,footerTreeMap:g,headerTreeMap:v,columnProperties:_=[],columnSeparatorType:C,marginTop:y=0,marginBottom:S=0,marginHeader:E=0,marginFooter:w=0,marginLeft:R=0,marginRight:D=0,renderConfig:I={}}=t,{skeHeaders:k,skeFooters:O}=e,{width:$=1/0,height:N=1/0}=c;l.pageNumber=n,l.pageNumberStart=u,l.renderConfig=I,l.marginLeft=R,l.marginRight=D,l.breakType=r,l.pageWidth=$,l.width=0,l.pageHeight=N,l.height=0,l.pageOrient=d;const{defaultHeaderId:H,evenPageHeaderId:X,firstPageHeaderId:te}=h,{defaultFooterId:z,evenPageFooterId:A,firstPageFooterId:T}=f;let P=H??"",K=z??"";n===u&&m?(P=te??"",K=T??""):n%2===0&&p&&(P=X??"",K=A??"");let ee,ue;P&&((i=k.get(P))!=null&&i.has($)?ee=(o=k.get(P))==null?void 0:o.get($):v&&v.has(P)&&(ee=hR(v.get(P),t,e),k.set(P,new Map([[$,ee]]))),l.headerId=P),K&&((s=O.get(K))!=null&&s.has($)?ue=(a=O.get(K))==null?void 0:a.get($):g&&g.has(K)&&(ue=hR(g.get(K),t,e),O.set(P,new Map([[$,ue]]))),l.footerId=K),l.marginTop=fR(y,E,ee),l.marginBottom=fR(S,w,ue);const fe=l.sections,Ee=fe[fe.length-1],{marginTop:Q,marginBottom:re,marginLeft:Se,marginRight:_e}=l,He=$-Se-_e,Ne=N-Q-re;let we=0;Ee&&(we=Ee.top+Ee.height);const Me=rA(_,C,we,0,He,Ne-we);return Me.parent=l,fe.push(Me),l}function wme(){return{sections:[],headerId:"",footerId:"",pageWidth:0,pageHeight:0,pageOrient:H5.PORTRAIT,pageNumber:1,pageNumberStart:1,verticalAlign:!1,angle:0,width:0,height:0,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,breakType:A6.SECTION,st:0,ed:0,skeDrawings:new Map}}function hR(t,e,n,r=!0){const{lists:i,footerTreeMap:o,headerTreeMap:s,localeService:a,pageSize:l,marginLeft:u=0,marginRight:c=0,drawings:d,marginTop:h=0,marginBottom:f=0,marginHeader:m=0,marginFooter:p=0}=e,g=(l==null?void 0:l.width)||1/0,v={lists:i,footerTreeMap:o,headerTreeMap:s,pageSize:{width:g-u-c,height:1/0},localeService:a,drawings:d},_=L6(v,n),C=nA(t,t.children[0],_,v,n).pages[0];wv([C]);const y=C.sections[0].columns[0],S=y.height||0,{skeDrawings:E,st:w,ed:R}=C,D={lines:y.lines,skeDrawings:E,height:S,st:w,ed:R,marginLeft:u,marginRight:c};return r?{...D,marginTop:Rme(h,m,S)}:{...D,marginBottom:Dme(f,p,S)}}function fR(t,e,n){return!n||n.lines.length===0?t:Math.max(t,e,(n==null?void 0:n.height)||0)}function Rme(t,e,n){const r=Math.max(t,e);return n>r?0:r-n}function Dme(t,e,n){const r=Math.max(t,e);return n>r?0:r-n}function mR(t,e,n,r,i=!1){if(i)if(r.bulletSkeleton){const{bulletSkeleton:o,paragraphStyle:s={}}=r,{gridType:a=fo.LINES,charSpace:l=0,defaultTabStop:u=1}=n,{snapToGrid:c=ke.TRUE}=s,d=UC(l,u,a,c);kme(s,o,d);const h=sme(t[0],o,d);xu([h,...t],e,n,r,i)}else xu(t,e,n,r,i);else t5(t,e,n,r,i);return[...e]}function t5(t,e,n,r,i=!1,o=!0,s){var a;const l=Y2(e),u=Kfe(l);if(u){const c=pR(t),{divide:d}=u,h=(a=d==null?void 0:d.spanGroup)==null?void 0:a[d.spanGroup.length-1],f=(h==null?void 0:h.width)||0,m=(h==null?void 0:h.left)||0,p=ume(h,t[0]);let g=0,v=f+m;if(p&&o){const _=Sv(h.content),C=" ";g=nl.getTextSize(C,_?t[0].fontStyle:h.fontStyle).width,v+=g,h.width+=g}if(v+c>d.width)if(vme(d,!0),u.isLast&&t.length===1&&(t[0].content===en.SPACE||t[0].content===en.PARAGRAPH))Bm(d,t,v);else if((d==null?void 0:d.spanGroup.length)===0){const _=[];for(;t.length&&(_.push(t.shift()),!(pR(_)>d.width)););Bm(d,_,v),t.length&&xu(t,e,n,r,i,s)}else xu(t,e,n,r,i,s);else{const _=d.parent,C=Tme(t);if(_&&C&&!Ame(_)){const{paragraphLineGapDefault:y,linePitch:S,lineSpacing:E,spacingRule:w,snapToGrid:R,gridType:D}=eA(n,r),{boundingBoxAscent:I,boundingBoxDescent:k}=C,O=I+k,{contentHeight:$}=aA(O,y,S,D,E,w,R);if(_.contentHeight<$){const N=$me(_),H=N.length;let X=[],te=1;H>2&&N[0].spanType===bo.LIST?(X=[N[0],N[1]],te=2):X=[N[0]];const z=_.parent,{paragraphStart:A}=z==null?void 0:z.lines.pop();xu(X,e,n,r,A,I+k);for(let T=te;T<N.length;T++)t5([N[T]],e,n,r,i,!1);t5(t,e,n,r,i,!1);return}}Bm(d,t,v)}}else xu(t,e,n,r,i,s)}function xu(t,e,n,r,i=!1,o){var s,a,l,u,c;let d=Y2(e),h=e5(d);if((!h||!h.column)&&(sA(t,e,n,r),d=Y2(e),h=e5(d)),!h)return;const f=h.column,m=Gfe(f),{ba:p,bd:g}=t[0].bBox,v=o||p+g,{paragraphStyle:_={},paragraphAffectSkeDrawings:C,skeHeaders:y,skeFooters:S,drawingAnchor:E,paragraphIndex:w}=r,{spaceAbove:R=0,spaceBelow:D=0,indentFirstLine:I=0,hanging:k=0,indentStart:O=0,indentEnd:$=0}=_,{paragraphLineGapDefault:N,linePitch:H,lineSpacing:X,spacingRule:te,snapToGrid:z,gridType:A}=eA(n,r),{paddingTop:T,paddingBottom:P,contentHeight:K,lineSpacingApply:ee}=aA(v,N,H,A,X,te,z),{marginTop:ue,spaceBelowApply:fe}=xme(ee,R,D,i,m),Ee=ue+T+K+P;let Q=f.parent;Q||(Q=FC(d));const re=(m==null?void 0:m.lineHeight)||0,Se=(m==null?void 0:m.top)||0,_e=re+Se,{pageWidth:He,headerId:Ne,footerId:we}=d,Me=(a=(s=y==null?void 0:y.get(Ne))==null?void 0:s.get(He))==null?void 0:a.skeDrawings,mt=(u=(l=S==null?void 0:S.get(we))==null?void 0:l.get(He))==null?void 0:u.skeDrawings;Mme(_e,Ee,f,(c=E==null?void 0:E.get(w))==null?void 0:c.top,C);const vt=pme(Ee,_e,d.skeDrawings,Me,mt);if(Ee+vt>Q.height&&f.lines.length>0&&d.sections.length>0){iA(f,!0),oA(t,e,n,r,i,o);return}const ft=m?m.lineIndex+1:0,{charSpace:et,defaultTabStop:ve}=qfe(n,r),Pe=UC(et,ve,A,z),{paddingLeft:Ye,paddingRight:bt,changeBulletWidth:Jt}=Ime(t[0],I,k,O,$,Pe);Jt.state&&(t[0].width=Jt.hangingNumber);const Ht=mme(w,N9.PARAGRAPH,{lineHeight:Ee,contentHeight:K,lineTop:vt,paddingLeft:Ye,paddingRight:bt,paddingTop:T,paddingBottom:P,marginTop:ue,spaceBelowApply:fe},f.width,ft,i,d.skeDrawings,Me,mt);f.lines.push(Ht),Ht.parent=f,Sme(w,Ht,_e,E),t5(t,e,n,r,i,!0,o)}function oA(t,e,n,r,i=!1,o){const s=Y2(e);Zfe(s)===!0?sA(t,e,n,r,i,o):xu(t,e,n,r,i,o)}function sA(t,e,n,r,i=!1,o){const s=Y2(e),{skeHeaders:a,skeFooters:l}=r;e.push(L6(n,{skeHeaders:a,skeFooters:l},s==null?void 0:s.pageNumber)),oA(t,e,n,r,i,o)}function Ime(t,e=0,n=0,r=0,i=0,o){const{spanType:s=bo.LETTER,bBox:a}=t,l=il(e,o),u=il(n,o),c=il(r,o),d=il(i,o);let h=c;const f=d,m={state:!1,hangingNumber:0};if(s===bo.LIST){const{width:p}=a;l>0?h+=l:u>0&&u>p&&(m.state=!0,m.hangingNumber=u)}else h+=u;return{paddingLeft:h,paddingRight:f,changeBulletWidth:m}}function xme(t=0,e=0,n=0,r,i){let o=0,s=0;if(!r)return{marginTop:o,spaceBelowApply:s};if(o=il(e,t),s=il(n,t),i){const{spaceBelowApply:a}=i;a>o&&(o=0,i.lineHeight+=a,i.marginBottom=a)}return{marginTop:o,spaceBelowApply:s}}function aA(t,e,n,r,i,o,s){let a=e,l=e;if(r===fo.DEFAULT||s===ke.FALSE)return o===uh.AUTO?{paddingTop:a,paddingBottom:l,contentHeight:i*t,lineSpacingApply:t}:{paddingTop:a,paddingBottom:l,contentHeight:Math.max(i,t),lineSpacingApply:i};let u=0;return o===uh.AUTO?u=i*n:u=i,t+e*2<u&&(a=l=(u-t)/2),{paddingTop:a,paddingBottom:l,contentHeight:t,lineSpacingApply:u}}function Mme(t,e,n,r,i){var o;if(!i)return;const s=(o=n.parent)==null?void 0:o.parent;if(!s)return;const a=new Map,l=Ome(n);i.forEach(u=>{if(!u)return;const{initialState:c,drawingOrigin:d}=u;if(c||!d)return;const{objectTransform:h}=d,{positionH:f,positionV:m,size:p,angle:g}=h,{width:v=0,height:_=0}=p;u.aLeft=eme(f,n,s,v,l)||0,u.aTop=tme(m,s,t,e,_,r,l)||0,u.width=v,u.height=_,u.angle=g,u.initialState=!0,a.set(u.objectId,u)}),s.skeDrawings=new Map([...s.skeDrawings,...a])}function Ome(t){const e=t.parent;if(!e)return!1;const n=e==null?void 0:e.columns;if(!n)return!1;const r=n.length;for(let i=r-1;i>=0;i--){const o=n[i].lines,s=o.length;if(!(s<=0)){for(let a=s-1;a>=0;a--)if(o[a].paragraphStart)return!1}}return!0}function pR(t){const e=t.length;let n=0;for(let r=0;r<e;r++){const i=t[r];n+=i.width}return n}function Tme(t){const e=t.length;let n=-1/0,r;for(let i=0;i<e;i++){const o=t[i],{ba:s,bd:a}=o.bBox;n<s+a&&(r={boundingBoxAscent:s,boundingBoxDescent:a}),n=s+a}return r}function $me(t){const e=t.divides,n=e.length,r=[];for(let i=0;i<n;i++){const o=e[i];r.push(...o.spanGroup)}return r}function kme(t,e,n){const{hanging:r,indentStart:i}=t,{hanging:o,indentStart:s}=e;r===void 0&&(t.hanging=o),i===void 0&&(t.indentStart=il(s||0,n)-il(o||0,n))}function Ame(t){return!t.divides[0].spanGroup[0]}function lA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var VC=0,uA=-3;function P6(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function Nme(t,e){this.source=t,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=e,this.destLen=0,this.ltree=new P6,this.dtree=new P6}var cA=new P6,dA=new P6,jC=new Uint8Array(30),zC=new Uint16Array(30),hA=new Uint8Array(30),fA=new Uint16Array(30),Lme=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),gR=new P6,na=new Uint8Array(320);function mA(t,e,n,r){var i,o;for(i=0;i<n;++i)t[i]=0;for(i=0;i<30-n;++i)t[i+n]=i/n|0;for(o=r,i=0;i<30;++i)e[i]=o,o+=1<<t[i]}function Pme(t,e){var n;for(n=0;n<7;++n)t.table[n]=0;for(t.table[7]=24,t.table[8]=152,t.table[9]=112,n=0;n<24;++n)t.trans[n]=256+n;for(n=0;n<144;++n)t.trans[24+n]=n;for(n=0;n<8;++n)t.trans[168+n]=280+n;for(n=0;n<112;++n)t.trans[176+n]=144+n;for(n=0;n<5;++n)e.table[n]=0;for(e.table[5]=32,n=0;n<32;++n)e.trans[n]=n}var vR=new Uint16Array(16);function Vm(t,e,n,r){var i,o;for(i=0;i<16;++i)t.table[i]=0;for(i=0;i<r;++i)t.table[e[n+i]]++;for(t.table[0]=0,o=0,i=0;i<16;++i)vR[i]=o,o+=t.table[i];for(i=0;i<r;++i)e[n+i]&&(t.trans[vR[e[n+i]]++]=i)}function Bme(t){t.bitcount--||(t.tag=t.source[t.sourceIndex++],t.bitcount=7);var e=t.tag&1;return t.tag>>>=1,e}function da(t,e,n){if(!e)return n;for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var r=t.tag&65535>>>16-e;return t.tag>>>=e,t.bitcount-=e,r+n}function Dv(t,e){for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var n=0,r=0,i=0,o=t.tag;do r=2*r+(o&1),o>>>=1,++i,n+=e.table[i],r-=e.table[i];while(r>=0);return t.tag=o,t.bitcount-=i,e.trans[n+r]}function Fme(t,e,n){var r,i,o,s,a,l;for(r=da(t,5,257),i=da(t,5,1),o=da(t,4,4),s=0;s<19;++s)na[s]=0;for(s=0;s<o;++s){var u=da(t,3,0);na[Lme[s]]=u}for(Vm(gR,na,0,19),a=0;a<r+i;){var c=Dv(t,gR);switch(c){case 16:var d=na[a-1];for(l=da(t,2,3);l;--l)na[a++]=d;break;case 17:for(l=da(t,3,3);l;--l)na[a++]=0;break;case 18:for(l=da(t,7,11);l;--l)na[a++]=0;break;default:na[a++]=c;break}}Vm(e,na,0,r),Vm(n,na,r,i)}function _R(t,e,n){for(;;){var r=Dv(t,e);if(r===256)return VC;if(r<256)t.dest[t.destLen++]=r;else{var i,o,s,a;for(r-=257,i=da(t,jC[r],zC[r]),o=Dv(t,n),s=t.destLen-da(t,hA[o],fA[o]),a=s;a<s+i;++a)t.dest[t.destLen++]=t.dest[a]}}}function Ume(t){for(var e,n,r;t.bitcount>8;)t.sourceIndex--,t.bitcount-=8;if(e=t.source[t.sourceIndex+1],e=256*e+t.source[t.sourceIndex],n=t.source[t.sourceIndex+3],n=256*n+t.source[t.sourceIndex+2],e!==(~n&65535))return uA;for(t.sourceIndex+=4,r=e;r;--r)t.dest[t.destLen++]=t.source[t.sourceIndex++];return t.bitcount=0,VC}function Hme(t,e){var n=new Nme(t,e),r,i,o;do{switch(r=Bme(n),i=da(n,2,0),i){case 0:o=Ume(n);break;case 1:o=_R(n,cA,dA);break;case 2:Fme(n,n.ltree,n.dtree),o=_R(n,n.ltree,n.dtree);break;default:o=uA}if(o!==VC)throw new Error("Data error")}while(!r);return n.destLen<n.dest.length?typeof n.dest.slice=="function"?n.dest.slice(0,n.destLen):n.dest.subarray(0,n.destLen):n.dest}Pme(cA,dA);mA(jC,zC,4,3);mA(hA,fA,2,1);jC[28]=0;zC[28]=258;var Vme=Hme;const jme=new Uint8Array(new Uint32Array([305419896]).buffer)[0]===18,bR=(t,e,n)=>{let r=t[e];t[e]=t[n],t[n]=r},zme=t=>{const e=t.length;for(let n=0;n<e;n+=4)bR(t,n,n+3),bR(t,n+1,n+2)},Wme=t=>{jme&&zme(t)};var Xme={swap32LE:Wme};const CR=Vme,{swap32LE:Yme}=Xme,WC=11,Au=5,Gme=WC-Au,Kme=65536>>WC,Zme=1<<Gme,qme=Zme-1,M3=2,Qme=1<<Au,jm=Qme-1,pA=65536>>Au,Jme=1024>>Au,epe=pA+Jme,tpe=epe,npe=32,rpe=tpe+npe,ipe=1<<M3;class ope{constructor(e){const n=typeof e.readUInt32BE=="function"&&typeof e.slice=="function";if(n||e instanceof Uint8Array){let r;if(n)this.highStart=e.readUInt32LE(0),this.errorValue=e.readUInt32LE(4),r=e.readUInt32LE(8),e=e.slice(12);else{const i=new DataView(e.buffer);this.highStart=i.getUint32(0,!0),this.errorValue=i.getUint32(4,!0),r=i.getUint32(8,!0),e=e.subarray(12)}e=CR(e,new Uint8Array(r)),e=CR(e,new Uint8Array(r)),Yme(e),this.data=new Uint32Array(e.buffer)}else({data:this.data,highStart:this.highStart,errorValue:this.errorValue}=e)}get(e){let n;return e<0||e>1114111?this.errorValue:e<55296||e>56319&&e<=65535?(n=(this.data[e>>Au]<<M3)+(e&jm),this.data[n]):e<=65535?(n=(this.data[pA+(e-55296>>Au)]<<M3)+(e&jm),this.data[n]):e<this.highStart?(n=this.data[rpe-Kme+(e>>WC)],n=this.data[n+(e>>Au&qme)],n=(n<<M3)+(e&jm),this.data[n]):this.data[this.data.length-ipe]}}var spe=ope;const ape=lA(spe);var gA={};(function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(n){var r=typeof Uint8Array<"u"?Uint8Array:Array,i=43,o=47,s=48,a=97,l=65,u=45,c=95;function d(m){var p=m.charCodeAt(0);if(p===i||p===u)return 62;if(p===o||p===c)return 63;if(p<s)return-1;if(p<s+10)return p-s+26+26;if(p<l+26)return p-l;if(p<a+26)return p-a+26}function h(m){var p,g,v,_,C,y;if(m.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var S=m.length;C=m.charAt(S-2)==="="?2:m.charAt(S-1)==="="?1:0,y=new r(m.length*3/4-C),v=C>0?m.length-4:m.length;var E=0;function w(R){y[E++]=R}for(p=0,g=0;p<v;p+=4,g+=3)_=d(m.charAt(p))<<18|d(m.charAt(p+1))<<12|d(m.charAt(p+2))<<6|d(m.charAt(p+3)),w((_&16711680)>>16),w((_&65280)>>8),w(_&255);return C===2?(_=d(m.charAt(p))<<2|d(m.charAt(p+1))>>4,w(_&255)):C===1&&(_=d(m.charAt(p))<<10|d(m.charAt(p+1))<<4|d(m.charAt(p+2))>>2,w(_>>8&255),w(_&255)),y}function f(m){var p,g=m.length%3,v="",_,C;function y(E){return e.charAt(E)}function S(E){return y(E>>18&63)+y(E>>12&63)+y(E>>6&63)+y(E&63)}for(p=0,C=m.length-g;p<C;p+=3)_=(m[p]<<16)+(m[p+1]<<8)+m[p+2],v+=S(_);switch(g){case 1:_=m[m.length-1],v+=y(_>>2),v+=y(_<<4&63),v+="==";break;case 2:_=(m[m.length-2]<<8)+m[m.length-1],v+=y(_>>10),v+=y(_>>4&63),v+=y(_<<2&63),v+="=";break}return v}n.toByteArray=h,n.fromByteArray=f})(t)})(gA);const lpe=lA(gA);var vA={};const upe=5,yR=12,cpe=13,dpe=16,hpe=17,fpe=22,SR=28,ER=31,mpe=33,O3=34,ppe=35,zm=36,Iv=37,_A=38,gpe=39,vpe=40,Md=41,_pe=42,x=0,L=1,Wn=2,bA=3,Z=4,bpe=[[Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,bA,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z],[x,Z,Z,L,L,Z,Z,Z,Z,L,L,x,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[x,Z,Z,L,L,Z,Z,Z,Z,L,L,L,L,L,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[Z,Z,Z,L,L,L,Z,Z,Z,L,L,L,L,L,L,L,L,L,L,L,Z,Wn,Z,L,L,L,L,L,L,L,L,L,L],[L,Z,Z,L,L,L,Z,Z,Z,L,L,L,L,L,L,L,L,L,L,L,Z,Wn,Z,L,L,L,L,L,L,L,L,L,L],[x,Z,Z,L,L,L,Z,Z,Z,x,x,x,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[x,Z,Z,L,L,L,Z,Z,Z,x,x,x,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[x,Z,Z,L,L,L,Z,Z,Z,x,x,L,x,L,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[x,Z,Z,L,L,L,Z,Z,Z,x,x,L,L,L,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[L,Z,Z,L,L,L,Z,Z,Z,x,x,L,L,L,L,L,L,L,x,x,Z,Wn,Z,L,L,L,L,L,x,L,L,L,x],[L,Z,Z,L,L,L,Z,Z,Z,x,x,L,L,L,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[L,Z,Z,L,L,L,Z,Z,Z,L,L,L,L,L,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[L,Z,Z,L,L,L,Z,Z,Z,L,L,L,L,L,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[L,Z,Z,L,L,L,Z,Z,Z,L,L,L,L,L,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[x,Z,Z,L,L,L,Z,Z,Z,x,L,x,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[x,Z,Z,L,L,L,Z,Z,Z,x,x,x,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[x,Z,Z,L,x,L,Z,Z,Z,x,x,L,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[x,Z,Z,L,x,L,Z,Z,Z,x,x,x,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[L,Z,Z,L,L,L,Z,Z,Z,L,L,L,L,L,L,L,L,L,L,L,Z,Wn,Z,L,L,L,L,L,L,L,L,L,x],[x,Z,Z,L,L,L,Z,Z,Z,x,x,x,x,x,x,L,L,L,x,Z,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,Z,x,x,x,x,x,x,x,x,x,x,x,x],[L,Z,Z,L,L,L,Z,Z,Z,L,L,L,L,L,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[L,Z,Z,L,L,L,Z,Z,Z,L,L,L,L,L,L,L,L,L,L,L,Z,Wn,Z,L,L,L,L,L,L,L,L,L,L],[x,Z,Z,L,L,L,Z,Z,Z,x,L,x,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,L,L,x,x,x,L,x],[x,Z,Z,L,L,L,Z,Z,Z,x,L,x,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,L,x,x,x,L,x],[x,Z,Z,L,L,L,Z,Z,Z,x,L,x,x,x,x,L,L,L,x,x,Z,Wn,Z,L,L,L,L,x,x,x,x,L,x],[x,Z,Z,L,L,L,Z,Z,Z,x,L,x,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,L,L,x,x,x,L,x],[x,Z,Z,L,L,L,Z,Z,Z,x,L,x,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,L,x,x,x,L,x],[x,Z,Z,L,L,L,Z,Z,Z,x,x,x,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,L,x,x,L,x],[x,Z,Z,L,L,L,Z,Z,Z,x,L,x,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,L,L,x],[x,Z,Z,L,L,L,Z,Z,Z,x,L,x,x,x,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[L,Z,Z,L,L,L,Z,Z,Z,L,L,L,L,L,x,L,L,L,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x],[x,Z,Z,L,L,x,Z,Z,Z,x,x,x,x,x,x,x,x,x,x,x,Z,Wn,Z,x,x,x,x,x,x,x,x,L,x]],Cpe=lpe.toByteArray("AAgOAAAAAAAQ4QAAAQ0P8vDtnQuMXUUZx+eyu7d7797d9m5bHoWltKVUlsjLWE0VJNigQoMVqkStEoNQQUl5GIo1KKmogEgqkKbBRki72lYabZMGKoGAjQRtJJDaCCIRiiigREBQS3z+xzOTnZ3O+3HOhd5NfpkzZx7fN9988zivu2M9hGwB28F94DnwEngd/Asc1EtIs9c/bIPDwCxwLDgezHcodyo4w5C+CCwBS8FnwSXgCnA1uFbI93XwbXAbWAfWgx+CzWAb+An4KfgFeAzsYWWfYuFz4CXwGvgb+Dfo6yNkEEwGh4CZYB44FpwI3g1OY+kfBItZOo2fB84Hy8DF4HJwNbiWpV8PVoO1LH4n2NRXyN+KcAd4kNVP9XsY4aPgcfAbsBfs6SniL4K/sPjfEf6HlanXCRkCw2BGvUh/keWfXS/CY+pFXs7x9XHmM94LTmWIeU2cgbxnS/k/B3kf86jDhU8L9V2E40vAFWAlWFUfb++NOL4F3C7JX4/4GiE+hvgWsF0oS7mXldspnN+F493gyXrh9xTav0cg3EvzgVfBG6wsmVSEkxBOBgdPGpd7JI6PnqRvJ68/xlbHof53gPeA94OzwLngk+ACsAwsByvASrAK3MB0Ws3CtQjvBJvAVrADPMDSHkb4CNijaccTwvnf4fiPEs8Lxy+D18A/QU8/xjgYBjPAbDAKTgYLwOngTHAO+EQ/8wuEF4EvsPiVCFf2+9tsFStzA8LVHuXXBsi6QyqzUYiPMR/7Mc7dAx7oL8bzw/3u/Bw8Bp4Az4AXwCtgHzsmDXP5fiF9iiVvly5d0sHngar16NKlS5cuXbp06fLmYlqHXrcd3ph4P0THUY3iXh49novju4S0tzfs5d+JPKewfAsRntZb3K9ZhOMlrO6lCC8An28U9+OuovcPcPxlVu5rCL/VmHh/iHIrzn3fIPu7SN8Axmg+8AOwEWwCm7tp3bRuWjetm5Y8bSu4B9zbKO6ZVsnORrVU3f4uXTqZ2H3sLoyx3eDXjfDndE9qyj6L838CfwVvgFpzYnof4oNgOhgBc8Fos9DrZIQLmtXPP1MmF6wGj4H+KXoWguvADkXaPil+YpuQy8Am8Ey7ODdtmJDF4HowBp4De6HDTNjhfHAHeBr0DBBy0kDxfPbcgSIusgrcWhtnJ8vL+TPix7UIOQtcBq4C28Cr4KRBnANbwSuDE+s50JgyNNFuXbp06XIgsXjIvPafjvXozKY+fVFz/z0LT1uCtKVSWbrOLWPnztG8e0Xfy7ol8XtZJi7WtG+5od2UFXQ/A12vUeS7jp27yVKHjdsU9lXB869TyNvAzt0lpP2oWbwLdjiO78bx/Sz+EMJHwK9Y/LcIfw+eZ3F67/Hl5vh9xX80J+rwX8SvRDhpgL17iPAQMHNArfPrqHPewLheI+AERV6efwV418B4nOZ/H+IfYHV8GOF5LJ3eAz0fx8sM9S0fUNud39O9CulfGZhY5huI3wzWgNvBelbHZoTbNPVpfYjKQpkHwUNgl0LWblbnk0LbbDxr0OMFpL3iqWdu9nWYPlVAWkXY39LnGdCkDbeqv1YNbfcMQ3t9oe8lzm6NH9N1ZB6Ln4BwfkJZJk7RyFnYKt6b/JDQXx9p5X+eFdqOjzM9P9MB/lUlFzr20aXIdzlY4dmn9F3YqtvoO76/2hp/D/xA5Zue88nNyL8GbFbs075X0tyUig3Qd2MCnf//HjnzpbsR3g9+1kHzzVjdnE71/qVBX9rGPUh/ysNWe1neFzvIDi5zAufV1sT0N0poR22wkFUfTOPfA4N2mbZ5fSrqOHSw+IbkSBbOGSzSRgf91/GTUWYBOB2cIZQ/G8cfBZ8CFwrnL8XxF8FKcA24jqXdiPA7Qr61OF7H4mMItwzuv2/YLth1ISt3Hzu3k4W7EH5JqPdRHD/O4k+z8A8IX5Lq3y7Z4nXE9xn6kX6vQ4bKfy+ok+hH+xf3hq9dnTTHhjKd2GmDuWA242iHMq4cC7A8kJ7i8o1+skSa7Jieo38HCWnoNjKFhdSFBxzpZ7QE6lI8N4S14aASZcryaV/WWHw66f6NHuCoxuQxmvM56GX9QMd8Q4D65ywGP+ZzRJuM+zQvx/MOS2VFeqQ4IXnH26zM9Xe6/E6D+4foAzzuajPZp8Qyw5ayZVDWuH0z0BtYRkeIDqH9KO9VbH1btd/lhNqCzvl8zeLnG0S/hnU6baHfpiuO6yy0rd+DHURo/zYF5H26j03rQsip2ndzz82u1z9N4VjWKWeb68Tedpt95HRVXp7H1R6p+/Wt4FPy/PpWwscOLRJ+PVWF/+W0iVyGzs18TIvXkOJ1Wxm66vSXz+vylenrZcj1ub439W+K8RNCGTJi2p/TJ1K23VaXr35tRpnzmjxequgfcfyk6B/TGBVlyedsNgpdd/h+W1U3P99QyFPNo1X3TwpM/WLTIWYfoBqXrv6iskHZ/RFr79R6hIyHBrH3f1nrUVnjP8SnZZ+rYtzr9Exld5MNbPNErusAPg+77u/eDOPftU9yj39TH7rezxd1LvsZQJlzkWlOirG/79zjMj/mtHUKu7vKy+3/LnXr9okyKedjX5/0He9iP/j63LwOQdarEVlfy8OO/Lqw023j6xcqmwxLiOd6heM2i9cV9LJy8jMJ23yQ+rpbfu7EQ/pXE8KYvUSqvVnb4XzZa6LrHMXHR+zcLvqWbm/Bn0/HzIs6fWPHoat8XfnDKmZGxRxeMbn2UqZ5Q94nmcZRbqqUXbZ8+lcjE+cPX11t814orvvAXNcG8vqj2vvk1MGn3anlj0bIT72v47bvE+Lc98T9b6r7AKn6j+8Duf7D0nnZx/j7Zjn0j9nbpSTndaLr9WNLivP+iN23xF7L+fqv6ZouFyb78jxVXvv5jJ9YUs9/sddO8h7KNg5jrhfaJGztT6G7KF+1d6yCmD5Kdb2fan60rSc552fZr3zeQ9DpnPp+Si5cx5Ktv2QfSzF/mMbWdOm46rFI4XstnU9xeqX4NKb7TKEdcr6pZOK3ID1k/LvFHkVczEuZLEDr499YqvqBym1aEHWgcvoYOtv0M91qQl5TfpO/in6rWx8OVpT1Wedkv3f5xom3T/xeR/6Gx6V86PWAOB4bBpqWdN+yTcVxjIyGRz/FrDGu6w/3d7kPm8StX8RyPu+uuvpNju/vTLJV37GpvoM0oZPnW87VLnL/5pDno1NoW1R6yedU6TyUv3u19a3KFnIbTLYz+ZCLP4T0tU1uivFgso0pnsJ/UtXvarNY28Xq5cvkBDrQP/E5ZaiuQwwfmTlsOiQRU1fMuqrDd/3ISSuwjOwXOfTyGUMpZIXq4GpLn3pUcdfzch2x7XO1u2uZHOPb1G6b3Xg9PH1IIWeEpJlPQtqos2EKW8b0u8rnuP1UeVLoXJb9be0uG9nnbchjU+XTszT5VeNBThPHnc5OKj1U9aj0GTHIVaGy1YhEWT4ixns00DT+XEzWn/7VAsIc63Cov3OdyhwjrnaqQqZvWKXdypRdlq+k8msZ031U+Rm4fA+3TtyeR9hwfW9G9yxDN0fZMN33F+9TE6md4hwoxumfaUzI9fN3PFT3xVV2msrQ3UsnChm6Nulk8TndpS28D3zX9tTIPsF/z7Am5OkTjm1tI1JZW74+4VgsZ0N3L1yXV3WeP5uR7TGHHdvC3JQlxybfpd22tDlk/2eofRK8TzrN/qnar/K/OUTth6I/+jAnEptNbPvFHP2gs40N3+dfMWtwqvVct7/wfd8gtQ7imifial9ZJ9/3IHLYU6eDj3+4PhsNhX+vwvcWLnu6kGfEMe8DuciPfUfGZB8X/7HJy/Gefe5n+VRGFd/wyP2ta7/LO4yh/sbLV/k9lev6kfO9Dt/5U67b1/6u/epqB1U9Me23jfHY9sscAg4tkbLl+e4/U36rJ9ddxfd6sg5vq5ice42Wpk/pb9FOJ36/W9tpv4kbC79nUbZceX8Zu6/qJ+P3WvhvA8v3reh7Jbn2d6rrNC7XNZTLma4Ba0JI9efX2uLzF5scG/w9UNU1ZxW+ymUfzELeTllXlQ1rUuhzjS5fp9c964iFBOqeSz63bU065nZKdU+mDEz3qHIjjifquw0pnb/raRtvrnsYcb46ihT3taoYz6brdNW9l6rWRnE/navdPn1XlR1km7hcz1WlH/elKuSOSvLLuE8U6m8uzwRdfcGl73VyTHuyMvzJ1Sa2cWDTP/Z63Kc94n2B1PYr24dz1JlyHLlcP+S4B6vD1c9EW4q2LWstCvUjeVy63k/LMYdUNd5D1xQfvVTzX1VjkMsUv88N8VH5fReVn/Fjn++/h6X6Q8a6b1/q3g/i/ewi0/Scs8zxXeV6mWIOUPlPzBgdFerW+bZrm2P18dnjuK6HunEp+rHvPMXbr+sHVb/lnL+pTP57jPw9Cvk3PW178JD9qChfzuvTf7Htl38L1QUf/VKu9SFjwWbTWPvFEvu7Uq76y7+31g6QlYPc669pbsm9Xur2LWI9Pu8ypfDXqm3A2z8s1FWGn4ntL9NfQu2oSlftX9uetvTtv7J8Ql4zxfXGZ3zk8PeQ9w59x2uMfqI8/q5eKh/l9cb2rwsu9rSNl06ZP2Pmxtz+rNMx93yno0n2/82rVH7rQ+y9P15H6FyRun9ViH81ATmffI7nJ5r8uXXW6enbP6b/B8/l5OifVHYLnb9S39s2zcc+Ph+rh8+eQgVPS72elzGWY/tUtbbabBpDiI7yN1q6/4th2y+ErAc5+9BVvu/7KamJbWNZeuqI/R4tRf+YyD1HmOZM1bMV3/14Sn10c0Xu+Sj1nOXb5jL73ncdy02uvlXZNde65dOHYl7Vs4KYuS6FzWLn2zJlpZqPXPVPOa5yzKOyn1VhT9lmMfdbfH7D11Wf2PXN5h9y+dD287+qxgSnaYmnIrRtIb8pJe6/Uv9OVer6Whn0zfGO/BEloZI9ojmfAlUflClDd178bTmVHVTpZXOkAlk/lb42UujmI89HH5V+cl7XtowY6vTxLVWok6UrGzoGTHN+bB+6ri05687VNpvfuvRfaP2uMlNQth1D5JjGelm/8yn+9p3p/7qk9gnfeddXZmq/Sm333PJT659Kv1zjNbZ9uv2Oi//67CV8/N1nj1DmviyXDNVeJkaeaX8UsyesYg8cu2+NvdaPfb+lLDu5tvt/"),ype=new ape(Cpe),wR=function(t){switch(t){case mpe:return yR;case gpe:case vpe:case _pe:return yR;case ppe:return upe;default:return t}},RR=function(t){switch(t){case Iv:case _A:return O3;case Md:return fpe;default:return t}};let Wm=class{constructor(e,n=!1){this.position=e,this.required=n}},Spe=class{nextCodePoint(){const e=this.string.charCodeAt(this.pos++),n=this.string.charCodeAt(this.pos);return 55296<=e&&e<=56319&&56320<=n&&n<=57343?(this.pos++,(e-55296)*1024+(n-56320)+65536):e}nextCharClass(){return wR(ype.get(this.nextCodePoint()))}getSimpleBreak(){switch(this.nextClass){case Md:return!1;case O3:case Iv:case _A:return this.curClass=O3,!1;case zm:return this.curClass=zm,!1}return null}getPairTableBreak(e){let n=!1;switch(bpe[this.curClass][this.nextClass]){case x:n=!0;break;case L:n=e===Md;break;case Wn:if(n=e===Md,!n)return n=!1,n;break;case bA:if(e!==Md)return n;break}return this.LB8a&&(n=!1),this.LB21a&&(this.curClass===dpe||this.curClass===hpe)?(n=!1,this.LB21a=!1):this.LB21a=this.curClass===cpe,this.curClass===SR?(this.LB30a++,this.LB30a==2&&this.nextClass===SR&&(n=!0,this.LB30a=0)):this.LB30a=0,this.curClass=this.nextClass,n}nextBreak(){if(this.curClass==null){let e=this.nextCharClass();this.curClass=RR(e),this.nextClass=e,this.LB8a=e===ER,this.LB30a=0}for(;this.pos<this.string.length;){this.lastPos=this.pos;const e=this.nextClass;if(this.nextClass=this.nextCharClass(),this.curClass===O3||this.curClass===zm&&this.nextClass!==Iv)return this.curClass=RR(wR(this.nextClass)),new Wm(this.lastPos,!0);let n=this.getSimpleBreak();if(n===null&&(n=this.getPairTableBreak(e)),this.LB8a=this.nextClass===ER,n)return new Wm(this.lastPos)}return this.lastPos<this.string.length?(this.lastPos=this.string.length,new Wm(this.string.length)):null}constructor(e){this.string=e,this.pos=0,this.lastPos=0,this.curClass=null,this.nextClass=null,this.LB8a=!1,this.LB21a=!1,this.LB30a=0}};vA=Spe;function Epe(t,e,n,r,i){const{gridType:o=fo.LINES,charSpace:s=0,defaultTabStop:a=10.5,pageSize:l={width:1/0,height:1/0},marginRight:u=0,marginLeft:c=0,lists:d,drawings:h={},localeService:f}=r,{endIndex:m,startIndex:p,content:g="",blocks:v=[]}=e,_=t.getParagraph(m)||{startIndex:0},{paragraphStyle:C={},bullet:y}=_,{skeHeaders:S,skeFooters:E,skeListLevel:w,drawingAnchor:R}=i,D=new Map,I={paragraphIndex:m,paragraphStyle:C,paragraphAffectSkeDrawings:D,skeHeaders:S,skeFooters:E,drawingAnchor:R},k=wpe(y,w),O=Hfe(y,d,k);Rpe(y,O,w),I.bulletSkeleton=O;const{horizontalAlign:$=Ln.UNSPECIFIED,snapToGrid:N=ke.TRUE}=C;let H=[n];const X=new Map;for(let T=0,P=v.length;T<P;T++){const K=v[T],ee=t.getCustomBlock(K);if(ee==null)continue;X.set(K,ee);const ue=ee.blockId,fe=h[ue];fe.layoutType!==va.INLINE&&D.set(ue,Dpe(fe))}rme();const te=new vA(g);let z=0,A;for(;A=te.nextBreak();){let T=g.slice(z,A.position),P=z,K=[],ee=z===0;const ue=()=>{K.length!==0&&(H=mR(K,H,r,I,ee),K=[],ee=!1)};for(;T.length>0;){const fe=T[0],Ee=P+p;if(fe===en.TAB){const Q=G2(P,t,e,r,C),re=UC(s,a,o,N),Se=ome(Q,re);ue(),H=mR([Se],H,r,I,ee),P++,T=T.substring(1);continue}if(/\s/.test(fe)||PC(fe)){const Q=G2(P,t,e,r,C),re=L9(fe,Q);K.push(re),P++,T=T.substring(1)}else if(ffe(T)){const{step:Q,spanGroup:re}=hme(P,T,t,e,r,C);K.push(...re),P+=Q,T=T.substring(Q)}else if(jk(fe)){const{step:Q,spanGroup:re}=dme(P,T,t,e,r,C);K.push(...re),P+=Q,T=T.substring(Q)}else if(zk(fe)){const{step:Q,spanGroup:re}=fme(P,T,t,e,r,C);K.push(...re),P+=Q,T=T.substring(Q)}else{const{step:Q,spanGroup:re}=cme(P,T,t,e,r,C);K.push(...re),P+=Q,T=T.substring(Q)}if(fe===en.CUSTOM_BLOCK){let Q=X.get(Ee);if(Q==null&&(Q=t.getCustomBlock(Ee)),Q!=null){const re=Q.blockId;h[re].layoutType===va.INLINE&&(H=Xfe())}}else if(fe===en.PAGE_BREAK)ue(),H.push(L6(r,i,DR(H[H.length-1]),A6.PAGE)),D.clear();else if(fe===en.COLUMN_BREAK){ue();const Q=H[H.length-1],re=e5(Q);re&&!re.isLast?iA(re.column,!0):H.push(L6(r,i,DR(Q),A6.COLUMN))}}ue(),z=A.position}return Qfe(H,T=>{Ipe(T,$)}),H}function wpe(t,e){if(!t||!e)return;const{listId:n,nestingLevel:r}=t,i=e==null?void 0:e.get(n);let o=r;o<0&&(o=0);const s=[];for(let a=o;a>=0;a--){const l=i==null?void 0:i[a];s[a]=l||null}return s}function Rpe(t,e,n){if(!t||!e)return;const{listId:r,nestingLevel:i}=t,o=[...(n==null?void 0:n.get(r))||[]];o[i]=e,o.splice(i+1),n==null||n.set(r,o)}function Dpe(t){return{objectId:t.objectId,aLeft:0,aTop:0,width:0,height:0,angle:0,initialState:!1,drawingOrigin:t}}function DR(t){return t.pageNumber+1}function Ipe(t,e){if(e===Ln.UNSPECIFIED||e===Ln.LEFT)return;const{divides:n}=t,r=n.length;for(let i=0;i<r;i++){const o=n[i],{width:s}=o,a=nme(o);s!==1/0&&(e===Ln.CENTER?o.paddingLeft=(s-a)/2:e===Ln.RIGHT?o.paddingLeft=s-a:Ln.JUSTIFIED)}}let B6=class{constructor(){M(this,"_translateX",0),M(this,"_translateY",0),M(this,"_translateSaveList",[])}get x(){return this._translateX}get y(){return this._translateY}reset(){this.translateBy(0,0),this._translateSaveList=[]}translateBy(e=0,n=0){this._translateX=e,this._translateY=n}translate(e=0,n=0){this._translateX+=e,this._translateY+=n}translateSave(){this._translateSaveList.push({x:this._translateX,y:this._translateY})}translateRestore(){const e=this._translateSaveList.pop();e&&(this._translateX=e.x,this._translateY=e.y)}translatePagePadding(e){const{marginTop:n=0,marginBottom:r=0,marginLeft:i=0,marginRight:o=0}=e;this.translate(i,n)}restorePagePadding(e){const{marginTop:n=0,marginBottom:r=0,marginLeft:i=0,marginRight:o=0}=e;this.translate(-i,-n)}translatePage(e,n=Vs.VERTICAL,r=0,i=0,o=0,s=0){const{sections:a,marginTop:l=0,marginBottom:u=0,marginLeft:c=0,marginRight:d=0,pageWidth:h,pageHeight:f,width:m,height:p,pageNumber:g=1,renderConfig:v={}}=e;let _=0,C=0;return n===Vs.VERTICAL?_+=f+i:n===Vs.HORIZONTAL&&(C+=h+r),this.translate(C,_),{x:C,y:_}}translateSection(e){const{top:n=0}=e;return this.translate(0,n),{x:0,y:n}}translateColumn(e){const{left:n}=e;return this.translate(n,0),{x:n,y:0}}translateLine(e,n=!1){const{top:r,marginBottom:i=0,marginTop:o=0,paddingTop:s=0,paddingBottom:a=0}=e,l=r+(n===!0?o:0)+s;return this.translate(0,l),{x:0,y:l}}translateDivide(e){const{left:n,paddingLeft:r}=e,i=n+r;return this.translate(i,0),{x:i,y:0}}translateSpan(e){const{left:n}=e;return this.translate(n,0),{x:n,y:0}}};var T3=(t=>(t[t.page=0]="page",t[t.section=1]="section",t[t.column=2]="column",t[t.line=3]="line",t[t.divide=4]="divide",t[t.span=5]="span",t))(T3||{});const qc={page:0,section:1,column:2,line:3,divide:4,span:5};function CA(t,e){return t.page>e.page?!1:t.page<e.page?!0:t.section>e.section?!1:t.section<e.section?!0:t.column>e.column?!1:t.column<e.column?!0:t.line>e.line?!1:t.line<e.line?!0:t.divide>e.divide?!1:t.divide<e.divide?!0:t.span>e.span?!1:(t.span<e.span,!0)}function xv(t,e){return CA(t,e)?{start:t,end:e}:{start:e,end:t}}function IR(t){const e=t.length;if(e===0)return;const n=t[0],r=t[e-1],i=t.length===1&&n.collapsed;return{startOffset:n.startOffset,endOffset:r.endOffset,collapsed:i}}function xpe(t,e,n,r){let i=r,o=r;for(let s=0;s<t.length;s++){const a=t[s].count;s<e&&(i+=a),s<n&&(o+=a)}return{startOffset:i,endOffset:o}}let Mv=class{constructor(e,n){M(this,"_liquid",new B6),M(this,"_currentStartState",{page:0,section:0,column:0,line:0,divide:0,span:0}),M(this,"_currentEndState",{page:0,section:0,column:0,line:0,divide:0,span:0}),this._documentOffsetConfig=e,this._docSkeleton=n}getRangePointData(e,n){const r=[],i=[],o=[];if(e==null||n==null)return{borderBoxPointGroup:r,contentBoxPointGroup:i,cursorList:o};const{start:s,end:a}=xv(e,n);return this._selectionIterator(s,a,(l,u,c,d,h,f)=>{const{lineHeight:m,marginTop:p,contentHeight:g}=f,{spanGroup:v,st:_}=h,{x:C,y}=this._liquid;let S,E;const w=v[l],R=v[u],D=(w==null?void 0:w.left)||0,I=(w==null?void 0:w.width)||0,k=(R==null?void 0:R.left)||0,O=(R==null?void 0:R.width)||0,$=(w==null?void 0:w.spanType)===bo.LIST,{startOffset:N,endOffset:H}=xpe(v,l,u,_),X=s.span===l&&c?s.isBack:!0,te=a.span===u&&d?a.isBack:!1,z=s===a;if(l===0&&u===v.length-1)S={startX:C+D+($?I:0),startY:y,endX:C+k+O,endY:y+m},E={startX:C+D+($?I:0),startY:y+p,endX:C+k+O,endY:y+p+g};else{const A=X&&!$;S={startX:C+D+(A?0:I),startY:y,endX:C+k+(te?0:O),endY:y+m},E={startX:C+D+(A?0:I),startY:y+p,endX:C+k+(te?0:O),endY:y+p+g}}r.push(this._pushToPoints(S)),i.push(this._pushToPoints(E)),o.push({startOffset:X?N:N+w.count,endOffset:te?H:H+R.count,collapsed:z})}),{borderBoxPointGroup:r,contentBoxPointGroup:i,cursorList:o}}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}_setNodePositionState(e=0,n,r,i){i===n?this._currentStartState[e]=1:this._currentStartState[e]=0,i===r?this._currentEndState[e]=2:this._currentEndState[e]=0}_checkPreviousNodePositionState(e,n=!0){let r=e,i;for(;r>=0;){const o=T3[r];let s;if(n?s=this._currentStartState[o]:s=this._currentEndState[o],s===void 0)return;if(i===void 0&&(i=s),s!==i)return 0;r--}return i}_getSelectionRuler(e,n,r,i,o){let s=0,a=i;const l=T3[e],u=T3[e+1];if(u===null||l===null)return{start_next:s,end_next:a};const c=n[l],d=r[l];this._setNodePositionState(l,c,d,o);const h=this._checkPreviousNodePositionState(e),f=this._checkPreviousNodePositionState(e,!1);return h===1&&(s=n[u]),f===2&&(a=r[u]),{start_next:s,end_next:a}}_pushToPoints(e){const{startX:n,startY:r,endX:i,endY:o}=e,s=[];return s.push({x:n,y:r}),s.push({x:i,y:r}),s.push({x:i,y:o}),s.push({x:n,y:o}),s.push({x:n,y:r}),s}_selectionIterator(e,n,r){const i=this._docSkeleton;if(!i)return[];this._liquid.reset();const o=i.getSkeletonData();if(o==null)return[];const s=o.pages,{page:a}=e,{page:l}=n;if(this._resetCurrentNodePositionState(),this._documentOffsetConfig==null)return[];const{pageLayoutType:u,pageMarginLeft:c,pageMarginTop:d}=this._documentOffsetConfig;for(let h=0;h<=a-1;h++){const f=s[h];this._liquid.translatePage(f,u,c,d)}for(let h=a;h<=l;h++){const f=s[h],m=f.sections,{start_next:p,end_next:g}=this._getSelectionRuler(qc.page,e,n,m.length-1,h);this._liquid.translateSave(),this._liquid.translatePagePadding(f);for(let v=p;v<=g;v++){const _=m[v],C=_.columns,{start_next:y,end_next:S}=this._getSelectionRuler(qc.section,e,n,C.length-1,v);this._liquid.translateSection(_);for(let E=y;E<=S;E++){const w=C[E],R=w.lines,{start_next:D,end_next:I}=this._getSelectionRuler(qc.column,e,n,R.length-1,E);this._liquid.translateColumn(w);for(let k=D;k<=I;k++){const O=R[k],{divides:$}=O,{start_next:N,end_next:H}=this._getSelectionRuler(qc.line,e,n,$.length-1,k);this._liquid.translateSave(),this._liquid.translateLine(O);for(let X=N;X<=H;X++){const te=$[X];this._liquid.translateSave(),this._liquid.translateDivide(te);const z=te.spanGroup,{start_next:A,end_next:T}=this._getSelectionRuler(qc.divide,e,n,z.length-1,X);let P=!1,K=!1;h===a&&v===p&&E===y&&k===D&&X===N&&(P=!0),h===l&&v===g&&E===S&&k===I&&X===H&&(K=!0),r&&r(A,T,P,K,te,O,w,_,f),this._liquid.translateRestore()}this._liquid.translateRestore()}}}this._liquid.translateRestore(),this._liquid.translatePage(f,u,c,d)}}};const Mpe=["hoverCursor","moveCursor","fillRule","globalCompositeOperation","paintFirst","stroke","strokeScaleEnabled","fill","fillAfterStrokeEnabled","hitStrokeWidth","strokeLineJoin","strokeLineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","shadowForStrokeEnabled","strokeDashArray","strokeDashOffset","strokeMiterLimit"];let g4=class extends X2{constructor(e,n){super(e),M(this,"_hoverCursor"),M(this,"_moveCursor",null),M(this,"_fillRule","nonzero"),M(this,"_globalCompositeOperation","source-over"),M(this,"_paintFirst","fill"),M(this,"_stroke"),M(this,"_strokeScaleEnabled",!1),M(this,"_fill"),M(this,"_fillAfterStrokeEnabled",!1),M(this,"_hitStrokeWidth",0),M(this,"_strokeLineJoin","round"),M(this,"_strokeLineCap","round"),M(this,"_shadowColor"),M(this,"_shadowBlur",0),M(this,"_shadowOffset"),M(this,"_shadowOffsetX",0),M(this,"_shadowOffsetY",0),M(this,"_shadowOpacity",0),M(this,"_shadowEnabled",!1),M(this,"_shadowForStrokeEnabled",!1),M(this,"_strokeDashArray"),M(this,"_strokeDashOffset",0),M(this,"_strokeMiterLimit",0),M(this,"_type",Nk.RECT),this._initialProps(n)}get hoverCursor(){return this._hoverCursor}get moveCursor(){return this._moveCursor}get fillRule(){return this._fillRule}get globalCompositeOperation(){return this._globalCompositeOperation}get paintFirst(){return this._paintFirst}get stroke(){return this._stroke}get strokeScaleEnabled(){return this._strokeScaleEnabled}get fill(){return this._fill}get fillAfterStrokeEnabled(){return this._fillAfterStrokeEnabled}get hitStrokeWidth(){return this._hitStrokeWidth}get strokeLineJoin(){return this._strokeLineJoin}get strokeLineCap(){return this._strokeLineCap}get shadowColor(){return this._shadowColor}get shadowBlur(){return this._shadowBlur}get shadowOffset(){return this._shadowOffset}get shadowOffsetX(){return this._shadowOffsetX}get shadowOffsetY(){return this._shadowOffsetY}get shadowOpacity(){return this._shadowOpacity}get shadowEnabled(){return this._shadowEnabled}get shadowForStrokeEnabled(){return this._shadowForStrokeEnabled}get strokeDashArray(){return this._strokeDashArray}get strokeDashOffset(){return this._strokeDashOffset}get strokeMiterLimit(){return this._strokeMiterLimit}static drawWith(e,n){}static _renderPaintInOrder(e,n){n.paintFirst==="stroke"?(this._renderStroke(e,n),this._renderFill(e,n)):(this._renderFill(e,n),this._renderStroke(e,n))}static _renderFill(e,n){n.fill&&(e.save(),this.__setFillStyles(e,n),n.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}static _renderStroke(e,n){const{stroke:r,strokeWidth:i,shadowEnabled:o,shadowForStrokeEnabled:s,strokeScaleEnabled:a,parent:l}=n;let{scaleX:u,scaleY:c}=n;if(!(!r||i===0)){if(o&&!s&&this.__removeShadow(e),e.save(),a&&l){const d=this.__getObjectScaling();e.scale(1/d.scaleX,1/d.scaleY)}else a&&(u=u??1,c=c??1,e.scale(1/u,1/c));this.__setLineDash(e),this.__setStrokeStyles(e,n),e.stroke(),e.restore()}}static __getObjectScaling(){return{scaleX:1,scaleY:1}}static __removeShadow(e){}static __setFillStyles(e,n){e.fillStyle=n.fill}static __setStrokeStyles(e,n){const{strokeWidth:r,strokeLineCap:i,strokeDashOffset:o,strokeLineJoin:s,strokeMiterLimit:a,stroke:l}=n;e.lineWidth=r,e.lineCap=i,e.lineDashOffset=o,e.lineJoin=s,e.miterLimit=a,e.strokeStyle=l}static __setLineDash(e){}render(e,n){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{top:i,left:o,bottom:s,right:a}=n.viewBound;if(this.width+this.strokeWidth<o||a<0||this.height+this.strokeWidth<i||s<0)return this}const r=this.transform.getMatrix();return e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._draw(e),e.restore(),this.makeDirty(!1),this}setProps(e){if(!e)return;const n=Object.keys(e);if(n.length!==0)return n.forEach(r=>{if(e[r]===void 0)return!0;Ev.indexOf(r)===-1&&(this[`_${r}`]=e[r])}),this.makeDirty(!0),this}toJson(){const e={};return Mpe.forEach(n=>{this[n]&&(e[n]=this[n])}),{...super.toJson(),...e}}_draw(e){}_initialProps(e){if(!e)return;const n=Object.keys(e);if(n.length===0)return;const r={};let i=!1;n.forEach(o=>{if(e[o]===void 0)return!0;Ev.indexOf(o)>-1?(r[o]=e[o],i=!0):this[`_${o}`]=e[o]}),i&&this.transformByState(r),this.makeDirty(!0)}};const Ope=["radius"];let qt=class yA extends g4{constructor(e,n){super(e,n),M(this,"_radius",0),n!=null&&n.radius&&(this._radius=n.radius)}get radius(){return this._radius}static drawWith(e,n){let{radius:r,width:i,height:o}=n;if(r=r??0,i=i??30,o=o??30,e.beginPath(),n.strokeDashArray&&e.setLineDash(n.strokeDashArray),!r)e.rect(0,0,i,o);else{let s=0,a=0,l=0,u=0;s=a=l=u=Math.min(r,i/2,o/2),e.moveTo(s,0),e.lineTo(i-a,0),e.arc(i-a,a,a,Math.PI*3/2,0,!1),e.lineTo(i,o-u),e.arc(i-u,o-u,u,0,Math.PI/2,!1),e.lineTo(l,o),e.arc(l,o-l,l,Math.PI/2,Math.PI,!1),e.lineTo(0,s),e.arc(s,s,s,Math.PI,Math.PI*3/2,!1)}e.closePath(),this._renderPaintInOrder(e,n)}toJson(){const e={};return Ope.forEach(n=>{this[n]&&(e[n]=this[n])}),{...super.toJson(),...e}}_draw(e){yA.drawWith(e,this)}};const Tpe=["pointsGroup"];let v2=class SA extends g4{constructor(e,n){super(e,n),M(this,"_pointsGroup"),this._pointsGroup=(n==null?void 0:n.pointsGroup)||[[]],this._setFixBoundingBox(),this.onTransformChangeObservable.add(r=>{const{type:i,value:o,preValue:s}=r;(i===lo.resize||i===lo.all)&&this.resizePolygon(s)})}get pointsGroup(){return this._pointsGroup}static drawWith(e,n){let{pointsGroup:r}=n;r=r??[[]],n.strokeDashArray&&e.setLineDash(n.strokeDashArray),e.beginPath();for(const i of r){e.moveTo(i[0].x,i[0].y);for(let o=1;o<i.length;o++){const s=i[o];e.lineTo(s.x,s.y)}}e.closePath(),this._renderPaintInOrder(e,n)}updatePointGroup(e){this._pointsGroup=e,this._setFixBoundingBox()}resizePolygon(e){const{left:n,top:r,width:i,height:o}=this._getSelfRect(),{width:s,height:a}=e;let l,u;s?l=this.width-s:l=0,a?u=this.height-a:u=0;const c=l/i,d=u/o;this.scaleX+=c,this.scaleY+=d,this.left=this.left-n*c,this.top=this.top-r*d,this._setTransForm()}toJson(){const e={};return Tpe.forEach(n=>{this[n]&&(e[n]=this[n])}),{...super.toJson(),...e}}getState(){const{left:e,top:n,width:r,height:i}=this.getRect();return{left:e,top:n,width:r,height:i,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:e,top:n,width:r,height:i}=this._getSelfRect();return{left:e*this.scaleX+this.left,top:n*this.scaleY+this.top,width:r*this.scaleX,height:i*this.scaleY}}_draw(e){SA.drawWith(e,this)}_setFixBoundingBox(){const{width:e,height:n,left:r,top:i}=this._getSelfRect();this.left=this.left+r,this.top=this.top+i,this.width=e,this.height=n;const o=this.pointsGroup;for(const s of o)for(const a of s)a.x-=r,a.y-=i;this._setTransForm()}_getSelfRect(){const e=this.pointsGroup;let n=e[0][0].x,r=e[0][0].x,i=e[0][0].y,o=e[0][0].y;for(const s of e)for(const a of s)n=Math.min(n,a.x),r=Math.max(r,a.x),i=Math.min(i,a.y),o=Math.max(o,a.y);return{left:n,top:i,width:r-n,height:o-i}}};const $pe="__TestSelectionRange__",kpe="__TestSelectionAnchor__",xR=6;function Ape(t,e,n,r){const{startOffset:i,endOffset:o,style:s=N6}=e,a=n.findNodePositionByCharIndex(i),l=i!==o?n.findNodePositionByCharIndex(o):null,u=new Ov(t,r,n,a,l,s);return u.refresh(),u}let Ov=class{constructor(e,n,r,i,o,s=N6){M(this,"_current",!1),M(this,"_rangeShape"),M(this,"_anchorShape"),M(this,"_cursorList",[]),this._scene=e,this._documentOffsetConfig=n,this._docSkeleton=r,this.anchorNodePosition=i,this.focusNodePosition=o,this.style=s}get startOffset(){const{startOffset:e}=IR(this._cursorList)??{},n=this._docSkeleton.getViewModel().getBody();if(e==null||n==null)return e;const r=n.dataStream.length-2;return Math.min(r,e)}get endOffset(){const{endOffset:e}=IR(this._cursorList)??{},n=this._docSkeleton.getViewModel().getBody();if(e==null||n==null)return e;const r=n.dataStream.length-2;return Math.min(e,r)}get collapsed(){const{startOffset:e,endOffset:n}=this;return e!=null&&e===n}get startNodePosition(){if(this.anchorNodePosition==null)return null;if(this.focusNodePosition==null)return this.anchorNodePosition;const{start:e}=xv(this.anchorNodePosition,this.focusNodePosition);return e}get endNodePosition(){if(this.anchorNodePosition==null)return this.focusNodePosition;if(this.focusNodePosition==null)return null;const{end:e}=xv(this.anchorNodePosition,this.focusNodePosition);return e}get direction(){const{collapsed:e,anchorNodePosition:n,focusNodePosition:r}=this;return e||n==null||r==null?O2.NONE:CA(n,r)?O2.FORWARD:O2.BACKWARD}getAnchor(){return this._anchorShape}activeStatic(){var e,n;(n=this._anchorShape)==null||n.setProps({stroke:((e=this.style)==null?void 0:e.strokeActive)||ls(e2.black,1)})}deactivateStatic(){var e,n;(n=this._anchorShape)==null||n.setProps({stroke:((e=this.style)==null?void 0:e.stroke)||ls(e2.black,0)})}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var e,n;(e=this._rangeShape)==null||e.dispose(),this._rangeShape=null,(n=this._anchorShape)==null||n.dispose(),this._anchorShape=null}isIntersection(e){const{startOffset:n,endOffset:r}=this,{startOffset:i,endOffset:o}=e;return n==null||r==null||i==null||o==null?!1:n<=o&&r>=i}refresh(){var e,n;const{_documentOffsetConfig:r,_docSkeleton:i}=this,o=this.anchorNodePosition,s=this.focusNodePosition;if((e=this._anchorShape)==null||e.hide(),(n=this._rangeShape)==null||n.hide(),this._isEmpty())return;const{docsLeft:a,docsTop:l}=r,u=new Mv(r,i);if(this._isCollapsed()){const{contentBoxPointGroup:h,cursorList:f}=u.getRangePointData(o,o);this._setCursorList(f),h.length>0&&this._createOrUpdateAnchor(h,a,l);return}const{borderBoxPointGroup:c,cursorList:d}=u.getRangePointData(o,s);this._setCursorList(d),c.length>0&&this._createOrUpdateRange(c,a,l)}_isEmpty(){return this.anchorNodePosition==null&&this.focusNodePosition==null}_isCollapsed(){const e=this.anchorNodePosition,n=this.focusNodePosition;if(e!=null&&n==null)return!0;if(e==null||n==null)return!1;const r=Object.keys(qc);for(const i of r){const o=e[i],s=n[i];if(o!==s)return!1}return e.isBack===n.isBack}_createOrUpdateRange(e,n,r){var i;if(this._rangeShape){this._rangeShape.translate(n,r),this._rangeShape.updatePointGroup(e),this._rangeShape.show();return}const o=.2,s=new v2($pe+De.generateRandomId(xR),{pointsGroup:e,fill:((i=this.style)==null?void 0:i.fill)||ls(e2.black,o),left:n,top:r,evented:!1,debounceParentDirty:!1});this._rangeShape=s,this._scene.addObject(s,2)}_getAnchorBounding(e){const n=e[0],r=n[0],i=n[2],{x:o,y:s}=r,{x:a,y:l}=i;return{left:o,top:s,width:a-o,height:l-s}}_createOrUpdateAnchor(e,n,r){var i,o;const s=this._getAnchorBounding(e),{left:a,top:l,height:u}=s;if(this._anchorShape){this._anchorShape.transformByState({left:a+n,top:l+r,height:u}),this._anchorShape.show();return}const c=new qt(kpe+De.generateRandomId(xR),{left:a+n,top:l+r,height:u,strokeWidth:((i=this.style)==null?void 0:i.strokeWidth)||1,stroke:((o=this.style)==null?void 0:o.stroke)||ls(e2.black,0),evented:!1});this._anchorShape=c,this._scene.addObject(c,2)}_setCursorList(e){e.length!==0&&(this._cursorList=e)}};var Npe=Object.defineProperty,Lpe=Object.getOwnPropertyDescriptor,Ppe=(t,e,n,r)=>{for(var i=r>1?void 0:r?Lpe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Npe(e,n,i),i},Bpe=(t,e)=>(n,r)=>e(n,r,t);let n5=class extends je{constructor(e){super(),M(this,"_fontLocale"),M(this,"_dirty",!0),this._localService=e,this._localeInitial()}get dirty(){return this._dirty}getFontLocale(){return this._fontLocale}makeDirty(e){this._dirty=e}_localeInitial(){}};n5=Ppe([Bpe(0,ne(mn))],n5);const Fpe={columnProperties:[],columnSeparatorType:a6.NONE,sectionType:lh.SECTION_TYPE_UNSPECIFIED,startIndex:0};let Tv=class EA extends n5{constructor(e,n){super(n),M(this,"_skeletonData"),M(this,"_renderedBlockIdMap",new Map),M(this,"_findLiquid",new B6),this._docViewModel=e}static create(e,n){return new EA(e,n)}getViewModel(){return this._docViewModel}calculate(e){this.dirty&&(this._skeletonData=this._createSkeleton(e))}getSkeletonData(){return this._skeletonData}getActualSize(){const e=this.getSkeletonData();let n=-1/0,r=0;return e==null||e.pages.forEach(i=>{const{width:o,height:s}=i;n=Math.max(n,o),r+=s}),{actualWidth:n,actualHeight:r}}_getPageActualWidth(e){let n=-1/0;for(const r of e.sections)for(const i of r.columns)for(const o of i.lines){let s=0;for(const a of o.divides)for(const l of a.spanGroup)s+=l.width;n=Math.max(n,s)}return n}getPageSize(){return this.getViewModel().getDataModel().documentStyle.pageSize}findPositionBySpan(e){const n=e.parent,r=n==null?void 0:n.parent,i=r==null?void 0:r.parent,o=i==null?void 0:i.parent,s=o==null?void 0:o.parent,a=this.getSkeletonData();if(!n||!i||!o||!s||!a)return;const l=n.spanGroup.indexOf(e),u=r.divides.indexOf(n),c=i.lines.indexOf(r),d=o.columns.indexOf(i),h=s.sections.indexOf(o),f=a.pages.indexOf(s);return{span:l,divide:u,line:c,column:d,section:h,page:f}}findNodePositionByCharIndex(e,n=!0){const r=this._findNodeIterator(e);if(r==null)return;const i=this.getSkeletonData();if(!i)return;const o=i.pages,{span:s,divide:a,line:l,column:u,section:c,page:d}=r;return{span:a.spanGroup.indexOf(s),divide:l.divides.indexOf(a),line:u.lines.indexOf(l),column:c.columns.indexOf(u),section:d.sections.indexOf(c),page:o.indexOf(d),isBack:n}}findNodeByCharIndex(e){const n=this._findNodeIterator(e);return n==null?void 0:n.span}findSpanByPosition(e){if(e==null)return;const n=this.getSkeletonData();if(n==null)return;const{divide:r,line:i,column:o,section:s,page:a,isBack:l}=e;let{span:u}=e;l===!0&&(u-=1),u=u<0?0:u;const c=n.pages[a].sections[s].columns[o].lines[i].divides[r].spanGroup;return c[u].spanType===bo.LIST?c[u+1]:c[u]}findNodeByCoord(e,n,r,i){const{x:o,y:s}=e;this._findLiquid.reset();const a=this.getSkeletonData();if(a==null)return;const l=a.pages;let u=[],c=[],d=1/0;for(let h=0,f=l.length;h<f;h++){const m=l[h];this._findLiquid.translatePagePadding(m);const p=m.sections;for(const g of p){const{columns:v,height:_}=g;this._findLiquid.translateSection(g);for(const C of v){const{lines:y,width:S}=C;this._findLiquid.translateColumn(C);const E=y.length;for(let w=0;w<E;w++){const R=y[w],{divides:D,type:I,lineHeight:k=0}=R;if(I!==N9.BLOCK){this._findLiquid.translateSave(),this._findLiquid.translateLine(R);const{y:O}=this._findLiquid,$=O,N=O+k,H=Math.abs(s-N),X=D.length;for(let te=0;te<X;te++){const z=D[te],{spanGroup:A,width:T}=z;this._findLiquid.translateSave(),this._findLiquid.translateDivide(z);const{x:P}=this._findLiquid;for(const K of A){if(!K.content||K.content.length===0)continue;const{width:ee,left:ue}=K,fe=P+ue,Ee=P+ue+ee,Q=Math.abs(o-Ee);if(s>=$&&s<=N){if(o>=fe&&o<=Ee)return{node:K,ratioX:o/(fe+Ee),ratioY:s/($+N)};d!==-1/0&&(u=[],c=[]),u.push({node:K,ratioX:o/(fe+Ee),ratioY:s/($+N)}),c.push(Q),d=-1/0;continue}H<d&&(d=H,u=[],c=[]),H===d&&(u.push({node:K,ratioX:o/(fe+Ee),ratioY:s/($+N)}),c.push(Q))}this._findLiquid.translateRestore()}this._findLiquid.translateRestore()}}}}this._findLiquid.restorePagePadding(m),this._translatePage(m,n,r,i)}return this._getNearestNode(u,c)}_getNearestNode(e,n){const r=Math.min(...n),i=n.indexOf(r);return e[i]}_getPageBoundingBox(e,n){const{pageWidth:r,pageHeight:i}=e,{x:o,y:s}=this._findLiquid;let a=-1,l=-1;return n===Vs.VERTICAL?(a=r,l=s+i):n===Vs.HORIZONTAL&&(a=o+r,l=i),{startX:o,startY:s,endX:a,endY:l}}_translatePage(e,n,r,i){this._findLiquid.translatePage(e,n,r,i)}_createSkeleton(e){var n;const r={width:1/0,height:1/0},i=this.getViewModel(),{headerTreeMap:o,footerTreeMap:s}=i,{documentStyle:a,drawings:l,lists:u={}}=i.getDataModel(),c={...sj,...u},{pageNumberStart:d=1,pageSize:h=r,pageOrient:f=H5.PORTRAIT,defaultHeaderId:m,defaultFooterId:p,evenPageHeaderId:g,evenPageFooterId:v,firstPageHeaderId:_,firstPageFooterId:C,useFirstPageHeaderFooter:y,useEvenPageHeaderFooter:S,marginTop:E=0,marginBottom:w=0,marginRight:R=0,marginLeft:D=0,marginHeader:I=0,marginFooter:k=0,charSpace:O=0,linePitch:$=15.6,gridType:N=fo.LINES,paragraphLineGapDefault:H=0,defaultTabStop:X=10.5,textStyle:te={fs:14},renderConfig:z={horizontalAlign:Ln.UNSPECIFIED,verticalAlign:Kr.UNSPECIFIED,centerAngle:0,vertexAngle:0,wrapStrategy:yr.UNSPECIFIED}}=a,A=this._getNullSke(),T={headerTreeMap:o,footerTreeMap:s,lists:c,drawings:l,charSpace:O,linePitch:$,gridType:N,localeService:this._localService,paragraphLineGapDefault:H,defaultTabStop:X,documentTextStyle:te},{skeHeaders:P,skeFooters:K,skeListLevel:ee,drawingAnchor:ue}=A,fe={skeHeaders:P,skeFooters:K,skeListLevel:ee,drawingAnchor:ue},Ee=[];A.pages=Ee;const Q=this.getViewModel();Q.resetCache();for(let re=0,Se=Q.children.length;re<Se;re++){const _e=Q.children[re],He=Q.getSectionBreak(_e.endIndex)||Fpe,{pageNumberStart:Ne=d,pageSize:we=h,pageOrient:Me=f,marginTop:mt=E,marginBottom:vt=w,marginRight:ft=R,marginLeft:et=D,marginHeader:ve=I,marginFooter:Pe=k,defaultHeaderId:Ye=m,defaultFooterId:bt=p,evenPageHeaderId:Jt=g,evenPageFooterId:Ht=v,firstPageHeaderId:Zt=_,firstPageFooterId:kt=C,useFirstPageHeaderFooter:gn=y,useEvenPageHeaderFooter:vn=S,columnProperties:Xt=[],columnSeparatorType:Vt=a6.NONE,contentDirection:jt,sectionType:Nt,textDirection:Bn,renderConfig:W=z}=He,j=Q.children[re+1],q=(n=Q.getSectionBreak(j==null?void 0:j.endIndex))==null?void 0:n.sectionType,pe={defaultHeaderId:Ye,evenPageHeaderId:Jt,firstPageHeaderId:Zt},Ae={defaultFooterId:bt,evenPageFooterId:Ht,firstPageFooterId:kt};we.width===null&&(we.width=1/0),we.height===null&&(we.height=1/0);const We={pageNumberStart:Ne,pageSize:we,pageOrient:Me,marginTop:mt,marginBottom:vt,marginRight:ft,marginLeft:et,marginHeader:ve,marginFooter:Pe,headerIds:pe,footerIds:Ae,useFirstPageHeaderFooter:gn,useEvenPageHeaderFooter:vn,columnProperties:Xt,columnSeparatorType:Vt,contentDirection:jt,sectionType:Nt,sectionTypeNext:q,textDirection:Bn,renderConfig:W,...T};let Re=Y2(Ee),Te=!1;Nt===lh.CONTINUOUS?(wv(Ee),this._addNewSectionByContinuous(Re,Xt,Vt),Te=!0):Re=L6(We,fe,Re==null?void 0:Re.pageNumber);const G=nA(Q,_e,Re,We,fe,this._renderedBlockIdMap);q===lh.CONTINUOUS&&Xt.length>0;const{pages:be}=G;Te&&be.splice(0,1),Ee.push(...be)}return wv(Ee),this._setPageParent(Ee,A),A}_setPageParent(e,n){for(const r of e)r.parent=n}_addNewSectionByContinuous(e,n,r){const i=e.sections,o=i[i.length-1],{pageWidth:s,pageHeight:a,marginTop:l,marginBottom:u,marginLeft:c,marginRight:d}=e,h=s-c-d,f=a-l-u,m=((o==null?void 0:o.top)||0)+((o==null?void 0:o.height)||0),p=rA(n,r,m,0,h,f-m);p.parent=e,i.push(p)}_getNullSke(){return{pages:[],left:0,top:0,st:0,skeHeaders:new Map,skeFooters:new Map,skeListLevel:new Map,drawingAnchor:new Map}}_findNodeIterator(e){const n=this.getSkeletonData();if(!n)return;const r=n.pages;for(const i of r){const{sections:o,st:s,ed:a}=i;if(!(e<s||e>a))for(const l of o){const{columns:u,st:c,ed:d}=l;if(!(e<c||e>d))for(const h of u){const{lines:f,st:m,ed:p}=h;if(!(e<m||e>p))for(const g of f){const{divides:v,st:_,ed:C}=g,y=v.length;if(!(e<_||e>C))for(let S=0;S<y;S++){const E=v[S],{spanGroup:w,st:R,ed:D}=E;if(e<R||e>D)continue;let I=e-R;for(const k of w)if(I-=k.count,I<0)return{page:i,section:l,column:h,line:g,divide:E,span:k}}}}}}}};class wA{constructor(){M(this,"uKey",""),M(this,"type"),M(this,"zIndex",0),M(this,"parent"),M(this,"translateX",0),M(this,"translateY",0),M(this,"extensionOffset",{})}draw(e,n,r,i){}clearCache(){}_getScale(e){return A9(e)}}const P9=B5.create(),RA=B5.create(),DA=B5.create(),v4=B5.create();var $v=(t=>(t[t.SPAN=0]="SPAN",t[t.LINE=1]="LINE",t))($v||{});let B9=class extends wA{constructor(){super(...arguments),M(this,"type",0),M(this,"translateX",0),M(this,"translateY",0)}};const Upe="DefaultDocsBackgroundExtension",Hpe=10;let Vpe=class extends B9{constructor(){super(...arguments),M(this,"uKey",Upe),M(this,"zIndex",Hpe),M(this,"_preBackgroundColor","")}draw(e,n,r){var i;const o=(i=r.parent)==null?void 0:i.parent;if(!o)return;const{contentHeight:s=0}=o,{ts:a,width:l}=r;if(!a)return;const{bg:u}=a;if(!u)return;const c=oo(u),{spanStartPoint:d=Ft.create(0,0)}=this.extensionOffset;c&&(e.fillStyle=c,e.fillRect(d.x-.5,d.y,l+1,s+1))}clearCache(){this._preBackgroundColor=""}};v4.add(new Vpe);const jpe="DefaultDocsBorderExtension";let zpe=class extends B9{constructor(){super(...arguments),M(this,"uKey",jpe),M(this,"zIndex",50),M(this,"_preBorderStyle"),M(this,"_preBorderColor","")}draw(e,n,r){var i;const o=(i=r.parent)==null?void 0:i.parent;if(!o)return;const{asc:s=0,lineHeight:a=0}=o,{ts:l,left:u,width:c}=r;if(!l)return;const{bd:d}=l;if(!d)return;const h=this._getScale(n),f=this._createBorderCache(d);e.save(),e.translate(ii/h,ii/h);const{spanStartPoint:m=Ft.create(0,0)}=this.extensionOffset;for(const p of f.keys()){const g=f.get(p);if(!g)continue;const{s:v,cl:_}=g,C=oo(_)||W2;v!==this._preBorderStyle&&(Gk(e,v),e.lineWidth=Kk(v)/h,this._preBorderStyle=v),C!==this._preBorderColor&&(e.strokeStyle=C||W2,this._preBorderColor=C),Yk(e,p,{startX:Et(m.x,h),startY:Et(m.y,h),endX:Et(m.x+c,h),endY:Et(m.y+a,h)})}e.restore()}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t:n,b:r,l:i,r:o}=e,s=new Map;return n&&s.set(jn.TOP,n),r&&s.set(jn.BOTTOM,r),i&&s.set(jn.LEFT,i),o&&s.set(jn.RIGHT,o),s}};v4.add(new zpe);const Wpe="DefaultDocsFontAndBaseLineExtension",Xpe=20;let Ype=class extends B9{constructor(){super(...arguments),M(this,"uKey",Wpe),M(this,"zIndex",Xpe),M(this,"_preFontString",""),M(this,"_preFontColor","")}draw(e,n,r){var i;if(!((i=r.parent)!=null&&i.parent))return;const{ts:o,content:s,fontStyle:a,bBox:l}=r,{spanPointWithFont:u=Ft.create(0,0)}=this.extensionOffset;if(s==null)return;if(!o){this._fillText(e,r,u);return}this._preFontString!==(a==null?void 0:a.fontString)&&(e.font=this._preFontString=(a==null?void 0:a.fontString)||"");const{cl:c,va:d}=o,h=oo(c)||W2;if(h&&this._preFontColor!==h&&(e.fillStyle=h),d===Cr.SUBSCRIPT||d===Cr.SUPERSCRIPT){let f=0;d===Cr.SUPERSCRIPT&&(f=-l.sbo),u.y+=f}this._fillText(e,r,u)}_fillText(e,n,r){const{renderConfig:i,spanStartPoint:o,centerPoint:s}=this.extensionOffset,{content:a,width:l,bBox:u}=n,{aba:c,abd:d}=u;if(a==null||o==null||s==null)return;const{vertexAngle:h,centerAngle:f}=i??{},m=90;h===m&&f===m&&!PC(a)?(e.save(),e.translate(o.x+s.x,o.y+s.y),e.rotate(Math.PI/2),e.translate(-l/2,(c+d)/2-d),e.fillText(a,0,0),e.restore()):e.fillText(a,r.x,r.y)}clearCache(){this._preFontString="",this._preFontColor=""}};v4.add(new Ype);const Gpe="DefaultDocsLineExtension",Kpe=40;let Zpe=class extends B9{constructor(){super(...arguments),M(this,"uKey",Gpe),M(this,"zIndex",Kpe),M(this,"_preBackgroundColor","")}draw(e,n,r){var i;const o=(i=r.parent)==null?void 0:i.parent;if(!o)return;const{contentHeight:s=0}=o,{ts:a,bBox:l}=r;if(!a)return;const{sp:u}=l,c=A9(n),d=.5,{ul:h,st:f,ol:m}=a;if(h){const p=s+Qw-d;this._drawLine(e,r,h,p,c)}if(f){const p=u-d;this._drawLine(e,r,f,p,c)}if(m){const p=-Qw-d;this._drawLine(e,r,m,p,c)}}clearCache(){this._preBackgroundColor=""}_drawLine(e,n,r,i,o){const{s,cl:a,t:l}=r;if(s===ke.TRUE){const{originTranslate:u=Ft.create(0,0),alignOffset:c=Ft.create(0,0),renderConfig:d={}}=this.extensionOffset,{left:h,width:f}=n,{centerAngle:m=0,vertexAngle:p=0}=d,g=Cl(m),v=Cl(p);e.save(),e.translate(ii/o,ii/o),e.beginPath();const _=oo(a)||W2;e.strokeStyle=_,this._setLineType(e,l||Jr.SINGLE);const C=Jh(u.addByPoint(h,i),Ft.create(0,0),g,v,c),y=Jh(u.addByPoint(h+f,i),Ft.create(0,0),g,v,c);e.moveTo(Et(C.x,o),Et(C.y,o)),e.lineTo(Et(y.x,o),Et(y.y,o)),e.stroke(),e.restore()}}_setLineType(e,n){n===Jr.DASH_DOT_DOT_HEAVY||n===Jr.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):n===Jr.DASH_DOT_HEAVY||n===Jr.DOT_DASH?e.setLineDash([2,5,2]):n===Jr.DOTTED||n===Jr.DOTTED_HEAVY?e.setLineDash([2]):n===Jr.DASH||n===Jr.DASHED_HEAVY?e.setLineDash([3]):n===Jr.DASH_LONG||n===Jr.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let n=1;return e===Jr.WAVY_HEAVY||e===Jr.DASHED_HEAVY||e===Jr.DOTTED_HEAVY||e===Jr.DASH_DOT_HEAVY||e===Jr.DASH_LONG_HEAVY||e===Jr.DASH_DOT_DOT_HEAVY?n=2:e===Jr.THICK&&(n=3),n}};v4.add(new Zpe);let qpe=class extends qk{constructor(e,n){super(e),M(this,"pageMarginLeft",0),M(this,"pageMarginTop",0),M(this,"pageLayoutType",Vs.VERTICAL),this._skeleton=n}getSkeleton(){return this._skeleton}setSkeleton(e){this._skeleton=e}render(e,n){if(!this.visible)return this.makeDirty(!1),this;if(!this._skeleton)return;const r=this.transform.getMatrix();e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._draw(e,n),e.restore()}getParentScale(){if(!this.parent)return{scaleX:1,scaleY:1};let{scaleX:e=1,scaleY:n=1}=this.parent;return this.parent.classType===Bt.SCENE&&(e=this.parent.ancestorScaleX||1,n=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:n}}scrollBySelection(){}syncSelection(){}remainActiveSelection(){}findNodeByCoord(e,n){}findCoordByNode(e){}_getBounding(e){}_draw(e,n){}},IA=class xA extends qpe{constructor(e,n,r){super(e,n),M(this,"onPageRenderObservable",new Sn),M(this,"docsLeft",0),M(this,"docsTop",0),M(this,"_drawLiquid"),M(this,"_findLiquid"),M(this,"_skeletonObserver"),this.setConfig(r),this._drawLiquid=new B6,this._findLiquid=new B6,this._initialDefaultExtension(),this.makeDirty(!0)}static create(e,n,r){return new xA(e,n,r)}setConfig(e){this.pageMarginLeft=(e==null?void 0:e.pageMarginLeft)||17,this.pageMarginTop=(e==null?void 0:e.pageMarginTop)||14,this.pageLayoutType=(e==null?void 0:e.pageLayoutType)||Vs.VERTICAL}getOffsetConfig(){const{transform:e,pageLayoutType:n,pageMarginLeft:r,pageMarginTop:i,left:o,top:s}=this;return{documentTransform:e,pageLayoutType:n,pageMarginLeft:r,pageMarginTop:i,docsLeft:o,docsTop:s}}getEngine(){return this.getScene().getEngine()}draw(e,n){var r;if(!this.getSkeleton())return;this._drawLiquid.reset();const i=(r=this.getSkeleton())==null?void 0:r.getSkeletonData();if(i==null)return;this._drawLiquid.reset();const{pages:o}=i,s=this.getParentScale(),a=A9(s),l=this.getExtensionsByOrder();for(const d of l)d.clearCache();let u=0,c=0;for(let d=0,h=o.length;d<h;d++){const f=o[d],{sections:m,marginTop:p=0,marginBottom:g=0,marginLeft:v=0,marginRight:_=0,width:C,height:y,renderConfig:S={}}=f,{verticalAlign:E=Kr.TOP,horizontalAlign:w=Ln.LEFT,centerAngle:R=0,vertexAngle:D=0,wrapStrategy:I=yr.UNSPECIFIED}=S,k=this._horizontalHandler(C*a,v*a,_*a,w),O=this._verticalHandler(y*a,p*a,g*a,E),$=Ft.create(k/a,O/a),N=Cl(R),H=Cl(D),X=H-N;this.onPageRenderObservable.notifyObservers({page:f,pageLeft:c,pageTop:u,ctx:e}),this._startRotation(e,X);for(const A of m){const{columns:T}=A;this._drawLiquid.translateSection(A);for(const P of T){const{lines:K,width:ee}=P;this._drawLiquid.translateColumn(P);const ue=K.length;let fe=$,Ee=null;if(H!==0){const{rotateTranslateXList:Q,rotatedHeight:re,rotatedWidth:Se,fixOffsetX:_e,fixOffsetY:He,rotateTranslateY:Ne}=Zk(K,ee,H);let we=Se;re>this.height&&I!==yr.WRAP&&(I===yr.OVERFLOW||H>0)&&(we=this.height/Math.tan(Math.abs(H)));const Me=this._horizontalHandler(we,v,_,w);let mt=this._verticalHandler(re,p,g,E)-He;re>this.height&&(H<0?mt=this.height-(re+He):mt=-He),fe=Ft.create(Me+_e,mt),this._drawLiquid.translate(0,-Ne),Ee=Q}else I===yr.WRAP&&(fe.x=v*a);for(let Q=0;Q<ue;Q++){const re=K[Q],{divides:Se,asc:_e=0,type:He,lineHeight:Ne=0}=re,we=_e,Me=we*Math.sin(N),mt=we*Math.cos(N);if(He===N9.BLOCK)for(const vt of l)vt.type===$v.LINE&&(vt.extensionOffset={alignOffset:fe,renderConfig:S},vt.draw(e,s,re));else{this._drawLiquid.translateSave(),this._drawLiquid.translateLine(re,!0),Ee&&this._drawLiquid.translate(Ee[Q]);const vt=Se.length;for(let ft=0;ft<vt;ft++){const et=Se[ft],{spanGroup:ve}=et;this._drawLiquid.translateSave(),this._drawLiquid.translateDivide(et);for(const Pe of ve){if(!Pe.content||Pe.content.length===0)continue;const{width:Ye,left:bt,paddingLeft:Jt}=Pe,{x:Ht,y:Zt}=this._drawLiquid,kt=Ft.create(Ht,Zt),gn=Ft.create(Ye/2,Ne/2),vn=Jh(kt.addByPoint(bt+Jt,0),gn,N,H,fe),Xt=Jh(kt.addByPoint(bt+Me+Jt,mt),gn,N,H,fe),Vt={originTranslate:kt,spanStartPoint:vn,spanPointWithFont:Xt,centerPoint:gn,alignOffset:fe,renderConfig:S};for(const jt of l)jt.type===$v.SPAN&&(jt.extensionOffset=Vt,jt.draw(e,s,Pe))}this._drawLiquid.translateRestore()}this._drawLiquid.translateRestore()}}}}this._resetRotation(e,X);const{x:te,y:z}=this._drawLiquid.translatePage(f,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop);c+=te,u+=z}}changeSkeleton(e){return this.setSkeleton(e),this}_draw(e,n){this.draw(e,n)}_horizontalHandler(e,n,r,i){let o=0;return i===Ln.CENTER?o=(this.width-e)/2:i===Ln.RIGHT?o=this.width-e-r:o=n,o}_verticalHandler(e,n,r,i){let o=0;return i===Kr.MIDDLE?o=(this.height-e)/2:i===Kr.BOTTOM?o=this.height-e-r:o=n,o}_startRotation(e,n){e.rotate(n||0)}_resetRotation(e,n){e.rotate(-n||0)}_initialDefaultExtension(){v4.getData().forEach(e=>{this.register(e)})}};function Qpe(t){const e=t.getBoundingClientRect(),n=document.body,r=document.documentElement,i=window.pageYOffset||r.scrollTop||n.scrollTop,o=window.pageXOffset||r.scrollLeft||n.scrollLeft,s=r.clientTop||n.clientTop,a=r.clientLeft||n.clientLeft,l=e.top+i-s,u=e.left+o-a;return{top:l,left:u}}var r5=(t=>(t[t.ALL=0]="ALL",t[t.X=1]="X",t[t.Y=2]="Y",t[t.NONE=3]="NONE",t))(r5||{});let yl=class MA{constructor(e,n=0,r,i=.4,o=.1){M(this,"_requestNewFrameNumber",-1),M(this,"_viewport"),M(this,"_offsetX",0),M(this,"_offsetY",0),M(this,"_moveX",0),M(this,"_moveY",0),M(this,"_scrollX",0),M(this,"_scrollY",0),M(this,"_scrollFunction"),this._scene=e,this._scrollTimerType=n,this._padding=r,this._smoothRatioX=i,this._smoothRatioY=o,this._padding||(this._padding={t:0,b:15,l:0,r:60})}static create(e,n=0,r){return new MA(e,n,r)}startScroll(e,n,r){this._offsetX=e,this._offsetY=n,this._moveX=e,this._moveY=n,r!=null?this._viewport=r:this._viewport=this.getViewportByCoord(this._scene),this._runRenderLoop()}_scroll(e){const n=(e==null?void 0:e.top)||0,r=n+((e==null?void 0:e.height)||0),i=(e==null?void 0:e.left)||0,o=i+((e==null?void 0:e.width)||0),{t:s=0,b:a=0,r:l=0,l:u=0}=this._padding;let c=0,d=0,h=!1;if(this._scrollTimerType!==2&&(this._moveX<i+u&&(c=(this._moveX-i-u)*this._smoothRatioX,h=!0),this._moveX>o-l&&(c=(this._moveX-o+l)*this._smoothRatioX,h=!0)),this._scrollTimerType!==1&&(this._moveY<n+s&&(d=(this._moveY-n-s)*this._smoothRatioY,h=!0),this._moveY>r-a&&(d=(this._moveY-r+a)*this._smoothRatioY,h=!0)),!h)return;const f=e==null?void 0:e.scrollBy({x:c,y:d}),m=e==null?void 0:e.getActualScroll(c,d);if(this._scrollX=(m==null?void 0:m.x)||0,this._scrollY=(m==null?void 0:m.y)||0,f){const p=this._findAncestorScene(e==null?void 0:e.scene),g=this.getViewportByCoord(p);g&&this._scroll(g)}}scrolling(e,n,r){this._moveX=e,this._moveY=n,this._scrollFunction=r}stopScroll(){sfe(this._requestNewFrameNumber)}dispose(){this.stopScroll(),delete this._scrollFunction}getViewportByCoord(e){return e==null?void 0:e.getActiveViewportByRelativeCoord(Ft.FromArray([this._offsetX,this._offsetY]))}getScene(){return this._scene}_runRenderLoop(){this._scroll(this._viewport),this._scrollFunction&&this._scrollFunction(this._scrollX,this._scrollY),this._requestNewFrameNumber=qh(this._runRenderLoop.bind(this))}_findAncestorScene(e){let n=e==null?void 0:e.getParent();for(;n;){if(n.classType===Bt.SCENE)return n;n=(n==null?void 0:n.getParent)&&(n==null?void 0:n.getParent())}}};function OA(t){const e=t==null?void 0:t.getCanvasElement();if(!e)return{left:0,top:0};const{top:n,left:r}=Qpe(e);return{left:r,top:n}}function MR(t){var e;const n=(e=t.parent)==null?void 0:e.parent,r=n==null?void 0:n.parent;if(n==null||r==null)return;const{paragraphIndex:i}=n,o=r.lines.filter(u=>u.paragraphIndex===i);let s=-1,a="",l=!1;for(const u of o)for(const c of u.divides)for(const d of c.spanGroup)l||(s+=d.count),d===t&&(l=!0),a+=d.count>0?d.content:"";return{st:o[0].st,ed:i,content:a,nodeIndex:s}}let Jpe=class extends E1{constructor(){super(),M(this,"_onInputBefore$",new rn(null)),M(this,"onInputBefore$",this._onInputBefore$.asObservable()),M(this,"_onKeydown$",new rn(null)),M(this,"onKeydown$",this._onKeydown$.asObservable()),M(this,"_onInput$",new rn(null)),M(this,"onInput$",this._onInput$.asObservable()),M(this,"_onCompositionstart$",new rn(null)),M(this,"onCompositionstart$",this._onCompositionstart$.asObservable()),M(this,"_onCompositionupdate$",new rn(null)),M(this,"onCompositionupdate$",this._onCompositionupdate$.asObservable()),M(this,"_onCompositionend$",new rn(null)),M(this,"onCompositionend$",this._onCompositionend$.asObservable()),M(this,"_onSelectionStart$",new rn(null)),M(this,"onSelectionStart$",this._onSelectionStart$.asObservable()),M(this,"_onPaste$",new rn(null)),M(this,"onPaste$",this._onPaste$.asObservable()),M(this,"_textSelectionInner$",new rn(null)),M(this,"textSelectionInner$",this._textSelectionInner$.asObservable()),M(this,"_container"),M(this,"_inputParent"),M(this,"_input"),M(this,"_cursor"),M(this,"_moveObserver"),M(this,"_upObserver"),M(this,"_viewportScrollX",0),M(this,"_viewportScrollY",0),M(this,"_rangeList",[]),M(this,"_currentSegmentId",""),M(this,"_selectionStyle",N6),M(this,"_isSelectionEnabled",!0),M(this,"_viewPortObserverMap",new Map),M(this,"_isIMEInputApply",!1),M(this,"_activeViewport"),M(this,"_docSkeleton"),M(this,"_scene"),M(this,"_document"),this._initDOM()}__getEditorContainer(){return this._container}getViewPort(){return this._activeViewport}setSegment(e){this._currentSegmentId=e}setStyle(e=N6){this._selectionStyle=e}resetStyle(){this.setStyle()}enableSelection(){this._isSelectionEnabled=!0}disableSelection(){this._isSelectionEnabled=!1}addTextRanges(e){const{_scene:n,_docSkeleton:r}=this,i=this._document.getOffsetConfig();for(const o of e){const s=Ape(n,o,r,i);this._add(s)}this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),segmentId:this._currentSegmentId,style:this._selectionStyle}),this._updateDomCursorPositionAndSize(),this._scrollToSelection()}sync(){this._updateDomCursorPositionAndSize()}activate(e,n){this._container.style.left=`${e}px`,this._container.style.top=`${n}px`,this._container.style.zIndex="1000",this._cursor.style.animation="univer_cursor_blinkStyle 1s steps(1) infinite",this._cursor.style.display="revert",this.focus()}focus(){this._input.focus()}blur(){this._input.blur()}deactivate(){this._container.style.left="0px",this._container.style.top="0px",this._cursor.style.animation="",this._cursor.style.display="none"}changeRuntime(e,n,r){e!==this._docSkeleton&&this.removeAllTextRanges(),this._docSkeleton=e,this._scene=n,this._activeViewport=n.getViewports()[0],this._document=r}handleDblClick(e){if(!this._scene||!this._isSelectionEnabled)return;const{offsetX:n,offsetY:r}=e,i=this._findNodeByCoord(n,r);if(i==null||i.node==null)return;const o=MR(i.node);if(o==null)return;const{content:s,st:a,nodeIndex:l}=o;if(l===-1||Intl.Segmenter==null)return;const u=new Intl.Segmenter(void 0,{granularity:"word"}).segment(s);let c=-1/0,d=-1/0;for(const{segment:h,index:f,isWordLike:m}of u)if(f<=l&&l<f+h.length&&m){c=f+a,d=f+a+h.length;break}if(Number.isFinite(c)&&Number.isFinite(d)){this.removeAllTextRanges();const h=[{startOffset:c,endOffset:d}];this.addTextRanges(h)}}handleTripleClick(e){if(!this._scene||!this._isSelectionEnabled)return;const{offsetX:n,offsetY:r}=e,i=this._findNodeByCoord(n,r);if(i==null||i.node==null)return;const o=MR(i.node);if(o==null)return;this.removeAllTextRanges();const{st:s,ed:a}=o,l=[{startOffset:s,endOffset:a,collapsed:s===a}];this.addTextRanges(l)}eventTrigger(e){var n;if(!this._scene||!this._isSelectionEnabled)return;const r=this._scene,{offsetX:i,offsetY:o}=e;this._attachScrollEvent(this._activeViewport||r.getActiveViewportByCoord(Ft.FromArray([i,o])));const s=this._findNodeByCoord(i,o),a=this._getNodePosition(s);if(a==null){this._removeAllTextRanges();return}if((s==null?void 0:s.node.streamType)===en.PARAGRAPH&&(a.isBack=!0),e.ctrlKey||this._isEmpty()){const f=new Ov(r,this._document.getOffsetConfig(),this._docSkeleton,a);this._addTextRange(f)}else this._updateTextRangePosition(a);this._activeSelectionRefresh(),r.disableEvent();const l=yl.create(r);l.startScroll(i,o);const{scrollX:u,scrollY:c}=xd(l);this._viewportScrollX=u,this._viewportScrollY=c,this._onSelectionStart$.next((n=this._getActiveRangeInstance())==null?void 0:n.startNodePosition);let d=i,h=o;this._moveObserver=r.onPointerMoveObserver.add(f=>{const{offsetX:m,offsetY:p}=f;r.setCursor(Yt.TEXT),!(Math.sqrt((m-d)**2+(p-h)**2)<3)&&(this._moving(m,p,l),l.scrolling(m,p,()=>{this._moving(m,p,l)}),d=m,h=p)}),this._upObserver=r.onPointerUpObserver.add(()=>{r.onPointerMoveObserver.remove(this._moveObserver),r.onPointerUpObserver.remove(this._upObserver),r.enableEvent(),this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),segmentId:this._currentSegmentId,style:this._selectionStyle}),l.dispose(),this._updateDomCursorPositionAndSize()})}removeAllTextRanges(){this._removeAllTextRanges(),this.deactivate()}_getAllTextRanges(){return this._rangeList}_getActiveRange(){const e=this._rangeList.find(l=>l.isActive());if(e==null)return null;const{startOffset:n,endOffset:r,collapsed:i,startNodePosition:o,endNodePosition:s,direction:a}=e;return n==null||r==null?null:{startOffset:n,endOffset:r,collapsed:i,startNodePosition:o,endNodePosition:s,direction:a,segmentId:this._currentSegmentId,style:this._selectionStyle}}_add(e){e!=null&&(this._addTextRange(e),e.refresh())}_getActiveRangeInstance(){return this._rangeList.find(e=>e.isActive())}dispose(){super.dispose(),this._detachEvent(),this._container.remove()}_initDOM(){const e=document.createElement("div");e.style.position="fixed",e.style.left="0px",e.style.top="0px";const n=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div");n.appendChild(r),e.appendChild(n),e.appendChild(i),this._container=e,this._inputParent=n,this._input=r,this._cursor=i,this._initInput(),this._initDOMCursor(),this._initInputEvents(),document.body.appendChild(e)}_initInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.style.cssText=`
            position: absolute;
            overflow: hidden;
            opacity: 1;
            background: #000;
            color: transparent;
            outline: none;
            z-index: -2;
            caret-color: transparent;
            white-space: pre-wrap;
            user-select: text;
        `}_initDOMCursor(){this._cursor.style.cssText=`
            visibility: visible;
            position: absolute;
            background: #000;
            left: 0;
            top: 0;
            width: 1px;
            height: 20px;
            opacity: 0;
            z-index: 0;
            pointer-events: none;
            display: none
        `,Cfe("keyframes univer_cursor_blinkStyle")||bfe([`
                @-webkit-keyframes univer_cursor_blinkStyle {
                    0% {
                        opacity: 1;
                    }

                    13% {
                        opacity: 0;
                    }

                    50% {
                        opacity: 0;
                    }

                    63% {
                        opacity: 1;
                    }

                    100% {
                        opacity: 1;
                    }
                }
            `,`
                @keyframes univer_cursor_blinkStyle {
                    0% {
                        opacity: 1;
                    }

                    13% {
                        opacity: 0;
                    }

                    50% {
                        opacity: 0;
                    }

                    63% {
                        opacity: 1;
                    }

                    100% {
                        opacity: 1;
                    }
                }
            `])}_getNodePosition(e){var n;if(e==null)return;const{node:r,ratioX:i}=e,o=(n=this._docSkeleton)==null?void 0:n.findPositionBySpan(r);if(o==null)return;const s=i<.5;return{...o,isBack:s}}_interactTextRange(e){const n=[];let r=!1;this._rangeList.forEach(i=>{if(i===e)return!0;e.isIntersection(i)?(r=!0,i.dispose()):n.push(i)}),r&&(n.push(e),this._rangeList=n)}_removeAllTextRanges(){this._rangeList.forEach(e=>{e.dispose()}),this._rangeList=[]}_deactivateAllTextRanges(){this._rangeList.forEach(e=>{e.deactivate()})}_addTextRange(e){this._deactivateAllTextRanges(),e.activate(),this._rangeList.push(e)}_updateTextRangePosition(e){if(!this._scene)return;let n=this._rangeList.pop();n||(n=new Ov(this._scene,this._document.getOffsetConfig(),this._docSkeleton,e)),this._removeAllTextRanges(),n.activate(),n.anchorNodePosition=e,n.focusNodePosition=null,this._rangeList=[n]}_isEmpty(){return this._rangeList.length===0}_getCanvasOffset(){var e;const n=(e=this._scene)==null?void 0:e.getEngine();return OA(n)}_scrollToSelection(){var e;const n=this._getActiveRangeInstance(),r=n==null?void 0:n.getAnchor();if(!r||r&&!r.visible||this._activeViewport==null)return;const{scaleX:i,scaleY:o}=((e=this._scene)==null?void 0:e.getAncestorScale())||{scaleX:1,scaleY:1},{left:s,top:a,height:l,width:u}=r,{left:c,top:d,right:h,bottom:f}=this._activeViewport.getBounding().viewBound,m=u/i,p=l/o;let g=0,v=0;a<d?g=a-d:a>f-p&&(g=a-f+p),s<c?v=s-c:s>h-m&&(v=s-h+m);const _=this._activeViewport.getBarScroll(v,g);this._activeViewport.scrollBy(_)}_updateDomCursorPositionAndSize(){var e;const n=this._getActiveRangeInstance(),r=n==null?void 0:n.getAnchor();if(!r||r&&!r.visible||this._activeViewport==null){this.focus();return}const{height:i,left:o,top:s}=r,a=this._activeViewport.getAbsoluteVector(Ft.FromArray([o,s])),{scaleY:l}=((e=this._scene)==null?void 0:e.getAncestorScale())||{scaleX:1,scaleY:1},{x:u,y:c}=a;this._cursor.style.height=`${i*l}px`;let{left:d,top:h}=this._getCanvasOffset();d+=u,h+=c,this.activate(d,h)}_moving(e,n,r){if(this._docSkeleton==null)return;const i=this._findNodeByCoord(e,n),o=this._getNodePosition(i);if(!o)return;const s=this._getActiveRangeInstance();s&&(s.focusNodePosition=o,s.refresh(),this.deactivate(),this._interactTextRange(s))}_attachScrollEvent(e){if(e==null)return;const n=e.viewPortKey;if(this._viewPortObserverMap.has(n))return;const r=e.onScrollBeforeObserver.add(o=>{if(!o.viewport)return;const s=this._getActiveRangeInstance();s==null||s.activeStatic(),this._cursor.style.display="none"}),i=e.onScrollStopObserver.add(o=>{const s=o.viewport;if(!s)return;const a=s.getBounding(),l=this._getActiveRangeInstance(),u=l==null?void 0:l.getAnchor();if(!(!u||u&&!u.visible)){if(a){const{left:c,top:d,right:h,bottom:f}=a.viewBound;if(u.left<c||u.left>h||u.top<d||u.top>f){l==null||l.deactivateStatic();return}}this._updateDomCursorPositionAndSize(),l==null||l.deactivateStatic(),this._cursor.style.display="revert"}});this._viewPortObserverMap.set(n,{scrollBefore:r,scrollStop:i})}_initInputEvents(){this._input.addEventListener("keydown",e=>{this._isIMEInputApply||this._eventHandle(e,n=>{this._onKeydown$.next(n)})}),this._input.addEventListener("input",e=>{this._isIMEInputApply||this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onInput$.next(n)})}),this._input.addEventListener("compositionstart",e=>{this._isIMEInputApply=!0,this._eventHandle(e,n=>{this._onCompositionstart$.next(n)})}),this._input.addEventListener("compositionend",e=>{this._isIMEInputApply=!1,this._eventHandle(e,n=>{this._onCompositionend$.next(n)})}),this._input.addEventListener("compositionupdate",e=>{this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onCompositionupdate$.next(n)})}),this._input.addEventListener("paste",e=>{this._eventHandle(e,n=>{this._onPaste$.next(n)})})}_eventHandle(e,n){const r=this._input.textContent||"";this._input.innerHTML="";const i=this._getActiveRange(),o=this._getAllTextRanges();n({event:e,content:r,activeRange:i,rangeList:o})}_getTransformCoordForDocumentOffset(e,n){const{documentTransform:r}=this._document.getOffsetConfig();if(this._activeViewport==null||r==null)return;const i=this._activeViewport.getRelativeVector(Ft.FromArray([e,n]));if(i)return r.clone().invert().applyPoint(i)}_findNodeByCoord(e,n){var r;const i=this._getTransformCoordForDocumentOffset(e,n);if(i==null)return;const{pageLayoutType:o=Vs.VERTICAL,pageMarginLeft:s,pageMarginTop:a}=this._document.getOffsetConfig();return(r=this._docSkeleton)==null?void 0:r.findNodeByCoord(i,o,s,a)}_detachEvent(){this._onInputBefore$.complete(),this._onKeydown$.complete(),this._onInput$.complete(),this._onCompositionstart$.complete(),this._onCompositionupdate$.complete(),this._onCompositionend$.complete(),this._onSelectionStart$.complete()}_activeSelectionRefresh(){if(this._docSkeleton==null)return;const e=this._getActiveRangeInstance();e==null||e.refresh()}};const Wl=nn("univer.doc.text-selection-render-manager");class TA extends qk{constructor(e,n){super(e),this._skeleton=n}getSkeleton(){return this._skeleton}updateSkeleton(e){this._skeleton=e}render(e,n){if(!this.visible)return this.makeDirty(!1),this;e.save(),this._draw(e,n),e.restore()}getParentScale(){let{scaleX:e=1,scaleY:n=1}=this.parent;return this.parent.classType===Bt.SCENE_VIEWER&&(e=this.parent.ancestorScaleX||1,n=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:n}}getDocuments(){}getNoMergeCellPositionByIndex(e,n){}getScrollXYByRelativeCoords(e){return{x:0,y:0}}getSelectionBounding(e,n,r,i){}_draw(e,n){}}class $A extends TA{_draw(e,n){this.draw(e,n)}}let ege=class extends $A{constructor(e,n){super(e,n),M(this,"_columnHeaderLayoutExtension"),this._initialDefaultExtension(),this.makeDirty(!0)}get columnHeaderLayoutExtension(){return this._columnHeaderLayoutExtension}draw(e,n){const r=this.getSkeleton();if(!r)return;this.getParentScale(),r.calculateSegment(n);const i=r.rowColumnSegment;if(i.startColumn===-1&&i.endColumn===-1)return;const{a:o=1,d:s=1}=e.getTransform(),a=Math.max(o,s),{rowHeaderWidth:l}=r;e.translate(Et(l,a),0);const u=this.getExtensionsByOrder();for(const c of u)c.draw(e,{scaleX:o,scaleY:s},r)}isHit(e){const n=this._getInverseCoord(e),r=this.getSkeleton();if(!r)return!1;const{rowHeaderWidth:i,columnHeaderHeight:o}=r;return n.x>i&&n.y>=0&&n.y<=o}_initialDefaultExtension(){DA.getData().forEach(e=>{this.register(e)}),this._columnHeaderLayoutExtension=this.getExtensionByKey("DefaultColumnHeaderLayoutExtension")}},_4=class extends wA{constructor(){super(...arguments),M(this,"type",0)}getCellIndex(e,n,r,i,o){return k6(e,n,r,i,o)}isRenderDiffRangesByCell(e,n){if(n==null||n.length===0)return!0;for(const r of n){const{startRow:i,startColumn:o,endRow:s,endColumn:a}=r;if(pt.intersects(r,{startRow:i,endRow:s,startColumn:o,endColumn:a}))return!0}return!1}isRenderDiffRangesByColumn(e,n,r){if(r==null||r.length===0)return!0;for(const i of r){const{startColumn:o,endColumn:s}=i;if(pt.intersects({startRow:0,endRow:0,startColumn:e,endColumn:n},{startRow:0,endRow:0,startColumn:o,endColumn:s}))return!0}return!1}isRenderDiffRangesByRow(e,n,r){if(r==null||r.length===0)return!0;for(const i of r){const{startRow:o,endRow:s}=i;if(pt.intersects({startRow:e,endRow:n,startColumn:0,endColumn:0},{startRow:o,endRow:s,startColumn:0,endColumn:0}))return!0}return!1}};const tge="DefaultBackgroundExtension",nge=40;let rge=class extends _4{constructor(){super(...arguments),M(this,"uKey",tge),M(this,"zIndex",nge)}draw(e,n,r,i){const{dataMergeCache:o,stylesCache:s}=r,{background:a,backgroundPositions:l}=s;if(!r)return;const{rowHeightAccumulation:u,columnTotalWidth:c,columnWidthAccumulation:d,rowTotalHeight:h}=r;if(!u||!d||c===void 0||h===void 0)return;e.save();const f=this._getScale(n);e.globalCompositeOperation="destination-over",a&&Object.keys(a).forEach(m=>{const p=a[m];e.fillStyle=m||ls([255,255,255]),e.beginPath(),p.forValue((g,v)=>{const _=l==null?void 0:l.getValue(g,v);if(_==null)return!0;let{startY:C,endY:y,startX:S,endX:E}=_;const{isMerged:w,isMergedMainCell:R,mergeInfo:D}=_;if(w||!this.isRenderDiffRangesByCell({startRow:D.startRow,endRow:D.endRow,startColumn:D.startColumn,endColumn:D.endColumn},i))return!0;R&&(C=D.startY,y=D.endY,S=D.startX,E=D.endX),C=Et(C,f),y=Et(y,f),S=Et(S,f),E=Et(E,f),e.moveTo(S,C),e.lineTo(S,y),e.lineTo(E,y),e.lineTo(E,C)}),e.closePath(),e.fill()}),e.restore()}};P9.add(new rge);const ige="DefaultBorderExtension",oge=50;let sge=class extends _4{constructor(){super(...arguments),M(this,"uKey",ige),M(this,"zIndex",oge)}draw(e,n,r,i){const{dataMergeCache:o,stylesCache:s,overflowCache:a}=r,{border:l}=s;if(!r)return;const{rowHeightAccumulation:u,columnTotalWidth:c,columnWidthAccumulation:d,rowTotalHeight:h}=r;if(!u||!d||c===void 0||h===void 0)return;e.save();const f=this._getScale(n);let m,p;e.translate(ii/f,ii/f),l==null||l.forValue((g,v,_)=>{if(!_)return!0;const C=this.getCellIndex(g,v,u,d,o);let{startY:y,endY:S,startX:E,endX:w}=C;const{isMerged:R,isMergedMainCell:D,mergeInfo:I}=C;if(R||(D&&(y=I.startY,S=I.endY,E=I.startX,w=I.endX),y=Et(y,f),S=Et(S,f),E=Et(E,f),w=Et(w,f),!this.isRenderDiffRangesByRow(I.startRow,I.endRow,i)))return!0;for(const k in _){const{type:O,style:$,color:N}=_[k];$!==m&&(Gk(e,$),e.lineWidth=Kk($)/f,m=$),N!==p&&(e.strokeStyle=N||W2,p=N),Dfe(e,O,{startX:E,startY:y,endX:w,endY:S}),!this._getOverflowExclusion(a,O,g,v)&&Yk(e,O,{startX:E,startY:y,endX:w,endY:S})}}),e.closePath(),e.restore()}_getOverflowExclusion(e,n,r,i){let o=!1;return n===jn.TOP||n===jn.BOTTOM||e==null||e.forRow((s,a)=>{if(s!==r)return!0;a.forEach(l=>{const u=e.getValue(s,l),{startColumn:c,endColumn:d}=u;if(n===jn.LEFT&&i>c&&i<=d||n===jn.RIGHT&&i>=c&&i<d)return o=!0,!1})}),o}};P9.add(new sge);const age="DefaultColumnHeaderLayoutExtension";let lge=class extends _4{constructor(){super(...arguments),M(this,"uKey",age),M(this,"zIndex",10)}draw(e,n,r){const{rowColumnSegment:i,columnHeaderHeight:o=0}=r,{startColumn:s,endColumn:a}=i;if(!r)return;const{rowHeightAccumulation:l,columnTotalWidth:u,columnWidthAccumulation:c,rowTotalHeight:d}=r;if(!l||!c||u===void 0||d===void 0)return;const h=this._getScale(n);e.fillStyle=ls([248,249,250]),e.fillRect(0,0,u,o),e.textAlign="center",e.textBaseline="middle",e.fillStyle=ls([0,0,0]),e.beginPath(),e.lineWidth=1/h,e.translate(ii/h,ii/h),e.strokeStyle=ls([217,217,217]),e.font=`13px ${AC}`;let f=0;const m=c.length;for(let g=s-1;g<=a;g++){if(g<0||g>m-1)continue;const v=c[g];if(f===v)continue;e.moveTo(Et(v,h),0),e.lineTo(Et(v,h),o);const _=f+(v-f)/2;e.fillText(ej(g),_,o/2+Lk),f=v}const p=o-1/h;e.moveTo(0,Et(p,h)),e.lineTo(u,Et(p,h)),e.stroke()}};DA.add(new lge);const uge="DefaultFontExtension",cge=30;let dge=class extends _4{constructor(){super(...arguments),M(this,"uKey",uge),M(this,"zIndex",cge),M(this,"changeFontColor",new nt)}getDocuments(){const e=this.parent;return e==null?void 0:e.getDocuments()}setChangeFontColor(e,n,r){this.changeFontColor.setValue(e,n,r)}draw(e,n,r,i){const{stylesCache:o,dataMergeCache:s,overflowCache:a}=r,{font:l}=o;if(!r)return;const{rowHeightAccumulation:u,columnTotalWidth:c,columnWidthAccumulation:d,rowTotalHeight:h}=r;if(!u||!d||c===void 0||h===void 0)return;e.save();const f=this._getScale(n);l&&Object.keys(l).forEach(m=>{l[m].forValue((p,g,v)=>{const _=this.getCellIndex(p,g,u,d,s);let{startY:C,endY:y,startX:S,endX:E}=_;const{isMerged:w,isMergedMainCell:R,mergeInfo:D}=_;if(w||(R&&(C=D.startY,y=D.endY,S=D.startX,E=D.endX),C=Et(C,f),y=Et(y,f),S=Et(S,f),E=Et(E,f),!this.isRenderDiffRangesByRow(D.startRow,D.endRow,i)))return!0;const I=E-S,k=y-C,O=a.getValue(p,g),{horizontalAlign:$}=v;if(e.save(),e.beginPath(),O){const{startColumn:N,startRow:H,endColumn:X,endRow:te}=O;N===X&&N===g?(e.rect(S+1/f,C+1/f,I-2/f,k-2/f),e.clip(),e.clearRect(S+1/f,C+1/f,I-2/f,k-2/f)):$===Ln.CENTER?this._clipRectangle(e,H,te,N,X,f,u,d):$===Ln.RIGHT?this._clipRectangle(e,H,p,N,g,f,u,d):this._clipRectangle(e,p,te,g,X,f,u,d)}else e.rect(S+1/f,C+1/f,I-2/f,k-2/f),e.clip(),e.clearRect(S+1/f,C+1/f,I-2/f,k-2/f);e.translate(S,C),this._renderDocuments(e,v,S,C,E,y,p,g),e.restore()})}),e.restore()}_renderDocuments(e,n,r,i,o,s,a,l){const u=this.getDocuments();if(u==null)throw new Error("documents is null");const{documentSkeleton:c,angle:d,wrapStrategy:h}=n,f=o-r,m=s-i;h===yr.WRAP&&d===0?(c.getViewModel().getDataModel().updateDocumentDataPageSize(f),c.calculate()):c.getViewModel().getDataModel().updateDocumentDataPageSize(1/0),c.makeDirty(!1),u.resize(f,m),u.changeSkeleton(c).render(e)}_clipRectangle(e,n,r,i,o,s,a,l){const u=Et(a[n-1]||0,s),c=Et(a[r]||a[a.length-1],s),d=Et(l[i-1]||0,s),h=Et(l[o]||l[l.length-1],s);e.rect(d,u,h-d,c-u),e.clip(),e.clearRect(d,u,h-d,c-u)}};P9.add(new dge);const hge="DefaultRowHeaderLayoutExtension";let fge=class extends _4{constructor(){super(...arguments),M(this,"uKey",hge),M(this,"zIndex",10)}draw(e,n,r){const{rowColumnSegment:i,rowHeaderWidth:o=0,columnHeaderHeight:s=0}=r,{startRow:a,endRow:l,startColumn:u,endColumn:c}=i;if(!r)return;const{rowHeightAccumulation:d,columnTotalWidth:h,columnWidthAccumulation:f,rowTotalHeight:m}=r;if(!d||!f||h===void 0||m===void 0)return;const p=this._getScale(n);e.fillStyle=ls([248,249,250]),e.fillRect(0,0,o,m),e.textAlign="center",e.textBaseline="middle",e.fillStyle=ls([0,0,0]),e.beginPath(),e.lineWidth=1/p,e.translate(ii/p,ii/p),e.strokeStyle=ls([217,217,217]),e.font=`13px ${AC}`;let g=0;const v=d.length;for(let C=a-1;C<=l;C++){if(C<0||C>v-1)continue;const y=d[C];if(g===y)continue;e.moveTo(0,Et(y,p)),e.lineTo(o,Et(y,p));const S=g+(y-g)/2;e.fillText(`${C+1}`,o/2,S+Lk),g=y}const _=o-1/p;e.moveTo(Et(_,p),0),e.lineTo(Et(_,p),m),e.stroke()}};RA.add(new fge);let mge=class extends $A{constructor(e,n){super(e,n),M(this,"_rowHeaderLayoutExtension"),this._initialDefaultExtension(),this.makeDirty(!0)}get rowHeaderLayoutExtension(){return this._rowHeaderLayoutExtension}draw(e,n){const r=this.getSkeleton();if(!r)return;this.getParentScale(),r.calculateSegment(n);const i=r.rowColumnSegment;if(i.startRow===-1&&i.endRow===-1)return;const{a:o=1,d:s=1}=e.getTransform(),a=Math.max(o,s),{columnHeaderHeight:l}=r;e.translate(0,Et(l,a));const u=this.getExtensionsByOrder();for(const c of u)c.draw(e,{scaleX:o,scaleY:s},r)}isHit(e){const n=this._getInverseCoord(e),r=this.getSkeleton();if(!r)return!1;const{rowHeaderWidth:i,columnHeaderHeight:o}=r;return n.x>=0&&n.x<=i&&n.y>o}_initialDefaultExtension(){RA.getData().forEach(e=>{this.register(e)}),this._rowHeaderLayoutExtension=this.getExtensionByKey("DefaultRowHeaderLayoutExtension")}};class n1{constructor(e,n){M(this,"children",[]),M(this,"parent"),M(this,"startIndex",-1),M(this,"endIndex",-1),M(this,"blocks",[]),this.nodeType=e,this.content=n}static create(e,n){return new n1(e,n)}dispose(){this.children.forEach(e=>{e.dispose()}),this.parent=null,this.blocks=[]}getProps(){const{children:e,parent:n,startIndex:r,endIndex:i,nodeType:o,content:s}=this;return{children:e,parent:n,startIndex:r,endIndex:i,nodeType:o,content:s}}addBlocks(e){this.blocks=this.blocks.concat(e)}setIndexRange(e,n){this.startIndex=e,this.endIndex=n}insertText(e,n){this.content=Ix(this.content||"",n-this.startIndex,e)}exclude(e){const{startIndex:n,endIndex:r}=this;return e<n||e>r}plus(e){this.startIndex+=e,this.endIndex+=e,this._addIndexForBlock(e)}selfPlus(e,n){this.endIndex+=e,n==null&&(n=this.startIndex),this._addIndexForBlock(e,n)}split(e){const{children:n,parent:r,startIndex:i,nodeType:o,content:s=""}=this.getProps();if(this.exclude(e))return;const a=0,l=e-i,u=l,c=s.slice(a,l),d=n1.create(o,c);d.parent=r,d.setIndexRange(a,l-1);const h=s.slice(u),f=n1.create(o,h);f.parent=r,f.setIndexRange(u,u+h.length-1);const m=[],p=[];for(const g of n){const{startIndex:v}=g;if(g.exclude(e))e<v?m.push(g):p.push(g);else{const _=g.split(e);if(_==null){m.push(g);continue}const{firstNode:C,lastNode:y}=_;m.push(C),m.push(y)}}return d.children=m,f.children=p,d._resetBlocks(),f._resetBlocks(),{firstNode:d,lastNode:f}}getPositionInParent(){var e;return((e=this.parent)==null?void 0:e.children.indexOf(this))??-1}remove(){this.children=[],this.parent!=null&&(this.parent.children.splice(this.getPositionInParent(),1),this.parent=null)}minus(e,n){const r=ob(this.startIndex,this.endIndex,e,n);if(r.length===0)return;const i=this.startIndex;this.startIndex=r[0],this.endIndex=r[1],this.content!=null&&(this.content=xx(this.content||"",e-i,n-i+1))}merge(e){const{startIndex:n,endIndex:r,children:i}=e;this.endIndex+=r-n+1,this.children.push(...i),this.content+=e.content||"",e.remove()}_addIndexForBlock(e,n=-1/0){for(let r=0,i=this.blocks.length;r<i;r++){const o=this.blocks[r];o>=n&&(this.blocks[r]=o+e)}}_resetBlocks(){if(this.nodeType===Xr.PARAGRAPH&&this.content!=null&&this.content.length!==0){this.blocks=[];for(let e=0,n=this.content.length;e<n;e++)this.content[e]===en.CUSTOM_BLOCK&&this.blocks.push(this.startIndex+e)}}}class Nu{constructor(e){M(this,"children",[]),M(this,"_sectionBreakCurrentIndex",0),M(this,"_paragraphCurrentIndex",0),M(this,"_textRunCurrentIndex",0),M(this,"_customBlockCurrentIndex",0),M(this,"_tableBlockCurrentIndex",0),M(this,"_customRangeCurrentIndex",0),M(this,"headerTreeMap",new Map),M(this,"footerTreeMap",new Map),this._documentDataModel=e,e.getBody()!=null&&(this.children=this._transformToTree(e.getBody().dataStream),this._buildHeaderFooterViewModel())}dispose(){this.children.forEach(e=>{e.dispose()})}selfPlus(e,n){}getPositionInParent(){return 0}getLastIndex(){return this.children[this.children.length-1].endIndex}getBody(){return this._documentDataModel.getBody()}getDataModel(){return this._documentDataModel}getSelfOrHeaderFooterViewModel(e){return e==null?this:this.headerTreeMap.has(e)?this.headerTreeMap.get(e):this.footerTreeMap.has(e)?this.footerTreeMap.get(e):this}reset(e){this._documentDataModel=e,this.children=this._transformToTree(e.getBody().dataStream),this._buildHeaderFooterViewModel()}insert(e,n=0){var r;const i=e.dataStream;let o=i.length;const s=this._getParagraphByIndex(this.children,n);if(s!=null)if(i[o-1]===en.SECTION_BREAK){const a=new u6({body:e}),l=new Nu(a);o-=1;const u=l.children;for(const f of u)this._forEachDown(f,m=>{m.plus(n)});const c=s.split(n);if(c==null)return;const{firstNode:d,lastNode:h}=c;(r=s.parent)==null||r.children.splice(s.getPositionInParent(),1,d,...u,h),this._forEachTop(s.parent,f=>{f.selfPlus(o,f.getPositionInParent());const m=f.children;let p=!1;for(const g of m)g===h&&(p=!0),p&&this._forEachDown(g,v=>{v.plus(o)})})}else o===1&&i[o-1]===en.PARAGRAPH?this._insertParagraph(s,n):(s.insertText(i,n),s.selfPlus(o,n),this._forEachTop(s.parent,a=>{a.selfPlus(o,a.getPositionInParent());const l=a.children;let u=!1;for(const c of l)c.startIndex>n&&(u=!0),u&&this._forEachDown(c,d=>{d.plus(o)})}))}delete(e,n){const r=this.children;this._deleteTree(r,e,n)}getText(){const e=[];function n(r){r.content&&e.push(r.content),r.children.forEach(n)}return this.children.forEach(r=>n(r)),e.join("")}resetCache(){this._sectionBreakCurrentIndex=0,this._paragraphCurrentIndex=0,this._textRunCurrentIndex=0,this._customBlockCurrentIndex=0,this._tableBlockCurrentIndex=0,this._customRangeCurrentIndex=0}getSectionBreak(e){if(e==null)return;const n=this.getBody().sectionBreaks;if(n!=null)for(let r=this._sectionBreakCurrentIndex;r<n.length;r++){const i=n[r];if(i.startIndex===e)return this._sectionBreakCurrentIndex=r,i}}getParagraph(e){const n=this.getBody().paragraphs;if(n!=null)for(let r=this._paragraphCurrentIndex;r<n.length;r++){const i=n[r];if(i.startIndex===e)return this._paragraphCurrentIndex=r,i}}getTextRunRange(e=0,n){const r=this.getBody().textRuns;if(r==null)return[{st:e,ed:n}];const i=[];for(let a=this._textRunCurrentIndex,l=r.length;a<l;a++){const u=r[a];if(u.st>n){this._textRunCurrentIndex=a;break}else if(u.ed<e){this._textRunCurrentIndex=a;continue}else i.push({st:u.st<e?e:u.st,ed:u.ed>n?n:u.ed,sId:u.sId,ts:u.ts}),this._textRunCurrentIndex=a}const o=i[0]||{st:n+1};o.st>e&&i.push({st:e,ed:o.st-1});const s=i[i.length-1]||{ed:e-1};return s.ed<n&&i.push({st:s.ed+1,ed:n}),i}getTextRun(e){const n=this.getBody().textRuns;if(n==null)return;const r=n[this._textRunCurrentIndex];if(r!=null){if(e>=r.st&&e<r.ed)return r;if(e<r.st)return}for(let i=this._textRunCurrentIndex,o=n.length;i<o;i++){const s=n[i];if(e>=s.st&&e<s.ed)return this._textRunCurrentIndex=i,s}}getCustomBlock(e){const n=this.getBody().customBlocks;if(n!=null)for(let r=this._customBlockCurrentIndex;r<n.length;r++){const i=n[r];if(i.startIndex===e)return this._customBlockCurrentIndex=r,i}}getTable(e){const n=this.getBody().tables;if(n!=null)for(let r=this._tableBlockCurrentIndex;r<n.length;r++){const i=n[r];if(i.startIndex===e)return this._tableBlockCurrentIndex=r,i}}getCustomRange(e){const n=this.getBody().customRanges;if(n!=null)for(let r=0,i=n.length;r<i;r++){const o=n[r];if(e>=o.startIndex&&e<=o.endIndex)return o}}_transformToTree(e){const n=e.length;let r="";const i=[];let o=[],s=[];for(let a=0;a<n;a++){const l=e[a];if(l===en.PARAGRAPH){r+=en.PARAGRAPH;const u=n1.create(Xr.PARAGRAPH,r);u.setIndexRange(a-r.length+1,a),u.addBlocks(s),o.push(u),r="",s=[]}else if(l===en.SECTION_BREAK){const u=n1.create(Xr.SECTION_BREAK);this._batchParent(u,o);const c=o[o.length-1];c&&c.content&&(c.content+=en.SECTION_BREAK),i.push(u),o=[]}else l===en.TABLE_START?o.push(n1.create(Xr.TABLE)):l===en.TABLE_ROW_START?o.push(n1.create(Xr.TABLE_ROW)):l===en.TABLE_CELL_START?o.push(n1.create(Xr.TABLE_CELL)):l===en.TABLE_END?this._processPreviousNodesUntil(o,Xr.TABLE):l===en.TABLE_ROW_END?this._processPreviousNodesUntil(o,Xr.TABLE_ROW):l===en.TABLE_CELL_END?this._processPreviousNodesUntil(o,Xr.TABLE_CELL):(l===en.CUSTOM_BLOCK&&s.push(a),r+=l)}return i}_processPreviousNodesUntil(e,n){const r=[];let i=e.pop();for(;i&&i.nodeType!==n;)r.push(i),i=e.pop();const o=e[e.length-1];if(this._batchParent(o,r,Xr.TABLE),n===Xr.TABLE_CELL){const s=r[0],a=r[r.length];s.content=en.TABLE_CELL_START+s.content||"",s.startIndex-=1,a.content+=en.TABLE_CELL_END,a.endIndex+=1}else if(n===Xr.TABLE_ROW){const s=r[0].children[0];let a=r[r.length];a=a.children[a.children.length-1],s.content=en.TABLE_ROW_START+s.content||"",s.startIndex-=1,a.content+=en.TABLE_ROW_END,a.endIndex+=1}else if(n===Xr.TABLE){const s=r[0].children[0].children[0];let a=r[r.length];a=a.children[a.children.length-1],a=a.children[a.children.length-1],s.content=en.TABLE_START+s.content||"",s.startIndex-=1,a.content+=en.TABLE_END,a.endIndex+=1}}_batchParent(e,n,r=Xr.SECTION_BREAK){for(const o of n)o.parent=e,e.children.push(o);const i=r===Xr.SECTION_BREAK?0:1;e.setIndexRange(n[0].startIndex-i,n[n.length-1].endIndex+1)}_buildHeaderFooterViewModel(){const{headerModelMap:e,footerModelMap:n}=this._documentDataModel;for(const[r,i]of e)this.headerTreeMap.set(r,new Nu(i));for(const[r,i]of n)this.footerTreeMap.set(r,new Nu(i))}_getParagraphByIndex(e,n){for(const r of e){const{children:i}=r;if(!r.exclude(n))return r.nodeType===Xr.PARAGRAPH?r:this._getParagraphByIndex(i,n)}return null}_forEachTop(e,n){let r=e;for(;r;)n(r),r=r.parent;n(this)}_forEachDown(e,n){n(e);const r=e.children;for(e of r)this._forEachDown(e,n)}_deleteTree(e,n,r){const i=n,o=n+r-1;let s=null,a=e.length,l=0;for(;l<a;){const u=e[l],{startIndex:c,endIndex:d,children:h}=u;if(this._deleteTree(h,n,r),i===o&&o===d){if(u.nodeType===Xr.PARAGRAPH){const f=this._getNextNode(u);if(f==null){l++;continue}u.minus(i,o),u.merge(f),a--}}else if(i<=c&&o>=d){u.remove(),a--;continue}else if(c<=i&&d>=o)u.minus(i,o);else if(o>c&&o<d){if(u.minus(c,o),s!=null){s.merge(u),s=null,a--;continue}}else i>c&&i<d?(u.minus(i,d),s=u):c>o&&u.plus(-r);l++}}_getNextNode(e){var n;const r=e.getPositionInParent(),i=(n=e.parent)==null?void 0:n.children;return i==null?void 0:i[r+1]}_insertParagraph(e,n=0){var r;const i=e.startIndex,o=e.endIndex,s=e.split(n);if(s==null)return;const{firstNode:a,lastNode:l}=s;a.content+=en.PARAGRAPH,a.selfPlus(1),a.plus(i),this._forEachDown(l,u=>{u.plus(i+1)}),(r=e.parent)==null||r.children.splice(e.getPositionInParent(),1,a,l),this._forEachTop(e.parent,u=>{u.selfPlus(1,u.getPositionInParent());const c=u.children;let d=!1;for(const h of c)h!==l&&(h.startIndex>=o+1&&(d=!0),d&&this._forEachDown(h,f=>{f.plus(1)}))})}}function kv(t,e=0){const n=t==null?void 0:t.getSkeletonData(),r=Cl(e);if(!n)return;const{pages:i}=n,o=i[i.length-1];if(r===0){const{width:c,height:d}=o;return{width:c,height:d}}let s=0,a=0;const l=[];Jfe([o],c=>{const{lines:d,width:h,spaceWidth:f}=c,{rotatedHeight:m,rotatedWidth:p}=Zk(d,h,r);a+=m,l.push({rotatedWidth:p,spaceWidth:f})});const u=l.length;for(let c=0;c<u;c++){const{rotatedWidth:d}=l[c];c===0&&(s+=d)}return{width:s,height:a}}const kc=90,OR={t:0,b:0,l:2,r:2};class XC extends n5{constructor(e,n,r,i,o){super(o),M(this,"_rowHeightAccumulation",[]),M(this,"_rowTotalHeight",0),M(this,"_columnWidthAccumulation",[]),M(this,"_columnTotalWidth",0),M(this,"_rowHeaderWidth",0),M(this,"_columnHeaderHeight",0),M(this,"_rowColumnSegment",{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}),M(this,"_dataMergeCache",[]),M(this,"_overflowCache",new nt),M(this,"_stylesCache",{background:{},backgroundPositions:new nt,font:{},border:new nt}),M(this,"_renderedCellCache",new nt),M(this,"_showGridlines",ke.TRUE),M(this,"_marginTop",0),M(this,"_marginLeft",0),this._worksheet=e,this._config=n,this._cellData=r,this._styles=i,this.updateLayout()}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowHeaderWidth(){return this._rowHeaderWidth}get columnHeaderHeight(){return this._columnHeaderHeight}get rowColumnSegment(){return this._rowColumnSegment}get dataMergeCache(){return this._dataMergeCache}get stylesCache(){return this._stylesCache}get overflowCache(){return this._overflowCache}get showGridlines(){return this._showGridlines}get mergeData(){return this._config.mergeData}get rowHeaderWidthAndMarginLeft(){return this.rowHeaderWidth+this._marginLeft}get columnHeaderHeightAndMarginTop(){return this.columnHeaderHeight+this._marginTop}static create(e,n,r,i,o){return new XC(e,n,r,i,o)}getWorksheetConfig(){return this._config}getCellData(){return this._cellData}getsStyles(){return this._styles}setOverflowCache(e){this._overflowCache=e}setMarginLeft(e){this._marginLeft=e}setMarginTop(e){this._marginTop=e}calculateSegment(e){if(this._config&&(this.updateLayout(),!(!this._rowHeightAccumulation||!this._columnWidthAccumulation)))return e!=null&&(this._rowColumnSegment=this.getRowColumnSegment(e)),!0}calculateWithoutClearingCache(e){if(!this.calculateSegment(e))return;const{mergeData:n}=this._config;return this._dataMergeCache=n&&this._getMergeCells(n,this._rowColumnSegment),this._calculateStylesCache(),this}calculate(e){return this._resetCache(),this.calculateWithoutClearingCache(e),this}calculateAutoHeightInRange(e){var n;if(!De.isArray(e))return[];const r=[],{mergeData:i,rowData:o}=this._config,s=o;for(const a of e){const{startRow:l,endRow:u,startColumn:c,endColumn:d}=a;for(let h=l;h<=u;h++)if(!(r.some(({row:f})=>f===h)||((n=s[h])==null?void 0:n.isAutoHeight)===!1)&&_fe(h,c,d,i)){const f=this._calculateRowAutoHeight(h);r.push({row:h,autoHeight:f})}}return r}_calculateRowAutoHeight(e){var n;const{columnCount:r,columnData:i,mergeData:o,defaultRowHeight:s}=this._config,a=i;let l=s;const u=this._worksheet;if(!u)return l;for(let c=0;c<r;c++){const{isMerged:d,isMergedMainCell:h}=cc(e,c,o);if(d||h)continue;const f=u.getCell(e,c),m=f&&this._getCellDocumentModel(f);if(m==null)continue;const{documentModel:p,textRotation:g,wrapStrategy:v}=m;if(p==null)continue;const _=new Nu(p);let{a:C}=g;const{v:y=ke.FALSE}=g;y===ke.TRUE&&(C=kc);const S=(n=a[c])==null?void 0:n.w;typeof S=="number"&&v===yr.WRAP&&p.updateDocumentDataPageSize(S);const E=Tv.create(_,this._localService);E.calculate();const{height:w=0}=kv(E,C)??{};l=Math.max(l,w)}return Math.min(l,yae)}updateLayout(){if(!this.dirty)return;const{rowData:e,columnData:n,defaultRowHeight:r,defaultColumnWidth:i,rowCount:o,columnCount:s,rowHeader:a,columnHeader:l,showGridlines:u}=this._config,{rowTotalHeight:c,rowHeightAccumulation:d}=this._generateRowMatrixCache(o,e,r),{columnTotalWidth:h,columnWidthAccumulation:f}=this._generateColumnMatrixCache(s,n,i);return this._rowHeaderWidth=a.hidden!==ke.TRUE?a.width:0,this._columnHeaderHeight=l.hidden!==ke.TRUE?l.height:0,this._rowTotalHeight=c,this._rowHeightAccumulation=d,this._columnTotalWidth=h,this._columnWidthAccumulation=f,this._showGridlines=u,this.makeDirty(!1),this}getRowColumnSegment(e){return this._getBounding(this._rowHeightAccumulation,this._columnWidthAccumulation,e==null?void 0:e.viewBound)}getRowColumnSegmentByViewBound(e){return this._getBounding(this._rowHeightAccumulation,this._columnWidthAccumulation,e)}getMergeBounding(e,n,r,i){const o=this._config.mergeData;if(!o)return{startRow:e,startColumn:n,endRow:r,endColumn:i};let s=!0;const a=new nt;for(;s;){s=!1;for(let l=0;l<o.length;l++){const{startRow:u,startColumn:c,endRow:d,endColumn:h}=o[l];a.getValue(u,c)||Wk({left:n,top:e,right:i,bottom:r},{left:c,top:u,right:h,bottom:d})&&(e=Math.min(e,u),n=Math.min(n,c),r=Math.max(r,d),i=Math.max(i,h),a.setValue(u,c,!0),s=!0)}}return{startRow:e,startColumn:n,endRow:r,endColumn:i}}appendToOverflowCache(e,n,r,i){this._overflowCache.setValue(e,n,{startRow:e,endRow:e,startColumn:r,endColumn:i})}getColumnCount(){return this._columnWidthAccumulation.length}getRowCount(){return this._rowHeightAccumulation.length}getOverflowPosition(e,n,r,i,o){const{width:s}=e;let a=i,l=i;return n===Ln.CENTER?(a=this._getOverflowBound(r,i,0,s/2,n),l=this._getOverflowBound(r,i,o-1,s/2,n)):n===Ln.RIGHT?a=this._getOverflowBound(r,i,0,s):l=this._getOverflowBound(r,i,o-1,s),{startColumn:a,endColumn:l}}getNoMergeCellPositionByIndex(e,n,r,i){const{rowHeightAccumulation:o,columnWidthAccumulation:s,rowHeaderWidthAndMarginLeft:a,columnHeaderHeightAndMarginTop:l}=this;let{startY:u,endY:c,startX:d,endX:h}=g2(e,n,o,s);return u+=l,c+=l,d+=a,h+=a,{startY:u,endY:c,startX:d,endX:h}}getNoMergeCellPositionByIndexWithNoHeader(e,n,r,i){const{rowHeightAccumulation:o,columnWidthAccumulation:s}=this,{startY:a,endY:l,startX:u,endX:c}=g2(e,n,o,s);return{startY:a,endY:l,startX:u,endX:c}}calculateCellIndexByPosition(e,n,r,i,o){const{row:s,column:a}=this.getCellPositionByOffset(e,n,r,i,o);return this.getCellByIndex(s,a,r,i)}getCellPositionByOffset(e,n,r,i,o){const s=this.getRowPositionByOffsetY(n,i,o),a=this.getColumnPositionByOffsetX(e,r,o);return{row:s,column:a}}getColumnPositionByOffsetX(e,n,r){e=this.getTransformOffsetX(e,n,r);const{columnWidthAccumulation:i}=this;let o=A1(i,e);return o===1/0?o=i.length-1:o===-1&&(o=0),o}getRowPositionByOffsetY(e,n,r){const{rowHeightAccumulation:i}=this;e=this.getTransformOffsetY(e,n,r);let o=A1(i,e);return o===1/0?o=i.length-1:o===-1&&(o=0),o}getTransformOffsetX(e,n,r){const{x:i}=r;return e=e/n+i-this.rowHeaderWidthAndMarginLeft,e}getTransformOffsetY(e,n,r){const{y:i}=r;return e=e/n+i-this.columnHeaderHeightAndMarginTop,e}getOffsetByPositionX(e){const{columnWidthAccumulation:n,rowHeaderWidthAndMarginLeft:r}=this,i=n.length-1,o=n[e];return o!=null?o+r:e<0?r:n[i]+r}getOffsetByPositionY(e){const{rowHeightAccumulation:n,columnHeaderHeightAndMarginTop:r}=this,i=n.length-1,o=n[e];return o!=null?o+r:e<0?r:n[i]+r}getCellByIndex(e,n,r,i){const{rowHeightAccumulation:o,columnWidthAccumulation:s,rowHeaderWidthAndMarginLeft:a,columnHeaderHeightAndMarginTop:l}=this,u=k6(e,n,o,s,this._config.mergeData),{isMerged:c,isMergedMainCell:d}=u;let{startY:h,endY:f,startX:m,endX:p,mergeInfo:g}=u;return h+=l,f+=l,m+=a,p+=a,g=sR(g,a,l),{actualRow:e,actualColumn:n,startY:h,endY:f,startX:m,endX:p,isMerged:c,isMergedMainCell:d,mergeInfo:g}}getCellByIndexWithNoHeader(e,n,r,i){const{rowHeightAccumulation:o,columnWidthAccumulation:s}=this,a=k6(e,n,o,s,this._config.mergeData),{isMerged:l,isMergedMainCell:u}=a,{startY:c,endY:d,startX:h,endX:f,mergeInfo:m}=a,p=sR(m,0,0);return{actualRow:e,actualColumn:n,startY:c,endY:d,startX:h,endX:f,isMerged:l,isMergedMainCell:u,mergeInfo:p}}convertTransformToOffsetX(e,n,r){const{x:i}=r;return e=(e-i)*n,e}convertTransformToOffsetY(e,n,r){const{y:i}=r;return e=(e-i)*n,e}getSelectionBounding(e,n,r,i){return this.getMergeBounding(e,n,r,i)}getBlankCellDocumentModel(e){const n=this._getCellDocumentModel(e,void 0,void 0,!0);if(n!=null)return n.documentModel==null&&(n.documentModel=this._getDocumentDataByStyle("",{},{})),n;const r="";let i="document";const o={a:0,v:ke.FALSE},s=Ln.UNSPECIFIED,a=Kr.UNSPECIFIED,l=yr.UNSPECIFIED,u=OR;return i=Qh({},this._localService).fontCache,{documentModel:this._getDocumentDataByStyle(r,{},{}),fontString:i,textRotation:o,wrapStrategy:l,verticalAlign:a,horizontalAlign:s,paddingData:u}}getCellDocumentModelWithFormula(e){return this._getCellDocumentModel(e,!0,!0,!0)}_getCellDocumentModel(e,n=!1,r=!1,i=!1){var o;const s=this._styles.getStyleByCell(e);if(!e)return;let a,l="document";const u=this._getOtherStyle(s),c=i?{a:0,v:ke.FALSE}:u.textRotation||{a:0,v:ke.FALSE},d=u.horizontalAlign||Ln.UNSPECIFIED,h=u.verticalAlign||Kr.UNSPECIFIED,f=u.wrapStrategy||yr.UNSPECIFIED,m=u.paddingData||OR;if(e.f&&r)a=this._getDocumentDataByStyle(e.f.toString(),{},{});else if(e.p){const{a:p=0,v:g=ke.FALSE}=c;let v=0,_=p;g===ke.TRUE&&(v=kc,_=kc),a=this._updateConfigAndGetDocumentModel(n?De.deepClone(e.p):e.p,d,{horizontalAlign:d,verticalAlign:h,centerAngle:v,vertexAngle:_,wrapStrategy:f})}else if(e.v!=null){const p=this._getFontFormat(s);l=Qh(p,this._localService).fontCache,a=this._getDocumentDataByStyle(e.v.toString(),p,{...u,textRotation:c})}return{documentModel:a,fontString:l,textRotation:c,wrapStrategy:f,verticalAlign:h,horizontalAlign:d,paddingData:m,fill:(o=s==null?void 0:s.bg)==null?void 0:o.rgb}}getDecomposedOffset(e,n){let r=A1(this._columnWidthAccumulation,e),i=0;r===-1||r===0?(r=0,i=e):i=e-this._columnWidthAccumulation[r-1];let o=A1(this._rowHeightAccumulation,n),s=0;return o===-1||o===0?(o=0,s=n):s=n-this._rowHeightAccumulation[o-1],{row:o,column:r,columnOffset:i,rowOffset:s}}_getBounding(e,n,r){const i=e.length,o=n.length;if(!r)return{startRow:0,endRow:i-1,startColumn:0,endColumn:o-1};let s=-1,a=-1,l=-1,u=-1;const c=A1(e,r.top-this.columnHeaderHeightAndMarginTop),d=A1(e,r.bottom-this.columnHeaderHeightAndMarginTop);c===-1&&d===0?(s=-1,a=-1):(c===-1?s=0:s=c,d===1/0||d>=i?a=i-1:a=d);const h=A1(n,r.left-this.rowHeaderWidthAndMarginLeft),f=A1(n,r.right-this.rowHeaderWidthAndMarginLeft);return h===-1&&f===0?(l=-1,u=-1):(h===-1?l=0:l=h,f===1/0||f>=o?u=o-1:u=f),{startRow:s,endRow:a,startColumn:l,endColumn:u}}_generateRowMatrixCache(e,n,r){let i=0;const o=[],s=n;for(let a=0;a<e;a++){let l=r;if(s[a]!=null){const u=s[a];if(!u)continue;const{h:c=r,ah:d,isAutoHeight:h}=u;(h==null||h)&&typeof d=="number"?l=d:l=c,u.hd===ke.TRUE&&(l=0)}i+=l,o.push(i)}return{rowTotalHeight:i,rowHeightAccumulation:o}}_generateColumnMatrixCache(e,n,r){let i=0;const o=[],s=n;for(let a=0;a<e;a++){let l=r;if(s[a]!=null){const u=s[a];if(!u)continue;u.w!=null&&(l=u.w),u.hd===ke.TRUE&&(l=0)}i+=l,o.push(i)}return{columnTotalWidth:i,columnWidthAccumulation:o}}_getOverflowBound(e,n,r,i,o=Ln.LEFT){var s,a;let l=0;if(n>r){const u=this._columnWidthAccumulation.length-1;for(let c=n;c>=r;c--){const d=c,h=(s=this._worksheet)==null?void 0:s.getCell(e,d);if(!bS(h)&&d!==n||this.intersectMergeRange(e,d))return d===n?d:d+1>u?u:d+1;const{startX:f,endX:m}=g2(e,d,this.rowHeightAccumulation,this.columnWidthAccumulation);if(o===Ln.CENTER&&d===n?l+=(m-f)/2:l+=m-f,i<l)return d}return n}for(let u=n;u<=r;u++){const c=u,d=(a=this._worksheet)==null?void 0:a.getCell(e,c);if(!bS(d)&&c!==n||this.intersectMergeRange(e,c))return c===n?c:c-1<0?0:c-1;const{startX:h,endX:f}=g2(e,c,this.rowHeightAccumulation,this.columnWidthAccumulation);if(o===Ln.CENTER&&c===n?l+=(f-h)/2:l+=f-h,i<l)return c}return r}intersectMergeRange(e,n){const r=this.dataMergeCache;for(const i of r){const{startRow:o,endRow:s,startColumn:a,endColumn:l}=i;if(e>=o&&e<=s&&n>=a&&n<=l)return!0}return!1}_calculateStylesCache(){const e=this._dataMergeCache,n=this._rowColumnSegment,r=this.columnWidthAccumulation,{startRow:i,endRow:o,startColumn:s,endColumn:a}=n;if(a!==-1){for(let l=i;l<=o;l++){for(let u=s;u<=a;u++)this._setCellCache(l,u,!1);for(let u=0;u<s;u++)this._setCellCache(l,u,!0);if(a!==0)for(let u=a+1;u<r.length;u++)this._setCellCache(l,u,!0)}for(const l of e)this._setCellCache(l.startRow,l.startColumn,!1)}}_resetCache(){this._stylesCache={background:{},backgroundPositions:new nt,font:{},border:new nt},this._renderedCellCache=new nt}_makeDocumentSkeletonDirty(e,n){if(this._stylesCache.font==null)return;const r=Object.keys(this._stylesCache.font);for(const i of r){const o=this._stylesCache.font[i];if(o!=null&&o.getValue(e,n)){o.getValue(e,n).documentSkeleton.makeDirty(!0);return}}}_setCellCache(e,n,r){var i;const o=this._renderedCellCache.getValue(e,n);if(e===-1||n===-1)return!0;if(o===!1)return this._makeDocumentSkeletonDirty(e,n),!0;if(!this._worksheet||this._worksheet.getColVisible(n)===!1||this._worksheet.getRowVisible(e)===!1)return!0;const s=this._worksheet.getCell(e,n);if(!s)return!0;const a=this._stylesCache,l=this._styles.getStyleByCell(s);if(!r&&l&&l.bg&&l.bg.rgb){const y=l.bg.rgb;a.background[y]||(a.background[y]=new nt),a.background[y].setValue(e,n,y);const S=this.getCellByIndexWithNoHeader(e,n,1,1);(i=a.backgroundPositions)==null||i.setValue(e,n,S)}if(!r&&l&&l.bd&&(this._setBorderProps(e,n,jn.TOP,l,a),this._setBorderProps(e,n,jn.BOTTOM,l,a),this._setBorderProps(e,n,jn.LEFT,l,a),this._setBorderProps(e,n,jn.RIGHT,l,a),this._setBorderProps(e,n,jn.TL_BR,l,a),this._setBorderProps(e,n,jn.TL_BC,l,a),this._setBorderProps(e,n,jn.TL_MR,l,a),this._setBorderProps(e,n,jn.BL_TR,l,a),this._setBorderProps(e,n,jn.ML_TR,l,a),this._setBorderProps(e,n,jn.BC_TR,l,a)),o===!0)return this._makeDocumentSkeletonDirty(e,n),!0;if(dh(s))return;const u=s&&this._getCellDocumentModel(s);if(u==null)return;const{documentModel:c,fontString:d,textRotation:h,wrapStrategy:f,verticalAlign:m,horizontalAlign:p}=u;if(c==null)return;const g=new Nu(c);a.font[d]||(a.font[d]=new nt);const v=a.font[d];let{a:_}=h;const{v:C=ke.FALSE}=h;if(C===ke.TRUE&&(_=kc),g){const y=Tv.create(g,this._localService);y.calculate(),v.setValue(e,n,{documentSkeleton:y,angle:_,verticalAlign:m,horizontalAlign:p,wrapStrategy:f})}r?this._renderedCellCache.setValue(e,n,!0):this._renderedCellCache.setValue(e,n,!1)}_updateConfigAndGetDocumentModel(e,n,r){var i;if(!r||!((i=e.body)!=null&&i.dataStream))return;e.documentStyle||(e.documentStyle={}),e.documentStyle.renderConfig=r;const o=e.body.paragraphs||[];for(const s of o)s.paragraphStyle||(s.paragraphStyle={}),s.paragraphStyle.horizontalAlign=n;return new u6(e)}_getDocumentDataByStyle(e,n,r){const i=e.length,{textRotation:o={a:0,v:ke.FALSE},paddingData:s={t:0,r:2,b:0,l:2},horizontalAlign:a=Ln.UNSPECIFIED,verticalAlign:l=Kr.UNSPECIFIED,wrapStrategy:u=yr.UNSPECIFIED}=r,{a:c=0,v:d=ke.FALSE}=o,{t:h,r:f,b:m,l:p}=s;let g=0,v=c;d===ke.TRUE&&(g=kc,v=kc);const _={id:"d",body:{dataStream:`${e}${c6}`,textRuns:[{ts:n,st:0,ed:i}],paragraphs:[{startIndex:i,paragraphStyle:{horizontalAlign:a}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:h,marginBottom:m,marginRight:f,marginLeft:p,renderConfig:{horizontalAlign:a,verticalAlign:l,centerAngle:g,vertexAngle:v,wrapStrategy:u}}};return new u6(_)}_setBorderProps(e,n,r,i,o){var s;const a=(s=i.bd)==null?void 0:s[r];if(!a||!o.border)return!0;const l=oo(a.cl)||W2,u=o.border;u.getValue(e,n)||u.setValue(e,n,{[r]:{}}),u.getValue(e,n)[r]={type:r,style:a.s,color:l}}_getFontFormat(e){if(!e)return{};const{ff:n,fs:r,it:i,bl:o,ul:s,st:a,ol:l,cl:u}=e,c={};return n&&(c.ff=n),r&&(c.fs=r),i&&(c.it=i),o&&(c.bl=o),s&&(c.ul=s),a&&(c.st=a),l&&(c.ol=l),u&&(c.cl=u),c}_getOtherStyle(e){if(!e)return{};const{tr:n,td:r,ht:i,vt:o,tb:s,pd:a}=e;return{textRotation:n,textDirection:r,horizontalAlign:i,verticalAlign:o,wrapStrategy:s,paddingData:a}}_getMergeCells(e,n){const r=this.columnWidthAccumulation.length-1;n?n={startRow:n.startRow,endRow:n.endRow,endColumn:r,startColumn:0}:n={startRow:0,startColumn:0,endRow:this.rowHeightAccumulation.length-1,endColumn:r};const{startRow:i,startColumn:o,endRow:s,endColumn:a}=n,l=[];for(let u=0;u<e.length;u++){const{startRow:c,endRow:d,startColumn:h,endColumn:f}=e[u];for(let m=i;m<=s;m++){let p=!1;for(let g=o;g<=a;g++)if(m>=c&&m<=d&&g>=h&&g<=f){l.push({startRow:c,endRow:d,startColumn:h,endColumn:f}),p=!0;break}if(p)break}}return l}}const pge="__SHEET_EXTENSION_FONT_DOCUMENT_INSTANCE__";let gge=class extends TA{constructor(e,n,r=!0){super(e,n),M(this,"_backgroundExtension"),M(this,"_borderExtension"),M(this,"_fontExtension"),M(this,"_cacheCanvas"),M(this,"_refreshIncrementalState",!1),M(this,"_forceDirty",!1),M(this,"_overflowCacheRuntime",{}),M(this,"_overflowCacheRuntimeRange",new nt),M(this,"_overflowCacheRuntimeTimeout",-1),M(this,"_documents",new IA(pge,void 0,{pageMarginLeft:0,pageMarginTop:0})),this._allowCache=r,this._allowCache&&(this._cacheCanvas=new BC,this.onIsAddedToParentObserver.add(i=>{var o;(o=i==null?void 0:i.getEngine())==null||o.onTransformChangeObservable.add(()=>{this._resizeCacheCanvas()}),this._resizeCacheCanvas(),this._addMakeDirtyToScroll()})),this._initialDefaultExtension(),this.makeDirty(!0)}get backgroundExtension(){return this._backgroundExtension}get borderExtension(){return this._borderExtension}get fontExtension(){return this._fontExtension}getDocuments(){return this._documents}draw(e,n){const r=this.getSkeleton();if(!r)return;const{a:i=1,d:o=1}=e.getTransform(),s=this._refreshIncrementalState?n==null?void 0:n.diffBounds.map(l=>r.getRowColumnSegmentByViewBound(l)):void 0,a=this.getExtensionsByOrder();for(const l of a)l.draw(e,{scaleX:i,scaleY:o},r,s);clearTimeout(this._overflowCacheRuntimeTimeout),this._overflowCacheRuntimeTimeout=setTimeout(()=>{this._overflowCacheRuntimeRange.reset(),this._overflowCacheRuntime={}},1e3)}isHit(e){const n=this._getInverseCoord(e),r=this.getSkeleton();if(!r)return!1;const{rowHeaderWidth:i,columnHeaderHeight:o}=r;return n.x>i&&n.y>o}getNoMergeCellPositionByIndex(e,n){const r=this.getSkeleton();if(!r)return;const{rowHeightAccumulation:i,columnWidthAccumulation:o,rowHeaderWidth:s,columnHeaderHeight:a}=r;this.getParentScale();let{startY:l,endY:u,startX:c,endX:d}=g2(e,n,i,o);return l+=a,u+=a,c+=s,d+=s,{startY:l,endY:u,startX:c,endX:d}}getScrollXYByRelativeCoords(e){const n=this.getParent();let r=0,i=0;const o=n.getActiveViewportByRelativeCoord(e);if(o){const s=o.actualScrollX||0,a=o.actualScrollY||0;r+=s,i+=a}return{x:r,y:i}}makeForceDirty(e=!0){this.makeDirty(e),this._forceDirty=e}getSelectionBounding(e,n,r,i){var o;return(o=this.getSkeleton())==null?void 0:o.getMergeBounding(e,n,r,i)}render(e,n){if(!this.visible)return this.makeDirty(!1),this;const r=this.getSkeleton();if(!r)return;r.calculateWithoutClearingCache(n);const i=r.rowColumnSegment;if(i.startRow===-1&&i.endRow===-1||i.startColumn===-1&&i.endColumn===-1)return;e.save();const{a:o=1,d:s=1}=e.getTransform(),a=A9({scaleX:o,scaleY:s}),{rowHeaderWidth:l,columnHeaderHeight:u}=r;if(e.translate(Et(l,a),Et(u,a)),this._drawAuxiliary(e),n&&this._allowCache===!0){const{viewBound:c,diffBounds:d,diffX:h,diffY:f,viewPortPosition:m,viewPortKey:p}=n;if(p==="viewMain"){const g=this._cacheCanvas.getContext();g.save();const{left:v,top:_,right:C,bottom:y}=m,S=C-v+l,E=y-_+u;if(d.length===0||h===0&&f===0||this._forceDirty)(this.isDirty()||this._forceDirty)&&(this._cacheCanvas.clear(),g.setTransform(e.getTransform()),this._draw(g,n),this._forceDirty=!1),this._applyCache(e,v,_,S,E,v,_,S,E);else{if(this.isDirty()){g.save(),g.globalCompositeOperation="copy",g.setTransform(1,0,0,1,0,0),g.drawImage(this._cacheCanvas.getCanvasEle(),Et(h,a)*a,Et(f,a)*a),g.restore(),this._refreshIncrementalState=!0,g.setTransform(e.getTransform());for(const w of d){const{left:R,right:D,bottom:I,top:k}=w;g.save(),g.beginPath(),g.rect(Et(R-l-ii,a),Et(k-u-ii,a),Et(D-R+l+ii*2,a),Et(I-k+u+ii*2,a)),g.clip(),this._draw(g,{viewBound:n.viewBound,diffBounds:[w],diffX:n.diffX,diffY:n.diffY,viewPortPosition:n.viewPortPosition,viewPortKey:n.viewPortKey}),g.restore()}this._refreshIncrementalState=!1}this._applyCache(e,v,_,S,E,v,_,S,E)}g.restore()}else this._draw(e,n)}else this._draw(e,n);return e.restore(),this.makeDirty(!1),this}_resizeCacheCanvas(){const e=this._getAncestorSize();if(!e||this._cacheCanvas==null)return;const{width:n,height:r}=e;this._cacheCanvas.setSize(n,r),this.makeDirty(!0)}_applyCache(e,n=0,r=0,i=0,o=0,s=0,a=0,l=0,u=0){if(!e)return;const c=this._cacheCanvas.getPixelRatio(),d=this._cacheCanvas.getContext();d.save(),e.save(),e.setTransform(1,0,0,1,0,0),d.setTransform(1,0,0,1,0,0),e.drawImage(this._cacheCanvas.getCanvasEle(),n*c,r*c,i*c,o*c,s*c,a*c,l*c,u*c),e.restore(),d.restore()}_draw(e,n){this.draw(e,n)}_getAncestorSize(){const e=this._getAncestorParent();if(e){if(e.classType===Bt.ENGINE){const n=e.getCanvas();return{width:n.getWidth(),height:n.getHeight()}}if(e.classType===Bt.SCENE_VIEWER)return{width:e.width,height:e.height}}}_getAncestorParent(){let e=this.parent;for(;e;){if(e.classType===Bt.ENGINE||e.classType===Bt.SCENE_VIEWER)return e;e=(e==null?void 0:e.getParent)&&(e==null?void 0:e.getParent())}}_initialDefaultExtension(){P9.getData().sort(Ns).forEach(e=>{this.register(e)}),this._backgroundExtension=this.getExtensionByKey("DefaultBackgroundExtension"),this._borderExtension=this.getExtensionByKey("DefaultBorderExtension"),this._fontExtension=this.getExtensionByKey("DefaultFontExtension")}_addMakeDirtyToScroll(){this._hasScrollViewportOperator(this,e=>{e.onScrollBeforeObserver.add(()=>{this.makeDirty(!0)})})}_hasScrollViewportOperator(e,n){let r=e.getParent();for(;r;){if(r.classType===Bt.SCENE){const i=r.getViewports(),o=this._getHasScrollViewports(i);for(const s of o)s&&n(s)}r=(r==null?void 0:r.getParent)&&(r==null?void 0:r.getParent())}}_getHasScrollViewports(e){const n=[];for(const r of e)r.getScrollBar()&&n.push(r);return n}_calculateOverflow(){const e=this.getSkeleton();if(!e)return;const n=e.getColumnCount(),{stylesCache:r,rowHeightAccumulation:i,columnWidthAccumulation:o,mergeData:s}=e,{font:a}=r;a&&Object.keys(a).forEach(l=>{const u=a[l];u.forRow((c,d)=>{this._overflowCacheRuntime[c]==null&&(d.forEach(h=>{const f=u.getValue(c,h),{documentSkeleton:m,angle:p=0,horizontalAlign:g,wrapStrategy:v}=f,_=e.getCellData().getValue(c,h),C=this.getSkeleton();if(!C)return!0;const{t:y=er.STRING}=_||{};if(v===yr.OVERFLOW&&y!==er.NUMBER&&y!==er.BOOLEAN&&g!==Ln.JUSTIFIED){if(e.intersectMergeRange(c,h))return!0;let S=kv(m,p);if(!S)return!0;if(p!==0){const{startY:D,endY:I,startX:k,endX:O}=k6(c,h,i,o,s),$=O-k,N=I-D;S.height>N&&(S={width:N/Math.tan(Math.abs(p))+$,height:N})}const E=e.getOverflowPosition(S,g,c,h,n),{startColumn:w,endColumn:R}=E;this._overflowCacheRuntimeRange.setValue(c,h,{startRow:c,endRow:c,startColumn:w,endColumn:R})}else if(v===yr.WRAP&&p!==0){if(e.intersectMergeRange(c,h))return!0;const{startY:S,endY:E}=k6(c,h,i,o,s),w=E-S;m.getViewModel().getDataModel().updateDocumentDataPageSize(w),m.calculate();const R=kv(m,p);if(!R)return!0;const{startColumn:D,endColumn:I}=C.getOverflowPosition(R,g,c,h,C.getColumnCount());this._overflowCacheRuntimeRange.setValue(c,h,{startRow:c,endRow:c,startColumn:D,endColumn:I})}}),this._overflowCacheRuntime[c]=!0)}),u.forValue((c,d,h)=>{})}),e.setOverflowCache(this._overflowCacheRuntimeRange)}_drawAuxiliary(e){const n=this.getSkeleton();if(n==null)return;this._calculateOverflow();const{rowColumnSegment:r,dataMergeCache:i,overflowCache:o,stylesCache:s,showGridlines:a}=n,{border:l,backgroundPositions:u}=s,{startRow:c,endRow:d,startColumn:h,endColumn:f}=r;if(!n||a===ke.FALSE)return;const{rowHeightAccumulation:m,columnTotalWidth:p,columnWidthAccumulation:g,rowTotalHeight:v}=n;if(!m||!g||p===void 0||v===void 0)return;e.save();const{a:_=1,d:C=1}=e.getTransform(),y=Math.max(_,C);e.beginPath(),e.lineWidth=1/y,e.strokeStyle=ls([212,212,212]);const S=p,E=v,w=g.length,R=m.length,D=c,I=d,k=0;e.translate(ii/y,ii/y);for(let O=D;O<=I;O++){if(O<0||O>R-1)continue;const $=m[O];e.moveTo(0,Et($,y)),e.lineTo(S,Et($,y))}for(let O=h;O<=f;O++){if(O<0||O>w-1)continue;const $=g[O];e.moveTo(Et($,y),k),e.lineTo(Et($,y),E)}e.stroke(),e.closePath(),l==null||l.forValue((O,$,N)=>{if(!N)return!0;const H=n.getCellByIndexWithNoHeader(O,$,_,C);let{startY:X,endY:te,startX:z,endX:A}=H;const{isMerged:T,isMergedMainCell:P,mergeInfo:K}=H;if(T||(P&&(X=K.startY,te=K.endY,z=K.startX,A=K.endX),X=Et(X,y),te=Et(te,y),z=Et(z,y),A=Et(A,y),!(K.startRow>=D&&K.endRow<=I)))return!0;for(const ee in N){const{type:ue}=N[ee];Ife(e,ue,{startX:z,startY:X,endX:A,endY:te},_,C)}}),e.closePath(),this._clearRectangle(e,y,m,g,i),this._clearRectangle(e,y,m,g,o.toNativeArray()),this._clearBackground(e,y,u),e.restore()}_clearRectangle(e,n,r,i,o){if(o!=null)for(const s of o){const{startRow:a,endRow:l,startColumn:u,endColumn:c}=s,d=Et(r[a-1]||0,n),h=Et(r[l]||r[r.length-1],n),f=Et(i[u-1]||0,n),m=Et(i[c]||i[i.length-1],n);e.clearRect(f,d,m-f,h-d),e.beginPath(),e.moveTo(f,d),e.lineTo(m,d),e.lineTo(m,h),e.lineTo(f,h),e.lineTo(f,d),e.stroke(),e.closePath()}}_clearBackground(e,n,r){r==null||r.forValue((i,o,s)=>{let{startY:a,endY:l,startX:u,endX:c}=s;const{isMerged:d,isMergedMainCell:h,mergeInfo:f}=s;if(d)return!0;h&&(a=f.startY,l=f.endY,u=f.startX,c=f.endX),e.clearRect(u,a,c-u,l-a)})}};class vge extends X2{constructor(e,n){super(e),M(this,"_subScenes",new Map),M(this,"_activeSubScene"),M(this,"_allowSelectedClipElement",!1),this._initialProps(n)}get classType(){return Bt.SCENE_VIEWER}render(e,n){var r;if(!this.visible)return this.makeDirty(!1),this;if(n){const{left:o,top:s,right:a,bottom:l}=n.viewBound;if(this.width+this.strokeWidth<o||a<0||this.height+this.strokeWidth<s||l<0)return this}const i=this.transform.getMatrix();return e.save(),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),(r=this._activeSubScene)==null||r.makeDirtyNoParent(!0).render(e),e.restore(),this.makeDirty(!1),this}getSubScenes(){return this._subScenes}getActiveSubScene(){return this._activeSubScene}getSubScene(e){for(const[n,r]of this._subScenes)if(n===e)return r}addSubScene(e){this._activeSubScene=e,this._subScenes.set(e.sceneKey,e),this.makeDirty()}removeSubScene(e){const n=this._subScenes.get(e);this._subScenes.delete(e),this._activeSubScene===n&&(this._activeSubScene=this._subScenes.values().next().value),this.makeDirty()}activeSubScene(e){if(e==null)return;const n=this._subScenes.get(e);this._activeSubScene!==n&&(this._activeSubScene=n,this.makeDirty())}enableSelectedClipElement(){this._allowSelectedClipElement=!0}disableSelectedClipElement(){this._allowSelectedClipElement=!1}allowSelectedClipElement(){return this._allowSelectedClipElement}pick(e){var n;if(this._activeSubScene===void 0)return;const r=this.transform.clone().invert().applyPoint(e);return(n=this._activeSubScene)==null?void 0:n.pick(r)}dispose(){super.dispose(),this._subScenes.forEach(e=>{e.dispose()})}_initialProps(e){if(!e)return;const n=Object.keys(e);if(n.length===0)return;const r={};let i=!1;n.forEach(o=>{if(e[o]===void 0)return!0;r[o]=e[o],i=!0}),i&&this.transformByState(r),this.makeDirty(!0)}}let _ge=class extends je{constructor(){super(...arguments),M(this,"onInputChangedObservable",new Sn),M(this,"onTransformChangeObservable",new Sn),M(this,"_scenes",{}),M(this,"_activeScene",null)}get classType(){return Bt.ENGINE}get activeScene(){return this._activeScene}get width(){return 0}get height(){return 0}getScenes(){return this._scenes}getScene(e){return this._scenes[e]}hasScene(e){return e in this._scenes}addScene(e){const n=e.sceneKey;return this.hasScene(n)&&console.warn("Scenes has similar key, it will be covered"),this._scenes[n]=e,e}setActiveScene(e){const n=this.getScene(e);return n&&(this._activeScene=n),n}hasActiveScene(){return this._activeScene!=null}dispose(){super.dispose();const e=this.getScenes();Object.keys(e).forEach(n=>{e[n].dispose()})}remainScene(e){const n=this.getScenes();if(n[e]){const r=n[e];return delete n[e],r}}},Av=class extends _ge{constructor(e=100,n=100){super(),M(this,"renderEvenInBackground",!0),M(this,"onBeginFrameObservable",new Sn),M(this,"onEndFrameObservable",new Sn),M(this,"_container"),M(this,"_canvas",new BC),M(this,"_canvasEle"),M(this,"_renderingQueueLaunched",!1),M(this,"_activeRenderLoops",new Array),M(this,"_renderFunction",()=>{}),M(this,"_requestNewFrameHandler",-1),M(this,"_frameId",-1),M(this,"_usingSafari",lfe()),M(this,"_fps",60),M(this,"_deltaTime",0),M(this,"_performanceMonitor",new Tfe),M(this,"_pointerMoveEvent"),M(this,"_pointerDownEvent"),M(this,"_pointerUpEvent"),M(this,"_pointerBlurEvent"),M(this,"_pointerWheelEvent"),M(this,"_pointerEnterEvent"),M(this,"_pointerLeaveEvent"),M(this,"pointer",{}),M(this,"_mouseId",-1),M(this,"_isUsingFirefox",navigator.userAgent.indexOf("Firefox")!==-1),this._canvasEle=this._canvas.getCanvasEle(),this._canvas.setSize(e,n),this._handleKeyboardAction(),this._handlePointerAction()}get width(){return this._canvas.getWidth()}get height(){return this._canvas.getHeight()}get requestNewFrameHandler(){return this._requestNewFrameHandler}get frameId(){return this._frameId}setCanvasCursor(e){const n=this.getCanvas().getCanvasEle();n.style.cursor=e}clearCanvas(){this.getCanvas().clear()}getCanvas(){return this._canvas}getCanvasElement(){return this._canvas.getCanvasEle()}getPixelRatio(){return this._canvas.getPixelRatio()}setContainer(e){this._container=e,this._container.appendChild(this._canvasEle),this.resize();let n;const r=new ResizeObserver(()=>{n||(n=window.requestIdleCallback(()=>{this.resize(),n=void 0}))});r.observe(this._container),this.disposeWithMe(Be(()=>{r.unobserve(this._container)}))}resize(){if(!this._container)return;const{width:e,height:n}=yfe(this._container);this.resizeBySize(e,n)}resizeBySize(e,n){const r=this.width,i=this.height;this._canvas.setSize(e,n),this.onTransformChangeObservable.notifyObservers({type:lo.resize,value:{width:e,height:n},preValue:{width:r,height:i}})}dispose(){super.dispose();const e=rR();this._canvasEle.removeEventListener(`${e}leave`,this._pointerLeaveEvent),this._canvasEle.removeEventListener(`${e}enter`,this._pointerEnterEvent),this._canvasEle.removeEventListener(`${e}move`,this._pointerMoveEvent),this._canvasEle.removeEventListener(`${e}down`,this._pointerDownEvent),this._canvasEle.removeEventListener(`${e}up`,this._pointerUpEvent),this._canvasEle.removeEventListener("blur",this._pointerBlurEvent),this._canvasEle.removeEventListener(this._getWheelEventName(),this._pointerWheelEvent),this._activeRenderLoops=[],this._canvas.dispose(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear(),this.onTransformChangeObservable.clear()}runRenderLoop(e){this._activeRenderLoops.indexOf(e)===-1&&(this._activeRenderLoops.push(e),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._renderFunction=this._renderLoop.bind(this),this._requestNewFrameHandler=qh(this._renderFunction)))}stopRenderLoop(e){if(!e){this._activeRenderLoops.length=0,this._cancelFrame();return}const n=this._activeRenderLoops.indexOf(e);n>=0&&(this._activeRenderLoops.splice(n,1),this._activeRenderLoops.length===0&&this._cancelFrame())}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}_renderFrame(){for(let e=0;e<this._activeRenderLoops.length;e++){const n=this._activeRenderLoops[e];n()}}_cancelFrame(){if(this._renderingQueueLaunched&&this._requestNewFrameHandler){if(this._renderingQueueLaunched=!1,typeof window>"u"){if(typeof cancelAnimationFrame=="function")return cancelAnimationFrame(this._requestNewFrameHandler)}else{const{cancelAnimationFrame:e}=this._getHostWindow()||window;if(typeof e=="function")return e(this._requestNewFrameHandler)}return clearTimeout(this._requestNewFrameHandler)}}_getHostWindow(){var e,n;return typeof window>"u"?null:(n=(e=this._canvasEle)==null?void 0:e.ownerDocument)!=null&&n.defaultView?this._canvasEle.ownerDocument.defaultView:window}_renderLoop(){let e=!0;this.renderEvenInBackground||(e=!1),e&&(this.beginFrame(),this._renderFrame(),this.endFrame()),this._activeRenderLoops.length>0?this._requestNewFrameHandler=qh(this._renderFunction):this._renderingQueueLaunched=!1}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}_handleKeyboardAction(){const e=r=>{const i=r;i.deviceType=Qo.Keyboard,i.inputIndex=r.keyCode,i.previousState=0,i.currentState=1,this.onInputChangedObservable.notifyObservers(i)},n=r=>{const i=r;i.deviceType=Qo.Keyboard,i.inputIndex=r.keyCode,i.previousState=1,i.currentState=0,this.onInputChangedObservable.notifyObservers(i)};this._canvasEle.addEventListener("keydown",e),this._canvasEle.addEventListener("keyup",n)}_handlePointerAction(){const e=rR();this._pointerMoveEvent=n=>{const r=this._getPointerType(n),i=this.pointer[xt.Horizontal],o=this.pointer[xt.Vertical],s=this.pointer[xt.DeltaHorizontal],a=this.pointer[xt.DeltaVertical];this.pointer[xt.Horizontal]=n.clientX,this.pointer[xt.Vertical]=n.clientY,this.pointer[xt.DeltaHorizontal]=n.movementX,this.pointer[xt.DeltaVertical]=n.movementY;const l=n;l.deviceType=r,i!==n.clientX&&(l.inputIndex=xt.Horizontal,l.previousState=i,l.currentState=this.pointer[xt.Horizontal],this.onInputChangedObservable.notifyObservers(l)),o!==n.clientY&&(l.inputIndex=xt.Vertical,l.previousState=o,l.currentState=this.pointer[xt.Vertical],this.onInputChangedObservable.notifyObservers(l)),this.pointer[xt.DeltaHorizontal]!==0&&(l.inputIndex=xt.DeltaHorizontal,l.previousState=s,l.currentState=this.pointer[xt.DeltaHorizontal],this.onInputChangedObservable.notifyObservers(l)),this.pointer[xt.DeltaVertical]!==0&&(l.inputIndex=xt.DeltaVertical,l.previousState=a,l.currentState=this.pointer[xt.DeltaVertical],this.onInputChangedObservable.notifyObservers(l)),!this._usingSafari&&n.button!==-1&&(l.inputIndex=n.button+2,l.previousState=this.pointer[n.button+2],this.pointer[n.button+2]=this.pointer[n.button+2]?0:1,l.currentState=this.pointer[n.button+2],this.onInputChangedObservable.notifyObservers(l))},this._pointerDownEvent=n=>{const r=n,i=this._getPointerType(r),o=this.pointer[xt.Horizontal],s=this.pointer[xt.Vertical],a=this.pointer[r.button+2];i===Qo.Mouse?(this._mouseId===-1&&(r.pointerId===void 0?this._mouseId=this._isUsingFirefox?0:1:this._mouseId=r.pointerId),document.pointerLockElement||this._canvasEle.setPointerCapture(this._mouseId)):r.pointerId&&!document.pointerLockElement&&this._canvasEle.setPointerCapture(r.pointerId),this.pointer[xt.Horizontal]=r.clientX,this.pointer[xt.Vertical]=r.clientY,this.pointer[r.button+2]=1;const l=r;l.deviceType=i,o!==r.clientX&&(l.inputIndex=xt.Horizontal,l.previousState=o,l.currentState=this.pointer[xt.Horizontal],this.onInputChangedObservable.notifyObservers(l)),s!==r.clientY&&(l.inputIndex=xt.Vertical,l.previousState=s,l.currentState=this.pointer[xt.Vertical],this.onInputChangedObservable.notifyObservers(l)),l.inputIndex=r.button+2,l.previousState=a,l.currentState=this.pointer[r.button+2],this.onInputChangedObservable.notifyObservers(l)},this._pointerUpEvent=n=>{const r=n,i=this._getPointerType(r),o=this.pointer[xt.Horizontal],s=this.pointer[xt.Vertical],a=this.pointer[r.button+2];this.pointer[xt.Horizontal]=r.clientX,this.pointer[xt.Vertical]=r.clientY,this.pointer[r.button+2]=0;const l=r;l.deviceType=i,o!==r.clientX&&(l.inputIndex=xt.Horizontal,l.previousState=o,l.currentState=this.pointer[xt.Horizontal],this.onInputChangedObservable.notifyObservers(l)),s!==r.clientY&&(l.inputIndex=xt.Vertical,l.previousState=s,l.currentState=this.pointer[xt.Vertical],this.onInputChangedObservable.notifyObservers(l)),l.inputIndex=r.button+2,l.previousState=a,l.currentState=this.pointer[r.button+2],i===Qo.Mouse&&this._mouseId>=0&&this._canvasEle.hasPointerCapture(this._mouseId)?this._canvasEle.releasePointerCapture(this._mouseId):l.pointerId&&this._canvasEle.hasPointerCapture(l.pointerId)&&this._canvasEle.releasePointerCapture(l.pointerId),this.onInputChangedObservable.notifyObservers(l),i!==Qo.Mouse&&(this.pointer={})},this._pointerEnterEvent=n=>{const r=this._getPointerType(n),i=n;i.deviceType=r,i.currentState=2,this.onInputChangedObservable.notifyObservers(i)},this._pointerLeaveEvent=n=>{const r=this._getPointerType(n),i=n;i.deviceType=r,i.currentState=3,this.onInputChangedObservable.notifyObservers(i)},this._pointerBlurEvent=n=>{this._mouseId>=0&&this._canvasEle.hasPointerCapture(this._mouseId)&&(this._canvasEle.releasePointerCapture(this._mouseId),this._mouseId=-1),this.pointer={}},this._pointerWheelEvent=n=>{const r=Qo.Mouse,i=this.pointer[xt.MouseWheelX],o=this.pointer[xt.MouseWheelY],s=this.pointer[xt.MouseWheelZ];this.pointer[xt.MouseWheelX]=n.deltaX||0,this.pointer[xt.MouseWheelY]=n.deltaY||n.wheelDelta||0,this.pointer[xt.MouseWheelZ]=n.deltaZ||0;const a=n;a.deviceType=r,this.pointer[xt.MouseWheelX]!==0&&(a.inputIndex=xt.MouseWheelX,a.previousState=i,a.currentState=this.pointer[xt.MouseWheelX],this.onInputChangedObservable.notifyObservers(a)),this.pointer[xt.MouseWheelY]!==0&&(a.inputIndex=xt.MouseWheelY,a.previousState=o,a.currentState=this.pointer[xt.MouseWheelY],this.onInputChangedObservable.notifyObservers(a)),this.pointer[xt.MouseWheelZ]!==0&&(a.inputIndex=xt.MouseWheelZ,a.previousState=s,a.currentState=this.pointer[xt.MouseWheelZ],this.onInputChangedObservable.notifyObservers(a))},this._canvasEle.addEventListener(`${e}enter`,this._pointerEnterEvent),this._canvasEle.addEventListener(`${e}leave`,this._pointerLeaveEvent),this._canvasEle.addEventListener(`${e}move`,this._pointerMoveEvent),this._canvasEle.addEventListener(`${e}down`,this._pointerDownEvent),this._canvasEle.addEventListener(`${e}up`,this._pointerUpEvent),this._canvasEle.addEventListener("blur",this._pointerBlurEvent),this._canvasEle.addEventListener(this._getWheelEventName(),this._pointerWheelEvent,this._getPassive()?{passive:!1}:!1)}_getWheelEventName(){return"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll"}_getPassive(){let e=!1;const n=()=>{};try{const r={passive:{get(){e=!0}}};this._canvasEle.addEventListener("test",n,r),this._canvasEle.removeEventListener("test",n,r)}catch{}return e}_getPointerType(e){let n=Qo.Mouse;return(e.pointerType==="touch"||e.pointerType==="pen"||e.touches)&&(n=Qo.Touch),n}},$3=class extends X2{constructor(e,...n){super(e),M(this,"_objects",[]),this.addObjects(...n)}get classType(){return Bt.GROUP}set cursor(e){this.setCursor(e)}addObjects(...e){for(const n of e)this.addObject(n)}addObject(e){let n=e;if(iR(e)){const r=this.getScene();if(n=r==null?void 0:r.getObject(e),!n){console.info("No object be added");return}n.parent=this,n.isInGroup=!0,n.groupKey=this.oKey,this._objects.push(n)}else e.parent=this,e.isInGroup=!0,e.groupKey=this.oKey,this._objects.push(e)}removeObject(e){const n=this.getObjects(),r=n.length;if(iR(e))for(let i=0;i<r;i++){const o=n[i];if(o.oKey===e){n.splice(i,1),this.parent.removeObject(o);return}}else for(let i=0;i<r;i++){const o=n[i];if(o===e){n.splice(i,1),this.parent.removeObject(o);return}}}getObjectsByOrder(){const e=[];this._objects.sort(Ns);for(const n of this._objects)!n.isInGroup&&n.visible&&e.push(n);return e}getObjects(){return this._objects}render(e,n){e.save();const r=this.transform.getMatrix();e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._objects.sort(Ns);for(const i of this._objects)i.render(e,this._transformBounds(n));e.restore()}resize(e,n){return this}scale(e,n){return this}skew(e,n){return this}flip(e,n){return this}isHit(e){return!0}pick(e){}dispose(){this.getObjects().forEach(e=>{e.dispose()}),super.dispose()}_transformBounds(e){return e}},F6=class{constructor(e,n=[],r=1,i=!1){M(this,"_objects",[]),M(this,"_cacheCanvas"),M(this,"_dirty",!0),this._scene=e,this._zIndex=r,this._allowCache=i,this.addObjects(n),this._allowCache&&this._initialCacheCanvas()}get scene(){return this._scene}get zIndex(){return this._zIndex}enableCache(){this._allowCache=!0,this._initialCacheCanvas()}disableCache(){var e;this._allowCache=!1,(e=this._cacheCanvas)==null||e.dispose(),this._cacheCanvas=null}isAllowCache(){return this._allowCache}getObjectsByOrder(){const e=[];this._objects.sort(Ns);for(const n of this._objects)!n.isInGroup&&n.visible&&e.push(n);return e}getObjectsByOrderForPick(){const e=[];this._objects.sort(Ns);for(const n of this._objects)n.classType!==Bt.GROUP&&n.visible&&e.push(n);return e}getObjects(){return this._objects}addObject(e){if(e.classType===Bt.GROUP){const n=e.getObjects();for(const r of n)this.scene.getObject(r.oKey)||(this._objects.push(r),this.scene.setObjectBehavior(r))}return this._objects.push(e),this.scene.setObjectBehavior(e),this.scene.applyTransformer(e),e.layer=this,this}removeObject(e){const n=this.getObjects(),r=n.length;if(e instanceof X2){for(let i=0;i<r;i++)if(n[i]===e){n.splice(i,1);return}}else for(let i=0;i<r;i++)if(n[i].oKey===e){n.splice(i,1);return}}addObjects(e){return e.forEach(n=>{this.addObject(n)}),this}removeObjects(e){const n=this.getObjects(),r=n.length;for(let i=r-1;i>=0;i--){let o=n[i];const s=e.length;if(s===0)break;for(let a=0;a<s;a++){const l=e[a];if(o=l instanceof X2?o:o.oKey,o===l){n.splice(i,1);break}}}}makeDirty(e=!0){return this._dirty=e,this}isDirty(){return this._dirty}render(e,n=!1){var r;const i=e||((r=this._scene.getEngine())==null?void 0:r.getCanvas().getContext());if(this._allowCache&&this._cacheCanvas){if(this.isDirty()){const o=this._cacheCanvas.getContext();this._cacheCanvas.clear(),o.save(),o.setTransform(i.getTransform()),this._draw(o,n),o.restore()}this._applyCache(i)}else i.save(),this._draw(i,n),i.restore();return this.makeDirty(!1),this}_initialCacheCanvas(){this._cacheCanvas=new BC,this._scene.getEngine().onTransformChangeObservable.add(()=>{this._resizeCacheCanvas()})}_draw(e,n){var r;(r=this._scene.getViewports())==null||r.forEach(i=>i.render(e,this.getObjectsByOrder(),n))}_applyCache(e){if(!e||this._cacheCanvas==null)return;const n=this._cacheCanvas.getWidth(),r=this._cacheCanvas.getHeight();e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,r)}_resizeCacheCanvas(){var e;const n=this._scene.getEngine();(e=this._cacheCanvas)==null||e.setSize(n.width,n.height),this.makeDirty(!0)}clear(){this._objects=[]}dispose(){var e;this.getObjects().forEach(n=>{n.dispose()}),this.clear(),(e=this._cacheCanvas)==null||e.dispose()}};const bge=["__SpreadsheetTransformerResizeLT__","__SpreadsheetTransformerResizeCT__","__SpreadsheetTransformerResizeRT__","__SpreadsheetTransformerResizeLM__","__SpreadsheetTransformerResizeRM__","__SpreadsheetTransformerResizeLB__","__SpreadsheetTransformerResizeCB__","__SpreadsheetTransformerResizeRB__"];let Cge=class{constructor(e,n){M(this,"hoverEnabled",!1),M(this,"hoverEnterFunc"),M(this,"hoverLeaveFunc"),M(this,"resizeEnabled",!0),M(this,"rotateEnabled",!0),M(this,"rotationSnaps",[]),M(this,"rotationSnapTolerance",5),M(this,"rotateAnchorOffset",50),M(this,"rotateSize",10),M(this,"rotateCornerRadius",10),M(this,"borderEnabled",!0),M(this,"borderStroke","rgb(97, 97, 97)"),M(this,"borderStrokeWidth",1),M(this,"borderDash",[]),M(this,"borderSpacing",10),M(this,"anchorFill","rgb(255,255,255)"),M(this,"anchorStroke","rgb(185,185,185)"),M(this,"anchorStrokeWidth",1),M(this,"anchorSize",10),M(this,"anchorCornerRadius",10),M(this,"keepRatio",!0),M(this,"centeredScaling",!1),M(this,"enabledAnchors",[1,1,1,1,1,1,1,1]),M(this,"flipEnabled",!1),M(this,"ignoreStroke",!1),M(this,"boundBoxFunc"),M(this,"useSingleNodeRotation",!1),M(this,"shouldOverdrawWholeArea",!1),M(this,"onChangeStartObservable",new Sn),M(this,"onChangingObservable",new Sn),M(this,"onChangeEndObservable",new Sn),M(this,"onClearControlObservable",new Sn),M(this,"onCreateControlObservable",new Sn),M(this,"_startOffsetX",-1),M(this,"_startOffsetY",-1),M(this,"_viewportScrollX",-1),M(this,"_viewportScrollY",-1),M(this,"_moveObserver"),M(this,"_upObserver"),M(this,"_cancelFocusObserver"),M(this,"_transformerControlMap",new Map),M(this,"_selectedObjectMap",new Map),this._scene=e,this._initialProps(n)}getScene(){return this._scene}hideControl(){this._hideControl()}attachTo(e){if(e.isTransformer)return this.hoverEnabled&&(this.hoverEnterFunc&&e.onPointerEnterObserver.add(this.hoverEnterFunc),this.hoverLeaveFunc&&e.onPointerLeaveObserver.add(this.hoverLeaveFunc)),e.onPointerDownObserver.add((n,r)=>{const{offsetX:i,offsetY:o}=n;this._startOffsetX=i,this._startOffsetY=o;const s=this._getTopScene();if(!s)return;this._addCancelObserver(s),s.disableEvent();const a=yl.create(s);a.startScroll(i,o);const{scrollX:l,scrollY:u}=xd(a);this._viewportScrollX=l,this._viewportScrollY=u,this._updateActiveObjectList(e,n),this._moveObserver=s.onPointerMoveObserver.add(c=>{const{offsetX:d,offsetY:h}=c;this._moving(d,h,a),this._hideControl(),a.scrolling(d,h,()=>{this._moving(d,h,a)})}),this._upObserver=s.onPointerUpObserver.add(c=>{s.onPointerMoveObserver.remove(this._moveObserver),s.onPointerUpObserver.remove(this._upObserver),s.enableEvent(),this._updateControl(),a.dispose(),this.onChangeEndObservable.notifyObservers({objects:this._selectedObjectMap,type:2})}),r.stopPropagation()}),e}dispose(){this._moveObserver=null,this._upObserver=null,this._transformerControlMap.forEach(e=>{e.dispose()}),this._selectedObjectMap.forEach(e=>{e.dispose()}),this.onChangeStartObservable.clear(),this.onChangingObservable.clear(),this.onChangeEndObservable.clear()}_initialProps(e){if(!e)return;const n=Object.keys(e);n.length!==0&&n.forEach(r=>{if(e[r]===void 0)return!0;this[r]=e[r]})}_updateControlChildren(){this._updateControlIterator((e,n)=>{const{left:r,top:i,width:o,height:s,scaleX:a,scaleY:l}=n.getState();e.getObjects().forEach(u=>{const c=u.oKey,d=this._checkTransformerType(c);if(!d)return!0;if(d==="__SpreadsheetTransformerOutline__")u.transformByState(this._getOutlinePosition(o,s,a,l));else{const{left:h,top:f}=this._getRotateAnchorPosition(d,s,o,a,l);u.transformByState({left:h,top:f})}}),e.transformByState({left:r,top:i})})}_anchorMoving(e,n,r,i){const{scrollX:o,scrollY:s}=xd(i),a=n-this._viewportScrollX+o,l=r-this._viewportScrollY+s,u=a-this._startOffsetX,c=l-this._startOffsetY;this._selectedObjectMap.forEach(d=>{const{left:h,top:f,width:m,height:p}=d,g={};switch(e){case"__SpreadsheetTransformerResizeLT__":g.left=h+u,g.top=f+c,g.width=m-u,g.height=p-c;break;case"__SpreadsheetTransformerResizeCT__":g.top=f+c,g.height=p-c;break;case"__SpreadsheetTransformerResizeRT__":g.top=f+c,g.width=m+u,g.height=p-c;break;case"__SpreadsheetTransformerResizeLM__":g.left=h+u,g.width=m-u;break;case"__SpreadsheetTransformerResizeRM__":g.width=u+m;break;case"__SpreadsheetTransformerResizeLB__":g.left=h+u,g.width=m-u,g.height=p+c;break;case"__SpreadsheetTransformerResizeCB__":g.height=c+p;break;case"__SpreadsheetTransformerResizeRB__":g.width=u+m,g.height=c+p;break}d.transformByState(g)}),this._updateControlChildren(),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:u,moveY:c,type:1}),this._startOffsetX=a,this._startOffsetY=l}_attachEventToAnchor(e,n="__SpreadsheetTransformerResizeLT__"){e.onPointerDownObserver.add((r,i)=>{const{offsetX:o,offsetY:s}=r;this._startOffsetX=o,this._startOffsetY=s;const a=this._getTopScene();if(a==null)return;a.disableEvent();const l=yl.create(a);l.startScroll(o,s);const{scrollX:u,scrollY:c}=xd(l);this._viewportScrollX=u,this._viewportScrollY=c;const d=this._getRotateAnchorCursor(n);this._moveObserver=a.onPointerMoveObserver.add(h=>{const{offsetX:f,offsetY:m}=h;this._anchorMoving(n,f,m,l),l.scrolling(f,m,()=>{this._anchorMoving(n,f,m,l)}),a.setCursor(d)}),this._upObserver=a.onPointerUpObserver.add(h=>{a.onPointerMoveObserver.remove(this._moveObserver),a.onPointerUpObserver.remove(this._upObserver),a.enableEvent(),a.resetCursor(),l.dispose(),this.onChangeEndObservable.notifyObservers({objects:this._selectedObjectMap,type:2})}),i.stopPropagation()})}_attachEventToRotate(e){e.onPointerDownObserver.add((n,r)=>{const{offsetX:i,offsetY:o}=n;this._startOffsetX=i,this._startOffsetY=o;const s=this._getTopScene();s!=null&&(s.disableEvent(),this._viewportScrollX=scrollX,this._viewportScrollY=scrollY,this._moveObserver=s.onPointerMoveObserver.add(a=>{}),this._upObserver=s.onPointerUpObserver.add(a=>{s.onPointerMoveObserver.remove(this._moveObserver),s.onPointerUpObserver.remove(this._upObserver),s.enableEvent()}),r.stopPropagation())})}_getOutlinePosition(e,n,r,i){return{left:-this.borderSpacing-this.borderStrokeWidth,top:-this.borderSpacing-this.borderStrokeWidth,width:e+this.borderSpacing*2,height:n+this.borderSpacing*2}}_getRotateAnchorCursor(e){let n=Yt.NORTH_WEST_RESIZE;switch(e){case"__SpreadsheetTransformerRotate__":n=Yt.MOVE;break;case"__SpreadsheetTransformerRotateLine__":n=Yt.MOVE;break;case"__SpreadsheetTransformerResizeLT__":break;case"__SpreadsheetTransformerResizeCT__":n=Yt.NORTH_RESIZE;break;case"__SpreadsheetTransformerResizeRT__":n=Yt.NORTH_EAST_RESIZE;break;case"__SpreadsheetTransformerResizeLM__":n=Yt.WEST_RESIZE;break;case"__SpreadsheetTransformerResizeRM__":n=Yt.EAST_RESIZE;break;case"__SpreadsheetTransformerResizeLB__":n=Yt.SOUTH_WEST_RESIZE;break;case"__SpreadsheetTransformerResizeCB__":n=Yt.SOUTH_RESIZE;break;case"__SpreadsheetTransformerResizeRB__":n=Yt.SOUTH_EAST_RESIZE;break}return n}_getRotateAnchorPosition(e,n,r,i,o){let s=-this.anchorSize/2,a=-this.anchorSize/2;switch(e){case"__SpreadsheetTransformerRotate__":s=r/2-this.rotateSize/2,a=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth*2-this.rotateSize;break;case"__SpreadsheetTransformerRotateLine__":s=r/2,a=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeLT__":s+=-this.borderSpacing-this.borderStrokeWidth,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeCT__":s+=r/2,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeRT__":s+=r+this.borderSpacing-this.borderStrokeWidth,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeLM__":s+=-this.borderSpacing-this.borderStrokeWidth,a+=n/2;break;case"__SpreadsheetTransformerResizeRM__":s+=r+this.borderSpacing-this.borderStrokeWidth,a+=n/2;break;case"__SpreadsheetTransformerResizeLB__":s+=-this.borderSpacing-this.borderStrokeWidth,a+=n+this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeCB__":s+=r/2,a+=n+this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeRB__":s+=r+this.borderSpacing-this.borderStrokeWidth,a+=n+this.borderSpacing-this.borderStrokeWidth;break}return{left:s,top:a}}_createResizeAnchor(e,n,r){const{height:i,width:o,scaleX:s,scaleY:a}=n.getState(),{left:l,top:u}=this._getRotateAnchorPosition(e,i,o,s,a),c=this._getRotateAnchorCursor(e),d=new qt(`${e}_${r}`,{zIndex:r-1,fill:this.anchorFill,stroke:this.anchorStroke,strokeWidth:this.anchorStrokeWidth,width:this.anchorSize,height:this.anchorSize,radius:this.anchorCornerRadius,left:l,top:u});return this._attachHover(d,c,Yt.DEFAULT),d}_checkTransformerType(e){if(e.indexOf("__SpreadsheetTransformerOutline__")>-1)return"__SpreadsheetTransformerOutline__";if(e.indexOf("__SpreadsheetTransformerRotate__")>-1)return"__SpreadsheetTransformerRotate__";if(e.indexOf("__SpreadsheetTransformerRotateLine__")>-1)return"__SpreadsheetTransformerRotateLine__";if(e.indexOf("__SpreadsheetTransformerResizeLT__")>-1)return"__SpreadsheetTransformerResizeLT__";if(e.indexOf("__SpreadsheetTransformerResizeCT__")>-1)return"__SpreadsheetTransformerResizeCT__";if(e.indexOf("__SpreadsheetTransformerResizeRT__")>-1)return"__SpreadsheetTransformerResizeRT__";if(e.indexOf("__SpreadsheetTransformerResizeLM__")>-1)return"__SpreadsheetTransformerResizeLM__";if(e.indexOf("__SpreadsheetTransformerResizeRM__")>-1)return"__SpreadsheetTransformerResizeRM__";if(e.indexOf("__SpreadsheetTransformerResizeLB__")>-1)return"__SpreadsheetTransformerResizeLB__";if(e.indexOf("__SpreadsheetTransformerResizeCB__")>-1)return"__SpreadsheetTransformerResizeCB__";if(e.indexOf("__SpreadsheetTransformerResizeRB__")>-1)return"__SpreadsheetTransformerResizeRB__"}_updateControlIterator(e){this._transformerControlMap.forEach((n,r)=>{const i=this._selectedObjectMap.get(r);if(!i)return!0;e(n,i)})}_updateControl(){this._updateControlIterator((e,n)=>{const{left:r,top:i}=n.getState();e.transformByState({left:r,top:i}),e.show(),e.makeDirty(!0)})}_hideControl(){this._transformerControlMap.forEach(e=>{e.hide(),e.makeDirty(!0)})}_attachHover(e,n,r){e.onPointerEnterObserver.add(()=>{e.cursor=n}),e.onPointerLeaveObserver.add(()=>{e.cursor=r})}_clearControl(){this._transformerControlMap.forEach(e=>{e.dispose()}),this._transformerControlMap.clear(),this.onClearControlObservable.notifyObservers(null)}_createControl(e){const{left:n,top:r,height:i,width:o,angle:s,scaleX:a,scaleY:l,skewX:u,skewY:c,flipX:d,flipY:h}=e.getState(),f=e.oKey,m=this._selectedObjectMap.size,p=[];if(this.borderEnabled){const v=new qt(`__SpreadsheetTransformerOutline___${m}`,{zIndex:m-1,evented:!1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke,...this._getOutlinePosition(o,i,a,l)});p.push(v)}if(this.resizeEnabled){const{left:v,top:_}=this._getRotateAnchorPosition("__SpreadsheetTransformerRotateLine__",i,o,a,l),C=new qt(`__SpreadsheetTransformerRotateLine___${m}`,{zIndex:m-1,evented:!1,left:v,top:_,height:this.rotateAnchorOffset,width:1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke}),{left:y,top:S}=this._getRotateAnchorPosition("__SpreadsheetTransformerRotate__",i,o,a,l),E=this._getRotateAnchorCursor("__SpreadsheetTransformerRotate__"),w=new qt(`__SpreadsheetTransformerRotate___${m}`,{zIndex:m-1,left:y,top:S,height:this.rotateSize,width:this.rotateSize,radius:this.rotateCornerRadius,strokeWidth:this.borderStrokeWidth*2,stroke:this.borderStroke});this._attachEventToRotate(w),this._attachHover(w,E,Yt.DEFAULT),p.push(C,w)}if(this.resizeEnabled)for(let v=0,_=this.enabledAnchors.length;v<_;v++){if(this.enabledAnchors[v]!==1)continue;const C=bge[v],y=this._createResizeAnchor(C,e,m);this._attachEventToAnchor(y,C),p.push(y)}const g=new $3(`__SpreadsheetTransformer___${m}`,...p);return g.zIndex=m,g.evented=!1,g.transformByState({left:n,top:r}),this.getScene().addObject(g,2),this._transformerControlMap.set(f,g),this.onCreateControlObservable.notifyObservers(g),g}_getTopScene(){var e;return(e=this.getScene().getEngine())==null?void 0:e.activeScene}_moving(e,n,r){const{scrollX:i,scrollY:o}=xd(r),s=e-this._viewportScrollX+i,a=n-this._viewportScrollY+o,l=s-this._startOffsetX,u=a-this._startOffsetY;this._selectedObjectMap.forEach(c=>{c.translate(l+c.left,u+c.top)}),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:l,moveY:u,type:1}),this._startOffsetX=s,this._startOffsetY=a}_updateActiveObjectList(e,n){this._selectedObjectMap.has(e.oKey)||(n.ctrlKey||(this._selectedObjectMap.clear(),this._clearControl()),this._selectedObjectMap.set(e.oKey,e),this._createControl(e))}_addCancelObserver(e){e.onPointerDownObserver.remove(this._cancelFocusObserver),this._cancelFocusObserver=e.onPointerDownObserver.add(n=>{this._selectedObjectMap.clear(),this._clearControl(),e.onPointerDownObserver.remove(this._cancelFocusObserver)})}};const Qc=class Od{constructor(e){M(this,"_alreadyAttached",!1),M(this,"_onInputObserver"),M(this,"_onPointerMove"),M(this,"_onPointerDown"),M(this,"_onPointerUp"),M(this,"_onPointerEnter"),M(this,"_onPointerLeave"),M(this,"_onMouseWheel"),M(this,"_onKeyDown"),M(this,"_onKeyUp"),M(this,"_scene"),M(this,"_currentMouseEnterPicked"),M(this,"_startingPosition",new Ft(1/0,1/0)),M(this,"_delayedTimeout",-1),M(this,"_delayedTripeTimeout",-1),M(this,"_doubleClickOccurred",0),M(this,"_tripleClickState",!1),M(this,"_currentObject"),this._scene=e}mouseLeaveEnterHandler(e){var n;const r=this._currentObject;if(r==null)(n=this._currentMouseEnterPicked)==null||n.triggerPointerLeave(e),this._currentMouseEnterPicked=null;else if(r!==this._currentMouseEnterPicked){const i=this._currentMouseEnterPicked;this._currentMouseEnterPicked=r,i==null||i.triggerPointerLeave(e),r==null||r.triggerPointerEnter(e)}}attachControl(e=!0,n=!0,r=!0,i=!0,o=!0,s=!0){const a=this._scene.getEngine();a&&(this._onPointerEnter=l=>{var u;l.pointerId===void 0&&(l.pointerId=0),this._currentObject=this._getCurrentObject(l.offsetX,l.offsetY),(u=this._currentObject)==null||u.triggerPointerMove(l),this.mouseLeaveEnterHandler(l)},this._onPointerLeave=l=>{l.pointerId===void 0&&(l.pointerId=0),this._currentObject=null,this.mouseLeaveEnterHandler(l)},this._onPointerMove=l=>{var u;l.pointerId===void 0&&(l.pointerId=0),this._currentObject=this._getCurrentObject(l.offsetX,l.offsetY);const c=(u=this._currentObject)==null?void 0:u.triggerPointerMove(l);this.mouseLeaveEnterHandler(l),this._checkDirectSceneEventTrigger(!c,this._currentObject)&&this._scene.onPointerMoveObserver.hasObservers()&&this._scene.onPointerMoveObserver.notifyObservers(l)},this._onPointerDown=l=>{l.pointerId===void 0&&(l.pointerId=0);const u=this._getCurrentObject(l.offsetX,l.offsetY),c=u==null?void 0:u.triggerPointerDown(l);this._checkDirectSceneEventTrigger(!c,u)&&this._scene.onPointerDownObserver.hasObservers()&&this._scene.onPointerDownObserver.notifyObservers(l)},this._onPointerUp=l=>{l.pointerId===void 0&&(l.pointerId=0);const u=this._getCurrentObject(l.offsetX,l.offsetY),c=u==null?void 0:u.triggerPointerUp(l);this._checkDirectSceneEventTrigger(!c,u)&&this._scene.onPointerUpObserver.hasObservers()&&this._scene.onPointerUpObserver.notifyObservers(l),this._prePointerDoubleOrTripleClick(l)},this._onMouseWheel=l=>{const u=this._getCurrentObject(l.offsetX,l.offsetY),c=u==null?void 0:u.triggerMouseWheel(l);this._scene.getViewports().forEach(d=>{d.onMouseWheelObserver.hasObservers()&&d.onMouseWheelObserver.notifyObservers(l)}),this._checkDirectSceneEventTrigger(!c,u)&&this._scene.onMouseWheelObserver.hasObservers()&&this._scene.onMouseWheelObserver.notifyObservers(l)},this._onKeyDown=l=>{this._scene.onKeyDownObservable.hasObservers()&&this._scene.onKeyDownObservable.notifyObservers(l)},this._onKeyUp=l=>{this._scene.onKeyUpObservable.hasObservers()&&this._scene.onKeyUpObservable.notifyObservers(l)},this._onInputObserver=a.onInputChangedObservable.add(l=>{const u=l;l.deviceType===Qo.Keyboard&&(l.currentState===1&&this._onKeyDown(u),l.currentState===0&&this._onKeyUp(u)),(l.deviceType===Qo.Mouse||l.deviceType===Qo.Touch)&&(e&&l.inputIndex>=xt.LeftClick&&l.inputIndex<=xt.RightClick&&l.currentState===1&&this._onPointerDown(u),n&&l.inputIndex>=xt.LeftClick&&l.inputIndex<=xt.RightClick&&l.currentState===0&&this._onPointerUp(u),r&&(l.inputIndex===xt.Horizontal||l.inputIndex===xt.Vertical||l.inputIndex===xt.DeltaHorizontal||l.inputIndex===xt.DeltaVertical)?this._onPointerMove(u):i&&(l.inputIndex===xt.MouseWheelX||l.inputIndex===xt.MouseWheelY||l.inputIndex===xt.MouseWheelZ)?this._onMouseWheel(u):o&&l.currentState===2?this._onPointerEnter(u):s&&l.currentState===3&&this._onPointerLeave(u))}),this._alreadyAttached=!0)}detachControl(){if(!this._alreadyAttached)return;const e=this._scene.getEngine();e&&(e.onInputChangedObservable.remove(this._onInputObserver),this._alreadyAttached=!1)}_getCurrentObject(e,n){var r;return(r=this._scene)==null?void 0:r.pick(Ft.FromArray([e,n]))}_checkDirectSceneEventTrigger(e,n){let r=!1;n==null&&(r=!0);let i=!0;if(n&&n.classType===Bt.BASE_OBJECT){const o=n.getScene();o&&(i=o.getParent().classType!==Bt.SCENE_VIEWER)}return!this._scene.evented&&e&&i||r}_isPointerSwiping(e,n){return Math.abs(this._startingPosition.x-e)>Od.DragMovementThreshold||Math.abs(this._startingPosition.y-n)>Od.DragMovementThreshold}_prePointerDoubleOrTripleClick(e){var n,r,i,o;const{clientX:s,clientY:a}=e;this._isPointerSwiping(s,a)&&this._resetDoubleClickParam(),this._delayedTimeout=setTimeout(()=>{this._resetDoubleClickParam()},Od.DoubleClickDelay),this._doubleClickOccurred+=1,this._tripleClickState&&((r=(n=this._scene)==null?void 0:n.pick(Ft.FromArray([e.offsetX,e.offsetY])))==null||r.triggerTripleClick(e),this._scene.onTripleClickObserver.hasObservers()&&this._scene.onTripleClickObserver.notifyObservers(e)),this._doubleClickOccurred===2&&((o=(i=this._scene)==null?void 0:i.pick(Ft.FromArray([e.offsetX,e.offsetY])))==null||o.triggerDblclick(e),this._scene.onDblclickObserver.hasObservers()&&this._scene.onDblclickObserver.notifyObservers(e),this._resetDoubleClickParam(),this._tripleClickState=!0,clearTimeout(this._delayedTripeTimeout),this._delayedTripeTimeout=setTimeout(()=>{this._tripleClickState=!1},Od.TripleClickDelay)),this._startingPosition.x=s,this._startingPosition.y=a}_resetDoubleClickParam(){this._doubleClickOccurred=0,clearTimeout(this._delayedTimeout)}};M(Qc,"DragMovementThreshold",2),M(Qc,"LongPressDelay",500),M(Qc,"DoubleClickDelay",500),M(Qc,"TripleClickDelay",300),M(Qc,"ExclusiveDoubleClickMode",!1);let yge=Qc,Sge=class{constructor(e){M(this,"onTransformChangeObservable",new Sn),M(this,"onPointerDownObserver",new Sn),M(this,"onPointerMoveObserver",new Sn),M(this,"onPointerUpObserver",new Sn),M(this,"onPointerEnterObserver",new Sn),M(this,"onPointerLeaveObserver",new Sn),M(this,"onDblclickObserver",new Sn),M(this,"onTripleClickObserver",new Sn),M(this,"onMouseWheelObserver",new Sn),M(this,"onKeyDownObservable",new Sn),M(this,"onKeyUpObservable",new Sn),M(this,"debounceParentTimeout",-1),M(this,"_sceneKey",""),M(this,"_width",100),M(this,"_height",100),M(this,"_scaleX",1),M(this,"_scaleY",1),M(this,"_transform",new Ea),M(this,"_evented",!0),this._sceneKey=e}get classType(){return Bt.SCENE}get transform(){return this._transform}get width(){return this._width}get height(){return this._height}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get sceneKey(){return this._sceneKey}get evented(){return this._evented}set transform(e){this._transform=e}set width(e){this._width=e}set height(e){this._height=e}set scaleX(e){this._scaleX=e}set scaleY(e){this._scaleY=e}enableEvent(){this._evented=!0}disableEvent(){this._evented=!1}on(e,n){return this[`on${e}Observer`].add(n.bind(this))}off(e,n){this[`on${e}Observer`].remove(n)}remove(e){this[`on${e}Observer`].clear()}triggerKeyDown(e){this.onKeyDownObservable.notifyObservers(e)}triggerKeyUp(e){this.onKeyUpObservable.notifyObservers(e)}triggerPointerUp(e){}triggerMouseWheel(e){}triggerPointerMove(e){}triggerDblclick(e){}triggerTripleClick(e){}triggerPointerDown(e){}triggerPointerOut(e){}triggerPointerLeave(e){}triggerPointerOver(e){}triggerPointerEnter(e){}renderObjects(e,n){}render(e){}getParent(){}dispose(){}getObject(e){}addObject(e,n=1){}addObjects(e,n=1){}getEngine(){}setObjectBehavior(e){}applyTransformer(e){}makeDirtyNoParent(e=!0){return this}makeDirty(e=!0){return this}pick(e){}getViewports(){return[]}removeViewport(e){}getAncestorScale(){return{scaleX:1,scaleY:1}}},Ege=class extends Sge{constructor(e,n,r){var i;if(super(e),M(this,"_layers",[]),M(this,"_viewports",[]),M(this,"_cursor",Yt.DEFAULT),M(this,"_defaultCursor",Yt.DEFAULT),M(this,"_addObject$",new rn(this)),M(this,"addObject$",this._addObject$.asObservable()),M(this,"_transformer"),M(this,"_transformerOpenState",!1),M(this,"_inputManager"),this._parent=n,r&&this.transformByState(r),this._parent.classType===Bt.ENGINE){const o=this._parent;o.addScene(this),o.hasActiveScene()||o.setActiveScene(e),this._inputManager=new yge(this)}else this._parent.classType===Bt.SCENE_VIEWER&&this._parent.addSubScene(this);(i=this._parent)==null||i.onTransformChangeObservable.add(o=>{this._setTransForm()})}get ancestorScaleX(){const e=this.getParent();let n=1;return e.classType===Bt.SCENE_VIEWER&&(n=e.ancestorScaleX),this.scaleX*n}get ancestorScaleY(){const e=this.getParent();let n=1;return e.classType===Bt.SCENE_VIEWER&&(n=e.ancestorScaleY),this.scaleY*n}set cursor(e){this.setCursor(e)}attachControl(e=!0,n=!0,r=!0,i=!0){var o;if(this._parent.classType===Bt.ENGINE)return(o=this._inputManager)==null||o.attachControl(e,n,r,i),this}detachControl(){var e;return(e=this._inputManager)==null||e.detachControl(),this}makeDirty(e=!0){var n;return this._layers.forEach(r=>{r.makeDirty(e)}),this._parent.classType===Bt.SCENE_VIEWER&&((n=this._parent)==null||n.makeDirty(e)),this}makeDirtyNoParent(e=!0){return this._viewports.forEach(n=>{n.makeDirty(e)}),this}enableLayerCache(...e){e.forEach(n=>{this.getLayer(n).enableCache()})}disableLayerCache(...e){e.forEach(n=>{this.getLayer(n).disableCache()})}isDirty(){for(let e=0;e<this._layers.length;e++)if(this._layers[e].isDirty()===!0)return!0;return!1}getCursor(){return this._cursor}resetCursor(){this.setCursor(this._defaultCursor)}setCursor(e){this._cursor=e;const n=this.getEngine();n&&n.setCanvasCursor(e)}setDefaultCursor(e){this._defaultCursor=e,this.resetCursor()}resize(e,n){const r=this.width;e!==void 0&&(this.width=e);const i=this.height;return n!==void 0&&(this.height=n),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:lo.resize,value:{width:this.width,height:this.height},preValue:{width:r,height:i}}),this}scale(e,n){const r=this.scaleX;e!==void 0&&(this.scaleX=e);const i=this.scaleY;return n!==void 0&&(this.scaleY=n),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:lo.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:r,scaleY:i}}),this}scaleBy(e,n){const r=this.scaleX;e!==void 0&&(this.scaleX+=e);const i=this.scaleY;return n!==void 0&&(this.scaleY+=n),this.scaleX=yv(this.scaleX,1),this.scaleY=yv(this.scaleY,1),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:lo.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:r,scaleY:i}}),this}transformByState(e){const n=Object.keys(e),r={};n.length!==0&&(n.forEach(i=>{e[i]!==void 0&&(r[i]=this[i],this[i]=e[i])}),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:lo.all,value:e,preValue:r}))}getParent(){return this._parent}getEngine(){if(this._parent.classType===Bt.ENGINE)return this._parent;let e=this._parent;for(;e;){if(e.classType===Bt.ENGINE)return e;e=e==null?void 0:e.getParent()}return null}getLayers(){return this._layers}getLayer(e=1){for(const n of this._layers)if(n.zIndex===e)return n;return this._createDefaultLayer(e)}getLayerMaxZIndex(){let e=Number.MIN_VALUE;for(let n=0;n<this._layers.length;n++){const r=this._layers[n];r.zIndex>=e&&(e=r.zIndex)}return e}addLayer(...e){this._layers.push(...e)}addObject(e,n=1){var r;return(r=this.getLayer(n))==null||r.addObject(e),this._addObject$.next(this),this}setObjectBehavior(e){e.parent||(e.parent=this),e.onIsAddedToParentObserver.notifyObservers(this)}addObjects(e,n=1){var r;return(r=this.getLayer(n))==null||r.addObjects(e),this._addObject$.next(this),this}removeObject(e){if(e==null)return;const n=this.getLayers();for(const r of n)r.removeObject(e);return this}removeObjects(e){if(e==null)return;const n=this.getLayers();for(const r of n)r.removeObjects(e);return this}getAllObjects(){const e=[];this._layers.sort(Ns);for(const n of this._layers)e.push(...n.getObjectsByOrder());return e}getAllObjectsByOrder(e=!1){const n=[],r=e?SS:Ns;this._layers.sort(r);for(const i of this._layers)n.push(...i.getObjectsByOrder().sort(r));return n}getAllObjectsByOrderForPick(e=!1){const n=[],r=e?SS:Ns;this._layers.sort(r);for(const i of this._layers)n.push(...i.getObjectsByOrderForPick().sort(r));return n}getObject(e){for(const n of this._layers){const r=n.getObjectsByOrder();for(const i of r)if(i.oKey===e)return i}}fuzzyMathObjects(e){const n=[];for(const r of this._layers){const i=r.getObjectsByOrder();for(const o of i)o.oKey.indexOf(e)>-1&&i.push(o)}return n}addViewport(...e){return this._viewports.push(...e),this}removeViewport(e){for(let n=0,r=this._viewports.length;n<r;n++){const i=this._viewports[n];if(i.viewPortKey===e)return this._viewports.splice(n,1),i}}getViewports(){return this._viewports}getViewport(e){for(const n of this._viewports)if(n.viewPortKey===e)return n}changeObjectOrder(){}render(e){var n;if(!this.isDirty())return;!e&&((n=this.getEngine())==null||n.clearCanvas());const r=this._layers.sort(Ns);for(let i=0,o=r.length;i<o;i++)r[i].render(e,i===o-1)}async requestRender(e){return new Promise((n,r)=>{this.render(e),qh(n)})}openTransformer(e){this._transformer||(this._transformer=new Cge(this,e)),this._transformerOpenState=!0}closeTransformer(e=!1){e&&(this._transformer=null),this._transformerOpenState=!1}applyTransformer(e){var n;this._transformerOpenState&&((n=this._transformer)==null||n.attachTo(e))}getTransformer(){return this._transformer}getActiveViewportByRelativeCoord(e){return this._viewports.find(n=>n.isHit(e))}getActiveViewportByCoord(e){return e=this.getRelativeCoord(e),this.getActiveViewportByRelativeCoord(e)}getScrollXYByRelativeCoords(e,n){return n||(n=this.getActiveViewportByRelativeCoord(e)),n?this.getScrollXY(n):{x:0,y:0}}getScrollXY(e){let n=0,r=0;if(e){const i=e.actualScrollX||0,o=e.actualScrollY||0;n+=i,r+=o}return{x:n,y:r}}getRelativeCoord(e){let n=this.getParent();const r=[];for(;n;)(n.classType===Bt.SCENE||n.classType===Bt.SCENE_VIEWER)&&r.push(n),n=(n==null?void 0:n.getParent)&&(n==null?void 0:n.getParent());r.reverse();for(const i of r)if(i.classType===Bt.SCENE){const o=i.getActiveViewportByCoord(e);if(o){const s=o.actualScrollX||0,a=o.actualScrollY||0;e=e.addByPoint(s,a)}}else i.classType===Bt.SCENE_VIEWER&&(e=i.transform.clone().invert().applyPoint(e));return e}clearLayer(){this._layers=[]}clearViewports(){this._viewports=[]}getAncestorScale(){let{scaleX:e=1,scaleY:n=1}=this;return this.classType===Bt.SCENE_VIEWER&&(e=this.ancestorScaleX||1,n=this.ancestorScaleY||1),{scaleX:e,scaleY:n}}dispose(){var e;this.getLayers().forEach(n=>{n.dispose()}),this.getViewports().forEach(n=>{n.dispose()}),this.clearLayer(),this.clearViewports(),this.detachControl(),(e=this._transformer)==null||e.dispose(),this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onPointerEnterObserver.clear(),this.onPointerLeaveObserver.clear(),this.onDblclickObserver.clear(),this.onTripleClickObserver.clear(),this.onMouseWheelObserver.clear(),this.onKeyDownObservable.clear(),this.onKeyUpObservable.clear()}pick(e){let n=this.getActiveViewportByCoord(e);if(n||(n=this._viewports[0]),!this.evented||!n)return;const r=n.pickScrollBar(e);if(r)return r;const i=n.getRelativeVector(e);let o=null;const s=this.getAllObjectsByOrderForPick().reverse(),a=s.length;for(let l=0;l<a;l++){const u=s[l];if(!u.visible||!u.evented||u.classType===Bt.GROUP)continue;let c=i;if(u.isInGroup&&u.parent.classType===Bt.GROUP){const{cumLeft:d,cumTop:h}=this._getGroupCumLeftRight(u);c=c.clone().add(Ft.FromArray([-d,-h]))}if(u.isHit(c)){if(u.classType===Bt.SCENE_VIEWER){const d=u.pick(c);d?o=d:o=u.getActiveSubScene()}else o=u;break}else if(u.classType===Bt.SCENE_VIEWER&&u.allowSelectedClipElement()){const d=u.pick(c);if(d){o=d;break}}}return!o&&this._parent.classType===Bt.ENGINE?this:o}triggerKeyDown(e){this.onKeyDownObservable.notifyObservers(e)}triggerKeyUp(e){this.onKeyUpObservable.notifyObservers(e)}triggerPointerUp(e){var n,r;return!((n=this.onPointerUpObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===Bt.SCENE_VIEWER?((r=this._parent)==null||r.triggerPointerUp(e),!1):!0}triggerMouseWheel(e){var n,r;return!((n=this.onMouseWheelObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===Bt.SCENE_VIEWER?((r=this._parent)==null||r.triggerMouseWheel(e),!1):!0}triggerPointerMove(e){var n,r;return!((n=this.onPointerMoveObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===Bt.SCENE_VIEWER?((r=this._parent)==null||r.triggerPointerMove(e),!1):!0}triggerDblclick(e){var n,r;return!((n=this.onDblclickObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===Bt.SCENE_VIEWER?((r=this._parent)==null||r.triggerDblclick(e),!1):!0}triggerTripleClick(e){var n,r;return!((n=this.onTripleClickObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===Bt.SCENE_VIEWER?((r=this._parent)==null||r.triggerTripleClick(e),!1):!0}triggerPointerDown(e){var n,r;return!((n=this.onPointerDownObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===Bt.SCENE_VIEWER?((r=this._parent)==null||r.triggerPointerDown(e),!1):!0}triggerPointerOut(e){var n;return this._parent.classType===Bt.SCENE_VIEWER?((n=this._parent)==null||n.triggerPointerOut(e),!1):!0}triggerPointerLeave(e){var n,r;return!((n=this.onPointerLeaveObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===Bt.SCENE_VIEWER?((r=this._parent)==null||r.triggerPointerLeave(e),!1):!0}triggerPointerOver(e){var n;return this._parent.classType===Bt.SCENE_VIEWER?((n=this._parent)==null||n.triggerPointerOver(e),!1):!0}triggerPointerEnter(e){var n,r;return!((n=this.onPointerEnterObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===Bt.SCENE_VIEWER?((r=this._parent)==null||r.triggerPointerEnter(e),!1):!0}_createDefaultLayer(e=1){const n=new F6(this,[],e);return this.addLayer(n),n}_setTransForm(){const e=Ea.create().composeMatrix({scaleX:this.scaleX,scaleY:this.scaleY});this.transform=e,this.getViewports().forEach(n=>{n.resetSizeAndScrollBar()}),this.makeDirty(!0)}_getGroupCumLeftRight(e){let n=e.parent,r=0,i=0;for(;n.classType===Bt.GROUP;){const{left:o,top:s}=n;r+=o,i+=s,n=n.parent}return{cumLeft:r,cumTop:i}}};const wge={width:1500,height:1e3},Rge="_UNIVER_SCENE_";let Dge=class{constructor(){M(this,"_defaultEngine",new Av),M(this,"_currentUnitId",""),M(this,"_renderMap",new Map),M(this,"_currentRender$",new rn(this._currentUnitId)),M(this,"currentRender$",this._currentRender$.asObservable())}get defaultEngine(){return this._defaultEngine}dispose(){this._renderMap.forEach(e=>{this._disposeItem(e)}),this._renderMap.clear(),this._currentRender$.complete()}createRenderWithParent(e,n){const r=this.getRenderById(n);if(r==null)throw new Error("parent render is null");const{scene:i,engine:o}=r,s=this._createRender(e,o,!1),a=s.scene,l=new vge(e);return l.addSubScene(a),i.addObject(l),s}createRender(e){const n=new Av;return this._createRender(e,n)}_createRender(e,n,r=!0){const i=this.getRenderById(e);let o=!0;i!=null&&i.engine===n&&(o=!1),this._disposeItem(i,o);const{width:s,height:a}=wge,l=new Ege(Rge+e,n,{width:s,height:a}),u={unitId:e,engine:n,scene:l,mainComponent:null,components:new Map,isMainScene:r};return this.addItem(e,u),u}addItem(e,n){this._renderMap.set(e,n)}removeItem(e){const n=this._renderMap.get(e);n!=null&&this._disposeItem(n),this._renderMap.delete(e)}setCurrent(e){this._currentUnitId=e,this._currentRender$.next(e)}getCurrent(){return this.getRenderById(this._currentUnitId)}getRenderById(e){return this._renderMap.get(e)}getRenderAll(){return this._renderMap}_disposeItem(e,n=!0){if(e==null)return;const{engine:r,scene:i,components:o,mainComponent:s}=e;o==null||o.forEach(a=>{a.dispose()}),s==null||s.dispose(),i.dispose(),n&&r.dispose()}};const kn=nn("univer.render-manager-service");var Ige=Object.defineProperty,xge=Object.getOwnPropertyDescriptor,Mge=(t,e,n,r)=>{for(var i=r>1?void 0:r?xge(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Ige(e,n,i),i},Oge=(t,e)=>(n,r)=>e(n,r,t);const Tge=nn("univer.render-engine"),$ge="render-engine";var Xm;let Nv=(Xm=class extends S1{constructor(t,e){super($ge),this._injector=e,this._injector.add([Tge,{useFactory:()=>new Av}]),this._injector.add([kn,{useClass:Dge}])}},M(Xm,"type",dr.Univer),Xm);Nv=Mge([Oge(1,ne(Tn))],Nv);let kge=class{constructor(){M(this,"enableHorizontal",!0),M(this,"enableVertical",!0),M(this,"horizontalThumbWidth",0),M(this,"horizontalMinusMiniThumb",0),M(this,"horizontalBarWidth",0),M(this,"verticalThumbHeight",0),M(this,"verticalBarHeight",0),M(this,"verticalMinusMiniThumb",0),M(this,"horizonBarRect"),M(this,"horizonThumbRect"),M(this,"verticalBarRect"),M(this,"verticalThumbRect"),M(this,"placeholderBarRect")}get limitX(){var e;return(e=this.horizonThumbRect)!=null&&e.visible?this.horizontalBarWidth-this.horizontalThumbWidth:0}get limitY(){var e;return(e=this.verticalThumbRect)!=null&&e.visible?this.verticalBarHeight-this.verticalThumbHeight:0}get ratioScrollX(){return this.enableHorizontal===!1||this.horizontalThumbWidth===void 0||this.horizontalBarWidth===void 0?1:(this.horizontalThumbWidth-this.horizontalMinusMiniThumb)*this.miniThumbRatioX/this.horizontalBarWidth}get ratioScrollY(){return this.enableVertical===!1||this.verticalThumbHeight===void 0||this.verticalBarHeight===void 0?1:(this.verticalThumbHeight-this.verticalMinusMiniThumb)*this.miniThumbRatioY/this.verticalBarHeight}get miniThumbRatioX(){const e=this.horizontalBarWidth-this.horizontalThumbWidth;if(e===0)return 0;const n=this.horizontalBarWidth-(this.horizontalThumbWidth-this.horizontalMinusMiniThumb);return n===0?0:e/n}get miniThumbRatioY(){const e=this.verticalBarHeight-this.verticalThumbHeight;if(e===0)return 0;const n=this.verticalBarHeight-(this.verticalThumbHeight-this.verticalMinusMiniThumb);return n===0?0:e/n}pick(e){var n,r,i,o;return(n=this.horizonThumbRect)!=null&&n.isHit(e)?this.horizonThumbRect:(r=this.verticalThumbRect)!=null&&r.isHit(e)?this.verticalThumbRect:(i=this.horizonBarRect)!=null&&i.isHit(e)?this.horizonBarRect:(o=this.verticalBarRect)!=null&&o.isHit(e)?this.verticalBarRect:null}dispose(){var e,n,r,i,o;(e=this.horizonBarRect)==null||e.dispose(),(n=this.horizonThumbRect)==null||n.dispose(),(r=this.verticalBarRect)==null||r.dispose(),(i=this.verticalThumbRect)==null||i.dispose(),(o=this.placeholderBarRect)==null||o.dispose()}hasHorizonThumb(){var e;return((e=this.horizonThumbRect)==null?void 0:e.visible)||!1}hasVerticalThumb(){var e;return((e=this.verticalThumbRect)==null?void 0:e.visible)||!1}resize(e=0,n=0,r=0,i=0){}makeDirty(e){}render(e,n=0,r=0){}};const Ac=17;class b0 extends kge{constructor(e,n){super(),M(this,"_view"),M(this,"_mainScene"),M(this,"_lastX",-1),M(this,"_lastY",-1),M(this,"_isHorizonMove",!1),M(this,"_isVerticalMove",!1),M(this,"_horizonPointerMoveObserver"),M(this,"_horizonPointerUpObserver"),M(this,"_verticalPointerMoveObserver"),M(this,"_verticalPointerUpObserver"),M(this,"barSize",14),M(this,"barBorder",1),M(this,"thumbMargin",2),M(this,"thumbLengthRatio",1),M(this,"thumbBackgroundColor","#cccccc"),M(this,"thumbHoverBackgroundColor","#b2b2b2"),M(this,"thumbActiveBackgroundColor","#999999"),M(this,"barBackgroundColor","rgba(255,255,255,0.5)"),M(this,"barBorderColor","rgba(255,255,255,0.7)"),e||console.warn("Missing viewport"),this.setProps(n),this._view=e,this._initialScrollRect(),this._view.setScrollBar(this)}static attachTo(e,n){return new b0(e,n)}dispose(){var e,n,r,i;super.dispose(),(e=this._mainScene)==null||e.onPointerMoveObserver.remove(this._horizonPointerMoveObserver),(n=this._mainScene)==null||n.onPointerMoveObserver.remove(this._verticalPointerMoveObserver),(r=this._mainScene)==null||r.onPointerUpObserver.remove(this._horizonPointerUpObserver),(i=this._mainScene)==null||i.onPointerUpObserver.remove(this._verticalPointerUpObserver),this._mainScene=null,this._view.removeScrollBar()}render(e,n=0,r=0){const{scrollX:i,scrollY:o}=this._view;e.save();const s=new Ea([1,0,0,1,n,r]).getMatrix();e.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this.enableHorizontal&&(this.horizonBarRect.render(e),this.horizonThumbRect.translate(i).render(e)),this.enableVertical&&(this.verticalBarRect.render(e),this.verticalThumbRect.translate(void 0,o).render(e)),this.enableHorizontal&&this.enableVertical&&this.placeholderBarRect.render(e),e.restore()}resize(e=0,n=0,r=0,i=0){var o;e===0&&e===0||(this._resizeHorizontal(e,n,r),this._resizeVertical(e,n,i),this.enableHorizontal&&this.enableVertical&&((o=this.placeholderBarRect)==null||o.transformByState({left:e-this.barSize,top:n-this.barSize,width:this.barSize-this.barBorder,height:this.barSize-this.barBorder})))}makeDirty(e){var n,r,i,o,s;(n=this.horizonBarRect)==null||n.makeDirty(e),(r=this.horizonThumbRect)==null||r.makeDirty(e),(i=this.verticalBarRect)==null||i.makeDirty(e),(o=this.verticalThumbRect)==null||o.makeDirty(e),(s=this.placeholderBarRect)==null||s.makeDirty(e),this.makeViewDirty(e)}makeViewDirty(e){(this._mainScene||this._view.scene).makeDirty(e)}pick(e){var n,r,i,o;return(n=this.horizonThumbRect)!=null&&n.isHit(e)?this.horizonThumbRect:(r=this.verticalThumbRect)!=null&&r.isHit(e)?this.verticalThumbRect:(i=this.horizonBarRect)!=null&&i.isHit(e)?this.horizonBarRect:(o=this.verticalBarRect)!=null&&o.isHit(e)?this.verticalBarRect:null}setProps(e){if(!e)return;const n=Object.keys(e);n.length!==0&&n.forEach(r=>{e[r]!==void 0&&(this[`${r}`]=e[r])})}_resizeHorizontal(e,n,r){var i,o,s,a,l;this.enableHorizontal&&(this.horizontalMinusMiniThumb=0,this.horizontalBarWidth=e-(this.enableVertical?this.barSize:0)-this.barBorder,this.horizontalThumbWidth=this.horizontalBarWidth*(this.horizontalBarWidth-this.barBorder)/r*this.thumbLengthRatio,this.horizontalThumbWidth<Ac&&(this.horizontalMinusMiniThumb=Ac-this.horizontalThumbWidth,this.horizontalThumbWidth=Ac),(i=this.horizonBarRect)==null||i.transformByState({left:0,top:n-this.barSize,width:this.horizontalBarWidth,height:this.barSize-this.barBorder}),this.horizontalThumbWidth>=e?(o=this.horizonThumbRect)==null||o.setProps({visible:!1}):((s=this.horizonThumbRect)!=null&&s.visible||(a=this.horizonThumbRect)==null||a.setProps({visible:!0}),(l=this.horizonThumbRect)==null||l.transformByState({left:this._view.scrollX,top:n-this.barSize+this.thumbMargin,width:this.horizontalThumbWidth,height:this.barSize-this.thumbMargin*2})))}_resizeVertical(e,n,r){var i,o,s,a,l;this.enableVertical&&(this.verticalMinusMiniThumb=0,this.verticalBarHeight=n-(this.enableHorizontal?this.barSize:0)-this.barBorder,this.verticalThumbHeight=this.verticalBarHeight*this.verticalBarHeight/r*this.thumbLengthRatio,this.verticalThumbHeight<Ac&&(this.verticalMinusMiniThumb=Ac-this.verticalThumbHeight,this.verticalThumbHeight=Ac),(i=this.verticalBarRect)==null||i.transformByState({left:e-this.barSize,top:0,width:this.barSize-this.barBorder,height:this.verticalBarHeight}),this.verticalThumbHeight>=n-this.barSize?(o=this.verticalThumbRect)==null||o.setProps({visible:!1}):((s=this.verticalThumbRect)!=null&&s.visible||(a=this.verticalThumbRect)==null||a.setProps({visible:!0}),(l=this.verticalThumbRect)==null||l.transformByState({left:e-this.barSize+this.thumbMargin,top:this._view.scrollY,width:this.barSize-this.thumbMargin*2,height:this.verticalThumbHeight})))}_initialScrollRect(){this.enableHorizontal&&(this.horizonBarRect=new qt("__horizonBarRect__",{fill:this.barBackgroundColor,strokeWidth:this.barBorder,stroke:this.barBorderColor}),this.horizonThumbRect=new qt("__horizonThumbRect__",{radius:6,fill:this.thumbBackgroundColor})),this.enableVertical&&(this.verticalBarRect=new qt("__verticalBarRect__",{fill:this.barBackgroundColor,strokeWidth:this.barBorder,stroke:this.barBorderColor}),this.verticalThumbRect=new qt("__verticalThumbRect__",{radius:6,fill:this.thumbBackgroundColor})),this.enableHorizontal&&this.enableVertical&&(this.placeholderBarRect=new qt("__placeholderBarRect__",{fill:this.barBackgroundColor,strokeWidth:this.barBorder,stroke:this.barBorderColor})),this._initialVerticalEvent(),this._initialHorizontalEvent()}_initialVerticalEvent(){var e,n,r,i;if(!this.enableVertical)return;const o=this._mainScene||this._view.scene;(e=this.verticalThumbRect)==null||e.on(ca.PointerEnter,this._hoverFunc(this.thumbHoverBackgroundColor,this.verticalThumbRect)),(n=this.verticalThumbRect)==null||n.on(ca.PointerLeave,this._hoverFunc(this.thumbBackgroundColor,this.verticalThumbRect)),(r=this.verticalBarRect)==null||r.on(ca.PointerDown,(s,a)=>{const l=s;this._view.scrollTo({y:l.offsetY-this._view.top-this.verticalThumbHeight/2}),a.stopPropagation()}),(i=this.verticalThumbRect)==null||i.on(ca.PointerDown,(s,a)=>{const l=s,u=this.verticalThumbRect;this._isVerticalMove=!0,this._lastX=l.offsetX,this._lastY=l.offsetY,u==null||u.setProps({fill:this.thumbActiveBackgroundColor}),o.disableEvent(),this.makeViewDirty(!0),a.stopPropagation()}),this._verticalPointerMoveObserver=o.onPointerMoveObserver.add((s,a)=>{const l=s;this._isVerticalMove&&(this._view.scrollByBar({y:l.offsetY-this._lastY}),this._lastY=l.offsetY)}),this._verticalPointerUpObserver=o.onPointerUpObserver.add((s,a)=>{const l=this.verticalThumbRect;this._isVerticalMove=!1,o.enableEvent(),l==null||l.setProps({fill:this.thumbBackgroundColor}),this.makeViewDirty(!0)})}_hoverFunc(e,n){return(r,i)=>{this._isHorizonMove||this._isVerticalMove||(n.setProps({fill:e}),this.makeViewDirty(!0))}}_initialHorizontalEvent(){var e,n,r,i;if(!this.enableHorizontal)return;const o=this._mainScene||this._view.scene;(e=this.horizonThumbRect)==null||e.on(ca.PointerEnter,this._hoverFunc(this.thumbHoverBackgroundColor,this.horizonThumbRect)),(n=this.horizonThumbRect)==null||n.on(ca.PointerLeave,this._hoverFunc(this.thumbBackgroundColor,this.horizonThumbRect)),(r=this.horizonBarRect)==null||r.on(ca.PointerDown,(s,a)=>{const l=s;this._view.scrollTo({x:l.offsetX-this._view.left-this.horizontalThumbWidth/2}),a.stopPropagation()}),(i=this.horizonThumbRect)==null||i.on(ca.PointerDown,(s,a)=>{var l;const u=s;this._isHorizonMove=!0,this._lastX=u.offsetX,this._lastY=u.offsetY,(l=this.horizonThumbRect)==null||l.setProps({fill:this.thumbActiveBackgroundColor}),this.makeViewDirty(!0),o.disableEvent(),a.stopPropagation()}),this._horizonPointerMoveObserver=o.onPointerMoveObserver.add((s,a)=>{const l=s;this._isHorizonMove&&(this._view.scrollByBar({x:l.offsetX-this._lastX}),this._lastX=l.offsetX)}),this._horizonPointerUpObserver=o.onPointerUpObserver.add((s,a)=>{const l=this.horizonThumbRect;this._isHorizonMove=!1,o.enableEvent(),l==null||l.setProps({fill:this.thumbBackgroundColor}),this.makeViewDirty(!0)})}}const Age=3;class aa{constructor(e,n,r){M(this,"scrollX",0),M(this,"scrollY",0),M(this,"actualScrollX",0),M(this,"actualScrollY",0),M(this,"onMouseWheelObserver",new Sn),M(this,"onScrollAfterObserver",new Sn),M(this,"onScrollBeforeObserver",new Sn),M(this,"onScrollStopObserver",new Sn),M(this,"onScrollByBarObserver",new Sn),M(this,"_viewPortKey",""),M(this,"_dirty",!0),M(this,"_topOrigin",0),M(this,"_leftOrigin",0),M(this,"_bottomOrigin",0),M(this,"_rightOrigin",0),M(this,"_widthOrigin"),M(this,"_heightOrigin"),M(this,"_top",0),M(this,"_left",0),M(this,"_bottom",0),M(this,"_right",0),M(this,"_width"),M(this,"_height"),M(this,"_scene"),M(this,"_scrollBar"),M(this,"_isWheelPreventDefaultX",!1),M(this,"_isWheelPreventDefaultY",!1),M(this,"_scrollStopNum",0),M(this,"_preScrollX",0),M(this,"_preScrollY",0),M(this,"_renderClipState",!0),M(this,"_active",!0),M(this,"_paddingStartX",0),M(this,"_paddingEndX",0),M(this,"_paddingStartY",0),M(this,"_paddingEndY",0),M(this,"_isRelativeX",!1),M(this,"_isRelativeY",!1),M(this,"_preViewportBound");var i;this._viewPortKey=e,this._scene=n,(r==null?void 0:r.active)!=null&&(this._active=r.active),this._setWithAndHeight(r),this._isWheelPreventDefaultX=(r==null?void 0:r.isWheelPreventDefaultX)||!1,this._isWheelPreventDefaultY=(r==null?void 0:r.isWheelPreventDefaultY)||!1,this._resizeCacheCanvasAndScrollBar(),(i=this._scene)==null||i.getParent().onTransformChangeObservable.add(()=>{this._resizeCacheCanvasAndScrollBar()})}get scene(){return this._scene}get width(){return this._width}get height(){return this._height}get viewPortKey(){return this._viewPortKey}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get bottomOrigin(){return this._bottomOrigin}get rightOrigin(){return this._rightOrigin}get top(){return this._top}get left(){return this._left}get bottom(){return this._bottom}get right(){return this._right}get isWheelPreventDefaultX(){return this._isWheelPreventDefaultX}get isWheelPreventDefaultY(){return this._isWheelPreventDefaultY}set width(e){this._width=e}set height(e){this._height=e}get isActive(){return this._active===!1||(this.height||0)<=0||(this.width||0)<=0?!1:this._active}set top(e){var n,r;this._topOrigin=e,this._top=rl(e,(r=(n=this._scene)==null?void 0:n.getParent())==null?void 0:r.height)}set left(e){var n;this._leftOrigin=e,this._left=rl(e,(n=this.scene.getParent())==null?void 0:n.width)}set bottom(e){var n;this._bottomOrigin=e,this._bottom=rl(e,(n=this.scene.getParent())==null?void 0:n.height)}set right(e){var n;this._rightOrigin=e,this._right=rl(e,(n=this.scene.getParent())==null?void 0:n.width)}enable(){this._active=!0}disable(){this._active=!1}resetSizeAndScrollBar(){this._resizeCacheCanvasAndScrollBar()}setScrollBar(e){this._scrollBar&&console.warn("Old scrollBar will be replaced "),this._scrollBar=e,this._resizeCacheCanvasAndScrollBar()}removeScrollBar(){this._scrollBar=null}resize(e){Object.keys(e).length!==0&&(this._setWithAndHeight(e),this._resizeCacheCanvasAndScrollBar())}setPadding(e){const{startX:n=0,startY:r=0,endX:i=0,endY:o=0}=e;this._paddingStartX=n,this._paddingEndX=i,this._paddingStartY=r,this._paddingEndY=o,this._resizeCacheCanvasAndScrollBar()}resetPadding(){this.setPadding({startX:0,endX:0,startY:0,endY:0})}makeDirty(e=!0,n=!1){if(this._dirty=e,n){const r=this.scene.getParent();r.classType===Bt.SCENE_VIEWER&&r.makeDirty(!0)}}isDirty(){return this._dirty}scrollTo(e,n=!0){return this._scroll(0,e,n)}scrollBy(e,n=!0){return this._scroll(1,e,n)}scrollByBar(e,n=!0){var r,i;this._scroll(1,e,n);const{x:o,y:s}=e;this.onScrollByBarObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:o,y:s,actualScrollX:this.actualScrollX,actualScrollY:this.actualScrollY,limitX:(r=this._scrollBar)==null?void 0:r.limitX,limitY:(i=this._scrollBar)==null?void 0:i.limitY,isTrigger:n})}scrollByOffset(e=0,n=0,r=!0){if(!this._scrollBar||this.isActive===!1)return;const i=e+this._paddingStartX,o=n+this._paddingStartY,s=this.getBarScroll(i,o);return this.scrollBy(s,r)}getBarScroll(e,n){let r=e-this._paddingStartX,i=n-this._paddingStartY;if(this._scrollBar){r*=this._scrollBar.ratioScrollX,i*=this._scrollBar.ratioScrollY;const{scaleX:o,scaleY:s}=this.scene;r*=o,i*=s}else this.scrollX!==void 0&&(r=this.scrollX),this.scrollY!==void 0&&(i=this.scrollY);return{x:r,y:i}}getActualScroll(e,n){let r=e,i=n;if(this._scrollBar){const{scaleX:s,scaleY:a}=this.scene;this._scrollBar.ratioScrollX!==0?(r/=this._scrollBar.ratioScrollX,r/=s):this.actualScrollX!==void 0&&(r=this.actualScrollX),this._scrollBar.ratioScrollY!==0?(i/=this._scrollBar.ratioScrollY,i/=a):this.actualScrollY!==void 0&&(i=this.actualScrollY)}else this.actualScrollX!==void 0&&(r=this.actualScrollX),this.actualScrollY!==void 0&&(i=this.actualScrollY);const o=this._getScale();return{x:Et(r+this._paddingStartX,o),y:Et(i+this._paddingStartY,o)}}_getScale(){var e;const n=this._scene,r=((e=n.getEngine())==null?void 0:e.getPixelRatio())||1,{scaleX:i,scaleY:o}=n.getAncestorScale();return Math.max(i*r,o*r)}getTransformedScroll(){const e=this.scrollX,n=this.scrollY;return this.getActualScroll(e,n)}getScrollBar(){return this._scrollBar}updateScroll(e){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY;const{scrollX:n,scrollY:r,actualScrollX:i,actualScrollY:o}=e;return n!==void 0&&(this.scrollX=n),r!==void 0&&(this.scrollY=r),i!==void 0&&(this.actualScrollX=i),o!==void 0&&(this.actualScrollY=o),this}getScrollBarTransForm(){const e=Ea.create();return e.multiply(Ea.create([1,0,0,1,this._left,this._top])),e}render(e,n=[],r=!1){var i;if(this.isActive===!1)return;const o=e||((i=this._scene.getEngine())==null?void 0:i.getCanvas().getContext()),s=this._scene.transform.clone();o.getTransform(),s.multiply(Ea.create([1,0,0,1,-this.actualScrollX||0,-this.actualScrollY||0]));const a=o,l=s.getMatrix(),u=this.getScrollBarTransForm().getMatrix();if(a.save(),this._renderClipState){a.beginPath();const{scaleX:d,scaleY:h}=this._getBoundScale(l[0],l[3]);a.rect(this.left,this.top,(this.width||0)*d,(this.height||0)*h),a.clip()}a.transform(l[0],l[1],l[2],l[3],l[4],l[5]);const c=this._calViewportRelativeBounding();n.forEach(d=>{d.render(a,c)}),a.restore(),this._scrollBar&&r&&(a.save(),a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawScrollbar(a),a.restore()),this.makeDirty(!1),this._scrollRendered(),this._preViewportBound=c}getBounding(){return this._calViewportRelativeBounding()}getRelativeVector(e){const n=this.scene.transform.clone().invert(),r=this.getTransformedScroll();return n.applyPoint(e).add(Ft.FromArray([r.x,r.y]))}getAbsoluteVector(e){const n=this.scene.transform.clone(),r=this.getTransformedScroll();return n.applyPoint(e.subtract(Ft.FromArray([r.x,r.y])))}onMouseWheel(e,n){if(!this._scrollBar||this.isActive===!1)return;let r;if(e.inputIndex===xt.MouseWheelX){const i=Math.abs(e.deltaX),o=this._scene.width,s=(this.width||1)/o*i;e.deltaX>0?r=this.scrollBy({x:s}):r=this.scrollBy({x:-s}),this._scene.getParent().classType===Bt.SCENE_VIEWER?r!=null&&r.isLimitedX||n.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():r!=null&&r.isLimitedX||e.preventDefault()}if(e.inputIndex===xt.MouseWheelY){const i=Math.abs(e.deltaY),o=this._scene.height;let s=(this.height||1)/o*i;e.shiftKey?(s*=Age,e.deltaY>0?r=this.scrollBy({x:s}):r=this.scrollBy({x:-s}),this._scene.getParent().classType===Bt.SCENE_VIEWER?r!=null&&r.isLimitedX||n.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():r!=null&&r.isLimitedX||e.preventDefault()):(e.deltaY>0?r=this.scrollBy({y:s}):r=this.scrollBy({y:-s}),this._scene.getParent().classType===Bt.SCENE_VIEWER?r!=null&&r.isLimitedY||n.stopPropagation():this._isWheelPreventDefaultY?e.preventDefault():r!=null&&r.isLimitedY||e.preventDefault())}e.inputIndex,xt.MouseWheelZ,this._scene.makeDirty(!0)}isHit(e){if(this.isActive===!1)return;const{width:n,height:r}=this._getViewPortSize();return e.x>=this.left&&e.x<=this.left+(n||0)&&e.y>=this.top&&e.y<=this.top+(r||0)}pickScrollBar(e){if(!this._scrollBar)return;const n=this.getScrollBarTransForm().invert().applyPoint(e);return this._scrollBar.pick(n)}openClip(){this._renderClipState=!0}closeClip(){this._renderClipState=!1}dispose(){var e;this.onMouseWheelObserver.clear(),this.onScrollAfterObserver.clear(),this.onScrollBeforeObserver.clear(),this.onScrollStopObserver.clear(),(e=this._scrollBar)==null||e.dispose(),this._scene.removeViewport(this._viewPortKey)}limitedScroll(){var e,n;if(!this._scrollBar)return;const r=(e=this._scrollBar)==null?void 0:e.limitX,i=(n=this._scrollBar)==null?void 0:n.limitY;let o=!0,s=!0;return this.scrollX<0?this.scrollX=0:this.scrollX>r?this.scrollX=r:o=!1,this.scrollY<0?this.scrollY=0:this.scrollY>i?this.scrollY=i:s=!1,{isLimitedX:o,isLimitedY:s}}_resizeCacheCanvasAndScrollBar(){var e;const{width:n,height:r}=this._getViewPortSize(),i=(this._scene.width-this._paddingEndX)*this._scene.scaleX,o=(this._scene.height-this._paddingEndY)*this._scene.scaleY;(e=this._scrollBar)==null||e.resize(n,r,i,o),this.makeDirty(!0)}_getViewPortSize(){const e=this._scene.getParent(),{width:n,height:r}=e,{scaleX:i=1,scaleY:o=1}=this._scene;let s,a,l=this.left*i,u=this.top*o;return this._leftOrigin!=null&&(l=this._leftOrigin*i),this._topOrigin!=null&&(u=this._topOrigin*o),this._widthOrigin!=null?s=this._widthOrigin*i:(s=n-(l+this._right),this.width=s),this._heightOrigin!=null?a=this._heightOrigin*o:(a=r-(u+this._bottom),this.height=a),this._left=l,this._top=u,{width:s,height:a}}_scrollRendered(){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY}_triggerScrollStop(e,n,r,i=!0){clearTimeout(this._scrollStopNum),this._scrollStopNum=setTimeout(()=>{var o,s;this.onScrollStopObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:n,y:r,actualScrollX:e.x,actualScrollY:e.y,limitX:(o=this._scrollBar)==null?void 0:o.limitX,limitY:(s=this._scrollBar)==null?void 0:s.limitY,isTrigger:i})},200)}_scroll(e,n,r=!0){var i,o,s,a;const{x:l,y:u}=n;if(this._scrollBar==null)return;l!==void 0&&(this._scrollBar.hasHorizonThumb()?e===1?this.scrollX+=l:this.scrollX=l:this.scrollX=0),u!==void 0&&(this._scrollBar.hasVerticalThumb()?e===1?this.scrollY+=u:this.scrollY=u:this.scrollY=0);const c=this.limitedScroll();this.onScrollBeforeObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:l,y:u,limitX:(i=this._scrollBar)==null?void 0:i.limitX,limitY:(o=this._scrollBar)==null?void 0:o.limitY,isTrigger:r}),this._scrollBar?this._scrollBar.makeDirty(!0):this.makeDirty(!0);const d=this.getTransformedScroll();return this.actualScrollX=d.x,this.actualScrollY=d.y,this.onScrollAfterObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:l,y:u,actualScrollX:d.x,actualScrollY:d.y,limitX:(s=this._scrollBar)==null?void 0:s.limitX,limitY:(a=this._scrollBar)==null?void 0:a.limitY,isTrigger:r}),this._triggerScrollStop(d,l,u,r),c}_calViewportRelativeBounding(){var e;if(this.isActive===!1)return{viewBound:{left:-1,top:-1,right:-1,bottom:-1},diffBounds:[],diffX:-1,diffY:-1,viewPortPosition:{top:0,left:0,bottom:0,right:0},viewPortKey:this.viewPortKey};const n=this._scene.transform.clone().getMatrix(),r=this._isRelativeX&&n[0]<1?n[0]:1,i=this._isRelativeY&&n[3]<1?n[3]:1,o=this._isRelativeX?1:n[0]<1?n[0]:1,s=this._isRelativeY?1:n[3]<1?n[3]:1;let a=this._width,l=this._height;const u=this._getViewPortSize();n[0]>1&&(a=u.width),n[3]>1&&(l=u.height);const c=this.left*r,d=((a||0)+this.left)*o,h=this.top*i,f=((l||0)+this.top)*s,m=this.getRelativeVector(Ft.FromArray([c,h])),p=this.getRelativeVector(Ft.FromArray([d,f])),g={top:m.y,left:m.x,right:p.x,bottom:p.y},v=(e=this._preViewportBound)==null?void 0:e.viewBound;return{viewBound:g,diffBounds:this._diffViewBound(g,v),diffX:((v==null?void 0:v.left)||0)-g.left,diffY:((v==null?void 0:v.top)||0)-g.top,viewPortPosition:{top:h,left:c,bottom:f,right:d},viewPortKey:this.viewPortKey}}_diffViewBound(e,n){if(n==null)return[e];const r={startRow:e.top,endRow:e.bottom,startColumn:e.left,endColumn:e.right},i={startRow:n.top,endRow:n.bottom,startColumn:n.left,endColumn:n.right};return pt.subtract(r,i).map(o=>{const{startRow:s,endRow:a,startColumn:l,endColumn:u}=o;return{left:l,top:s,right:u,bottom:a}})}_drawScrollbar(e){if(!this._scrollBar)return;const n=this._scene.getParent();n.classType===Bt.SCENE_VIEWER?this._scrollBar.render(e):n.classType===Bt.ENGINE&&this._scrollBar.render(e)}_setWithAndHeight(e){this.top=(e==null?void 0:e.top)||0,this.left=(e==null?void 0:e.left)||0,this.bottom=(e==null?void 0:e.bottom)||0,this.right=(e==null?void 0:e.right)||0,e!=null&&e.width?(this.width=e==null?void 0:e.width,this._widthOrigin=this.width,this._isRelativeX=!1):(this.width=null,this._widthOrigin=null,this._isRelativeX=!0),e!=null&&e.height?(this.height=e==null?void 0:e.height,this._heightOrigin=this.height,this._isRelativeY=!1):(this.height=null,this._heightOrigin=null,this._isRelativeY=!0)}_getBoundScale(e,n){return e=this._isRelativeX&&e<1?1:e,n=this._isRelativeY&&n<1?1:n,{scaleX:e,scaleY:n}}}var Nge="__RediContextCreated__";if(!window.RediContextCreated)window.RediContextCreated=Nge;else throw new qi(`"RediContext" is already created. You may import "RediContext" from different paths. Use "import { RediContext } from '@wendellhu/redi/react-bindings'; instead."`);var F9=b.createContext({injector:null});F9.displayName="RediContext";var Lge=F9.Provider;F9.Consumer;var Pge=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bge=function(t){Pge(e,t);function e(){return t.call(this,"Using dependency injection outside of a RediContext.")||this}return e}(qi);function Fge(){var t=b.useContext(F9);if(!t.injector)throw new Bge;return t.injector}function _t(t,e,n){var r=Fge();return r.get(t,e,n)}var Lv=function(){return Lv=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Lv.apply(this,arguments)};function Qd(t,e){return function(r){return b.createElement(Lge,{value:{injector:e}},b.createElement(t,Lv({},r)))}}var Uge=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();(function(t){Uge(e,t);function e(n){return t.call(this,'You should make "RediContext" as '.concat(n.constructor.name,"'s default context type. ")+"If you want to use multiple context, please check this on React doc site. https://reactjs.org/docs/context.html#classcontexttype")||this}return e})(qi);var Hge=Object.defineProperty,Vge=(t,e,n)=>e in t?Hge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Cn=(t,e,n)=>(Vge(t,typeof e!="symbol"?e+"":e,n),n),rs=function(){return rs=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},rs.apply(this,arguments)},jge=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},dt=b.forwardRef(function(t,e){var n=t.icon,r=t.id,i=t.className,o=t.extend,s=jge(t,["icon","id","className","extend"]),a="univerjs-icon univerjs-icon-".concat(r," ").concat(i||"").trim(),l=b.useRef("_".concat(Xge()));return kA(n,"".concat(r),{defIds:n.defIds,idSuffix:l.current},rs({ref:e,className:a},s),o)});function kA(t,e,n,r,i){return b.createElement(t.tag,rs(rs({key:e},zge(t,n,i)),r),(Wge(t,n).children||[]).map(function(o,s){return kA(o,"".concat(e,"-").concat(t.tag,"-").concat(s),n,void 0,i)}))}function zge(t,e,n){var r=rs({},t.attrs);n!=null&&n.colorChannel1&&r.fill==="colorChannel1"&&(r.fill=n.colorChannel1);var i=e.defIds;return!i||i.length===0||(t.tag==="use"&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+e.idSuffix),Object.entries(r).forEach(function(o){var s=o[0],a=o[1];typeof a=="string"&&(r[s]=a.replace(/url\(#(.*)\)/,"url(#$1".concat(e.idSuffix,")")))})),r}function Wge(t,e){var n,r=e.defIds;return!r||r.length===0?t:t.tag==="defs"&&!((n=t.children)===null||n===void 0)&&n.length?rs(rs({},t),{children:t.children.map(function(i){return typeof i.attrs.id=="string"&&r&&r.indexOf(i.attrs.id)>-1?rs(rs({},i),{attrs:rs(rs({},i.attrs),{id:i.attrs.id+e.idSuffix})}):i})}):t}function Xge(){return Math.random().toString(36).substring(2,8)}dt.displayName="UniverIcon";var Yge={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1312",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.55 0.65H16.55V16.65H0.55z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1312)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M9.15655 6.42075L9.9355 7.1991C10.1708 7.43425 10.5522 7.4341 10.7874 7.19877C11.0225 6.96345 11.0224 6.58206 10.787 6.34691L9.00363 4.56487C8.89332 4.44134 8.73284 4.36357 8.5542 4.36357C8.39987 4.36338 8.24484 4.42214 8.12705 4.53983L6.32137 6.34411C6.08604 6.57925 6.08589 6.96064 6.32103 7.19597C6.55618 7.4313 6.93757 7.43145 7.17289 7.1963L7.95184 6.41796L7.95184 10.8693L7.1729 10.091C6.93757 9.85584 6.55618 9.85599 6.32104 10.0913C6.08589 10.3266 6.08604 10.708 6.32136 10.9432L8.10476 12.7252C8.21507 12.8487 8.37555 12.9265 8.5542 12.9265L8.55513 12.9265C8.70937 12.9266 8.86363 12.8679 8.98135 12.7503L10.787 10.946C11.0224 10.7108 11.0225 10.3294 10.7874 10.0941C10.5522 9.85879 10.1708 9.85864 9.9355 10.0938L9.15655 10.8721L9.15655 6.42075Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.2582 3.89179C14.6082 3.89179 14.892 3.60804 14.892 3.25803 14.892 2.90801 14.6082 2.62427 14.2582 2.62427L2.85056 2.62427C2.50054 2.62427 2.2168 2.90801 2.2168 3.25803 2.2168 3.60804 2.50054 3.89179 2.85056 3.89179L14.2582 3.89179zM14.2582 14.6657C14.6082 14.6657 14.892 14.3819 14.892 14.0319 14.892 13.6819 14.6082 13.3982 14.2582 13.3982L2.85056 13.3982C2.50054 13.3982 2.2168 13.6819 2.2168 14.0319 2.2168 14.3819 2.50054 14.6657 2.85056 14.6657L14.2582 14.6657z"}}]}]},AA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"adjust-height",ref:e,icon:Yge}))});AA.displayName="AdjustHeight";const Gge=AA;var Kge={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1166",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.21 0.65H16.21V16.65H0.21z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1166)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M5.98325 8.04266L6.7616 7.26372C6.99674 7.02839 6.9966 6.647 6.76127 6.41186C6.52595 6.17672 6.14456 6.17686 5.90941 6.41219L4.12737 8.19559C4.00384 8.3059 3.92607 8.46638 3.92607 8.64502C3.92588 8.79935 3.98463 8.95438 4.10233 9.07217L5.90661 10.8779C6.14175 11.1132 6.52314 11.1133 6.75847 10.8782C6.9938 10.643 6.99395 10.2617 6.7588 10.0263L5.98046 9.24738L10.4318 9.24738L9.65349 10.0263C9.41834 10.2616 9.41849 10.643 9.65381 10.8782C9.88914 11.1133 10.2705 11.1132 10.5057 10.8779L12.2877 9.09446C12.4112 8.98415 12.489 8.82367 12.489 8.64502L12.489 8.64409C12.4891 8.48985 12.4304 8.33558 12.3128 8.21787L10.5085 6.41219C10.2733 6.17686 9.89195 6.17671 9.65662 6.41186C9.42129 6.647 9.42114 7.02839 9.65629 7.26372L10.4346 8.04266L5.98325 8.04266Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.45429 2.94124C3.45429 2.59123 3.17054 2.30748 2.82053 2.30748 2.47051 2.30748 2.18677 2.59123 2.18677 2.94124L2.18677 14.3489C2.18677 14.6989 2.47051 14.9827 2.82053 14.9827 3.17054 14.9827 3.45429 14.6989 3.45429 14.3489L3.45429 2.94124zM14.2282 2.94124C14.2282 2.59123 13.9444 2.30748 13.5944 2.30748 13.2444 2.30748 12.9607 2.59123 12.9607 2.94124L12.9607 14.3489C12.9607 14.6989 13.2444 14.9827 13.5944 14.9827 13.9444 14.9827 14.2282 14.6989 14.2282 14.3489L14.2282 2.94124z"}}]}]},NA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"adjust-width",ref:e,icon:Kge}))});NA.displayName="AdjustWidth";const Zge=NA;var qge={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_827",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.87 0.21H16.87V16.21H0.87z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_827)"},children:[{tag:"path",attrs:{d:"M9.59528 2.22428C9.59528 1.85029 9.2921 1.54712 8.91812 1.54712 8.54413 1.54712 8.24096 1.85029 8.24096 2.22428V8.2166L7.55014 7.52579C7.28569 7.26134 6.85694 7.26134 6.59249 7.52579 6.32804 7.79023 6.32804 8.21899 6.59249 8.48344L8.43876 10.3297C8.44041 10.3314 8.44207 10.333 8.44373 10.3346 8.5071 10.3969 8.57967 10.4441 8.65701 10.4764 8.73736 10.51 8.82557 10.5286 8.91812 10.5286 9.10286 10.5286 9.27033 10.4546 9.3925 10.3346 9.39418 10.333 9.39585 10.3313 9.3975 10.3297L11.2437 8.48344C11.5082 8.21899 11.5082 7.79023 11.2437 7.52579 10.9793 7.26134 10.5505 7.26134 10.2861 7.52579L9.59528 8.2166V2.22428zM2.87772 13.5221C2.50374 13.5221 2.20056 13.8253 2.20056 14.1993 2.20056 14.5733 2.50374 14.8765 2.87772 14.8765H14.9585C15.3325 14.8765 15.6357 14.5733 15.6357 14.1993 15.6357 13.8253 15.3325 13.5221 14.9585 13.5221H2.87772z"}}]}]},LA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"align-bottom-single",ref:e,icon:qge}))});LA.displayName="AlignBottomSingle";const Qge=LA;var Jge={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_830",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.21 0.21H16.21V16.21H0.21z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_830)"},children:[{tag:"path",attrs:{d:"M1.51147 14.2166C1.51147 13.85 1.80863 13.5528 2.17519 13.5528H14.2384C14.605 13.5528 14.9021 13.85 14.9021 14.2166 14.9021 14.5831 14.605 14.8803 14.2384 14.8803H2.17519C1.80863 14.8803 1.51147 14.5831 1.51147 14.2166zM8.20683 10.5777C7.81659 10.5777 7.50024 10.2748 7.50024 9.90106V3.85034L6.77941 4.54066C6.50347 4.80491 6.05608 4.80491 5.78014 4.54066 5.50421 4.2764 5.50421 3.84796 5.78014 3.5837L7.70661 1.73879 7.71183 1.73383C7.83931 1.61397 8.01405 1.54004 8.20683 1.54004 8.30339 1.54004 8.39544 1.55859 8.47928 1.59218 8.55998 1.62443 8.6357 1.67165 8.70182 1.73384L8.70701 1.73876 10.6335 3.5837C10.9094 3.84796 10.9094 4.2764 10.6335 4.54066 10.3576 4.80491 9.91018 4.80491 9.63425 4.54066L8.91341 3.85034V9.90106C8.91341 10.2748 8.59706 10.5777 8.20683 10.5777z"}}]}]},PA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"align-top-single",ref:e,icon:Jge}))});PA.displayName="AlignTopSingle";const eve=PA;var tve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_771",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.88 0.24H16.88V16.24H0.88z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_771)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.2782 13.5485C2.2782 14.2619 2.8565 14.8402 3.56986 14.8402H14.1949C14.9082 14.8402 15.4865 14.2619 15.4865 13.5485V2.9235C15.4865 2.21013 14.9082 1.63184 14.1949 1.63184H3.56986C2.8565 1.63184 2.2782 2.21013 2.2782 2.9235V13.5485ZM3.61153 8.90267V13.5068H8.2157V8.90267H3.61153ZM3.61153 7.56934H8.2157V2.96517H3.61153V7.56934ZM9.54903 8.90267V13.5068H14.1532V8.90267H9.54903ZM14.1532 7.56934H9.54903V2.96517H14.1532V7.56934Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},BA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"all-border-single",ref:e,icon:tve}))});BA.displayName="AllBorderSingle";const nve=BA;var rve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_176_82",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M16.94 0.96H32.94V16.96H16.94z",transform:"rotate(90 16.94 .96)"}}]},{tag:"g",attrs:{mask:"url(#mask0_176_82)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.77949 14.2355C8.77935 14.5851 8.49584 14.8684 8.14624 14.8682L3.66424 14.8665C3.31484 14.8663 3.03163 14.5831 3.03149 14.2337L3.02978 9.7448C3.02965 9.3952 3.31294 9.11169 3.66254 9.11156C4.01213 9.11143 4.29565 9.39472 4.29578 9.74432L4.29691 12.7025L12.682 4.31749L9.72375 4.31635C9.37415 4.31621 9.09086 4.0327 9.091 3.6831C9.09113 3.33351 9.37464 3.05021 9.72424 3.05035L14.2062 3.05209C14.5556 3.05222 14.8388 3.33544 14.839 3.68484L14.8407 8.17377C14.8408 8.52336 14.5575 8.80688 14.208 8.80701C13.8584 8.80715 13.5748 8.52386 13.5747 8.17426L13.5736 5.21627L5.18877 13.6011L8.14674 13.6022C8.49634 13.6024 8.77963 13.8859 8.77949 14.2355Z"}}]}]},FA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"amplify-single",ref:e,icon:rve}))});FA.displayName="AmplifySingle";const ive=FA;var ove={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1317",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.8 0.65H16.8V16.65H0.8z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1317)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.09849 2.62524C2.74854 2.62524 2.46484 2.90894 2.46484 3.2589 2.46484 3.60885 2.74854 3.89255 3.09849 3.89255H14.5042C14.8542 3.89255 15.1379 3.60885 15.1379 3.2589 15.1379 2.90894 14.8542 2.62524 14.5042 2.62524H3.09849zM3.09849 13.3973C2.74854 13.3973 2.46484 13.681 2.46484 14.031 2.46484 14.3809 2.74854 14.6646 3.09849 14.6646H14.5042C14.8542 14.6646 15.1379 14.3809 15.1379 14.031 15.1379 13.681 14.8542 13.3973 14.5042 13.3973H3.09849z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M8.2229 4.9009L5.05597 11.8681C4.91116 12.1867 5.05203 12.5624 5.37062 12.7072C5.68921 12.852 6.06487 12.7111 6.20968 12.3925L7.04893 10.5462H10.5532L11.3925 12.3925C11.5373 12.7111 11.913 12.852 12.2315 12.7072C12.5501 12.5624 12.691 12.1867 12.5462 11.8681L9.37927 4.90091C9.36877 4.87746 9.35684 4.85463 9.34354 4.83257C9.29139 4.74604 9.21815 4.67122 9.12706 4.61673C9.10227 4.6019 9.07654 4.58879 9.05005 4.57748C8.96891 4.54277 8.88436 4.52632 8.80108 4.52637C8.68584 4.52644 8.57303 4.55811 8.47511 4.61673C8.38841 4.66863 8.31337 4.74166 8.25862 4.83257C8.24533 4.85463 8.2334 4.87746 8.2229 4.9009ZM9.97719 9.2789L8.80108 6.69146L7.62497 9.2789H9.97719Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},UA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"auto-height",ref:e,icon:ove}))});UA.displayName="AutoHeight";const sve=UA;var ave={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_790",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.64 0.21H16.64V16.21H0.64z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_790)"},children:[{tag:"path",attrs:{d:"M5.24472 5.52752C5.24472 5.16351 5.53981 4.86842 5.90382 4.86842L9.07414 4.86842C10.7238 4.86842 12.0611 6.20575 12.0611 7.85544 12.0611 9.50512 10.7238 10.8425 9.07414 10.8425H7.90755L8.90245 11.8374C9.15984 12.0948 9.15984 12.5121 8.90245 12.7695 8.64505 13.0269 8.22774 13.0269 7.97034 12.7695L5.79891 10.598C5.54152 10.3406 5.54152 9.92331 5.79891 9.66591L7.97034 7.49445C8.22774 7.23705 8.64505 7.23705 8.90244 7.49445 9.15984 7.75185 9.15984 8.16917 8.90244 8.42656L7.80477 9.52425H9.07414C9.99579 9.52425 10.7429 8.7771 10.7429 7.85544 10.7429 6.93378 9.99579 6.18662 9.07414 6.18662H5.90382C5.53981 6.18662 5.24472 5.89153 5.24472 5.52752zM2.62138 1.55151C2.98538 1.55151 3.28047 1.8466 3.28047 2.21061L3.28047 14.2092C3.28047 14.5732 2.98538 14.8683 2.62138 14.8683 2.25737 14.8683 1.96228 14.5732 1.96228 14.2092L1.96228 2.21061C1.96228 1.8466 2.25737 1.55151 2.62138 1.55151zM14.649 1.55151C15.013 1.55151 15.3081 1.8466 15.3081 2.21061L15.3081 14.2092C15.3081 14.5732 15.013 14.8683 14.649 14.8683 14.285 14.8683 13.9899 14.5732 13.9899 14.2092L13.9899 2.21061C13.9899 1.8466 14.285 1.55151 14.649 1.55151z"}}]}]},HA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"autowrap-single",ref:e,icon:ave}))});HA.displayName="AutowrapSingle";const lve=HA;var uve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.0521 13.1932C12.0629 13.1932 11.2473 12.7599 11.2473 11.682 11.2473 11.195 11.4506 10.7995 11.8358 10.5153 11.8502 10.5046 11.859 10.4877 11.859 10.4698 11.859 10.4543 11.8526 10.4397 11.8415 10.4289 11.624 10.2177 11.4663 9.90405 11.4663 9.40996 11.4663 8.99482 11.6557 8.57968 11.9272 8.30468 11.9366 8.29507 11.9421 8.28219 11.9421 8.26869 11.9421 8.25515 11.9367 8.2423 11.9272 8.23268 11.6309 7.93313 11.3606 7.38005 11.3606 6.69409 11.3606 5.22519 12.229 4.50659 13.1578 4.50659 13.2983 4.50659 13.434 4.52338 13.5608 4.55506 13.7488 4.60205 13.9382 4.65454 14.132 4.65454H14.7341C15.1105 4.65454 15.4157 4.95971 15.4157 5.33615V5.74978C15.4157 5.89778 15.2957 6.01776 15.1477 6.01776 14.9579 6.01776 14.8199 6.21378 14.847 6.4016 14.8627 6.51023 14.872 6.62766 14.872 6.74692 14.872 8.15242 14.1093 8.76534 13.1578 8.76534 13.1368 8.76534 13.1151 8.76465 13.0927 8.76325 12.8238 8.74638 12.516 8.81287 12.516 9.08236 12.516 9.35712 12.6897 9.48393 13.1503 9.48393H13.8299C14.8871 9.48393 15.4836 9.93834 15.4836 11.0268 15.4836 12.2949 14.5473 13.1932 13.0521 13.1932zM13.1578 7.6346C13.475 7.6346 13.7015 7.31757 13.7015 6.69409 13.7015 6.08116 13.475 5.76414 13.1578 5.76414 12.8482 5.76414 12.6141 6.08116 12.6141 6.69409 12.6141 7.31757 12.8482 7.6346 13.1578 7.6346zM13.2636 12.0202C13.8148 12.0202 14.1999 11.7348 14.1999 11.3544 14.1999 10.9951 13.9734 10.9211 13.5732 10.9211H13.1654C13.1548 10.9211 13.1444 10.9211 13.1342 10.9211 12.7839 10.9194 12.3498 11.0358 12.3498 11.3861 12.3498 11.8088 12.7123 12.0202 13.2636 12.0202zM8.69019 10.6675C8.23567 10.6675 7.84068 10.3553 7.73571 9.91306L6.67506 5.4444C6.57938 5.0413 6.88509 4.65454 7.29939 4.65454 7.61143 4.65454 7.87824 4.87902 7.93161 5.18647L8.3199 7.42325 8.56358 8.92546C8.57389 8.98905 8.62881 9.03578 8.69323 9.03578 8.75671 9.03578 8.81111 8.99037 8.82246 8.92791L9.09586 7.42325 9.48127 5.16567C9.53167 4.87044 9.78755 4.65454 10.0871 4.65454 10.4823 4.65454 10.7748 5.02232 10.6858 5.40745L9.64601 9.90737C9.54318 10.3523 9.14689 10.6675 8.69019 10.6675zM3.48634 7.06119C3.46154 7.24144 3.6016 7.40208 3.78354 7.40208H4.24009C4.42308 7.40208 4.56345 7.23966 4.53692 7.0586L4.4897 6.73632 4.16506 4.66175C4.15497 4.59728 4.09943 4.54976 4.03418 4.54976 3.97004 4.54976 3.91511 4.59571 3.90378 4.65884L3.53104 6.73632 3.48634 7.06119zM5.73882 10.6675C5.40883 10.6675 5.12622 10.4311 5.06786 10.1063L4.92516 9.31218C4.87818 9.0507 4.65065 8.86041 4.38499 8.86041H3.64169C3.37603 8.86041 3.1485 9.0507 3.10152 9.31218L2.9556 10.1242C2.8991 10.4387 2.62551 10.6675 2.30605 10.6675 1.88395 10.6675 1.57035 10.2767 1.66177 9.86458L3.05299 3.59399C3.15524 3.13313 3.56393 2.80518 4.03599 2.80518 4.50806 2.80518 4.91675 3.13313 5.019 3.59399L6.40434 9.83812C6.49878 10.2638 6.17484 10.6675 5.73882 10.6675z"}}]},VA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"avg-single",ref:e,icon:uve}))});VA.displayName="AvgSingle";const cve=VA;var dve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_436_28",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.35 0.72H16.35V16.72H0.35z"}}]},{tag:"g",attrs:{mask:"url(#mask0_436_28)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.5853 14.7987L2.27159 3.485L3.12012 2.63647L14.4338 13.9502L13.5853 14.7987Z"}},{tag:"path",attrs:{fill:"#E5E5E5",d:"M1.69629 12.8102L1.69629 14.1743C1.69629 14.8371 2.23355 15.3743 2.89629 15.3743L4.26042 15.3743L4.26042 14.0443L3.02629 14.0443L3.02629 12.8102L1.69629 12.8102ZM4.26042 2.06128L2.89629 2.06128C2.23355 2.06128 1.69629 2.59854 1.69629 3.26128L1.69629 4.62541L3.02629 4.62541L3.02629 3.39128L4.26042 3.39128L4.26042 2.06128ZM1.69629 10.0819L3.02629 10.0819L3.02629 7.35367L1.69629 7.35367L1.69629 10.0819ZM6.98868 2.06128L6.98868 3.39128L9.71693 3.39128L9.71693 2.06128L6.98868 2.06128ZM12.4452 2.06128L12.4452 3.39128L13.6793 3.39128L13.6793 4.62541L15.0093 4.62541L15.0093 3.26128C15.0093 2.59854 14.4721 2.06128 13.8093 2.06128L12.4452 2.06128ZM15.0093 7.35367L13.6793 7.35367L13.6793 10.0819L15.0093 10.0819L15.0093 7.35367ZM15.0093 12.8102L13.6793 12.8102L13.6793 14.0443L12.4452 14.0443L12.4452 15.3743L13.8093 15.3743C14.4721 15.3743 15.0093 14.8371 15.0093 14.1743L15.0093 12.8102ZM9.71693 15.3743L9.71693 14.0443L6.98868 14.0443L6.98868 15.3743L9.71693 15.3743Z"}}]}]},jA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"back-slash-single",ref:e,icon:dve}))});jA.displayName="BackSlashSingle";const hve=jA;var fve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.85742 3.04829C3.85742 2.60646 4.21559 2.24829 4.65742 2.24829H7.78717C9.66964 2.24829 11.1957 3.77433 11.1957 5.6568C11.1957 6.67683 10.7476 7.59221 10.0376 8.21686C11.3622 8.82802 12.2815 10.1679 12.2815 11.7224C12.2815 13.8535 10.5539 15.5811 8.42284 15.5811H4.65742C4.21559 15.5811 3.85742 15.2229 3.85742 14.7811V3.04829ZM5.05742 3.44829H7.78717C9.0069 3.44829 9.99568 4.43707 9.99568 5.6568C9.99568 6.84867 9.05155 7.82002 7.87037 7.86377H5.05742V3.44829ZM5.05742 9.06531V14.3811H8.42284C9.89116 14.3811 11.0815 13.1907 11.0815 11.7224C11.0815 10.2541 9.89116 9.06377 8.42284 9.06377H7.89057C7.85623 9.06479 7.82176 9.06531 7.78717 9.06531H5.05742Z",fillRule:"evenodd",clipRule:"evenodd"}}]},zA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"bold-single",ref:e,icon:fve}))});zA.displayName="BoldSingle";const mve=zA;var pve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_653",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.56 0.06H16.56V16.06H0.56z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_653)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.44145 9.19698C3.00358 8.85847 2.72347 8.33997 2.72347 7.75875C2.72347 6.73885 3.60062 5.91205 4.66459 5.91205C5.74483 5.91205 6.6354 5.07262 6.63542 4.03712L6.63543 3.24022C6.63544 2.22033 7.49795 1.39355 8.56192 1.39355C9.62589 1.39355 10.4884 2.22035 10.4884 3.24025V4.03711C10.4884 5.07262 11.379 5.91205 12.4592 5.91205C13.5232 5.91205 14.4003 6.73885 14.4003 7.75875C14.4003 8.33997 14.1202 8.85847 13.6823 9.19698L15.1492 13.905C15.2769 14.3148 14.9566 14.7269 14.5104 14.7269H2.61339C2.16716 14.7269 1.84691 14.3148 1.9746 13.905L3.44145 9.19698ZM9.15507 3.24025V4.03711C9.15507 5.79103 10.6557 7.19016 12.4592 7.19016C12.8 7.19016 13.067 7.45727 13.067 7.75875C13.067 8.06367 12.8166 8.31253 12.5022 8.3267H4.62164C4.3072 8.31253 4.0568 8.06367 4.0568 7.75875C4.0568 7.45727 4.32385 7.19016 4.66459 7.19016C6.46806 7.19016 7.96873 5.79105 7.96875 4.03714L7.96876 3.24024C7.96876 2.92622 8.23433 2.67166 8.56192 2.67166C8.88951 2.67166 9.15507 2.92623 9.15507 3.24025ZM4.70572 9.60545L3.50826 13.4488H13.6155L12.4181 9.60545H4.70572Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},WA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"brush-single",ref:e,icon:pve}))});WA.displayName="BrushSingle";const gve=WA;var vve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_768",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.25 0.44H16.25V16.44H0.25z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_768)"},children:[{tag:"path",attrs:{d:"M0.260559 3.10579C0.260559 2.36941 0.857513 1.77246 1.59389 1.77246H12.2606C12.997 1.77246 13.5939 2.36942 13.5939 3.10579V5.77246C13.5939 6.14065 13.2954 6.43913 12.9272 6.43913C12.559 6.43913 12.2606 6.14065 12.2606 5.77246V3.10579H7.59391V8.43913C7.59391 8.80732 7.29544 9.10579 6.92725 9.10579H1.59389V13.7725H12.2606V12.4391C12.2606 12.0709 12.559 11.7725 12.9272 11.7725C13.2954 11.7725 13.5939 12.0709 13.5939 12.4391V13.7725C13.5939 14.5089 12.9969 15.1058 12.2606 15.1058H1.59389C0.857519 15.1058 0.260559 14.5089 0.260559 13.7725V3.10579ZM4.41373 3.10579H5.68212L1.59389 6.74378V5.48531L4.41373 3.10579ZM2.34627 3.10579L1.59389 3.74069V3.10579H2.34627ZM2.4436 7.77246H3.73396L6.26058 5.45444V4.37584L2.4436 7.77246ZM5.70625 7.77246H6.26058V7.2639L5.70625 7.77246Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M8.69988 11.3713C8.55945 11.2308 8.49476 11.0433 8.50583 10.8595L8.62325 8.39332C8.64076 8.02555 8.95309 7.7416 9.32086 7.75911C9.68864 7.77662 9.97258 8.08896 9.95507 8.45673L9.91925 9.20909L11.4097 7.71862C12.4741 6.65427 14.2333 6.61977 15.3386 7.64208C16.5072 8.72296 16.5407 10.6015 15.4167 11.7256L15.0169 12.1253C14.7565 12.3857 14.3344 12.3857 14.0741 12.1253C13.8137 11.865 13.8137 11.4429 14.0741 11.1825L14.4739 10.7827C15.0641 10.1925 15.0449 9.18668 14.4333 8.62092C13.8538 8.08493 12.9105 8.10344 12.3525 8.66143L10.7807 10.2332L11.764 10.2332C12.1322 10.2332 12.4307 10.5317 12.4307 10.8999C12.4307 11.2681 12.1322 11.5666 11.764 11.5666L9.17133 11.5665C9.15973 11.5665 9.14817 11.5662 9.13665 11.5656C8.97776 11.5574 8.82124 11.4926 8.69988 11.3713Z"}}]}]},XA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"cancel-freeze-single",ref:e,icon:vve}))});XA.displayName="CancelFreezeSingle";const _ve=XA;var bve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_718",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.88 0.24H16.88V16.24H0.88z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_718)"},children:[{tag:"path",attrs:{d:"M3.54901 2.90265H6.21565V4.23597H7.54896V2.90265C7.54896 2.16628 6.95202 1.56934 6.21565 1.56934H3.54901C2.81264 1.56934 2.2157 2.16628 2.2157 2.90265V13.5692C2.2157 14.3056 2.81264 14.9025 3.54901 14.9025H6.21565C6.95202 14.9025 7.54896 14.3056 7.54896 13.5692V12.2359H6.21565V13.5692H3.54901V2.90265zM11.5489 2.90265H14.2155V13.5692H11.5489V12.2359H10.2156V13.5692C10.2156 14.3056 10.8125 14.9025 11.5489 14.9025H14.2155C14.9519 14.9025 15.5489 14.3056 15.5489 13.5692V2.90265C15.5489 2.16628 14.9519 1.56934 14.2155 1.56934H11.5489C10.8125 1.56934 10.2156 2.16628 10.2156 2.90265V4.23597H11.5489V2.90265z"}},{tag:"path",attrs:{d:"M7.60297 10.6137C7.34262 10.874 6.92052 10.874 6.66017 10.6137L4.7538 8.70732C4.49346 8.44697 4.49346 8.02487 4.7538 7.76452L6.66017 5.85815C6.92052 5.59781 7.34262 5.59781 7.60297 5.85815 7.86331 6.1185 7.86331 6.5406 7.60297 6.80095L6.168 8.23592 7.60297 9.67089C7.86331 9.93123 7.86331 10.3533 7.60297 10.6137zM11.1044 10.6137C10.844 10.874 10.4219 10.874 10.1616 10.6137 9.90124 10.3533 9.90124 9.93123 10.1616 9.67089L11.5966 8.23592 10.1616 6.80095C9.90124 6.5406 9.90124 6.1185 10.1616 5.85815 10.4219 5.59781 10.844 5.59781 11.1044 5.85815L13.0108 7.76452C13.2711 8.02487 13.2711 8.44697 13.0108 8.70732L11.1044 10.6137z"}}]}]},YA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"cancel-merge-single",ref:e,icon:bve}))});YA.displayName="CancelMergeSingle";const Cve=YA;var yve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.6152 4.52067C14.8732 4.77869 14.8732 5.19703 14.6152 5.45505L6.61862 13.4514C6.46241 13.6077 6.20915 13.6077 6.05294 13.4514L1.73512 9.13354C1.4771 8.87551 1.4771 8.45718 1.73513 8.19915C1.99315 7.94113 2.41149 7.94114 2.66951 8.19916L6.19436 11.7241C6.27247 11.8022 6.3991 11.8022 6.47721 11.7241L13.6808 4.52067C13.9388 4.26264 14.3571 4.26264 14.6152 4.52067Z",fillRule:"evenodd",clipRule:"evenodd"}}]},GA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"check-mark-single",ref:e,icon:yve}))});GA.displayName="CheckMarkSingle";const Sve=GA;var Eve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1161",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.2 0.65H16.2V16.65H0.2z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1161)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M5.56384 3.86626C5.56384 2.58975 6.59866 1.55493 7.87517 1.55493C9.15169 1.55493 10.1865 2.58975 10.1865 3.86626V7.39231H8.92202V3.86626C8.92202 3.2881 8.45333 2.81941 7.87517 2.81941C7.29701 2.81941 6.82833 3.2881 6.82833 3.86626V7.39231H5.56384V3.86626Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.19637 6.11768C3.5319 6.11768 2.14536 7.39367 2.00739 9.05241L1.73975 12.2699C1.58457 14.1354 3.0568 15.7352 4.92874 15.7352H13.8622C14.3704 15.7352 14.7499 15.2674 14.645 14.77L13.2217 8.02234C12.9875 6.91219 12.0079 6.11768 10.8733 6.11768H5.19637ZM10.8733 7.39768H5.19637C4.19769 7.39768 3.36577 8.16327 3.28298 9.15852L3.01534 12.376C2.92224 13.4953 3.80557 14.4552 4.92874 14.4552H5.96496C5.45908 13.6999 5.25131 12.6973 5.50771 11.6915C5.60408 11.3134 5.95789 11.0938 6.29796 11.201C6.63803 11.3081 6.83558 11.7014 6.73921 12.0795C6.47064 13.133 7.12445 14.3184 8.07462 14.4552H9.20958C8.70371 13.6999 8.49593 12.6973 8.75233 11.6915C8.8487 11.3134 9.20251 11.0938 9.54258 11.201C9.88265 11.3081 10.0802 11.7014 9.98383 12.0795C9.71526 13.133 10.3691 14.3184 11.3192 14.4552H13.2704L11.9692 8.28652C11.8599 7.76845 11.4028 7.39768 10.8733 7.39768Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},KA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"clear-format",ref:e,icon:Eve}))});KA.displayName="ClearFormat";const wve=KA;var Rve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.48712 4.59907C5.23328 4.34523 4.82172 4.34523 4.56788 4.59907C4.31404 4.85291 4.31404 5.26447 4.56788 5.51831L7.9973 8.94773L4.56773 12.3773C4.31389 12.6311 4.31389 13.0427 4.56773 13.2965C4.82157 13.5504 5.23313 13.5504 5.48697 13.2965L8.91654 9.86697L12.3461 13.2965C12.5999 13.5503 13.0114 13.5503 13.2653 13.2965C13.5191 13.0426 13.5191 12.6311 13.2653 12.3772L9.83577 8.94773L13.2651 5.51836C13.519 5.26452 13.519 4.85296 13.2651 4.59912C13.0113 4.34528 12.5997 4.34528 12.3459 4.59912L8.91654 8.02849L5.48712 4.59907Z"}}]},ZA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"close-single",ref:e,icon:Rve}))});ZA.displayName="CloseSingle";const qA=ZA;var Dve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.2678 12.0781C13.089 12.0781 12.6108 11.127 12.6108 9.70038V7.70345C12.6108 7.52817 12.4687 7.38607 12.2935 7.38607 12.1182 7.38607 11.9761 7.24397 11.9761 7.06868V6.37055C11.9761 6.15499 12.1391 5.97434 12.3535 5.95222 12.5515 5.9318 12.708 5.77537 12.7286 5.5774L12.7983 4.90733C12.8323 4.5804 13.1079 4.33203 13.4366 4.33203 13.7909 4.33203 14.0782 4.61932 14.0782 4.97371V5.36484C14.0782 5.66988 14.3255 5.91717 14.6306 5.91717 14.9356 5.91717 15.1829 6.16446 15.1829 6.46951V6.83374C15.1829 7.13878 14.9356 7.38607 14.6306 7.38607 14.3255 7.38607 14.0782 7.63336 14.0782 7.9384V9.67924C14.0782 10.345 14.3255 10.6092 14.6718 10.6092 14.9027 10.6092 15.1363 10.7134 15.1751 10.941L15.2377 11.3076C15.2921 11.6266 15.1175 11.955 14.801 12.0225 14.6457 12.0556 14.4692 12.0781 14.2678 12.0781zM7.7239 11.9302C7.32096 11.9302 6.99432 11.6036 6.99432 11.2006V6.55414C6.99432 6.20238 7.27948 5.91723 7.63123 5.91723H7.81127C8.02781 5.91723 8.21083 6.0777 8.23913 6.29238L8.28581 6.64643C8.28741 6.65851 8.2977 6.66753 8.30988 6.66753 8.31727 6.66753 8.32425 6.66416 8.32887 6.6584 8.71503 6.17627 9.19115 5.76929 9.82194 5.76929 10.8442 5.76929 11.2811 6.7098 11.2811 8.2104V11.1965C11.2811 11.6017 10.9526 11.9302 10.5474 11.9302 10.1422 11.9302 9.81369 11.6017 9.81369 11.1965V8.44289C9.81369 7.61862 9.64057 7.37556 9.2696 7.37556 8.61309 7.37556 8.45347 8.27371 8.45347 8.93022V11.2006C8.45347 11.6036 8.12683 11.9302 7.7239 11.9302zM4.20837 12.0781C2.6503 12.0781 1.3313 10.7043 1.3313 8.04129 1.3313 5.42052 2.69976 3.91992 4.25784 3.91992 4.87237 3.91992 5.3944 4.20078 5.79398 4.58023 6.00735 4.78284 6.01483 5.10992 5.85565 5.35739 5.60206 5.75163 5.05199 5.73073 4.60584 5.58693 4.5049 5.55439 4.39774 5.53677 4.28257 5.53677 3.49117 5.53677 2.83991 6.44558 2.83991 7.97788 2.83991 9.54189 3.40049 10.4507 4.26608 10.4507 4.42357 10.4507 4.57155 10.4175 4.70946 10.3589 5.14044 10.1758 5.71259 10.1535 5.96908 10.5452 6.11605 10.7697 6.11944 11.0654 5.94146 11.2662 5.46346 11.8054 4.87616 12.0781 4.20837 12.0781z"}}]},QA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"cnt-single",ref:e,icon:Dve}))});QA.displayName="CntSingle";const Ive=QA;var xve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6.33059 4.37857C6.5955 4.63427 6.60297 5.05631 6.34726 5.32123L2.81056 8.98531 6.33028 12.3783C6.59536 12.6338 6.6031 13.0558 6.34756 13.3209 6.09203 13.586 5.66999 13.5937 5.40491 13.3382L1.40491 9.48227C1.27756 9.35951 1.20422 9.19117 1.20104 9.01431 1.19785 8.83745 1.26508 8.66658 1.38793 8.53931L5.38793 4.39524C5.64363 4.13033 6.06567 4.12286 6.33059 4.37857zM10.7379 4.37857C11.0028 4.12286 11.4248 4.13033 11.6805 4.39524L15.6805 8.53931C15.8034 8.66658 15.8706 8.83745 15.8674 9.01431 15.8642 9.19117 15.7909 9.35951 15.6635 9.48227L11.6635 13.3382C11.3984 13.5937 10.9764 13.586 10.7209 13.3209 10.4653 13.0558 10.4731 12.6338 10.7382 12.3783L14.2579 8.98531 10.7212 5.32123C10.4655 5.05631 10.4729 4.63427 10.7379 4.37857zM9.9343 2.93067C9.97315 2.56454 9.70784 2.23623 9.3417 2.19738 8.97557 2.15853 8.64726 2.42385 8.60841 2.78998L7.13414 14.7857C7.09529 15.1519 7.3606 15.4802 7.72674 15.519 8.09287 15.5579 8.42118 15.2926 8.46003 14.9264L9.9343 2.93067z"}}]},JA=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"code-single",ref:e,icon:xve}))});JA.displayName="CodeSingle";const Mve=JA;var Ove={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_273_6444",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.54 0.84H16.54V16.84H0.54z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_273_6444)"},children:[{tag:"path",attrs:{d:"M6.67742 7.37473V5.64139H9.74408V7.37473H6.67742Z"}},{tag:"path",attrs:{d:"M2.41101 2.84136C2.41101 2.03134 3.06766 1.37469 3.87768 1.37469H13.211C14.021 1.37469 14.6777 2.03135 14.6777 2.84136V14.8414C14.6777 15.6514 14.021 16.308 13.211 16.308H3.87768C3.06767 16.308 2.41101 15.6514 2.41101 14.8414V2.84136ZM5.87742 10.0414C5.43559 10.0414 5.07742 10.3996 5.07742 10.8414C5.07742 11.2832 5.43559 11.6414 5.87742 11.6414H10.5441C10.9859 11.6414 11.3441 11.2832 11.3441 10.8414C11.3441 10.3996 10.9859 10.0414 10.5441 10.0414H5.87742ZM5.07742 12.8414C5.07742 12.3996 5.43559 12.0414 5.87742 12.0414H8.21075C8.65258 12.0414 9.01075 12.3996 9.01075 12.8414C9.01075 13.2832 8.65258 13.6414 8.21075 13.6414H5.87742C5.43559 13.6414 5.07742 13.2832 5.07742 12.8414ZM5.87742 4.04139C5.43559 4.04139 5.07742 4.39957 5.07742 4.84139V8.17473C5.07742 8.61655 5.43559 8.97473 5.87742 8.97473H10.5441C10.9859 8.97473 11.3441 8.61655 11.3441 8.17473V4.84139C11.3441 4.39957 10.9859 4.04139 10.5441 4.04139H5.87742Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},eN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"content-single-16",ref:e,icon:Ove}))});eN.displayName="ContentSingle16";const Tve=eN;var $ve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1141",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.7 0.72H16.7V16.72H0.7z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1141)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M6.09571 3.31892C5.95323 3.31892 5.83772 3.43443 5.83772 3.57691V5.04359C5.83772 5.39431 5.5534 5.67863 5.20267 5.67863C4.85195 5.67863 4.56763 5.39431 4.56763 5.04359V3.57691C4.56763 2.73297 5.25177 2.04883 6.09571 2.04883H13.8354C14.6793 2.04883 15.3634 2.73297 15.3634 3.57691V11.3166C15.3634 12.1605 14.6793 12.8446 13.8354 12.8446H12.3521C12.0014 12.8446 11.7171 12.5603 11.7171 12.2096C11.7171 11.8589 12.0014 11.5745 12.3521 11.5745H13.8354C13.9778 11.5745 14.0933 11.459 14.0933 11.3166V3.57691C14.0933 3.43443 13.9778 3.31892 13.8354 3.31892H6.09571Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.0274 6.11719C2.0274 5.27326 2.71155 4.58911 3.55549 4.58911H11.2951C12.1391 4.58911 12.8232 5.27326 12.8232 6.11719V13.8568C12.8232 14.7008 12.1391 15.3849 11.2951 15.3849H3.55549C2.71155 15.3849 2.0274 14.7008 2.0274 13.8568V6.11719ZM3.55549 5.85921C3.41301 5.85921 3.2975 5.97471 3.2975 6.11719V13.8568C3.2975 13.9993 3.41301 14.1148 3.55549 14.1148H11.2951C11.4376 14.1148 11.5531 13.9993 11.5531 13.8568V6.11719C11.5531 5.97471 11.4376 5.85921 11.2951 5.85921H3.55549Z"}}]}]},tN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"copy",ref:e,icon:$ve}))});tN.displayName="Copy";const kve=tN;var Ave={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1093",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.23 0.72H16.23V16.72H0.23z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1093)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.92173 6.16476C7.92173 5.79657 7.62325 5.49809 7.25507 5.49809H3.48471C3.11651 5.49809 2.81804 5.79657 2.81804 6.16476V11.2684C2.81804 11.6366 3.11651 11.9351 3.48471 11.9351H7.25507C7.62325 11.9351 7.92173 11.6366 7.92173 11.2684V6.16476ZM2.81804 4.22217C2.11336 4.22217 1.54211 4.79342 1.54211 5.49809V11.9351C1.54211 12.6398 2.11336 13.211 2.81804 13.211H7.92173C8.62638 13.211 9.19765 12.6398 9.19765 11.9351V5.49809C9.19765 4.79342 8.62638 4.22217 7.92173 4.22217H2.81804Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M12.1221 11.1725C12.1973 11.2037 12.2799 11.2209 12.3663 11.2209C12.4529 11.2209 12.5353 11.2037 12.6105 11.1725C12.6858 11.1414 12.7563 11.0952 12.8175 11.034L14.7313 9.12015C14.9805 8.87101 14.9805 8.46708 14.7313 8.21794C14.4822 7.9688 14.0783 7.9688 13.8291 8.21794L13.0043 9.04275V6.85085C13.0043 6.49852 12.7187 6.21289 12.3663 6.21289C12.014 6.21289 11.7284 6.49852 11.7284 6.85085V9.04275L10.9035 8.21794C10.6544 7.9688 10.2505 7.9688 10.0013 8.21794C9.7522 8.46708 9.7522 8.87101 10.0013 9.12015L11.9149 11.0337M7.20317 10.5587C6.92887 10.8403 6.48414 10.8403 6.20985 10.5587L5.40894 9.73654L4.60798 10.5588C4.33368 10.8403 3.88896 10.8403 3.61466 10.5588C3.34036 10.2772 3.34036 9.82065 3.61466 9.53908L4.41562 8.71686L3.61468 7.89467C3.34038 7.6131 3.34038 7.15657 3.61468 6.875C3.88897 6.59342 4.3337 6.59343 4.608 6.875L5.40894 7.6972L6.20983 6.87506C6.48413 6.59349 6.92886 6.59349 7.20316 6.87506C7.47745 7.15664 7.47745 7.61316 7.20315 7.89473L6.40226 8.71686L7.20317 9.53902C7.47747 9.82059 7.47747 10.2771 7.20317 10.5587Z"}}]}]},nN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"delete-cell-move-down",ref:e,icon:Ave}))});nN.displayName="DeleteCellMoveDown";const Nve=nN;var Lve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_252_31",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M16.31 16.22H32.31V32.22H16.31z",transform:"rotate(180 16.31 16.22)"}}]},{tag:"g",attrs:{mask:"url(#mask0_252_31)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.60329 10.7725C8.60329 11.1407 8.90177 11.4392 9.26996 11.4392L13.0403 11.4392C13.4085 11.4392 13.707 11.1407 13.707 10.7725L13.707 5.66882C13.707 5.30062 13.4085 5.00215 13.0403 5.00215L9.26996 5.00215C8.90177 5.00215 8.60329 5.30062 8.60329 5.66882L8.60329 10.7725ZM13.707 12.7151C14.4117 12.7151 14.9829 12.1438 14.9829 11.4392L14.9829 5.00215C14.9829 4.29749 14.4117 3.72622 13.707 3.72622L8.60329 3.72622C7.89864 3.72622 7.32738 4.29749 7.32738 5.00216L7.32738 11.4392C7.32738 12.1438 7.89864 12.7151 8.60329 12.7151L13.707 12.7151Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.69213 7.97654C1.66093 8.05176 1.64367 8.13424 1.64367 8.22074C1.64367 8.30724 1.66093 8.38972 1.69213 8.46494C1.72327 8.54018 1.7694 8.61068 1.83053 8.67184L3.74447 10.5857C3.9936 10.8349 4.39753 10.8349 4.64667 10.5857C4.8958 10.3366 4.8958 9.93266 4.64667 9.68352L3.82187 8.8587L6.01373 8.8587C6.36607 8.8587 6.65169 8.57307 6.65169 8.22074C6.65169 7.8684 6.36607 7.58278 6.01373 7.58278L3.82187 7.58278L4.64667 6.75796C4.8958 6.50882 4.8958 6.10488 4.64667 5.85574C4.39753 5.6066 3.9936 5.6066 3.74447 5.85574L1.83087 7.76933M9.3221 6.37892C9.5964 6.09734 10.0411 6.09734 10.3154 6.37892L11.1163 7.20107L11.9173 6.37886C12.1916 6.09728 12.6363 6.09728 12.9106 6.37886C13.1849 6.66043 13.1849 7.11695 12.9106 7.39853L12.1096 8.22074L12.9106 9.04294C13.1849 9.32451 13.1849 9.78103 12.9106 10.0626C12.6363 10.3442 12.1916 10.3442 11.9173 10.0626L11.1163 9.24041L10.3154 10.0625C10.0411 10.3441 9.59641 10.3441 9.32211 10.0625C9.04782 9.78097 9.04782 9.32445 9.32212 9.04288L10.123 8.22074L9.3221 7.39859C9.0478 7.11702 9.0478 6.6605 9.3221 6.37892Z"}}]}]},rN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"delete-cell-shift-left",ref:e,icon:Lve}))});rN.displayName="DeleteCellShiftLeft";const Pve=rN;var Bve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1088",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.31 0.72H16.31V16.72H0.31z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1088)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.02305 6.16476C8.02305 5.79657 7.72457 5.49809 7.35639 5.49809H3.58603C3.21783 5.49809 2.91936 5.79657 2.91936 6.16476V11.2684C2.91936 11.6366 3.21783 11.9351 3.58603 11.9351H7.35639C7.72457 11.9351 8.02305 11.6366 8.02305 11.2684V6.16476ZM2.91936 4.22217C2.21468 4.22217 1.64343 4.79342 1.64343 5.49809V11.9351C1.64343 12.6398 2.21468 13.211 2.91936 13.211H8.02305C8.7277 13.211 9.29897 12.6398 9.29897 11.9351V5.49809C9.29897 4.79342 8.7277 4.22217 8.02305 4.22217H2.91936Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.9342 8.9606C14.9654 8.88538 14.9827 8.8029 14.9827 8.7164C14.9827 8.6299 14.9654 8.54742 14.9342 8.4722C14.9031 8.39695 14.8569 8.32646 14.7958 8.26529L12.8819 6.35141C12.6327 6.10227 12.2288 6.10227 11.9797 6.35141C11.7305 6.60054 11.7305 7.00448 11.9797 7.25362L12.8045 8.07844H10.6126C10.2603 8.07844 9.97465 8.36406 9.97465 8.7164C9.97465 9.06874 10.2603 9.35436 10.6126 9.35436H12.8045L11.9797 10.1792C11.7305 10.4283 11.7305 10.8323 11.9797 11.0814C12.2288 11.3305 12.6327 11.3305 12.8819 11.0814L14.7955 9.1678M7.30424 10.5582C7.02994 10.8398 6.58522 10.8398 6.31092 10.5582L5.51002 9.73606L4.70905 10.5583C4.43476 10.8399 3.99003 10.8399 3.71573 10.5583C3.44144 10.2767 3.44144 9.82018 3.71573 9.5386L4.5167 8.71639L3.71575 7.8942C3.44145 7.61262 3.44145 7.1561 3.71575 6.87452C3.99005 6.59295 4.43477 6.59295 4.70907 6.87452L5.51002 7.69672L6.3109 6.87459C6.5852 6.59301 7.02993 6.59301 7.30423 6.87459C7.57852 7.15616 7.57852 7.61268 7.30422 7.89426L6.50334 8.71639L7.30424 9.53854C7.57854 9.82012 7.57854 10.2766 7.30424 10.5582Z"}}]}]},iN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"delete-cell-shift-right",ref:e,icon:Bve}))});iN.displayName="DeleteCellShiftRight";const Fve=iN;var Uve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_252_36",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z",transform:"matrix(1 0 0 -1 .23 16.22)"}}]},{tag:"g",attrs:{mask:"url(#mask0_252_36)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.92198 10.7725C7.92198 11.1407 7.6235 11.4392 7.25531 11.4392H3.48495C3.11676 11.4392 2.81829 11.1407 2.81829 10.7725V5.66882C2.81829 5.30062 3.11676 5.00215 3.48495 5.00215H7.25531C7.6235 5.00215 7.92198 5.30062 7.92198 5.66882V10.7725ZM2.81829 12.7151C2.11361 12.7151 1.54236 12.1438 1.54236 11.4392V5.00215C1.54236 4.29749 2.11361 3.72622 2.81829 3.72622H7.92198C8.62663 3.72622 9.19789 4.29749 9.19789 5.00215V11.4392C9.19789 12.1438 8.62663 12.7151 7.92198 12.7151H2.81829Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M12.1223 5.76489C12.1975 5.7337 12.28 5.71649 12.3665 5.71649C12.453 5.71649 12.5355 5.7337 12.6107 5.76489C12.6859 5.79603 12.7564 5.84217 12.8176 5.90334L14.7315 7.81723C14.9806 8.06637 14.9806 8.4703 14.7315 8.71944C14.4823 8.96858 14.0784 8.96858 13.8293 8.71944L13.0044 7.89463V10.0865C13.0044 10.4389 12.7188 10.7245 12.3665 10.7245C12.0141 10.7245 11.7285 10.4389 11.7285 10.0865V7.89463L10.9037 8.71944C10.6545 8.96858 10.2506 8.96858 10.0015 8.71944C9.75232 8.4703 9.75232 8.06637 10.0015 7.81723L11.9151 5.90363M7.20329 6.37869C6.92899 6.09711 6.48426 6.09712 6.20997 6.37869L5.40906 7.20084L4.6081 6.37863C4.3338 6.09705 3.88908 6.09705 3.61478 6.37863C3.34048 6.6602 3.34048 7.11673 3.61478 7.3983L4.41574 8.22051L3.6148 9.04271C3.3405 9.32428 3.3405 9.78081 3.6148 10.0624C3.8891 10.344 4.33382 10.344 4.60812 10.0624L5.40906 9.24018L6.20995 10.0623C6.48425 10.3439 6.92898 10.3439 7.20328 10.0623C7.47757 9.78074 7.47757 9.32422 7.20327 9.04265L6.40238 8.22051L7.20329 7.39836C7.47759 7.11679 7.47759 6.66027 7.20329 6.37869Z"}}]}]},oN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"delete-cell-shift-up",ref:e,icon:Uve}))});oN.displayName="DeleteCellShiftUp";const Hve=oN;var Vve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1098",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.4 0.72H16.4V16.72H0.4z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1098)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.3466 2.04997C13.0829 2.04997 13.6799 2.6469 13.6799 3.3833V14.05C13.6799 14.7863 13.0829 15.3833 12.3466 15.3833H9.67989C8.94351 15.3833 8.34656 14.7863 8.34656 14.05L8.34656 3.3833C8.34656 2.6469 8.94351 2.04997 9.67989 2.04997H12.3466ZM12.3466 3.3833V14.05H9.67989V3.3833H12.3466Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M4.2505 7.01395C3.99015 6.75361 3.56804 6.75361 3.30769 7.01395C3.04734 7.27431 3.04734 7.69641 3.30769 7.95677L4.06787 8.71694L3.3077 9.47711C3.04736 9.73745 3.04735 10.1596 3.3077 10.4199C3.56805 10.6803 3.99017 10.6803 4.25051 10.4199L5.01067 9.65975L5.77089 10.42C6.03125 10.6803 6.45335 10.6803 6.71371 10.42C6.97405 10.1596 6.97405 9.73751 6.71371 9.47716L5.95349 8.71694L6.71372 7.95671C6.97407 7.69636 6.97407 7.27425 6.71372 7.0139C6.45337 6.75355 6.03126 6.75355 5.77091 7.0139L5.01067 7.77413L4.2505 7.01395Z"}}]}]},sN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"delete-column",ref:e,icon:Vve}))});sN.displayName="DeleteColumn";const jve=sN;var zve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1103",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.48 0.72H16.48V16.72H0.48z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1103)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M15.146 12.667C15.146 13.4034 14.549 14.0003 13.8126 14.0003H3.14596C2.40958 14.0003 1.81262 13.4034 1.81262 12.667V10.0003C1.81262 9.26395 2.40957 8.66699 3.14596 8.66699L13.8126 8.66699C14.549 8.66699 15.146 9.26395 15.146 10.0003V12.667ZM13.8126 12.667H3.14596V10.0003H13.8126V12.667Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M10.0807 4.57118C10.341 4.31083 10.341 3.88872 10.0807 3.62837C9.8203 3.36802 9.39819 3.36802 9.13784 3.62837L8.37766 4.38855L7.6175 3.62838C7.35715 3.36803 6.93504 3.36803 6.67469 3.62838C6.41434 3.88873 6.41434 4.31085 6.67469 4.57119L7.43485 5.33135L6.67463 6.09157C6.41428 6.35193 6.41428 6.77403 6.67463 7.03439C6.93498 7.29473 7.35709 7.29473 7.61744 7.03439L8.37766 6.27417L9.1379 7.0344C9.39824 7.29475 9.82036 7.29475 10.0807 7.0344C10.3411 6.77405 10.3411 6.35194 10.0807 6.09159L9.32047 5.33135L10.0807 4.57118Z"}}]}]},aN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"delete-row",ref:e,icon:zve}))});aN.displayName="DeleteRow";const Wve=aN;var Xve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1287",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.2 0.05H16.2V16.05H0.2z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1287)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M4.19548 1.38208H2.86214C2.12576 1.38208 1.52881 1.97903 1.52881 2.71541V4.04875H2.86214V2.71541L4.19548 2.71541V1.38208zM1.52881 9.38208H2.86214V6.71541H1.52881V9.38208zM6.86214 1.38208V2.71541H7.52881V5.38208H8.86214V2.71541H9.52881V1.38208H6.86214zM12.1955 1.38208V2.71541H13.5288V4.04875H14.8621V2.71541C14.8621 1.97903 14.2652 1.38208 13.5288 1.38208H12.1955zM14.8621 6.71541H13.5288V7.38208H10.8621V8.71541H13.5288V9.38208H14.8621V6.71541zM7.52881 13.3821V10.7154H8.86214V13.3821H7.52881zM5.52881 7.38208H2.86214V8.71541H5.52881V7.38208z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.52881 13.3824V12.0491H2.86214L2.86214 13.3824H13.5288V12.0491H14.8621V13.3824C14.8621 14.1188 14.2652 14.7157 13.5288 14.7157H2.86214C2.12576 14.7157 1.52881 14.1188 1.52881 13.3824Z"}}]}]},lN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"down-border",ref:e,icon:Xve}))});lN.displayName="DownBorder";const Yve=lN;var Gve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.39 0.21H16.39V16.21H0.39z",opacity:.01}},{tag:"path",attrs:{fill:"currentColor",d:"M8.48755 1.7124C4.89804 1.7124 1.98755 4.62289 1.98755 8.2124C1.98755 11.8019 4.89804 14.7124 8.48755 14.7124C12.0771 14.7124 14.9875 11.8019 14.9875 8.2124C14.9875 4.62289 12.0771 1.7124 8.48755 1.7124ZM10.8873 10.682L9.92972 10.6777L8.48753 8.95834L7.04679 10.6762L6.08775 10.6806C6.02391 10.6806 5.97168 10.6298 5.97168 10.5645C5.97168 10.5369 5.98184 10.5108 5.99925 10.489L7.88686 8.24015L5.99925 5.99272C5.98184 5.97095 5.97168 5.94484 5.97168 5.91727C5.97168 5.85343 6.02391 5.8012 6.08775 5.8012L7.04679 5.80555L8.48753 7.52486L9.92826 5.807L10.8859 5.80265C10.9497 5.80265 11.0019 5.85343 11.0019 5.91872C11.0019 5.94629 10.9918 5.97241 10.9744 5.99417L9.08965 8.2416L10.9758 10.4905C10.9932 10.5122 11.0034 10.5384 11.0034 10.5659C11.0034 10.6298 10.9511 10.682 10.8873 10.682Z",fillRule:"evenodd",clipRule:"evenodd"}}]},uN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"error-single",ref:e,icon:Gve}))});uN.displayName="ErrorSingle";const Kve=uN;var Zve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1198",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.92 0.59H16.92V16.59H0.92z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1198)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6.60668 10.576C6.65219 10.4632 6.69764 10.3462 6.74303 10.225L7.25057 8.86766H10.578L11.2717 10.7077C11.3244 10.8758 11.4061 11.0194 11.5216 11.1295C11.6593 11.2608 11.8312 11.3154 12.0208 11.3058C12.2738 11.3049 12.5113 11.2297 12.619 10.995L12.6207 10.991C12.7095 10.7855 12.6943 10.5552 12.6123 10.3207L9.77288 2.45517C9.71484 2.28008 9.60947 2.1406 9.46151 2.04182C9.30774 1.93043 9.11827 1.88292 8.90735 1.88292C8.7021 1.88292 8.51689 1.93194 8.36397 2.04378C8.22418 2.14402 8.12555 2.28364 8.06872 2.45523L5.24337 10.2932L5.24219 10.2967C5.1894 10.4523 5.15765 10.5974 5.15765 10.7264C5.15765 10.8564 5.19054 10.9855 5.28219 11.0827C5.42193 11.2386 5.61147 11.3058 5.82541 11.3058C5.95627 11.3058 6.07743 11.2663 6.18094 11.1834C6.28267 11.1165 6.36558 11.0249 6.43038 10.9135C6.49925 10.8095 6.55795 10.6969 6.60668 10.576ZM7.64042 7.59332L8.92081 3.92007L10.2012 7.59332H7.64042Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"rect",attrs:{width:11.58,height:2.56,x:3.13,y:12.79,fill:"colorChannel1",rx:1.28}}]}]},cN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"font-color",ref:e,icon:Zve}))});cN.displayName="FontColor";const qve=cN;var Qve={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_680",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.07 0.06H16.07V16.06H0.07z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_680)"},children:[{tag:"path",attrs:{d:"M14.3853 4.71405C14.7561 4.71405 14.9414 4.48869 14.9414 4.03797C14.9414 3.81988 14.8942 3.65268 14.7997 3.53637C14.7052 3.41278 14.5707 3.35099 14.3962 3.35099H12.9459V1.84617C12.9459 1.47542 12.7206 1.29004 12.2698 1.29004C12.0445 1.29004 11.8736 1.34093 11.7573 1.4427C11.641 1.53721 11.5829 1.66806 11.5829 1.83526V3.35099H10.2525C10.0199 3.35099 9.84904 3.40915 9.73999 3.52546C9.63822 3.64178 9.58733 3.81261 9.58733 4.03797C9.58733 4.25606 9.63822 4.42326 9.73999 4.53958C9.84177 4.65589 10.009 4.71405 10.2416 4.71405H11.5829V6.19706C11.5829 6.42969 11.641 6.60053 11.7573 6.70957C11.8736 6.81135 12.0445 6.86224 12.2698 6.86224C12.4879 6.86224 12.6551 6.81135 12.7714 6.70957C12.8878 6.6078 12.9459 6.4406 12.9459 6.20797V4.71405H14.3853Z"}},{tag:"path",attrs:{d:"M3.53596 13.2577L4.30239 11.1079H9.25615L10.2843 13.968C10.3466 14.1799 10.4401 14.3481 10.5647 14.4727C10.7018 14.6098 10.8762 14.6721 11.0881 14.6597C11.4121 14.6597 11.6178 14.56 11.705 14.3606C11.7922 14.1487 11.786 13.8932 11.6863 13.5941L7.74198 2.13508C7.67967 1.93568 7.56751 1.7799 7.4055 1.66774C7.24349 1.54312 7.03163 1.48081 6.76993 1.48081C6.52068 1.48081 6.31505 1.54312 6.15304 1.66774C6.0035 1.7799 5.89757 1.93568 5.83525 2.13508L1.90964 13.5568C1.77255 13.9805 1.77255 14.2671 1.90964 14.4167C2.04672 14.5787 2.23989 14.6597 2.48913 14.6597C2.62622 14.6597 2.74461 14.616 2.84431 14.5288C2.95647 14.454 3.04994 14.3481 3.12471 14.211C3.21195 14.0739 3.28672 13.9244 3.34903 13.7624C3.41134 13.6004 3.47365 13.4321 3.53596 13.2577ZM6.78862 3.38754L8.91967 9.79938H4.65757L6.78862 3.38754Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},dN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"font-size-increase-single",ref:e,icon:Qve}))});dN.displayName="FontSizeIncreaseSingle";const Jve=dN;var e_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_683",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.07 0.06H16.07V16.06H0.07z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_683)"},children:[{tag:"path",attrs:{d:"M3.45597 13.3346L4.23118 11.1602H9.24166L10.2816 14.053C10.3446 14.2673 10.4391 14.4375 10.5652 14.5636C10.7038 14.7022 10.8803 14.7652 11.0946 14.7526C11.4223 14.7526 11.6303 14.6518 11.7185 14.4501C11.8068 14.2358 11.8005 13.9774 11.6996 13.6749L7.71016 2.08461C7.64713 1.88293 7.53369 1.72537 7.36982 1.61193C7.20596 1.48588 6.99167 1.42285 6.72697 1.42285C6.47487 1.42285 6.26689 1.48588 6.10302 1.61193C5.95176 1.72537 5.84462 1.88293 5.78159 2.08461L1.81102 13.6371C1.67237 14.0657 1.67237 14.3556 1.81102 14.5068C1.94968 14.6707 2.14505 14.7526 2.39715 14.7526C2.53581 14.7526 2.65556 14.7085 2.7564 14.6203C2.86984 14.5446 2.96438 14.4375 3.04001 14.2988C3.12824 14.1602 3.20387 14.0089 3.2669 13.8451C3.32992 13.6812 3.39295 13.511 3.45597 13.3346ZM6.74588 3.35141L8.90133 9.83668H4.59042L6.74588 3.35141Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M13.8752 4.0259C14.2502 4.0259 14.4377 3.79796 14.4377 3.34208C14.4377 3.12149 14.3899 2.95238 14.2943 2.83473C14.1987 2.70973 14.0627 2.64723 13.8862 2.64723H10.2465C10.0112 2.64723 9.83841 2.70605 9.72811 2.8237C9.62517 2.94135 9.5737 3.11414 9.5737 3.34208C9.5737 3.57002 9.62517 3.74281 9.72811 3.86046C9.83106 3.97075 10.0002 4.0259 10.2355 4.0259H13.8752Z"}}]}]},hN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"font-size-reduce-single-single",ref:e,icon:e_e}))});hN.displayName="FontSizeReduceSingleSingle";const t_e=hN;var n_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_765",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#CDCDCD",d:"M0.25 0.44H16.25V16.44H0.25z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_765)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.582 1.77295C14.3184 1.77295 14.9154 2.36991 14.9154 3.10628V13.7729C14.9154 14.5093 14.3184 15.1063 13.582 15.1063H2.91536C2.17899 15.1063 1.58203 14.5093 1.58203 13.7729V3.10628C1.58203 2.3699 2.17898 1.77295 2.91536 1.77295H13.582ZM5.91536 3.10628H5.87658L2.91536 5.73897V6.91697L5.91536 4.14773V3.10628ZM7.2487 4.43642V3.10628H13.582V13.7729H7.2487V10.4586C7.24906 10.4459 7.24906 10.4331 7.2487 10.4204V7.44248C7.24871 7.44046 7.24871 7.43844 7.2487 7.43642V4.44248C7.24871 4.44046 7.24871 4.43844 7.2487 4.43642ZM5.91536 5.96228L2.91536 8.73151V9.91697L5.91536 7.14774V5.96228ZM5.91536 8.96228L2.91536 11.7315V13.0089L5.91536 10.154V8.96228ZM5.91536 11.9946L4.0466 13.7729H5.91536V11.9946ZM3.86986 3.10628L2.91536 3.95488V3.10628H3.86986Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},fN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"freeze-column-single",ref:e,icon:n_e}))});fN.displayName="FreezeColumnSingle";const r_e=fN;var i_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_724",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#939393",d:"M0.25 0.44H16.25V16.44H0.25z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_724)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.2926 1.77296H13.582C14.3184 1.77296 14.9154 2.36992 14.9154 3.10629V13.773C14.9154 14.5093 14.3184 15.1063 13.582 15.1063H2.91536C2.17899 15.1063 1.58203 14.5094 1.58203 13.773V3.10629C1.58203 2.36991 2.17898 1.77296 2.91536 1.77296H12.2864C12.2884 1.77295 12.2905 1.77295 12.2926 1.77296ZM9.14683 6.12582L12.5432 3.10629H13.582V3.47816L10.638 6.12582H9.14683ZM7.14009 6.12582L10.5365 3.10629H9.20986L5.81349 6.12582H7.14009ZM7.20313 3.10629L3.80676 6.12582H2.91536V5.73896L5.87657 3.10629H7.20313ZM12.6319 6.12582H13.582V5.27138L12.6319 6.12582ZM2.91536 3.95488L3.86984 3.10629H2.91536V3.95488ZM2.91536 7.45916H13.582V13.773H2.91536V7.45916Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},mN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"freeze-row-single",ref:e,icon:i_e}))});mN.displayName="FreezeRowSingle";const o_e=mN;var s_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_721",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.25 0.44H16.25V16.44H0.25z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_721)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.5823 1.77246C14.3187 1.77246 14.9157 2.36942 14.9157 3.10579V13.7725C14.9157 14.5089 14.3187 15.1058 13.5823 15.1058H2.91567C2.1793 15.1058 1.58234 14.5089 1.58234 13.7725V3.10579C1.58234 2.36941 2.17929 1.77246 2.91567 1.77246H13.5823ZM13.5823 6.77246V4.98742L11.6486 6.77246H13.5823ZM9.68281 6.77246L13.4635 3.2826C13.5005 3.24839 13.5404 3.21918 13.5823 3.19494V3.10579H12.178L8.23971 6.77246H9.68281ZM7.249 8.10579H13.5823V13.7725H7.249V10.4662C7.24974 10.4481 7.24974 10.4299 7.249 10.4118V8.10579ZM5.91567 13.7725V11.9843L4.01869 13.7725H5.91567ZM5.91567 8.93622V10.1519L2.91567 12.9799V11.7293L5.91567 8.93622ZM10.2213 3.10579L2.91567 9.90757V8.73607L9.17238 3.10579H10.2213ZM5.87689 3.10579H7.1791L2.91567 6.94237V5.73848L5.87689 3.10579ZM3.87016 3.10579L2.91567 3.95439V3.10579H3.87016Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},pN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"freeze-to-selected-single",ref:e,icon:s_e}))});pN.displayName="FreezeToSelectedSingle";const a_e=pN;var l_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.57847 2.911C3.6814 2.66251 3.92388 2.50049 4.19285 2.50049H12.6649C12.8412 2.50049 13.0104 2.57055 13.1351 2.69526L14.0115 3.57168C14.2712 3.83138 14.2712 4.25243 14.0115 4.51213C13.7518 4.77183 13.3308 4.77183 13.0711 4.51213L12.3894 3.83049H5.7983L9.92158 7.95376C10.1813 8.21346 10.1813 8.63452 9.92158 8.89421L5.7983 13.0175H12.3894L13.0711 12.3358C13.3308 12.0761 13.7518 12.0761 14.0115 12.3358C14.2712 12.5955 14.2712 13.0166 14.0115 13.2763L13.1351 14.1527C13.0104 14.2774 12.8412 14.3475 12.6649 14.3475H4.19285C3.92388 14.3475 3.6814 14.1855 3.57847 13.937C3.47554 13.6885 3.53244 13.4025 3.72263 13.2123L8.5109 8.42399L3.72263 3.63571C3.53244 3.44553 3.47554 3.1595 3.57847 2.911Z",fillRule:"evenodd",clipRule:"evenodd"}}]},gN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"function-single",ref:e,icon:l_e}))});gN.displayName="FunctionSingle";const u_e=gN;var c_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1151",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.18 0.65H16.18V16.65H0.18z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1151)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.19879 5.56037C7.83419 5.56037 7.47414 5.60909 7.12116 5.69671C6.7898 5.77897 6.45449 5.57703 6.37223 5.24567C6.28997 4.9143 6.49191 4.579 6.82327 4.49674C7.2632 4.38753 7.7235 4.32397 8.19879 4.32397C10.1211 4.32397 11.8061 5.36053 12.9646 6.32082C13.5527 6.80824 14.027 7.29424 14.3546 7.65836C14.5187 7.84082 14.6469 7.99372 14.7351 8.10232C14.7792 8.15665 14.8134 8.19997 14.8371 8.23045C14.8489 8.2457 14.8581 8.25774 14.8647 8.26635L14.8725 8.27666L14.8749 8.27984L14.8757 8.28092C14.8757 8.28092 14.8762 8.28166 14.3808 8.65137C14.8762 9.02109 14.8761 9.02124 14.8761 9.02124L14.8757 9.02183L14.8749 9.02291L14.8725 9.02609L14.8647 9.0364C14.8581 9.04501 14.8489 9.05705 14.8371 9.07229C14.8134 9.10277 14.7792 9.1461 14.7351 9.20042C14.6469 9.30902 14.5187 9.46193 14.3546 9.64439C14.027 10.0085 13.5527 10.4945 12.9646 10.9819C12.7018 11.1998 12.312 11.1633 12.0942 10.9005C11.8763 10.6376 11.9127 10.2479 12.1756 10.03C12.7063 9.59013 13.1373 9.14883 13.4354 8.81748C13.4887 8.75824 13.5376 8.70265 13.5819 8.65137C13.5376 8.60009 13.4887 8.5445 13.4354 8.48526C13.1373 8.15391 12.7063 7.71261 12.1756 7.27273C11.0967 6.37842 9.69068 5.56037 8.19879 5.56037ZM14.3808 8.65137L14.8761 9.02124C15.0398 8.80193 15.0399 8.50097 14.8762 8.28166L14.3808 8.65137ZM4.30341 6.40226C4.52129 6.66512 4.48483 7.05484 4.22197 7.27272C3.69128 7.71261 3.26029 8.15391 2.9622 8.48526C2.90891 8.5445 2.85999 8.60009 2.81563 8.65137C2.85999 8.70266 2.90891 8.75824 2.9622 8.81748C3.26028 9.14884 3.69128 9.59014 4.22197 10.03C5.30088 10.9243 6.70689 11.7424 8.19879 11.7424C8.56643 11.7424 8.92941 11.6929 9.28516 11.6039C9.61638 11.521 9.95205 11.7223 10.0349 12.0536C10.1178 12.3848 9.91643 12.7204 9.58521 12.8033C9.142 12.9142 8.67802 12.9788 8.19879 12.9788C6.27646 12.9788 4.59147 11.9422 3.43294 10.9819C2.84491 10.4945 2.37057 10.0085 2.04301 9.64439C1.87887 9.46193 1.75064 9.30902 1.66246 9.20042C1.61835 9.14609 1.5842 9.10277 1.56052 9.07229C1.54867 9.05705 1.53945 9.04501 1.53289 9.0364L1.52508 9.02608L1.52269 9.02291L1.52188 9.02183C1.52188 9.02183 1.52133 9.02108 2.01679 8.65137C1.52133 8.28166 1.52144 8.28151 1.52144 8.28151L1.52269 8.27983L1.52508 8.27666L1.53289 8.26635C1.53945 8.25774 1.54867 8.2457 1.56052 8.23045C1.5842 8.19997 1.61835 8.15665 1.66246 8.10232C1.75064 7.99372 1.87887 7.84082 2.04301 7.65836C2.37057 7.29424 2.84491 6.80824 3.43294 6.32082C3.6958 6.10294 4.08552 6.1394 4.30341 6.40226ZM2.01679 8.65137L1.52144 8.28151C1.35779 8.50082 1.35823 8.80252 1.52188 9.02183L2.01679 8.65137Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M4.06119 3.63932C3.81977 3.3979 3.42835 3.3979 3.18693 3.63932C2.9455 3.88074 2.9455 4.27216 3.18693 4.51358L6.29536 7.62202C6.12957 7.92817 6.03522 8.279 6.03522 8.65125C6.03522 9.84622 7.00395 10.8149 8.19892 10.8149C8.57125 10.8149 8.92203 10.7206 9.22813 10.5548L12.2932 13.6199C12.5346 13.8613 12.926 13.8613 13.1675 13.6199C13.4089 13.3784 13.4089 12.987 13.1675 12.7456L4.06119 3.63932ZM8.25049 9.57715L7.27302 8.59968C7.27209 8.61674 7.27162 8.63394 7.27162 8.65125C7.27162 9.16337 7.68679 9.57855 8.19892 9.57855C8.21623 9.57855 8.23342 9.57808 8.25049 9.57715Z"}}]}]},vN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"hide",ref:e,icon:c_e}))});vN.displayName="Hide";const d_e=vN;var h_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_208_115",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M16.87 0.6H32.870000000000005V16.6H16.87z",transform:"rotate(90 16.87 .6)"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_208_115)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{d:"M14.2081 1.93335C14.9444 1.93335 15.5414 2.5303 15.5414 3.26667L15.5414 5.9333C15.5414 6.66967 14.9444 7.26661 14.2081 7.26661L3.54153 7.26661C2.80517 7.26661 2.20822 6.66967 2.20822 5.9333L2.20822 3.26667C2.20822 2.5303 2.80516 1.93335 3.54153 1.93335L14.2081 1.93335zM14.2081 3.26667L14.2081 5.9333 11.5485 5.9333 11.5485 3.26667 14.2081 3.26667zM10.2152 3.26667L7.5344 3.26667 7.5344 5.9333 10.2152 5.9333 10.2152 3.26667zM3.54153 3.26667L6.20109 3.26667 6.20109 5.9333 3.54153 5.9333 3.54153 3.26667zM14.2081 9.93325C14.9444 9.93325 15.5414 10.5302 15.5414 11.2666L15.5414 13.9332C15.5414 14.6696 14.9444 15.2665 14.2081 15.2665L3.54153 15.2665C2.80516 15.2665 2.20822 14.6696 2.20822 13.9332L2.20822 11.2666C2.20822 10.5302 2.80516 9.93325 3.54153 9.93325L14.2081 9.93325zM14.2081 11.2666L14.2081 13.9332 11.5485 13.9332 11.5485 11.2666 14.2081 11.2666zM10.2152 11.2666L7.5344 11.2666 7.5344 13.9332 10.2152 13.9332 10.2152 11.2666zM3.54153 11.2666L6.20109 11.2666 6.20109 13.9332 3.54153 13.9332 3.54153 11.2666z"}}]}]},_N=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"horizontal-merge-single",ref:e,icon:h_e}))});_N.displayName="HorizontalMergeSingle";const f_e=_N;var m_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_824",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z",transform:"matrix(-1 0 0 1 16.88 .33)"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_824)"},children:[{tag:"path",attrs:{d:"M14.8825 2.67969C15.2415 2.67969 15.5325 2.9707 15.5325 3.32969 15.5325 3.68867 15.2415 3.97969 14.8825 3.97969L2.88247 3.97969C2.52349 3.97969 2.23247 3.68867 2.23247 3.32969 2.23247 2.9707 2.52349 2.67969 2.88247 2.67969L14.8825 2.67969zM13.5825 6.01306C13.9415 6.01306 14.2325 6.30408 14.2325 6.66306 14.2325 7.02205 13.9415 7.31306 13.5825 7.31306L4.24913 7.31306C3.89015 7.31306 3.59913 7.02205 3.59913 6.66306 3.59913 6.30408 3.89015 6.01306 4.24913 6.01306L13.5825 6.01306zM15.5325 9.99631C15.5325 9.63733 15.2415 9.34631 14.8825 9.34631L2.88247 9.34631C2.52348 9.34631 2.23247 9.63733 2.23247 9.99631 2.23247 10.3553 2.52348 10.6463 2.88247 10.6463L14.8825 10.6463C15.2415 10.6463 15.5325 10.3553 15.5325 9.99631zM13.5825 12.6797C13.9415 12.6797 14.2325 12.9707 14.2325 13.3297 14.2325 13.6887 13.9415 13.9797 13.5825 13.9797L4.24913 13.9797C3.89015 13.9797 3.59913 13.6887 3.59913 13.3297 3.59913 12.9707 3.89015 12.6797 4.24913 12.6797L13.5825 12.6797z"}}]}]},bN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"horizontally-single",ref:e,icon:m_e}))});bN.displayName="HorizontallySingle";const p_e=bN;var g_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1307",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.2 0.05H16.2V16.05H0.2z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1307)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M1.52881 12.0487V13.3821C1.52881 14.1185 2.12576 14.7154 2.86214 14.7154H4.19548V13.3821H2.86214L2.86214 12.0487H1.52881ZM4.19548 1.38208H2.86214C2.12576 1.38208 1.52881 1.97903 1.52881 2.71541V4.04875H2.86214V2.71541L4.19548 2.71541V1.38208ZM1.52881 9.38208H2.86214V6.71541H1.52881V9.38208ZM6.86214 1.38208V2.71541H9.52881V1.38208H6.86214ZM12.1955 1.38208V2.71541H13.5288V4.04875H14.8621V2.71541C14.8621 1.97903 14.2652 1.38208 13.5288 1.38208H12.1955ZM14.8621 6.71541H13.5288V9.38208H14.8621V6.71541ZM14.8621 12.0487H13.5288V13.3821H12.1955V14.7154H13.5288C14.2652 14.7154 14.8621 14.1185 14.8621 13.3821V12.0487ZM9.52881 14.7154V13.3821H6.86214V14.7154H9.52881Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.86243 7.38322V2.71655H7.52909V7.38322H2.86243V8.71655H7.52909V13.3832H8.86243V8.71655H13.5291V7.38322H8.86243Z"}}]}]},CN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"inner-border",ref:e,icon:g_e}))});CN.displayName="InnerBorder";const v_e=CN;var __e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1113",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.64 0.72H16.64V16.72H0.64z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1113)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.30259 6.16476C8.30259 5.79657 8.00411 5.49809 7.63593 5.49809H3.86557C3.49737 5.49809 3.1989 5.79657 3.1989 6.16476V11.2684C3.1989 11.6366 3.49737 11.9351 3.86557 11.9351H7.63593C8.00411 11.9351 8.30259 11.6366 8.30259 11.2684V6.16476ZM3.1989 4.22217C2.49422 4.22217 1.92297 4.79342 1.92297 5.49809V11.9351C1.92297 12.6398 2.49422 13.211 3.1989 13.211H8.30259C9.00724 13.211 9.57851 12.6398 9.57851 11.9351V5.49809C9.57851 4.79342 9.00724 4.22217 8.30259 4.22217H3.1989Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M12.5641 11.1818C12.6393 11.213 12.7218 11.2302 12.8083 11.2302C12.8948 11.2302 12.9773 11.213 13.0525 11.1818C13.1278 11.1506 13.1983 11.1045 13.2594 11.0433L15.1733 9.12943C15.4224 8.88029 15.4224 8.47635 15.1733 8.22721C14.9242 7.97807 14.5202 7.97807 14.2711 8.22721L13.4463 9.05203V6.86013C13.4463 6.50779 13.1607 6.22217 12.8083 6.22217C12.456 6.22217 12.1704 6.50779 12.1704 6.86013V9.05203L11.3455 8.22721C11.0964 7.97807 10.6925 7.97807 10.4433 8.22721C10.1942 8.47635 10.1942 8.88029 10.4433 9.12943L12.3569 11.043"}}]}]},yN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"insert-cell-down",ref:e,icon:__e}))});yN.displayName="InsertCellDown";const b_e=yN;var C_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1108",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.78 0.72H16.78V16.72H0.78z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1108)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.34764 6.16476C8.34764 5.79657 8.04916 5.49809 7.68097 5.49809H3.91061C3.54242 5.49809 3.24394 5.79657 3.24394 6.16476V11.2684C3.24394 11.6366 3.54242 11.9351 3.91061 11.9351H7.68097C8.04916 11.9351 8.34764 11.6366 8.34764 11.2684V6.16476ZM3.24394 4.22217C2.53927 4.22217 1.96802 4.79342 1.96802 5.49809V11.9351C1.96802 12.6398 2.53927 13.211 3.24394 13.211H8.34764C9.05228 13.211 9.62355 12.6398 9.62355 11.9351V5.49809C9.62355 4.79342 9.05228 4.22217 8.34764 4.22217H3.24394Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M15.5466 8.9606C15.5778 8.88538 15.595 8.8029 15.595 8.7164C15.595 8.6299 15.5778 8.54742 15.5466 8.4722C15.5155 8.39695 15.4693 8.32646 15.4082 8.26529L13.4943 6.35141C13.2452 6.10227 12.8412 6.10227 12.5921 6.35141C12.3429 6.60054 12.3429 7.00448 12.5921 7.25362L13.4169 8.07844H11.225C10.8727 8.07844 10.587 8.36406 10.587 8.7164C10.587 9.06874 10.8727 9.35436 11.225 9.35436H13.4169L12.5921 10.1792C12.3429 10.4283 12.3429 10.8323 12.5921 11.0814C12.8412 11.3305 13.2452 11.3305 13.4943 11.0814L15.4079 9.1678"}}]}]},SN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"insert-cell-shift-right",ref:e,icon:C_e}))});SN.displayName="InsertCellShiftRight";const y_e=SN;var S_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1128",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.81 0.72H16.81V16.72H0.81z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1128)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.1416 14.1255C14.878 14.1255 15.475 13.5285 15.475 12.7922L15.475 10.1255C15.475 9.38911 14.878 8.79215 14.1416 8.79215L3.47498 8.79216C2.73858 8.79216 2.14164 9.38911 2.14164 10.1255L2.14164 12.7922C2.14164 13.5285 2.73858 14.1255 3.47498 14.1255L14.1416 14.1255ZM3.47498 12.7922L14.1416 12.7922L14.1416 10.1255L3.47498 10.1255L3.47498 12.7922Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M8.54997 3.30817C8.91815 3.30817 9.21663 3.60664 9.21663 3.97483L9.21663 5.04989L10.2918 5.04989C10.66 5.04989 10.9584 5.34836 10.9584 5.71655C10.9584 6.08474 10.66 6.38322 10.2918 6.38322L9.21663 6.38322L9.21663 7.45833C9.21663 7.82652 8.91816 8.125 8.54997 8.125C8.18178 8.125 7.8833 7.82652 7.8833 7.45833L7.8833 6.38322L6.80827 6.38322C6.44007 6.38322 6.1416 6.08474 6.1416 5.71655C6.1416 5.34836 6.44007 5.04989 6.80827 5.04989L7.8833 5.04989L7.8833 3.97483C7.8833 3.60664 8.18177 3.30817 8.54997 3.30817Z"}}]}]},EN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"insert-row-above",ref:e,icon:S_e}))});EN.displayName="InsertRowAbove";const E_e=EN;var w_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1133",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M16.31 16.72H32.31V32.72H16.31z",transform:"rotate(180 16.3 16.72)"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1133)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.97506 3.30811C2.23868 3.30811 1.64172 3.90506 1.64172 4.64144L1.64172 7.30811C1.64172 8.04449 2.23868 8.64144 2.97506 8.64144L13.6417 8.64144C14.3781 8.64144 14.9751 8.04448 14.9751 7.3081L14.9751 4.64144C14.9751 3.90506 14.3781 3.3081 13.6417 3.3081L2.97506 3.30811ZM13.6417 4.64144L2.97506 4.64144L2.97506 7.30811L13.6417 7.3081L13.6417 4.64144Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M8.56667 14.1254C8.19848 14.1254 7.9 13.827 7.9 13.4588L7.9 12.3837L6.82487 12.3837C6.45668 12.3837 6.1582 12.0852 6.1582 11.717C6.1582 11.3489 6.45668 11.0504 6.82487 11.0504L7.9 11.0504L7.9 9.97526C7.9 9.60707 8.19848 9.30859 8.56667 9.30859C8.93486 9.30859 9.23334 9.60707 9.23334 9.97526L9.23334 11.0504L10.3084 11.0504C10.6766 11.0504 10.975 11.3489 10.975 11.717C10.975 12.0852 10.6766 12.3837 10.3084 12.3837L9.23334 12.3837L9.23334 13.4588C9.23334 13.827 8.93486 14.1254 8.56667 14.1254Z"}}]}]},wN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"insert-row-below",ref:e,icon:w_e}))});wN.displayName="InsertRowBelow";const R_e=wN;var D_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_233_16",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.55 0.53H16.55V16.53H0.55z"}}]},{tag:"g",attrs:{mask:"url(#mask0_233_16)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.08174 14.5298C2.90495 14.5298 2.73541 14.4595 2.6104 14.3345C2.4854 14.2095 2.41518 14.0399 2.41518 13.8631C2.41518 13.6863 2.4854 13.5168 2.6104 13.3918C2.73541 13.2667 2.90495 13.1965 3.08174 13.1965L14.0151 13.1965C14.1919 13.1965 14.3614 13.2667 14.4864 13.3918C14.6114 13.5168 14.6816 13.6863 14.6816 13.8631C14.6816 14.0399 14.6114 14.2095 14.4864 14.3345C14.3614 14.4595 14.1919 14.5298 14.0151 14.5298L3.08174 14.5298ZM3.08174 3.86312C2.90495 3.86309 2.7354 3.79284 2.6104 3.66782C2.4854 3.5428 2.41518 3.37325 2.41518 3.19645C2.41518 3.01966 2.4854 2.85011 2.6104 2.72508C2.7354 2.60006 2.90495 2.52981 3.08174 2.52979L14.0151 2.52979C14.1919 2.52981 14.3614 2.60006 14.4864 2.72508C14.6114 2.8501 14.6816 3.01966 14.6816 3.19645C14.6816 3.37325 14.6114 3.5428 14.4864 3.66782C14.3614 3.79284 14.1919 3.86309 14.0151 3.86312L3.08174 3.86312Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.6057 7.86306L10.7437 7.00106C10.6187 6.87605 10.5485 6.70651 10.5485 6.52972C10.5485 6.35294 10.6187 6.1834 10.7437 6.05839C10.8687 5.93338 11.0383 5.86316 11.215 5.86316C11.3918 5.86316 11.5614 5.93338 11.6864 6.05839L13.6864 8.05839C13.7483 8.12025 13.7975 8.19372 13.831 8.27459C13.8646 8.35547 13.8818 8.44217 13.8818 8.52972C13.8818 8.61728 13.8646 8.70398 13.831 8.78485C13.7975 8.86573 13.7483 8.9392 13.6864 9.00106L11.6864 11.0011C11.6245 11.063 11.551 11.1121 11.4701 11.1455C11.3892 11.179 11.3026 11.1963 11.215 11.1963C11.1275 11.1963 11.0408 11.179 10.96 11.1456C10.8791 11.1121 10.8056 11.063 10.7437 11.0011C10.6818 10.9392 10.6327 10.8657 10.5992 10.7848C10.5657 10.7039 10.5485 10.6173 10.5485 10.5297C10.5485 10.4422 10.5657 10.3555 10.5992 10.2746C10.6327 10.1938 10.6818 10.1203 10.7437 10.0584L11.6057 9.19639L3.8817 9.19639C3.70489 9.19639 3.53532 9.12615 3.4103 9.00113C3.28527 8.8761 3.21503 8.70654 3.21503 8.52972C3.21503 8.35291 3.28527 8.18334 3.4103 8.05832C3.53532 7.9333 3.70489 7.86306 3.8817 7.86306L11.6057 7.86306Z"}}]}]},RN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"insert",ref:e,icon:D_e}))});RN.displayName="Insert";const I_e=RN;var x_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_665",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.07 0.06H16.07V16.06H0.07z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_665)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6.90859 1.94452C6.90859 1.59492 7.192 1.31152 7.54159 1.31152H10.2618C10.6114 1.31152 10.8948 1.59492 10.8948 1.94452C10.8948 2.29411 10.6114 2.57751 10.2618 2.57751H9.52336L7.94858 13.5428H8.59764C8.94724 13.5428 9.23064 13.8262 9.23064 14.1758C9.23064 14.5254 8.94724 14.8088 8.59764 14.8088H5.87738C5.52779 14.8088 5.24438 14.5254 5.24438 14.1758C5.24438 13.8262 5.52779 13.5428 5.87738 13.5428H6.66472L8.23951 2.57751H7.54159C7.192 2.57751 6.90859 2.29411 6.90859 1.94452Z"}}]}]},DN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"italic-single",ref:e,icon:x_e}))});DN.displayName="ItalicSingle";const M_e=DN;var O_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_883",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.51 0.5H16.51V16.5H0.51z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_883)"},children:[{tag:"path",attrs:{d:"M4.37501 6.97149C4.28567 7.0085 4.18992 7.02754 4.09322 7.02754V7.02607C3.89812 7.02607 3.71102 6.94857 3.57306 6.81062 3.43511 6.67266 3.35761 6.48556 3.35761 6.29046 3.35761 6.09536 3.43511 5.90826 3.57306 5.77031 3.71102 5.63235 3.89812 5.55485 4.09322 5.55485 4.18992 5.55485 4.28567 5.5739 4.37501 5.6109 4.46434 5.64791 4.54552 5.70214 4.6139 5.77052 4.68227 5.8389 4.73651 5.92007 4.77351 6.00941 4.81052 6.09875 4.82957 6.1945 4.82957 6.2912 4.82957 6.38789 4.81052 6.48365 4.77351 6.57298 4.73651 6.66232 4.68227 6.7435 4.6139 6.81187 4.54552 6.88025 4.46434 6.93449 4.37501 6.97149zM4.61337 9.01745C4.75133 8.8795 4.82883 8.69239 4.82883 8.49729 4.82883 8.3022 4.75133 8.11509 4.61337 7.97714 4.47542 7.83918 4.28832 7.76168 4.09322 7.76168 3.89812 7.76168 3.71102 7.83918 3.57306 7.97714 3.43511 8.11509 3.35761 8.3022 3.35761 8.49729 3.35761 8.69239 3.43511 8.8795 3.57306 9.01745 3.71102 9.1554 3.89812 9.2329 4.09322 9.2329 4.28832 9.2329 4.47542 9.1554 4.61337 9.01745zM4.61337 11.2243C4.47542 11.3622 4.28832 11.4397 4.09322 11.4397 3.89812 11.4397 3.71102 11.3622 3.57306 11.2243 3.43511 11.0863 3.35761 10.8992 3.35761 10.7041 3.35761 10.509 3.43511 10.3219 3.57306 10.184 3.71102 10.046 3.89812 9.96852 4.09322 9.96852 4.28832 9.96852 4.47542 10.046 4.61337 10.184 4.75133 10.3219 4.82883 10.509 4.82883 10.7041 4.82883 10.8992 4.75133 11.0863 4.61337 11.2243zM6.97995 6.57202C7.01683 6.48274 7.03576 6.38706 7.03566 6.29046 7.03547 6.09536 6.95778 5.90834 6.81969 5.77052 6.6816 5.6327 6.49441 5.55539 6.29932 5.55559 6.10422 5.55578 5.91719 5.63347 5.77938 5.77156 5.64156 5.90965 5.56425 6.09684 5.56444 6.29193 5.56454 6.38853 5.58366 6.48417 5.62072 6.57338 5.65778 6.66259 5.71204 6.74363 5.78042 6.81187 5.84879 6.88011 5.92994 6.93422 6.01923 6.97109 6.10851 7.00797 6.20419 7.0269 6.30079 7.02681 6.39739 7.02671 6.49303 7.00759 6.58224 6.97053 6.67145 6.93347 6.75249 6.87921 6.82073 6.81083 6.88897 6.74246 6.94307 6.66131 6.97995 6.57202zM6.58156 9.17691C6.49231 9.21388 6.39665 9.23291 6.30005 9.2329 6.10496 9.2329 5.91785 9.1554 5.7799 9.01745 5.64194 8.8795 5.56444 8.69239 5.56444 8.49729 5.56444 8.3022 5.64194 8.11509 5.7799 7.97714 5.91785 7.83918 6.10496 7.76168 6.30005 7.76168 6.39665 7.76168 6.49231 7.78071 6.58156 7.81768 6.67081 7.85465 6.7519 7.90883 6.82021 7.97714 6.88852 8.04545 6.9427 8.12654 6.97967 8.21579 7.01664 8.30504 7.03566 8.40069 7.03566 8.49729 7.03566 8.5939 7.01664 8.68955 6.97967 8.7788 6.9427 8.86805 6.88852 8.94914 6.82021 9.01745 6.7519 9.08576 6.67081 9.13994 6.58156 9.17691zM9.18678 6.57202C9.22366 6.48274 9.24259 6.38706 9.2425 6.29046 9.2423 6.09536 9.16461 5.90834 9.02652 5.77052 8.88843 5.6327 8.70125 5.55539 8.50615 5.55559 8.31105 5.55578 8.12403 5.63347 7.98621 5.77156 7.84839 5.90965 7.77108 6.09684 7.77127 6.29193 7.77137 6.38853 7.79049 6.48417 7.82755 6.57338 7.86461 6.66259 7.91887 6.74363 7.98725 6.81187 8.05563 6.88011 8.13677 6.93422 8.22606 6.97109 8.31535 7.00797 8.41102 7.0269 8.50762 7.02681 8.60422 7.02671 8.69986 7.00759 8.78907 6.97053 8.87828 6.93347 8.95932 6.87921 9.02756 6.81083 9.0958 6.74246 9.1499 6.66131 9.18678 6.57202zM8.78839 9.17691C8.69914 9.21388 8.60349 9.23291 8.50689 9.2329 8.31179 9.2329 8.12468 9.1554 7.98673 9.01745 7.84878 8.8795 7.77127 8.69239 7.77127 8.49729 7.77127 8.3022 7.84878 8.11509 7.98673 7.97714 8.12468 7.83918 8.31179 7.76168 8.50689 7.76168 8.60349 7.76168 8.69914 7.78071 8.78839 7.81768 8.87764 7.85465 8.95873 7.90883 9.02704 7.97714 9.09535 8.04545 9.14953 8.12654 9.1865 8.21579 9.22347 8.30504 9.2425 8.40069 9.2425 8.49729 9.2425 8.5939 9.22347 8.68955 9.1865 8.7788 9.14953 8.86805 9.09535 8.94914 9.02704 9.01745 8.95873 9.08576 8.87764 9.13994 8.78839 9.17691zM11.3936 6.57202C11.4305 6.48274 11.4494 6.38706 11.4493 6.29046 11.4491 6.09536 11.3714 5.90834 11.2334 5.77052 11.0953 5.6327 10.9081 5.55539 10.713 5.55559 10.5179 5.55578 10.3309 5.63347 10.193 5.77156 10.0552 5.90965 9.97791 6.09684 9.97811 6.29193 9.97821 6.38853 9.99733 6.48417 10.0344 6.57338 10.0714 6.66259 10.1257 6.74363 10.1941 6.81187 10.2625 6.88011 10.3436 6.93422 10.4329 6.97109 10.5222 7.00797 10.6179 7.0269 10.7145 7.02681 10.8111 7.02671 10.9067 7.00759 10.9959 6.97053 11.0851 6.93347 11.1662 6.87921 11.2344 6.81083 11.3026 6.74246 11.3567 6.66131 11.3936 6.57202zM10.9952 9.17691C10.906 9.21388 10.8103 9.23291 10.7137 9.2329 10.5186 9.2329 10.3315 9.1554 10.1936 9.01745 10.0556 8.8795 9.97811 8.69239 9.97811 8.49729 9.97811 8.3022 10.0556 8.11509 10.1936 7.97714 10.3315 7.83918 10.5186 7.76168 10.7137 7.76168 10.8103 7.76168 10.906 7.78071 10.9952 7.81768 11.0845 7.85465 11.1656 7.90883 11.2339 7.97714 11.3022 8.04545 11.3564 8.12654 11.3933 8.21579 11.4303 8.30504 11.4493 8.40069 11.4493 8.49729 11.4493 8.5939 11.4303 8.68955 11.3933 8.7788 11.3564 8.86805 11.3022 8.94914 11.2339 9.01745 11.1656 9.08576 11.0845 9.13994 10.9952 9.17691zM13.6005 6.57202C13.6373 6.48274 13.6563 6.38706 13.6562 6.29046 13.656 6.09536 13.5783 5.90834 13.4402 5.77052 13.3021 5.6327 13.1149 5.55539 12.9198 5.55559 12.7247 5.55578 12.5377 5.63347 12.3999 5.77156 12.2621 5.90965 12.1847 6.09684 12.1849 6.29193 12.185 6.38853 12.2042 6.48417 12.2412 6.57338 12.2783 6.66259 12.3325 6.74363 12.4009 6.81187 12.4693 6.88011 12.5504 6.93422 12.6397 6.97109 12.729 7.00797 12.8247 7.0269 12.9213 7.02681 13.0179 7.02671 13.1135 7.00759 13.2027 6.97053 13.292 6.93347 13.373 6.87921 13.4412 6.81083 13.5095 6.74246 13.5636 6.66131 13.6005 6.57202zM13.2021 9.17691C13.1128 9.21388 13.0172 9.23291 12.9206 9.2329 12.7255 9.2329 12.5384 9.1554 12.4004 9.01745 12.2624 8.8795 12.1849 8.69239 12.1849 8.49729 12.1849 8.3022 12.2624 8.11509 12.4004 7.97714 12.5384 7.83918 12.7255 7.76168 12.9206 7.76168 13.0172 7.76168 13.1128 7.78071 13.2021 7.81768 13.2913 7.85465 13.3724 7.90883 13.4407 7.97714 13.509 8.04545 13.5632 8.12654 13.6002 8.21579 13.6371 8.30504 13.6562 8.40069 13.6562 8.49729 13.6562 8.5939 13.6371 8.68955 13.6002 8.7788 13.5632 8.86805 13.509 8.94914 13.4407 9.01745 13.3724 9.08576 13.2913 9.13994 13.2021 9.17691zM13.4407 11.2243C13.5787 11.0863 13.6562 10.8992 13.6562 10.7041 13.6562 10.509 13.5787 10.3219 13.4407 10.184 13.3028 10.046 13.1156 9.96852 12.9206 9.96852 12.7255 9.96852 12.5384 10.046 12.4004 10.184 12.2624 10.3219 12.1849 10.509 12.1849 10.7041 12.1849 10.8992 12.2624 11.0863 12.4004 11.2243 12.5384 11.3622 12.7255 11.4397 12.9206 11.4397 13.1156 11.4397 13.3028 11.3622 13.4407 11.2243zM5.7799 10.184C5.91785 10.046 6.10496 9.96852 6.30005 9.96852H10.7137C10.9088 9.96852 11.0959 10.046 11.2339 10.184 11.3718 10.3219 11.4493 10.509 11.4493 10.7041 11.4493 10.8992 11.3718 11.0863 11.2339 11.2243 11.0959 11.3622 10.9088 11.4397 10.7137 11.4397H6.30005C6.10496 11.4397 5.91785 11.3622 5.7799 11.2243 5.64194 11.0863 5.56444 10.8992 5.56444 10.7041 5.56444 10.509 5.64194 10.3219 5.7799 10.184z"}},{tag:"path",attrs:{d:"M0.860199 4.99261C0.860199 3.93682 1.71609 3.08093 2.77188 3.08093H14.2419C15.2977 3.08093 16.1536 3.93682 16.1536 4.99261V12.0021C16.1536 13.0579 15.2977 13.9138 14.2419 13.9138H2.77188C1.71609 13.9138 0.860199 13.0579 0.860199 12.0021V4.99261ZM2.77188 4.35538H14.2419C14.5939 4.35538 14.8792 4.64068 14.8792 4.99261V12.0021C14.8792 12.354 14.5939 12.6393 14.2419 12.6393H2.77188C2.41995 12.6393 2.13465 12.354 2.13465 12.0021V4.99261C2.13465 4.64068 2.41995 4.35538 2.77188 4.35538Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},IN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"keyboard-single",ref:e,icon:O_e}))});IN.displayName="KeyboardSingle";const T_e=IN;var $_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1292",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.2 0.05H16.2V16.05H0.2z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1292)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M14.8621 4.04875L14.8621 2.71541C14.8621 1.97903 14.2651 1.38208 13.5287 1.38208L12.1954 1.38208 12.1954 2.71541 13.5287 2.71541 13.5287 4.04875 14.8621 4.04875zM6.86206 1.38208L6.86206 2.71541 9.52873 2.71541 9.52873 1.38208 6.86206 1.38208zM14.8621 6.71541L13.5287 6.71541 13.5287 7.38208 10.8621 7.38208 10.8621 8.71541 13.5287 8.71541 13.5287 9.38208 14.8621 9.38208 14.8621 6.71541zM14.8621 12.0487L13.5287 12.0487 13.5287 13.3821 12.1954 13.3821 12.1954 14.7154 13.5287 14.7154C14.2651 14.7154 14.8621 14.1185 14.8621 13.3821L14.8621 12.0487zM9.52873 14.7154L9.52873 13.3821 8.86206 13.3821 8.86206 10.7154 7.52873 10.7154 7.52873 13.3821 6.86206 13.3821 6.86206 14.7154 9.52873 14.7154zM2.86206 7.38208L5.52873 7.38208 5.52873 8.71541 2.86206 8.71541 2.86206 7.38208zM8.86206 5.38208L8.86206 2.71541 7.52873 2.71541 7.52873 5.38208 8.86206 5.38208z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.86247 1.38208L4.1958 1.38208L4.1958 2.71541L2.86247 2.71541L2.86247 13.3821L4.1958 13.3821L4.1958 14.7154L2.86247 14.7154C2.12609 14.7154 1.52913 14.1185 1.52913 13.3821L1.52913 2.71541C1.52913 1.97903 2.12609 1.38208 2.86247 1.38208Z"}}]}]},xN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"left-border",ref:e,icon:$_e}))});xN.displayName="LeftBorder";const k_e=xN;var A_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_436_29",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.46 0.72H16.46V16.72H0.46z"}}]},{tag:"g",attrs:{mask:"url(#mask0_436_29)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.75537 3.11333L14.8806 8.21036L14.3808 9.30132L4.52076 4.78394L9.03813 14.644L7.94718 15.1438L2.85015 4.01855L2.5419 3.87733L2.66368 3.61154L2.52319 3.30491L2.8788 3.14199L3.04172 2.78638L3.34836 2.92686L3.61415 2.80509L3.75537 3.11333Z"}},{tag:"path",attrs:{fill:"#E5E5E5",d:"M1.80017 12.8102L1.80017 14.1743C1.80017 14.8371 2.33743 15.3743 3.00017 15.3743L4.3643 15.3743L4.3643 14.0443L3.13017 14.0443L3.13017 12.8102L1.80017 12.8102ZM4.3643 2.06128L3.00017 2.06128C2.33743 2.06128 1.80017 2.59854 1.80017 3.26128L1.80017 4.62541L3.13017 4.62541L3.13017 3.39128L4.3643 3.39128L4.3643 2.06128ZM1.80017 10.0819L3.13017 10.0819L3.13017 7.35367L1.80017 7.35367L1.80017 10.0819ZM7.09256 2.06128L7.09256 3.39128L9.82081 3.39128L9.82081 2.06128L7.09256 2.06128ZM12.5491 2.06128L12.5491 3.39128L13.7832 3.39128L13.7832 4.62541L15.1132 4.62541L15.1132 3.26128C15.1132 2.59854 14.5759 2.06128 13.9132 2.06128L12.5491 2.06128ZM15.1132 7.35367L13.7832 7.35367L13.7832 10.0819L15.1132 10.0819L15.1132 7.35367ZM15.1132 12.8102L13.7832 12.8102L13.7832 14.0443L12.5491 14.0443L12.5491 15.3743L13.9132 15.3743C14.5759 15.3743 15.1132 14.8371 15.1132 14.1743L15.1132 12.8102ZM9.82082 15.3743L9.82082 14.0443L7.09256 14.0443L7.09256 15.3743L9.82082 15.3743Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},MN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"left-double-diagonal-single",ref:e,icon:A_e}))});MN.displayName="LeftDoubleDiagonalSingle";const N_e=MN;var L_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1118",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.72 0.72H16.72V16.72H0.72z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1118)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.1571 3.38363C14.1571 2.64725 13.5602 2.05029 12.8238 2.05029H10.1571C9.42072 2.05029 8.82377 2.64725 8.82377 3.38363V14.0503C8.82377 14.7867 9.42072 15.3836 10.1571 15.3836H12.8238C13.5602 15.3836 14.1571 14.7867 14.1571 14.0503V3.38363ZM12.8238 14.0503V3.38363H10.1571V14.0503H12.8238Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M3.29254 8.71657C3.29254 8.34839 3.59101 8.04991 3.95921 8.04991H5.03426V6.97477C5.03426 6.60658 5.33273 6.30811 5.70093 6.30811C6.06911 6.30811 6.36759 6.60658 6.36759 6.97477V8.04991H7.44271C7.8109 8.04991 8.10938 8.34839 8.10938 8.71657C8.10938 9.08477 7.8109 9.38324 7.44271 9.38324H6.36759V10.4583C6.36759 10.8265 6.06911 11.1249 5.70093 11.1249C5.33273 11.1249 5.03426 10.8265 5.03426 10.4583V9.38324H3.95921C3.59101 9.38324 3.29254 9.08477 3.29254 8.71657Z"}}]}]},ON=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"left-insert-column",ref:e,icon:L_e}))});ON.displayName="LeftInsertColumn";const P_e=ON;var B_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_818",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.87 0.33H16.87V16.33H0.87z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_818)"},children:[{tag:"path",attrs:{d:"M2.86716 2.67969C2.50818 2.67969 2.21716 2.9707 2.21716 3.32969 2.21716 3.68867 2.50818 3.97969 2.86716 3.97969H14.8672C15.2261 3.97969 15.5172 3.68867 15.5172 3.32969 15.5172 2.9707 15.2261 2.67969 14.8672 2.67969H2.86716zM2.86716 6.01306C2.50818 6.01306 2.21716 6.30408 2.21716 6.66306 2.21716 7.02205 2.50818 7.31306 2.86716 7.31306H12.2005C12.5595 7.31306 12.8505 7.02205 12.8505 6.66306 12.8505 6.30408 12.5595 6.01306 12.2005 6.01306H2.86716zM2.21716 9.99631C2.21716 9.63733 2.50818 9.34631 2.86716 9.34631H14.8672C15.2261 9.34631 15.5172 9.63733 15.5172 9.99631 15.5172 10.3553 15.2261 10.6463 14.8672 10.6463H2.86716C2.50818 10.6463 2.21716 10.3553 2.21716 9.99631zM2.86716 12.6797C2.50818 12.6797 2.21716 12.9707 2.21716 13.3297 2.21716 13.6887 2.50818 13.9797 2.86716 13.9797H12.2005C12.5595 13.9797 12.8505 13.6887 12.8505 13.3297 12.8505 12.9707 12.5595 12.6797 12.2005 12.6797H2.86716z"}}]}]},TN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"left-justifying-single",ref:e,icon:B_e}))});TN.displayName="LeftJustifyingSingle";const F_e=TN;var U_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_802",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.87 0.56H16.87V16.56H0.87z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_802)"},children:[{tag:"path",attrs:{d:"M3.4347 2.42425C3.17633 2.33484 2.88069 2.40752 2.67794 2.61027C2.47518 2.81303 2.40251 3.10867 2.49191 3.36703L5.23584 11.2964C5.36212 11.6613 5.7668 11.8374 6.13971 11.6896C6.51262 11.5418 6.71255 11.1262 6.58627 10.7613L5.81836 8.54215L8.60982 5.7507L10.8289 6.51861C11.1939 6.64489 11.6095 6.44496 11.7573 6.07204C11.905 5.69913 11.729 5.29446 11.3641 5.16818L3.4347 2.42425ZM7.1561 5.24764L5.31531 7.08844L4.34123 4.27356L7.1561 5.24764Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M5.55071 13.9686C5.26432 14.255 5.25118 14.7061 5.52136 14.9763C5.79153 15.2465 6.24271 15.2333 6.52909 14.947L13.7625 7.71356L13.7326 8.74162C13.7211 9.13516 14.0308 9.4449 14.4244 9.43344C14.8179 9.42198 15.1462 9.09366 15.1577 8.70011L15.2378 5.95173C15.2462 5.66352 15.0801 5.40875 14.817 5.30621C14.554 5.20367 14.2457 5.27356 14.036 5.48329L5.55071 13.9686Z"}}]}]},$N=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"left-rotation-forty-five-degrees-single",ref:e,icon:U_e}))});$N.displayName="LeftRotationFortyFiveDegreesSingle";const H_e=$N;var V_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.53613 8.20612C1.53613 7.95197 1.68426 7.72113 1.91531 7.61523L5.91531 5.7819 5.91531 5.7819 7.24864 5.1708 7.24864 5.1708 9.9153 3.94857C10.2416 3.79899 10.6274 3.94229 10.777 4.26863 10.9266 4.59497 10.7833 4.98077 10.457 5.13035L8.16947 6.17879 8.16947 10.2335 10.457 11.2819C10.7833 11.4315 10.9266 11.8173 10.777 12.1436 10.6274 12.47 10.2416 12.6133 9.91531 12.4637L7.24864 11.2415 7.24864 11.2414 5.91531 10.6304 5.91531 10.6303 1.91531 8.79702C1.68426 8.69112 1.53613 8.46028 1.53613 8.20612zM6.86947 9.63763L6.86947 6.77462 6.45696 6.96368 6.45695 6.96368 3.74618 8.20612 6.45695 9.44856 6.45696 9.44857 6.86947 9.63763zM12.8526 14.856C12.4937 14.856 12.2026 14.5649 12.2026 14.206L12.2026 2.20596C12.2026 1.94306 12.361 1.70604 12.6039 1.60544 12.8468 1.50483 13.1264 1.56044 13.3123 1.74634L15.3123 3.74634C15.5661 4.00018 15.5661 4.41174 15.3123 4.66558 15.0584 4.91942 14.6469 4.91942 14.393 4.66558L13.5026 3.7752 13.5026 14.206C13.5026 14.5649 13.2116 14.856 12.8526 14.856z",fillRule:"evenodd",clipRule:"evenodd"}}]},kN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"left-rotation-ninety-degrees-single",ref:e,icon:V_e}))});kN.displayName="LeftRotationNinetyDegreesSingle";const j_e=kN;var z_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_436_43",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.33 0.72H16.33V16.72H0.33z"}}]},{tag:"g",attrs:{mask:"url(#mask0_436_43)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.33875 3.57255L2.23657 3.79614L2.72883 4.0211L7.58275 14.6428L8.67419 14.144L5.10931 6.34311L13.5649 14.7987L14.4134 13.9502L5.96172 5.49847L13.7573 9.0609L14.2561 7.96947L3.63438 3.11555L3.40942 2.62329L3.18782 2.72456L3.09973 2.63647L2.93861 2.7976L2.73534 2.70471L2.60444 2.99116L2.31799 3.12206L2.41088 3.32533L2.2512 3.485L2.33875 3.57255Z"}},{tag:"path",attrs:{fill:"#E5E5E5",d:"M1.6759 12.8102L1.6759 14.1743C1.6759 14.8371 2.21316 15.3743 2.8759 15.3743L4.24003 15.3743L4.24003 14.0443L3.0059 14.0443L3.0059 12.8102L1.6759 12.8102ZM4.24003 2.06128L2.8759 2.06128C2.21316 2.06128 1.6759 2.59854 1.6759 3.26128L1.6759 4.62541L3.0059 4.62541L3.0059 3.39128L4.24003 3.39128L4.24003 2.06128ZM1.6759 10.0819L3.0059 10.0819L3.0059 7.35367L1.6759 7.35367L1.6759 10.0819ZM6.96829 2.06128L6.96829 3.39128L9.69655 3.39128L9.69655 2.06128L6.96829 2.06128ZM12.4248 2.06128L12.4248 3.39128L13.6589 3.39128L13.6589 4.62541L14.9889 4.62541L14.9889 3.26128C14.9889 2.59854 14.4517 2.06128 13.7889 2.06128L12.4248 2.06128ZM14.9889 7.35367L13.6589 7.35367L13.6589 10.0819L14.9889 10.0819L14.9889 7.35367ZM14.9889 12.8102L13.6589 12.8102L13.6589 14.0443L12.4248 14.0443L12.4248 15.3743L13.7889 15.3743C14.4517 15.3743 14.9889 14.8371 14.9889 14.1743L14.9889 12.8102ZM9.69655 15.3743L9.69655 14.0443L6.96829 14.0443L6.96829 15.3743L9.69655 15.3743Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},AN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"left-tridiagonal-single",ref:e,icon:z_e}))});AN.displayName="LeftTridiagonalSingle";const W_e=AN;var X_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.3469 11.8562C11.9308 11.8562 11.6453 11.4371 11.7977 11.0499L12.47 9.34117C12.6248 8.94753 12.6232 8.50955 12.4654 8.11708L11.8926 6.69241C11.7292 6.28603 12.0284 5.84326 12.4664 5.84326 12.7277 5.84326 12.9608 6.00748 13.0487 6.25353L13.2345 6.77321C13.3389 7.10607 13.4502 7.44917 13.5616 7.78235 13.5648 7.79186 13.5737 7.79827 13.5837 7.79827 13.5946 7.79827 13.604 7.79077 13.6065 7.78018 13.6836 7.44768 13.7806 7.10535 13.864 6.77321L13.9952 6.28043C14.0638 6.02266 14.2972 5.84326 14.5639 5.84326 14.9748 5.84326 15.2592 6.25356 15.1151 6.63831L14.485 8.32021C14.336 8.71794 14.345 9.15763 14.5101 9.54894L15.1222 10.9996C15.2938 11.4062 14.9952 11.8562 14.5539 11.8562 14.2999 11.8562 14.0719 11.7006 13.9794 11.464L13.765 10.9157C13.6467 10.5726 13.5283 10.2192 13.4033 9.89588 13.3996 9.88635 13.3904 9.88009 13.3802 9.88009 13.3693 9.88009 13.3597 9.88723 13.3565 9.89769 13.2592 10.2202 13.162 10.5628 13.0648 10.9157L12.9133 11.4321C12.8396 11.6835 12.6089 11.8562 12.3469 11.8562zM8.60589 12.0042C7.86324 12.0042 7.41058 11.1799 7.41058 10.176 7.41058 9.24556 7.76849 8.62802 8.57927 8.26493 9.15457 8.0073 9.66769 7.19591 9.03734 7.19591 8.93902 7.19591 8.83936 7.21406 8.73668 7.24911 8.32638 7.38918 7.82912 7.28905 7.6842 6.88044 7.59996 6.64293 7.66457 6.37396 7.86703 6.2239 8.30584 5.89865 8.77368 5.69531 9.27781 5.69531 10.3175 5.69531 10.9046 6.56186 10.9046 8.44289V11.3045C10.9046 11.6092 10.6576 11.8562 10.3529 11.8562H10.1837C10.0084 11.8562 9.85947 11.7283 9.83303 11.555L9.78975 11.2715C9.7882 11.2614 9.77946 11.2539 9.76918 11.2539 9.76262 11.2539 9.75643 11.257 9.75249 11.2622 9.42162 11.7016 9.04868 12.0042 8.60589 12.0042zM9.03734 10.5458C9.24498 10.5458 9.39618 10.4264 9.54464 10.2218 9.61454 10.1255 9.6456 10.0072 9.6456 9.88822 9.6456 9.4852 9.24918 9.151 8.92488 9.39028 8.69363 9.56091 8.60589 9.77991 8.60589 10.028 8.60589 10.3768 8.77564 10.5458 9.03734 10.5458zM2.04947 11.8562C1.73697 11.8562 1.48364 11.6029 1.48364 11.2904V4.75915C1.48364 4.33651 1.82626 3.9939 2.2489 3.9939 2.60112 3.9939 2.90785 4.23431 2.992 4.57633L3.6833 7.3861C3.78812 7.83507 3.87223 8.32531 3.96973 8.80585 3.9718 8.816 3.98073 8.82329 3.99109 8.82329 4.00134 8.82329 4.0102 8.81616 4.01238 8.80614 4.11674 8.32551 4.20078 7.83516 4.29863 7.3861L4.96488 4.58313C5.04698 4.23772 5.35555 3.9939 5.71058 3.9939 6.1339 3.9939 6.47707 4.33706 6.47707 4.76038V11.2798C6.47707 11.5981 6.21899 11.8562 5.90063 11.8562 5.58227 11.8562 5.32419 11.5981 5.32419 11.2798V9.16145C5.32419 8.38487 5.42185 7.22268 5.48554 6.4511 5.48626 6.44233 5.47932 6.43501 5.47052 6.43501 5.46353 6.43501 5.45745 6.43983 5.45587 6.44665L5.02006 8.31605 4.39568 10.8535C4.347 11.0514 4.16955 11.1904 3.96579 11.1904 3.76242 11.1904 3.5852 11.0519 3.53615 10.8545L2.90528 8.31605 2.48355 6.44672C2.48201 6.43987 2.47593 6.43501 2.46892 6.43501 2.46014 6.43501 2.45322 6.44231 2.45395 6.45105 2.51764 7.22263 2.6153 8.38485 2.6153 9.16145V11.2904C2.6153 11.6029 2.36197 11.8562 2.04947 11.8562z"}}]},NN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"max-single",ref:e,icon:X_e}))});NN.displayName="MaxSingle";const Y_e=NN;var G_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_677",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.21 0.06H16.21V16.06H0.21z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_677)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6.00227 2.94522C6.00227 2.83901 5.91875 2.75291 5.81573 2.75291H3.47254C3.36952 2.75291 3.28601 2.83901 3.28601 2.94522L3.28602 7.18717C3.28602 7.29338 3.36954 7.37948 3.47256 7.37948H5.07496C5.1411 7.37948 5.2023 7.34337 5.2358 7.28458C5.2693 7.22579 5.2701 7.1531 5.23789 7.09354C5.10099 6.84035 5.13719 6.51463 5.34559 6.29978C5.5975 6.04006 6.00594 6.04006 6.25787 6.29976L7.49412 7.5742C7.61511 7.69892 7.68307 7.86807 7.68307 8.04445C7.68308 8.22083 7.61511 8.38999 7.49413 8.51471L6.25788 9.7892C6.00596 10.0489 5.59752 10.0489 5.3456 9.7892C5.1372 9.57436 5.10099 9.24866 5.23787 8.99547C5.27007 8.93591 5.26927 8.86323 5.23577 8.80444C5.20226 8.74565 5.14107 8.70954 5.07493 8.70954H3.47256C3.36954 8.70954 3.28602 8.79564 3.28602 8.90185L3.28602 13.1752C3.28602 13.2814 3.36954 13.3675 3.47256 13.3675H5.81574C5.91876 13.3675 6.00228 13.2814 6.00228 13.1752L6.00228 11.1192C6.00228 10.752 6.29109 10.4542 6.64736 10.4542C7.00363 10.4542 7.29244 10.752 7.29244 11.1192L7.29244 13.6038C7.29244 14.2079 6.81746 14.6975 6.23155 14.6975H3.05675C2.47084 14.6975 1.99586 14.2079 1.99586 13.6038L1.99585 2.51655C1.99585 1.91252 2.47082 1.42285 3.05674 1.42285H6.23154C6.81745 1.42285 7.29242 1.91252 7.29242 2.51655L7.29244 4.78618C7.29244 5.15346 7.00363 5.45121 6.64736 5.45121C6.29109 5.45121 6.00228 5.15346 6.00228 4.78618L6.00227 2.94522ZM10.4147 13.1752C10.4147 13.2814 10.4983 13.3675 10.6013 13.3675H12.9445C12.9939 13.3675 13.0414 13.3472 13.0764 13.3111C13.1114 13.2751 13.131 13.2262 13.131 13.1752L13.131 8.90184C13.131 8.79563 13.0475 8.70954 12.9445 8.70954H11.3421C11.2759 8.70954 11.2147 8.74564 11.1812 8.80444C11.1477 8.86323 11.1469 8.93592 11.1791 8.99548C11.316 9.24867 11.2798 9.57438 11.0714 9.78924C10.8195 10.049 10.4111 10.049 10.1592 9.78926L8.9229 8.51482C8.80192 8.3901 8.73395 8.22095 8.73395 8.04457C8.73395 7.86819 8.80191 7.69903 8.92289 7.57431L10.1592 6.29982C10.4111 6.04011 10.8195 6.04011 11.0714 6.29982C11.2798 6.51466 11.316 6.84036 11.1792 7.09355C11.147 7.15311 11.1478 7.22579 11.1813 7.28458C11.2148 7.34337 11.276 7.37948 11.3421 7.37948H12.9445C13.0475 7.37948 13.131 7.29338 13.131 7.18717L13.131 2.94524C13.131 2.89423 13.1113 2.84532 13.0763 2.80925C13.0414 2.77319 12.9939 2.75293 12.9444 2.75293L10.6013 2.75293C10.4982 2.75293 10.4147 2.83903 10.4147 2.94524L10.4147 4.96977C10.4147 5.33706 10.1259 5.6348 9.76966 5.6348C9.4134 5.6348 9.12458 5.33706 9.12458 4.96977L9.12457 2.51657C9.12457 1.91253 9.59954 1.42287 10.1855 1.42287L13.3603 1.42287C13.9462 1.42287 14.4211 1.91253 14.4211 2.51657L14.4212 13.6038C14.4212 14.2079 13.9462 14.6975 13.3603 14.6975H10.1855C9.59956 14.6975 9.12458 14.2079 9.12458 13.6038L9.12458 11.3028C9.12458 10.9356 9.4134 10.6378 9.76966 10.6378C10.1259 10.6378 10.4147 10.9356 10.4147 11.3028L10.4147 13.1752Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},LN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"merge-all-single",ref:e,icon:G_e}))});LN.displayName="MergeAllSingle";const K_e=LN;var Z_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.0438 12.2901C11.6423 12.2901 11.3168 11.9646 11.3168 11.563V6.91165C11.3168 6.56119 11.6009 6.2771 11.9514 6.2771H12.1296C12.3461 6.2771 12.5291 6.43759 12.5573 6.65225L12.6038 7.00638C12.6054 7.01841 12.6156 7.0274 12.6278 7.0274 12.6351 7.0274 12.6421 7.02403 12.6467 7.01827 13.0315 6.53614 13.506 6.12915 14.1346 6.12915 15.1532 6.12915 15.5886 7.06967 15.5886 8.57027V11.5589C15.5886 11.9627 15.2613 12.2901 14.8575 12.2901 14.4537 12.2901 14.1264 11.9627 14.1264 11.5589V8.80275C14.1264 7.97848 13.9538 7.73543 13.5842 7.73543 12.9291 7.73543 12.7709 8.63264 12.7709 9.28775V11.563C12.7709 11.9646 12.4454 12.2901 12.0438 12.2901zM9.40478 12.29C9.00325 12.29 8.67775 11.9645 8.67775 11.563V7.0041C8.67775 6.60257 9.00325 6.27706 9.40478 6.27706 9.80631 6.27706 10.1318 6.60257 10.1318 7.0041V11.563C10.1318 11.9645 9.80631 12.29 9.40478 12.29zM9.40889 5.301C8.91599 5.301 8.57095 5.04065 8.57095 4.48057 8.57095 3.90992 8.91599 3.70801 9.40889 3.70801 9.89358 3.70801 10.2386 3.90992 10.2386 4.48057 10.2386 5.04065 9.89358 5.301 9.40889 5.301zM2.24583 12.29C1.88286 12.29 1.58862 11.9958 1.58862 11.6328V5.33154C1.58862 4.83238 1.99327 4.42773 2.49243 4.42773 2.89594 4.42773 3.25057 4.69522 3.36144 5.0832L4.14351 7.81994C4.26503 8.26807 4.36259 8.75731 4.47557 9.23698 4.47835 9.24879 4.4889 9.25713 4.50103 9.25713 4.51301 9.25713 4.52346 9.249 4.52639 9.23738 4.6473 8.75758 4.74476 8.26819 4.85822 7.81994L5.61141 5.09177C5.71972 4.69946 6.07663 4.42773 6.48362 4.42773 6.98335 4.42773 7.38846 4.83285 7.38846 5.33257V11.6205C7.38846 11.9903 7.0887 12.29 6.71893 12.29 6.34916 12.29 6.0494 11.9903 6.0494 11.6205V9.59529C6.0494 8.81971 6.16253 7.65951 6.23652 6.88792 6.23751 6.87758 6.22936 6.86885 6.21897 6.86885 6.21101 6.86885 6.20404 6.87418 6.20197 6.88186L5.69615 8.74988 4.98542 11.2367C4.91985 11.4661 4.71016 11.6243 4.47156 11.6243 4.23348 11.6243 4.02411 11.4668 3.95809 11.2381L3.23985 8.74988 2.75038 6.88195C2.74836 6.87423 2.74138 6.86885 2.7334 6.86885 2.72305 6.86885 2.71492 6.87755 2.71591 6.88786 2.7899 7.65944 2.90303 8.81968 2.90303 9.59529V11.6328C2.90303 11.9958 2.60879 12.29 2.24583 12.29z"}}]},PN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"min-single",ref:e,icon:Z_e}))});PN.displayName="MinSingle";const q_e=PN;var Q_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_556",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.56 0.77H16.56V16.77H0.56z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_556)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.19318 4.76988C1.70089 4.26222 2.524 4.26226 3.03166 4.76997L8.13929 9.87808C8.3736 10.1124 8.75352 10.1124 8.98784 9.8781L14.0959 4.77C14.6036 4.26232 15.4267 4.26232 15.9344 4.77C16.4421 5.27768 16.4421 6.1008 15.9344 6.60848L9.97775 12.5651C9.19667 13.3462 7.93029 13.3462 7.14925 12.5651L1.1931 6.60836C0.685438 6.10065 0.685477 5.27753 1.19318 4.76988Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},BN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"more-down-single",ref:e,icon:Q_e}))});BN.displayName="MoreDownSingle";const TR=BN;var J_e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.86658 4.09473C9.41886 4.09473 9.86658 3.64701 9.86658 3.09473 9.86658 2.54244 9.41886 2.09473 8.86658 2.09473 8.31429 2.09473 7.86658 2.54244 7.86658 3.09473 7.86658 3.64701 8.31429 4.09473 8.86658 4.09473zM8.86658 9.79407C9.41886 9.79407 9.86658 9.34635 9.86658 8.79407 9.86658 8.24178 9.41886 7.79407 8.86658 7.79407 8.31429 7.79407 7.86658 8.24178 7.86658 8.79407 7.86658 9.34635 8.31429 9.79407 8.86658 9.79407zM9.86658 14.4934C9.86658 15.0457 9.41886 15.4934 8.86658 15.4934 8.31429 15.4934 7.86658 15.0457 7.86658 14.4934 7.86658 13.9411 8.31429 13.4934 8.86658 13.4934 9.41886 13.4934 9.86658 13.9411 9.86658 14.4934z"}}]},FN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"more-function-single",ref:e,icon:J_e}))});FN.displayName="MoreFunctionSingle";const ebe=FN;var tbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.52628 3.57095C5.81918 3.26411 6.29405 3.26411 6.58695 3.57095L11.0869 8.28525C11.3798 8.59209 11.3798 9.08958 11.0869 9.39642L6.51623 14.04C6.22334 14.3468 5.74846 14.3468 5.45557 14.04C5.16268 13.7331 5.16268 13.2357 5.45557 12.9288L9.35939 8.979C9.43544 8.90205 9.43652 8.77857 9.36182 8.70031L5.52628 4.68212C5.23339 4.37528 5.23339 3.87779 5.52628 3.57095Z",fillRule:"evenodd",clipRule:"evenodd"}}]},UN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"more-single",ref:e,icon:tbe}))});UN.displayName="MoreSingle";const $R=UN;var nbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_727",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.88 0.24H16.88V16.24H0.88z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_727)"},children:[{tag:"path",attrs:{d:"M2.2157 12.236V13.5693C2.2157 14.3057 2.81265 14.9027 3.54903 14.9027H4.88237V13.5693H3.54903L3.54903 12.236H2.2157zM4.88236 1.56934H3.54903C2.81265 1.56934 2.2157 2.16629 2.2157 2.90267V4.236H3.54903V2.90267L4.88236 2.90267V1.56934zM2.2157 9.56934H3.54903V6.90267H2.2157V9.56934zM7.54903 1.56934V2.90267H8.2157V5.56934H9.54903V2.90267H10.2157V1.56934H7.54903zM12.8824 1.56934V2.90267H14.2157V4.236H15.549V2.90267C15.549 2.16629 14.9521 1.56934 14.2157 1.56934H12.8824zM15.549 6.90267H14.2157V7.56934H11.549V8.90267H14.2157V9.56934H15.549V6.90267zM15.549 12.236H14.2157V13.5693H12.8824V14.9027H14.2157C14.9521 14.9027 15.549 14.3057 15.549 13.5693V12.236zM10.2157 14.9027V13.5693H9.54903V10.9027H8.2157V13.5693H7.54903V14.9027H10.2157zM6.2157 7.56934H3.54903V8.90267H6.2157V7.56934z"}}]}]},HN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"no-border-single",ref:e,icon:nbe}))});HN.displayName="NoBorderSingle";const rbe=HN;var ibe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.2764 2.95793H3.94641C3.57638 2.95793 3.27641 3.2579 3.27641 3.62793V12.9579C3.27641 13.328 3.57638 13.6279 3.94641 13.6279H13.2764C13.6464 13.6279 13.9464 13.328 13.9464 12.9579V3.62793C13.9464 3.2579 13.6464 2.95793 13.2764 2.95793ZM3.94641 1.62793C2.84184 1.62793 1.94641 2.52336 1.94641 3.62793V12.9579C1.94641 14.0625 2.84184 14.9579 3.94641 14.9579H13.2764C14.381 14.9579 15.2764 14.0625 15.2764 12.9579V3.62793C15.2764 2.52336 14.381 1.62793 13.2764 1.62793H3.94641Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.8673 14.4893L2.26086 2.88281L3.20132 1.94236L14.8078 13.5488L13.8673 14.4893Z",fillRule:"evenodd",clipRule:"evenodd"}}]},VN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"no-color",ref:e,icon:ibe}))});VN.displayName="NoColor";const obe=VN;var sbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_837",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.04 0.56H16.04V16.56H0.04z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_837)"},children:[{tag:"path",attrs:{d:"M8.65606 2.36855C8.54565 2.1413 8.30498 1.99561 8.04 1.99561C7.77503 1.99561 7.53436 2.1413 7.42395 2.36855L4.03557 9.34293C3.87962 9.66391 4.02902 10.0434 4.36926 10.1905C4.70949 10.3376 5.11173 10.1967 5.26767 9.87568L6.21595 7.92383H9.86406L10.8123 9.87568C10.9683 10.1967 11.3705 10.3376 11.7108 10.1905C12.051 10.0434 12.2004 9.66391 12.0444 9.34293L8.65606 2.36855ZM9.24286 6.64519H6.83715L8.04 4.16933L9.24286 6.64519Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M2.39521 12.0948C2.02094 12.0948 1.71753 12.381 1.71753 12.7341C1.71753 13.0872 2.02094 13.3734 2.39521 13.3734H12.0484L11.3571 14.0256C11.0924 14.2753 11.0924 14.6801 11.3571 14.9298C11.6217 15.1794 12.0508 15.1794 12.3155 14.9298L14.1637 13.1862C14.3575 13.0033 14.4155 12.7283 14.3106 12.4894C14.2057 12.2505 13.9586 12.0948 13.6845 12.0948H2.39521Z"}}]}]},jN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"no-rotation-single",ref:e,icon:sbe}))});jN.displayName="NoRotationSingle";const abe=jN;var lbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.28459 3.18012V4.26015C3.28459 4.40773 3.16496 4.52736 3.01738 4.52736 2.75841 4.52736 2.55017 4.74017 2.55017 4.99725 2.55017 5.25732 2.76082 5.47259 3.02278 5.47259H4.55643C4.81745 5.47259 5.02904 5.26099 5.02904 4.99997V4.93517C5.02904 4.70994 4.84646 4.52736 4.62123 4.52736 4.50646 4.52736 4.41342 4.43432 4.41342 4.31955V2.47989C4.41342 2.13139 4.13091 1.84888 3.78241 1.84888 3.66544 1.84888 3.55411 1.88249 3.45611 1.93512 3.37143 1.9806 3.28531 2.02063 3.19774 2.05525 3.12772 2.081 3.04906 2.10554 2.96155 2.12879 2.77664 2.17791 2.63657 2.34227 2.63657 2.54104 2.63657 2.77028 2.8224 2.95611 3.05164 2.95611H3.15566C3.21218 2.95611 3.23559 2.97573 3.25128 3.00211 3.27225 3.03738 3.28459 3.09641 3.28459 3.18012zM3.20701 8.77922C3.0239 8.95928 2.82054 9.15308 2.59807 9.35948 2.50243 9.44821 2.44751 9.57281 2.44751 9.70373 2.44751 9.9621 2.65696 10.1715 2.91532 10.1715H4.64278C4.91274 10.1715 5.13159 9.95269 5.13159 9.68273 5.13159 9.41277 4.91274 9.19392 4.64278 9.19392H4.45917C4.37922 9.19392 4.28216 9.19961 4.16873 9.21058 4.15975 9.21145 4.15167 9.21201 4.14442 9.21231 4.14995 9.20501 4.15586 9.19798 4.16168 9.19161 4.24919 9.09578 4.33608 8.99651 4.42234 8.89382 4.57749 8.70543 4.70635 8.51166 4.80715 8.31394 4.91399 8.11148 4.96958 7.90857 4.96958 7.70627 4.96958 7.46422 4.91564 7.24798 4.80429 7.06107 4.69392 6.8758 4.54149 6.73323 4.34873 6.63473 4.15598 6.53261 3.93627 6.48303 3.69235 6.48303 3.42896 6.48303 3.19712 6.53 3.00033 6.62823 2.89779 6.67752 2.79655 6.74189 2.69655 6.8206 2.48959 6.9835 2.5076 7.27856 2.67839 7.44935L2.6891 7.46006C2.87027 7.64123 3.12467 7.59677 3.30003 7.47051L3.30211 7.46897C3.36455 7.42151 3.45534 7.40666 3.56274 7.40666 3.66732 7.40666 3.74091 7.43724 3.79444 7.49077L3.79788 7.49405C3.84835 7.53993 3.88396 7.62084 3.88396 7.76027 3.88396 7.88759 3.83202 8.03515 3.71303 8.20514 3.59179 8.37834 3.42366 8.56967 3.20701 8.77922zM2.9214 14.7332C3.1415 14.8259 3.39645 14.8706 3.68383 14.8706 3.93219 14.8706 4.16382 14.8311 4.37776 14.7509L4.37921 14.7503C4.59447 14.6657 4.77112 14.5431 4.90564 14.3808L4.90639 14.3799C5.04481 14.2089 5.11227 14.0024 5.11227 13.7662 5.11227 13.5302 5.04483 13.3286 4.90319 13.1703 4.81044 13.0666 4.69956 12.9841 4.57171 12.9224 4.68529 12.8522 4.77864 12.7696 4.84941 12.6735 4.95333 12.5323 5.00427 12.3677 5.00427 12.1839 5.00427 11.8465 4.87877 11.5774 4.62375 11.3909 4.37806 11.2049 4.05412 11.1173 3.66223 11.1173 3.44058 11.1173 3.23098 11.1594 3.03444 11.2441 2.9524 11.2786 2.87168 11.3193 2.79227 11.3663 2.55772 11.5049 2.54558 11.8119 2.70332 12.0027 2.87014 12.2044 3.15197 12.2063 3.3566 12.1002 3.43523 12.0611 3.52216 12.0409 3.61903 12.0409 3.72536 12.0409 3.78644 12.0646 3.82032 12.0944 3.85174 12.122 3.87544 12.1688 3.87544 12.2541 3.87544 12.3372 3.84185 12.4026 3.76308 12.4573 3.72179 12.484 3.65044 12.5088 3.5393 12.5246 3.32312 12.5554 3.13021 12.7285 3.13021 12.967 3.13021 13.2041 3.32183 13.3826 3.54459 13.4034 3.62771 13.4112 3.69368 13.4224 3.74392 13.4361 3.85799 13.4663 3.91391 13.505 3.93694 13.5377 3.96648 13.5795 3.98344 13.6324 3.98344 13.7014 3.98344 13.7755 3.95581 13.8234 3.89699 13.8586 3.82792 13.9001 3.72724 13.9254 3.58662 13.9254 3.48091 13.9254 3.37347 13.9007 3.2635 13.8492 3.04114 13.7355 2.72835 13.7469 2.5624 13.9767L2.55507 13.9869C2.43083 14.1589 2.42461 14.4222 2.6215 14.5648 2.71195 14.6302 2.81243 14.6865 2.9214 14.7332zM7.08183 2.99402C6.71364 2.99402 6.41516 3.2925 6.41516 3.66069 6.41516 4.02888 6.71364 4.32735 7.08183 4.32735H14.4152C14.7834 4.32735 15.0818 4.02888 15.0818 3.66069 15.0818 3.2925 14.7834 2.99402 14.4152 2.99402H7.08183zM6.41516 8.32731C6.41516 7.95912 6.71364 7.66064 7.08183 7.66064H14.4152C14.7834 7.66064 15.0818 7.95912 15.0818 8.32731 15.0818 8.6955 14.7834 8.99398 14.4152 8.99398H7.08183C6.71364 8.99398 6.41516 8.6955 6.41516 8.32731zM7.08183 12.3273C6.71364 12.3273 6.41516 12.6257 6.41516 12.9939 6.41516 13.3621 6.71364 13.6606 7.08183 13.6606H14.4152C14.7834 13.6606 15.0818 13.3621 15.0818 12.9939 15.0818 12.6257 14.7834 12.3273 14.4152 12.3273H7.08183z"}}]},zN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"order-single",ref:e,icon:lbe}))});zN.displayName="OrderSingle";const ube=zN;var cbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1302",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.2 0.05H16.2V16.05H0.2z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1302)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.5288 2.71541H2.86214V13.3821H13.5288V2.71541ZM2.86214 1.38208C2.12576 1.38208 1.52881 1.97903 1.52881 2.71541V13.3821C1.52881 14.1185 2.12576 14.7154 2.86214 14.7154H13.5288C14.2652 14.7154 14.8621 14.1185 14.8621 13.3821V2.71541C14.8621 1.97903 14.2652 1.38208 13.5288 1.38208H2.86214Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.52873 2.71655V5.38322H8.86206V2.71655H7.52873zM7.52873 10.7166V13.3832H8.86206V10.7166H7.52873zM13.5287 7.38322H10.8621V8.71655H13.5287V7.38322zM5.52873 7.38322H2.86206V8.71655H5.52873V7.38322z"}}]}]},WN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"outer-border",ref:e,icon:cbe}))});WN.displayName="OuterBorder";const dbe=WN;var hbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_793",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.45 0.21H16.45V16.21H0.45z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_793)"},children:[{tag:"path",attrs:{d:"M5.36939 7.53377C4.97066 7.53377 4.64743 7.82763 4.64743 8.19014 4.64743 8.55264 4.97066 8.84651 5.36939 8.84651H12.4453L11.9989 9.25724C11.7186 9.5151 11.7214 9.93069 12.005 10.1855 12.2886 10.4403 12.7457 10.4378 13.026 10.1799L14.6789 8.65907C14.9584 8.40189 14.9565 7.98763 14.6747 7.73256L13.0218 6.23656C12.7392 5.98081 12.2821 5.98174 12.0008 6.23865 11.7195 6.49555 11.7205 6.91115 12.0031 7.1669L12.4084 7.53377H5.36939zM9.26102 2.14212C9.26102 1.80906 8.96405 1.53906 8.59771 1.53906 8.23137 1.53906 7.9344 1.80906 7.9344 2.14212V6.02894C7.9344 6.362 8.23137 6.632 8.59771 6.632 8.96405 6.632 9.26102 6.362 9.26102 6.02894V2.14212zM9.26102 10.3911C9.26102 10.0581 8.96405 9.78809 8.59771 9.78809 8.23137 9.78809 7.9344 10.0581 7.9344 10.3911V14.278C7.9344 14.611 8.23137 14.881 8.59771 14.881 8.96405 14.881 9.26102 14.611 9.26102 14.278V10.3911zM2.6718 3.43622C3.03814 3.43622 3.33511 3.70622 3.33511 4.03928V12.3807C3.33511 12.7138 3.03814 12.9838 2.6718 12.9838 2.30546 12.9838 2.00848 12.7138 2.00848 12.3807V4.03928C2.00848 3.70622 2.30546 3.43622 2.6718 3.43622z"}}]}]},XN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"overflow-single",ref:e,icon:hbe}))});XN.displayName="OverflowSingle";const fbe=XN;var mbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1204",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.25 0.41H16.25V16.41H0.25z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1204)"},children:[{tag:"rect",attrs:{width:12.62,height:2.79,x:1.94,y:12.66,fill:"colorChannel1",rx:1.4}},{tag:"path",attrs:{fill:"currentColor",d:"M7.99664 2.57069C7.59302 2.05771 7.10966 1.68854 6.63466 1.50243C6.11882 1.30028 5.40184 1.25862 4.95066 1.83566C4.5486 2.34994 4.581 3.10899 4.82709 3.91045C4.93826 4.27259 5.11865 4.62903 5.37541 4.97266C5.38713 4.98834 5.39945 5.00329 5.41229 5.01752C5.4217 5.02789 5.4314 5.03788 5.44133 5.04746C5.45477 5.06043 5.46874 5.07267 5.48315 5.08419L3.75659 6.81071C3.51774 7.04955 3.51774 7.43683 3.75659 7.67569L7.48775 11.4068C7.72666 11.6457 8.11394 11.6457 8.35278 11.4068L13.0831 6.67651C13.3219 6.43766 13.3219 6.05039 13.0831 5.81155L9.35191 2.08037C9.11306 1.84153 8.72579 1.84153 8.48695 2.08037L7.99664 2.57069ZM7.71181 4.91288C7.72271 4.98224 7.73182 5.05302 7.73898 5.12518C7.77251 5.46131 8.07213 5.70663 8.40825 5.6731C8.74438 5.6396 8.98972 5.33994 8.9562 5.00382C8.90804 4.52113 8.79269 4.0731 8.6291 3.66819L8.91946 3.37784L11.7856 6.24403L10.8608 7.16886H5.12843L7.6582 4.63909C7.67903 4.72777 7.69702 4.81905 7.71181 4.91288ZM7.12302 3.44433C6.8246 3.02658 6.47279 2.75283 6.18833 2.64136C6.05252 2.58814 5.96546 2.58477 5.92656 2.58984C5.92268 2.59037 5.91947 2.59093 5.91678 2.59147L5.91208 2.59257C5.89185 2.62604 5.78612 2.86628 5.99645 3.5514C6.0626 3.76685 6.1728 3.99252 6.34325 4.2241L7.12302 3.44433Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.4434 11.9528C12.8956 11.9528 13.2622 11.5862 13.2622 11.134C13.2622 10.854 12.9483 10.3347 12.7092 9.9798C12.5801 9.78823 12.3066 9.78823 12.1776 9.97981C11.9385 10.3347 11.6246 10.854 11.6246 11.134C11.6246 11.5862 11.9912 11.9528 12.4434 11.9528Z"}}]}]},YN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"paint-bucket",ref:e,icon:mbe}))});YN.displayName="PaintBucket";const pbe=YN;var gbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1138",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.61 0.72H16.61V16.72H0.61z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1138)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M8.35898 9.84143C8.35898 10.177 8.63099 10.449 8.96654 10.449H12.1054C12.4409 10.449 12.7129 10.177 12.7129 9.84143V9.84143C12.7129 9.50589 12.4409 9.23387 12.1054 9.23387H8.96654C8.63099 9.23387 8.35898 9.50589 8.35898 9.84143V9.84143zM11.4756 11.5691C11.4756 11.9047 11.2036 12.1767 10.8681 12.1767H8.96654C8.63099 12.1767 8.35898 11.9047 8.35898 11.5691V11.5691C8.35898 11.2336 8.631 10.9615 8.96654 10.9615H10.8681C11.2036 10.9615 11.4756 11.2336 11.4756 11.5691V11.5691z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.09116 2.69948C6.09119 2.43209 6.49118 2.21533 6.98459 2.21533C7.47799 2.21533 7.87798 2.43209 7.87801 2.69948H8.23393C8.83483 2.69948 9.33665 3.11214 9.45618 3.662H10.0077C10.6976 3.662 11.257 4.20602 11.257 4.87712V6.72249H12.7381C13.7731 6.72249 14.612 7.53853 14.612 8.54517V12.0508C14.612 12.5342 14.4146 12.9978 14.0632 13.3396L12.6814 14.6815C12.3299 15.0233 11.8533 15.2153 11.3563 15.2153H8.52322C7.6623 15.2153 6.93698 14.7599 6.71741 13.9905H3.96131C3.27136 13.9905 2.71204 13.4465 2.71204 12.7754V4.87712C2.71204 4.20602 3.27136 3.662 3.96131 3.662H4.51313C4.63266 3.11214 5.13448 2.69948 5.73538 2.69948H6.09116ZM4.58455 4.87712H3.86131L3.86131 12.7754H6.64931V8.54517C6.64931 7.53853 7.48829 6.72249 8.52322 6.72249H10.1077V4.87712H9.38476C9.19495 5.3129 8.75115 5.61862 8.23393 5.61862H5.73538C5.21816 5.61862 4.77436 5.3129 4.58455 4.87712ZM5.73538 3.61082H8.23393C8.40642 3.61082 8.54625 3.74683 8.54625 3.9146V4.4035C8.54625 4.57128 8.40642 4.70728 8.23393 4.70728H5.73538C5.56289 4.70728 5.42306 4.57128 5.42306 4.4035V3.9146C5.42306 3.74683 5.56289 3.61082 5.73538 3.61082ZM8.52322 7.82837C8.17824 7.82837 7.89858 8.10038 7.89858 8.43593V13.5019C7.89858 13.8374 8.17825 14.1095 8.52322 14.1095H11.3563C11.4521 14.1095 11.5457 14.088 11.6303 14.0479C11.7494 13.9914 11.798 13.8591 11.798 13.7302V12.7234C11.798 12.5892 11.9099 12.4804 12.0478 12.4804H13.0829C13.2154 12.4804 13.3514 12.4331 13.4096 12.3172C13.4508 12.235 13.4729 12.144 13.4729 12.0508V8.43593C13.4729 8.10038 13.1932 7.82837 12.8482 7.82837H8.52322Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},GN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"paste-special",ref:e,icon:gbe}))});GN.displayName="PasteSpecial";const vbe=GN;var _be={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.08989 4.52266H2.64274C2.27455 4.52266 1.97607 4.22419 1.97607 3.856C1.97607 3.48781 2.27455 3.18933 2.64274 3.18933H4.08986C4.36441 2.41251 5.10525 1.85596 5.97607 1.85596C6.8469 1.85596 7.58774 2.41251 7.86228 3.18933H12.3093C14.0055 3.18933 15.3096 4.45471 15.3094 6.1894C15.3093 7.92386 14.0056 9.18933 12.3093 9.18933H7.30953L7.3021 9.18929H4.97621C4.00568 9.18929 3.30932 9.86839 3.30941 10.8559C3.3095 11.8436 4.00579 12.5226 4.97621 12.5226H9.42321C9.69778 11.7458 10.4386 11.1893 11.3094 11.1893C12.1802 11.1893 12.921 11.7458 13.1956 12.5226H14.6427C15.0109 12.5226 15.3094 12.8211 15.3094 13.1892C15.3094 13.5574 15.0109 13.8559 14.6427 13.8559H13.1956C12.9211 14.6328 12.1802 15.1893 11.3094 15.1893C10.4386 15.1893 9.69772 14.6328 9.42318 13.856H4.97621C3.27993 13.856 1.97623 12.5905 1.97607 10.856C1.97592 9.12133 3.28005 7.85596 4.97621 7.85596H7.30941L7.31684 7.856H12.3093C13.2797 7.856 13.976 7.177 13.9761 6.18927C13.9762 5.20175 13.2798 4.52266 12.3093 4.52266H7.86226C7.58769 5.29944 6.84687 5.85596 5.97607 5.85596C5.10528 5.85596 4.36446 5.29944 4.08989 4.52266ZM5.30941 3.85596C5.30941 3.48777 5.60788 3.18929 5.97607 3.18929C6.34426 3.18929 6.64274 3.48777 6.64274 3.85596C6.64274 4.22415 6.34426 4.52262 5.97607 4.52262C5.60788 4.52262 5.30941 4.22415 5.30941 3.85596ZM10.6427 13.1925C10.6445 13.5593 10.9423 13.856 11.3094 13.856C11.6776 13.856 11.9761 13.5575 11.9761 13.1893C11.9761 12.8211 11.6776 12.5227 11.3094 12.5227C10.9423 12.5227 10.6445 12.8194 10.6427 13.1861L10.6427 13.1893L10.6427 13.1925Z",fillRule:"evenodd",clipRule:"evenodd"}}]},KN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"piping-single",ref:e,icon:_be}))});KN.displayName="PipingSingle";const bbe=KN;var Cbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_659",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.07 0.06H16.07V16.06H0.07z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_659)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.2571 6.53267C14.5175 6.28401 14.5175 5.88086 14.2571 5.6322L10.0145 1.58005C9.75414 1.33139 9.33203 1.33139 9.07168 1.58005C8.81133 1.82871 8.81133 2.23187 9.07168 2.48053L12.1763 5.4457H6.5456C3.86219 5.4457 1.68685 7.52337 1.68685 10.0863C1.68685 12.6492 3.86218 14.7269 6.5456 14.7269H9.86226C10.2139 14.7269 10.499 14.4418 10.499 14.0902V14.0902C10.499 13.7385 10.2139 13.4534 9.86226 13.4534H6.5456C4.59856 13.4534 3.02018 11.9459 3.02018 10.0863C3.02018 8.22668 4.59857 6.71917 6.5456 6.71917H12.1763L9.07168 9.68434C8.81133 9.933 8.81133 10.3362 9.07168 10.5848C9.33203 10.8335 9.75414 10.8335 10.0145 10.5848L14.2571 6.53267Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},ZN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"redo-single",ref:e,icon:Cbe}))});ZN.displayName="RedoSingle";const ybe=ZN;var Sbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_233_11",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.46 0.53H16.46V16.53H0.46z"}}]},{tag:"g",attrs:{mask:"url(#mask0_233_11)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.9908 14.5298C2.81401 14.5298 2.64446 14.4595 2.51946 14.3345C2.39446 14.2095 2.32424 14.0399 2.32424 13.8631C2.32424 13.6863 2.39446 13.5168 2.51946 13.3918C2.64446 13.2667 2.81401 13.1965 2.9908 13.1965L13.9241 13.1965C14.1009 13.1965 14.2705 13.2667 14.3955 13.3918C14.5205 13.5168 14.5907 13.6863 14.5907 13.8631C14.5907 14.0399 14.5205 14.2095 14.3955 14.3345C14.2705 14.4595 14.1009 14.5298 13.9241 14.5298L2.9908 14.5298ZM2.9908 3.86312C2.81401 3.86309 2.64446 3.79284 2.51946 3.66782C2.39446 3.5428 2.32423 3.37325 2.32423 3.19645C2.32423 3.01966 2.39446 2.85011 2.51946 2.72508C2.64446 2.60006 2.81401 2.52981 2.9908 2.52979L13.9241 2.52979C14.1009 2.52981 14.2705 2.60006 14.3955 2.72508C14.5205 2.8501 14.5907 3.01966 14.5907 3.19645C14.5907 3.37325 14.5205 3.5428 14.3955 3.66782C14.2705 3.79284 14.1009 3.86309 13.9241 3.86312L2.9908 3.86312Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.2717 11.3442C11.0163 11.5996 10.6022 11.5996 10.3468 11.3442L8.43623 9.43357L6.59776 11.272C6.35407 11.5157 5.95897 11.5157 5.71529 11.272C5.4716 11.0284 5.4716 10.6333 5.71529 10.3896L7.55376 8.5511L5.64316 6.6405C5.38776 6.3851 5.38776 5.97101 5.64316 5.7156C5.89856 5.4602 6.31265 5.4602 6.56806 5.7156L8.47866 7.62621L10.3171 5.78773C10.5608 5.54404 10.9559 5.54404 11.1996 5.78773C11.4433 6.03142 11.4433 6.42651 11.1996 6.6702L9.36113 8.50868L11.2717 10.4193C11.5271 10.6747 11.5271 11.0888 11.2717 11.3442Z"}}]}]},qN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"reduce",ref:e,icon:Sbe}))});qN.displayName="Reduce";const Ebe=qN;var wbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1297",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.2 0.05H16.2V16.05H0.2z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1297)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M1.52881 4.04899L1.52881 2.71566C1.52881 1.97928 2.12576 1.38232 2.86214 1.38232L4.19548 1.38232 4.19548 2.71566 2.86214 2.71566 2.86214 4.04899 1.52881 4.04899zM9.52881 1.38232L9.52881 2.71566 6.86214 2.71566 6.86214 1.38232 9.52881 1.38232zM1.52881 6.71566L2.86214 6.71566 2.86214 7.38232 5.52881 7.38232 5.52881 8.71566 2.86214 8.71566 2.86214 9.38232 1.52881 9.38232 1.52881 6.71566zM1.52881 12.049L2.86214 12.049 2.86214 13.3823 4.19548 13.3823 4.19548 14.7157 2.86214 14.7157C2.12576 14.7157 1.52881 14.1187 1.52881 13.3823L1.52881 12.049zM6.86214 14.7157L6.86214 13.3823 7.52881 13.3823 7.52881 10.7157 8.86214 10.7157 8.86214 13.3823 9.52881 13.3823 9.52881 14.7157 6.86214 14.7157zM13.5288 7.38232L10.8621 7.38232 10.8621 8.71566 13.5288 8.71566 13.5288 7.38232zM7.52881 5.38232L7.52881 2.71566 8.86214 2.71566 8.86214 5.38232 7.52881 5.38232z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.5289 1.38232L12.1956 1.38232L12.1956 2.71566L13.5289 2.71566L13.5289 13.3823L12.1956 13.3823L12.1956 14.7157L13.5289 14.7157C14.2653 14.7157 14.8622 14.1187 14.8622 13.3823L14.8622 2.71566C14.8622 1.97928 14.2653 1.38232 13.5289 1.38232Z"}}]}]},QN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"right-border",ref:e,icon:wbe}))});QN.displayName="RightBorder";const Rbe=QN;var Dbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_436_42",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.54 0.48H16.54V16.48H0.54z"}}]},{tag:"g",attrs:{mask:"url(#mask0_436_42)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.2368 2.87507L2.11162 7.97208L2.61144 9.06304L12.4714 4.54568L7.95409 14.4057L9.04505 14.9055L14.1421 3.78029L14.4503 3.63905L14.3286 3.37322L14.469 3.0666L14.1134 2.90369L13.9505 2.5481L13.6439 2.68857L13.3781 2.56678L13.2368 2.87507Z"}},{tag:"path",attrs:{fill:"#E5E5E5",d:"M4.44524 1.82495L3.08111 1.82495C2.41837 1.82495 1.88111 2.36221 1.88111 3.02495L1.88111 4.38908L3.21111 4.38908L3.21111 3.15495L4.44524 3.15495L4.44524 1.82495ZM15.1941 4.38908L15.1941 3.02495C15.1941 2.36221 14.6569 1.82495 13.9941 1.82495L12.63 1.82495L12.63 3.15495L13.8641 3.15495L13.8641 4.38908L15.1941 4.38908ZM7.17349 1.82495L7.17349 3.15495L9.90175 3.15495L9.90175 1.82495L7.17349 1.82495ZM15.1941 7.11734L13.8641 7.11734L13.8641 9.84559L15.1941 9.84559L15.1941 7.11734ZM15.1941 12.5739L13.8641 12.5739L13.8641 13.808L12.63 13.808L12.63 15.138L13.9941 15.138C14.6569 15.138 15.1941 14.6007 15.1941 13.938L15.1941 12.5739ZM9.90175 15.138L9.90175 13.808L7.17349 13.808L7.17349 15.138L9.90175 15.138ZM4.44524 15.138L4.44524 13.808L3.21111 13.808L3.21111 12.5739L1.88111 12.5739L1.88111 13.938C1.88111 14.6007 2.41837 15.138 3.08111 15.138L4.44524 15.138ZM1.88111 9.8456L3.21111 9.8456L3.21111 7.11734L1.88111 7.11734L1.88111 9.8456Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},JN=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"right-double-diagonal-single",ref:e,icon:Dbe}))});JN.displayName="RightDoubleDiagonalSingle";const Ibe=JN;var xbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1123",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M16.22 16.72H32.22V32.72H16.22z",transform:"rotate(180 16.22 16.72)"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1123)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.7926 14.05C2.7926 14.7863 3.38956 15.3833 4.12594 15.3833L6.7926 15.3833C7.52898 15.3833 8.12594 14.7863 8.12594 14.05L8.12593 3.3833C8.12593 2.6469 7.52898 2.04997 6.7926 2.04997L4.12593 2.04997C3.38956 2.04997 2.7926 2.6469 2.7926 3.3833L2.7926 14.05ZM4.12593 3.3833L4.12594 14.05L6.7926 14.05L6.7926 3.3833L4.12593 3.3833Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.6572 8.71702C13.6572 9.08521 13.3587 9.38369 12.9905 9.38369L11.9154 9.38369L11.9154 10.4588C11.9154 10.827 11.617 11.1255 11.2488 11.1255C10.8806 11.1255 10.5821 10.827 10.5821 10.4588L10.5821 9.38369L9.507 9.38369C9.13881 9.38369 8.84033 9.08521 8.84033 8.71702C8.84033 8.34883 9.13881 8.05035 9.507 8.05035L10.5821 8.05035L10.5821 6.97532C10.5821 6.60713 10.8806 6.30865 11.2488 6.30865C11.617 6.30865 11.9154 6.60713 11.9154 6.97532L11.9154 8.05035L12.9905 8.05035C13.3587 8.05035 13.6572 8.34883 13.6572 8.71702Z"}}]}]},eL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"right-insert-column",ref:e,icon:xbe}))});eL.displayName="RightInsertColumn";const Mbe=eL;var Obe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_821",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z",transform:"matrix(-1 0 0 1 16.88 .33)"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_821)"},children:[{tag:"path",attrs:{d:"M14.8825 2.67969C15.2415 2.67969 15.5325 2.9707 15.5325 3.32969 15.5325 3.68867 15.2415 3.97969 14.8825 3.97969L2.88247 3.97969C2.52349 3.97969 2.23247 3.68867 2.23247 3.32969 2.23247 2.9707 2.52349 2.67969 2.88247 2.67969L14.8825 2.67969zM14.8825 6.01306C15.2415 6.01306 15.5325 6.30408 15.5325 6.66306 15.5325 7.02205 15.2415 7.31306 14.8825 7.31306L5.54914 7.31306C5.19015 7.31306 4.89914 7.02205 4.89914 6.66306 4.89914 6.30408 5.19015 6.01306 5.54914 6.01306L14.8825 6.01306zM15.5325 9.99631C15.5325 9.63733 15.2415 9.34631 14.8825 9.34631L2.88247 9.34631C2.52348 9.34631 2.23247 9.63733 2.23247 9.99631 2.23247 10.3553 2.52348 10.6463 2.88247 10.6463L14.8825 10.6463C15.2415 10.6463 15.5325 10.3553 15.5325 9.99631zM14.8825 12.6797C15.2415 12.6797 15.5325 12.9707 15.5325 13.3297 15.5325 13.6887 15.2415 13.9797 14.8825 13.9797L5.54914 13.9797C5.19015 13.9797 4.89914 13.6887 4.89914 13.3297 4.89914 12.9707 5.19015 12.6797 5.54914 12.6797L14.8825 12.6797z"}}]}]},tL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"right-justifying-single",ref:e,icon:Obe}))});tL.displayName="RightJustifyingSingle";const Tbe=tL;var $be={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_805",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.7 0.56H16.7V16.56H0.7z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_805)"},children:[{tag:"path",attrs:{d:"M15.0771 3.45899C15.1665 3.20062 15.0938 2.90498 14.8911 2.70223C14.6883 2.49947 14.3927 2.4268 14.1343 2.51621L6.20494 5.26013C5.84001 5.38641 5.66397 5.79109 5.81174 6.164C5.95951 6.53691 6.37514 6.73685 6.74007 6.61057L8.95919 5.84266L11.7506 8.63411L10.9827 10.8532C10.8565 11.2182 11.0564 11.6338 11.4293 11.7816C11.8022 11.9293 12.2069 11.7533 12.3332 11.3884L15.0771 3.45899ZM12.2537 7.1804L10.4129 5.3396L13.2278 4.36552L12.2537 7.1804Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M3.53277 5.575C3.24638 5.28862 2.7952 5.27547 2.52503 5.54565C2.25486 5.81582 2.268 6.267 2.55438 6.55339L9.78778 13.7868L8.75972 13.7568C8.36618 13.7454 8.05644 14.0551 8.0679 14.4487C8.07936 14.8422 8.40769 15.1705 8.80123 15.182L11.5496 15.2621C11.8378 15.2704 12.0926 15.1044 12.1951 14.8413C12.2977 14.5783 12.2278 14.27 12.018 14.0603L3.53277 5.575Z"}}]}]},nL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"right-rotation-forty-five-degrees-single",ref:e,icon:$be}))});nL.displayName="RightRotationFortyFiveDegreesSingle";const kbe=nL;var Abe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M15.3706 8.25648C15.3706 8.53019 15.2111 8.77879 14.9623 8.89283L10.9623 10.7262 10.9623 10.7262 9.62893 11.3373 9.62893 11.3373 6.96227 12.5595C6.61082 12.7206 6.19534 12.5663 6.03426 12.2148 5.87318 11.8634 6.0275 11.4479 6.37895 11.2868L8.63727 10.2517 8.63727 6.26124 6.37895 5.22616C6.0275 5.06508 5.87318 4.6496 6.03426 4.29816 6.19534 3.94671 6.61082 3.79239 6.96227 3.95347L9.62893 5.1757 9.62893 5.17571 10.9623 5.7868 10.9623 5.78681 14.9623 7.62014C15.2111 7.73418 15.3706 7.98278 15.3706 8.25648zM10.0373 6.9029L10.0373 9.61007 10.3789 9.45347 10.379 9.45347 12.9906 8.25649 10.379 7.0595 10.3789 7.0595 10.0373 6.9029zM4.0041 1.55615C4.3907 1.55615 4.7041 1.86955 4.7041 2.25615L4.7041 14.2562C4.7041 14.5393 4.53355 14.7945 4.27198 14.9029 4.01041 15.0112 3.70933 14.9513 3.50913 14.7511L1.50913 12.7511C1.23576 12.4778 1.23576 12.0345 1.50913 11.7612 1.78249 11.4878 2.22571 11.4878 2.49908 11.7612L3.3041 12.5662 3.3041 2.25615C3.3041 1.86955 3.6175 1.55615 4.0041 1.55615z",fillRule:"evenodd",clipRule:"evenodd"}}]},rL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"right-rotation-ninety-degrees-single",ref:e,icon:Abe}))});rL.displayName="RightRotationNinetyDegreesSingle";const Nbe=rL;var Lbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_436_41",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.35 0.48H16.35V16.48H0.35z"}}]},{tag:"g",attrs:{mask:"url(#mask0_436_41)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.27177 13.714L13.5855 2.40025L14.434 3.24878L3.1203 14.5625L2.27177 13.714Z"}},{tag:"path",attrs:{fill:"#E5E5E5",d:"M4.2603 1.82495L2.89617 1.82495C2.23343 1.82495 1.69617 2.36221 1.69617 3.02495L1.69617 4.38908L3.02617 4.38908L3.02617 3.15495L4.2603 3.15495L4.2603 1.82495ZM15.0092 4.38908L15.0092 3.02495C15.0092 2.36221 14.4719 1.82495 13.8092 1.82495L12.4451 1.82495L12.4451 3.15495L13.6792 3.15495L13.6792 4.38908L15.0092 4.38908ZM6.98856 1.82495L6.98856 3.15495L9.71681 3.15495L9.71681 1.82495L6.98856 1.82495ZM15.0092 7.11734L13.6792 7.11734L13.6792 9.84559L15.0092 9.84559L15.0092 7.11734ZM15.0092 12.5739L13.6792 12.5739L13.6792 13.808L12.4451 13.808L12.4451 15.138L13.8092 15.138C14.4719 15.138 15.0092 14.6007 15.0092 13.938L15.0092 12.5739ZM9.71681 15.138L9.71681 13.808L6.98856 13.808L6.98856 15.138L9.71681 15.138ZM4.2603 15.138L4.2603 13.808L3.02617 13.808L3.02617 12.5739L1.69617 12.5739L1.69617 13.938C1.69617 14.6007 2.23343 15.138 2.89617 15.138L4.2603 15.138ZM1.69617 9.8456L3.02617 9.8456L3.02617 7.11734L1.69617 7.11734L1.69617 9.8456Z"}}]}]},iL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"slash-single",ref:e,icon:Lbe}))});iL.displayName="SlashSingle";const Pbe=iL;var Bbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_671",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.07 0.06H16.07V16.06H0.07z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_671)"},children:[{tag:"path",attrs:{d:"M5.03223 2.1974C5.03223 1.83782 4.74074 1.54632 4.38116 1.54632 4.02158 1.54632 3.73008 1.83782 3.73008 2.1974V5.21704C3.73008 5.57662 4.02158 5.86811 4.38116 5.86811 4.74074 5.86811 5.03223 5.57662 5.03223 5.21704V2.1974zM4.38116 8.95372C4.74074 8.95372 5.03223 9.24522 5.03223 9.60479V10.3959C5.03223 12.0733 6.39207 13.4332 8.06953 13.4332 9.74698 13.4332 11.1068 12.0733 11.1068 10.3959V9.60479C11.1068 9.24522 11.3983 8.95372 11.7579 8.95372 12.1175 8.95372 12.409 9.24522 12.409 9.60479V10.3959C12.409 12.7925 10.4661 14.7353 8.06953 14.7353 5.67292 14.7353 3.73008 12.7925 3.73008 10.3959V9.60479C3.73008 9.24522 4.02158 8.95372 4.38116 8.95372zM11.7579 5.86879C12.1175 5.86879 12.409 5.57729 12.409 5.21771V2.03535C12.409 1.67577 12.1175 1.38428 11.7579 1.38428 11.3983 1.38428 11.1068 1.67577 11.1068 2.03535V5.21771C11.1068 5.57729 11.3983 5.86879 11.7579 5.86879zM2.20985 6.7262C1.85027 6.7262 1.55878 7.0177 1.55878 7.37727 1.55878 7.73685 1.85027 8.02835 2.20985 8.02835H13.9292C14.2888 8.02835 14.5803 7.73685 14.5803 7.37727 14.5803 7.0177 14.2888 6.7262 13.9292 6.7262H2.20985z"}}]}]},oL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"strikethrough-single",ref:e,icon:Bbe}))});oL.displayName="StrikethroughSingle";const Fbe=oL;var Ube={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.66573 3.27145C2.45636 2.97984 2.05024 2.91317 1.75863 3.12253 1.46702 3.3319 1.40035 3.73802 1.60971 4.02963L5.12716 8.92883 1.60973 13.828C1.40036 14.1196 1.46703 14.5257 1.75864 14.7351 2.05025 14.9445 2.45637 14.8778 2.66574 14.5862L5.92734 10.0433 9.18894 14.5862C9.39831 14.8778 9.80443 14.9445 10.096 14.7351 10.3876 14.5257 10.4543 14.1196 10.245 13.828L6.72752 8.92883 10.245 4.02963C10.4543 3.73802 10.3877 3.3319 10.0961 3.12253 9.80444 2.91317 9.39832 2.97984 9.18895 3.27145L5.92734 7.81432 2.66573 3.27145zM13.084 11.4012C13.084 11.7006 12.9164 12.0534 12.5923 12.4714 12.2704 12.8864 11.8073 13.3493 11.2443 13.8668 11.1267 13.9749 11.0586 14.1276 11.0586 14.2881 11.0586 14.6024 11.3134 14.8572 11.6276 14.8572H14.0392C14.3689 14.8572 14.6361 14.5899 14.6361 14.2602 14.6361 13.9305 14.3689 13.6632 14.0392 13.6632H13.6354C13.5006 13.6632 13.3243 13.6754 13.1539 13.6921L13.1525 13.6921 13.1509 13.6906 13.1487 13.6876C13.1473 13.6848 13.1474 13.6822 13.1474 13.6822L13.1482 13.6812C13.4797 13.327 13.7948 12.9403 14.0275 12.5446 14.2597 12.1498 14.4147 11.7382 14.4147 11.3361 14.4147 10.8471 14.2419 10.4365 13.938 10.1485 13.6347 9.86112 13.2092 9.70361 12.7171 9.70361 12.4421 9.70361 12.2173 9.72894 12.0113 9.79655 11.8043 9.86446 11.6225 9.97291 11.4301 10.1306 11.3143 10.2256 11.239 10.3712 11.2164 10.5167 11.1938 10.6622 11.2218 10.8259 11.339 10.9419 11.5516 11.1523 11.8736 11.1912 12.1248 11.0192 12.2501 10.9334 12.4308 10.8778 12.589 10.8778 12.7648 10.8778 12.883 10.921 12.9582 10.996 13.0333 11.0709 13.084 11.1962 13.084 11.4012z"}}]},sL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"subscript-single",ref:e,icon:Ube}))});sL.displayName="SubscriptSingle";const Hbe=sL;var Vbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.39 0.21H16.39V16.21H0.39z",opacity:.01}},{tag:"path",attrs:{fill:"currentColor",d:"M8.38843 1.8125C4.79892 1.8125 1.88843 4.72299 1.88843 8.3125C1.88843 11.902 4.79892 14.8125 8.38843 14.8125C11.9779 14.8125 14.8884 11.902 14.8884 8.3125C14.8884 4.72299 11.9779 1.8125 8.38843 1.8125ZM11.196 6.18984L8.1404 10.4265C7.95614 10.6833 7.57456 10.6833 7.39029 10.4265L5.58103 7.91931C5.5259 7.84241 5.58103 7.73504 5.67534 7.73504H6.35581C6.5038 7.73504 6.64453 7.80614 6.73159 7.92801L7.76462 9.3615L10.0454 6.19855C10.1325 6.07813 10.2718 6.00558 10.4212 6.00558H11.1017C11.196 6.00558 11.2511 6.11295 11.196 6.18984Z",fillRule:"evenodd",clipRule:"evenodd"}}]},aL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"success-single",ref:e,icon:Vbe}))});aL.displayName="SuccessSingle";const jbe=aL;var zbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.3093 11.9302C10.0114 11.9302 9.76996 11.5394 9.76996 11.0574V6.74679C9.76996 6.28864 9.99945 5.91723 10.2826 5.91723H10.3093C10.5445 5.91723 10.7451 6.19232 10.7838 6.56765L10.7923 6.6501C10.7939 6.66626 10.8026 6.6781 10.8127 6.6781L10.8127 6.6781C10.8182 6.6781 10.8235 6.67455 10.8273 6.66828 11.1324 6.176 11.4514 5.76929 11.9509 5.76929 12.4668 5.76929 12.7802 6.11802 12.9696 6.76264 13.2895 6.23426 13.6356 5.76929 14.1319 5.76929 14.9416 5.76929 15.2942 6.7098 15.2942 8.2104V10.9897C15.2942 11.5091 15.034 11.9302 14.713 11.9302L14.713 11.9302C14.3921 11.9302 14.1319 11.5091 14.1319 10.9897V8.44289C14.1319 7.61862 14.0013 7.37556 13.7074 7.37556L13.7074 7.37556C13.2596 7.37556 13.1132 8.31995 13.1132 9.04476V10.9844C13.1132 11.5068 12.8516 11.9302 12.5288 11.9302L12.5288 11.9302C12.206 11.9302 11.9444 11.5068 11.9444 10.9844V8.44289C11.9444 7.61862 11.8138 7.37556 11.52 7.37556L11.52 7.37556C11.0721 7.37556 10.9257 8.31995 10.9257 9.04476V10.995C10.9257 11.5115 10.667 11.9302 10.3478 11.9302H10.3093zM6.61373 12.0782C5.80403 12.0782 5.45795 11.1376 5.45795 9.63703V6.85775C5.45795 6.33832 5.71814 5.91724 6.0391 5.91724 6.36007 5.91724 6.62026 6.33832 6.62026 6.85775V9.40455C6.62026 10.2394 6.75738 10.4719 7.05123 10.4719 7.11248 10.4719 7.16834 10.4626 7.22051 10.4426 7.59463 10.2995 7.67156 9.5245 7.67156 8.90233V6.85775C7.67156 6.33832 7.93175 5.91724 8.25271 5.91724 8.57368 5.91724 8.83387 6.33832 8.83387 6.85775V11.1006C8.83387 11.5588 8.60437 11.9302 8.32128 11.9302H8.14522C7.99624 11.9302 7.86909 11.7559 7.8446 11.5181L7.80493 11.1328C7.80333 11.1173 7.79503 11.1059 7.78531 11.1059 7.77943 11.1059 7.77383 11.1102 7.77004 11.1175 7.46462 11.7027 7.11974 12.0782 6.61373 12.0782zM2.92665 12.0781C2.44891 12.0781 1.94517 11.8617 1.51069 11.4334 1.27078 11.1969 1.25067 10.6728 1.42894 10.3215 1.61686 9.95109 1.9544 9.91256 2.21833 10.1299 2.46194 10.3304 2.71934 10.4507 2.95277 10.4507 3.38374 10.4507 3.58616 10.1865 3.58616 9.76381 3.58616 9.3094 3.31844 9.16145 2.90053 8.87613L2.28019 8.45342C1.77087 8.12583 1.29419 7.43893 1.29419 6.29763 1.29419 4.97668 2.02553 3.91992 3.05724 3.91992 3.4784 3.91992 3.91791 4.11606 4.29041 4.50389 4.50421 4.72649 4.51804 5.19876 4.35988 5.52088 4.19102 5.86477 3.8882 5.908 3.63956 5.73186 3.45863 5.60368 3.27034 5.53677 3.05724 5.53677 2.6981 5.53677 2.47609 5.76925 2.47609 6.19196 2.47609 6.62523 2.78299 6.79431 3.21396 7.06907L3.82123 7.46007C4.42198 7.85107 4.78112 8.50626 4.78112 9.61586 4.78112 10.9262 4.10202 12.0781 2.92665 12.0781z"}}]},lL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"sum-single",ref:e,icon:zbe}))});lL.displayName="SumSingle";const Wbe=lL;var Xbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.4963 4.53866C13.4963 4.838 13.3288 5.19084 13.0046 5.60884 12.6828 6.02386 12.2197 6.48673 11.6567 7.00424 11.5391 7.11234 11.4709 7.26502 11.4709 7.42559 11.4709 7.73986 11.7257 7.99463 12.04 7.99463H14.4515C14.7812 7.99463 15.0485 7.72735 15.0485 7.39765 15.0485 7.06795 14.7812 6.80067 14.4515 6.80067H14.0477C13.9129 6.80067 13.7367 6.8129 13.5663 6.82956L13.5648 6.82958C13.5648 6.82958 13.5624 6.82779 13.5611 6.82503 13.5597 6.82227 13.5597 6.81967 13.5597 6.81967L13.5605 6.81868C13.892 6.46446 14.2071 6.07771 14.4399 5.68204 14.6721 5.28729 14.8271 4.8756 14.8271 4.47353 14.8271 3.98457 14.6542 3.57399 14.3503 3.28599 14.047 2.99857 13.6216 2.84106 13.1295 2.84106 12.8544 2.84106 12.6297 2.86639 12.4236 2.934 12.2166 3.00192 12.0348 3.11036 11.8425 3.26808 11.7267 3.36307 11.6514 3.50867 11.6288 3.65418 11.6061 3.79965 11.6341 3.96334 11.7513 4.07933 11.9639 4.28974 12.286 4.32869 12.5372 4.15664 12.6625 4.0708 12.8431 4.01521 13.0013 4.01521 13.1771 4.01521 13.2954 4.05845 13.3705 4.13343 13.4456 4.20838 13.4963 4.33369 13.4963 4.53866zM3.07808 3.43087C2.86871 3.13926 2.46259 3.07259 2.17098 3.28195 1.87937 3.49132 1.8127 3.89744 2.02207 4.18905L5.53951 9.08825 2.02208 13.9874C1.81271 14.279 1.87939 14.6852 2.171 14.8945 2.46261 15.1039 2.86873 15.0372 3.07809 14.7456L6.33969 10.2028 9.60129 14.7456C9.81066 15.0372 10.2168 15.1039 10.5084 14.8945 10.8 14.6852 10.8667 14.279 10.6573 13.9874L7.13987 9.08825 10.6573 4.18905C10.8667 3.89744 10.8 3.49132 10.5084 3.28195 10.2168 3.07259 9.81067 3.13926 9.60131 3.43087L6.33969 7.97374 3.07808 3.43087z"}}]},uL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"superscript-single",ref:e,icon:Xbe}))});uL.displayName="SuperscriptSingle";const Ybe=uL;var Gbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_796",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.4 0.21H16.4V16.21H0.4z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_796)"},children:[{tag:"path",attrs:{d:"M2.44963 1.63696C2.82345 1.63696 3.12649 1.94 3.12649 2.31382V14.1746C3.12649 14.5484 2.82345 14.8514 2.44963 14.8514 2.07582 14.8514 1.77278 14.5484 1.77278 14.1746L1.77278 2.31382C1.77278 1.94 2.07582 1.63696 2.44963 1.63696zM14.3414 1.63696C14.7152 1.63696 15.0183 1.94 15.0183 2.31382V14.1746C15.0183 14.5484 14.7152 14.8514 14.3414 14.8514 13.9676 14.8514 13.6646 14.5484 13.6646 14.1746V8.94528H6.9855C6.61169 8.94528 6.30865 8.64224 6.30865 8.26843 6.30865 7.89461 6.61169 7.59158 6.9855 7.59158H13.6646V2.31382C13.6646 1.94 13.9676 1.63696 14.3414 1.63696z"}}]}]},cL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"truncation-single",ref:e,icon:Gbe}))});cL.displayName="TruncationSingle";const Kbe=cL;var Zbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_668",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.07 0.06H16.07V16.06H0.07z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_668)"},children:[{tag:"path",attrs:{d:"M5.31757 1.99766C5.31757 1.64676 5.03311 1.3623 4.68221 1.3623 4.33132 1.3623 4.04686 1.64676 4.04686 1.99766V8.01505C4.04686 10.2367 5.84784 12.0377 8.06947 12.0377 10.2911 12.0377 12.0921 10.2367 12.0921 8.01505V1.99766C12.0921 1.64676 11.8076 1.3623 11.4567 1.3623 11.1058 1.3623 10.8214 1.64676 10.8214 1.99766V8.01505C10.8214 9.53489 9.58931 10.767 8.06947 10.767 6.54964 10.767 5.31757 9.53489 5.31757 8.01505V1.99766zM2.79069 13.4866C2.43979 13.4866 2.15533 13.7711 2.15533 14.122 2.15533 14.4729 2.43979 14.7573 2.79069 14.7573H13.3483C13.6992 14.7573 13.9837 14.4729 13.9837 14.122 13.9837 13.7711 13.6992 13.4866 13.3483 13.4866H2.79069z"}}]}]},dL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"underline-single",ref:e,icon:Zbe}))});dL.displayName="UnderlineSingle";const qbe=dL;var Qbe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_656",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.07 0.06H16.07V16.06H0.07z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_656)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.88203 6.53267C1.62168 6.28401 1.62168 5.88086 1.88203 5.6322L6.12467 1.58005C6.38502 1.33139 6.80713 1.33139 7.06748 1.58005C7.32783 1.82871 7.32783 2.23187 7.06748 2.48053L3.96291 5.4457H9.59356C12.277 5.4457 14.4523 7.52337 14.4523 10.0863C14.4523 12.6492 12.277 14.7269 9.59356 14.7269H6.2769C5.92524 14.7269 5.64017 14.4418 5.64017 14.0902V14.0902C5.64017 13.7385 5.92524 13.4534 6.2769 13.4534H9.59356C11.5406 13.4534 13.119 11.9459 13.119 10.0863C13.119 8.22668 11.5406 6.71917 9.59356 6.71917H3.96291L7.06748 9.68434C7.32783 9.933 7.32783 10.3362 7.06748 10.5848C6.80713 10.8335 6.38502 10.8335 6.12467 10.5848L1.88203 6.53267Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},hL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"undo-single",ref:e,icon:Qbe}))});hL.displayName="UndoSingle";const Jbe=hL;var eCe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.06604 4.95117C3.84647 4.95117 4.47913 4.31851 4.47913 3.53809 4.47913 2.75766 3.84647 2.125 3.06604 2.125 2.28561 2.125 1.65295 2.75766 1.65295 3.53809 1.65295 4.31851 2.28561 4.95117 3.06604 4.95117zM5.66504 3.538C5.66504 3.16981 5.96352 2.87134 6.33171 2.87134H13.665C14.0332 2.87134 14.3317 3.16981 14.3317 3.538 14.3317 3.90619 14.0332 4.20467 13.665 4.20467H6.33171C5.96352 4.20467 5.66504 3.90619 5.66504 3.538zM6.33171 12.2047C5.96352 12.2047 5.66504 12.5032 5.66504 12.8714 5.66504 13.2396 5.96352 13.538 6.33171 13.538H13.665C14.0332 13.538 14.3317 13.2396 14.3317 12.8714 14.3317 12.5032 14.0332 12.2047 13.665 12.2047H6.33171zM6.33183 7.53809C5.96364 7.53809 5.66516 7.83656 5.66516 8.20475 5.66516 8.57294 5.96364 8.87142 6.33183 8.87142H13.6652C14.0334 8.87142 14.3318 8.57294 14.3318 8.20475 14.3318 7.83656 14.0334 7.53809 13.6652 7.53809H6.33183zM4.47913 8.20483C4.47913 8.98526 3.84647 9.61792 3.06604 9.61792 2.28561 9.61792 1.65295 8.98526 1.65295 8.20483 1.65295 7.42441 2.28561 6.79175 3.06604 6.79175 3.84647 6.79175 4.47913 7.42441 4.47913 8.20483zM3.06604 14.285C3.84647 14.285 4.47913 13.6524 4.47913 12.8719 4.47913 12.0915 3.84647 11.4589 3.06604 11.4589 2.28561 11.4589 1.65295 12.0915 1.65295 12.8719 1.65295 13.6524 2.28561 14.285 3.06604 14.285z"}}]},fL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"unorder-single",ref:e,icon:eCe}))});fL.displayName="UnorderSingle";const tCe=fL;var nCe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1282",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.2 0.05H16.2V16.05H0.2z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1282)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M4.19572 14.7161H2.86239C2.12601 14.7161 1.52905 14.1191 1.52905 13.3827V12.0494H2.86239V13.3827L4.19572 13.3827V14.7161zM1.52905 6.71606H2.86239V9.38273H1.52905V6.71606zM6.86239 14.7161V13.3827H7.52905V10.7161H8.86239V13.3827H9.52905V14.7161H6.86239zM12.1957 14.7161V13.3827H13.5291V12.0494H14.8624V13.3827C14.8624 14.1191 14.2654 14.7161 13.5291 14.7161H12.1957zM14.8624 9.38273H13.5291V8.71606H10.8624V7.38273H13.5291V6.71606H14.8624V9.38273zM7.52905 2.71606V5.38273H8.86239V2.71606H7.52905zM5.52905 8.71606H2.86239V7.38273H5.52905V8.71606z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.52905 2.71696V4.05029H2.86239L2.86239 2.71696H13.5291V4.05029H14.8624V2.71696C14.8624 1.98058 14.2654 1.38363 13.5291 1.38363H2.86239C2.12601 1.38363 1.52905 1.98058 1.52905 2.71696Z"}}]}]},mL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"up-border",ref:e,icon:nCe}))});mL.displayName="UpBorder";const rCe=mL;var iCe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_834",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.88 0.21H16.88V16.21H0.88z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_834)"},children:[{tag:"path",attrs:{d:"M2.84585 7.55023C2.48138 7.55023 2.18591 7.84569 2.18591 8.21016 2.18591 8.57463 2.48138 8.87009 2.84585 8.87009H14.9194C15.2838 8.87009 15.5793 8.57463 15.5793 8.21016 15.5793 7.84569 15.2838 7.55023 14.9194 7.55023H2.84585zM9.54121 2.17278C9.54121 1.80903 9.24634 1.51416 8.88259 1.51416 8.51885 1.51416 8.22397 1.80903 8.22397 2.17278L8.22397 4.66668 7.55207 3.99478C7.29486 3.73757 6.87785 3.73757 6.62064 3.99478 6.36343 4.25199 6.36343 4.669 6.62064 4.92621L8.41688 6.72245C8.67409 6.97965 9.0911 6.97965 9.34831 6.72245L11.1445 4.92621C11.4018 4.669 11.4018 4.25199 11.1445 3.99478 10.8873 3.73757 10.4703 3.73757 10.2131 3.99478L9.54121 4.66668 9.54121 2.17278zM8.22397 14.2477C8.22397 14.6114 8.51885 14.9063 8.88259 14.9063 9.24634 14.9063 9.54121 14.6114 9.54121 14.2477L9.54121 11.7538 10.2131 12.4257C10.4703 12.6829 10.8873 12.6829 11.1445 12.4257 11.4018 12.1685 11.4018 11.7515 11.1445 11.4943L9.34831 9.69803C9.0911 9.44083 8.67408 9.44082 8.41688 9.69803L6.62064 11.4943C6.36343 11.7515 6.36343 12.1685 6.62064 12.4257 6.87785 12.6829 7.29486 12.6829 7.55207 12.4257L8.22397 11.7538 8.22397 14.2477z"}}]}]},pL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"vertical-center-single",ref:e,icon:iCe}))});pL.displayName="VerticalCenterSingle";const oCe=pL;var sCe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_709",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.88 0.24H16.88V16.24H0.88z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_709)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{d:"M2.2157 2.90265C2.2157 2.16628 2.81264 1.56934 3.54901 1.56934H6.21565C6.95202 1.56934 7.54896 2.16628 7.54896 2.90265V13.5692C7.54896 14.3056 6.95202 14.9025 6.21565 14.9025H3.54901C2.81264 14.9025 2.2157 14.3056 2.2157 13.5692V2.90265zM3.54901 2.90265H6.21565V5.5622H3.54901V2.90265zM3.54901 6.89552V9.57631H6.21565V6.89552H3.54901zM3.54901 13.5692V10.9096H6.21565V13.5692H3.54901zM10.2156 2.90265C10.2156 2.16628 10.8125 1.56934 11.5489 1.56934H14.2155C14.9519 1.56934 15.5489 2.16628 15.5489 2.90265V13.5692C15.5489 14.3056 14.9519 14.9025 14.2155 14.9025H11.5489C10.8125 14.9025 10.2156 14.3056 10.2156 13.5692V2.90265zM11.5489 2.90265H14.2155V5.5622H11.5489V2.90265zM11.5489 6.89552V9.57631H14.2155V6.89552H11.5489zM11.5489 13.5692V10.9096H14.2155V13.5692H11.5489z"}}]}]},gL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"vertical-integration-single",ref:e,icon:sCe}))});gL.displayName="VerticalIntegrationSingle";const aCe=gL;var lCe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_799",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.21 0.56H16.21V16.56H0.21z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_799)"},children:[{tag:"path",attrs:{d:"M2.85036 3.27456C2.85036 2.9169 3.1403 2.62695 3.49796 2.62695H3.49984C3.8575 2.62695 4.14744 2.9169 4.14744 3.27456V12.2707L4.81063 11.6076C5.06353 11.3547 5.47357 11.3547 5.72648 11.6076C5.97939 11.8605 5.97939 12.2705 5.72648 12.5234L3.95777 14.2921C3.83368 14.4162 3.66771 14.482 3.4989 14.4818C3.33009 14.482 3.16412 14.4162 3.04004 14.2921L1.27134 12.5234C1.01844 12.2705 1.01844 11.8605 1.27134 11.6076C1.52425 11.3547 1.93429 11.3547 2.18719 11.6076L2.85036 12.2707V3.27456Z"}},{tag:"path",attrs:{d:"M14.9392 13.5085C14.6045 13.6619 14.2088 13.515 14.0554 13.1803L12.9051 10.6704H8.44625L7.29587 13.1803C7.14246 13.515 6.74676 13.6619 6.41206 13.5085C6.07735 13.3551 5.93038 12.9594 6.08379 12.6247L10.0696 3.92837C10.1782 3.6914 10.415 3.53947 10.6757 3.53947C10.9363 3.53947 11.1731 3.6914 11.2817 3.92837L15.2675 12.6247C15.4209 12.9594 15.274 13.3551 14.9392 13.5085ZM9.05735 9.33704H12.2939L10.6757 5.80619L9.05735 9.33704Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},vL=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"vertical-text-single",ref:e,icon:lCe}))});vL.displayName="VerticalTextSingle";const uCe=vL;var cCe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.78833 8.2124C1.78833 4.62289 4.69882 1.7124 8.28833 1.7124C11.8778 1.7124 14.7883 4.62289 14.7883 8.2124C14.7883 11.8019 11.8778 14.7124 8.28833 14.7124C4.69882 14.7124 1.78833 11.8019 1.78833 8.2124ZM7.7015 5.54982L7.94869 9.54615H8.62848L8.88598 5.54982L8.90658 4.33444H7.6706L7.7015 5.54982ZM7.4646 11.2765C7.4646 11.7812 7.83539 12.0902 8.28859 12.0902C8.74178 12.0902 9.11257 11.7812 9.11257 11.2765C9.11257 10.7924 8.74178 10.4731 8.28859 10.4731C7.83539 10.4731 7.4646 10.7924 7.4646 11.2765Z",fillRule:"evenodd",clipRule:"evenodd"}}]},_L=b.forwardRef(function(t,e){return b.createElement(dt,Object.assign({},t,{id:"warning-single",ref:e,icon:cCe}))});_L.displayName="WarningSingle";const kR=_L;let Pa=class{constructor(){Cn(this,"_components",new Map);const e={AlignBottomSingle:Qge,AlignTopSingle:eve,AllBorderSingle:nve,AmplifySingle:ive,AutowrapSingle:lve,BoldSingle:mve,BrushSingle:gve,Copy:kve,ClearFormat:wve,DownBorder:Yve,FontColor:qve,FunctionSingle:u_e,HorizontallySingle:p_e,InnerBorder:v_e,ItalicSingle:M_e,KeyboardSingle:T_e,ContentSingle16:Tve,LeftBorder:k_e,LeftJustifyingSingle:F_e,LeftRotationFortyFiveDegreesSingle:H_e,LeftRotationNinetyDegreesSingle:j_e,MergeAllSingle:K_e,HorizontalMergeSingle:f_e,VerticalIntegrationSingle:aCe,PipingSingle:bbe,CancelMergeSingle:Cve,NoBorderSingle:rbe,NoColor:obe,NoRotationSingle:abe,OuterBorder:dbe,OverflowSingle:fbe,PaintBucket:pbe,PasteSpecial:vbe,RedoSingle:ybe,RightBorder:Rbe,RightJustifyingSingle:Tbe,RightRotationFortyFiveDegreesSingle:kbe,RightRotationNinetyDegreesSingle:Nbe,StrikethroughSingle:Fbe,OrderSingle:ube,UnorderSingle:tCe,SuperscriptSingle:Ybe,SubscriptSingle:Hbe,TruncationSingle:Kbe,UnderlineSingle:qbe,UndoSingle:Jbe,UpBorder:rCe,VerticalCenterSingle:oCe,VerticalTextSingle:uCe,Insert:I_e,InsertCellDown:b_e,InsertCellShiftRight:y_e,InsertRowAbove:E_e,InsertRowBelow:R_e,LeftInsertColumn:P_e,RightInsertColumn:Mbe,DeleteColumn:jve,DeleteRow:Wve,DeleteCellShiftUp:Hve,DeleteCellShiftRight:Fve,DeleteCellShiftLeft:Pve,DeleteCellMoveDown:Nve,Reduce:Ebe,Hide:d_e,AutoHeight:sve,AdjustHeight:Gge,AdjustWidth:Zge,AvgSingle:cve,CntSingle:Ive,MaxSingle:Y_e,MinSingle:q_e,SumSingle:Wbe,CancelFreezeSingle:_ve,FreezeColumnSingle:r_e,FreezeRowSingle:o_e,FreezeToSelectedSingle:a_e,CodeSingle:Mve,FontSizeIncreaseSingle:Jve,FontSizeReduceSingleSingle:t_e,BackSlashSingle:hve,LeftDoubleDiagonalSingle:N_e,LeftTridiagonalSingle:W_e,SlashSingle:Pbe,RightDoubleDiagonalSingle:Ibe};for(const n in e)this.register(n,e[n])}register(e,n){return this._components.has(e)&&console.warn(`Component ${e} already exists.`),this._components.set(e,n),Be(()=>this._components.delete(e))}get(e){return this._components.get(e)}delete(e){this._components.delete(e)}};class dCe{constructor(){Cn(this,"_list",new Map)}setIndex(e,n){this._list.set(e,n)}getIndex(e){return this._list.get(e)}removeIndex(e){this._list.delete(e)}getMaxIndex(){let e=-9999999;return this._list.forEach(n=>{+n>e&&(e=+n)}),e}}function jr(t,e){const n=t.get(oe);return new tn(r=>{const i=n.focused$.subscribe(a=>{if(a==null)return r.next(!0);const l=n.getDocumentType(a);r.next(l!==e)}),o=n.getFocusedUniverInstance();if(o==null)return r.next(!0);const s=n.getDocumentType(o.getUnitId());return r.next(s!==e),()=>i.unsubscribe()})}var N7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bL(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var CL={exports:{}},U9={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hCe=Qe,fCe=Symbol.for("react.element"),mCe=Symbol.for("react.fragment"),pCe=Object.prototype.hasOwnProperty,gCe=hCe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vCe={key:!0,ref:!0,__self:!0,__source:!0};function yL(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)pCe.call(e,r)&&!vCe.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:fCe,type:t,key:o,ref:s,props:i,_owner:gCe.current}}U9.Fragment=mCe;U9.jsx=yL;U9.jsxs=yL;CL.exports=U9;var Ie=CL.exports;function Mu(t,e,n){var r;const i=b.useRef(null),o=b.useRef(null);let s,a=!1,l;if((!i.current||i.current!==t)&&((r=o.current)==null||r.unsubscribe(),o.current=t.subscribe(d=>{s?s(d):(l=d,a=!0)})),n&&!a)throw new Error("[useObservable]: expect shouldHaveSyncValue but not getting a sync value!");const u=b.useState(l||e),c=u[0];return s=u[1],c}function us(t){const{title:e,icon:n,label:r,value:i,value$:o}=t,s=_t(mn),a=_t(Pa),l=[];let u=0,c=i;o&&(c=Mu(o,void 0,!0));let d;Q_(n)?d=Mu(n,void 0,!0):d=n;let h=!1;if(c&&typeof c=="string"&&(h=new _o(c).isValid),n){const f=a.get(d??"");f&&l.push(Ie.jsx(f,{extend:{colorChannel1:h?c:"rgb(var(--primary-color))"}},u++))}if(r){const f=typeof r=="string",m=f?{...t}:{...r==null?void 0:r.props,...t},p=f?r:r==null?void 0:r.name,g=a.get(p);g?l.push(Ie.jsx(g,{...m,value:c},u++)):l.push(Ie.jsx("span",{children:s.t(p)},u++))}return e&&l.push(Ie.jsx("span",{children:s.t(e)},u++)),Ie.jsx(Ie.Fragment,{children:l})}var yn=(t=>(t.VOID="void",t.TOOLBAR_START="uiToolbar.start",t.TOOLBAR_INSERT="uiToolbar.insert",t.TOOLBAR_FORMULAS="uiToolbar.formulas",t.TOOLBAR_DATA="uiToolbar.data",t.TOOLBAR_VIEW="uiToolbar.view",t.TOOLBAR_OTHERS="uiToolbar.others",t.CONTEXT_MENU="contextMenu",t))(yn||{}),un=(t=>(t[t.TOOLBAR_HISTORY=0]="TOOLBAR_HISTORY",t[t.TOOLBAR_FORMAT=1]="TOOLBAR_FORMAT",t[t.TOOLBAR_LAYOUT=2]="TOOLBAR_LAYOUT",t[t.TOOLBAR_FORMULAS_INSERT=3]="TOOLBAR_FORMULAS_INSERT",t[t.TOOLBAR_FORMULAS_VIEW=4]="TOOLBAR_FORMULAS_VIEW",t[t.TOOLBAR_FILE=5]="TOOLBAR_FILE",t[t.TOOLBAR_OTHERS=6]="TOOLBAR_OTHERS",t[t.CONTEXT_MENU_FORMAT=7]="CONTEXT_MENU_FORMAT",t[t.CONTEXT_MENU_LAYOUT=8]="CONTEXT_MENU_LAYOUT",t[t.CONTEXT_MENU_DATA=9]="CONTEXT_MENU_DATA",t[t.CONTEXT_MENU_OTHERS=10]="CONTEXT_MENU_OTHERS",t))(un||{}),gt=(t=>(t[t.BUTTON=0]="BUTTON",t[t.SELECTOR=1]="SELECTOR",t[t.BUTTON_SELECTOR=2]="BUTTON_SELECTOR",t[t.SUBITEMS=3]="SUBITEMS",t))(gt||{});function _Ce(t,e,n){return document.addEventListener(t,e,n),Be(()=>document.removeEventListener(t,e,n))}let H9=class{constructor(){Cn(this,"_containers",[])}registerContainer(e){if(this._containers.indexOf(e)===-1)return this._containers.push(e),Be(()=>ga(this._containers,e));throw new Error("[LayoutService]: container already registered!")}checkElementInCurrentApplicationScope(e){return this._containers.some(n=>n.contains(e))}};const SL=nn("univer.platform-service");class bCe{get isMac(){return/Mac/.test(navigator.appVersion)}get isWindows(){return/Windows/.test(navigator.appVersion)}get isLinux(){return/Linux/.test(navigator.appVersion)}}const CCe={8:"Backspace",9:"Tab",13:"Enter",46:"Del",27:"Esc",32:"Space",37:"",39:"",38:"",40:"",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",189:"-",187:"="};var Xe=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.ENTER=13]="ENTER",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.ARROW_LEFT=37]="ARROW_LEFT",t[t.ARROW_UP=38]="ARROW_UP",t[t.ARROW_RIGHT=39]="ARROW_RIGHT",t[t.ARROW_DOWN=40]="ARROW_DOWN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.Digit0=48]="Digit0",t[t.Digit1=49]="Digit1",t[t.Digit2=50]="Digit2",t[t.Digit3=51]="Digit3",t[t.Digit4=52]="Digit4",t[t.Digit5=53]="Digit5",t[t.Digit6=54]="Digit6",t[t.Digit7=55]="Digit7",t[t.Digit8=56]="Digit8",t[t.Digit9=57]="Digit9",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NUM_LOCK=144]="NUM_LOCK",t[t.SCROLL_LOCK=145]="SCROLL_LOCK",t[t.MINUS=189]="MINUS",t[t.EQUAL=187]="EQUAL",t))(Xe||{}),Ut=(t=>(t[t.SHIFT=1024]="SHIFT",t[t.ALT=2048]="ALT",t[t.CTRL_COMMAND=4096]="CTRL_COMMAND",t[t.MAC_CTRL=8192]="MAC_CTRL",t))(Ut||{}),yCe=Object.defineProperty,SCe=Object.getOwnPropertyDescriptor,ECe=(t,e,n,r)=>{for(var i=r>1?void 0:r?SCe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&yCe(e,n,i),i},L7=(t,e)=>(n,r)=>e(n,r,t);const Xl=nn("univer.shortcut");let Pv=class extends je{constructor(e,n,r,i){super(),Cn(this,"_shortCutMapping",new Map),Cn(this,"_commandIDMapping",new Map),Cn(this,"_shortcutChanged$",new Qt),Cn(this,"shortcutChanged$",this._shortcutChanged$.asObservable()),Cn(this,"_forceEscaped",!1),Cn(this,"_disable",!1),this._commandService=e,this._platformService=n,this._contextService=r,this._layoutService=i,this.disposeWithMe(_Ce("keydown",o=>{this._resolveKeyboardEvent(o)}))}setDisable(e){this._disable=e}getAllShortcuts(){return Array.from(this._shortCutMapping.values()).map(e=>Array.from(e.values())).flat()}registerShortcut(e){const n=this._getBindingFromItem(e),r=this._shortCutMapping.get(n);r?r.add(e):this._shortCutMapping.set(n,new Set([e]));const i=e.id,o=this._commandIDMapping.get(i);return o?o.add(e):this._commandIDMapping.set(i,new Set([e])),this._emitShortcutChanged(),Be(()=>{var s,a,l,u;(s=this._shortCutMapping.get(n))==null||s.delete(e),((a=this._shortCutMapping.get(n))==null?void 0:a.size)===0&&this._shortCutMapping.delete(n),(l=this._commandIDMapping.get(i))==null||l.delete(e),((u=this._commandIDMapping.get(i))==null?void 0:u.size)===0&&this._commandIDMapping.delete(i),this._emitShortcutChanged()})}getShortcutDisplayOfCommand(e){const n=this._commandIDMapping.get(e);return n?this.getShortcutDisplay(n.values().next().value):null}getShortcutDisplay(e){const n=this._getBindingFromItem(e),r=n&Ut.CTRL_COMMAND,i=n&Ut.SHIFT,o=n&Ut.ALT,s=n&Ut.MAC_CTRL,a=CCe[n&255]??"<->";return this._platformService.isMac?`${r?"":""}${i?"":""}${o?"":""}${s?"":""}${a}`:`${r?"Ctrl+":""}${i?"Shift+":""}${o?"Alt+":""}${a}`}_emitShortcutChanged(){this._shortcutChanged$.next()}forceEscape(){return this._forceEscaped=!0,Be(()=>this._forceEscaped=!1)}_resolveKeyboardEvent(e){this._forceEscaped||this._disable||this._layoutService&&!this._layoutService.checkElementInCurrentApplicationScope(e.target)||this._dispatch(e)&&e.preventDefault()}_dispatch(e){const n=this._deriveBindingFromEvent(e);if(n===null)return!1;const r=this._shortCutMapping.get(n);if(r===void 0)return!1;const i=Array.from(r).sort((o,s)=>(s.priority??0)-(o.priority??0)).find(o=>{var s;return((s=o.preconditions)==null?void 0:s.call(o,this._contextService))??!0});return i?(this._commandService.executeCommand(i.id,i.staticParameters),!0):!1}_getBindingFromItem(e){return this._platformService.isMac&&e.mac?e.mac:this._platformService.isWindows&&e.win?e.win:this._platformService.isLinux&&e.linux?e.linux:e.binding}_deriveBindingFromEvent(e){const{shiftKey:n,metaKey:r,altKey:i,keyCode:o}=e;let s=o;return n&&(s|=Ut.SHIFT),i&&(s|=Ut.ALT),(this._platformService.isMac?r:e.ctrlKey)&&(s|=Ut.CTRL_COMMAND),this._platformService.isMac&&e.ctrlKey&&(s|=Ut.MAC_CTRL),s}};Pv=ECe([L7(0,le),L7(1,SL),L7(2,Tr),L7(3,A5(H9))],Pv);var wCe=Object.defineProperty,RCe=Object.getOwnPropertyDescriptor,DCe=(t,e,n,r)=>{for(var i=r>1?void 0:r?RCe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&wCe(e,n,i),i},ICe=(t,e)=>(n,r)=>e(n,r,t);const I1=nn("univer.menu-service");let Bv=class extends je{constructor(e){super(),Cn(this,"_menuItemMap",new Map),Cn(this,"_menuByPositions",new Map),Cn(this,"_menuChanged$",new rn(void 0)),Cn(this,"menuChanged$",this._menuChanged$.asObservable()),this._shortcutService=e}dispose(){this._menuItemMap.clear(),this._menuChanged$.complete()}addMenuItem(e){if(this._menuItemMap.has(e.id))throw new Error(`Menu item with the same id ${e.id} has already been added!`);return this._menuItemMap.set(e.id,e),Array.isArray(e.positions)?e.positions.forEach(n=>this._appendMenuToPosition(e,n)):this._appendMenuToPosition(e,e.positions),this._menuChanged$.next(),Be(()=>{if(this._menuItemMap.delete(e.id),Array.isArray(e.positions))e.positions.forEach(n=>{const r=this._menuByPositions.get(n);if(!r)return;const i=r.findIndex(o=>o[0]===e.id);i>-1&&r.splice(i,1)});else{const n=this._menuByPositions.get(e.positions);if(!n)return;const r=n.findIndex(i=>i[0]===e.id);r>-1&&n.splice(r,1)}this._menuChanged$.next()})}getMenuItems(e){if(this._menuByPositions.has(e)){const n=this._menuByPositions.get(e);if(n)return[...n.values()].map(r=>this._getDisplayMenuItems(r[1]))}return[]}getMenuItem(e){return this._menuItemMap.has(e)?this._menuItemMap.get(e):null}_getDisplayMenuItems(e){const n=this._shortcutService.getShortcutDisplayOfCommand(e.id);return n?{...e,shortcut:n}:e}_appendMenuToPosition(e,n){this._menuByPositions.has(n)||this._menuByPositions.set(n,[]);const r=this._menuByPositions.get(n);if(r.findIndex(i=>i[0]===e.id)>-1)throw new Error(`Menu item with the same id ${e.id} has already been added!`);r.push([e.id,e])}};Bv=DCe([ICe(0,Xl)],Bv);const xCe="univer-menu-item-no-hover",MCe="univer-menu-item-content",OCe="univer-menu-item-selectable",TCe="univer-menu-item-selectable-icon",$Ce="univer-menu-item-more-icon",ma={menuItemNoHover:xCe,menuItemContent:MCe,menuItemSelectable:OCe,menuItemSelectableIcon:TCe,menuItemMoreIcon:$Ce};function EL(t){const{menuType:e,onOptionSelect:n}=t,r=_t(I1);if(e){if(Array.isArray(e)){const i=e.map(o=>r.getMenuItems(o)).map(o=>o.reduce((s,a)=>(a.group?(s[a.group]=s[a.group]??[],s[a.group].push(a)):(s[un.CONTEXT_MENU_OTHERS]=s[un.CONTEXT_MENU_OTHERS]??[],s[un.CONTEXT_MENU_OTHERS].push(a)),s),{}));return Ie.jsx(Ie.Fragment,{children:i.map(o=>Object.keys(o).map(s=>Ie.jsx(uee,{eventKey:s,children:o[s].map(a=>Ie.jsx(AR,{menuItem:a,onClick:l=>{n==null||n({value:"",label:a.id,...l})}},a.id))},s)))})}return r.getMenuItems(e).map(i=>Ie.jsx(AR,{menuItem:i,onClick:o=>{n==null||n({value:"",label:i.id,...o})}},i.id))}}function wL(t){const{options:e,value:n,onOptionSelect:r,parentKey:i}=t;return(e==null?void 0:e.map((o,s)=>{var a,l;const u=`${i}-${o.label??o.id}-${s}`,c=f=>{r==null||r({value:f,label:o==null?void 0:o.label})},d=()=>{typeof o.value>"u"||r==null||r({...o})},h=wi({[ma.menuItemNoHover]:typeof o.label!="string"&&!((a=o.label)!=null&&a.hoverable)});return Ie.jsx(Xh,{eventKey:u,className:h,onClick:d,children:Ie.jsxs("span",{className:wi(ma.menuItemContent,{[ma.menuItemSelectable]:!(typeof o.label!="string"&&!((l=o.label)!=null&&l.hoverable))}),children:[typeof n<"u"&&String(n)===String(o.value)&&Ie.jsx("span",{className:ma.menuItemSelectableIcon,children:Ie.jsx(Sve,{style:{color:"rgb(var(--success-color))"}})}),Ie.jsx(us,{value$:o.value$,value:o.value,label:o.label,icon:o.icon,onChange:c})]})},u)}))??Ie.jsx(Ie.Fragment,{})}const i5=t=>Ie.jsxs(sk,{selectable:!1,children:[Ie.jsx(wL,{...t}),Ie.jsx(EL,{...t})]});function AR({menuItem:t,onClick:e}){const n=_t(I1),r=t.id?n.getMenuItems(t.id):[],i=Mu(t.disabled$||n7(!1),!1,!0),o=Mu(t.hidden$||n7(!1),!1,!0),s=Mu(t.value$||n7(void 0),void 0,!0),[a,l]=b.useState(s),u=f=>{const m=Mx(f)&&typeof f=="string"?parseInt(f):f;l(m)},c=()=>{const f=t,{title:m,label:p}=f;return Ie.jsx(Xh,{eventKey:f.id,disabled:i,onClick:()=>{e({value:a,id:f.id})},children:Ie.jsx("span",{className:ma.menuItemContent,children:Ie.jsx(us,{value:s,title:m,label:p,icon:f.icon,onChange:u})})},f.id)},d=()=>{const f=t;let m;return Q_(f.selections)?m=Mu(f.selections||n7([]),[],!0):m=f.selections||[],m.length>0?Ie.jsx(Aw,{eventKey:f.id,popupOffset:[18,0],title:Ie.jsxs("span",{className:ma.menuItemContent,children:[Ie.jsx(us,{title:f.title,value:a,onChange:u,icon:f.icon,label:f.label}),f.shortcut&&` (${f.shortcut})`]}),expandIcon:Ie.jsx($R,{className:ma.menuItemMoreIcon}),children:m.length>0&&Ie.jsx(wL,{parentKey:f.id,menuType:f.id,options:m,onOptionSelect:p=>{e({value:p.value,id:f.id})}})},f.id):Ie.jsx(Xh,{eventKey:f.id,children:Ie.jsxs("span",{className:ma.menuItemContent,children:[Ie.jsx(us,{title:f.title,value:a,icon:f.icon,label:f.label,onChange:u}),f.shortcut&&` (${f.shortcut})`]})},f.id)},h=()=>{const f=t;return Ie.jsx(Aw,{eventKey:f.id,popupOffset:[18,0],title:Ie.jsx("span",{className:ma.menuItemContent,children:Ie.jsx(us,{title:f.title,icon:f.icon,label:f.label,onChange:u})}),expandIcon:Ie.jsx($R,{className:ma.menuItemMoreIcon}),children:r.length&&Ie.jsx(EL,{menuType:f.id,parentKey:f.id,onOptionSelect:e})},f.id)};return o?null:Ie.jsxs(Ie.Fragment,{children:[t.type===gt.SELECTOR&&d(),t.type===gt.SUBITEMS&&h(),t.type===gt.BUTTON&&c()]})}const NR="univer.command.copy",b4={id:NR,name:NR,multi:!0,priority:0,type:se.COMMAND,preconditions:()=>!1,handler:async()=>!0},LR="univer.command.cut",V9={id:LR,name:LR,multi:!0,priority:0,type:se.COMMAND,preconditions:()=>!1,handler:async()=>!0},PR="univer.command.paste",C4={id:PR,name:PR,multi:!0,priority:0,type:se.COMMAND,preconditions:()=>!1,handler:async()=>!0};function kCe(t){const e=t.get(At);return{id:cb.id,group:un.TOOLBAR_HISTORY,type:gt.BUTTON,icon:"UndoSingle",title:"Undo",tooltip:"toolbar.undo",positions:[yn.TOOLBAR_START],disabled$:e.undoRedoStatus$.pipe(Fs(n=>n.undos<=0))}}function ACe(t){const e=t.get(At);return{id:db.id,group:un.TOOLBAR_HISTORY,type:gt.BUTTON,icon:"RedoSingle",title:"Redo",tooltip:"toolbar.redo",positions:[yn.TOOLBAR_START],disabled$:e.undoRedoStatus$.pipe(Fs(n=>n.redos<=0))}}var NCe=Object.defineProperty,LCe=Object.getOwnPropertyDescriptor,PCe=(t,e,n,r)=>{for(var i=r>1?void 0:r?LCe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&NCe(e,n,i),i},P7=(t,e)=>(n,r)=>e(n,r,t);const BCe={id:b4.id,description:"shortcut.copy",group:"1_common-edit",binding:Xe.C|Ut.CTRL_COMMAND},FCe={id:V9.id,description:"shortcut.cut",group:"1_common-edit",binding:Xe.X|Ut.CTRL_COMMAND},UCe={id:C4.id,description:"shortcut.paste",group:"1_common-edit",binding:Xe.V|Ut.CTRL_COMMAND},HCe={id:cb.id,description:"shortcut.undo",group:"1_common-edit",binding:Xe.Z|Ut.CTRL_COMMAND},VCe={id:db.id,description:"shortcut.redo",group:"1_common-edit",binding:Xe.Y|Ut.CTRL_COMMAND};let k3=class extends je{constructor(e,n,r,i){super(),this._injector=e,this._menuService=n,this._shortcutService=r,this._commandService=i,this.initialize()}initialize(){this._registerCommands(),this._registerShortcuts(),this._registerMenus()}_registerMenus(){[kCe,ACe].forEach(e=>{this.disposeWithMe(this._menuService.addMenuItem(this._injector.invoke(e)))})}_registerCommands(){[V9,b4,C4].forEach(e=>this.disposeWithMe(this._commandService.registerAsMultipleCommand(e)))}_registerShortcuts(){[HCe,VCe,FCe,BCe,UCe].forEach(e=>this.disposeWithMe(this._shortcutService.registerShortcut(e)))}};k3=PCe([yt(it.Ready,k3),P7(0,ne(Tn)),P7(1,I1),P7(2,Xl),P7(3,le)],k3);const U6=nn("univer.ui-controller");var y4={},RL={exports:{}},DL={exports:{}};(function(t){function e(n){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(DL);var S4=DL.exports;(function(t){var e=S4.default;function n(i){if(typeof WeakMap!="function")return null;var o=new WeakMap,s=new WeakMap;return(n=function(a){return a?s:o})(i)}function r(i,o){if(!o&&i&&i.__esModule)return i;if(i===null||e(i)!="object"&&typeof i!="function")return{default:i};var s=n(o);if(s&&s.has(i))return s.get(i);var a={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in i)if(u!=="default"&&Object.prototype.hasOwnProperty.call(i,u)){var c=l?Object.getOwnPropertyDescriptor(i,u):null;c&&(c.get||c.set)?Object.defineProperty(a,u,c):a[u]=i[u]}return a.default=i,s&&s.set(i,a),a}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(RL);var jCe=RL.exports,IL={exports:{}};(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(IL);var zCe=IL.exports,xL={exports:{}};(function(t){var e=S4.default;function n(){t.exports=n=function(){return i},t.exports.__esModule=!0,t.exports.default=t.exports;var r,i={},o=Object.prototype,s=o.hasOwnProperty,a=Object.defineProperty||function(A,T,P){A[T]=P.value},l=typeof Symbol=="function"?Symbol:{},u=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",d=l.toStringTag||"@@toStringTag";function h(A,T,P){return Object.defineProperty(A,T,{value:P,enumerable:!0,configurable:!0,writable:!0}),A[T]}try{h({},"")}catch{h=function(A,T,P){return A[T]=P}}function f(A,T,P,K){var ee=T&&T.prototype instanceof y?T:y,ue=Object.create(ee.prototype),fe=new te(K||[]);return a(ue,"_invoke",{value:$(A,P,fe)}),ue}function m(A,T,P){try{return{type:"normal",arg:A.call(T,P)}}catch(K){return{type:"throw",arg:K}}}i.wrap=f;var p="suspendedStart",g="suspendedYield",v="executing",_="completed",C={};function y(){}function S(){}function E(){}var w={};h(w,u,function(){return this});var R=Object.getPrototypeOf,D=R&&R(R(z([])));D&&D!==o&&s.call(D,u)&&(w=D);var I=E.prototype=y.prototype=Object.create(w);function k(A){["next","throw","return"].forEach(function(T){h(A,T,function(P){return this._invoke(T,P)})})}function O(A,T){function P(ee,ue,fe,Ee){var Q=m(A[ee],A,ue);if(Q.type!=="throw"){var re=Q.arg,Se=re.value;return Se&&e(Se)=="object"&&s.call(Se,"__await")?T.resolve(Se.__await).then(function(_e){P("next",_e,fe,Ee)},function(_e){P("throw",_e,fe,Ee)}):T.resolve(Se).then(function(_e){re.value=_e,fe(re)},function(_e){return P("throw",_e,fe,Ee)})}Ee(Q.arg)}var K;a(this,"_invoke",{value:function(ee,ue){function fe(){return new T(function(Ee,Q){P(ee,ue,Ee,Q)})}return K=K?K.then(fe,fe):fe()}})}function $(A,T,P){var K=p;return function(ee,ue){if(K===v)throw new Error("Generator is already running");if(K===_){if(ee==="throw")throw ue;return{value:r,done:!0}}for(P.method=ee,P.arg=ue;;){var fe=P.delegate;if(fe){var Ee=N(fe,P);if(Ee){if(Ee===C)continue;return Ee}}if(P.method==="next")P.sent=P._sent=P.arg;else if(P.method==="throw"){if(K===p)throw K=_,P.arg;P.dispatchException(P.arg)}else P.method==="return"&&P.abrupt("return",P.arg);K=v;var Q=m(A,T,P);if(Q.type==="normal"){if(K=P.done?_:g,Q.arg===C)continue;return{value:Q.arg,done:P.done}}Q.type==="throw"&&(K=_,P.method="throw",P.arg=Q.arg)}}}function N(A,T){var P=T.method,K=A.iterator[P];if(K===r)return T.delegate=null,P==="throw"&&A.iterator.return&&(T.method="return",T.arg=r,N(A,T),T.method==="throw")||P!=="return"&&(T.method="throw",T.arg=new TypeError("The iterator does not provide a '"+P+"' method")),C;var ee=m(K,A.iterator,T.arg);if(ee.type==="throw")return T.method="throw",T.arg=ee.arg,T.delegate=null,C;var ue=ee.arg;return ue?ue.done?(T[A.resultName]=ue.value,T.next=A.nextLoc,T.method!=="return"&&(T.method="next",T.arg=r),T.delegate=null,C):ue:(T.method="throw",T.arg=new TypeError("iterator result is not an object"),T.delegate=null,C)}function H(A){var T={tryLoc:A[0]};1 in A&&(T.catchLoc=A[1]),2 in A&&(T.finallyLoc=A[2],T.afterLoc=A[3]),this.tryEntries.push(T)}function X(A){var T=A.completion||{};T.type="normal",delete T.arg,A.completion=T}function te(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(H,this),this.reset(!0)}function z(A){if(A||A===""){var T=A[u];if(T)return T.call(A);if(typeof A.next=="function")return A;if(!isNaN(A.length)){var P=-1,K=function ee(){for(;++P<A.length;)if(s.call(A,P))return ee.value=A[P],ee.done=!1,ee;return ee.value=r,ee.done=!0,ee};return K.next=K}}throw new TypeError(e(A)+" is not iterable")}return S.prototype=E,a(I,"constructor",{value:E,configurable:!0}),a(E,"constructor",{value:S,configurable:!0}),S.displayName=h(E,d,"GeneratorFunction"),i.isGeneratorFunction=function(A){var T=typeof A=="function"&&A.constructor;return!!T&&(T===S||(T.displayName||T.name)==="GeneratorFunction")},i.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,E):(A.__proto__=E,h(A,d,"GeneratorFunction")),A.prototype=Object.create(I),A},i.awrap=function(A){return{__await:A}},k(O.prototype),h(O.prototype,c,function(){return this}),i.AsyncIterator=O,i.async=function(A,T,P,K,ee){ee===void 0&&(ee=Promise);var ue=new O(f(A,T,P,K),ee);return i.isGeneratorFunction(T)?ue:ue.next().then(function(fe){return fe.done?fe.value:ue.next()})},k(I),h(I,d,"Generator"),h(I,u,function(){return this}),h(I,"toString",function(){return"[object Generator]"}),i.keys=function(A){var T=Object(A),P=[];for(var K in T)P.push(K);return P.reverse(),function ee(){for(;P.length;){var ue=P.pop();if(ue in T)return ee.value=ue,ee.done=!1,ee}return ee.done=!0,ee}},i.values=z,te.prototype={constructor:te,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(X),!A)for(var T in this)T.charAt(0)==="t"&&s.call(this,T)&&!isNaN(+T.slice(1))&&(this[T]=r)},stop:function(){this.done=!0;var A=this.tryEntries[0].completion;if(A.type==="throw")throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var T=this;function P(Q,re){return ue.type="throw",ue.arg=A,T.next=Q,re&&(T.method="next",T.arg=r),!!re}for(var K=this.tryEntries.length-1;K>=0;--K){var ee=this.tryEntries[K],ue=ee.completion;if(ee.tryLoc==="root")return P("end");if(ee.tryLoc<=this.prev){var fe=s.call(ee,"catchLoc"),Ee=s.call(ee,"finallyLoc");if(fe&&Ee){if(this.prev<ee.catchLoc)return P(ee.catchLoc,!0);if(this.prev<ee.finallyLoc)return P(ee.finallyLoc)}else if(fe){if(this.prev<ee.catchLoc)return P(ee.catchLoc,!0)}else{if(!Ee)throw new Error("try statement without catch or finally");if(this.prev<ee.finallyLoc)return P(ee.finallyLoc)}}}},abrupt:function(A,T){for(var P=this.tryEntries.length-1;P>=0;--P){var K=this.tryEntries[P];if(K.tryLoc<=this.prev&&s.call(K,"finallyLoc")&&this.prev<K.finallyLoc){var ee=K;break}}ee&&(A==="break"||A==="continue")&&ee.tryLoc<=T&&T<=ee.finallyLoc&&(ee=null);var ue=ee?ee.completion:{};return ue.type=A,ue.arg=T,ee?(this.method="next",this.next=ee.finallyLoc,C):this.complete(ue)},complete:function(A,T){if(A.type==="throw")throw A.arg;return A.type==="break"||A.type==="continue"?this.next=A.arg:A.type==="return"?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):A.type==="normal"&&T&&(this.next=T),C},finish:function(A){for(var T=this.tryEntries.length-1;T>=0;--T){var P=this.tryEntries[T];if(P.finallyLoc===A)return this.complete(P.completion,P.afterLoc),X(P),C}},catch:function(A){for(var T=this.tryEntries.length-1;T>=0;--T){var P=this.tryEntries[T];if(P.tryLoc===A){var K=P.completion;if(K.type==="throw"){var ee=K.arg;X(P)}return ee}}throw new Error("illegal catch attempt")},delegateYield:function(A,T,P){return this.delegate={iterator:z(A),resultName:T,nextLoc:P},this.method==="next"&&(this.arg=r),C}},i}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(xL);var WCe=xL.exports,ML={exports:{}};(function(t){function e(r,i,o,s,a,l,u){try{var c=r[l](u),d=c.value}catch(h){o(h);return}c.done?i(d):Promise.resolve(d).then(s,a)}function n(r){return function(){var i=this,o=arguments;return new Promise(function(s,a){var l=r.apply(i,o);function u(d){e(l,s,a,u,c,"next",d)}function c(d){e(l,s,a,u,c,"throw",d)}u(void 0)})}}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(ML);var XCe=ML.exports,OL={exports:{}},TL={exports:{}},$L={exports:{}},kL={exports:{}};(function(t){var e=S4.default;function n(r,i){if(e(r)!=="object"||r===null)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var s=o.call(r,i||"default");if(e(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(r)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(kL);var YCe=kL.exports;(function(t){var e=S4.default,n=YCe;function r(i){var o=n(i,"string");return e(o)==="symbol"?o:String(o)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})($L);var GCe=$L.exports;(function(t){var e=GCe;function n(r,i,o){return i=e(i),i in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o,r}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(TL);var KCe=TL.exports;(function(t){var e=KCe;function n(i,o){var s=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);o&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),s.push.apply(s,a)}return s}function r(i){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?n(Object(s),!0).forEach(function(a){e(i,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(s,a))})}return i}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(OL);var ZCe=OL.exports,qCe=jCe.default,j9=zCe.default;Object.defineProperty(y4,"__esModule",{value:!0});y4._r=uye;y4._u=fye;var QCe=y4.render=cye,JCe=y4.unmount=mye,o5=j9(WCe),AL=j9(XCe),eye=j9(S4),tye=j9(ZCe),nye=qCe(_a),E4=(0,tye.default)({},nye),rye=E4.version,iye=E4.render,oye=E4.unmountComponentAtNode,z9;try{var sye=Number((rye||"").split(".")[0]);sye>=18&&(z9=E4.createRoot)}catch{}function BR(t){var e=E4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;e&&(0,eye.default)(e)==="object"&&(e.usingClientEntryPoint=t)}var s5="__rc_react_root__";function aye(t,e){BR(!0);var n=e[s5]||z9(e);BR(!1),n.render(t),e[s5]=n}function lye(t,e){iye(t,e)}function uye(t,e){}function cye(t,e){if(z9){aye(t,e);return}lye(t,e)}function dye(t){return Fv.apply(this,arguments)}function Fv(){return Fv=(0,AL.default)((0,o5.default)().mark(function t(e){return(0,o5.default)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Promise.resolve().then(function(){var r;(r=e[s5])===null||r===void 0||r.unmount(),delete e[s5]}));case 1:case"end":return n.stop()}},t)})),Fv.apply(this,arguments)}function hye(t){oye(t)}function fye(t){}function mye(t){return Uv.apply(this,arguments)}function Uv(){return Uv=(0,AL.default)((0,o5.default)().mark(function t(e){return(0,o5.default)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(z9===void 0){n.next=2;break}return n.abrupt("return",dye(e));case 2:hye(e);case 3:case"end":return n.stop()}},t)})),Uv.apply(this,arguments)}var pye=Object.defineProperty,gye=Object.getOwnPropertyDescriptor,vye=(t,e,n,r)=>{for(var i=r>1?void 0:r?gye(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&pye(e,n,i),i},_ye=(t,e)=>(n,r)=>e(n,r,t);const YC=nn("univer.focus-service"),bye="FOCUSING_UNIVER";let Hv=class extends je{constructor(e){super(),Cn(this,"_containerElement",null),Cn(this,"_isUniverFocused",!0),this._contextService=e,this._initFocusListener()}get isFocused(){return this._isUniverFocused}dispose(){super.dispose(),this._containerElement=null}setContainerElement(e){this._containerElement=e}_initFocusListener(){this.disposeWithMe(Be(zp(window,"focusin").subscribe(e=>{var n;e.target&&(n=this._containerElement)!=null&&n.contains(e.target)?this._isUniverFocused=!0:this._isUniverFocused=!1,this._contextService.setContextValue(bye,this._isUniverFocused)})))}};Hv=vye([yt(it.Ready,YC),_ye(0,Tr)],Hv);const w4=nn("univer.message-service"),Cye="univer-app-layout",yye="univer-app-container",Sye="univer-app-container-header",Eye="univer-app-container-wrapper",wye="univer-app-container-content",Rye="univer-app-container-canvas",Dye="univer-app-container-sidebar",U1={appLayout:Cye,appContainer:yye,appContainerHeader:Sye,appContainerWrapper:Eye,appContainerContent:wye,appContainerCanvas:Rye,appContainerSidebar:Dye};function Td(t){const{components:e}=t;return e?Array.from(e.values()).map((n,r)=>Qe.createElement(n(),{key:`${r}`})):null}const Iye="univer-toolbar-btn",xye="univer-toolbar-btn-active",FR={toolbarBtn:Iye,toolbarBtnActive:xye};function NL(t){const{children:e,className:n,style:r,disabled:i=!1,active:o=!1,onClick:s,onDoubleClick:a,...l}=t,u=h=>{if(i){h.preventDefault();return}s&&s(h)},c=h=>{if(i){h.preventDefault();return}a&&a(h)},d=wi(FR.toolbarBtn,{[`${FR.toolbarBtn}-active`]:o},n);return Ie.jsx("button",{className:d,style:r,disabled:i,onClick:u,onDoubleClick:c,...l,children:e})}const Mye="univer-headerbar",Oye="univer-header-menu",Tye="univer-menubar",$ye="univer-menubar-item",kye="univer-menubar-item-active",Aye="univer-toolbar",Nye="univer-toolbar-container",Lye="univer-toolbar-more",Pye="univer-toolbar-more-container",Bye="univer-toolbar-group",Fye="univer-toolbar-item-select-button",Uye="univer-toolbar-item-select-button-label",Hye="univer-toolbar-item-select-button-arrow",Vye="univer-toolbar-item-select",jye="univer-toolbar-item-select-arrow",Yr={headerbar:Mye,headerMenu:Oye,menubar:Tye,menubarItem:$ye,menubarItemActive:kye,toolbar:Aye,toolbarContainer:Nye,toolbarMore:Lye,toolbarMoreContainer:Pye,toolbarGroup:Bye,toolbarItemSelectButton:Fye,toolbarItemSelectButtonLabel:Uye,toolbarItemSelectButtonArrow:Hye,toolbarItemSelect:Vye,toolbarItemSelectArrow:jye},Ym=b.forwardRef((t,e)=>{var n;const r=_t(mn),i=_t(le),[o,s]=b.useState(),[a,l]=b.useState(!1),[u,c]=b.useState(!1),[d,h]=b.useState(!1);b.useEffect(()=>{const I=[];return t.disabled$&&I.push(t.disabled$.subscribe(k=>{l(k)})),t.hidden$&&I.push(t.hidden$.subscribe(k=>{h(k)})),t.type===gt.BUTTON&&t.activated$&&I.push(t.activated$.subscribe(k=>{c(k)})),t.value$&&I.push(t.value$.subscribe(k=>{s(k)})),()=>{I.forEach(k=>{k.unsubscribe()})}},[]);const{tooltip:f,shortcut:m,icon:p,title:g,label:v,id:_}=t,C=r.t(f??"")+(m?` (${m})`:""),{selections:y}=t,S=y;let E=p;Q_(p)?E=Mu(p,void 0,!0):E=((n=S==null?void 0:S.find(I=>I.value===o))==null?void 0:n.icon)??p;function w(I){function k(N){let H=_;const X=N;N.id&&(H=N.id),i.executeCommand(H,X)}function O(N){const H=_;i.executeCommand(H,{value:N})}function $(){if(I===gt.BUTTON_SELECTOR){const N=_;i.executeCommand(N,{value:o})}}return I===gt.BUTTON_SELECTOR?Ie.jsxs("div",{className:Yr.toolbarItemSelectButton,children:[Ie.jsx("div",{className:Yr.toolbarItemSelectButtonLabel,onClick:$,children:Ie.jsx(us,{icon:E,title:g,value:o,label:v,onChange:O})}),Ie.jsx(g1,{overlay:Ie.jsx(i5,{menuType:_,options:S,onOptionSelect:k,value:o}),children:Ie.jsx("div",{className:Yr.toolbarItemSelectButtonArrow,children:Ie.jsx(TR,{})})})]}):Ie.jsx(g1,{overlay:Ie.jsx(i5,{menuType:_,options:S,onOptionSelect:k,value:o}),children:Ie.jsxs("div",{className:Yr.toolbarItemSelect,children:[Ie.jsx(us,{icon:E,title:g,value:o,label:v,onChange:O}),Ie.jsx("div",{className:Yr.toolbarItemSelectArrow,children:Ie.jsx(TR,{})})]})})}function R(){const I=_t(Pa).get(typeof v=="string"?v:(v==null?void 0:v.name)??"");return Ie.jsx(NL,{className:Yr.toolbarItemTextButton,active:u,disabled:a,onClick:()=>i.executeCommand(t.id),onDoubleClick:()=>t.subId&&i.executeCommand(t.subId),children:I?Ie.jsx(us,{title:g,value:o,label:v}):Ie.jsx(us,{icon:p})})}function D(){switch(t.type){case gt.BUTTON_SELECTOR:case gt.SELECTOR:case gt.SUBITEMS:return w(t.type);case gt.BUTTON:default:return R()}}return d?Ie.jsx(Ie.Fragment,{}):Ie.jsx(p4,{ref:e,title:C,placement:"bottom",children:D()})}),zye=[yn.TOOLBAR_START,yn.TOOLBAR_INSERT,yn.TOOLBAR_FORMULAS,yn.TOOLBAR_DATA,yn.TOOLBAR_VIEW,yn.TOOLBAR_OTHERS];function Wye(t){const{headerMenuComponents:e}=t,n=_t(mn),r=_t(I1),[i,o]=b.useState(yn.TOOLBAR_START),s=b.useRef(null),a=b.useRef(null),l=b.useRef({}),[u,c]=b.useState([]),[d,h]=b.useState([]);b.useEffect(()=>{const m=r.menuChanged$.subscribe(()=>{const p=[];for(const g of zye){const v=r.getMenuItems(g);v.length&&p.push({name:g,menuItems:v})}c(p)});return()=>{m.unsubscribe()}},[i]),b.useEffect(()=>{function m(){var g,v;const _=((g=s.current)==null?void 0:g.clientWidth)??0,C=((v=a.current)==null?void 0:v.clientWidth)??0,y=Object.entries(l.current).map(([R,D])=>{var I;return{key:D.key,width:(I=D.el)==null?void 0:I.clientWidth}}),S=8,E=[];let w=C+120;for(let R=y.length-1;R>=0;R--){const D=y[R];w-=D.width+S,w>=_&&E.push(D.key)}h(E)}m();const p=new ResizeObserver(()=>m());return p.observe(document.body),()=>{p.unobserve(document.body)}},[u]);const f=b.useMemo(()=>{var m;return((m=u.find(p=>p.name===i))==null?void 0:m.menuItems.reduce((p,g)=>{const v=g.group??un.TOOLBAR_OTHERS;return p[v]||(p[v]=[]),p[v].push(g),p},{}))??{}},[u]);return Ie.jsxs(Ie.Fragment,{children:[Ie.jsxs("header",{className:Yr.headerbar,children:[Ie.jsx("div",{className:Yr.menubar,children:u.length>1&&u.map((m,p)=>Ie.jsx("a",{className:wi(Yr.menubarItem,{[Yr.menubarItemActive]:m.name===i}),onClick:()=>o(m.name),children:n.t(m.name)},p))}),Ie.jsx("div",{className:Yr.headerMenu,children:Ie.jsx(Td,{components:e})})]}),Ie.jsx("div",{ref:s,className:Yr.toolbar,children:Ie.jsxs("div",{className:Yr.toolbarContainer,children:[Object.entries(f).map(([m,p])=>Ie.jsx("div",{className:Yr.toolbarGroup,children:p.map(g=>!d.includes(g.id)&&Ie.jsx(Ym,{...g},g.id))},m)),d.length>0&&Ie.jsx(p4,{title:"",placement:"bottom",children:Ie.jsx(g1,{className:Yr.toolbarMore,overlay:Ie.jsx("div",{className:Yr.toolbarMoreContainer,onClick:m=>m.stopPropagation(),children:Object.entries(f).map(([m,p])=>Ie.jsx("div",{className:Yr.toolbarGroup,children:p.map(g=>d.includes(g.id)&&Ie.jsx(Ym,{...g},g.id))},m))}),children:Ie.jsx(NL,{className:Yr.toolbarItemTextButton,children:Ie.jsx(ebe,{})})})})]})}),Ie.jsx("div",{ref:a,className:Yr.toolbarContainer,style:{position:"absolute",top:-9999,left:-9999,opacity:0},children:Object.entries(f).map(([m,p])=>Ie.jsx("div",{className:Yr.toolbarGroup,children:p.map(g=>Ie.jsx(Ym,{ref:v=>{l.current[g.id]={el:v==null?void 0:v.nativeElement,key:g.id}},...g},g.id))},m))})]})}const C0=nn("univer.sidebar-service"),Xye="univer-sidebar",Yye="univer-sidebar-open",Gye="univer-sidebar-container",Kye="univer-sidebar-header",Zye="univer-sidebar-header-close",qye="univer-sidebar-body",Qye="univer-sidebar-footer",ql={sidebar:Xye,sidebarOpen:Yye,sidebarContainer:Gye,sidebarHeader:Kye,sidebarHeaderClose:Zye,sidebarBody:qye,sidebarFooter:Qye};function Jye(){const t=_t(C0),[e,n]=b.useState({});b.useEffect(()=>{const a=t.sidebarOptions$.subscribe(l=>{n(l)});return()=>{a.unsubscribe()}},[]);const r=e;for(const a of["children","header","footer"]){const l=a;if(e[l]){const u=e[l];u&&(r[l]=Ie.jsx(us,{...u}))}}const i=wi(ql.sidebar,{[ql.sidebarOpen]:r.visible}),o=b.useMemo(()=>r.visible?typeof r.width=="number"?`${r.width}px`:r.width:0,[r]);function s(){var a;const l={...e,visible:!1};n(l),t.sidebarOptions$.next(l),(a=l==null?void 0:l.onClose)==null||a.call(l)}return Ie.jsx("section",{className:i,style:{width:o},children:Ie.jsxs("section",{className:ql.sidebarContainer,children:[Ie.jsxs("header",{className:ql.sidebarHeader,children:[r==null?void 0:r.header,Ie.jsx("a",{className:ql.sidebarHeaderClose,onClick:s,children:Ie.jsx(qA,{})})]}),Ie.jsx("section",{className:ql.sidebarBody,children:r==null?void 0:r.children}),(r==null?void 0:r.footer)&&Ie.jsx("footer",{className:ql.sidebarFooter,children:r.footer})]})})}const LL=nn("univer.zen-zone-service"),eSe="univer-zen-zone",tSe="univer-zen-zone-open",nSe="univer-zen-zone-close",Gm={zenZone:eSe,zenZoneOpen:tSe,zenZoneClose:nSe};function rSe(){const t=_t(LL),[e,n]=b.useState(!1),[r,i]=b.useState(),o=_t(Pa);b.useEffect(()=>{const l=[t.visible$.subscribe(u=>{n(u)}),t.componentKey$.subscribe(u=>{i(u)})];return()=>{l.forEach(u=>{u.unsubscribe()})}},[]);const s=wi(Gm.zenZone,e?Gm.zenZoneOpen:Gm.zenZoneClose),a=b.useMemo(()=>{const l=o.get(r??"");if(l)return l},[r]);return Ie.jsx("section",{className:s,children:a&&Ie.jsx(a,{})})}function Vv(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function iSe(t){if(Array.isArray(t))return Vv(t)}function oSe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function PL(t,e){if(t){if(typeof t=="string")return Vv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vv(t,e)}}function sSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jd(t){return iSe(t)||oSe(t)||PL(t)||sSe()}function aSe(t){if(Array.isArray(t))return t}function lSe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}function uSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ci(t,e){return aSe(t)||lSe(t,e)||PL(t,e)||uSe()}function cSe(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function a5(t,e){if(t==null)return{};var n=cSe(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Ks(t){"@babel/helpers - typeof";return Ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ks(t)}function dSe(t,e){if(Ks(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ks(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BL(t){var e=dSe(t,"string");return Ks(e)==="symbol"?e:String(e)}function li(t,e,n){return e=BL(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UR(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function rr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UR(Object(n),!0).forEach(function(r){li(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UR(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function K2(){return K2=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},K2.apply(this,arguments)}var FL={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var r=[],i=0;i<arguments.length;i++){var o=arguments[i];if(o){var s=typeof o;if(s==="string"||s==="number")r.push(o);else if(Array.isArray(o)){if(o.length){var a=n.apply(null,o);a&&r.push(a)}}else if(s==="object"){if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]")){r.push(o.toString());continue}for(var l in o)e.call(o,l)&&o[l]&&r.push(l)}}}return r.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(FL);var hSe=FL.exports;const e6=bL(hSe);function fSe(t){return t instanceof HTMLElement||t instanceof SVGElement}function mSe(t){return fSe(t)?t:t instanceof Qe.Component?_a.findDOMNode(t):null}var UL={exports:{}},lr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GC=Symbol.for("react.element"),KC=Symbol.for("react.portal"),W9=Symbol.for("react.fragment"),X9=Symbol.for("react.strict_mode"),Y9=Symbol.for("react.profiler"),G9=Symbol.for("react.provider"),K9=Symbol.for("react.context"),pSe=Symbol.for("react.server_context"),Z9=Symbol.for("react.forward_ref"),q9=Symbol.for("react.suspense"),Q9=Symbol.for("react.suspense_list"),J9=Symbol.for("react.memo"),ef=Symbol.for("react.lazy"),gSe=Symbol.for("react.offscreen"),HL;HL=Symbol.for("react.module.reference");function vs(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case GC:switch(t=t.type,t){case W9:case Y9:case X9:case q9:case Q9:return t;default:switch(t=t&&t.$$typeof,t){case pSe:case K9:case Z9:case ef:case J9:case G9:return t;default:return e}}case KC:return e}}}lr.ContextConsumer=K9;lr.ContextProvider=G9;lr.Element=GC;lr.ForwardRef=Z9;lr.Fragment=W9;lr.Lazy=ef;lr.Memo=J9;lr.Portal=KC;lr.Profiler=Y9;lr.StrictMode=X9;lr.Suspense=q9;lr.SuspenseList=Q9;lr.isAsyncMode=function(){return!1};lr.isConcurrentMode=function(){return!1};lr.isContextConsumer=function(t){return vs(t)===K9};lr.isContextProvider=function(t){return vs(t)===G9};lr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===GC};lr.isForwardRef=function(t){return vs(t)===Z9};lr.isFragment=function(t){return vs(t)===W9};lr.isLazy=function(t){return vs(t)===ef};lr.isMemo=function(t){return vs(t)===J9};lr.isPortal=function(t){return vs(t)===KC};lr.isProfiler=function(t){return vs(t)===Y9};lr.isStrictMode=function(t){return vs(t)===X9};lr.isSuspense=function(t){return vs(t)===q9};lr.isSuspenseList=function(t){return vs(t)===Q9};lr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===W9||t===Y9||t===X9||t===q9||t===Q9||t===gSe||typeof t=="object"&&t!==null&&(t.$$typeof===ef||t.$$typeof===J9||t.$$typeof===G9||t.$$typeof===K9||t.$$typeof===Z9||t.$$typeof===HL||t.getModuleId!==void 0)};lr.typeOf=vs;UL.exports=lr;var vSe=UL.exports;function _Se(t,e){typeof t=="function"?t(e):Ks(t)==="object"&&t&&"current"in t&&(t.current=e)}function bSe(t){var e,n,r=vSe.isMemo(t)?t.type.type:t.type;return!(typeof r=="function"&&!((e=r.prototype)!==null&&e!==void 0&&e.render)||typeof t=="function"&&!((n=t.prototype)!==null&&n!==void 0&&n.render))}var CSe=b.createContext({});function VL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function HR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,BL(r.key),r)}}function jL(t,e,n){return e&&HR(t.prototype,e),n&&HR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function jv(t,e){return jv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},jv(t,e)}function zL(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jv(t,e)}function l5(t){return l5=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l5(t)}function ySe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zv(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function SSe(t,e){if(e&&(Ks(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zv(t)}function WL(t){var e=ySe();return function(){var n=l5(t),r;if(e){var i=l5(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return SSe(this,r)}}var ESe=function(t){zL(n,t);var e=WL(n);function n(){return VL(this,n),e.apply(this,arguments)}return jL(n,[{key:"render",value:function(){return this.props.children}}]),n}(b.Component);function A3(t){var e=b.useRef(!1),n=b.useState(t),r=Ci(n,2),i=r[0],o=r[1];b.useEffect(function(){return e.current=!1,function(){e.current=!0}},[]);function s(a,l){l&&e.current||o(a)}return[i,s]}var gu="none",B7="appear",F7="enter",U7="leave",VR="none",Ms="prepare",_2="start",b2="active",ZC="end",XL="prepared";function qC(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function jR(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit".concat(t)]="webkit".concat(e),n["Moz".concat(t)]="moz".concat(e),n["ms".concat(t)]="MS".concat(e),n["O".concat(t)]="o".concat(e.toLowerCase()),n}function wSe(t,e){var n={animationend:jR("Animation","AnimationEnd"),transitionend:jR("Transition","TransitionEnd")};return t&&("AnimationEvent"in e||delete n.animationend.animation,"TransitionEvent"in e||delete n.transitionend.transition),n}var RSe=wSe(qC(),typeof window<"u"?window:{}),YL={};if(qC()){var DSe=document.createElement("div");YL=DSe.style}var H7={};function GL(t){if(H7[t])return H7[t];var e=RSe[t];if(e)for(var n=Object.keys(e),r=n.length,i=0;i<r;i+=1){var o=n[i];if(Object.prototype.hasOwnProperty.call(e,o)&&o in YL)return H7[t]=e[o],H7[t]}return""}var KL=GL("animationend"),ZL=GL("transitionend"),qL=!!(KL&&ZL),zR=KL||"animationend",WR=ZL||"transitionend";function XR(t,e){if(!t)return null;if(Ks(t)==="object"){var n=e.replace(/-\w/g,function(r){return r[1].toUpperCase()});return t[n]}return"".concat(t,"-").concat(e)}const ISe=function(t){var e=b.useRef(),n=b.useRef(t);n.current=t;var r=b.useCallback(function(s){n.current(s)},[]);function i(s){s&&(s.removeEventListener(WR,r),s.removeEventListener(zR,r))}function o(s){e.current&&e.current!==s&&i(e.current),s&&s!==e.current&&(s.addEventListener(WR,r),s.addEventListener(zR,r),e.current=s)}return b.useEffect(function(){return function(){i(e.current)}},[]),[o,i]};var QL=qC()?b.useLayoutEffect:b.useEffect,JL=function(t){return+setTimeout(t,16)},eP=function(t){return clearTimeout(t)};typeof window<"u"&&"requestAnimationFrame"in window&&(JL=function(t){return window.requestAnimationFrame(t)},eP=function(t){return window.cancelAnimationFrame(t)});var YR=0,QC=new Map;function tP(t){QC.delete(t)}var Wv=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;YR+=1;var n=YR;function r(i){if(i===0)tP(n),t();else{var o=JL(function(){r(i-1)});QC.set(n,o)}}return r(e),n};Wv.cancel=function(t){var e=QC.get(t);return tP(t),eP(e)};const xSe=function(){var t=b.useRef(null);function e(){Wv.cancel(t.current)}function n(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;e();var o=Wv(function(){i<=1?r({isCanceled:function(){return o!==t.current}}):n(r,i-1)});t.current=o}return b.useEffect(function(){return function(){e()}},[]),[n,e]};var MSe=[Ms,_2,b2,ZC],OSe=[Ms,XL],nP=!1,TSe=!0;function rP(t){return t===b2||t===ZC}const $Se=function(t,e,n){var r=A3(VR),i=Ci(r,2),o=i[0],s=i[1],a=xSe(),l=Ci(a,2),u=l[0],c=l[1];function d(){s(Ms,!0)}var h=e?OSe:MSe;return QL(function(){if(o!==VR&&o!==ZC){var f=h.indexOf(o),m=h[f+1],p=n(o);p===nP?s(m,!0):m&&u(function(g){function v(){g.isCanceled()||s(m,!0)}p===!0?v():Promise.resolve(p).then(v)})}},[t,o]),b.useEffect(function(){return function(){c()}},[]),[d,o]};function kSe(t,e,n,r){var i=r.motionEnter,o=i===void 0?!0:i,s=r.motionAppear,a=s===void 0?!0:s,l=r.motionLeave,u=l===void 0?!0:l,c=r.motionDeadline,d=r.motionLeaveImmediately,h=r.onAppearPrepare,f=r.onEnterPrepare,m=r.onLeavePrepare,p=r.onAppearStart,g=r.onEnterStart,v=r.onLeaveStart,_=r.onAppearActive,C=r.onEnterActive,y=r.onLeaveActive,S=r.onAppearEnd,E=r.onEnterEnd,w=r.onLeaveEnd,R=r.onVisibleChanged,D=A3(),I=Ci(D,2),k=I[0],O=I[1],$=A3(gu),N=Ci($,2),H=N[0],X=N[1],te=A3(null),z=Ci(te,2),A=z[0],T=z[1],P=b.useRef(!1),K=b.useRef(null);function ee(){return n()}var ue=b.useRef(!1);function fe(){X(gu,!0),T(null,!0)}function Ee(ve){var Pe=ee();if(!(ve&&!ve.deadline&&ve.target!==Pe)){var Ye=ue.current,bt;H===B7&&Ye?bt=S==null?void 0:S(Pe,ve):H===F7&&Ye?bt=E==null?void 0:E(Pe,ve):H===U7&&Ye&&(bt=w==null?void 0:w(Pe,ve)),H!==gu&&Ye&&bt!==!1&&fe()}}var Q=ISe(Ee),re=Ci(Q,1),Se=re[0],_e=function(ve){var Pe,Ye,bt;switch(ve){case B7:return Pe={},li(Pe,Ms,h),li(Pe,_2,p),li(Pe,b2,_),Pe;case F7:return Ye={},li(Ye,Ms,f),li(Ye,_2,g),li(Ye,b2,C),Ye;case U7:return bt={},li(bt,Ms,m),li(bt,_2,v),li(bt,b2,y),bt;default:return{}}},He=b.useMemo(function(){return _e(H)},[H]),Ne=$Se(H,!t,function(ve){if(ve===Ms){var Pe=He[Ms];return Pe?Pe(ee()):nP}if(mt in He){var Ye;T(((Ye=He[mt])===null||Ye===void 0?void 0:Ye.call(He,ee(),null))||null)}return mt===b2&&(Se(ee()),c>0&&(clearTimeout(K.current),K.current=setTimeout(function(){Ee({deadline:!0})},c))),mt===XL&&fe(),TSe}),we=Ci(Ne,2),Me=we[0],mt=we[1],vt=rP(mt);ue.current=vt,QL(function(){O(e);var ve=P.current;P.current=!0;var Pe;!ve&&e&&a&&(Pe=B7),ve&&e&&o&&(Pe=F7),(ve&&!e&&u||!ve&&d&&!e&&u)&&(Pe=U7);var Ye=_e(Pe);Pe&&(t||Ye[Ms])?(X(Pe),Me()):X(gu)},[e]),b.useEffect(function(){(H===B7&&!a||H===F7&&!o||H===U7&&!u)&&X(gu)},[a,o,u]),b.useEffect(function(){return function(){P.current=!1,clearTimeout(K.current)}},[]);var ft=b.useRef(!1);b.useEffect(function(){k&&(ft.current=!0),k!==void 0&&H===gu&&((ft.current||k)&&(R==null||R(k)),ft.current=!0)},[k,H]);var et=A;return He[Ms]&&mt===_2&&(et=rr({transition:"none"},et)),[H,mt,et,k??e]}function ASe(t){var e=t;Ks(t)==="object"&&(e=t.transitionSupport);function n(i,o){return!!(i.motionName&&e&&o!==!1)}var r=b.forwardRef(function(i,o){var s=i.visible,a=s===void 0?!0:s,l=i.removeOnLeave,u=l===void 0?!0:l,c=i.forceRender,d=i.children,h=i.motionName,f=i.leavedClassName,m=i.eventProps,p=b.useContext(CSe),g=p.motion,v=n(i,g),_=b.useRef(),C=b.useRef();function y(){try{return _.current instanceof HTMLElement?_.current:mSe(C.current)}catch{return null}}var S=kSe(v,a,y,i),E=Ci(S,4),w=E[0],R=E[1],D=E[2],I=E[3],k=b.useRef(I);I&&(k.current=!0);var O=b.useCallback(function(T){_.current=T,_Se(o,T)},[o]),$,N=rr(rr({},m),{},{visible:a});if(!d)$=null;else if(w===gu)I?$=d(rr({},N),O):!u&&k.current&&f?$=d(rr(rr({},N),{},{className:f}),O):c||!u&&!f?$=d(rr(rr({},N),{},{style:{display:"none"}}),O):$=null;else{var H,X;R===Ms?X="prepare":rP(R)?X="active":R===_2&&(X="start");var te=XR(h,"".concat(w,"-").concat(X));$=d(rr(rr({},N),{},{className:e6(XR(h,w),(H={},li(H,te,te&&X),li(H,h,typeof h=="string"),H)),style:D}),O)}if(b.isValidElement($)&&bSe($)){var z=$,A=z.ref;A||($=b.cloneElement($,{ref:O}))}return b.createElement(ESe,{ref:C},$)});return r.displayName="CSSMotion",r}const NSe=ASe(qL);var Xv="add",Yv="keep",Gv="remove",Km="removed";function LSe(t){var e;return t&&Ks(t)==="object"&&"key"in t?e=t:e={key:t},rr(rr({},e),{},{key:String(e.key)})}function Kv(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return t.map(LSe)}function PSe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=[],r=0,i=e.length,o=Kv(t),s=Kv(e);o.forEach(function(u){for(var c=!1,d=r;d<i;d+=1){var h=s[d];if(h.key===u.key){r<d&&(n=n.concat(s.slice(r,d).map(function(f){return rr(rr({},f),{},{status:Xv})})),r=d),n.push(rr(rr({},h),{},{status:Yv})),r+=1,c=!0;break}}c||n.push(rr(rr({},u),{},{status:Gv}))}),r<i&&(n=n.concat(s.slice(r).map(function(u){return rr(rr({},u),{},{status:Xv})})));var a={};n.forEach(function(u){var c=u.key;a[c]=(a[c]||0)+1});var l=Object.keys(a).filter(function(u){return a[u]>1});return l.forEach(function(u){n=n.filter(function(c){var d=c.key,h=c.status;return d!==u||h!==Gv}),n.forEach(function(c){c.key===u&&(c.status=Yv)})}),n}var BSe=["component","children","onVisibleChanged","onAllRemoved"],FSe=["status"],USe=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function HSe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NSe,n=function(r){zL(o,r);var i=WL(o);function o(){var s;VL(this,o);for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return s=i.call.apply(i,[this].concat(l)),li(zv(s),"state",{keyEntities:[]}),li(zv(s),"removeKey",function(c){var d=s.state.keyEntities,h=d.map(function(f){return f.key!==c?f:rr(rr({},f),{},{status:Km})});return s.setState({keyEntities:h}),h.filter(function(f){var m=f.status;return m!==Km}).length}),s}return jL(o,[{key:"render",value:function(){var s=this,a=this.state.keyEntities,l=this.props,u=l.component,c=l.children,d=l.onVisibleChanged,h=l.onAllRemoved,f=a5(l,BSe),m=u||b.Fragment,p={};return USe.forEach(function(g){p[g]=f[g],delete f[g]}),delete f.keys,b.createElement(m,f,a.map(function(g,v){var _=g.status,C=a5(g,FSe),y=_===Xv||_===Yv;return b.createElement(e,K2({},p,{key:C.key,visible:y,eventProps:C,onVisibleChanged:function(S){if(d==null||d(S,{key:C.key}),!S){var E=s.removeKey(C.key);E===0&&h&&h()}}}),function(S,E){return c(rr(rr({},S),{},{index:v}),E)})}))}}],[{key:"getDerivedStateFromProps",value:function(s,a){var l=s.keys,u=a.keyEntities,c=Kv(l),d=PSe(u,c);return{keyEntities:d.filter(function(h){var f=u.find(function(m){var p=m.key;return h.key===p});return!(f&&f.status===Km&&h.status===Gv)})}}}]),o}(b.Component);return li(n,"defaultProps",{component:"div"}),n}const VSe=HSe(qL);var sn={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(t){var e=t.keyCode;if(t.altKey&&!t.ctrlKey||t.metaKey||e>=sn.F1&&e<=sn.F12)return!1;switch(e){case sn.ALT:case sn.CAPS_LOCK:case sn.CONTEXT_MENU:case sn.CTRL:case sn.DOWN:case sn.END:case sn.ESC:case sn.HOME:case sn.INSERT:case sn.LEFT:case sn.MAC_FF_META:case sn.META:case sn.NUMLOCK:case sn.NUM_CENTER:case sn.PAGE_DOWN:case sn.PAGE_UP:case sn.PAUSE:case sn.PRINT_SCREEN:case sn.RIGHT:case sn.SHIFT:case sn.UP:case sn.WIN_KEY:case sn.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(t){if(t>=sn.ZERO&&t<=sn.NINE||t>=sn.NUM_ZERO&&t<=sn.NUM_MULTIPLY||t>=sn.A&&t<=sn.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&t===0)return!0;switch(t){case sn.SPACE:case sn.QUESTION_MARK:case sn.NUM_PLUS:case sn.NUM_MINUS:case sn.NUM_PERIOD:case sn.NUM_DIVISION:case sn.SEMICOLON:case sn.DASH:case sn.EQUALS:case sn.COMMA:case sn.PERIOD:case sn.SLASH:case sn.APOSTROPHE:case sn.SINGLE_QUOTE:case sn.OPEN_SQUARE_BRACKET:case sn.BACKSLASH:case sn.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},jSe=b.forwardRef(function(t,e){var n=t.prefixCls,r=t.style,i=t.className,o=t.duration,s=o===void 0?4.5:o,a=t.eventKey,l=t.content,u=t.closable,c=t.closeIcon,d=c===void 0?"x":c,h=t.props,f=t.onClick,m=t.onNoticeClose,p=t.times,g=t.hovering,v=b.useState(!1),_=Ci(v,2),C=_[0],y=_[1],S=g||C,E=function(){m(a)},w=function(D){(D.key==="Enter"||D.code==="Enter"||D.keyCode===sn.ENTER)&&E()};b.useEffect(function(){if(!S&&s>0){var D=setTimeout(function(){E()},s*1e3);return function(){clearTimeout(D)}}},[s,S,p]);var R="".concat(n,"-notice");return b.createElement("div",K2({},h,{ref:e,className:e6(R,i,li({},"".concat(R,"-closable"),u)),style:r,onMouseEnter:function(D){var I;y(!0),h==null||(I=h.onMouseEnter)===null||I===void 0||I.call(h,D)},onMouseLeave:function(D){var I;y(!1),h==null||(I=h.onMouseLeave)===null||I===void 0||I.call(h,D)},onClick:f}),b.createElement("div",{className:"".concat(R,"-content")},l),u&&b.createElement("a",{tabIndex:0,className:"".concat(R,"-close"),onKeyDown:w,onClick:function(D){D.preventDefault(),D.stopPropagation(),E()}},d))}),zSe=Qe.createContext({}),GR=8,KR=3,ZR=16,WSe=function(t){var e={offset:GR,threshold:KR,gap:ZR};if(t&&Ks(t)==="object"){var n,r,i;e.offset=(n=t.offset)!==null&&n!==void 0?n:GR,e.threshold=(r=t.threshold)!==null&&r!==void 0?r:KR,e.gap=(i=t.gap)!==null&&i!==void 0?i:ZR}return[!!t,e]},XSe=["className","style","classNames","styles"],YSe=function(t){var e,n=t.configList,r=t.placement,i=t.prefixCls,o=t.className,s=t.style,a=t.motion,l=t.onAllNoticeRemoved,u=t.onNoticeClose,c=t.stack,d=b.useContext(zSe),h=d.classNames,f=b.useRef({}),m=b.useState(null),p=Ci(m,2),g=p[0],v=p[1],_=b.useState([]),C=Ci(_,2),y=C[0],S=C[1],E=n.map(function(X){return{config:X,key:String(X.key)}}),w=WSe(c),R=Ci(w,2),D=R[0],I=R[1],k=I.offset,O=I.threshold,$=I.gap,N=D&&(y.length>0||E.length<=O),H=typeof a=="function"?a(r):a;return b.useEffect(function(){D&&y.length>1&&S(function(X){return X.filter(function(te){return E.some(function(z){var A=z.key;return te===A})})})},[y,E,D]),b.useEffect(function(){var X;if(D&&f.current[(X=E[E.length-1])===null||X===void 0?void 0:X.key]){var te;v(f.current[(te=E[E.length-1])===null||te===void 0?void 0:te.key])}},[E,D]),Qe.createElement(VSe,K2({key:r,className:e6(i,"".concat(i,"-").concat(r),h==null?void 0:h.list,o,(e={},li(e,"".concat(i,"-stack"),!!D),li(e,"".concat(i,"-stack-expanded"),N),e)),style:s,keys:E,motionAppear:!0},H,{onAllRemoved:function(){l(r)}}),function(X,te){var z=X.config,A=X.className,T=X.style,P=X.index,K=z,ee=K.key,ue=K.times,fe=String(ee),Ee=z,Q=Ee.className,re=Ee.style,Se=Ee.classNames,_e=Ee.styles,He=a5(Ee,XSe),Ne=E.findIndex(function(Ht){return Ht.key===fe}),we={};if(D){var Me=E.length-1-(Ne>-1?Ne:P-1),mt=r==="top"||r==="bottom"?"-50%":"0";if(Me>0){var vt,ft,et;we.height=N?(vt=f.current[fe])===null||vt===void 0?void 0:vt.offsetHeight:g==null?void 0:g.offsetHeight;for(var ve=0,Pe=0;Pe<Me;Pe++){var Ye;ve+=((Ye=f.current[E[E.length-1-Pe].key])===null||Ye===void 0?void 0:Ye.offsetHeight)+$}var bt=(N?ve:Me*k)*(r.startsWith("top")?1:-1),Jt=!N&&g!==null&&g!==void 0&&g.offsetWidth&&(ft=f.current[fe])!==null&&ft!==void 0&&ft.offsetWidth?((g==null?void 0:g.offsetWidth)-k*2*(Me<3?Me:3))/((et=f.current[fe])===null||et===void 0?void 0:et.offsetWidth):1;we.transform="translate3d(".concat(mt,", ").concat(bt,"px, 0) scaleX(").concat(Jt,")")}else we.transform="translate3d(".concat(mt,", 0, 0)")}return Qe.createElement("div",{ref:te,className:e6("".concat(i,"-notice-wrapper"),A,Se==null?void 0:Se.wrapper),style:rr(rr(rr({},T),we),_e==null?void 0:_e.wrapper),onMouseEnter:function(){return S(function(Ht){return Ht.includes(fe)?Ht:[].concat(Jd(Ht),[fe])})},onMouseLeave:function(){return S(function(Ht){return Ht.filter(function(Zt){return Zt!==fe})})}},Qe.createElement(jSe,K2({},He,{ref:function(Ht){Ne>-1?f.current[fe]=Ht:delete f.current[fe]},prefixCls:i,classNames:Se,styles:_e,className:e6(Q,h==null?void 0:h.notice),style:re,times:ue,key:ee,eventKey:ee,onNoticeClose:u,hovering:D&&y.length>0})))})},GSe=b.forwardRef(function(t,e){var n=t.prefixCls,r=n===void 0?"rc-notification":n,i=t.container,o=t.motion,s=t.maxCount,a=t.className,l=t.style,u=t.onAllRemoved,c=t.stack,d=t.renderNotifications,h=b.useState([]),f=Ci(h,2),m=f[0],p=f[1],g=function(R){var D,I=m.find(function(k){return k.key===R});I==null||(D=I.onClose)===null||D===void 0||D.call(I),p(function(k){return k.filter(function(O){return O.key!==R})})};b.useImperativeHandle(e,function(){return{open:function(R){p(function(D){var I=Jd(D),k=I.findIndex(function(N){return N.key===R.key}),O=rr({},R);if(k>=0){var $;O.times=((($=D[k])===null||$===void 0?void 0:$.times)||0)+1,I[k]=O}else O.times=0,I.push(O);return s>0&&I.length>s&&(I=I.slice(-s)),I})},close:function(R){g(R)},destroy:function(){p([])}}});var v=b.useState({}),_=Ci(v,2),C=_[0],y=_[1];b.useEffect(function(){var R={};m.forEach(function(D){var I=D.placement,k=I===void 0?"topRight":I;k&&(R[k]=R[k]||[],R[k].push(D))}),Object.keys(C).forEach(function(D){R[D]=R[D]||[]}),y(R)},[m]);var S=function(R){y(function(D){var I=rr({},D),k=I[R]||[];return k.length||delete I[R],I})},E=b.useRef(!1);if(b.useEffect(function(){Object.keys(C).length>0?E.current=!0:E.current&&(u==null||u(),E.current=!1)},[C]),!i)return null;var w=Object.keys(C);return Xu.createPortal(b.createElement(b.Fragment,null,w.map(function(R){var D=C[R],I=b.createElement(YSe,{key:R,configList:D,placement:R,prefixCls:r,className:a==null?void 0:a(R),style:l==null?void 0:l(R),motion:o,onNoticeClose:g,onAllNoticeRemoved:S,stack:c});return d?d(I,{prefixCls:r,key:R}):I})),i)}),KSe=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved","stack","renderNotifications"],ZSe=function(){return document.body},qR=0;function qSe(){for(var t={},e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(i){i&&Object.keys(i).forEach(function(o){var s=i[o];s!==void 0&&(t[o]=s)})}),t}function QSe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.getContainer,n=e===void 0?ZSe:e,r=t.motion,i=t.prefixCls,o=t.maxCount,s=t.className,a=t.style,l=t.onAllRemoved,u=t.stack,c=t.renderNotifications,d=a5(t,KSe),h=b.useState(),f=Ci(h,2),m=f[0],p=f[1],g=b.useRef(),v=b.createElement(GSe,{container:m,ref:g,prefixCls:i,motion:r,maxCount:o,className:s,style:a,onAllRemoved:l,stack:u,renderNotifications:c}),_=b.useState([]),C=Ci(_,2),y=C[0],S=C[1],E=b.useMemo(function(){return{open:function(w){var R=qSe(d,w);(R.key===null||R.key===void 0)&&(R.key="rc-notification-".concat(qR),qR+=1),S(function(D){return[].concat(Jd(D),[{type:"open",config:R}])})},close:function(w){S(function(R){return[].concat(Jd(R),[{type:"close",key:w}])})},destroy:function(){S(function(w){return[].concat(Jd(w),[{type:"destroy"}])})}}},[]);return b.useEffect(function(){p(n())}),b.useEffect(function(){g.current&&y.length&&(y.forEach(function(w){switch(w.type){case"open":g.current.open(w.config);break;case"close":g.current.close(w.key);break;case"destroy":g.current.destroy();break}}),S(function(w){return w.filter(function(R){return!y.includes(R)})}))},[y]),[E,v]}const JSe="univer-notification",eEe="univer-notification-notice",tEe="univer-notification-notice-wrapper",nEe="univer-notification-notice-content",rEe="univer-notification-notice-close",iEe="univer-notification-icon",oEe="univer-notification-icon-success",sEe="univer-notification-icon-info",aEe="univer-notification-icon-warning",lEe="univer-notification-icon-error",uEe="univer-notification-content-container",cEe="univer-notification-title",dEe="univer-notification-content",hEe="univer-notification-content-ellipsis",fEe="univer-notification-top",mEe="univer-notification-topLeft",pEe="univer-notification-topRight",gEe="univer-notification-bottom",vEe="univer-notification-bottomRight",_Ee="univer-notification-bottomLeft",bEe="univer-notification-fade",CEe="univer-notification-fade-appear-prepare",yEe="univer-notification-fade-appear-start",SEe="univer-notification-fade-appear-active",EEe="univer-notification-fade-appear",wEe="univer-notification-fade-enter",REe="univer-notification-fade-leave",DEe="univer-notification-fade-enter-active",IEe="univer-notification-fade-in",xEe="univer-notification-fade-leave-active",MEe="univer-notification-fade-out",As={notification:JSe,notificationNotice:eEe,notificationNoticeWrapper:tEe,notificationNoticeContent:nEe,notificationNoticeClose:rEe,notificationIcon:iEe,notificationIconSuccess:oEe,notificationIconInfo:sEe,notificationIconWarning:aEe,notificationIconError:lEe,notificationContentContainer:uEe,notificationTitle:cEe,notificationContent:dEe,notificationContentEllipsis:hEe,notificationTop:fEe,notificationTopLeft:mEe,notificationTopRight:pEe,notificationBottom:gEe,notificationBottomRight:vEe,notificationBottomLeft:_Ee,notificationFade:bEe,notificationFadeAppearPrepare:CEe,notificationFadeAppearStart:yEe,notificationFadeAppearActive:SEe,notificationFadeAppear:EEe,notificationFadeEnter:wEe,notificationFadeLeave:REe,notificationFadeEnterActive:DEe,notificationFadeIn:IEe,notificationFadeLeaveActive:xEe,notificationFadeOut:MEe},OEe={success:Ie.jsx(jbe,{className:As.notificationIconSuccess}),info:Ie.jsx(kR,{className:As.notificationIconInfo}),warning:Ie.jsx(kR,{className:As.notificationIconWarning}),error:Ie.jsx(Kve,{className:As.notificationIconError})},iP=new Qt,TEe=t=>{const{type:e,content:n,title:r,lines:i=0}=t,o=wi(As.notificationContent,{[As.notificationContentEllipsis]:i!==0});return Ie.jsxs(Ie.Fragment,{children:[Ie.jsx("span",{className:As.notificationIcon,children:OEe[e]}),Ie.jsxs("div",{className:As.notificationContentContainer,children:[Ie.jsx("span",{className:As.notificationTitle,children:r}),Ie.jsx("span",{className:o,style:{WebkitLineClamp:i},children:n})]})]})};function $Ee(){const{mountContainer:t}=b.useContext(R1),[e,n]=QSe({prefixCls:As.notification,maxCount:3,closeIcon:Ie.jsx(qA,{}),getContainer:()=>t,motion:{motionName:As.notificationFade,motionAppear:!0,motionEnter:!0,motionLeave:!0}}),r=b.useRef(iP);return b.useEffect(()=>{const i=r.current.subscribe(o=>{e.open({content:Ie.jsx(TEe,{content:o.content,type:o.type,title:o.title,lines:o.lines}),placement:o.placement??"topRight",duration:o.duration??4.5,closable:o.closable??!0})});return()=>{i.unsubscribe()}},[]),Ie.jsx(Ie.Fragment,{children:n})}const kEe={show:t=>{iP.next(t)}},R4=nn("univer.confirm-service");function AEe(){const t=_t(R4),[e,n]=b.useState([]);b.useEffect(()=>{const i=t.confirmOptions$.subscribe(o=>{n(o)});return()=>{i.unsubscribe()}},[]);const r=e.map(i=>{const{children:o,title:s,...a}=i,l=a;for(const u of["children","title"]){const c=u,d=i[c];d&&(l[c]=Ie.jsx(us,{...d}))}return l});return r==null?void 0:r.map((i,o)=>Ie.jsx(EZ,{...i},o))}const tf=nn("univer.context-menu-service");let NEe=class extends je{constructor(){super(...arguments),Cn(this,"_currentHandler",null)}triggerContextMenu(e,n){var r;e.stopPropagation(),(r=this._currentHandler)==null||r.handleContextMenu(e,n)}registerContextMenuHandler(e){if(this._currentHandler)throw new Error("There is already a context menu handler!");return this._currentHandler=e,Be(()=>{this._currentHandler=null})}};function LEe(){const[t,e]=b.useState(!1),[n,r]=b.useState(""),[i,o]=b.useState([0,0]),s=_t(tf),a=_t(le);b.useEffect(()=>{const c=s.registerContextMenuHandler({handleContextMenu:l});return document.addEventListener("pointerdown",u),document.addEventListener("wheel",u),()=>{document.removeEventListener("pointerdown",u),document.removeEventListener("wheel",u),c.dispose()}},[]);function l(c,d){r(d),o([c.clientX,c.clientY]),e(!0)}function u(){e(!1)}return Ie.jsx(OC,{visible:t,offset:i,children:Ie.jsx("section",{onPointerDown:c=>c.stopPropagation(),children:Ie.jsx(i5,{menuType:[n],onOptionSelect:c=>{const{label:d,value:h}=c;a&&a.executeCommand(d,{value:h}),e(!1)}})})})}const oP=nn("univer.dialog-service");function PEe(){const t=_t(oP),[e,n]=b.useState([]);b.useEffect(()=>{const i=t.getObservableDialog().subscribe(o=>{n(o)});return()=>{i.unsubscribe()}},[]);const r=e.map(i=>{const{children:o,title:s,closeIcon:a,footer:l,...u}=i,c=u;for(const d of["children","title","closeIcon","footer"]){const h=d,f=i[h];f&&(c[h]=Ie.jsx(us,{...f}))}return c});return Ie.jsx(Ie.Fragment,{children:r==null?void 0:r.map(i=>Ie.jsx(T$,{...i},i.id))})}const BEe=new Set([()=>PEe,()=>AEe,()=>$Ee,()=>LEe]);function FEe(t){const e=_t(mn),n=_t(Ki),r=_t(w4),i=b.useRef(null),{mountContainer:o,headerComponents:s,headerMenuComponents:a,contentComponents:l,footerComponents:u,onRendered:c}=t;b.useEffect(()=>{n.getCurrentTheme()||n.setTheme(Ak)},[]),b.useEffect(()=>{i.current&&(c==null||c(i.current))},[c]);const[d,h]=b.useState(e.getLocales()),f=b.useMemo(()=>document.createElement("div"),[]);return b.useEffect(()=>{document.body.appendChild(f),r.setContainer(f);const m=[e.localeChanged$.subscribe(()=>{h(e.getLocales())}),n.currentTheme$.subscribe(p=>{qw.setTheme(o,p),f&&qw.setTheme(f,p)})];return()=>{m.forEach(p=>p.unsubscribe())}},[f]),Ie.jsxs(uG,{locale:d,mountContainer:f,children:[Ie.jsxs("div",{className:U1.appLayout,children:[t.toolbar&&Ie.jsx("header",{className:U1.appContainerHeader,children:Ie.jsx(Wye,{headerMenuComponents:a})}),Ie.jsxs("section",{className:U1.appContainer,children:[Ie.jsxs("div",{className:U1.appContainerWrapper,children:[Ie.jsxs("section",{className:U1.appContainerContent,children:[Ie.jsx("header",{children:Ie.jsx(Td,{components:s})}),Ie.jsx("section",{className:U1.appContainerCanvas,ref:i,"data-range-selector":!0,onContextMenu:m=>m.preventDefault(),children:Ie.jsx(Td,{components:l})})]}),Ie.jsx("aside",{className:U1.appContainerSidebar,children:Ie.jsx(Jye,{})})]}),t.footer&&Ie.jsx("footer",{className:U1.appFooter,children:Ie.jsx(Td,{components:u})}),Ie.jsx(rSe,{})]})]}),Ie.jsx(Td,{components:BEe})]})}var UEe=Object.defineProperty,HEe=Object.getOwnPropertyDescriptor,VEe=(t,e,n,r)=>{for(var i=r>1?void 0:r?HEe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&UEe(e,n,i),i},rd=(t,e)=>(n,r)=>e(n,r,t);const jEe=3e3;let Zv=class extends je{constructor(e,n,r,i,o){super(),Cn(this,"_headerComponents",new Set),Cn(this,"_headerMenuComponents",new Set),Cn(this,"_contentComponents",new Set),Cn(this,"_footerComponents",new Set),Cn(this,"_componentRegistered$",new Qt),Cn(this,"componentRegistered$",this._componentRegistered$.asObservable()),this._injector=e,this._lifecycleService=n,this._renderManagerService=r,this._focusService=i,this._layoutService=o}bootstrapWorkbench(e){this.disposeWithMe(zEe(this._injector,e,(n,r)=>{this._initializeEngine(n),this._lifecycleService.stage=it.Rendered,this._focusService.setContainerElement(r),this._layoutService&&this.disposeWithMe(this._layoutService.registerContainer(r)),setTimeout(()=>this._lifecycleService.stage=it.Steady,jEe)}))}_initializeEngine(e){this._renderManagerService.getCurrent().engine.setContainer(e)}registerComponent(e,n){switch(e){case"header":return this.registerHeaderComponent(n);case"content":return this.registerContentComponent(n);case"footer":return this.registerFooterComponent(n);case"header-menu":return this.registerHeaderMenuComponent(n);default:throw new Error(`[DesktopUIController] Unknown part type: ${e}.`)}}registerHeaderMenuComponent(e){return this._headerMenuComponents.add(e),this._componentRegistered$.next(),Be(()=>this._headerMenuComponents.delete(e))}getHeaderMenuComponents(){return new Set([...this._headerMenuComponents])}registerHeaderComponent(e){return this._headerComponents.add(e),this._componentRegistered$.next(),Be(()=>this._headerComponents.delete(e))}getHeaderComponents(){return new Set([...this._headerComponents])}registerContentComponent(e){return this._contentComponents.add(e),this._componentRegistered$.next(),Be(()=>this._contentComponents.delete(e))}getContentComponents(){return new Set([...this._contentComponents])}registerFooterComponent(e){return this._footerComponents.add(e),this._componentRegistered$.next(),Be(()=>this._footerComponents.delete(e))}getFooterComponents(){return new Set([...this._footerComponents])}};Zv=VEe([rd(0,ne(Tn)),rd(1,ne(Ls)),rd(2,kn),rd(3,YC),rd(4,A5(H9))],Zv);function zEe(t,e,n){let r;const i=e.container;if(typeof i=="string"){const c=document.getElementById(i);c?r=c:r=QR(i)}else i instanceof HTMLElement?r=i:r=QR("univer");const o=Qd(FEe,t),s=t.get(U6),a=c=>n(c,r);function l(){const c=s.getHeaderComponents(),d=s.getContentComponents(),h=s.getFooterComponents(),f=s.getHeaderMenuComponents();QCe(Ie.jsx(o,{...e,mountContainer:r,headerComponents:c,headerMenuComponents:f,contentComponents:d,onRendered:a,footerComponents:h}),r)}const u=s.componentRegistered$.subscribe(l);return l(),Be(()=>{JCe(r),u.unsubscribe()})}function QR(t){const e=document.createElement("div");return e.id=t,e}const WEe={uiToolbar:{start:"Start",insert:"Insert",formulas:"Formulas",data:"Data",view:"View",others:"Others"},"shortcut-panel":{title:"Shortcut Panel"},shortcut:{undo:"Undo",redo:"Redo",cut:"Cut",copy:"Copy",paste:"Paste"},"common-edit":"Common Edit","toggle-shortcut-panel":"Toggle Shortcut Panel"},sP=nn("univer.notification-service");var XEe=Object.defineProperty,YEe=Object.getOwnPropertyDescriptor,GEe=(t,e,n,r)=>{for(var i=r>1?void 0:r?YEe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&XEe(e,n,i),i},KEe=(t,e)=>(n,r)=>e(n,r,t);const ZEe=nn("univer.ui.before-close-service");let qv=class{constructor(e){Cn(this,"_beforeUnloadCallbacks",[]),Cn(this,"_onCloseCallbacks",[]),this._notificationService=e,this._init()}registerBeforeClose(e){return this._beforeUnloadCallbacks.push(e),{dispose:()=>{this._beforeUnloadCallbacks=this._beforeUnloadCallbacks.filter(n=>n!==e)}}}registerOnClose(e){return this._onCloseCallbacks.push(e),{dispose:()=>{this._onCloseCallbacks=this._onCloseCallbacks.filter(n=>n!==e)}}}_init(){window.addEventListener("beforeunload",e=>{const n=this._beforeUnloadCallbacks.map(r=>r()).filter(r=>!!r).join(`
`);if(n)return this._notificationService.show({type:"error",title:"Some changes are not saved",content:n}),typeof e>"u"&&(e=window.event),e.returnValue=n,n}),window.addEventListener("unload",()=>{this._onCloseCallbacks.forEach(e=>e())})}};qv=GEe([KEe(0,sP)],qv);const H6="text/plain",V6="text/html",D4=nn("univer.clipboard-interface-service");let qEe=class extends je{async write(e,n){try{return await navigator.clipboard.write([new ClipboardItem({[H6]:new Blob([e],{type:H6}),[V6]:new Blob([n],{type:V6})})])}catch(r){console.error(r)}}async writeText(e){try{return await navigator.clipboard.writeText(e)}catch(i){console.error(i)}const n=document.activeElement,r=QEe();r.value=e,r.focus(),r.select(),document.body.appendChild(r),document.execCommand("copy"),n instanceof HTMLElement&&n.focus(),document.removeChild(r)}async read(){return navigator.clipboard.read()}async readText(){try{return await navigator.clipboard.readText()}catch(e){return console.error(e),""}}};function QEe(){const t=document.createElement("textarea");return t.style.position="absolute",t.style.height="1px",t.style.width="1px",t}let JEe=class{constructor(){Cn(this,"_confirmOptions",[]),Cn(this,"confirmOptions$",new Qt)}open(e){return this._confirmOptions.find(n=>n.id===e.id)?this._confirmOptions=this._confirmOptions.map(n=>({...n.id===e.id?e:n,visible:n.id===e.id?!0:n.visible})):this._confirmOptions.push({...e,visible:!0}),this.confirmOptions$.next(this._confirmOptions),Be(()=>{this._confirmOptions=[],this.confirmOptions$.next([])})}confirm(e){return new Promise(n=>{const r=this.open({...e,onConfirm:()=>{r.dispose(),n(!0)},onClose:()=>{r.dispose(),n(!1)}})})}close(e){this._confirmOptions=this._confirmOptions.map(n=>({...n,visible:n.id===e?!1:n.visible})),this.confirmOptions$.next([...this._confirmOptions])}},ewe=class{constructor(){Cn(this,"dialogOptions",[]),Cn(this,"dialogOptions$",new Qt)}open(e){return this.dialogOptions.find(n=>n.id===e.id)?this.dialogOptions=this.dialogOptions.map(n=>({...n.id===e.id?e:n,visible:!0})):this.dialogOptions.push({...e,visible:!0}),this.dialogOptions$.next(this.dialogOptions),Be(()=>{this.dialogOptions=[],this.dialogOptions$.next([])})}close(e){this.dialogOptions=this.dialogOptions.map(n=>({...n,visible:n.id===e?!1:n.visible})),this.dialogOptions$.next([...this.dialogOptions])}getObservableDialog(){return this.dialogOptions$}},twe=class{constructor(){Cn(this,"portalContainer",document.body),Cn(this,"message")}setContainer(e){this.portalContainer=e,this.message=new ste(e)}show(e){const{type:n,...r}=e;return this.message&&this.message[n](r),Be(()=>{})}},nwe=class{show(e){return kEe.show(e),Be(()=>{})}};var rwe=Object.defineProperty,iwe=Object.getOwnPropertyDescriptor,owe=(t,e,n,r)=>{for(var i=r>1?void 0:r?iwe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&rwe(e,n,i),i},JR=(t,e)=>(n,r)=>e(n,r,t);let j6=class{constructor(e,n){Cn(this,"_current",null),Cn(this,"_shortcutParam",[]),this._currentUniverService=e,this._localeService=n}dispose(){this._shortcutParam=[]}getCurrentBySearch(e){return this._getCurrentBySearch(e)}getCurrent(){return this._getCurrentBySearch(this._current)}addOrUpdate(e){const n=this._getCurrentBySearch({unitId:e.unitId,sheetId:e.sheetId,keycode:e.keycode});if(n!=null){const r=this._shortcutParam.indexOf(n);this._shortcutParam.splice(r,1)}return this._shortcutParam.push(e),n}remove(e){if(e==null)return;const n=this._getCurrentBySearch(e);if(n==null)return;const r=this._shortcutParam.indexOf(n);return this._shortcutParam.splice(r,1)[0]}_getCurrentBySearch(e){return e==null?void 0:this._shortcutParam.find(n=>n.unitId===e.unitId&&n.sheetId===e.sheetId&&n.keycode===e.keycode)}};j6=owe([JR(0,oe),JR(1,ne(mn))],j6);let swe=class{constructor(){Cn(this,"_sidebarOptions",{}),Cn(this,"sidebarOptions$",new Qt)}open(e){return this._sidebarOptions={...e,visible:!0},this.sidebarOptions$.next(this._sidebarOptions),Be(()=>{this.sidebarOptions$.complete()})}set(e){this._sidebarOptions={...e},this.sidebarOptions$.next(this._sidebarOptions)}close(){this._sidebarOptions={...this._sidebarOptions,visible:!1},this.sidebarOptions$.next(this._sidebarOptions),this._sidebarOptions.onClose&&this._sidebarOptions.onClose()}};var awe=Object.defineProperty,lwe=Object.getOwnPropertyDescriptor,uwe=(t,e,n,r)=>{for(var i=r>1?void 0:r?lwe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&awe(e,n,i),i},eD=(t,e)=>(n,r)=>e(n,r,t);let N3=class extends je{constructor(e,n){super(),this._errorService=e,this._messageService=n,this.disposeWithMe(Be(this._errorService.error$.subscribe(r=>{this._messageService.show({content:r.errorKey,type:T9.Error})})))}};N3=uwe([yt(it.Starting,N3),eD(0,ne(q6)),eD(1,w4)],N3);let aP=class extends je{constructor(){super(...arguments),Cn(this,"_open$",new rn(!1)),Cn(this,"open$",this._open$.pipe(eb()))}get isOpen(){return this._open$.getValue()}dispose(){this._open$.next(!1),this._open$.complete()}open(){this._open$.next(!0)}close(){this._open$.next(!1)}};const lP="ShortcutPanel",uP={id:"base-ui.operation.toggle-shortcut-panel",type:se.OPERATION,handler:t=>{const e=t.get(aP),n=t.get(C0);return e.isOpen?(e.close(),n.close()):(e.open(),n.open({header:{title:"shortcut-panel.title"},children:{label:lP}})),!0}},cwe="univer-shortcut-panel-group-title",dwe="univer-shortcut-panel-item",hwe="univer-shortcut-panel-item-title",fwe="univer-shortcut-panel-item-shortcut",Nc={shortcutPanelGroupTitle:cwe,shortcutPanelItem:dwe,shortcutPanelItemTitle:hwe,shortcutPanelItemShortcut:fwe};function mwe(){const t=_t(Xl),e=_t(mn),[n,r]=Qe.useState([]),i=b.useCallback(()=>{const o=new Map,s=t.getAllShortcuts().filter(l=>!!l.group);for(const l of s){const u=l.group,c={title:e.t(l.description??l.id),shortcut:t.getShortcutDisplay(l)};if(!/\d+_[a-zA-Z0-9]/.test(u))throw new Error(`[ShortcutPanel]: Invalid shortcut group: ${u}!`);o.has(u)||o.set(u,[]),o.get(u).push(c)}const a=Array.from(o.entries()).map(([l,u])=>{const c=l.split("_")[0],d=l.slice(c.length+1);return{sequence:+c,name:e.t(d),items:u}}).sort((l,u)=>l.sequence-u.sequence);r(a)},[t,e]);return b.useEffect(()=>{i();const o=t.shortcutChanged$.subscribe(()=>i());return()=>o.unsubscribe()},[t]),Ie.jsx("div",{className:Nc.shortcutPanel,children:n.map(o=>Ie.jsxs("div",{className:Nc.shortcutPanelGroup,children:[Ie.jsx("div",{className:Nc.shortcutPanelGroupTitle,children:o.name}),o.items.map((s,a)=>Ie.jsxs("div",{className:Nc.shortcutPanelItem,children:[Ie.jsx("span",{className:Nc.shortcutPanelItemTitle,children:s.title}),Ie.jsx("span",{className:Nc.shortcutPanelItemShortcut,children:s.shortcut})]},a))]},o.name))})}function pwe(t){return{id:uP.id,title:"toggle-shortcut-panel",tooltip:"toggle-shortcut-panel",icon:"KeyboardSingle",type:gt.BUTTON,positions:[yn.TOOLBAR_START],hidden$:jr(t,Pr.SHEET)}}var gwe=Object.defineProperty,vwe=Object.getOwnPropertyDescriptor,_we=(t,e,n,r)=>{for(var i=r>1?void 0:r?vwe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&gwe(e,n,i),i},V7=(t,e)=>(n,r)=>e(n,r,t);let L3=class extends je{constructor(e,n,r,i){super(),this._injector=e,this.disposeWithMe(n.addMenuItem(this._injector.invoke(pwe))),this.disposeWithMe(i.register(lP,mwe)),this.disposeWithMe(r.registerCommand(uP))}};L3=_we([yt(it.Steady,L3),V7(0,ne(Tn)),V7(1,I1),V7(2,le),V7(3,ne(Pa))],L3);function j7(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var cP={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var d=typeof j7=="function"&&j7;if(!c&&d)return d(u,!0);if(a)return a(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var f=i[u]={exports:{}};r[u][0].call(f.exports,function(m){var p=r[u][1][m];return s(p||m)},f,f.exports,n,r,i,o)}return i[u].exports}for(var a=typeof j7=="function"&&j7,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s=o.MutationObserver||o.WebKitMutationObserver,a;if(s){var l=0,u=new s(m),c=o.document.createTextNode("");u.observe(c,{characterData:!0}),a=function(){c.data=l=++l%2}}else if(!o.setImmediate&&typeof o.MessageChannel<"u"){var d=new o.MessageChannel;d.port1.onmessage=m,a=function(){d.port2.postMessage(0)}}else"document"in o&&"onreadystatechange"in o.document.createElement("script")?a=function(){var g=o.document.createElement("script");g.onreadystatechange=function(){m(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},o.document.documentElement.appendChild(g)}:a=function(){setTimeout(m,0)};var h,f=[];function m(){h=!0;for(var g,v,_=f.length;_;){for(v=f,f=[],g=-1;++g<_;)v[g]();_=f.length}h=!1}r.exports=p;function p(g){f.push(g)===1&&!h&&a()}}).call(this,typeof N7<"u"?N7:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,r,i){var o=n(1);function s(){}var a={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];r.exports=d;function d(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,S!==s&&p(this,S)}d.prototype.catch=function(S){return this.then(null,S)},d.prototype.then=function(S,E){if(typeof S!="function"&&this.state===u||typeof E!="function"&&this.state===l)return this;var w=new this.constructor(s);if(this.state!==c){var R=this.state===u?S:E;f(w,R,this.outcome)}else this.queue.push(new h(w,S,E));return w};function h(S,E,w){this.promise=S,typeof E=="function"&&(this.onFulfilled=E,this.callFulfilled=this.otherCallFulfilled),typeof w=="function"&&(this.onRejected=w,this.callRejected=this.otherCallRejected)}h.prototype.callFulfilled=function(S){a.resolve(this.promise,S)},h.prototype.otherCallFulfilled=function(S){f(this.promise,this.onFulfilled,S)},h.prototype.callRejected=function(S){a.reject(this.promise,S)},h.prototype.otherCallRejected=function(S){f(this.promise,this.onRejected,S)};function f(S,E,w){o(function(){var R;try{R=E(w)}catch(D){return a.reject(S,D)}R===S?a.reject(S,new TypeError("Cannot resolve promise with itself")):a.resolve(S,R)})}a.resolve=function(S,E){var w=g(m,E);if(w.status==="error")return a.reject(S,w.value);var R=w.value;if(R)p(S,R);else{S.state=u,S.outcome=E;for(var D=-1,I=S.queue.length;++D<I;)S.queue[D].callFulfilled(E)}return S},a.reject=function(S,E){S.state=l,S.outcome=E;for(var w=-1,R=S.queue.length;++w<R;)S.queue[w].callRejected(E);return S};function m(S){var E=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof E=="function")return function(){E.apply(S,arguments)}}function p(S,E){var w=!1;function R(O){w||(w=!0,a.reject(S,O))}function D(O){w||(w=!0,a.resolve(S,O))}function I(){E(D,R)}var k=g(I);k.status==="error"&&R(k.value)}function g(S,E){var w={};try{w.value=S(E),w.status="success"}catch(R){w.status="error",w.value=R}return w}d.resolve=v;function v(S){return S instanceof this?S:a.resolve(new this(s),S)}d.reject=_;function _(S){var E=new this(s);return a.reject(E,S)}d.all=C;function C(S){var E=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=S.length,R=!1;if(!w)return this.resolve([]);for(var D=new Array(w),I=0,k=-1,O=new this(s);++k<w;)$(S[k],k);return O;function $(N,H){E.resolve(N).then(X,function(te){R||(R=!0,a.reject(O,te))});function X(te){D[H]=te,++I===w&&!R&&(R=!0,a.resolve(O,D))}}}d.race=y;function y(S){var E=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=S.length,R=!1;if(!w)return this.resolve([]);for(var D=-1,I=new this(s);++D<w;)k(S[D]);return I;function k(O){E.resolve(O).then(function($){R||(R=!0,a.resolve(I,$))},function($){R||(R=!0,a.reject(I,$))})}}},{1:1}],3:[function(n,r,i){(function(o){typeof o.Promise!="function"&&(o.Promise=n(2))}).call(this,typeof N7<"u"?N7:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,r,i){var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B};function s(B,Y){if(!(B instanceof Y))throw new TypeError("Cannot call a class as a function")}function a(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var l=a();function u(){try{if(!l||!l.open)return!1;var B=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Y=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!B||Y)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function c(B,Y){B=B||[],Y=Y||{};try{return new Blob(B,Y)}catch(ae){if(ae.name!=="TypeError")throw ae;for(var U=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,J=new U,ie=0;ie<B.length;ie+=1)J.append(B[ie]);return J.getBlob(Y.type)}}typeof Promise>"u"&&n(3);var d=Promise;function h(B,Y){Y&&B.then(function(U){Y(null,U)},function(U){Y(U)})}function f(B,Y,U){typeof Y=="function"&&B.then(Y),typeof U=="function"&&B.catch(U)}function m(B){return typeof B!="string"&&(console.warn(B+" used as a key, but it is not a string."),B=String(B)),B}function p(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var g="local-forage-detect-blob-support",v=void 0,_={},C=Object.prototype.toString,y="readonly",S="readwrite";function E(B){for(var Y=B.length,U=new ArrayBuffer(Y),J=new Uint8Array(U),ie=0;ie<Y;ie++)J[ie]=B.charCodeAt(ie);return U}function w(B){return new d(function(Y){var U=B.transaction(g,S),J=c([""]);U.objectStore(g).put(J,"key"),U.onabort=function(ie){ie.preventDefault(),ie.stopPropagation(),Y(!1)},U.oncomplete=function(){var ie=navigator.userAgent.match(/Chrome\/(\d+)/),ae=navigator.userAgent.match(/Edge\//);Y(ae||!ie||parseInt(ie[1],10)>=43)}}).catch(function(){return!1})}function R(B){return typeof v=="boolean"?d.resolve(v):w(B).then(function(Y){return v=Y,v})}function D(B){var Y=_[B.name],U={};U.promise=new d(function(J,ie){U.resolve=J,U.reject=ie}),Y.deferredOperations.push(U),Y.dbReady?Y.dbReady=Y.dbReady.then(function(){return U.promise}):Y.dbReady=U.promise}function I(B){var Y=_[B.name],U=Y.deferredOperations.pop();if(U)return U.resolve(),U.promise}function k(B,Y){var U=_[B.name],J=U.deferredOperations.pop();if(J)return J.reject(Y),J.promise}function O(B,Y){return new d(function(U,J){if(_[B.name]=_[B.name]||K(),B.db)if(Y)D(B),B.db.close();else return U(B.db);var ie=[B.name];Y&&ie.push(B.version);var ae=l.open.apply(l,ie);Y&&(ae.onupgradeneeded=function(Ce){var Ue=ae.result;try{Ue.createObjectStore(B.storeName),Ce.oldVersion<=1&&Ue.createObjectStore(g)}catch(rt){if(rt.name==="ConstraintError")console.warn('The database "'+B.name+'" has been upgraded from version '+Ce.oldVersion+" to version "+Ce.newVersion+', but the storage "'+B.storeName+'" already exists.');else throw rt}}),ae.onerror=function(Ce){Ce.preventDefault(),J(ae.error)},ae.onsuccess=function(){var Ce=ae.result;Ce.onversionchange=function(Ue){Ue.target.close()},U(Ce),I(B)}})}function $(B){return O(B,!1)}function N(B){return O(B,!0)}function H(B,Y){if(!B.db)return!0;var U=!B.db.objectStoreNames.contains(B.storeName),J=B.version<B.db.version,ie=B.version>B.db.version;if(J&&(B.version!==Y&&console.warn('The database "'+B.name+`" can't be downgraded from version `+B.db.version+" to version "+B.version+"."),B.version=B.db.version),ie||U){if(U){var ae=B.db.version+1;ae>B.version&&(B.version=ae)}return!0}return!1}function X(B){return new d(function(Y,U){var J=new FileReader;J.onerror=U,J.onloadend=function(ie){var ae=btoa(ie.target.result||"");Y({__local_forage_encoded_blob:!0,data:ae,type:B.type})},J.readAsBinaryString(B)})}function te(B){var Y=E(atob(B.data));return c([Y],{type:B.type})}function z(B){return B&&B.__local_forage_encoded_blob}function A(B){var Y=this,U=Y._initReady().then(function(){var J=_[Y._dbInfo.name];if(J&&J.dbReady)return J.dbReady});return f(U,B,B),U}function T(B){D(B);for(var Y=_[B.name],U=Y.forages,J=0;J<U.length;J++){var ie=U[J];ie._dbInfo.db&&(ie._dbInfo.db.close(),ie._dbInfo.db=null)}return B.db=null,$(B).then(function(ae){return B.db=ae,H(B)?N(B):ae}).then(function(ae){B.db=Y.db=ae;for(var Ce=0;Ce<U.length;Ce++)U[Ce]._dbInfo.db=ae}).catch(function(ae){throw k(B,ae),ae})}function P(B,Y,U,J){J===void 0&&(J=1);try{var ie=B.db.transaction(B.storeName,Y);U(null,ie)}catch(ae){if(J>0&&(!B.db||ae.name==="InvalidStateError"||ae.name==="NotFoundError"))return d.resolve().then(function(){if(!B.db||ae.name==="NotFoundError"&&!B.db.objectStoreNames.contains(B.storeName)&&B.version<=B.db.version)return B.db&&(B.version=B.db.version+1),N(B)}).then(function(){return T(B).then(function(){P(B,Y,U,J-1)})}).catch(U);U(ae)}}function K(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function ee(B){var Y=this,U={db:null};if(B)for(var J in B)U[J]=B[J];var ie=_[U.name];ie||(ie=K(),_[U.name]=ie),ie.forages.push(Y),Y._initReady||(Y._initReady=Y.ready,Y.ready=A);var ae=[];function Ce(){return d.resolve()}for(var Ue=0;Ue<ie.forages.length;Ue++){var rt=ie.forages[Ue];rt!==Y&&ae.push(rt._initReady().catch(Ce))}var Je=ie.forages.slice(0);return d.all(ae).then(function(){return U.db=ie.db,$(U)}).then(function(qe){return U.db=qe,H(U,Y._defaultConfig.version)?N(U):qe}).then(function(qe){U.db=ie.db=qe,Y._dbInfo=U;for(var It=0;It<Je.length;It++){var on=Je[It];on!==Y&&(on._dbInfo.db=U.db,on._dbInfo.version=U.version)}})}function ue(B,Y){var U=this;B=m(B);var J=new d(function(ie,ae){U.ready().then(function(){P(U._dbInfo,y,function(Ce,Ue){if(Ce)return ae(Ce);try{var rt=Ue.objectStore(U._dbInfo.storeName),Je=rt.get(B);Je.onsuccess=function(){var qe=Je.result;qe===void 0&&(qe=null),z(qe)&&(qe=te(qe)),ie(qe)},Je.onerror=function(){ae(Je.error)}}catch(qe){ae(qe)}})}).catch(ae)});return h(J,Y),J}function fe(B,Y){var U=this,J=new d(function(ie,ae){U.ready().then(function(){P(U._dbInfo,y,function(Ce,Ue){if(Ce)return ae(Ce);try{var rt=Ue.objectStore(U._dbInfo.storeName),Je=rt.openCursor(),qe=1;Je.onsuccess=function(){var It=Je.result;if(It){var on=It.value;z(on)&&(on=te(on));var An=B(on,It.key,qe++);An!==void 0?ie(An):It.continue()}else ie()},Je.onerror=function(){ae(Je.error)}}catch(It){ae(It)}})}).catch(ae)});return h(J,Y),J}function Ee(B,Y,U){var J=this;B=m(B);var ie=new d(function(ae,Ce){var Ue;J.ready().then(function(){return Ue=J._dbInfo,C.call(Y)==="[object Blob]"?R(Ue.db).then(function(rt){return rt?Y:X(Y)}):Y}).then(function(rt){P(J._dbInfo,S,function(Je,qe){if(Je)return Ce(Je);try{var It=qe.objectStore(J._dbInfo.storeName);rt===null&&(rt=void 0);var on=It.put(rt,B);qe.oncomplete=function(){rt===void 0&&(rt=null),ae(rt)},qe.onabort=qe.onerror=function(){var An=on.error?on.error:on.transaction.error;Ce(An)}}catch(An){Ce(An)}})}).catch(Ce)});return h(ie,U),ie}function Q(B,Y){var U=this;B=m(B);var J=new d(function(ie,ae){U.ready().then(function(){P(U._dbInfo,S,function(Ce,Ue){if(Ce)return ae(Ce);try{var rt=Ue.objectStore(U._dbInfo.storeName),Je=rt.delete(B);Ue.oncomplete=function(){ie()},Ue.onerror=function(){ae(Je.error)},Ue.onabort=function(){var qe=Je.error?Je.error:Je.transaction.error;ae(qe)}}catch(qe){ae(qe)}})}).catch(ae)});return h(J,Y),J}function re(B){var Y=this,U=new d(function(J,ie){Y.ready().then(function(){P(Y._dbInfo,S,function(ae,Ce){if(ae)return ie(ae);try{var Ue=Ce.objectStore(Y._dbInfo.storeName),rt=Ue.clear();Ce.oncomplete=function(){J()},Ce.onabort=Ce.onerror=function(){var Je=rt.error?rt.error:rt.transaction.error;ie(Je)}}catch(Je){ie(Je)}})}).catch(ie)});return h(U,B),U}function Se(B){var Y=this,U=new d(function(J,ie){Y.ready().then(function(){P(Y._dbInfo,y,function(ae,Ce){if(ae)return ie(ae);try{var Ue=Ce.objectStore(Y._dbInfo.storeName),rt=Ue.count();rt.onsuccess=function(){J(rt.result)},rt.onerror=function(){ie(rt.error)}}catch(Je){ie(Je)}})}).catch(ie)});return h(U,B),U}function _e(B,Y){var U=this,J=new d(function(ie,ae){if(B<0){ie(null);return}U.ready().then(function(){P(U._dbInfo,y,function(Ce,Ue){if(Ce)return ae(Ce);try{var rt=Ue.objectStore(U._dbInfo.storeName),Je=!1,qe=rt.openKeyCursor();qe.onsuccess=function(){var It=qe.result;if(!It){ie(null);return}B===0||Je?ie(It.key):(Je=!0,It.advance(B))},qe.onerror=function(){ae(qe.error)}}catch(It){ae(It)}})}).catch(ae)});return h(J,Y),J}function He(B){var Y=this,U=new d(function(J,ie){Y.ready().then(function(){P(Y._dbInfo,y,function(ae,Ce){if(ae)return ie(ae);try{var Ue=Ce.objectStore(Y._dbInfo.storeName),rt=Ue.openKeyCursor(),Je=[];rt.onsuccess=function(){var qe=rt.result;if(!qe){J(Je);return}Je.push(qe.key),qe.continue()},rt.onerror=function(){ie(rt.error)}}catch(qe){ie(qe)}})}).catch(ie)});return h(U,B),U}function Ne(B,Y){Y=p.apply(this,arguments);var U=this.config();B=typeof B!="function"&&B||{},B.name||(B.name=B.name||U.name,B.storeName=B.storeName||U.storeName);var J=this,ie;if(!B.name)ie=d.reject("Invalid arguments");else{var ae=B.name===U.name&&J._dbInfo.db,Ce=ae?d.resolve(J._dbInfo.db):$(B).then(function(Ue){var rt=_[B.name],Je=rt.forages;rt.db=Ue;for(var qe=0;qe<Je.length;qe++)Je[qe]._dbInfo.db=Ue;return Ue});B.storeName?ie=Ce.then(function(Ue){if(Ue.objectStoreNames.contains(B.storeName)){var rt=Ue.version+1;D(B);var Je=_[B.name],qe=Je.forages;Ue.close();for(var It=0;It<qe.length;It++){var on=qe[It];on._dbInfo.db=null,on._dbInfo.version=rt}var An=new d(function(In,wr){var xn=l.open(B.name,rt);xn.onerror=function(gi){var Ii=xn.result;Ii.close(),wr(gi)},xn.onupgradeneeded=function(){var gi=xn.result;gi.deleteObjectStore(B.storeName)},xn.onsuccess=function(){var gi=xn.result;gi.close(),In(gi)}});return An.then(function(In){Je.db=In;for(var wr=0;wr<qe.length;wr++){var xn=qe[wr];xn._dbInfo.db=In,I(xn._dbInfo)}}).catch(function(In){throw(k(B,In)||d.resolve()).catch(function(){}),In})}}):ie=Ce.then(function(Ue){D(B);var rt=_[B.name],Je=rt.forages;Ue.close();for(var qe=0;qe<Je.length;qe++){var It=Je[qe];It._dbInfo.db=null}var on=new d(function(An,In){var wr=l.deleteDatabase(B.name);wr.onerror=function(){var xn=wr.result;xn&&xn.close(),In(wr.error)},wr.onblocked=function(){console.warn('dropInstance blocked for database "'+B.name+'" until all open connections are closed')},wr.onsuccess=function(){var xn=wr.result;xn&&xn.close(),An(xn)}});return on.then(function(An){rt.db=An;for(var In=0;In<Je.length;In++){var wr=Je[In];I(wr._dbInfo)}}).catch(function(An){throw(k(B,An)||d.resolve()).catch(function(){}),An})})}return h(ie,Y),ie}var we={_driver:"asyncStorage",_initStorage:ee,_support:u(),iterate:fe,getItem:ue,setItem:Ee,removeItem:Q,clear:re,length:Se,key:_e,keys:He,dropInstance:Ne};function Me(){return typeof openDatabase=="function"}var mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",vt="~~local_forage_type~",ft=/^~~local_forage_type~([^~]+)~/,et="__lfsc__:",ve=et.length,Pe="arbf",Ye="blob",bt="si08",Jt="ui08",Ht="uic8",Zt="si16",kt="si32",gn="ur16",vn="ui32",Xt="fl32",Vt="fl64",jt=ve+Pe.length,Nt=Object.prototype.toString;function Bn(B){var Y=B.length*.75,U=B.length,J,ie=0,ae,Ce,Ue,rt;B[B.length-1]==="="&&(Y--,B[B.length-2]==="="&&Y--);var Je=new ArrayBuffer(Y),qe=new Uint8Array(Je);for(J=0;J<U;J+=4)ae=mt.indexOf(B[J]),Ce=mt.indexOf(B[J+1]),Ue=mt.indexOf(B[J+2]),rt=mt.indexOf(B[J+3]),qe[ie++]=ae<<2|Ce>>4,qe[ie++]=(Ce&15)<<4|Ue>>2,qe[ie++]=(Ue&3)<<6|rt&63;return Je}function W(B){var Y=new Uint8Array(B),U="",J;for(J=0;J<Y.length;J+=3)U+=mt[Y[J]>>2],U+=mt[(Y[J]&3)<<4|Y[J+1]>>4],U+=mt[(Y[J+1]&15)<<2|Y[J+2]>>6],U+=mt[Y[J+2]&63];return Y.length%3===2?U=U.substring(0,U.length-1)+"=":Y.length%3===1&&(U=U.substring(0,U.length-2)+"=="),U}function j(B,Y){var U="";if(B&&(U=Nt.call(B)),B&&(U==="[object ArrayBuffer]"||B.buffer&&Nt.call(B.buffer)==="[object ArrayBuffer]")){var J,ie=et;B instanceof ArrayBuffer?(J=B,ie+=Pe):(J=B.buffer,U==="[object Int8Array]"?ie+=bt:U==="[object Uint8Array]"?ie+=Jt:U==="[object Uint8ClampedArray]"?ie+=Ht:U==="[object Int16Array]"?ie+=Zt:U==="[object Uint16Array]"?ie+=gn:U==="[object Int32Array]"?ie+=kt:U==="[object Uint32Array]"?ie+=vn:U==="[object Float32Array]"?ie+=Xt:U==="[object Float64Array]"?ie+=Vt:Y(new Error("Failed to get type for BinaryArray"))),Y(ie+W(J))}else if(U==="[object Blob]"){var ae=new FileReader;ae.onload=function(){var Ce=vt+B.type+"~"+W(this.result);Y(et+Ye+Ce)},ae.readAsArrayBuffer(B)}else try{Y(JSON.stringify(B))}catch(Ce){console.error("Couldn't convert value into a JSON string: ",B),Y(null,Ce)}}function q(B){if(B.substring(0,ve)!==et)return JSON.parse(B);var Y=B.substring(jt),U=B.substring(ve,jt),J;if(U===Ye&&ft.test(Y)){var ie=Y.match(ft);J=ie[1],Y=Y.substring(ie[0].length)}var ae=Bn(Y);switch(U){case Pe:return ae;case Ye:return c([ae],{type:J});case bt:return new Int8Array(ae);case Jt:return new Uint8Array(ae);case Ht:return new Uint8ClampedArray(ae);case Zt:return new Int16Array(ae);case gn:return new Uint16Array(ae);case kt:return new Int32Array(ae);case vn:return new Uint32Array(ae);case Xt:return new Float32Array(ae);case Vt:return new Float64Array(ae);default:throw new Error("Unkown type: "+U)}}var pe={serialize:j,deserialize:q,stringToBuffer:Bn,bufferToString:W};function Ae(B,Y,U,J){B.executeSql("CREATE TABLE IF NOT EXISTS "+Y.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],U,J)}function We(B){var Y=this,U={db:null};if(B)for(var J in B)U[J]=typeof B[J]!="string"?B[J].toString():B[J];var ie=new d(function(ae,Ce){try{U.db=openDatabase(U.name,String(U.version),U.description,U.size)}catch(Ue){return Ce(Ue)}U.db.transaction(function(Ue){Ae(Ue,U,function(){Y._dbInfo=U,ae()},function(rt,Je){Ce(Je)})},Ce)});return U.serializer=pe,ie}function Re(B,Y,U,J,ie,ae){B.executeSql(U,J,ie,function(Ce,Ue){Ue.code===Ue.SYNTAX_ERR?Ce.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Y.storeName],function(rt,Je){Je.rows.length?ae(rt,Ue):Ae(rt,Y,function(){rt.executeSql(U,J,ie,ae)},ae)},ae):ae(Ce,Ue)},ae)}function Te(B,Y){var U=this;B=m(B);var J=new d(function(ie,ae){U.ready().then(function(){var Ce=U._dbInfo;Ce.db.transaction(function(Ue){Re(Ue,Ce,"SELECT * FROM "+Ce.storeName+" WHERE key = ? LIMIT 1",[B],function(rt,Je){var qe=Je.rows.length?Je.rows.item(0).value:null;qe&&(qe=Ce.serializer.deserialize(qe)),ie(qe)},function(rt,Je){ae(Je)})})}).catch(ae)});return h(J,Y),J}function G(B,Y){var U=this,J=new d(function(ie,ae){U.ready().then(function(){var Ce=U._dbInfo;Ce.db.transaction(function(Ue){Re(Ue,Ce,"SELECT * FROM "+Ce.storeName,[],function(rt,Je){for(var qe=Je.rows,It=qe.length,on=0;on<It;on++){var An=qe.item(on),In=An.value;if(In&&(In=Ce.serializer.deserialize(In)),In=B(In,An.key,on+1),In!==void 0){ie(In);return}}ie()},function(rt,Je){ae(Je)})})}).catch(ae)});return h(J,Y),J}function be(B,Y,U,J){var ie=this;B=m(B);var ae=new d(function(Ce,Ue){ie.ready().then(function(){Y===void 0&&(Y=null);var rt=Y,Je=ie._dbInfo;Je.serializer.serialize(Y,function(qe,It){It?Ue(It):Je.db.transaction(function(on){Re(on,Je,"INSERT OR REPLACE INTO "+Je.storeName+" (key, value) VALUES (?, ?)",[B,qe],function(){Ce(rt)},function(An,In){Ue(In)})},function(on){if(on.code===on.QUOTA_ERR){if(J>0){Ce(be.apply(ie,[B,rt,U,J-1]));return}Ue(on)}})})}).catch(Ue)});return h(ae,U),ae}function xe(B,Y,U){return be.apply(this,[B,Y,U,1])}function ye(B,Y){var U=this;B=m(B);var J=new d(function(ie,ae){U.ready().then(function(){var Ce=U._dbInfo;Ce.db.transaction(function(Ue){Re(Ue,Ce,"DELETE FROM "+Ce.storeName+" WHERE key = ?",[B],function(){ie()},function(rt,Je){ae(Je)})})}).catch(ae)});return h(J,Y),J}function st(B){var Y=this,U=new d(function(J,ie){Y.ready().then(function(){var ae=Y._dbInfo;ae.db.transaction(function(Ce){Re(Ce,ae,"DELETE FROM "+ae.storeName,[],function(){J()},function(Ue,rt){ie(rt)})})}).catch(ie)});return h(U,B),U}function Ge(B){var Y=this,U=new d(function(J,ie){Y.ready().then(function(){var ae=Y._dbInfo;ae.db.transaction(function(Ce){Re(Ce,ae,"SELECT COUNT(key) as c FROM "+ae.storeName,[],function(Ue,rt){var Je=rt.rows.item(0).c;J(Je)},function(Ue,rt){ie(rt)})})}).catch(ie)});return h(U,B),U}function lt(B,Y){var U=this,J=new d(function(ie,ae){U.ready().then(function(){var Ce=U._dbInfo;Ce.db.transaction(function(Ue){Re(Ue,Ce,"SELECT key FROM "+Ce.storeName+" WHERE id = ? LIMIT 1",[B+1],function(rt,Je){var qe=Je.rows.length?Je.rows.item(0).key:null;ie(qe)},function(rt,Je){ae(Je)})})}).catch(ae)});return h(J,Y),J}function de(B){var Y=this,U=new d(function(J,ie){Y.ready().then(function(){var ae=Y._dbInfo;ae.db.transaction(function(Ce){Re(Ce,ae,"SELECT key FROM "+ae.storeName,[],function(Ue,rt){for(var Je=[],qe=0;qe<rt.rows.length;qe++)Je.push(rt.rows.item(qe).key);J(Je)},function(Ue,rt){ie(rt)})})}).catch(ie)});return h(U,B),U}function Le(B){return new d(function(Y,U){B.transaction(function(J){J.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(ie,ae){for(var Ce=[],Ue=0;Ue<ae.rows.length;Ue++)Ce.push(ae.rows.item(Ue).name);Y({db:B,storeNames:Ce})},function(ie,ae){U(ae)})},function(J){U(J)})})}function Ve(B,Y){Y=p.apply(this,arguments);var U=this.config();B=typeof B!="function"&&B||{},B.name||(B.name=B.name||U.name,B.storeName=B.storeName||U.storeName);var J=this,ie;return B.name?ie=new d(function(ae){var Ce;B.name===U.name?Ce=J._dbInfo.db:Ce=openDatabase(B.name,"","",0),B.storeName?ae({db:Ce,storeNames:[B.storeName]}):ae(Le(Ce))}).then(function(ae){return new d(function(Ce,Ue){ae.db.transaction(function(rt){function Je(An){return new d(function(In,wr){rt.executeSql("DROP TABLE IF EXISTS "+An,[],function(){In()},function(xn,gi){wr(gi)})})}for(var qe=[],It=0,on=ae.storeNames.length;It<on;It++)qe.push(Je(ae.storeNames[It]));d.all(qe).then(function(){Ce()}).catch(function(An){Ue(An)})},function(rt){Ue(rt)})})}):ie=d.reject("Invalid arguments"),h(ie,Y),ie}var Ze={_driver:"webSQLStorage",_initStorage:We,_support:Me(),iterate:G,getItem:Te,setItem:xe,removeItem:ye,clear:st,length:Ge,key:lt,keys:de,dropInstance:Ve};function Dt(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Mt(B,Y){var U=B.name+"/";return B.storeName!==Y.storeName&&(U+=B.storeName+"/"),U}function pn(){var B="_localforage_support_test";try{return localStorage.setItem(B,!0),localStorage.removeItem(B),!1}catch{return!0}}function Yn(){return!pn()||localStorage.length>0}function Hn(B){var Y=this,U={};if(B)for(var J in B)U[J]=B[J];return U.keyPrefix=Mt(B,Y._defaultConfig),Yn()?(Y._dbInfo=U,U.serializer=pe,d.resolve()):d.reject()}function ht(B){var Y=this,U=Y.ready().then(function(){for(var J=Y._dbInfo.keyPrefix,ie=localStorage.length-1;ie>=0;ie--){var ae=localStorage.key(ie);ae.indexOf(J)===0&&localStorage.removeItem(ae)}});return h(U,B),U}function Dn(B,Y){var U=this;B=m(B);var J=U.ready().then(function(){var ie=U._dbInfo,ae=localStorage.getItem(ie.keyPrefix+B);return ae&&(ae=ie.serializer.deserialize(ae)),ae});return h(J,Y),J}function Gn(B,Y){var U=this,J=U.ready().then(function(){for(var ie=U._dbInfo,ae=ie.keyPrefix,Ce=ae.length,Ue=localStorage.length,rt=1,Je=0;Je<Ue;Je++){var qe=localStorage.key(Je);if(qe.indexOf(ae)===0){var It=localStorage.getItem(qe);if(It&&(It=ie.serializer.deserialize(It)),It=B(It,qe.substring(Ce),rt++),It!==void 0)return It}}});return h(J,Y),J}function zt(B,Y){var U=this,J=U.ready().then(function(){var ie=U._dbInfo,ae;try{ae=localStorage.key(B)}catch{ae=null}return ae&&(ae=ae.substring(ie.keyPrefix.length)),ae});return h(J,Y),J}function Ke(B){var Y=this,U=Y.ready().then(function(){for(var J=Y._dbInfo,ie=localStorage.length,ae=[],Ce=0;Ce<ie;Ce++){var Ue=localStorage.key(Ce);Ue.indexOf(J.keyPrefix)===0&&ae.push(Ue.substring(J.keyPrefix.length))}return ae});return h(U,B),U}function $e(B){var Y=this,U=Y.keys().then(function(J){return J.length});return h(U,B),U}function hn(B,Y){var U=this;B=m(B);var J=U.ready().then(function(){var ie=U._dbInfo;localStorage.removeItem(ie.keyPrefix+B)});return h(J,Y),J}function an(B,Y,U){var J=this;B=m(B);var ie=J.ready().then(function(){Y===void 0&&(Y=null);var ae=Y;return new d(function(Ce,Ue){var rt=J._dbInfo;rt.serializer.serialize(Y,function(Je,qe){if(qe)Ue(qe);else try{localStorage.setItem(rt.keyPrefix+B,Je),Ce(ae)}catch(It){(It.name==="QuotaExceededError"||It.name==="NS_ERROR_DOM_QUOTA_REACHED")&&Ue(It),Ue(It)}})})});return h(ie,U),ie}function Qn(B,Y){if(Y=p.apply(this,arguments),B=typeof B!="function"&&B||{},!B.name){var U=this.config();B.name=B.name||U.name,B.storeName=B.storeName||U.storeName}var J=this,ie;return B.name?ie=new d(function(ae){B.storeName?ae(Mt(B,J._defaultConfig)):ae(B.name+"/")}).then(function(ae){for(var Ce=localStorage.length-1;Ce>=0;Ce--){var Ue=localStorage.key(Ce);Ue.indexOf(ae)===0&&localStorage.removeItem(Ue)}}):ie=d.reject("Invalid arguments"),h(ie,Y),ie}var vr={_driver:"localStorageWrapper",_initStorage:Hn,_support:Dt(),iterate:Gn,getItem:Dn,setItem:an,removeItem:hn,clear:ht,length:$e,key:zt,keys:Ke,dropInstance:Qn},mi=function(B,Y){return B===Y||typeof B=="number"&&typeof Y=="number"&&isNaN(B)&&isNaN(Y)},wo=function(B,Y){for(var U=B.length,J=0;J<U;){if(mi(B[J],Y))return!0;J++}return!1},Fi=Array.isArray||function(B){return Object.prototype.toString.call(B)==="[object Array]"},pi={},Qr={},Ui={INDEXEDDB:we,WEBSQL:Ze,LOCALSTORAGE:vr},_s=[Ui.INDEXEDDB._driver,Ui.WEBSQL._driver,Ui.LOCALSTORAGE._driver],zr=["dropInstance"],Go=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(zr),Ro={description:"",driver:_s.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Hi(B,Y){B[Y]=function(){var U=arguments;return B.ready().then(function(){return B[Y].apply(B,U)})}}function Di(){for(var B=1;B<arguments.length;B++){var Y=arguments[B];if(Y)for(var U in Y)Y.hasOwnProperty(U)&&(Fi(Y[U])?arguments[0][U]=Y[U].slice():arguments[0][U]=Y[U])}return arguments[0]}var Ko=function(){function B(Y){s(this,B);for(var U in Ui)if(Ui.hasOwnProperty(U)){var J=Ui[U],ie=J._driver;this[U]=ie,pi[ie]||this.defineDriver(J)}this._defaultConfig=Di({},Ro),this._config=Di({},this._defaultConfig,Y),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return B.prototype.config=function(Y){if((typeof Y>"u"?"undefined":o(Y))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var U in Y){if(U==="storeName"&&(Y[U]=Y[U].replace(/\W/g,"_")),U==="version"&&typeof Y[U]!="number")return new Error("Database version must be a number.");this._config[U]=Y[U]}return"driver"in Y&&Y.driver?this.setDriver(this._config.driver):!0}else return typeof Y=="string"?this._config[Y]:this._config},B.prototype.defineDriver=function(Y,U,J){var ie=new d(function(ae,Ce){try{var Ue=Y._driver,rt=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!Y._driver){Ce(rt);return}for(var Je=Go.concat("_initStorage"),qe=0,It=Je.length;qe<It;qe++){var on=Je[qe],An=!wo(zr,on);if((An||Y[on])&&typeof Y[on]!="function"){Ce(rt);return}}var In=function(){for(var xn=function(T1){return function(){var $1=new Error("Method "+T1+" is not implemented by the current driver"),k1=d.reject($1);return h(k1,arguments[arguments.length-1]),k1}},gi=0,Ii=zr.length;gi<Ii;gi++){var Kl=zr[gi];Y[Kl]||(Y[Kl]=xn(Kl))}};In();var wr=function(xn){pi[Ue]&&console.info("Redefining LocalForage driver: "+Ue),pi[Ue]=Y,Qr[Ue]=xn,ae()};"_support"in Y?Y._support&&typeof Y._support=="function"?Y._support().then(wr,Ce):wr(!!Y._support):wr(!0)}catch(xn){Ce(xn)}});return f(ie,U,J),ie},B.prototype.driver=function(){return this._driver||null},B.prototype.getDriver=function(Y,U,J){var ie=pi[Y]?d.resolve(pi[Y]):d.reject(new Error("Driver not found."));return f(ie,U,J),ie},B.prototype.getSerializer=function(Y){var U=d.resolve(pe);return f(U,Y),U},B.prototype.ready=function(Y){var U=this,J=U._driverSet.then(function(){return U._ready===null&&(U._ready=U._initDriver()),U._ready});return f(J,Y,Y),J},B.prototype.setDriver=function(Y,U,J){var ie=this;Fi(Y)||(Y=[Y]);var ae=this._getSupportedDrivers(Y);function Ce(){ie._config.driver=ie.driver()}function Ue(qe){return ie._extend(qe),Ce(),ie._ready=ie._initStorage(ie._config),ie._ready}function rt(qe){return function(){var It=0;function on(){for(;It<qe.length;){var An=qe[It];return It++,ie._dbInfo=null,ie._ready=null,ie.getDriver(An).then(Ue).catch(on)}Ce();var In=new Error("No available storage method found.");return ie._driverSet=d.reject(In),ie._driverSet}return on()}}var Je=this._driverSet!==null?this._driverSet.catch(function(){return d.resolve()}):d.resolve();return this._driverSet=Je.then(function(){var qe=ae[0];return ie._dbInfo=null,ie._ready=null,ie.getDriver(qe).then(function(It){ie._driver=It._driver,Ce(),ie._wrapLibraryMethodsWithReady(),ie._initDriver=rt(ae)})}).catch(function(){Ce();var qe=new Error("No available storage method found.");return ie._driverSet=d.reject(qe),ie._driverSet}),f(this._driverSet,U,J),this._driverSet},B.prototype.supports=function(Y){return!!Qr[Y]},B.prototype._extend=function(Y){Di(this,Y)},B.prototype._getSupportedDrivers=function(Y){for(var U=[],J=0,ie=Y.length;J<ie;J++){var ae=Y[J];this.supports(ae)&&U.push(ae)}return U},B.prototype._wrapLibraryMethodsWithReady=function(){for(var Y=0,U=Go.length;Y<U;Y++)Hi(this,Go[Y])},B.prototype.createInstance=function(Y){return new B(Y)},B}(),Zo=new Ko;r.exports=Zo},{3:3}]},{},[4])(4)})})(cP);var bwe=cP.exports;const Ql=bL(bwe);let Cwe=class{getItem(e){return Ql.getItem(e)}setItem(e,n){return Ql.setItem(e,n)}removeItem(e){return Ql.removeItem(e)}clear(){return Ql.clear()}key(e){return Ql.key(e)}keys(){return Ql.keys()}iterate(e){return Ql.iterate(e)}};var ywe=Object.defineProperty,Swe=Object.getOwnPropertyDescriptor,Ewe=(t,e,n,r)=>{for(var i=r>1?void 0:r?Swe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&ywe(e,n,i),i},wwe=(t,e)=>(n,r)=>e(n,r,t);let Qv=class{constructor(e){Cn(this,"visible$",new Qt),Cn(this,"componentKey$",new Qt),this._componentManager=e}set(e,n){return this._componentManager.register(e,n),this.componentKey$.next(e),Be(()=>{this._componentManager.delete(e),this.visible$.complete(),this.componentKey$.complete()})}open(){this.visible$.next(!0)}close(){this.visible$.next(!1)}};Qv=Ewe([wwe(0,ne(Pa))],Qv);var Rwe=Object.defineProperty,Dwe=Object.getOwnPropertyDescriptor,Iwe=(t,e,n,r)=>{for(var i=r>1?void 0:r?Dwe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Rwe(e,n,i),i},tD=(t,e)=>(n,r)=>e(n,r,t);const xwe="ui",Mwe={};var Zm;let Jv=(Zm=class extends S1{constructor(t={},e,n){super(xwe),Cn(this,"_config"),this._injector=e,this._localeService=n,this._config={...Mwe,...t},this._localeService.load({zhCN:WEe})}onStarting(t){this._initDependencies(t)}onReady(){this._initUI()}_initDependencies(t){[[Pa],[dCe],[j6],[aP],[H9],[Xl,{useClass:Pv}],[SL,{useClass:bCe}],[I1,{useClass:Bv}],[tf,{useClass:NEe}],[D4,{useClass:qEe,lazy:!0}],[sP,{useClass:nwe,lazy:!0}],[oP,{useClass:ewe,lazy:!0}],[R4,{useClass:JEe,lazy:!0}],[C0,{useClass:swe,lazy:!0}],[LL,{useClass:Qv,lazy:!0}],[w4,{useClass:twe,lazy:!0}],[iM,{useClass:Cwe,lazy:!0}],[ZEe,{useClass:qv}],[YC,{useClass:Hv}],[U6,{useClass:Zv}],[k3],[N3],[L3]].forEach(e=>t.add(e))}_initUI(){Promise.resolve().then(()=>this._injector.get(U6).bootstrapWorkbench(this._config))}},Cn(Zm,"type",dr.Univer),Zm);Jv=Iwe([tD(1,ne(Tn)),tD(2,ne(mn))],Jv);function C2(t){return t.length===0?t:t.replace(/^\s+|\s+$/gm,"")}function Owe(t,e=""){var n;let r=((n=t==null?void 0:t.style)==null?void 0:n.cssText)??"";if(r+=e,r.length===0)return{};const i=r.split(";"),o={},s={t:"",r:"",b:"",l:""};return i.forEach(a=>{a=a.toLowerCase();const l=C2(a.substr(0,a.indexOf(":"))),u=C2(a.substr(a.indexOf(":")+1));if(l==="font-weight")u==="bold"?o.bl=1:o.bl=0;else if(l==="font-style")u==="italic"?o.it=1:o.it=0;else if(l==="font-family")o.ff=u;else if(l==="font-size"){let c=parseInt(u);r.indexOf("vertical-align")>-1&&(r.indexOf("sub")>-1||r.indexOf("sup")>-1)&&(c*=2),u.indexOf("px")!==-1&&(c=vfe(parseInt(u))),o.fs=c}else l==="color"?o.cl={rgb:u}:l==="background"||l==="background-color"?o.bg={rgb:u}:l==="text-decoration-line"?u==="underline"?(o.ul||(o.ul={s:1}),o.ul.s=1):u==="line-through"?(o.st||(o.st={s:1}),o.st.s=1):u==="overline"&&(o.ol||(o.ol={s:1}),o.ol.s=1):l==="text-decoration-color"?(o.hasOwnProperty("ul")&&(o.ul||(o.ul={s:1,cl:{rgb:u}}),o.ul.cl={rgb:u}),o.hasOwnProperty("st")&&(o.st||(o.st={s:1,cl:{rgb:u}}),o.st.cl={rgb:u}),o.hasOwnProperty("ol")&&(o.ol||(o.ol={s:1,cl:{rgb:u}}),o.ol.cl={rgb:u})):l==="text-decoration-style"?(o.hasOwnProperty("ul")&&(o.ul||(o.ul={s:1,t:Number(u)}),o.ul.t=Number(u)),o.hasOwnProperty("st")&&(o.st||(o.st={s:1,t:Number(u)}),o.st.t=Number(u)),o.hasOwnProperty("ol")&&(o.ol||(o.ol={s:1,t:Number(u)}),o.ol.t=Number(u))):(l==="text-decoration"||l==="univer-strike")&&(o.st={s:1});if(l==="univer-underline"&&(o.ul={s:1}),l==="vertical-align"&&(u==="sub"?o.va=Cr.SUBSCRIPT:u==="super"?o.va=Cr.SUPERSCRIPT:u==="top"?o.vt=1:u==="middle"?o.vt=2:u==="bottom"?o.vt=3:o.va=Cr.NORMAL),l==="transform"){const c=u.split(")"),d=c.findIndex(h=>h.includes("rotate"));if(d>-1){const h=c[d].match(/\d+/g);let f=0,m=0;h!=null&&h.length&&(f=+h[0]),t!=null&&t.dataset.vertical&&(m=+t.dataset.vertical),o.tr={a:f,v:m}}}if(l==="text-align"&&(u==="left"?o.ht=1:u==="center"?o.ht=2:u==="right"?o.ht=3:u==="justify"?o.ht=4:o.ht=0),l==="overflow-wrap"||l==="word-wrap"?u==="break-word"&&(o.tb=3):l==="text-overflow"?u==="clip"&&(o.tb=2):l==="text-break"&&u==="overflow"&&(o.tb=1),l==="border-color"){const c=nD(u,")");if(o.bd)for(const d in c)o.bd[d].cl.rgb=c[d];else{o.bd={b:{cl:{rgb:"#000"},s:0},t:{cl:{rgb:"#000"},s:0},l:{cl:{rgb:"#000"},s:0},r:{cl:{rgb:"#000"},s:0}};for(const d in c)o.bd[d].cl.rgb=c[d]}}if(l==="border-width"||l==="border-style"){const c=nD(u," ");for(const d in c)s[d]+=` ${c[d]}`;o.bd?(o.bd.b.s=za(s.b),o.bd.t.s=za(s.t),o.bd.l.s=za(s.l),o.bd.r.s=za(s.r)):o.bd={b:{cl:{rgb:"#000"},s:za(s.b)},t:{cl:{rgb:"#000"},s:za(s.t)},l:{cl:{rgb:"#000"},s:za(s.l)},r:{cl:{rgb:"#000"},s:za(s.r)}}}if(l==="border-bottom"||l==="border-top"||l==="border-left"||l==="border-right"||l==="border"){o.bd||(o.bd={});const c=u.split(" "),d=`${c[0]} ${c[1]}`;c.splice(0,2);const h={cl:{rgb:c.join("")},s:za(d)};l==="border-bottom"?o.bd.b=u==="none"?null:h:l==="border-top"?o.bd.t=u==="none"?null:h:l==="border-left"?o.bd.l=u==="none"?null:h:l==="border-right"?o.bd.r=u==="none"?null:h:l==="border"&&(o.bd={r:u==="none"?null:h,t:u==="none"?null:h,b:u==="none"?null:h,l:u==="none"?null:h})}}),o}function nD(t,e){let n;e===" "?n=t.trim().split(e):n=t.trim().split(e).slice(0,-1),n.forEach(i=>`${i.trim()})`);let r={};return n.length===1?r={t:n[0],r:n[0],b:n[0],l:n[0]}:n.length===2?r={t:n[0],r:n[1],b:n[0],l:n[1]}:n.length===3?r={t:n[0],r:n[1],b:n[2],l:n[1]}:n.length===4&&(r={t:n[0],r:n[1],b:n[2],l:n[3]}),r}var Twe=Object.defineProperty,$we=(t,e,n)=>e in t?Twe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ln=(t,e,n)=>($we(t,typeof e!="symbol"?e+"":e,n),n);function I4(t,e){const n=t.getCurrentUniverDocInstance().getUnitId(),r=e.getRenderById(n);if(r==null)return;const{mainComponent:i,scene:o,engine:s}=r;return{document:i,scene:o,engine:s}}function kwe(t,e){const n=e.getRenderById(t);if(n==null)return;const{mainComponent:r,scene:i,engine:o}=n;return{document:r,scene:i,engine:o}}var e_=(t=>(t.MAIN="__Document_Render_Main__",t))(e_||{}),Z2=(t=>(t.VIEW_MAIN="viewMain",t.VIEW_TOP="viewTop",t.VIEW_LEFT="viewLeft",t.VIEW_LEFT_TOP="viewLeftTop",t))(Z2||{});const t_=0,Awe=2,Nwe=10,dP={id:"doc.operation.set-selections",type:se.OPERATION,handler:(t,e)=>!0};var Lwe=Object.defineProperty,Pwe=Object.getOwnPropertyDescriptor,Bwe=(t,e,n,r)=>{for(var i=r>1?void 0:r?Pwe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Lwe(e,n,i),i},rD=(t,e)=>(n,r)=>e(n,r,t);function iD(t){const{startOffset:e,endOffset:n,collapsed:r}=t;return{startOffset:e,endOffset:n,collapsed:r}}let gr=class extends E1{constructor(t,e){super(),ln(this,"_currentSelection",null),ln(this,"_textSelectionInfo",new Map),ln(this,"_textSelection$",new rn(null)),ln(this,"textSelection$",this._textSelection$.asObservable()),this._textSelectionRenderManager=t,this._commandService=e,this._syncSelectionFromRenderService()}getCurrentSelection(){return this._currentSelection}getCurrentSelectionInfo(){return this._getTextRanges(this._currentSelection)}dispose(){this._textSelection$.complete()}refreshSelection(){this._currentSelection!=null&&this._refresh(this._currentSelection)}setCurrentSelection(t){this._currentSelection=t,this._refresh(t)}setCurrentSelectionNotRefresh(t){this._currentSelection=t}getSelections(){var t;return(t=this._getTextRanges(this._currentSelection))==null?void 0:t.textRanges}getActiveRange(){const t=this._getTextRanges(this._currentSelection);if(t==null)return;const{textRanges:e,segmentId:n,style:r}=t,i=e.find(d=>d.isActive());if(i==null)return null;const{startOffset:o,endOffset:s,collapsed:a,startNodePosition:l,endNodePosition:u,direction:c}=i;return o==null||s==null?null:{startOffset:o,endOffset:s,collapsed:a,startNodePosition:l,endNodePosition:u,direction:c,segmentId:n,style:r}}add(t){this._currentSelection!=null&&this._addByParam({...this._currentSelection,textRanges:t,segmentId:"",style:N6})}replaceTextRanges(t){this._currentSelection!=null&&(this._textSelectionRenderManager.removeAllTextRanges(),this._textSelectionRenderManager.addTextRanges(t))}_syncSelectionFromRenderService(){this._textSelectionRenderManager.textSelectionInner$.pipe(Ts(this.dispose$)).subscribe(t=>{t!=null&&this._replaceTextRangesWithNoRefresh(t)})}_replaceTextRangesWithNoRefresh(t){if(this._currentSelection==null)return;const e={...this._currentSelection,...t};this._replaceByParam(e),this._textSelection$.next(e);const{unitId:n,subUnitId:r,segmentId:i,style:o,textRanges:s}=e;this._commandService.executeCommand(dP.id,{unitId:n,subUnitId:r,segmentId:i,style:o,ranges:s.map(iD)})}_getTextRanges(t){var e;if(t==null)return;const{unitId:n,subUnitId:r=""}=t;return(e=this._textSelectionInfo.get(n))==null?void 0:e.get(r)}_refresh(t){const e=this._getTextRanges(t);this._textSelectionRenderManager.removeAllTextRanges(),e&&Array.isArray(e.textRanges)&&e.textRanges.length&&this._textSelectionRenderManager.addTextRanges(e.textRanges.map(iD))}_replaceByParam(t){const{unitId:e,subUnitId:n,style:r,segmentId:i,textRanges:o}=t;this._textSelectionInfo.has(e)||this._textSelectionInfo.set(e,new Map),this._textSelectionInfo.get(e).set(n,{textRanges:o,style:r,segmentId:i})}_addByParam(t){const{unitId:e,subUnitId:n,textRanges:r,style:i,segmentId:o}=t;this._textSelectionInfo.has(e)||this._textSelectionInfo.set(e,new Map);const s=this._textSelectionInfo.get(e);s.has(n)?s.get(n).textRanges.push(...r):s.set(n,{textRanges:r,style:i,segmentId:o})}};gr=Bwe([rD(0,Wl),rD(1,le)],gr);function nf(t,e="",n=0){const{startOffset:r,endOffset:i}=t,o=[],s=r-n,a=i-n;return s>0&&o.push({t:"r",len:s,segmentId:e}),o.push({t:"d",len:a-s,line:0,segmentId:e}),o}var Fwe=Object.defineProperty,Uwe=Object.getOwnPropertyDescriptor,Hwe=(t,e,n,r)=>{for(var i=r>1?void 0:r?Uwe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Fwe(e,n,i),i},Vwe=(t,e)=>(n,r)=>e(n,r,t);let v1=class{constructor(e){ln(this,"_currentViewModelUnitId",""),ln(this,"_docViewModelMap",new Map),ln(this,"_currentDocViewModel$",new rn(null)),ln(this,"currentDocViewModel$",this._currentDocViewModel$.asObservable()),this._currentUniverService=e}dispose(){this._currentDocViewModel$.complete(),this._docViewModelMap=new Map}getCurrent(){return this._docViewModelMap.get(this._currentViewModelUnitId)}getViewModel(e){var n;return(n=this._docViewModelMap.get(e))==null?void 0:n.docViewModel}setCurrent(e){var n;const r=this._currentUniverService.getUniverDocInstance(e);if(r==null)throw new Error(`Document data model with id ${e} not found when build view model.`);if(r.getBody()!=null){if(!this._docViewModelMap.has(e)){const i=this._buildDocViewModel(r);this._docViewModelMap.set(e,{unitId:e,docViewModel:i})}if(e===Zr){const i=(n=this._docViewModelMap.get(e))==null?void 0:n.docViewModel;if(i==null)return;i.reset(r)}this._currentViewModelUnitId=e,this._currentDocViewModel$.next(this.getCurrent())}}_buildDocViewModel(e){return new Nu(e)}};v1=Hwe([Vwe(0,oe)],v1);const Kt={id:"doc.mutation.rich-text-editing",type:se.MUTATION,handler:(t,e)=>{const{unitId:n,mutations:r}=e,i=t.get(oe).getUniverDocInstance(n),o=t.get(v1).getViewModel(n);if(i==null||o==null)throw new Error(`DocumentDataModel or documentViewModel not found for unitId: ${n}`);const s=i.apply(r),a=r[0].segmentId,l=i.getSelfOrHeaderFooterModel(a);return o.getSelfOrHeaderFooterViewModel(a).reset(l),{unitId:n,mutations:s}}},JC={id:"doc.command.insert-text",type:se.COMMAND,handler:async(t,e)=>{const n=t.get(At),r=t.get(le),i=t.get(gr),{range:o,segmentId:s,body:a,unitId:l,textRanges:u}=e,{startOffset:c,collapsed:d}=o,h={id:Kt.id,params:{unitId:l,mutations:[]}};d?c>0&&h.params.mutations.push({t:"r",len:c,segmentId:s}):h.params.mutations.push(...nf(o,s)),h.params.mutations.push({t:"i",body:a,len:a.dataStream.length,line:0,segmentId:s});const f=r.syncExecuteCommand(h.id,h.params);return i.replaceTextRanges(u),f?(n.pushUndoRedo({unitID:l,undoMutations:[{id:Kt.id,params:f}],redoMutations:[{id:Kt.id,params:h.params}],undo(){return r.syncExecuteCommand(Kt.id,f),i.replaceTextRanges([o]),!0},redo(){return r.syncExecuteCommand(Kt.id,h.params),i.replaceTextRanges(u),!0}}),!0):!1}};var Sl=(t=>(t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT",t))(Sl||{});const ey={id:"doc.command.delete-text",type:se.COMMAND,handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(gr),{range:o,segmentId:s,unitId:a,direction:l,textRanges:u,len:c=1}=e,{startOffset:d}=o,h={id:Kt.id,params:{unitId:a,mutations:[]}};d>0&&h.params.mutations.push({t:"r",len:l===0?d-c:d,segmentId:s}),h.params.mutations.push({t:"d",len:c,line:0,segmentId:s});const f=n.syncExecuteCommand(h.id,h.params);return i.replaceTextRanges(u),f&&r.pushUndoRedo({unitID:a,undoMutations:[{id:Kt.id,params:f}],redoMutations:[{id:Kt.id,params:h.params}],undo(){return n.syncExecuteCommand(Kt.id,f),i.replaceTextRanges([o]),!0},redo(){return n.syncExecuteCommand(Kt.id,h.params),i.replaceTextRanges(u),!0}}),!1}},hP={id:"doc.command.update-text",type:se.COMMAND,handler:async(t,e)=>{const{range:n,segmentId:r,updateBody:i,coverType:o,unitId:s,textRanges:a}=e,l=t.get(le),u=t.get(At),c=t.get(gr),d={id:Kt.id,params:{unitId:s,mutations:[]}},{startOffset:h,endOffset:f}=n;d.params.mutations.push({t:"r",len:h,segmentId:r}),d.params.mutations.push({t:"r",body:i,len:f-h,segmentId:r,coverType:o});const m=l.syncExecuteCommand(d.id,d.params);return c.replaceTextRanges(a),m?(u.pushUndoRedo({unitID:s,undoMutations:[{id:Kt.id,params:m}],redoMutations:[{id:Kt.id,params:d.params}],undo(){return l.syncExecuteCommand(Kt.id,m),c.replaceTextRanges(a),!0},redo(){return l.syncExecuteCommand(Kt.id,d.params),c.replaceTextRanges(a),!0}}),!0):!1}};function jwe(t,e){const n=[];for(let r=0,i=t.length;r<i;r++)t[r]===en.PARAGRAPH&&n.push({startIndex:r});if(e)for(const r of n)e.bullet&&(r.bullet=De.deepClone(e.bullet)),e.paragraphStyle&&(r.paragraphStyle=De.deepClone(e.paragraphStyle));return n}const ty={id:"doc.command.break-line",type:se.COMMAND,handler:async t=>{var e;const n=t.get(gr),r=t.get(oe),i=t.get(le),o=n.getActiveRange();if(o==null)return!1;const s=r.getCurrentUniverDocInstance(),a=s.getUnitId(),{startOffset:l,segmentId:u,style:c}=o,d=[{startOffset:l+1,endOffset:l+1,style:c}],h=(((e=s.getBody())==null?void 0:e.paragraphs)??[]).find(f=>f.startIndex>=l);return await i.executeCommand(JC.id,{unitId:a,body:{dataStream:en.PARAGRAPH,paragraphs:jwe(en.PARAGRAPH,h)},range:o,textRanges:d,segmentId:u})}},qm={id:b4.id,name:"doc.command.copy",type:se.COMMAND,multi:!0,priority:999,preconditions:t=>t.getContextValue(fi)||t.getContextValue(Dr),handler:async()=>!0},Qm={id:V9.id,name:"doc.command.cut",type:se.COMMAND,multi:!0,priority:999,preconditions:t=>t.getContextValue(fi)||t.getContextValue(Dr),handler:async()=>!0},Jm={id:C4.id,name:"doc.command.paste",type:se.COMMAND,multi:!0,priority:999,preconditions:t=>t.getContextValue(fi)||t.getContextValue(Dr),handler:async()=>!0};var zwe=Object.defineProperty,Wwe=Object.getOwnPropertyDescriptor,Xwe=(t,e,n,r)=>{for(var i=r>1?void 0:r?Wwe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&zwe(e,n,i),i},oD=(t,e)=>(n,r)=>e(n,r,t);let Co=class{constructor(t,e){ln(this,"_currentSkeletonUnitId",""),ln(this,"_docSkeletonMap",new Map),ln(this,"_currentSkeleton$",new rn(null)),ln(this,"currentSkeleton$",this._currentSkeleton$.asObservable()),ln(this,"_currentSkeletonBefore$",new rn(null)),ln(this,"currentSkeletonBefore$",this._currentSkeletonBefore$.asObservable()),this._localeService=t,this._docViewModelManagerService=e,this.initialize()}initialize(){this._docViewModelManagerService.currentDocViewModel$.subscribe(t=>{t!=null&&this._setCurrent(t)})}dispose(){this._currentSkeletonBefore$.complete(),this._currentSkeleton$.complete(),this._docSkeletonMap=new Map}getCurrent(){return this.getSkeletonByUnitId(this._currentSkeletonUnitId)}makeDirtyCurrent(t=!0){this.makeDirty(this._currentSkeletonUnitId,t)}makeDirty(t,e=!0){const n=this.getSkeletonByUnitId(t);n!=null&&(n.dirty=e)}_setCurrent(t){const{unitId:e}=t;if(this._docSkeletonMap.has(e)){const n=this.getSkeletonByUnitId(e);n.skeleton.calculate(),n.dirty=!0}else{const n=this._buildSkeleton(t.docViewModel);n.calculate(),this._docSkeletonMap.set(e,{unitId:e,skeleton:n,dirty:!1})}return this._currentSkeletonUnitId=e,this._currentSkeletonBefore$.next(this.getCurrent()),this._currentSkeleton$.next(this.getCurrent()),this.getCurrent()}getSkeletonByUnitId(t){return this._docSkeletonMap.get(t)}_buildSkeleton(t){return Tv.create(t,this._localeService)}};Co=Xwe([oD(0,ne(mn)),oD(1,ne(v1))],Co);const sD={id:"doc.command.inner-paste",type:se.COMMAND,handler:async(t,e)=>{const{segmentId:n,body:r,textRanges:i}=e,o=t.get(At),s=t.get(le),a=t.get(gr),l=t.get(oe),u=a.getSelections();if(!Array.isArray(u)||u.length===0)return!1;const c=l.getCurrentUniverDocInstance().getUnitId(),d={id:Kt.id,params:{unitId:c,mutations:[]}},h=new Q6;h.reset();for(const m of u){const{startOffset:p,endOffset:g,collapsed:v}=m,_=p-h.cursor;v?d.params.mutations.push({t:"r",len:_,segmentId:n}):d.params.mutations.push(...nf(m,n,h.cursor)),d.params.mutations.push({t:"i",body:r,len:r.dataStream.length,line:0,segmentId:n}),h.reset(),h.moveCursor(g)}const f=s.syncExecuteCommand(d.id,d.params);return a.replaceTextRanges(i),f?(o.pushUndoRedo({unitID:c,undoMutations:[{id:Kt.id,params:f}],redoMutations:[{id:Kt.id,params:d.params}],undo(){return s.syncExecuteCommand(Kt.id,f),a.replaceTextRanges(u),!0},redo(){return s.syncExecuteCommand(Kt.id,d.params),a.replaceTextRanges(i),!0}}),!0):!1}},u5={id:"doc.command.inner-cut",type:se.COMMAND,handler:async(t,e)=>{const{segmentId:n,textRanges:r}=e,i=t.get(At),o=t.get(le),s=t.get(gr),a=t.get(oe),l=s.getSelections();if(!Array.isArray(l)||l.length===0)return!1;const u=a.getCurrentUniverDocInstance().getUnitId(),c=a.getUniverDocInstance(u),d=u3(c.snapshot,n);if(d==null)return!1;const h={id:Kt.id,params:{unitId:u,mutations:[]}},f=new Q6;f.reset();for(const p of l){const{startOffset:g,endOffset:v,collapsed:_}=p,C=g-f.cursor;_?h.params.mutations.push({t:"r",len:C,segmentId:n}):h.params.mutations.push(...Ywe(p,d,n,f.cursor)),f.reset(),f.moveCursor(v)}const m=o.syncExecuteCommand(h.id,h.params);return s.replaceTextRanges(r),m?(i.pushUndoRedo({unitID:u,undoMutations:[{id:Kt.id,params:m}],redoMutations:[{id:Kt.id,params:h.params}],undo(){return o.syncExecuteCommand(Kt.id,m),s.replaceTextRanges(l),!0},redo(){return o.syncExecuteCommand(Kt.id,h.params),s.replaceTextRanges(r),!0}}),!0):!1}};function Ywe(t,e,n="",r=0){const{startOffset:i,endOffset:o}=t,s=[],{paragraphs:a=[]}=e,l=i-r,u=o-r,c=a==null?void 0:a.find(d=>d.startIndex-r>=l&&d.startIndex-r<=u);if(l>0&&s.push({t:"r",len:l,segmentId:n}),c&&c.startIndex-r>l){const d=c.startIndex-r;s.push({t:"d",len:d-l,line:0,segmentId:n}),s.push({t:"r",len:1,segmentId:n}),u>d+1&&s.push({t:"d",len:u-d-1,line:0,segmentId:n})}else s.push({t:"d",len:u-l,line:0,segmentId:n});return s}const ny={id:"doc.command.delete-left",type:se.COMMAND,handler:async t=>{var e;const n=t.get(gr),r=t.get(Co),i=t.get(oe),o=t.get(le),s=n.getActiveRange(),a=n.getSelections(),l=(e=r.getCurrent())==null?void 0:e.skeleton;let u;if(s==null||l==null||a==null)return!1;const c=i.getCurrentUniverDocInstance(),{startOffset:d,collapsed:h,segmentId:f,style:m}=s;if(d===0&&h)return!0;const p=l.findNodeByCharIndex(d),g=Sfe(p),v=Efe(p,c.body);let _=d;const C=l.findNodeByCharIndex(d-1);if(wfe(p)&&C!==p&&(g===!0||v===!0)){const y=Xk(p,c.body);if(y==null)return!1;const S=y==null?void 0:y.startIndex,E={startIndex:0},w=y.paragraphStyle;if(g===!0){const D=y.paragraphStyle;D&&(E.paragraphStyle=D)}else if(v===!0){const D=y.bullet;D&&(E.bullet=D),w!=null&&(E.paragraphStyle={...w},delete E.paragraphStyle.hanging,delete E.paragraphStyle.indentStart)}const R=[{startOffset:_,endOffset:_,style:m}];u=await o.executeCommand(hP.id,{unitId:c.getUnitId(),updateBody:{dataStream:"",paragraphs:[{...E}]},range:{startOffset:S,endOffset:S+1},textRanges:R,coverType:Ei.REPLACE,segmentId:f})}else if(h===!0)if(C.content==="\r")u=await o.executeCommand(ry.id,{direction:Sl.LEFT,range:s});else{_-=C.count;const y=[{startOffset:_,endOffset:_,style:m}];u=await o.executeCommand(ey.id,{unitId:c.getUnitId(),range:s,segmentId:f,direction:Sl.LEFT,len:C.count,textRanges:y})}else{const y=mP(s,a);u=await o.executeCommand(u5.id,{segmentId:f,textRanges:y})}return u}},fP={id:"doc.command.delete-right",type:se.COMMAND,handler:async t=>{var e;const n=t.get(gr),r=t.get(Co),i=t.get(oe),o=t.get(le),s=n.getActiveRange(),a=n.getSelections(),l=(e=r.getCurrent())==null?void 0:e.skeleton;let u;if(s==null||l==null||a==null)return!1;const c=i.getCurrentUniverDocInstance(),{startOffset:d,collapsed:h,segmentId:f,style:m}=s;if(d===c.getBody().dataStream.length-2&&h)return!0;if(h===!0){const p=l.findNodeByCharIndex(d);if(p.content==="\r")u=await o.executeCommand(ry.id,{direction:Sl.RIGHT,range:s});else{const g=[{startOffset:d,endOffset:d,style:m}];u=await o.executeCommand(ey.id,{unitId:c.getUnitId(),range:s,segmentId:f,direction:Sl.RIGHT,textRanges:g,len:p.count})}}else{const p=mP(s,a);u=await o.executeCommand(u5.id,{segmentId:f,textRanges:p})}return u}},ry={id:"doc.command.merge-two-paragraph",type:se.COMMAND,handler:async(t,e)=>{var n,r,i;const o=t.get(gr),s=t.get(oe),a=t.get(le),l=t.get(At),{direction:u,range:c}=e,d=o.getActiveRange(),h=o.getSelections();if(d==null||h==null)return!1;const f=s.getCurrentUniverDocInstance(),{startOffset:m,collapsed:p,segmentId:g,style:v}=d;if(!p)return!1;const _=u===Sl.LEFT?m:m+1,C=(i=(r=(n=f.getBody())==null?void 0:n.paragraphs)==null?void 0:r.find(I=>I.startIndex>=_))==null?void 0:i.startIndex,y=Gwe(f.getBody(),_,C),S=u===Sl.LEFT?m-1:m,E=f.getUnitId(),w=[{startOffset:S,endOffset:S,style:v}],R={id:Kt.id,params:{unitId:E,mutations:[]}};R.params.mutations.push({t:"r",len:u===Sl.LEFT?m-1:m,segmentId:g}),y.dataStream.length&&R.params.mutations.push({t:"i",body:y,len:y.dataStream.length,line:0,segmentId:g}),R.params.mutations.push({t:"r",len:1,segmentId:g}),R.params.mutations.push({t:"d",len:C+1-_,line:0,segmentId:g});const D=a.syncExecuteCommand(R.id,R.params);return o.replaceTextRanges(w),D?(l.pushUndoRedo({unitID:E,undoMutations:[{id:Kt.id,params:D}],redoMutations:[{id:Kt.id,params:R.params}],undo(){return a.syncExecuteCommand(Kt.id,D),o.replaceTextRanges([c]),!0},redo(){return a.syncExecuteCommand(Kt.id,R.params),o.replaceTextRanges(w),!0}}),!0):!1}};function Gwe(t,e,n){const{textRuns:r}=t,i=t.dataStream.substring(e,n);if(r==null)return{dataStream:i};const o=[];for(const s of r){const{st:a,ed:l}=s;l<=e||a>=n||(a<e?o.push({...s,st:0,ed:l-e}):l>n?o.push({...s,st:a-e,ed:n-e}):o.push({...s,st:a-e,ed:l-e}))}return{dataStream:i,textRuns:o}}function mP(t,e){let n=t.endOffset;for(const r of e){const{startOffset:i,endOffset:o}=r;i==null||o==null||o<=t.endOffset&&(n-=o-i)}return[{startOffset:n,endOffset:n,style:t.style}]}let iy=class{constructor(){ln(this,"_previousActiveRange",null),ln(this,"_undoMutationParamsCache",[]),ln(this,"_redoMutationParamsCache",[])}clearUndoRedoMutationParamsCache(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[]}setActiveRange(e){this._previousActiveRange=e}pushUndoRedoMutationParams(e,n){this._undoMutationParamsCache.push(e),this._redoMutationParamsCache.push(n)}fetchComposedUndoRedoMutationParams(e){if(this._undoMutationParamsCache.length===0||this._previousActiveRange==null)return null;const{unitId:n}=this._undoMutationParamsCache[0],{segmentId:r,startOffset:i,collapsed:o}=this._previousActiveRange,s={unitId:n,mutations:[]},a={unitId:n,mutations:[]};return o?(s.mutations.push({t:"r",len:i,segmentId:r}),a.mutations.push({t:"r",len:i,segmentId:r})):(i>0&&s.mutations.push({t:"r",len:i,segmentId:r}),s.mutations.push(this._undoMutationParamsCache[0].mutations.find(l=>l.t==="i")),a.mutations.push(...nf(this._previousActiveRange,r))),e.length&&(s.mutations.push({t:"d",len:e.length,line:0,segmentId:r}),a.mutations.push({t:"i",body:{dataStream:e},len:e.length,line:0,segmentId:r})),{redoMutationParams:a,undoMutationParams:s,previousActiveRange:this._previousActiveRange}}dispose(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[],this._previousActiveRange=null}};const pP={id:"doc.command.ime-input",type:se.COMMAND,handler:async(t,e)=>{const{unitId:n,newText:r,oldTextLen:i,range:o,segmentId:s,textRanges:a,isCompositionEnd:l}=e,u=t.get(le),c=t.get(At),d=t.get(gr),h=t.get(iy),f={id:Kt.id,params:{unitId:n,mutations:[]}};o.collapsed?f.params.mutations.push({t:"r",len:o.startOffset,segmentId:s}):f.params.mutations.push(...nf(o,s)),i>0&&f.params.mutations.push({t:"d",len:i,line:0,segmentId:s}),f.params.mutations.push({t:"i",body:{dataStream:r},len:r.length,line:0,segmentId:s});const m=u.syncExecuteCommand(f.id,f.params);if(h.pushUndoRedoMutationParams(m,f.params),d.replaceTextRanges(a),l){if(m){const p=h.fetchComposedUndoRedoMutationParams(r);if(p==null)return!1;const{undoMutationParams:g,redoMutationParams:v,previousActiveRange:_}=p;return c.pushUndoRedo({unitID:n,undoMutations:[{id:Kt.id,params:g}],redoMutations:[{id:Kt.id,params:v}],undo(){return u.syncExecuteCommand(Kt.id,g),d.replaceTextRanges([_]),!0},redo(){return u.syncExecuteCommand(Kt.id,v),d.replaceTextRanges(a),!0}}),!0}}else return!!m;return!1}},q2={id:"doc.command.set-inline-format-bold",type:se.COMMAND,handler:async()=>!0},x4={id:"doc.command.set-inline-format-italic",type:se.COMMAND,handler:async()=>!0},M4={id:"doc.command.set-inline-format-underline",type:se.COMMAND,handler:async()=>!0},O4={id:"doc.command.set-inline-format-strikethrough",type:se.COMMAND,handler:async()=>!0},xl={id:"doc.command.set-inline-format-subscript",type:se.COMMAND,handler:async()=>!0},Yu={id:"doc.command.set-inline-format-superscript",type:se.COMMAND,handler:async()=>!0},Q2={id:"doc.command.set-inline-format-fontsize",type:se.COMMAND,handler:async()=>!0},J2={id:"doc.command.set-inline-format-font-family",type:se.COMMAND,handler:async()=>!0},T4={id:"doc.command.set-inline-format-text-color",type:se.COMMAND,handler:async()=>!0},gP={[q2.id]:"bl",[x4.id]:"it",[M4.id]:"ul",[O4.id]:"st",[Q2.id]:"fs",[J2.id]:"ff",[T4.id]:"cl",[xl.id]:"va",[Yu.id]:"va"},vP={id:"doc.command.set-inline-format",type:se.COMMAND,handler:async(t,e)=>{const{segmentId:n,value:r,preCommandId:i}=e,o=t.get(At),s=t.get(le),a=t.get(gr),l=t.get(oe),u=a.getSelections();if(!Array.isArray(u)||u.length===0)return!1;let c=l.getCurrentUniverDocInstance(),d=c.getUnitId();d===Un&&(c=l.getUniverDocInstance(Zr),d=c.getUnitId());let h;switch(i){case q2.id:case x4.id:case M4.id:case O4.id:case xl.id:case Yu.id:{h=Zwe(c.getBody().textRuns,i,u);break}case Q2.id:case J2.id:{h=r;break}case T4.id:{h={rgb:r};break}default:throw new Error(`Unknown command: ${i} in handleInlineFormat`)}const f={id:Kt.id,params:{unitId:d,mutations:[]}},m=new Q6;m.reset();for(const v of u){const{startOffset:_,endOffset:C}=v,y={dataStream:"",textRuns:[{st:0,ed:C-_,ts:{[gP[i]]:h}}]},S=_-m.cursor;S!==0&&f.params.mutations.push({t:"r",len:S,segmentId:n}),f.params.mutations.push({t:"r",body:y,len:C-_,segmentId:n}),m.reset(),m.moveCursor(C)}const p=s.syncExecuteCommand(f.id,f.params),g=[q2.id,Q2.id,J2.id,xl.id,Yu.id];return g.includes(i)&&a.refreshSelection(),p?(o.pushUndoRedo({unitID:d,undoMutations:[{id:Kt.id,params:p}],redoMutations:[{id:Kt.id,params:f.params}],undo(){return s.syncExecuteCommand(Kt.id,p),g.includes(i)&&a.refreshSelection(),!0},redo(){return s.syncExecuteCommand(Kt.id,f.params),g.includes(i)&&a.refreshSelection(),!0}}),!0):!1}};function Kwe(t){return t!==null&&typeof t=="object"}function Zwe(t,e,n){let r=0,i=0;const o=gP[e];for(;r!==t.length&&i!==n.length;){const{startOffset:s,endOffset:a}=n[i],{st:l,ed:u,ts:c}=t[r];if(a<=l)i++;else if(u<=s)r++;else{if((c==null?void 0:c[o])==null){if(/bl|it/.test(o))return ke.TRUE;if(/ul|st/.test(o))return{s:ke.TRUE};if(/va/.test(o))return e===xl.id?Cr.SUBSCRIPT:Cr.SUPERSCRIPT}if(Kwe(c==null?void 0:c[o])&&c[o].s===ke.FALSE)return{s:ke.TRUE};if(e===xl.id&&(c==null?void 0:c[o])!==Cr.SUBSCRIPT)return Cr.SUBSCRIPT;if(e===Yu.id&&(c==null?void 0:c[o])!==Cr.SUPERSCRIPT)return Cr.SUPERSCRIPT;if((c==null?void 0:c[o])===ke.FALSE)return ke.TRUE;r++}}return/bl|it/.test(o)?ke.FALSE:/ul|st/.test(o)?{s:ke.FALSE}:Cr.NORMAL}const qwe={id:"doc.command.bullet-list",type:se.COMMAND,handler:t=>t.get(le).syncExecuteCommand(oy.id,{listType:l6.BULLET_LIST})},Qwe={id:"doc.command.order-list",type:se.COMMAND,handler:t=>t.get(le).syncExecuteCommand(oy.id,{listType:l6.ORDER_LIST})},oy={id:"doc.command.list-operation",type:se.COMMAND,handler:(t,e)=>{var n;const r=t.get(gr),i=t.get(oe),o=t.get(le),s=t.get(At),{listType:a}=e,l=i.getCurrentUniverDocInstance(),u=r.getActiveRange(),c=(n=l.getBody())==null?void 0:n.paragraphs;if(u==null||c==null)return!1;const d=Jwe(u,c),{segmentId:h}=u,f=l.getUnitId(),m=d.every(y=>{var S;return((S=y.bullet)==null?void 0:S.listType)===a}),p=6;let g=De.generateRandomId(p);if(d.length===1){const y=c.indexOf(d[0]),S=c[y-1],E=c[y+1];S&&S.bullet&&S.bullet.listType===a?g=S.bullet.listId:E&&E.bullet&&E.bullet.listType===a&&(g=E.bullet.listId)}const v={id:Kt.id,params:{unitId:f,mutations:[]}},_=new Q6;_.reset();for(const y of d){const{startIndex:S}=y;v.params.mutations.push({t:"r",len:S-_.cursor,segmentId:h});const E={...y.paragraphStyle,hanging:void 0,indentStart:void 0};v.params.mutations.push({t:"r",len:1,body:{dataStream:"",paragraphs:[m?{paragraphStyle:E,startIndex:0}:{...y,startIndex:0,bullet:{...y.bullet??{nestingLevel:0,textStyle:{fs:20}},listType:a,listId:g}}]},segmentId:h,coverType:Ei.REPLACE}),_.moveCursorTo(S+1)}const C=o.syncExecuteCommand(v.id,v.params);return r.refreshSelection(),C&&s.pushUndoRedo({unitID:f,undoMutations:[{id:Kt.id,params:C}],redoMutations:[{id:Kt.id,params:v.params}],undo(){return o.syncExecuteCommand(Kt.id,C),r.refreshSelection(),!0},redo(){return o.syncExecuteCommand(Kt.id,v.params),r.refreshSelection(),!0}}),!0}};function Jwe(t,e){const{startOffset:n,endOffset:r}=t,i=[];let o=0;for(const s of e){const{startIndex:a}=s;(n>o&&n<=a||r>o&&r<=a||a>=n&&a<=r)&&i.push(s),o=a}return i}const _P={id:"doc.command-replace-content",type:se.COMMAND,handler:async(t,e)=>{var n;const{unitId:r,body:i,textRanges:o,segmentId:s=""}=e,a=t.get(oe),l=t.get(le),u=t.get(gr),c=t.get(At),d=(n=a.getUniverDocInstance(r))==null?void 0:n.getSnapshot().body,h=u.getSelections();if(d==null||!Array.isArray(h)||h.length===0)return!1;const f=CP(r,s,d,i),m=l.syncExecuteCommand(f.id,f.params);return u.replaceTextRanges(o),m?(c.pushUndoRedo({unitID:r,undoMutations:[{id:Kt.id,params:m}],redoMutations:[{id:Kt.id,params:f.params}],undo(){return l.syncExecuteCommand(Kt.id,m),u.replaceTextRanges(h),!0},redo(){return l.syncExecuteCommand(Kt.id,f.params),u.replaceTextRanges(o),!0}}),!0):!1}},bP={id:"doc.command-cover-content",type:se.COMMAND,handler:async(t,e)=>{var n;const{unitId:r,body:i,segmentId:o=""}=e,s=t.get(oe),a=t.get(le),l=t.get(At),u=(n=s.getUniverDocInstance(r))==null?void 0:n.getSnapshot().body;if(u==null)return!1;const c=CP(r,o,u,i);return a.syncExecuteCommand(c.id,c.params),l.clearUndoRedo(r),!0}};function CP(t,e,n,r){const i={id:Kt.id,params:{unitId:t,mutations:[]}},o=(n==null?void 0:n.dataStream.length)-2;return o>0&&i.params.mutations.push({t:"d",len:o,line:0,segmentId:e}),r.dataStream.length>0&&i.params.mutations.push({t:"i",body:r,len:r.dataStream.length,line:0,segmentId:e}),i}const _1={id:"doc.operation.move-cursor",type:se.OPERATION,handler:(t,e)=>!!e},Ml={id:"doc.operation.move-selection",type:se.OPERATION,handler:(t,e)=>!!e},eRe=(t,e)=>{const n=t.get(oe).getUniverDocInstance(e.unitId),r=(n==null?void 0:n.zoomRatio)||1;return{...De.deepClone(e),zoomRatio:r}},Lu={id:"doc.operation.set-zoom-ratio",type:se.OPERATION,handler:(t,e)=>{const n=t.get(oe).getUniverDocInstance(e.unitId);if(!n)return!1;const r=n.getSnapshot();return r.settings==null?r.settings={zoomRatio:e.zoomRatio}:r.settings.zoomRatio=e.zoomRatio,!0}},yP={type:se.COMMAND,id:"doc.command.set-zoom-ratio",handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe);let o=i.getCurrentUniverDocInstance().getUnitId(),s=1;if(e&&(o=e.documentId??o,s=e.zoomRatio??s),!i.getUniverDocInstance(o))return!1;const a={zoomRatio:s,unitId:o},l=eRe(t,a);return n.syncExecuteCommand(Lu.id,a)?(r.pushUndoRedo({unitID:o,undoMutations:[{id:Lu.id,params:l}],redoMutations:[{id:Lu.id,params:a}]}),!0):!1}},SP={id:"doc.operation.select-all",type:se.COMMAND,handler:async t=>{const e=t.get(oe),n=t.get(gr),r=e.getCurrentUniverDocInstance().getSnapshot().body;if(r==null)return!1;const i=[{startOffset:0,endOffset:r.dataStream.length-2}];return n.replaceTextRanges(i),!0}},tRe=10,nRe=6;function rRe(){return De.generateRandomId(nRe)}function iRe(t){const e=t.match(/data-copy-id="([^\s]+)"/);return e&&e[1]?e[1]:null}let oRe=class{constructor(){ln(this,"_cache",new U5(tRe))}set(e,n){this._cache.set(e,n)}get(e){return this._cache.get(e)}clear(){this._cache.clear()}};const aD=new oRe;function sRe(t){const e=t.style,n={};for(let r=0;r<e.length;r++){const i=e[r],o=e.getPropertyValue(i);switch(i){case"margin-top":{const s=parseInt(o);n.spaceAbove=/pt/.test(o)?n_(s):s;break}case"margin-bottom":{const s=parseInt(o);n.spaceBelow=/pt/.test(o)?n_(s):s;break}}}return Object.getOwnPropertyNames(n).length?n:null}function n_(t){return t/.75}function sy(t){const e=t.style,n={},r=t.tagName.toLowerCase();switch(r){case"b":case"em":case"strong":{n.bl=ke.TRUE;break}case"s":{n.st={s:ke.TRUE};break}case"u":{n.ul={s:ke.TRUE};break}case"i":{n.it=ke.TRUE;break}case"sub":case"sup":{n.va=r==="sup"?Cr.SUPERSCRIPT:Cr.SUBSCRIPT;break}}for(let i=0;i<e.length;i++){const o=e[i],s=e.getPropertyValue(o);switch(o){case"font-family":{n.ff=s;break}case"font-size":{const a=parseInt(s);Number.isNaN(a)||(n.fs=/pt$/.test(s)?n_(a):a);break}case"font-style":{s==="italic"&&(n.it=ke.TRUE);break}case"font-weight":{Number(s)>400&&(n.bl=ke.TRUE);break}case"text-decoration":{/underline/.test(s)?n.ul={s:ke.TRUE}:/overline/.test(s)?n.ol={s:ke.TRUE}:/line-through/.test(s)&&(n.st={s:ke.TRUE});break}case"color":{const a=new _o(s);a.isValid&&(n.cl={rgb:a.toRgbString()});break}case"background-color":{const a=new _o(s);a.isValid&&(n.bg={rgb:a.toRgbString()});break}}}return n}function aRe(t){const e=new DOMParser,n=`<x-univer id="univer-root">${t}</x-univer>`;return e.parseFromString(n,"text/html").querySelector("#univer-root")}function lD(t,e){const n=t.tagName.toLowerCase();return typeof e=="string"?n===e:Array.isArray(e)?e.some(r=>r===n):e(t)}const EP=class wP{constructor(){ln(this,"_styleCache",new Map),ln(this,"_styleRules",[]),ln(this,"_afterProcessRules",[])}static use(e){if(this._pluginList.includes(e))throw new Error(`Univer paste plugin ${e.name} already added`);this._pluginList.push(e)}convert(e){const n=wP._pluginList.find(o=>o.checkPasteType(e)),r=aRe(e),i={dataStream:"",textRuns:[]};return n&&(this._styleRules=[...n.stylesRules],this._afterProcessRules=[...n.afterProcessRules]),this._styleCache.clear(),this._process(null,r==null?void 0:r.childNodes,i),this._styleCache.clear(),this._styleRules=[],this._afterProcessRules=[],i}_process(e,n,r){var i;for(const o of n)if(o.nodeType===Node.TEXT_NODE){const s=(i=o.nodeValue)==null?void 0:i.replace(/[\r\n]/g,"");let a;e&&this._styleCache.has(e)&&(a=this._styleCache.get(e)),r.dataStream+=s,a&&Object.getOwnPropertyNames(a).length&&r.textRuns.push({st:r.dataStream.length-s.length,ed:r.dataStream.length,ts:a})}else if(o.nodeType===Node.ELEMENT_NODE){const s=e?this._styleCache.get(e):{},a=this._styleRules.find(({filter:d})=>lD(o,d)),l=a?a.getStyle(o):sy(o);this._styleCache.set(o,{...s,...l});const{childNodes:u}=o;this._process(o,u,r);const c=this._afterProcessRules.find(({filter:d})=>lD(o,d));c&&c.handler(r,o)}}};ln(EP,"_pluginList",[]);let ay=EP;const lRe={name:"univer-doc-paste-plugin-lark",checkPasteType(t){return/lark-record-clipboard/i.test(t)},stylesRules:[{filter:["s"],getStyle(t){const e=sy(t);return{st:{s:ke.TRUE},...e}}}],afterProcessRules:[{filter(t){return t.tagName==="DIV"&&/ace-line/i.test(t.className)},handler(t){t.paragraphs==null&&(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r"}}]},uRe={name:"univer-doc-paste-plugin-word",checkPasteType(t){return/word|mso/i.test(t)},stylesRules:[{filter:["b"],getStyle(t){const e=sy(t);return{bl:ke.TRUE,...e}}}],afterProcessRules:[{filter(t){return t.tagName==="P"&&/mso/i.test(t.className)},handler(t,e){t.paragraphs==null&&(t.paragraphs=[]);const n={startIndex:t.dataStream.length},r=sRe(e);r&&(n.paragraphStyle=r),t.paragraphs.push(n),t.dataStream+="\r"}}]};function cRe(t,e){const{st:n,ed:r,ts:i={}}=e,{ff:o,fs:s,it:a,bl:l,ul:u,st:c,ol:d,bg:h,cl:f,va:m}=i;let p=t.slice(n,r);const g=[];return a===ke.TRUE&&(p=`<i>${p}</i>`),m===Cr.SUPERSCRIPT?p=`<sup>${p}</sup>`:m===Cr.SUBSCRIPT&&(p=`<sub>${p}</sub>`),(u==null?void 0:u.s)===ke.TRUE&&(p=`<u>${p}</u>`),(c==null?void 0:c.s)===ke.TRUE&&(p=`<s>${p}</s>`),l===ke.TRUE&&(p=`<strong>${p}</strong>`),o&&g.push(`font-family: ${o}`),f&&g.push(`color: ${f.rgb}`),s&&g.push(`font-size: ${s}px`),d&&g.push("text-decoration: overline"),h&&g.push(`background: ${h.rgb}`),g.length?`<span style="${g.join(";")}">${p}</span>`:p}function uD(t,e=!0){const{dataStream:n,textRuns:r=[],paragraphs:i=[]}=t;let o=0;const s=[],a=[];for(const l of r){const{st:u,ed:c}=l;if(u!==o&&s.push(n.slice(o,u)),s.push(cRe(n,l)),o=c,e)for(const d of i){const{startIndex:h,paragraphStyle:f={}}=d;if(h>=u&&h<=c){const{spaceAbove:m,spaceBelow:p}=f,g=[];m!=null&&(typeof m=="number"?g.push(`margin-top: ${m}px`):g.push(`margin-top: ${m.v}px`)),p!=null&&(typeof p=="number"?g.push(`margin-bottom: ${p}px`):g.push(`margin-bottom: ${p.v}px`)),a.push(`<p className="UniverNormal" ${g.length?`style="${g.join(";")}"`:""}>${s.join("")}</p>`),s.length=0}}}return a.join("")+s.join("")}let dRe=class{convert(e){if(e.length===0)throw new Error("The bodyList length at least to be 1");if(e.length===1)return uD(e[0]);let n="";for(const r of e)n+='<p className="UniverNormal">',n+=uD(r,!1),n+="</p>";return n}};var hRe=Object.defineProperty,fRe=Object.getOwnPropertyDescriptor,mRe=(t,e,n,r)=>{for(var i=r>1?void 0:r?fRe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&hRe(e,n,i),i},cD=(t,e)=>(n,r)=>e(n,r,t);ay.use(uRe);ay.use(lRe);function pRe(t){const e=t.replace(/\n/g,"\r"),n=[];for(let r=0;r<e.length;r++)e[r]==="\r"&&n.push({startIndex:r});return{dataStream:e,paragraphs:n}}const RP=nn("doc.clipboard-service");let r_=class extends je{constructor(e,n){super(),ln(this,"_clipboardHooks",[]),ln(this,"_htmlToUDM",new ay),ln(this,"_umdToHtml",new dRe),this._currentUniverService=e,this._clipboardInterfaceService=n}async queryClipboardData(){const e=await this._clipboardInterfaceService.read();if(e.length===0)return Promise.reject();try{let n="",r="";for(const o of e)for(const s of o.types)s===H6?r=await o.getType(s).then(a=>a&&a.text()):s===V6&&(n=await o.getType(s).then(a=>a&&a.text()));if(!n)return pRe(r);const i=iRe(n);if(i){const o=aD.get(i);if(o)return o}return this._htmlToUDM.convert(n)}catch(n){return Promise.reject(n)}}async setClipboardData(e){const n=rRe(),r=e.length>1?e.map(o=>o.dataStream).join(`
`):e[0].dataStream;let i=this._umdToHtml.convert(e);return e.length===1&&(i=i.replace(/(<[a-z]+)/,(o,s)=>`${s} data-copy-id="${n}"`),aD.set(n,e[0])),this._clipboardInterfaceService.write(r,i)}addClipboardHook(e){return this._clipboardHooks.push(e),Be(()=>{const n=this._clipboardHooks.indexOf(e);n>-1&&this._clipboardHooks.splice(n,1)})}};r_=mRe([cD(0,oe),cD(1,D4)],r_);var gRe=Object.defineProperty,vRe=Object.getOwnPropertyDescriptor,_Re=(t,e,n,r)=>{for(var i=r>1?void 0:r?vRe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&gRe(e,n,i),i},Lc=(t,e)=>(n,r)=>e(n,r,t);let P3=class extends je{constructor(e,n,r,i,o,s){super(),this._logService=e,this._commandService=n,this._currentUniverService=r,this._docClipboardService=i,this._textSelectionManagerService=o,this._contextService=s,this._commandExecutedListener(),this.initialize()}initialize(){[qm,Qm,Jm].forEach(e=>this.disposeWithMe(this._commandService.registerAsMultipleCommand(e))),[sD,u5].forEach(e=>this.disposeWithMe(this._commandService.registerCommand(e)))}_commandExecutedListener(){const e=[Qm.id,qm.id,Jm.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(e.includes(n.id)&&!(!this._contextService.getContextValue(fi)&&!this._contextService.getContextValue(Dr)))switch(n.id){case Jm.id:{this._handlePaste();break}case qm.id:{this._handleCopy();break}case Qm.id:{this._handleCut();break}default:throw new Error(`Unhandled command ${n.id}`)}}))}async _handlePaste(){const{_docClipboardService:e}=this,{segmentId:n,endOffset:r,style:i}=this._textSelectionManagerService.getActiveRange()??{},o=this._textSelectionManagerService.getSelections();if(n==null&&this._logService.error("[DocClipboardController] segmentId is not existed"),!(r==null||o==null))try{const s=await e.queryClipboardData();let a=r;for(const u of o){const{startOffset:c,endOffset:d}=u;c==null||d==null||d<=r&&(a+=s.dataStream.length-(d-c))}const l=[{startOffset:a,endOffset:a,style:i}];this._commandService.executeCommand(sD.id,{body:s,segmentId:n,textRanges:l})}catch{this._logService.error("[DocClipboardController] clipboard is empty")}}_getDocumentBodyInRanges(){const e=this._textSelectionManagerService.getSelections(),n=this._currentUniverService.getCurrentUniverDocInstance(),{dataStream:r,textRuns:i=[],paragraphs:o=[]}=n.getBody(),s=[];if(e==null)return s;for(const a of e){const{startOffset:l,endOffset:u,collapsed:c}=a;if(c||l==null||u==null)continue;const d={dataStream:r.slice(l,u)},h=[];for(const m of i){const p=De.deepClone(m),{st:g,ed:v}=p;De.hasIntersectionBetweenTwoRanges(g,v,l,u)&&(l>=g&&l<=v?h.push({...p,st:l,ed:Math.min(u,v)}):u>=g&&u<=v?h.push({...p,st:Math.max(l,g),ed:u}):h.push(p))}h.length&&(d.textRuns=h.map(m=>{const{st:p,ed:g}=m;return{...m,st:p-l,ed:g-l}}));const f=[];for(const m of o){const{startIndex:p}=m;p>=l&&p<=u&&f.push(De.deepClone(m))}f.length&&(d.paragraphs=f.map(m=>({...m,startIndex:m.startIndex-l}))),s.push(d)}return s}async _handleCopy(){const{_docClipboardService:e}=this,n=this._getDocumentBodyInRanges();try{e.setClipboardData(n)}catch{this._logService.error("[DocClipboardController] set clipboard failed")}}async _handleCut(){const{segmentId:e,endOffset:n,style:r}=this._textSelectionManagerService.getActiveRange()??{},i=this._textSelectionManagerService.getSelections();if(e==null&&this._logService.error("[DocClipboardController] segmentId is not existed"),!(n==null||i==null)){this._handleCopy();try{let o=n;for(const a of i){const{startOffset:l,endOffset:u}=a;l==null||u==null||u<=n&&(o-=u-l)}const s=[{startOffset:o,endOffset:o,style:r}];this._commandService.executeCommand(u5.id,{segmentId:e,textRanges:s})}catch{this._logService.error("[DocClipboardController] cut content failed")}}}};P3=_Re([yt(it.Rendered,P3),Lc(0,hs),Lc(1,le),Lc(2,oe),Lc(3,RP),Lc(4,ne(gr)),Lc(5,Tr)],P3);var bRe=Object.defineProperty,CRe=Object.getOwnPropertyDescriptor,yRe=(t,e,n,r)=>{for(var i=r>1?void 0:r?CRe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&bRe(e,n,i),i},ep=(t,e)=>(n,r)=>e(n,r,t);let B3=class extends E1{constructor(e,n,r){super(),this._docSkeletonManagerService=e,this._renderManagerService=n,this._commandService=r,this._initialRenderRefresh(),this._commandExecutedListener()}_initialRenderRefresh(){this._docSkeletonManagerService.currentSkeletonBefore$.pipe(Ts(this.dispose$)).subscribe(e=>{if(e==null)return;const{skeleton:n,unitId:r}=e,i=this._renderManagerService.getRenderById(r);if(i==null)return;const{mainComponent:o}=i;o.changeSkeleton(n),this._recalculateSizeBySkeleton(i,n)})}_recalculateSizeBySkeleton(e,n){var r;const{mainComponent:i,scene:o}=e,s=i,a=(r=n.getSkeletonData())==null?void 0:r.pages;if(a==null)return;let l=0,u=0;for(let c=0,d=a.length;c<d;c++){const h=a[c],{pageWidth:f,pageHeight:m}=h;s.pageLayoutType===Vs.VERTICAL?(u+=m,u+=s.pageMarginTop,c===d-1&&(u+=s.pageMarginTop),l=Math.max(l,f)):s.pageLayoutType===Vs.HORIZONTAL&&(l+=f,c!==d-1&&(l+=s.pageMarginLeft),u=Math.max(u,m))}s.resize(l,u),[Zr,Un].includes(e.unitId)||o.resize(l,u)}_commandExecutedListener(){const e=[Kt.id],n=[Zr,Un];this.disposeWithMe(this._commandService.onCommandExecuted(r=>{var i;if(e.includes(r.id)){const o=r.params,{unitId:s}=o,a=this._docSkeletonManagerService.getSkeletonByUnitId(s);if(a==null)return;const{skeleton:l}=a,u=this._renderManagerService.getRenderById(s);if(u==null)return;if(l.calculate(),n.includes(s)){(i=u.mainComponent)==null||i.makeDirty();return}this._recalculateSizeBySkeleton(u,l)}}))}};B3=yRe([yt(it.Rendered,B3),ep(0,ne(Co)),ep(1,kn),ep(2,le)],B3);var SRe=Object.defineProperty,ERe=Object.getOwnPropertyDescriptor,wRe=(t,e,n,r)=>{for(var i=r>1?void 0:r?ERe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&SRe(e,n,i),i},id=(t,e)=>(n,r)=>e(n,r,t);let F3=class extends je{constructor(e,n,r,i,o){super(),ln(this,"_liquid",new B6),ln(this,"_pageMarginCache",new Map),this._docSkeletonManagerService=e,this._currentUniverService=n,this._renderManagerService=r,this._commandService=i,this._floatingObjectManagerService=o,this._initialize(),this._commandExecutedListener()}_initialize(){this._initialRenderRefresh(),this._updateOnPluginChange()}_updateOnPluginChange(){this._floatingObjectManagerService.pluginUpdate$.subscribe(e=>{const n=this._docSkeletonManagerService.getCurrent();if(n==null)return;const{unitId:r,skeleton:i}=n,o=this._renderManagerService.getRenderById(r);if(o==null)return;const{mainComponent:s,components:a,scene:l}=o,u=s,{left:c,top:d}=u;e.forEach(h=>{const{unitId:f,subComponentId:m,floatingObjectId:p,floatingObject:g}=h,{left:v=0,top:_=0,width:C=0,height:y=0,angle:S,flipX:E,flipY:w,skewX:R,skewY:D}=g,I=this._pageMarginCache.get(p),k=(I==null?void 0:I.marginLeft)||0,O=(I==null?void 0:I.marginTop)||0;i==null||i.getViewModel().getDataModel().updateDrawing(p,{left:v-c-k,top:_-d-O,height:y,width:C})}),i==null||i.calculate(),s==null||s.makeDirty()})}_initialRenderRefresh(){this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const{skeleton:n,unitId:r}=e,i=this._renderManagerService.getRenderById(r);if(i==null)return;const{mainComponent:o}=i;o.changeSkeleton(n),this._refreshFloatingObject(r,n,i)})}_commandExecutedListener(){const e=[Kt.id,Lu.id],n=[Zr,Un];this.disposeWithMe(this._commandService.onCommandExecuted(r=>{var i;if(e.includes(r.id)){const o=r.params,{unitId:s}=o,a=this._docSkeletonManagerService.getCurrent();if(a==null)return;const{unitId:l,skeleton:u}=a;if(s!==l)return;const c=this._renderManagerService.getRenderById(l);if(c==null)return;if(n.includes(l)){(i=c.mainComponent)==null||i.makeDirty();return}this._refreshFloatingObject(l,u,c)}}))}_refreshFloatingObject(e,n,r){const i=n==null?void 0:n.getSkeletonData(),{mainComponent:o,scene:s}=r,a=o;if(!i)return;const{left:l,top:u,pageLayoutType:c,pageMarginLeft:d,pageMarginTop:h}=a,{pages:f}=i,m=[];s.getAncestorScale(),this._liquid.reset(),this._pageMarginCache.clear();for(let p=0,g=f.length;p<g;p++){const v=f[p],{skeDrawings:_,marginLeft:C,marginTop:y}=v;this._liquid.translatePagePadding(v),_.forEach(S=>{const{aLeft:E,aTop:w,height:R,width:D,objectId:I}=S;m.push({unitId:e,subComponentId:gV,floatingObjectId:I,floatingObject:{left:E+l+this._liquid.x,top:w+u+this._liquid.y,width:D,height:R}}),this._pageMarginCache.set(I,{marginLeft:this._liquid.x,marginTop:this._liquid.y})}),this._liquid.translatePage(v,c,d,h)}this._floatingObjectManagerService.BatchAddOrUpdate(m)}};F3=wRe([yt(it.Steady,F3),id(0,ne(Co)),id(1,oe),id(2,kn),id(3,le),id(4,Cx)],F3);var RRe=Object.defineProperty,DRe=Object.getOwnPropertyDescriptor,IRe=(t,e,n,r)=>{for(var i=r>1?void 0:r?DRe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&RRe(e,n,i),i},Pc=(t,e)=>(n,r)=>e(n,r,t);let U3=class extends je{constructor(e,n,r,i,o,s){super(),ln(this,"_previousIMEContent",""),ln(this,"_previousIMERange"),ln(this,"_onStartSubscription"),ln(this,"_onUpdateSubscription"),ln(this,"_onEndSubscription"),this._docSkeletonManagerService=e,this._currentUniverService=n,this._renderManagerService=r,this._textSelectionRenderManager=i,this._imeInputManagerService=o,this._commandService=s,this._initialize()}dispose(){var e,n,r;(e=this._onStartSubscription)==null||e.unsubscribe(),(n=this._onUpdateSubscription)==null||n.unsubscribe(),(r=this._onEndSubscription)==null||r.unsubscribe()}_initialize(){this._initialOnCompositionstart(),this._initialOnCompositionUpdate(),this._initialOnCompositionend()}_initialOnCompositionstart(){this._onStartSubscription=this._textSelectionRenderManager.onCompositionstart$.subscribe(e=>{if(e==null)return;const{activeRange:n}=e;n!=null&&(this._imeInputManagerService.clearUndoRedoMutationParamsCache(),this._imeInputManagerService.setActiveRange(De.deepClone(n)),this._previousIMERange=n)})}_initialOnCompositionUpdate(){this._onUpdateSubscription=this._textSelectionRenderManager.onCompositionupdate$.subscribe(async e=>{this._updateContent(e,!0)})}_initialOnCompositionend(){this._onEndSubscription=this._textSelectionRenderManager.onCompositionend$.subscribe(e=>{this._updateContent(e,!1)})}async _updateContent(e,n){var r;const i=(r=this._docSkeletonManagerService.getCurrent())==null?void 0:r.skeleton;if(this._previousIMERange==null||e==null||i==null)return;const o=this._currentUniverService.getCurrentUniverDocInstance(),{event:s,activeRange:a}=e,{startOffset:l,segmentId:u,style:c}=this._previousIMERange;if(i==null||a==null)return;const d=s.data;if(d===this._previousIMEContent&&n)return;const h=d.length,f=[{startOffset:l+h,endOffset:l+h,style:c}];await this._commandService.executeCommand(pP.id,{unitId:o.getUnitId(),newText:d,oldTextLen:this._previousIMEContent.length,range:this._previousIMERange,textRanges:f,isCompositionEnd:!n,segmentId:u}),i.calculate(),n?(this._previousIMERange.collapsed||(this._previousIMERange.collapsed=!0),this._previousIMEContent=d):this._resetIME()}_resetIME(){this._previousIMEContent="",this._previousIMERange=null,this._imeInputManagerService.clearUndoRedoMutationParamsCache(),this._imeInputManagerService.setActiveRange(null)}_getDocObject(){return I4(this._currentUniverService,this._renderManagerService)}};U3=IRe([yt(it.Rendered,U3),Pc(0,ne(Co)),Pc(1,oe),Pc(2,kn),Pc(3,Wl),Pc(4,ne(iy)),Pc(5,le)],U3);var xRe=Object.defineProperty,MRe=Object.getOwnPropertyDescriptor,ORe=(t,e,n,r)=>{for(var i=r>1?void 0:r?MRe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&xRe(e,n,i),i},dD=(t,e)=>(n,r)=>e(n,r,t);let H3=class extends je{constructor(e,n){super(),this._textSelectionManagerService=e,this._commandService=n,this._commandExecutedListener()}_commandExecutedListener(){const e=[q2.id,x4.id,M4.id,O4.id,xl.id,Yu.id,Q2.id,J2.id,T4.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{e.includes(n.id)&&this._handleInlineFormat(n)}))}_handleInlineFormat(e){const{segmentId:n}=this._textSelectionManagerService.getActiveRange()??{};n!=null&&this._commandService.executeCommand(vP.id,{segmentId:n,preCommandId:e.id,...e.params??{}})}};H3=ORe([yt(it.Rendered,H3),dD(0,ne(gr)),dD(1,le)],H3);var TRe=Object.defineProperty,$Re=Object.getOwnPropertyDescriptor,kRe=(t,e,n,r)=>{for(var i=r>1?void 0:r?$Re(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&TRe(e,n,i),i},od=(t,e)=>(n,r)=>e(n,r,t);let V3=class extends je{constructor(e,n,r,i,o){super(),ln(this,"_onInputSubscription"),this._docSkeletonManagerService=e,this._currentUniverService=n,this._renderManagerService=r,this._textSelectionManagerService=i,this._commandService=o,this._initialize(),this._commandExecutedListener()}dispose(){var e;(e=this._onInputSubscription)==null||e.unsubscribe()}_initialize(){}_commandExecutedListener(){const e=[_1.id,Ml.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(!e.includes(n.id))return;const r=n.params;switch(n.id){case _1.id:return this._handleMoveCursor(r.direction);case Ml.id:return this._handleShiftMoveSelection(r.direction);default:throw new Error("Unknown command")}}))}_handleShiftMoveSelection(e){var n;const r=this._textSelectionManagerService.getActiveRange(),i=this._textSelectionManagerService.getSelections(),o=this._currentUniverService.getCurrentUniverDocInstance(),s=(n=this._docSkeletonManagerService.getCurrent())==null?void 0:n.skeleton,a=this._getDocObject();if(r==null||s==null||a==null)return;const{startOffset:l,endOffset:u,style:c,collapsed:d,direction:h}=r;if(i.length>1){let g=1/0,v=-1/0;for(const _ of i)g=Math.min(g,_.startOffset),v=Math.max(v,_.endOffset);this._textSelectionManagerService.replaceTextRanges([{startOffset:e===ge.LEFT||e===ge.UP?v:g,endOffset:e===ge.LEFT||e===ge.UP?g:v,style:c}]);return}const f=d||h===O2.FORWARD?l:u;let m=d||h===O2.FORWARD?u:l;const p=o.getBody().dataStream.length??1/0;if(e===ge.LEFT||e===ge.RIGHT){const g=s.findNodeByCharIndex(m-1),v=s.findNodeByCharIndex(m);m=e===ge.RIGHT?m+v.count:m-((g==null?void 0:g.count)??0),m=Math.min(p-2,Math.max(0,m)),this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:m,style:c}])}else{const g=s.findNodeByCharIndex(m),v=a.document.getOffsetConfig(),_=this._getTopOrBottomPosition(s,g,e===ge.DOWN);if(_==null){const y=e===ge.UP?0:p-2;if(y===m)return;this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:y,style:c}]);return}const C=new Mv(v,s).getRangePointData(_,_).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:C.endOffset,style:c}])}}_handleMoveCursor(e){var n;const r=this._textSelectionManagerService.getActiveRange(),i=this._textSelectionManagerService.getSelections(),o=this._currentUniverService.getCurrentUniverDocInstance(),s=(n=this._docSkeletonManagerService.getCurrent())==null?void 0:n.skeleton,a=this._getDocObject();if(r==null||s==null||a==null||i==null)return;const{startOffset:l,endOffset:u,style:c,collapsed:d}=r,h=o.getBody().dataStream.length??1/0;if(e===ge.LEFT||e===ge.RIGHT){let f;if(!r.collapsed||i.length>1){let m=1/0,p=-1/0;for(const g of i)m=Math.min(m,g.startOffset),p=Math.max(p,g.endOffset);f=e===ge.LEFT?m:p}else{const m=s.findNodeByCharIndex(l-1),p=s.findNodeByCharIndex(l);e===ge.LEFT?f=Math.max(0,l-((m==null?void 0:m.count)??0)):f=Math.min(h-2,u+p.count)}this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:f,style:c}])}else{const f=s.findNodeByCharIndex(l),m=s.findNodeByCharIndex(u),p=a.document.getOffsetConfig(),g=this._getTopOrBottomPosition(s,e===ge.UP?f:m,e===ge.DOWN);if(g==null){let _;d?_=e===ge.UP?0:h-2:_=e===ge.UP?l:u,this._textSelectionManagerService.replaceTextRanges([{startOffset:_,endOffset:_,style:c}]);return}const v=new Mv(p,s).getRangePointData(g,g).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{...v,style:c}])}}_getTopOrBottomPosition(e,n,r){if(n==null)return;const i=this._getSpanLeftOffsetInLine(n),o=this._getNextOrPrevLine(n,r);if(o==null)return;const s=this._matchPositionByLeftOffset(e,o,i);if(s!=null)return{...s,isBack:!0}}_getSpanLeftOffsetInLine(e){const n=e.parent;if(n==null)return-1/0;const r=n.left,{left:i}=e;return r+i}_matchPositionByLeftOffset(e,n,r){const i={distance:1/0};for(const o of n.divides){const s=o.left;for(const a of o.spanGroup){const{left:l}=a,u=s+l,c=Math.abs(r-u);c<i.distance&&(i.span=a,i.distance=c)}}if(i.span!=null)return e.findPositionBySpan(i.span)}_getNextOrPrevLine(e,n){var r,i,o,s,a,l,u,c,d,h,f,m;const p=e.parent;if(p==null)return;const g=p.parent;if(g==null)return;const v=g.parent;if(v==null)return;const _=v.lines.indexOf(g);if(_===-1)return;let C;if(n===!0?C=v.lines[_+1]:C=v.lines[_-1],C!=null)return C;const y=v.parent;if(y==null)return;const S=y.columns.indexOf(v);if(S===-1)return;if(n===!0)C=(r=y.columns[S+1])==null?void 0:r.lines[0];else{const I=(o=(i=y.columns)==null?void 0:i[S-1])==null?void 0:o.lines;C=I==null?void 0:I[I.length-1]}if(C!=null)return C;const E=y.parent;if(E==null)return;const w=E.sections.indexOf(y);if(w===-1)return;if(n===!0)C=(a=(s=E.sections[w-1])==null?void 0:s.columns[0])==null?void 0:a.lines[0];else{const I=(u=(l=E.sections)==null?void 0:l[w-1])==null?void 0:u.columns,k=I==null?void 0:I[I.length-1],O=k==null?void 0:k.lines;C=O==null?void 0:O[O.length-1]}if(C!=null)return C;const R=E.parent;if(R==null)return;const D=R.pages.indexOf(E);if(D!==-1){if(n===!0)C=(h=(d=(c=R.pages[D+1])==null?void 0:c.sections[0])==null?void 0:d.columns[0])==null?void 0:h.lines[0];else{const I=(f=R.pages[D-1])==null?void 0:f.sections;if(I==null)return;const k=(m=I[I.length-1])==null?void 0:m.columns,O=k[k.length-1],$=O==null?void 0:O.lines;C=$[$.length-1]}if(C!=null)return C}}_getDocObject(){return I4(this._currentUniverService,this._renderManagerService)}};V3=kRe([yt(it.Rendered,V3),od(0,ne(Co)),od(1,oe),od(2,kn),od(3,ne(gr)),od(4,le)],V3);var ARe=Object.defineProperty,NRe=Object.getOwnPropertyDescriptor,LRe=(t,e,n,r)=>{for(var i=r>1?void 0:r?NRe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&ARe(e,n,i),i},sd=(t,e)=>(n,r)=>e(n,r,t);let j3=class extends je{constructor(e,n,r,i,o){super(),ln(this,"_onInputSubscription"),this._docSkeletonManagerService=e,this._currentUniverService=n,this._renderManagerService=r,this._textSelectionRenderManager=i,this._commandService=o,this._initialize(),this._commandExecutedListener()}dispose(){var e;(e=this._onInputSubscription)==null||e.unsubscribe()}_initialize(){this._initialNormalInput()}_initialNormalInput(){this._onInputSubscription=this._textSelectionRenderManager.onInput$.subscribe(async e=>{var n;if(e==null)return;const r=this._currentUniverService.getCurrentUniverDocInstance().getUnitId(),{event:i,content:o="",activeRange:s}=e,a=i,l=(n=this._docSkeletonManagerService.getCurrent())==null?void 0:n.skeleton;if(a.data==null||l==null||!l||!s)return;const{startOffset:u,segmentId:c,style:d}=s,h=o.length,f=[{startOffset:u+h,endOffset:u+h,style:d}];await this._commandService.executeCommand(JC.id,{unitId:r,body:{dataStream:o},range:s,textRanges:f,segmentId:c})})}_commandExecutedListener(){}_getDocObject(){return I4(this._currentUniverService,this._renderManagerService)}};j3=LRe([yt(it.Rendered,j3),sd(0,ne(Co)),sd(1,oe),sd(2,kn),sd(3,Wl),sd(4,le)],j3);var PRe=Object.defineProperty,BRe=Object.getOwnPropertyDescriptor,FRe=(t,e,n,r)=>{for(var i=r>1?void 0:r?BRe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&PRe(e,n,i),i},hD=(t,e)=>(n,r)=>e(n,r,t);const URe="rgba(198, 198, 198, 1)",HRe="rgba(255, 255, 255, 1)";let z3=class extends je{constructor(e,n){super(),this._renderManagerService=e,this._currentUniverService=n,this._initialize(),this._commandExecutedListener()}_initialize(){this._initialRenderRefresh()}_initialRenderRefresh(){this._renderManagerService.currentRender$.subscribe(e=>{var n;if(e==null||this._currentUniverService.getUniverDocInstance(e)==null)return;const r=this._renderManagerService.getRenderById(e);if(r==null)return;const{mainComponent:i}=r,o=i,s=(n=o.getSkeleton())==null?void 0:n.getPageSize();o.onPageRenderObservable.add(a=>{if([Zr,Un].includes(e))return;const{page:l,pageLeft:u,pageTop:c,ctx:d}=a,{width:h,pageWidth:f,height:m,pageHeight:p}=l;d.save(),d.translate(u-.5,c-.5),qt.drawWith(d,{width:(s==null?void 0:s.width)??f??h,height:(s==null?void 0:s.height)??p??m,strokeWidth:1,stroke:URe,fill:HRe,zIndex:3}),d.restore()})})}_commandExecutedListener(){}};z3=FRe([yt(it.Rendered,z3),hD(0,kn),hD(1,ne(oe))],z3);var VRe=Object.defineProperty,jRe=Object.getOwnPropertyDescriptor,zRe=(t,e,n,r)=>{for(var i=r>1?void 0:r?jRe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&VRe(e,n,i),i},Jl=(t,e)=>(n,r)=>e(n,r,t);let W3=class extends je{constructor(e,n,r,i,o,s,a){super(),ln(this,"_moveInObserver"),ln(this,"_moveOutObserver"),ln(this,"_downObserver"),ln(this,"_dblClickObserver"),ln(this,"_tripleClickObserver"),ln(this,"_loadedMap",new Set),this._docSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._textSelectionRenderManager=o,this._textSelectionManagerService=s,this._layoutService=a,this._renderManagerService.currentRender$.subscribe(l=>{l!=null&&this._currentUniverService.getUniverDocInstance(l)!=null&&(this._loadedMap.has(l)||(this._initialMain(l),this._loadedMap.add(l)))}),this._initialize()}_initialize(){this._skeletonListener(),this._commandExecutedListener(),this._layoutService&&this.disposeWithMe(this._layoutService.registerContainer(this._textSelectionRenderManager.__getEditorContainer()))}dispose(){this._renderManagerService.getRenderAll().forEach(e=>{const{mainComponent:n}=e;n!=null&&(n.onPointerEnterObserver.remove(this._moveInObserver),n.onPointerLeaveObserver.remove(this._moveOutObserver),n.onPointerDownObserver.remove(this._downObserver),n.onDblclickObserver.remove(this._dblClickObserver),n.onTripleClickObserver.remove(this._tripleClickObserver))})}_initialMain(e){const n=this._getDocObjectById(e);if(n==null)return;const{document:r,scene:i}=n;this._moveInObserver=r.onPointerEnterObserver.add(()=>{r.cursor=Yt.TEXT}),this._moveOutObserver=r.onPointerLeaveObserver.add(()=>{r.cursor=Yt.DEFAULT,i.resetCursor()}),this._downObserver=r==null?void 0:r.onPointerDownObserver.add((o,s)=>{this._currentUniverService.getCurrentUniverDocInstance().getUnitId()!==e&&this._currentUniverService.setCurrentUniverDocInstance(e),this._textSelectionRenderManager.eventTrigger(o),o.button!==2&&s.stopPropagation()}),this._dblClickObserver=r==null?void 0:r.onDblclickObserver.add(o=>{this._textSelectionRenderManager.handleDblClick(o)}),this._tripleClickObserver=r==null?void 0:r.onTripleClickObserver.add(o=>{this._textSelectionRenderManager.handleTripleClick(o)})}_commandExecutedListener(){const e=[Lu.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{var r;if(e.includes(n.id)){const i=n.params,{unitId:o}=i,s=(r=this._textSelectionManagerService.getCurrentSelection())==null?void 0:r.unitId;if(o!==s)return;this._textSelectionManagerService.refreshSelection()}}))}_skeletonListener(){this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const{unitId:n,skeleton:r}=e,i=this._renderManagerService.getRenderById(n);if(i==null)return;const{scene:o,mainComponent:s}=i;this._textSelectionRenderManager.changeRuntime(r,o,s),this._textSelectionManagerService.setCurrentSelectionNotRefresh({unitId:n,subUnitId:""})})}_getDocObjectById(e){return kwe(e,this._renderManagerService)}};W3=zRe([yt(it.Rendered,W3),Jl(0,ne(Co)),Jl(1,oe),Jl(2,le),Jl(3,kn),Jl(4,Wl),Jl(5,ne(gr)),Jl(6,A5(H9))],W3);var WRe=Object.defineProperty,XRe=Object.getOwnPropertyDescriptor,YRe=(t,e,n,r)=>{for(var i=r>1?void 0:r?XRe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&WRe(e,n,i),i},ad=(t,e)=>(n,r)=>e(n,r,t);let X3=class extends je{constructor(e,n,r,i,o){super(),ln(this,"_initializedRender",new Set),this._docSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._textSelectionManagerService=o,this._initialize()}dispose(){super.dispose()}_initialize(){this._skeletonListener(),this._commandExecutedListener(),this._initialRenderRefresh()}_initialRenderRefresh(){this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const{unitId:n}=e,r=this._renderManagerService.getRenderById(n);if(r==null||this._initializedRender.has(n)||[Zr,Un].includes(n))return;this._initializedRender.add(n);const{scene:i}=r;this.disposeWithMe(Be(i.onMouseWheelObserver.add(o=>{if(!o.ctrlKey)return;const s=Math.abs(o.deltaX);let a=s<40?.2:s<80?.4:.2;a*=o.deltaY>0?-1:1,i.scaleX<1&&(a/=2);const l=this._currentUniverService.getCurrentUniverDocInstance(),u=l.zoomRatio;let c=+parseFloat(`${u+a}`).toFixed(1);c=c>=4?4:c<=.1?.1:c,this._commandService.executeCommand(yP.id,{zoomRatio:c,unitId:l.getUnitId()}),o.preventDefault()})))})}_skeletonListener(){this.disposeWithMe(Be(this._docSkeletonManagerService.currentSkeletonBefore$.subscribe(e=>{if(e==null)return;const n=this._currentUniverService.getCurrentUniverDocInstance().zoomRatio||1;this._updateViewZoom(n,!1)})))}_commandExecutedListener(){const e=[Lu.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(e.includes(n.id)){const r=this._currentUniverService.getCurrentUniverDocInstance(),i=n.params,{unitId:o}=i;if(o!==r.getUnitId())return;const s=r.zoomRatio||1;this._updateViewZoom(s)}}))}_updateViewZoom(e,n=!0){var r;const i=this._getDocObject();i!=null&&(i.scene.scale(e,e),this._calculatePagePosition(i,e),n&&this._textSelectionManagerService.refreshSelection(),(r=i.scene.getTransformer())==null||r.hideControl())}_calculatePagePosition(e,n){const{document:r,scene:i}=e,o=i==null?void 0:i.getParent(),{width:s,height:a,pageMarginLeft:l,pageMarginTop:u}=r;if(o==null||s===1/0||a===1/0)return;const{width:c,height:d}=o;let h=0,f=0,m=0,p=0,g=1/0;c>(s+l*2)*n?(h=c/2-s*n/2,h/=n,m=(c-l*2)/n,g=0):(h=l,m=s+l*2,g=(m-c/n)/2),d>a?(f=d/2-a/2,p=(d-u*2)/n):(f=u,p=a+u*2),i.resize(m,p+200),r.translate(h,f);const v=i.getViewport(Z2.VIEW_MAIN);if(g!==1/0&&v!=null){const _=v.getBarScroll(g,0).x;v.scrollTo({x:_})}return this}_getDocObject(){return I4(this._currentUniverService,this._renderManagerService)}};X3=YRe([yt(it.Rendered,X3),ad(0,ne(Co)),ad(1,oe),ad(2,le),ad(3,kn),ad(4,ne(gr))],X3);const GRe={id:ty.id,preconditions:t=>t.getContextValue(fi),binding:Xe.ENTER},KRe={id:ny.id,preconditions:t=>t.getContextValue(fi),binding:Xe.BACKSPACE},ZRe={id:fP.id,preconditions:t=>t.getContextValue(fi),binding:Xe.DELETE},qRe={id:_1.id,binding:Xe.ARROW_UP,preconditions:t=>t.getContextValue(fi),staticParameters:{direction:ge.UP}},QRe={id:_1.id,binding:Xe.ARROW_DOWN,preconditions:t=>t.getContextValue(fi),staticParameters:{direction:ge.DOWN}},JRe={id:_1.id,binding:Xe.ARROW_LEFT,preconditions:t=>t.getContextValue(fi),staticParameters:{direction:ge.LEFT}},eDe={id:_1.id,binding:Xe.ARROW_RIGHT,preconditions:t=>t.getContextValue(fi),staticParameters:{direction:ge.RIGHT}},tDe={id:Ml.id,binding:Xe.ARROW_UP|Ut.SHIFT,preconditions:t=>t.getContextValue(fi),staticParameters:{direction:ge.UP}},nDe={id:Ml.id,binding:Xe.ARROW_DOWN|Ut.SHIFT,preconditions:t=>t.getContextValue(fi),staticParameters:{direction:ge.DOWN}},rDe={id:Ml.id,binding:Xe.ARROW_LEFT|Ut.SHIFT,preconditions:t=>t.getContextValue(fi),staticParameters:{direction:ge.LEFT}},iDe={id:Ml.id,binding:Xe.ARROW_RIGHT|Ut.SHIFT,preconditions:t=>t.getContextValue(fi),staticParameters:{direction:ge.RIGHT}},oDe={id:SP.id,binding:Xe.A|Ut.CTRL_COMMAND,preconditions:t=>t.getContextValue(fi)||t.getContextValue(Dr)};var sDe=Object.defineProperty,aDe=Object.getOwnPropertyDescriptor,lDe=(t,e,n,r)=>{for(var i=r>1?void 0:r?aDe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&sDe(e,n,i),i},z7=(t,e)=>(n,r)=>e(n,r,t);let Y3=class extends E1{constructor(e,n,r,i){super(),ln(this,"_scene"),ln(this,"_currentDocumentModel"),ln(this,"_loadedMap",new Set),ln(this,"_fps$",new rn("")),ln(this,"fps$",this._fps$.asObservable()),this._renderManagerService=e,this._configService=n,this._currentUniverService=r,this._docViewModelManagerService=i,this._initialize()}_initialize(){this._currentUniverService.currentDoc$.subscribe(e=>{if(e==null)return;this._currentDocumentModel=e;const n=e.getUnitId();this._docViewModelManagerService.setCurrent(n),this._loadedMap.has(n)||(this._addNewRender(),this._loadedMap.add(n))})}dispose(){this._fps$.complete()}_addNewRender(){const e=this._currentDocumentModel,n=e.getUnitId(),r=e.getContainer(),i=e.getParentRenderUnitId();if(r!=null&&i!=null)throw new Error("container or parentRenderUnitId can only exist one");r==null&&i!=null?this._renderManagerService.createRenderWithParent(n,i):this._renderManagerService.createRender(n);const o=this._renderManagerService.getRenderById(n);if(o==null)return;const{scene:s,engine:a}=o;s.openTransformer(),this._scene=s;const l=new aa(Z2.VIEW_MAIN,s,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});s.addViewport(l).attachControl(),s.on(ca.wheel,(u,c)=>{const d=u;if(d.ctrlKey){const h=Math.abs(d.deltaX);let f=h<40?.2:h<80?.4:.2;f*=d.deltaY>0?-1:1,s.scaleX<1&&(f/=2),s.scaleX+f>4?s.scale(4,4):s.scaleX+f<.1?s.scale(.1,.1):d.preventDefault()}else l.onMouseWheel(d,c)}),this._configService.getConfig("hasScroll")!==!1&&n!==Un&&new b0(l),s.addLayer(new F6(s,[],t_),new F6(s,[],Awe)),this._addComponent(o),this._currentDocumentModel.getShouldRenderLoopImmediately()&&a.runRenderLoop(()=>{s.render(),this._fps$.next(Math.round(a.getFps()).toString())}),this._renderManagerService.setCurrent(n)}_addComponent(e){const n=this._scene,r=this._currentDocumentModel,i=new IA(e_.MAIN,void 0,{pageMarginLeft:r.documentStyle.marginLeft||0,pageMarginTop:r.documentStyle.marginTop||0});i.zIndex=Nwe,e.mainComponent=i,e.components.set(e_.MAIN,i),n.addObjects([i],t_)}};Y3=lDe([yt(it.Ready,Y3),z7(0,kn),z7(1,d0),z7(2,oe),z7(3,ne(v1))],Y3);var uDe=Object.defineProperty,cDe=Object.getOwnPropertyDescriptor,dDe=(t,e,n,r)=>{for(var i=r>1?void 0:r?cDe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&uDe(e,n,i),i},W7=(t,e)=>(n,r)=>e(n,r,t);const hDe={hasScroll:!0},fDe="docs";var tp;let i_=(tp=class extends S1{constructor(t={},e,n,r,i){super(fDe),ln(this,"_config"),this._injector=e,this._localeService=n,this._configService=r,this._currentUniverService=i,this._config=Object.assign(hDe,t),this._initializeDependencies(e),this._initializeCommands()}initialize(){}_initializeCommands(){[_1,Ml,ny,fP,q2,x4,M4,O4,xl,Yu,Q2,J2,T4,vP,ty,JC,ey,hP,pP,ry,Kt,_P,bP,yP,Lu,dP,SP,Qwe,qwe,oy].forEach(t=>{this._injector.get(le).registerCommand(t)}),[qRe,QRe,eDe,JRe,tDe,nDe,rDe,iDe,oDe,KRe,ZRe,GRe].forEach(t=>{this._injector.get(Xl).registerShortcut(t)})}onReady(){this.initialize()}_initializeDependencies(t){[[Y3],[Co],[v1],[iy],[RP,{useClass:r_}],[Wl,{useClass:Jpe}],[gr],[B3],[z3],[W3],[j3],[U3],[H3],[P3],[V3],[X3],[F3]].forEach(e=>t.add(e))}},ln(tp,"type",dr.Doc),tp);i_=dDe([W7(1,ne(Tn)),W7(2,ne(mn)),W7(3,d0),W7(4,oe)],i_);var mDe=Object.defineProperty,pDe=(t,e,n)=>e in t?mDe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Fe=(t,e,n)=>(pDe(t,typeof e!="symbol"?e+"":e,n),n);function gDe(t,e,n,r,i){for(let o=0,s=t.length;o<s;o++){const a=t[o];if(e!==a.unitId||n!==a.sheetId)continue;const{startRow:l,startColumn:u,endRow:c,endColumn:d}=a.range;if(r>=l&&r<=c&&i>=u&&i<=d)return!0}return!1}var ce=(t=>(t.DIV_BY_ZERO="#DIV/0!",t.NAME="#NAME!",t.VALUE="#VALUE!",t.NUM="#NUM!",t.NA="#N/A",t.CYCLE="#CYCLE!",t.REF="#REF!",t.SPILL="#SPILL!",t.CALC="#CALC!",t.ERROR="#ERROR!",t.CONNECT="#GETTING_DATA",t.NULL="#NULL!",t))(ce||{});const vDe=new Set(["#DIV/0!","#NAME!","#VALUE!","#NUM!","#N/A","#CYCLE!","#REF!","#SPILL!","#CALC!","#ERROR!","#GETTING_DATA","#NULL!"]);var uo=(t=>(t[t.Financial=0]="Financial",t[t.Date=1]="Date",t[t.Math=2]="Math",t[t.Statistical=3]="Statistical",t[t.Lookup=4]="Lookup",t[t.Database=5]="Database",t[t.Text=6]="Text",t[t.Logical=7]="Logical",t[t.Information=8]="Information",t[t.Engineering=9]="Engineering",t[t.Cube=10]="Cube",t[t.Compatibility=11]="Compatibility",t[t.Web=12]="Web",t[t.Array=13]="Array",t[t.Univer=14]="Univer",t))(uo||{}),$o=(t=>(t.PLUS="+",t.MINUS="-",t.MULTIPLY="*",t.DIVIDED="/",t.CONCATENATE="&",t.POWER="^",t.EQUALS="=",t.NOT_EQUAL="<>",t.GREATER_THAN=">",t.GREATER_THAN_OR_EQUAL=">=",t.LESS_THAN="<",t.LESS_THAN_OR_EQUAL="<=",t))($o||{}),St=(t=>(t.EQUALS="=",t.NOT_EQUAL="<>",t.GREATER_THAN=">",t.GREATER_THAN_OR_EQUAL=">=",t.LESS_THAN="<",t.LESS_THAN_OR_EQUAL="<=",t))(St||{});const G3=new Map([["<>",3],["<",3],[">=",3],["=",3],[">",3],["<=",3],["&",2],["+",2],["-",2],["/",1],["*",1],["^",0]]),$d=new Set(G3.keys()),_De=new Set(["=","<>",">",">=","<","<="]);var cn=(t=>(t.OPEN_BRACKET="(",t.CLOSE_BRACKET=")",t.COMMA=",",t.SINGLE_QUOTATION="'",t.DOUBLE_QUOTATION='"',t.OPEN_BRACES="{",t.CLOSE_BRACES="}",t.COLON=":",t.OPEN_SQUARE_BRACKET="[",t.CLOSE_SQUARE_BRACKET="]",t))(cn||{}),Ol=(t=>(t.PERCENTAGE="%",t.POUND="#",t))(Ol||{});const bDe=new Set(["%","#"]);var ri=(t=>(t.AT="@",t.MINUS="-",t))(ri||{});const DP=[...Object.values(St),...Object.values($o),...Object.values(cn),...Object.values(Ol),...Object.values(ri)];function o_(t){return DP.includes(t)}function CDe(t){for(const e of DP)if(t.indexOf(e)>-1)return!0;return!1}function yDe(t){return t[0]==="'"&&t[t.length-1]==="'"?t.substring(1,t.length-1):t}function IP(t){const e={};return Object.keys(t).forEach(n=>{const r=t[n];e[n]==null&&(e[n]={}),Object.keys(r).forEach(i=>{const o=r[i];e[n][i]=new nt(o)})}),e}let rf=class{constructor(e){Fe(this,"_cache"),this._cache=new U5(e)}set(e,n){const r=this._hash(e);this._cache.set(r,n)}get(e){const n=this._hash(e);return this._cache.get(n)}clear(){this._cache.clear()}_hash(e){return WV(e)}};const y0=`'?\\[((?![\\/?:"<>|*\\\\]).)*\\]`,S0="((?![\\[\\]\\/?*\\\\]).)*!",Tl="$",ly="\\s*?:\\s*?",s_=`\\${Tl}?[A-Za-z]+\\${Tl}?[0-9]+`,SDe=`^(${ri.AT})?(${y0})?(${S0})?${s_}${ly}${s_}$`,uy=`^(${y0})?(${S0})?\\s*?${s_}(${Ol.POUND})?$`,EDe=`^(${y0})?(${S0})?\\${Tl}?[0-9]+${ly}\\${Tl}?[0-9]+$`,wDe=`^(${y0})?(${S0})?\\${Tl}?[A-Za-z]+${ly}\\${Tl}?[A-Za-z]+$`,RDe=`^(${y0})?(${S0})?\\s*?\\${Tl}?[0-9]+$`,DDe=`^(${y0})?(${S0})?\\s*?\\${Tl}?[A-Za-z]+$`,xP="[.*?]",IDe="{.*?}";function xDe(t){return new RegExp(uy).test(t)||new RegExp(SDe).test(t)||new RegExp(EDe).test(t)||new RegExp(wDe).test(t)}const vu="P_1",El="R_1",e0="L_1",of="LR_1",MP="LO_1",MDe="LET",z6="LAMBDA";var Hr=(t=>(t[t.NORMAL=0]="NORMAL",t[t.NUMBER=1]="NUMBER",t[t.STRING=2]="STRING",t[t.FUNCTION=3]="FUNCTION",t[t.REFERENCE=4]="REFERENCE",t[t.ARRAY=5]="ARRAY",t))(Hr||{});function cy(t){let e="";for(const n of t)typeof n=="string"?e+=n:e+=n.token;return e}class bn{constructor(){Fe(this,"_parent"),Fe(this,"_token",El),Fe(this,"_children",[]),Fe(this,"_lambdaId"),Fe(this,"_functionDefinitionPrivacyVar"),Fe(this,"_lambdaParameter",""),Fe(this,"_startIndex",-1),Fe(this,"_endIndex",-1)}dispose(){var e;this._children.forEach(n=>{typeof n!="string"&&n.dispose()}),(e=this._functionDefinitionPrivacyVar)==null||e.clear(),this._parent=null}getStartIndex(){return this._startIndex}getLambdaId(){return this._lambdaId}setLambdaId(e){this._lambdaId=e}getFunctionDefinitionPrivacyVar(){return this._functionDefinitionPrivacyVar}setLambdaPrivacyVar(e){this._functionDefinitionPrivacyVar=e}getLambdaParameter(){return this._lambdaParameter}setLambdaParameter(e){this._lambdaParameter=e}getParent(){return this._parent}setParent(e){this._parent=e}getChildren(){return this._children}setChildren(e){this._children=e}addChildren(e){this._children.push(e)}addChildrenFirst(e){this._children.unshift(e)}getToken(){return this._token}setToken(e){this._token=e}setIndex(e,n){this._startIndex=e,this._endIndex=n}replaceChild(e,n){const r=this._getIndexInParent(e);r!=null&&(this.getChildren().splice(r,1,n),n.setParent(this))}changeToParent(e){const n=this.getParent();n&&n.removeChild(this),this.setParent(e),e.getChildren().push(this)}removeChild(e){const n=this._getIndexInParent(e);n!=null&&this.getChildren().splice(n,1)}serialize(){const e=this.getToken(),n=this.getChildren(),r=[],i=n.length;for(let o=0;o<i;o++){const s=n[o];s instanceof bn?r.push(s.serialize()):r.push(s)}return{token:e,st:this._startIndex,ed:this._endIndex,children:r}}_getIndexInParent(e){const n=this.getChildren(),r=n.length;for(let i=0;i<r;i++)if(n[i]===e)return i}}const OP=1e5,np=new rf(OP),rp=new rf(OP);let Ba=class extends je{constructor(){super(...arguments),Fe(this,"_currentLexerNode",new bn),Fe(this,"_upLevel",0),Fe(this,"_segment",""),Fe(this,"_bracketState",[]),Fe(this,"_squareBracketState",0),Fe(this,"_bracesState",0),Fe(this,"_singleQuotationState",0),Fe(this,"_doubleQuotationState",0),Fe(this,"_lambdaState",!1),Fe(this,"_colonState",!1),Fe(this,"_tableBracketState",!1)}dispose(){this._resetTemp(),this._currentLexerNode.dispose(),np.clear(),rp.clear()}getUpLevel(){return this._upLevel}isColonClose(){return this._colonState===!1}isColonOpen(){return this._colonState===!0}isDoubleQuotationClose(){return this._doubleQuotationState===0}isLambdaOpen(){return this._lambdaState===!0}isLambdaClose(){return this._lambdaState===!1}isSingleQuotationClose(){return this._singleQuotationState===0}isBracesClose(){return this._bracesState===0}isBracketClose(){return this._bracketState.length===0}isSquareBracketClose(){return this._squareBracketState===0}getCurrentLexerNode(){return this._currentLexerNode}getFunctionAndParameter(e,n){const r=this._getCurrentParamIndex(e,n);if(r==null||r===ce.VALUE)return;const i=r[0];if(typeof i=="string")return;let o=i.getParent(),s=i;for(;o;){const a=o.getToken();if(a!==vu&&!o_(a)&&o.getStartIndex()!==-1){const l=o.getChildren().indexOf(s);return{functionName:a,paramIndex:l}}s=o,o=o.getParent()}}moveFormulaRefOffset(e,n,r){const i=this.sequenceNodesBuilder(e);if(i==null)return e;const o=[];for(let s=0,a=i.length;s<a;s++){const l=i[s];if(typeof l=="string"||l.nodeType!==Hr.REFERENCE){o.push(l);continue}const{token:u}=l,c=xa(u),{range:d,sheetName:h,unitId:f}=c,m=pt.moveOffset(d,n,r);let p="";UV(m)?p=Bd({range:m,unitId:f,sheetName:h}):p=ce.REF,o.push({...l,token:p})}return`=${cy(o)}`}checkIfAddBracket(e){let n=0,r=e.length-1,i=e[r];for(;(i===cn.CLOSE_BRACKET||i===" ")&&r>=0;)i===cn.CLOSE_BRACKET&&n++,i=e[--r];const o=this._getCurrentParamIndex(e,e.length-2);if(o==null||o===ce.VALUE)return 0;const s=o[0];if(typeof s=="string")return 0;let a=s.getParent(),l=0;for(;a;){const u=a.getToken();u!==vu&&u!==cn.COLON&&a.getStartIndex()!==-1&&u.toUpperCase()!==z6&&(n===0?l+=1:n--),a=a.getParent()}return l}sequenceNodesBuilder(e){const n=rp.get(e);if(n)return[...n];const r=this._getSequenceArray(e);if(r.length===0)return;const i=this.getSequenceNode(r);return rp.set(e,[...i]),i}getSequenceNode(e){const n=[];let r=!1;for(let i=0,o=e.length;i<o;i++){const s=e[i],a=e[i-1],{segment:l,currentString:u,cur:c}=s;if(u===cn.DOUBLE_QUOTATION&&(r=!0),(l!==""||i===0)&&i!==o-1){n.push(u);continue}let d=(a==null?void 0:a.segment)||"";const h=i-d.length;let f=i-1;const m=i-1;if(i===o-1&&this._isLastMergeString(u)&&(d+=u,f+=1),d===""||G3.has(d)){n.push(u);continue}const p=d.trim(),g=this._replacePrefixString(p);r===!0&&p[p.length-1]===cn.DOUBLE_QUOTATION?(r=!1,this._pushSequenceNode(n,{nodeType:Hr.STRING,token:d,startIndex:h,endIndex:f},m)):new RegExp(uy).test(g)?this._pushSequenceNode(n,{nodeType:Hr.REFERENCE,token:d,startIndex:h,endIndex:f},m):De.isStringNumber(p)?this._pushSequenceNode(n,{nodeType:Hr.NUMBER,token:d,startIndex:h,endIndex:f},m):p.length>0&&this._pushSequenceNode(n,{nodeType:Hr.FUNCTION,token:d,startIndex:h,endIndex:f},m),(i!==o-1||!this._isLastMergeString(u))&&n.push(u)}return this._mergeSequenceNodeReference(n)}_getCurrentParamIndex(e,n){return this._nodeMaker(e,void 0,n)}_isLastMergeString(e){return e===cn.DOUBLE_QUOTATION||De.isStringNumber(e)||!o_(e)}_mergeSequenceNodeReference(e){const n=[],r=e.length;let i=0;for(;i<r;){const o=e[i];if(typeof o=="string"){const s=e[i-1];if(o.trim()===cn.CLOSE_BRACES&&s!=null&&typeof s!="string"&&s.nodeType===Hr.FUNCTION&&s.token.trim().substring(0,1)===cn.OPEN_BRACES){s.nodeType=Hr.ARRAY,s.token+=o,s.endIndex+=o.length,i++;continue}n.push(o)}else{const s=e[i+1],a=e[i+2];s===cn.COLON&&typeof o!="string"&&a!=null&&typeof a!="string"&&xDe((o.token+s+a.token).trim())&&(o.nodeType=Hr.REFERENCE,o.token+=s+a.token,o.endIndex=a.endIndex,i+=2),n.push(o)}i++}return n}_pushSequenceNode(e,n,r){const i=r-n.startIndex+1;e.splice(e.length-i,i,n)}_replacePrefixString(e){return e.replace(new RegExp(ri.AT,"g"),"").replace(new RegExp(ri.MINUS,"g"),"")}nodeMakerTest(e){return this._nodeMaker(e)}treeBuilder(e,n=!0,r){if(n===!0){const u=np.get(e);if(u)return u}this._resetCurrentLexerNode(),this._currentLexerNode.setToken(El);const i=[];let o=this._nodeMaker(e,i);if(o===ce.VALUE||i.length===0)return o;let s=!1,a="";if(r){const{hasDefinedName:u,sequenceString:c}=r(i);s=u,a=c}if(s&&(this._resetCurrentLexerNode(),this._currentLexerNode.setToken(El),o=this._nodeMaker(`=${a}`),o===ce.VALUE))return o;const l=this._getTopNode(this._currentLexerNode);return l&&(this._currentLexerNode=l),n&&(this._suffixExpressionHandler(this._currentLexerNode),np.set(e,this._currentLexerNode)),this._currentLexerNode}_suffixExpressionHandler(e){var n,r;const i=e.getChildren();if(!i)return;const o=i.length,s=[],a=[];for(let l=0;l<o;l++){const u=i[l];if(u instanceof bn)this._suffixExpressionHandler(u),s.push(u);else{const c=u.trim();if(c==="")continue;if($d.has(c)){for(;a.length>0;){const d=(n=a[a.length-1])==null?void 0:n.trim();if(!d||d===cn.OPEN_BRACKET)break;const h=G3.get(d),f=G3.get(c);if(!h||!f)break;if(f>h)s.push(a.pop());else break}a.push(u)}else if(c===cn.OPEN_BRACKET)a.push(u);else if(c===cn.CLOSE_BRACKET)for(;a.length>0;){const d=(r=a[a.length-1])==null?void 0:r.trim();if(!d)break;if(d===cn.OPEN_BRACKET){a.pop();break}s.push(a.pop())}else s.push(u)}}for(;a.length>0;)s.push(a.pop());e.setChildren(s)}_resetCurrentLexerNode(){this._currentLexerNode=new bn}_resetSegment(){this._segment=""}_openBracket(e=0){this._bracketState.push(e)}_closeBracket(){this._bracketState.pop()}_openSquareBracket(){this._squareBracketState+=1}_closeSquareBracket(){this._squareBracketState-=1}_getCurrentBracket(){const e=this._bracketState;return e[e.length-1]}_openBraces(){this._bracesState+=1}_closeBraces(){this._bracesState-=1}_openSingleQuotation(){this._singleQuotationState+=1}_closeSingleQuotation(){this._singleQuotationState-=1}_openDoubleQuotation(){this._doubleQuotationState+=1}_closeDoubleQuotation(){this._doubleQuotationState-=1}_openLambda(){this._lambdaState=!0}_closeLambda(){this._lambdaState=!1}_openColon(e){this._upLevel=e,this._colonState=!0}_closeColon(){this._upLevel=0,this._colonState=!1}_isTableBracket(){return this._tableBracketState}_openTableBracket(){this._tableBracketState=!0}_closeTableBracket(){this._tableBracketState=!1}_getLastChildCurrentLexerNode(){const e=this._currentLexerNode.getChildren();if(e&&e.length>0){const n=e[e.length-1];if(n instanceof bn)return n}return!1}_getLastChildCurrent(){const e=this._currentLexerNode.getChildren();return e&&e.length>0?e[e.length-1]:!1}_setParentCurrentLexerNode(){const e=this._currentLexerNode.getParent();return e?(this._currentLexerNode=e,!0):!1}_setAncestorCurrentLexerNode(){var e,n,r,i,o,s;const a=(e=this._currentLexerNode)==null?void 0:e.getParent();let l=!1;if(a&&a.getToken()===e0){if((n=a==null?void 0:a.getParent())!=null&&n.getParent()){const u=(i=(r=this._currentLexerNode.getParent())==null?void 0:r.getParent())==null?void 0:i.getParent();u&&(this._currentLexerNode=u),l=!0}}else if(a!=null&&a.getParent()){const u=(o=this._currentLexerNode.getParent())==null?void 0:o.getParent();u&&(this._currentLexerNode=u),l=!0}for(let u=0;u<this._upLevel;u++){const c=(s=this._currentLexerNode)==null?void 0:s.getParent();c&&(this._currentLexerNode=c),this._currentLexerNode?l=!0:l=!1}return l}_segmentCount(){return this._segment.trim().length}_pushSegment(e){this._segment+=e}_pushNodeToChildren(e,n=!1){if(e!==""){const r=this._currentLexerNode.getChildren();if(!(e instanceof bn)&&this.isColonOpen()){const i=new bn;i.setToken(e),i.setParent(this._currentLexerNode),e=i}n?r.unshift(e):r.push(e)}this.isColonOpen()&&(this._setAncestorCurrentLexerNode(),this._closeColon())}_setCurrentLexerNode(e,n=!1){this._pushNodeToChildren(e,n),e.setParent(this._currentLexerNode),this._currentLexerNode=e}_newAndPushCurrentLexerNode(e,n,r=!1){const i=new bn;i.setToken(e),i.setIndex(n-e.length,n-1),this._setCurrentLexerNode(i,r)}_getTopNode(e){let n=e;for(;n!=null&&n.getParent();)n=n.getParent();return n}_removeLastChild(){this._currentLexerNode.getChildren().splice(-1)}_findPreviousToken(e,n){for(;n>=0;){const r=e[n];if(r!==" ")return r;n--}}_negativeCondition(e){return!!($d.has(e)||e===cn.OPEN_BRACKET||e===cn.COMMA||e==="")}_getSequenceArray(e){const n=[];return this._nodeMaker(e,n),n}_resetTemp(){this._currentLexerNode=new bn,this._upLevel=0,this._segment="",this._bracketState=[],this._bracesState=0,this._singleQuotationState=0,this._doubleQuotationState=0,this._lambdaState=!1,this._colonState=!1}_nodeMaker(e,n,r){e.substring(0,1)===$o.EQUALS&&(e=e.substring(1));const i=e.split(""),o=i.length;let s=0;for(this._resetTemp();s<o;){const a=i[s];if(r===s)return[this._currentLexerNode,a];if(a===cn.OPEN_BRACKET&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())if(this._segmentCount()>0||this.isLambdaOpen()){this.isLambdaClose()&&(this._newAndPushCurrentLexerNode(this._segment,s),this._resetSegment()),this._openBracket(1),this._closeLambda();const l=i[s+1];if(l&&l===cn.CLOSE_BRACKET){if(!this._setParentCurrentLexerNode()&&s!==o-1)return ce.VALUE;s++}else l&&this._newAndPushCurrentLexerNode(vu,s)}else this._pushNodeToChildren(a),this._openBracket(0);else if(a===cn.CLOSE_BRACKET&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()){this._pushNodeToChildren(this._segment),this._resetSegment();const l=this._getCurrentBracket();if(l===0)this._pushNodeToChildren(a);else if(l===1){const u=i[s+1];if(u&&u===cn.OPEN_BRACKET){if(!this._setParentCurrentLexerNode()&&s!==o-1)return ce.VALUE;this._newAndPushCurrentLexerNode(e0,s,!0),this._openLambda()}else if(!this._setAncestorCurrentLexerNode()&&s!==o-1)return ce.VALUE}else return ce.VALUE;this._closeBracket()}else if(a===cn.OPEN_BRACES&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())this._pushSegment(a),this._openBraces();else if(a===cn.CLOSE_BRACES&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())this._pushSegment(a),this._pushNodeToChildren(this._segment),this._resetSegment(),this._closeBraces();else if(a===cn.OPEN_SQUARE_BRACKET&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())this._segment.length>0&&this._openTableBracket(),this._pushSegment(a),this._openSquareBracket();else if(a===cn.CLOSE_SQUARE_BRACKET&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())this._closeSquareBracket(),this.isSquareBracketClose()?(this._pushSegment(a),this._isTableBracket()&&(this._pushNodeToChildren(this._segment),this._resetSegment()),this._closeTableBracket()):this._pushSegment(a);else if(a===cn.DOUBLE_QUOTATION&&this.isSingleQuotationClose()&&this.isBracesClose()&&this.isSquareBracketClose()){if(this.isDoubleQuotationClose())this._openDoubleQuotation();else{const l=i[s+1];l&&l===cn.DOUBLE_QUOTATION?s++:this._closeDoubleQuotation()}this._pushSegment(a)}else if(a===cn.SINGLE_QUOTATION&&this.isDoubleQuotationClose()){if(this.isSingleQuotationClose())this._openSingleQuotation();else{const l=i[s+1];l&&l===cn.SINGLE_QUOTATION?s++:this._closeSingleQuotation()}this._pushSegment(a)}else if(a===cn.COMMA&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()&&this.isBracesClose()&&this.isSquareBracketClose()){const l=this._getCurrentBracket();if(l===1||l==null){if(this._pushNodeToChildren(this._segment),this._resetSegment(),!this._setParentCurrentLexerNode()&&s!==o-1&&l!=null)return ce.VALUE;this._newAndPushCurrentLexerNode(vu,s)}else return ce.VALUE}else if(a===cn.COLON&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()&&this.isBracesClose()&&this.isSquareBracketClose()){const l=new bn;l.setToken(a);const u=new bn;u.setToken(vu),u.setParent(l);const c=new bn;c.setToken(vu),c.setParent(l),l.getChildren().push(u,c);let d=l,h=0;if(this._segmentCount()>0){let f,m,p=0;const g=this._segment.trim(),v=g[0],_=g[1];if(v===ri.MINUS&&(f=new bn,f.setToken(ri.MINUS),p++),(v===ri.AT||_===ri.AT)&&(m=new bn,m.setToken(ri.AT),f&&(f.addChildren(m),m.setParent(f)),p++),p>0&&(this._segment=g.slice(p)),h=p,m)if(m.addChildren(l),l.setParent(m),m.getParent()){const y=m.getParent();y&&(d=y)}else d=m;else f&&(d=f,f.addChildren(l),l.setParent(f));const C=new bn;C.setToken(this._segment),C.setParent(u),u.getChildren().push(C),this._resetSegment()}else{const f=this._getLastChildCurrentLexerNode();f&&f.changeToParent(u)}this._setCurrentLexerNode(d),this._currentLexerNode=c,this._openColon(h)}else if(bDe.has(a)&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()&&this.isSquareBracketClose()){this._pushNodeToChildren(this._segment);const l=new bn;l.setToken(a);const u=this._getLastChildCurrent();u instanceof bn?u.changeToParent(l):u!==!1&&(l.getChildren().push(u),this._removeLastChild()),this._pushNodeToChildren(l),l.setParent(this._currentLexerNode),this._resetSegment()}else if($d.has(a)&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()&&this.isSquareBracketClose()){let l=this._segment.trim();if(a===$o.MINUS&&l===""){const u=this._findPreviousToken(i,s-1)||"";if(this._negativeCondition(u)){this._pushSegment($o.MINUS),n==null||n.push({segment:this._segment,currentString:a,cur:s,currentLexerNode:this._currentLexerNode}),s++;continue}}else this._segment.length>0&&l===""?l=this._segment:(this._pushNodeToChildren(this._segment),l="");if(a===$o.LESS_THAN||a===$o.GREATER_THAN){const u=i[s+1];u&&$d.has(a+u)?(this._pushNodeToChildren(l+a+u),s++):this._pushNodeToChildren(l+a)}else this._pushNodeToChildren(l+a);this._resetSegment()}else this._pushSegment(a);n==null||n.push({segment:this._segment,currentString:a,cur:s,currentLexerNode:this._currentLexerNode}),s++}this._pushNodeToChildren(this._segment)}};var ODe=Object.defineProperty,TDe=Object.getOwnPropertyDescriptor,$De=(t,e,n,r)=>{for(var i=r>1?void 0:r?TDe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&ODe(e,n,i),i},fD=(t,e)=>(n,r)=>e(n,r,t);let Vo=class extends je{constructor(e,n){super(),Fe(this,"_formulaData",{}),Fe(this,"_arrayFormulaRange",{}),Fe(this,"_arrayFormulaCellData",{}),this._currentUniverService=e,this._lexerTreeBuilder=n}clearPreviousArrayFormulaCellData(e){Object.keys(e).forEach(n=>{const r=e[n];Object.keys(r).forEach(i=>{var o,s;const a=r[i],l=(s=(o=this._arrayFormulaRange)==null?void 0:o[n])==null?void 0:s[i];if(l==null)return!0;let u=new nt;this._arrayFormulaCellData[n][i]!=null&&(u=new nt(this._arrayFormulaCellData[n][i])),a.forValue((c,d)=>{var h;const f=(h=l==null?void 0:l[c])==null?void 0:h[d];if(f==null)return!0;const{startRow:m,startColumn:p,endRow:g,endColumn:v}=f;for(let _=m;_<=g;_++)for(let C=p;C<=v;C++)u.setValue(_,C,null)}),this._arrayFormulaCellData[n][i]=u.getData()})})}mergeArrayFormulaCellData(e){Object.keys(e).forEach(n=>{const r=e[n];this._arrayFormulaRange[n]==null&&(this._arrayFormulaRange[n]={}),this._arrayFormulaCellData[n]==null&&(this._arrayFormulaCellData[n]={}),Object.keys(r).forEach(i=>{const o=r[i];let s=new nt,a=new nt;this._arrayFormulaRange[n][i]!=null&&(s=new nt(this._arrayFormulaRange[n][i])),this._arrayFormulaCellData[n][i]!=null&&(a=new nt(this._arrayFormulaCellData[n][i])),o.forValue((l,u)=>{const c=s==null?void 0:s.getValue(l,u);if(c==null)return!0;const{startRow:d,startColumn:h,endRow:f,endColumn:m}=c;for(let p=d;p<=f;p++)for(let g=h;g<=m;g++)a.setValue(p,g,null)}),o.forValue((l,u,c)=>{a.setValue(l,u,c)}),this._arrayFormulaCellData[n][i]=a.getData()})})}getFormulaData(){return this._formulaData}setFormulaData(e){this._formulaData=e}setArrayFormulaRange(e){this._arrayFormulaRange=e}getArrayFormulaRange(){return this._arrayFormulaRange}setArrayFormulaCellData(e){this._arrayFormulaCellData=e}getArrayFormulaCellData(){return this._arrayFormulaCellData}mergeArrayFormulaRange(e){Object.keys(e).forEach(n=>{const r=e[n];this._arrayFormulaRange[n]||(this._arrayFormulaRange[n]={}),Object.keys(r).forEach(i=>{const o=new nt(r[i]);let s=new nt;this._arrayFormulaRange[n][i]&&(s=new nt(this._arrayFormulaRange[n][i])),o.forValue((a,l,u)=>{s.setValue(a,l,u)}),this._arrayFormulaRange[n][i]=s.getData()})})}deleteArrayFormulaRange(e,n,r,i){var o;const s=(o=this._arrayFormulaRange[e])==null?void 0:o[n];if(s==null)return;const a=new nt(s);a.getValue(r,i)&&(a.realDeleteValue(r,i),this._arrayFormulaRange[e][n]=a.getData())}initFormulaData(){this._currentUniverService.getAllUniverSheetsInstance();const e=this._currentUniverService.getCurrentUniverSheetInstance(),n=e.getUnitId();this._formulaData[n]={},e.getSheets().forEach(r=>{const i=r.getCellMatrix(),o=r.getSheetId();TP(this._formulaData,n,o,i)})}getCalculateData(){const e=this._currentUniverService.getAllUniverSheetsInstance(),n={},r={};for(const i of e){const o=i.getUnitId(),s=i.getSheets(),a={},l={};for(const u of s){const c=u.getSheetId(),d=u.getConfig();a[c]={cellData:new nt(d.cellData),rowCount:d.rowCount,columnCount:d.columnCount},l[u.getName()]=u.getSheetId()}n[o]=a,r[o]=l}return{allUnitData:n,unitSheetNameMap:r}}updateFormulaData(e,n,r){const i=new nt(r),o=this.getFormulaIdMap(e,n),s=new Map,a=this._formulaData;a[e]==null&&(a[e]={});const l=a[e];l[n]==null&&(l[n]={});const u=new nt(l[n]);i.forValue((c,d,h)=>{const f=(h==null?void 0:h.f)||"",m=(h==null?void 0:h.si)||"",p=Ao(f),g=q1(m);if(p&&g)u.setValue(c,d,{f,si:m}),o.set(m,{f,r:c,c:d});else if(p&&!g)u.setValue(c,d,{f});else if(!p&&g)u.setValue(c,d,{f:"",si:m});else if(!p&&!g&&u.getValue(c,d)){const v=u.getValue(c,d),_=(v==null?void 0:v.f)||"",C=(v==null?void 0:v.si)||"";Ao(_)&&q1(C)&&s.set(C,_),u.realDeleteValue(c,d)}}),u.forValue((c,d,h)=>{const f=(h==null?void 0:h.f)||"",m=(h==null?void 0:h.si)||"";if(q1(m)){const p=o.get(m),g=s.get(m);if(p&&!Ao(f)){const v=p.f,_=d-p.c,C=c-p.r;u.setValue(c,d,{f:v,si:m,x:_,y:C})}else if(typeof g=="string"){const v=h.x||0,_=h.y||0,C=this._lexerTreeBuilder.moveFormulaRefOffset(g,v,_);s.set(m,{r:c,c:d,f:C}),u.setValue(c,d,{f:C,si:m})}else if(typeof g=="object"){const v=d-g.c,_=c-g.r;u.setValue(c,d,{f:g.f,si:m,x:v,y:_})}}})}getFormulaItemBySId(e,n,r){const i=this._formulaData;if(i[r]==null)return null;const o=i[r];if(o[n]==null)return null;const s=new nt(o[n]);let a=null;return s.forValue((l,u,c)=>{const{f:d,si:h,x:f=0,y:m=0}=c;if(h===e&&d.length>0&&f===0&&m===0)return a=c,!1}),a}getFormulaDataItem(e,n,r,i){var o,s,a,l;return(l=(a=(s=(o=this._formulaData)==null?void 0:o[i])==null?void 0:s[r])==null?void 0:a[e])==null?void 0:l[n]}getFormulaIdMap(e,n){const r=new Map,i=this._formulaData;if(i[e]==null)return r;const o=i[e];return o[n]==null||new nt(o[n]).forValue((s,a,l)=>{const u=(l==null?void 0:l.f)||"",c=(l==null?void 0:l.si)||"",d=(l==null?void 0:l.x)||0,h=(l==null?void 0:l.y)||0;Ao(u)&&q1(c)&&d===0&&h===0&&r.set(c,{f:u,r:s,c:a})}),r}};Vo=$De([fD(0,oe),fD(1,ne(Ba))],Vo);function TP(t,e,n,r){const i=new Map,o=new nt;r.forValue((s,a,l)=>{const u=(l==null?void 0:l.f)||"",c=(l==null?void 0:l.si)||"",d=Ao(u),h=q1(c);d&&h?(o.setValue(s,a,{f:u,si:c}),i.set(c,{f:u,r:s,c:a})):d&&!h?o.setValue(s,a,{f:u}):!d&&h&&o.setValue(s,a,{f:"",si:c})}),o.forValue((s,a,l)=>{const u=(l==null?void 0:l.f)||"",c=(l==null?void 0:l.si)||"";if(q1(c)&&!Ao(u)){const d=i.get(c);if(d){const h=d.f,f=a-d.c,m=s-d.r;o.setValue(s,a,{f:h,si:c,x:f,y:m})}}}),t[e][n]=o.getData()}const t0={id:"formula.mutation.set-array-formula-data",type:se.MUTATION,handler:(t,e)=>{const n=t.get(Vo);return n.setArrayFormulaRange(e.arrayFormulaRange),n.setArrayFormulaCellData(e.arrayFormulaCellData),!0}},dy={id:"formula.mutation.set-defined-name",type:se.MUTATION,handler:()=>!0},hy={id:"formula.mutation.remove-defined-name",type:se.MUTATION,handler:()=>!0},$P={id:"formula.mutation.set-feature-calculation",type:se.MUTATION,handler:()=>!0},kP={id:"formula.mutation.remove-feature-calculation",type:se.MUTATION,handler:()=>!0},c5={id:"formula.mutation.set-formula-calculation-start",type:se.MUTATION,handler:()=>!0},AP={id:"formula.mutation.set-formula-calculation-stop",type:se.MUTATION,handler:()=>!0},d5={id:"formula.mutation.set-formula-calculation-notification",type:se.MUTATION,handler:()=>!0},sf={id:"formula.mutation.set-formula-calculation-result",type:se.MUTATION,handler:()=>!0},y2={id:"formula.mutation.set-formula-data",type:se.MUTATION,handler:(t,e)=>(t.get(Vo).setFormulaData(e.formulaData),!0)},NP={id:"formula.mutation.set-other-formula",type:se.MUTATION,handler:()=>!0},LP={id:"formula.mutation.remove-other-formula",type:se.MUTATION,handler:()=>!0},kDe={id:"formula.mutation.set-super-table",type:se.MUTATION,handler:()=>!0},ADe={id:"formula.mutation.remove-super-table",type:se.MUTATION,handler:()=>!0},PP={id:"formula.mutation.set-super-table-option",type:se.MUTATION,handler:()=>!0};let af=class extends je{isError(){return!1}isAsyncObject(){return!1}isAsyncArrayObject(){return!1}isReferenceObject(){return!1}isValueObject(){return!1}isEqualType(e){return!1}};var Gu=(t=>(t.FALSE="FALSE",t.TRUE="TRUE",t))(Gu||{}),ol=(t=>(t[t.SUCCESS=0]="SUCCESS",t[t.ERROR=1]="ERROR",t))(ol||{}),_u=(t=>(t.ALL="#All",t.DATA="#Data",t.HEADERS="#Headers",t.TOTALS="#Totals",t))(_u||{}),Ps=(t=>(t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK",t))(Ps||{});let NDe=class{constructor(){Fe(this,"_cache",new Map),Fe(this,"_continueBuildingCache",new Map)}set(e,n,r,i,o){if(!this.shouldContinueBuildingCache(e,n,r,o))return;let s=this._cache.get(e);s==null&&(s=new Map,this._cache.set(e,s));let a=s.get(n);a==null&&(a=new Map,s.set(n,a));let l=a.get(r);l==null&&(l=new Map,a.set(r,l));let u=l.get(i);u==null&&(u=[],l.set(i,u)),u.push(o)}getCellValuePositions(e,n,r){var i,o;return(o=(i=this._cache.get(e))==null?void 0:i.get(n))==null?void 0:o.get(r)}getCellPositions(e,n,r,i){var o,s,a;return(a=(s=(o=this._cache.get(e))==null?void 0:o.get(n))==null?void 0:s.get(r))==null?void 0:a.get(i)}getCellPosition(e,n,r,i,o,s){const a=this.getCellPositions(e,n,r,i);if(a!=null){for(const l of a)if(l>=o&&l<=s)return l}}setContinueBuildingCache(e,n,r,i,o){let s=this._continueBuildingCache.get(e);s==null&&(s=new Map,this._continueBuildingCache.set(e,s));let a=s.get(n);a==null&&(a=new Map,s.set(n,a));let l=a.get(r);if(l==null){l={startRow:i,endRow:o},a.set(r,l);return}l.startRow=Math.min(l.startRow,i),l.endRow=Math.max(l.endRow,o)}shouldContinueBuildingCache(e,n,r,i){var o,s;const a=(s=(o=this._continueBuildingCache.get(e))==null?void 0:o.get(n))==null?void 0:s.get(r);if(a==null)return!0;const{startRow:l,endRow:u}=a;return!(i>=l&&i<=u)}canUseCache(e,n,r,i,o){var s,a;const l=(a=(s=this._continueBuildingCache.get(e))==null?void 0:s.get(n))==null?void 0:a.get(r);if(l==null)return!1;const{startRow:u,endRow:c}=l;return!(i>c||o<u)}clear(){this._cache.clear(),this._continueBuildingCache.clear()}};const bu=new NDe;function LDe(){return new Intl.Collator(void 0,{numeric:!0}).compare}function PDe(t){return t.indexOf("*")>-1||t.indexOf("?")>-1}function mD(t,e){const n=e.replace(/~?[*?]/g,r=>r.startsWith("~")?`\\${r.substring(1)}`:r==="*"?".*":r==="?"?".":r);return new RegExp(`^${n}$`).test(t)}function pD(t){return t.replace(/~?[*?]/g,e=>e.startsWith("~")?e.substring(1):" ")}function BDe(t,e,n){let r=!1;switch(n){case St.EQUALS:r=mD(t,e);break;case St.GREATER_THAN:case St.GREATER_THAN_OR_EQUAL:r=mD(t,e)||t>pD(e);break;case St.LESS_THAN:case St.LESS_THAN_OR_EQUAL:r=t<pD(e);break}return r}let dc=class extends af{constructor(e){super(),this._rawValue=e}isValueObject(){return!0}getValue(){return 0}getArrayValue(){return[]}setValue(e){}setArrayValue(e){}isArray(){return!1}isString(){return!1}isNumber(){return!1}isBoolean(){return!1}isLambda(){return!1}isError(){return!1}isNull(){return!1}getNegative(){return me.create(ce.NAME)}getReciprocal(){return me.create(ce.NAME)}plus(e){return me.create(ce.NAME)}minus(e){return me.create(ce.NAME)}multiply(e){return me.create(ce.NAME)}divided(e){return me.create(ce.NAME)}map(e){return me.create(ce.NAME)}product(e,n){return n(this,e)}compare(e,n){return me.create(ce.NAME)}wildcard(e,n){return me.create(ce.NAME)}isEqual(e){return this.compare(e,St.EQUALS)}isNotEqual(e){return this.compare(e,St.NOT_EQUAL)}isGreaterThanOrEqual(e){return this.compare(e,St.GREATER_THAN_OR_EQUAL)}isLessThanOrEqual(e){return this.compare(e,St.LESS_THAN_OR_EQUAL)}isLessThan(e){return this.compare(e,St.LESS_THAN)}isGreaterThan(e){return this.compare(e,St.GREATER_THAN)}concatenateFront(e){return me.create(ce.NAME)}concatenateBack(e){return me.create(ce.NAME)}plusBy(e){return me.create(ce.NAME)}minusBy(e){return me.create(ce.NAME)}multiplyBy(e){return me.create(ce.NAME)}dividedBy(e){return me.create(ce.NAME)}compareBy(e,n){return me.create(ce.NAME)}concatenate(e,n=Ps.FRONT){let r=this.getValue().toString();if(typeof e=="string")n===Ps.FRONT?r=e+r:r+=e;else if(typeof e=="number")n===Ps.FRONT?r=e.toString()+r:r+=e.toString();else if(typeof e=="boolean"){const i=e?"TRUE":"FALSE";n===Ps.FRONT?r=i+r:r+=i}return r}pow(e){return me.create(ce.VALUE)}powInverse(e){return me.create(ce.VALUE)}sqrt(){return me.create(ce.VALUE)}cbrt(){return me.create(ce.VALUE)}cos(){return me.create(ce.VALUE)}acos(){return me.create(ce.VALUE)}acosh(){return me.create(ce.VALUE)}sin(){return me.create(ce.VALUE)}asin(){return me.create(ce.VALUE)}asinh(){return me.create(ce.VALUE)}tan(){return me.create(ce.VALUE)}tanh(){return me.create(ce.VALUE)}atan(){return me.create(ce.VALUE)}atan2(e){return me.create(ce.VALUE)}atan2Inverse(e){return me.create(ce.VALUE)}atanh(){return me.create(ce.VALUE)}mean(){return this}median(){return this}var(){return this}std(){return this}log(){return me.create(ce.VALUE)}log10(){return me.create(ce.VALUE)}exp(){return me.create(ce.VALUE)}abs(){return me.create(ce.VALUE)}round(e){return me.create(ce.VALUE)}roundInverse(e){return me.create(ce.VALUE)}floor(e){return me.create(ce.VALUE)}floorInverse(e){return me.create(ce.VALUE)}ceil(e){return me.create(ce.VALUE)}ceilInverse(e){return me.create(ce.VALUE)}},me=class BP extends dc{constructor(e,n=""){super(e),this._errorType=e,this._errorContent=n}static create(e,n){return new BP(e,n)}getErrorType(){return this._errorType}getErrorContent(){return this._errorContent}isEqualType(e){return e.getErrorType()===this.getErrorType()}isError(){return!0}};var FDe=20,UDe=1,Ku=1e6,gD=1e6,HDe=-7,VDe=21,jDe=!1,$4="[big.js] ",hc=$4+"Invalid ",lf=hc+"decimal places",zDe=hc+"rounding mode",FP=$4+"Division by zero",or={},wa=void 0,WDe=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function UP(){function t(e){var n=this;if(!(n instanceof t))return e===wa?UP():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(hc+"value");e=e===0&&1/e<0?"-0":String(e)}XDe(n,e)}n.constructor=t}return t.prototype=or,t.DP=FDe,t.RM=UDe,t.NE=HDe,t.PE=VDe,t.strict=jDe,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function XDe(t,e){var n,r,i;if(!WDe.test(e))throw Error(hc+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),i=e.length,r=0;r<i&&e.charAt(r)=="0";)++r;if(r==i)t.c=[t.e=0];else{for(;i>0&&e.charAt(--i)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=i;)t.c[n++]=+e.charAt(r++)}return t}function fc(t,e,n,r){var i=t.c;if(n===wa&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(zDe);if(e<1)r=n===3&&(r||!!i[0])||e===0&&(n===1&&i[0]>=5||n===2&&(i[0]>5||i[0]===5&&(r||i[1]!==wa))),i.length=1,r?(t.e=t.e-e+1,i[0]=1):i[0]=t.e=0;else if(e<i.length){if(r=n===1&&i[e]>=5||n===2&&(i[e]>5||i[e]===5&&(r||i[e+1]!==wa||i[e-1]&1))||n===3&&(r||!!i[0]),i.length=e,r){for(;++i[--e]>9;)if(i[e]=0,e===0){++t.e,i.unshift(1);break}}for(e=i.length;!i[--e];)i.pop()}return t}function E0(t,e,n){var r=t.e,i=t.c.join(""),o=i.length;if(e)i=i.charAt(0)+(o>1?"."+i.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)i="0"+i;i="0."+i}else if(r>0)if(++r>o)for(r-=o;r--;)i+="0";else r<o&&(i=i.slice(0,r)+"."+i.slice(r));else o>1&&(i=i.charAt(0)+"."+i.slice(1));return t.s<0&&n?"-"+i:i}or.abs=function(){var t=new this.constructor(this);return t.s=1,t};or.cmp=function(t){var e,n=this,r=n.c,i=(t=new n.constructor(t)).c,o=n.s,s=t.s,a=n.e,l=t.e;if(!r[0]||!i[0])return r[0]?o:i[0]?-s:0;if(o!=s)return o;if(e=o<0,a!=l)return a>l^e?1:-1;for(s=(a=r.length)<(l=i.length)?a:l,o=-1;++o<s;)if(r[o]!=i[o])return r[o]>i[o]^e?1:-1;return a==l?0:a>l^e?1:-1};or.div=function(t){var e=this,n=e.constructor,r=e.c,i=(t=new n(t)).c,o=e.s==t.s?1:-1,s=n.DP;if(s!==~~s||s<0||s>Ku)throw Error(lf);if(!i[0])throw Error(FP);if(!r[0])return t.s=o,t.c=[t.e=0],t;var a,l,u,c,d,h=i.slice(),f=a=i.length,m=r.length,p=r.slice(0,a),g=p.length,v=t,_=v.c=[],C=0,y=s+(v.e=e.e-t.e)+1;for(v.s=o,o=y<0?0:y,h.unshift(0);g++<a;)p.push(0);do{for(u=0;u<10;u++){if(a!=(g=p.length))c=a>g?1:-1;else for(d=-1,c=0;++d<a;)if(i[d]!=p[d]){c=i[d]>p[d]?1:-1;break}if(c<0){for(l=g==a?i:h;g;){if(p[--g]<l[g]){for(d=g;d&&!p[--d];)p[d]=9;--p[d],p[g]+=10}p[g]-=l[g]}for(;!p[0];)p.shift()}else break}_[C++]=c?u:++u,p[0]&&c?p[g]=r[f]||0:p=[r[f]]}while((f++<m||p[0]!==wa)&&o--);return!_[0]&&C!=1&&(_.shift(),v.e--,y--),C>y&&fc(v,y,n.RM,p[0]!==wa),v};or.eq=function(t){return this.cmp(t)===0};or.gt=function(t){return this.cmp(t)>0};or.gte=function(t){return this.cmp(t)>-1};or.lt=function(t){return this.cmp(t)<0};or.lte=function(t){return this.cmp(t)<1};or.minus=or.sub=function(t){var e,n,r,i,o=this,s=o.constructor,a=o.s,l=(t=new s(t)).s;if(a!=l)return t.s=-l,o.plus(t);var u=o.c.slice(),c=o.e,d=t.c,h=t.e;if(!u[0]||!d[0])return d[0]?t.s=-l:u[0]?t=new s(o):t.s=1,t;if(a=c-h){for((i=a<0)?(a=-a,r=u):(h=c,r=d),r.reverse(),l=a;l--;)r.push(0);r.reverse()}else for(n=((i=u.length<d.length)?u:d).length,a=l=0;l<n;l++)if(u[l]!=d[l]){i=u[l]<d[l];break}if(i&&(r=u,u=d,d=r,t.s=-t.s),(l=(n=d.length)-(e=u.length))>0)for(;l--;)u[e++]=0;for(l=e;n>a;){if(u[--n]<d[n]){for(e=n;e&&!u[--e];)u[e]=9;--u[e],u[n]+=10}u[n]-=d[n]}for(;u[--l]===0;)u.pop();for(;u[0]===0;)u.shift(),--h;return u[0]||(t.s=1,u=[h=0]),t.c=u,t.e=h,t};or.mod=function(t){var e,n=this,r=n.constructor,i=n.s,o=(t=new r(t)).s;if(!t.c[0])throw Error(FP);return n.s=t.s=1,e=t.cmp(n)==1,n.s=i,t.s=o,e?new r(n):(i=r.DP,o=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=i,r.RM=o,this.minus(n.times(t)))};or.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};or.plus=or.add=function(t){var e,n,r,i=this,o=i.constructor;if(t=new o(t),i.s!=t.s)return t.s=-t.s,i.minus(t);var s=i.e,a=i.c,l=t.e,u=t.c;if(!a[0]||!u[0])return u[0]||(a[0]?t=new o(i):t.s=i.s),t;if(a=a.slice(),e=s-l){for(e>0?(l=s,r=u):(e=-e,r=a),r.reverse();e--;)r.push(0);r.reverse()}for(a.length-u.length<0&&(r=u,u=a,a=r),e=u.length,n=0;e;a[e]%=10)n=(a[--e]=a[e]+u[e]+n)/10|0;for(n&&(a.unshift(n),++l),e=a.length;a[--e]===0;)a.pop();return t.c=a,t.e=l,t};or.pow=function(t){var e=this,n=new e.constructor("1"),r=n,i=t<0;if(t!==~~t||t<-gD||t>gD)throw Error(hc+"exponent");for(i&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return i?n.div(r):r};or.prec=function(t,e){if(t!==~~t||t<1||t>Ku)throw Error(hc+"precision");return fc(new this.constructor(this),t,e)};or.round=function(t,e){if(t===wa)t=0;else if(t!==~~t||t<-Ku||t>Ku)throw Error(lf);return fc(new this.constructor(this),t+this.e+1,e)};or.sqrt=function(){var t,e,n,r=this,i=r.constructor,o=r.s,s=r.e,a=new i("0.5");if(!r.c[0])return new i(r);if(o<0)throw Error($4+"No square root");o=Math.sqrt(r+""),o===0||o===1/0?(e=r.c.join(""),e.length+s&1||(e+="0"),o=Math.sqrt(e),s=((s+1)/2|0)-(s<0||s&1),t=new i((o==1/0?"5e":(o=o.toExponential()).slice(0,o.indexOf("e")+1))+s)):t=new i(o+""),s=t.e+(i.DP+=4);do n=t,t=a.times(n.plus(r.div(n)));while(n.c.slice(0,s).join("")!==t.c.slice(0,s).join(""));return fc(t,(i.DP-=4)+t.e+1,i.RM)};or.times=or.mul=function(t){var e,n=this,r=n.constructor,i=n.c,o=(t=new r(t)).c,s=i.length,a=o.length,l=n.e,u=t.e;if(t.s=n.s==t.s?1:-1,!i[0]||!o[0])return t.c=[t.e=0],t;for(t.e=l+u,s<a&&(e=i,i=o,o=e,u=s,s=a,a=u),e=new Array(u=s+a);u--;)e[u]=0;for(l=a;l--;){for(a=0,u=s+l;u>l;)a=e[u]+o[l]*i[u-l-1]+a,e[u--]=a%10,a=a/10|0;e[u]=a}for(a?++t.e:e.shift(),l=e.length;!e[--l];)e.pop();return t.c=e,t};or.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==wa){if(t!==~~t||t<0||t>Ku)throw Error(lf);for(n=fc(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return E0(n,!0,!!r)};or.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==wa){if(t!==~~t||t<0||t>Ku)throw Error(lf);for(n=fc(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return E0(n,!1,!!r)};or[Symbol.for("nodejs.util.inspect.custom")]=or.toJSON=or.toString=function(){var t=this,e=t.constructor;return E0(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};or.toNumber=function(){var t=Number(E0(this,!0,!0));if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error($4+"Imprecise conversion");return t};or.toPrecision=function(t,e){var n=this,r=n.constructor,i=n.c[0];if(t!==wa){if(t!==~~t||t<1||t>Ku)throw Error(hc+"precision");for(n=fc(new r(n),t,e);n.c.length<t;)n.c.push(0)}return E0(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!i)};or.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error($4+"valueOf disallowed");return E0(t,t.e<=e.NE||t.e>=e.PE,!0)};var ki=UP();function a_(t){let e;switch(t){case St.EQUALS:e=St.EQUALS;break;case St.GREATER_THAN:e=St.LESS_THAN;break;case St.GREATER_THAN_OR_EQUAL:e=St.LESS_THAN_OR_EQUAL;break;case St.LESS_THAN:e=St.GREATER_THAN;break;case St.LESS_THAN_OR_EQUAL:e=St.GREATER_THAN_OR_EQUAL;break;case St.NOT_EQUAL:e=St.NOT_EQUAL;break}return e}function fy(t,e){return ki(t).times(e).toNumber()}function vD(t,e){const n=10**Math.floor(e);return Math.round(fy(t,n))/n}function _D(t,e){const n=10**Math.floor(e);return Math.floor(fy(t,n))/n}function bD(t,e){const n=10**Math.floor(e);return Math.ceil(fy(t,n))/n}function CD(t,e){return t**e}let HP=class extends dc{isNull(){return!0}plus(e){return new tt(0,!0).plus(e)}minus(e){return new tt(0,!0).minus(e)}multiply(e){return new tt(0,!0).multiply(e)}divided(e){return new tt(0,!0).divided(e)}compare(e,n){return e.isString()?new co("").compare(e,n):e.isBoolean()?new ko(!1).compare(e,n):new tt(0,!0).compare(e,n)}concatenateFront(e){return e.isArray()?e.concatenateBack(new co("")):new co(this.concatenate(e.getValue(),Ps.FRONT))}concatenateBack(e){return e.isArray()?e.concatenateFront(new co("")):new co(this.concatenate(e.getValue(),Ps.BACK))}plusBy(e){return new tt(0).plusBy(e)}minusBy(e){return new tt(0).minusBy(e)}multiplyBy(e){return new tt(0).multiplyBy(e)}dividedBy(e){return new tt(0).dividedBy(e)}compareBy(e,n){return typeof e=="string"?new co("").compareBy(e,n):typeof e=="boolean"?new ko(!1).compareBy(e,n):new tt(0,!0).compareBy(e,n)}pow(e){return new tt(0,!0).pow(e)}sqrt(){return new tt(0,!0)}cbrt(){return new tt(0,!0)}cos(){return new tt(0,!0)}acos(){return new tt(0,!0)}acosh(){return new tt(0,!0)}sin(){return new tt(0,!0)}asin(){return new tt(0,!0)}asinh(){return new tt(0,!0)}tan(){return new tt(0,!0)}tanh(){return new tt(0,!0)}atan(){return new tt(0,!0)}atan2(e){return new tt(0,!0).atan2(e)}atanh(){return new tt(0,!0)}log(){return me.create(ce.NUM)}log10(){return me.create(ce.NUM)}exp(){return me.create(ce.NUM)}abs(){return me.create(ce.NUM)}round(e){return new tt(0,!0).round(e)}floor(e){return new tt(0,!0).floor(e)}ceil(e){return new tt(0,!0).ceil(e)}};class ko extends dc{constructor(e,n=!1){if(super(e),Fe(this,"_value",!1),n){this._value=e;return}if(typeof e=="boolean")this._value=e;else if(typeof e=="string"){const r=e.toLocaleUpperCase();r===Gu.TRUE?this._value=!0:r===Gu.FALSE&&(this._value=!1)}else e===1?this._value=!0:this._value=!1}getValue(){return this._value}isBoolean(){return!0}getNegative(){const e=this.getValue();let n=0;return e&&(n=1),new tt(-n,!0)}getReciprocal(){return this.getValue()?new tt(1,!0):me.create(ce.DIV_BY_ZERO)}plus(e){return this._convertTonNumber().plus(e)}minus(e){return this._convertTonNumber().minus(e)}multiply(e){return this._convertTonNumber().multiply(e)}divided(e){return this._convertTonNumber().divided(e)}compare(e,n){return this._convertTonNumber().compare(e,n)}concatenateFront(e){return this._convertTonNumber().concatenateFront(e)}concatenateBack(e){return this._convertTonNumber().concatenateBack(e)}_convertTonNumber(){const e=this.getValue();let n=0;return e&&(n=1),new tt(n,!0)}pow(e){return this._convertTonNumber().pow(e)}sqrt(){return this._convertTonNumber()}cbrt(){return this._convertTonNumber()}cos(){return this._convertTonNumber().cos()}acos(){return this._convertTonNumber().acos()}acosh(){return this._convertTonNumber().acosh()}sin(){return this._convertTonNumber().sin()}asin(){return this._convertTonNumber().asin()}asinh(){return this._convertTonNumber().asinh()}tan(){return this._convertTonNumber().tan()}tanh(){return this._convertTonNumber().tanh()}atan(){return this._convertTonNumber().atan()}atan2(e){return this._convertTonNumber().atan2(e)}atanh(){return this._convertTonNumber().atanh()}log(){return this._convertTonNumber().log()}log10(){return this._convertTonNumber().log10()}exp(){return this._convertTonNumber().exp()}abs(){return this._convertTonNumber().abs()}round(e){return this._convertTonNumber().round(e)}floor(e){return this._convertTonNumber().floor(e)}ceil(e){return this._convertTonNumber().ceil(e)}}class tt extends dc{constructor(e,n=!1){if(super(e),Fe(this,"_value",0),n){this._value=e;return}this._value=Number(e)}getValue(){return this._value}setValue(e){this._value=e}isNumber(){return!0}getNegative(){return new tt(0).minus(this)}getReciprocal(){return new tt(1).divided(this)}plus(e){if(e.isArray())return e.plus(this);const n=this.plusBy(e.getValue());return n.isError()?this:n}equalZero(){return this._value===0}minus(e){if(e.isArray()){const r=e.getNegative();return r.isError()?r:r.plus(this)}const n=this.minusBy(e.getValue());return n.isError()?this:n}multiply(e){return e.isArray()?e.multiply(this):this.multiplyBy(e.getValue())}divided(e){if(e.isArray()){const n=e.getReciprocal();return n.isError()?n:n.multiply(this)}return this.dividedBy(e.getValue())}concatenateFront(e){return e.isArray()?e.concatenateBack(this):new co(this.concatenate(e.getValue(),Ps.FRONT))}concatenateBack(e){return e.isArray()?e.concatenateFront(this):new co(this.concatenate(e.getValue(),Ps.BACK))}compare(e,n){return e.isArray()?e.compare(this,a_(n)):this.compareBy(e.getValue(),n)}plusBy(e){const n=this.getValue();if(typeof e=="string")return me.create(ce.VALUE);if(typeof e=="number"){if(!Number.isFinite(n)||!Number.isFinite(e))return me.create(ce.NUM);const r=ki(n).plus(e).toNumber();return Number.isFinite(r)?new tt(r):me.create(ce.NUM)}return typeof e=="boolean"?new tt(ki(n).plus(e?1:0).toNumber()):this}minusBy(e){const n=this.getValue();if(typeof e=="string")return me.create(ce.VALUE);if(typeof e=="number"){if(!Number.isFinite(n)||!Number.isFinite(e))return me.create(ce.NUM);const r=ki(n).minus(e).toNumber();return Number.isFinite(r)?new tt(r):me.create(ce.NUM)}return typeof e=="boolean"?new tt(ki(n).minus(e?1:0).toNumber()):this}multiplyBy(e){const n=this.getValue();if(typeof e=="string")return me.create(ce.VALUE);if(typeof e=="number"){if(!Number.isFinite(n)||!Number.isFinite(e))return me.create(ce.NUM);const r=ki(n).times(e).toNumber();return Number.isFinite(r)?new tt(r):me.create(ce.NUM)}return typeof e=="boolean"?new tt(ki(n).times(e?1:0).toNumber()):this}dividedBy(e){const n=this.getValue();if(typeof e=="string")return me.create(ce.VALUE);if(typeof e=="number"){if(e===0)return me.create(ce.DIV_BY_ZERO);if(!Number.isFinite(n)||!Number.isFinite(e))return me.create(ce.NUM);const r=ki(n).div(e).toNumber();return Number.isFinite(r)?new tt(r):me.create(ce.NUM)}return typeof e=="boolean"?e===!1?me.create(ce.DIV_BY_ZERO):new tt(ki(n).div(1).toNumber()):this}compareBy(e,n){const r=this.getValue();let i=!1;if(typeof e=="string")switch(n){case St.EQUALS:case St.GREATER_THAN:case St.GREATER_THAN_OR_EQUAL:i=!1;break;case St.LESS_THAN:case St.LESS_THAN_OR_EQUAL:case St.NOT_EQUAL:i=!0;break}else if(typeof e=="number")if(!Number.isFinite(r)||!Number.isFinite(e))i=this._compareInfinity(r,e,n);else switch(n){case St.EQUALS:i=ki(r).eq(e);break;case St.GREATER_THAN:i=ki(r).gt(e);break;case St.GREATER_THAN_OR_EQUAL:i=ki(r).gte(e);break;case St.LESS_THAN:i=ki(r).lt(e);break;case St.LESS_THAN_OR_EQUAL:i=ki(r).lte(e);break;case St.NOT_EQUAL:i=!ki(r).eq(e);break}else if(typeof e=="boolean")switch(n){case St.EQUALS:case St.GREATER_THAN:case St.GREATER_THAN_OR_EQUAL:i=!1;break;case St.LESS_THAN:case St.LESS_THAN_OR_EQUAL:case St.NOT_EQUAL:i=!0;break}return new ko(i)}pow(e){if(e.isArray())return e.powInverse(this);const n=this.getValue(),r=e.getValue();if(typeof r=="string")return me.create(ce.VALUE);if(typeof r=="number"){if(!Number.isFinite(n)||!Number.isFinite(r))return me.create(ce.NUM);const i=CD(n,r);return Number.isFinite(i)?new tt(i):me.create(ce.NUM)}return typeof r=="boolean"?new tt(CD(n,r?1:0)):this}sqrt(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=ki(e).sqrt().toNumber();return Number.isFinite(n)?new tt(n):me.create(ce.NUM)}cbrt(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=Math.cbrt(e);return Number.isFinite(n)?new tt(n):me.create(ce.NUM)}cos(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=Math.cos(e);return Number.isFinite(n)?new tt(n):me.create(ce.NUM)}acos(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=Math.acos(e);return Number.isNaN(n)?me.create(ce.NUM):new tt(n)}acosh(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=Math.acosh(e);return Number.isNaN(n)?me.create(ce.NUM):new tt(n)}sin(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=Math.sin(e);return Number.isFinite(n)?new tt(n):me.create(ce.NUM)}asin(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=Math.asin(e);return Number.isNaN(n)?me.create(ce.NUM):new tt(n)}asinh(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=Math.asinh(e);return Number.isNaN(n)?me.create(ce.NUM):new tt(n)}tan(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=Math.tan(e);return Number.isFinite(n)?new tt(n):me.create(ce.NUM)}tanh(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=Math.tanh(e);return Number.isFinite(n)?new tt(n):me.create(ce.NUM)}atan(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=Math.atan(e);return Number.isFinite(n)?new tt(n):me.create(ce.NUM)}atan2(e){if(e.isArray())return e.atan2Inverse(this);const n=this.getValue(),r=e.getValue();if(typeof r=="string")return me.create(ce.VALUE);if(typeof r=="number"){if(!Number.isFinite(n)||!Number.isFinite(r))return me.create(ce.NUM);const i=Math.atan2(n,r);return Number.isFinite(i)?new tt(i):me.create(ce.NUM)}return typeof r=="boolean"?new tt(Math.atan2(n,r?1:0)):this}atanh(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=Math.atanh(e);return Number.isFinite(n)?new tt(n):me.create(ce.NUM)}log(){const e=this.getValue();if(typeof e=="number"&&e<=0||!Number.isFinite(e))return me.create(ce.NUM);const n=Math.log(e);return Number.isFinite(n)?new tt(n):me.create(ce.NUM)}log10(){const e=this.getValue();if(typeof e=="number"&&e<=0||!Number.isFinite(e))return me.create(ce.NUM);const n=Math.log10(e);return Number.isFinite(n)?new tt(n):me.create(ce.NUM)}exp(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=Math.exp(e);return Number.isFinite(n)?new tt(n):me.create(ce.NUM)}abs(){const e=this.getValue();if(!Number.isFinite(e))return me.create(ce.NUM);const n=Math.abs(e);return Number.isFinite(n)?new tt(n):me.create(ce.NUM)}round(e){if(e.isArray())return e.roundInverse(this);const n=this.getValue(),r=e.getValue();if(typeof r=="string")return me.create(ce.VALUE);if(typeof r=="number"){if(!Number.isFinite(n)||!Number.isFinite(r))return me.create(ce.NUM);const i=vD(n,r);return Number.isFinite(i)?new tt(i):me.create(ce.NUM)}return typeof r=="boolean"?new tt(vD(n,r?1:0)):this}floor(e){if(e.isArray())return e.floorInverse(this);const n=this.getValue(),r=e.getValue();if(typeof r=="string")return me.create(ce.VALUE);if(typeof r=="number"){if(!Number.isFinite(n)||!Number.isFinite(r))return me.create(ce.NUM);const i=_D(n,r);return Number.isFinite(i)?new tt(i):me.create(ce.NUM)}return typeof r=="boolean"?new tt(_D(n,r?1:0)):this}ceil(e){if(e.isArray())return e.ceilInverse(this);const n=this.getValue(),r=e.getValue();if(typeof r=="string")return me.create(ce.VALUE);if(typeof r=="number"){if(!Number.isFinite(n)||!Number.isFinite(r))return me.create(ce.NUM);const i=bD(n,r);return Number.isFinite(i)?new tt(i):me.create(ce.NUM)}return typeof r=="boolean"?new tt(bD(n,r?1:0)):this}_compareInfinity(e,n,r){let i=!1;switch(r){case St.EQUALS:i=e===n;break;case St.GREATER_THAN:i=e>n;break;case St.GREATER_THAN_OR_EQUAL:i=e>=n;break;case St.LESS_THAN:i=e<n;break;case St.LESS_THAN_OR_EQUAL:i=e<=n;break;case St.NOT_EQUAL:i=e!==n;break}return i}}class co extends dc{constructor(e,n=!1){if(super(e),Fe(this,"_value"),n){this._value=e;return}let r=e.toString();r.charAt(0)==='"'&&r.charAt(r.length-1)==='"'&&(r=r.slice(1,-1),r=r.replace(/""/g,'"')),this._value=r}getValue(){return this._value}isString(){return!0}concatenateFront(e){return e.isArray()?e.concatenateBack(this):new co(this.concatenate(e.getValue(),Ps.FRONT))}concatenateBack(e){return e.isArray()?e.concatenateFront(this):new co(this.concatenate(e.getValue(),Ps.BACK))}compare(e,n){return e.isArray()?e.compare(this,a_(n)):this.compareBy(e.getValue(),n)}wildcard(e,n){return e.isArray()?e.wildcard(this,a_(n)):this._checkWildcard(e.getValue(),n)}compareBy(e,n){const r=this.getValue();let i=!1;if(typeof e=="string")switch(n){case St.EQUALS:i=r===e;break;case St.GREATER_THAN:i=r>e;break;case St.GREATER_THAN_OR_EQUAL:i=r>=e;break;case St.LESS_THAN:i=r<e;break;case St.LESS_THAN_OR_EQUAL:i=r<=e;break;case St.NOT_EQUAL:i=r!==e;break}else if(typeof e=="number")switch(n){case St.EQUALS:case St.GREATER_THAN:case St.GREATER_THAN_OR_EQUAL:i=!0;break;case St.LESS_THAN:case St.LESS_THAN_OR_EQUAL:case St.NOT_EQUAL:i=!1;break}else if(typeof e=="boolean")switch(n){case St.EQUALS:case St.GREATER_THAN:case St.GREATER_THAN_OR_EQUAL:i=!1;break;case St.LESS_THAN:case St.LESS_THAN_OR_EQUAL:case St.NOT_EQUAL:i=!0;break}return new ko(i)}_checkWildcard(e,n){const r=this.getValue().toLocaleLowerCase(),i=BDe(r,e,n);return new ko(i)}}function YDe(t){return""}function GDe(t=[]){const e=[];for(let n=0;n<t.length;n++){const r=t[n];e[n]==null&&(e[n]=[]);for(let i=0;i<r.length;i++){const o=r[i];o.isError()?e[n][i]=o.getErrorType():e[n][i]=o.getValue()}}return e}class sl extends dc{constructor(e){var n=(...r)=>(super(...r),Fe(this,"_value",[]),Fe(this,"_rowCount",-1),Fe(this,"_columnCount",-1),Fe(this,"_unitId",""),Fe(this,"_sheetId",""),Fe(this,"_currentRow",-1),Fe(this,"_currentColumn",-1),this);if(typeof e=="string")n(e);else{const r=YDe();n(r)}this._value=this._formatValue(e)}dispose(){this._value.forEach(e=>{e.forEach(n=>{n.dispose()})}),this._value=[]}getRowCount(){return this._rowCount}setRowCount(e){this._rowCount=e}getColumnCount(){return this._columnCount}setColumnCount(e){this._columnCount=e}setCurrent(e,n){this._currentRow=e,this._currentColumn=n}setUnitId(e){this._unitId=e}getUnitId(){return this._unitId}setSheetId(e){this._sheetId=e}getSheetId(){return this._sheetId}getCurrentRow(){return this._currentRow}getCurrentColumn(){return this._currentColumn}getArrayValue(){return this._value}setArrayValue(e){this._value=e}isArray(){return!0}get(e,n){return this._value[e][n]}set(e,n,r){if(e>=this._rowCount||n>=this._columnCount)throw new Error("Exceeding array bounds.");this._value[e][n]=r}getRangePosition(){const e=this.getRowCount(),n=0,r=this.getColumnCount();return{startRow:0,endRow:e-1,startColumn:n,endColumn:r-1}}iterator(e){const{startRow:n,endRow:r,startColumn:i,endColumn:o}=this.getRangePosition(),s=this.getArrayValue();for(let a=n;a<=r;a++)for(let l=i;l<=o;l++)if(e(s[a][l],a,l)===!1)return}getFirstCell(){const{startRow:e,startColumn:n}=this.getRangePosition();return this.getArrayValue()[e][n]}pick(e){const n=e.getRowCount(),r=e.getColumnCount();if(n!==this._rowCount||n!==this._rowCount)return this._createNewArray([[new tt(0)]],1,1);const i=[];i[0]=[];for(let o=0;o<n;o++)for(let s=0;s<r;s++){const a=e.get(o,s),l=this.get(o,s);a.isError()||a.getValue()===!0&&i[0].push(l)}return this._createNewArray(i,1,i[0].length)}flatten(){const e=[];e[0]=[];for(let n=0;n<this._rowCount;n++)for(let r=0;r<this._rowCount;r++){const i=this.get(n,r);e[0].push(i)}return this._createNewArray(e,1,e[0].length)}slice(e,n){let r=0,i=this._rowCount-1,o=1,s=0,a=this._columnCount-1,l=1;e!=null&&(r=e[0]||0,i=e[1]||this._rowCount-1,o=e[2]||1),n!=null&&(s=n[0]||0,a=n[1]||this._columnCount-1,l=n[2]||1);const u=[],c=this._value;let d=0,h=0;for(let f=r;f<=i;f+=o){h=0,u[d]==null&&(u[d]=[]);for(let m=s;m<=a;m+=l)u[d][h]=c[f][m],h++;d++}return this._createNewArray(u,u.length,u[0].length)}sum(){let e=new tt(0);return this.iterator(n=>{if(n==null)return!0;if(n.isError())return e=n,!1;e=e.plus(n)}),e}max(){let e=new tt(-1/0);return this.iterator(n=>{if(n==null)return!0;if(n.isError())return e=n,!1;if(n.isString()||n.isNull())return!0;e.isLessThan(n).getValue()&&(e=n)}),e}min(){let e=new tt(1/0);return this.iterator(n=>{if(n==null)return!0;if(n.isError())return e=n,!1;if(n.isString()||n.isNull())return!0;e.isGreaterThan(n).getValue()&&(e=n)}),e}count(){let e=new tt(0);return this.iterator(n=>{if(n==null||n.isError()||n.isString()||n.isNull())return!0;e=e.plusBy(1)}),e}countA(){let e=new tt(0);return this.iterator(n=>{if(n==null||n.isNull())return!0;e=e.plusBy(1)}),e}countBlank(){let e=new tt(0);return this.iterator(n=>{if(n!=null)return!0;e=e.plusBy(1)}),e}sortByRow(e){const n=this._transposeArray(this._value);n.sort(this._sort(e)),this._value=this._transposeArray(n)}sortByColumn(e){this._value.sort(this._sort(e))}transpose(){const e=this._transposeArray(this._value),n=this._rowCount,r=this._columnCount;return this._createNewArray(e,r,n)}getNegative(){return new sl("{0}").minus(this)}getReciprocal(){return new sl("{1}").divided(this)}plus(e){return this._batchOperator(e,1)}minus(e){return this._batchOperator(e,0)}multiply(e){return this._batchOperator(e,2)}divided(e){return this._batchOperator(e,3)}compare(e,n){return this._batchOperator(e,4,n)}wildcard(e,n){return this._batchOperator(e,8,n)}concatenateFront(e){return this._batchOperator(e,5)}concatenateBack(e){return this._batchOperator(e,6)}product(e,n){return this._batchOperator(e,7,n)}map(e){var n,r;const i=this._rowCount,o=this._columnCount,s=[];for(let a=0;a<i;a++){const l=[];for(let u=0;u<o;u++){const c=(r=(n=this._value)==null?void 0:n[a])==null?void 0:r[u];c?c.isError()?l[u]=c:l[u]=e(c,a,u):l[u]=me.create(ce.VALUE)}s.push(l)}return this._createNewArray(s,i,o)}pow(e){return this._batchOperator(e,9)}powInverse(e){return this.map(n=>n.isError()?n:e.pow(n))}sqrt(){return this.map(e=>e.isError()?e:e.sqrt())}cbrt(){return this.map(e=>e.isError()?e:e.cbrt())}cos(){return this.map(e=>e.isError()?e:e.cos())}acos(){return this.map(e=>e.isError()?e:e.acos())}acosh(){return this.map(e=>e.isError()?e:e.acosh())}sin(){return this.map(e=>e.isError()?e:e.sin())}asin(){return this.map(e=>e.isError()?e:e.asin())}asinh(){return this.map(e=>e.isError()?e:e.asinh())}tan(){return this.map(e=>e.isError()?e:e.tan())}tanh(){return this.map(e=>e.isError()?e:e.tanh())}atan(){return this.map(e=>e.isError()?e:e.atan())}atanh(){return this.map(e=>e.isError()?e:e.atanh())}atan2(e){return this._batchOperator(e,13)}atan2Inverse(e){return this.map(n=>n.isError()?n:e.atan2(n))}mean(){const e=this.sum(),n=this.countA();return e.divided(n)}median(){const e=this.flatten(),n=e.getColumnCount();if(n<=1)return e.get(0,0);if(e.sortByRow(0),n%2===0){const r=e.get(0,n/2),i=e.get(0,n/2-1);return r.plus(i).divided(new tt(2,!0))}return e.get(0,(n-1)/2)}var(){const e=this.mean(),n=[];this.iterator((u,c,d)=>{(u==null||u.isError()||u.isString())&&(u=new tt(0));let h=u.minus(e).pow(new tt(2,!0));h.isError()&&(h=new tt(0)),n[c]==null&&(n[c]=[]),n[c][d]=h});const{_rowCount:r,_columnCount:i,_unitId:o,_sheetId:s,_currentRow:a,_currentColumn:l}=this;return new sl({calculateValueList:n,rowCount:r,columnCount:i,unitId:o,sheetId:s,row:a,column:l}).mean()}std(){const e=this.var();return e.isError()?e:e.sqrt()}log(){return this.map(e=>e.isError()?e:e.log())}log10(){return this.map(e=>e.isError()?e:e.log10())}exp(){return this.map(e=>e.isError()?e:e.exp())}abs(){return this.map(e=>e.isError()?e:e.abs())}round(e){return this._batchOperator(e,10)}roundInverse(e){return this.map(n=>n.isError()?n:e.round(n))}floor(e){return this._batchOperator(e,11)}floorInverse(e){return this.map(n=>n.isError()?n:e.floor(n))}ceil(e){return this._batchOperator(e,12)}ceilInverse(e){return this.map(n=>n.isError()?n:e.ceil(n))}toValue(){return GDe(this._value)}_sort(e){const n=LDe();return(r,i)=>{const o=r[e],s=i[e];return o.isError()&&o.isError()?0:o.isError()?1:s.isError()?-1:n(o.getValue(),s.getValue())}}_transposeArray(e){const n=e.length,r=e[0].length,i=[];for(let o=0;o<r;o++){i[o]=[];for(let s=0;s<n;s++)i[o][s]=e[s][o]}return i}_batchOperator(e,n,r){const i=[];let o=this._rowCount,s=this._columnCount;if(e.isArray()){const l=e.getRowCount(),u=e.getColumnCount();if(o=Math.max(l,o),s=Math.max(u,s),l===1&&u===1){const c=e.getFirstCell();for(let d=0;d<s;d++)i.push(c)}else if(l===1&&this._columnCount>1){const c=e.getArrayValue();for(let d=0;d<s;d++)i.push(c[0][d])}else return this._batchOperatorArray(e,n,r)}else for(let l=0;l<s;l++)i.push(e);const a=[];for(let l=0;l<s;l++){const u=i[l];this._batchOperatorValue(u,l,a,n,r)}return this._createNewArray(a,o,s)}_batchOperatorValue(e,n,r,i,o){var s,a;const l=this._rowCount;let u=!1;const c=this.getUnitId(),d=this.getSheetId(),h=this.getCurrentRow(),f=this.getCurrentColumn();if(i===4&&(u=bu.canUseCache(c,d,n+f,h,h+l-1),u===!0)){if(o===St.EQUALS){const m=bu.getCellPositions(c,d,n+f,e.getValue());if(m!=null)for(let p=0;p<l;p++)r[p]==null&&(r[p]=[]),m.includes(p+h)?r[p][n]=new ko(!0):r[p][n]=new ko(!1)}else{const m=bu.getCellValuePositions(c,d,n+f);m!=null&&m.forEach((p,g)=>{let v;if(typeof g=="string"?v=new co(g):typeof g=="number"?v=new tt(g):typeof g=="boolean"&&(v=new ko(g)),v==null)return!0;if(v.compare(e,o))for(let _=0;_<l;_++)r[_]==null&&(r[_]=[]),p.includes(_+h)?r[_][n]=new ko(!0):r[_][n]=new ko(!1)})}return}bu.setContinueBuildingCache(c,d,n+f,h,h+l-1);for(let m=0;m<l;m++){const p=(a=(s=this._value)==null?void 0:s[m])==null?void 0:a[n];if(r[m]==null&&(r[m]=[]),p&&e)if(p.isError())r[m][n]=p;else if(e.isError())r[m][n]=me.create(ce.VALUE);else switch(i){case 1:r[m][n]=p.plus(e);break;case 0:r[m][n]=p.minus(e);break;case 2:r[m][n]=p.multiply(e);break;case 3:r[m][n]=p.divided(e);break;case 4:o?r[m][n]=p.compare(e,o):r[m][n]=me.create(ce.VALUE);break;case 5:r[m][n]=p.concatenateFront(e);break;case 6:r[m][n]=p.concatenateBack(e);break;case 7:o?r[m][n]=p.product(e,o):r[m][n]=me.create(ce.VALUE);break;case 8:o?r[m][n]=p.wildcard(e,o):r[m][n]=me.create(ce.VALUE);break;case 9:r[m][n]=p.pow(e);break;case 10:r[m][n]=p.round(e);break;case 11:r[m][n]=p.floor(e);break;case 13:r[m][n]=p.atan2(e);break;case 12:r[m][n]=p.ceil(e);break}else r[m][n]=me.create(ce.NA);p!=null&&(p.isError()?bu.set(c,d,n+f,p.getErrorType(),m+h):bu.set(c,d,n+f,p.getValue(),m+h))}}_batchOperatorArray(e,n,r){var i,o,s,a,l,u,c,d,h,f,m,p;let g=e.getRowCount(),v=e.getColumnCount();g<this._rowCount&&(g=this._rowCount),v<this._columnCount&&(v=this._columnCount);const _=[],C=e.getArrayValue(),y=this._checkArrayCalculateType(this),S=this._checkArrayCalculateType(e);for(let E=0;E<g;E++){const w=[];for(let R=0;R<v;R++){let D;y===3?D=(o=(i=this._value)==null?void 0:i[0])==null?void 0:o[0]:y===1?D=(a=(s=this._value)==null?void 0:s[0])==null?void 0:a[R]:y===2?D=(u=(l=this._value)==null?void 0:l[E])==null?void 0:u[0]:D=(d=(c=this._value)==null?void 0:c[E])==null?void 0:d[R];let I;if(S===3?I=(h=C==null?void 0:C[0])==null?void 0:h[0]:S===1?I=(f=C==null?void 0:C[0])==null?void 0:f[R]:S===2?I=(m=C==null?void 0:C[E])==null?void 0:m[0]:I=(p=C==null?void 0:C[E])==null?void 0:p[R],D&&I)if(D.isError())w[R]=D;else if(I.isError())w[R]=I;else switch(n){case 1:w[R]=D.plus(I);break;case 0:w[R]=D.minus(I);break;case 2:w[R]=D.multiply(I);break;case 3:w[R]=D.divided(I);break;case 4:r?w[R]=D.compare(I,r):w[R]=me.create(ce.VALUE);break;case 5:w[R]=D.concatenateFront(I);break;case 6:w[R]=D.concatenateBack(I);break;case 7:r?w[R]=D.product(I,r):w[R]=me.create(ce.VALUE);break;case 8:r?w[R]=D.wildcard(I,r):w[R]=me.create(ce.VALUE);break;case 9:w[R]=D.pow(I);break;case 10:w[R]=D.round(I);break;case 13:w[R]=D.atan2(I);break;case 11:w[R]=D.floor(I);break;case 12:w[R]=D.ceil(I);break}else w[R]=me.create(ce.NA)}_.push(w)}return this._createNewArray(_,g,v)}_checkArrayCalculateType(e){return e.getRowCount()===1&&e.getColumnCount()===1?3:e.getRowCount()===1?1:e.getColumnCount()===1?2:0}_formatValue(e){if(typeof e!="string")return e=e,this._rowCount=e.rowCount,this._columnCount=e.columnCount,this._unitId=e.unitId,this._sheetId=e.sheetId,this._currentRow=e.row,this._currentColumn=e.column,e.calculateValueList;e=e.slice(1,-1);const n=e.split(";"),r=n.length,i=[];let o=0;for(let s=0;s<r;s++){const a=n[s].split(","),l=a.length;o<l&&(o=l);const u=[];for(let c=0;c<l;c++){const d=a[c].trim();u.push(W6.create(d))}i.push(u)}return this._rowCount=r,this._columnCount=o,i}_createNewArray(e,n,r){const i={calculateValueList:e,rowCount:n,columnCount:r,unitId:this.getUnitId(),sheetId:this.getSheetId(),row:this._currentRow,column:this._currentColumn};return new sl(i)}}let W6=class{static create(e){if(typeof e=="boolean")return new ko(e,!0);if(typeof e=="string"){const n=e.toLocaleUpperCase();return n===Gu.TRUE||n===Gu.FALSE?new ko(n):Mx(e)?new tt(e):new RegExp(IDe,"g").test(e)?new sl(e):new co(e)}return typeof e=="number"?Number.isFinite(e)?new tt(e,!0):me.create(ce.NUM):me.create(ce.NA)}};const KDe=1e5,l_=new rf(KDe);let k4=class extends af{constructor(e){super(),Fe(this,"_forcedSheetId",""),Fe(this,"_forcedSheetName",""),Fe(this,"_defaultSheetId",""),Fe(this,"_rangeData",{startColumn:-1,startRow:-1,endRow:-1,endColumn:-1}),Fe(this,"_unitData",{}),Fe(this,"_rowCount",0),Fe(this,"_columnCount",0),Fe(this,"_defaultUnitId",""),Fe(this,"_forcedUnitId",""),Fe(this,"_runtimeData",{}),Fe(this,"_arrayFormulaCellData",{}),Fe(this,"_runtimeArrayFormulaCellData",{}),Fe(this,"_runtimeFeatureCellData",{}),Fe(this,"_refOffsetX",0),Fe(this,"_refOffsetY",0),this._token=e}dispose(){this._unitData={},this._runtimeData={}}setRefOffset(e=0,n=0){this._refOffsetX=e,this._refOffsetY=n}getRefOffset(){return{x:this._refOffsetX,y:this._refOffsetY}}getRangePosition(){let e=this._rangeData.startRow,n=this._rangeData.endRow,r=this._rangeData.startColumn,i=this._rangeData.endColumn;return e===-1&&(e=0),r===-1&&(r=0),n===-1&&(n=this._rowCount-1),i===-1&&(i=this._columnCount-1),{startRow:e,endRow:n,startColumn:r,endColumn:i}}isReferenceObject(){return!0}iterator(e){const{startRow:n,endRow:r,startColumn:i,endColumn:o}=this.getRangePosition();if(this._checkIfWorksheetMiss())return e(new me(ce.VALUE),n,i);for(let s=n;s<=r;s++)for(let a=i;a<=o;a++){const l=s+this._refOffsetY,u=a+this._refOffsetX;if(l<0||u<0)return e(new me(ce.REF),s,a);const c=this.getCellData(l,u);let d=!1;if(c==null||dh(c)){d=e(null,s,a);continue}const h=this.getCellValueObject(c);if(d=e(h,s,a),d===!1)return}}getFirstCell(){const{startRow:e,startColumn:n}=this.getRangePosition(),r=this.getCellData(e+this._refOffsetY,n+this._refOffsetX);return r?this.getCellValueObject(r):new tt(0,!0)}getRangeData(){return this._rangeData}setRangeData(e){this._rangeData=e}getUnitId(){return this._forcedUnitId&&this._forcedUnitId.length>0?this._forcedUnitId:this._defaultUnitId}getSheetId(){return this._forcedSheetId&&this._forcedSheetId.length>0?this._forcedSheetId:this._defaultSheetId}setForcedUnitIdDirect(e){e.length>0&&(this._forcedUnitId=e)}getForcedUnitId(){return this._forcedUnitId}setForcedSheetId(e){var n;this._forcedSheetId=(n=e[this.getUnitId()])==null?void 0:n[this._forcedSheetName]}setForcedSheetIdDirect(e){this._forcedSheetId=e}getForcedSheetId(){return this._forcedSheetId}setForcedSheetName(e){e.length>0&&(this._forcedSheetName=e)}getForcedSheetName(){return this._forcedSheetName}setDefaultSheetId(e){this._defaultSheetId=e}getDefaultSheetId(){return this._defaultSheetId}setDefaultUnitId(e){this._defaultUnitId=e}getDefaultUnitId(){return this._defaultUnitId}getUnitData(){return this._unitData}setUnitData(e){this._unitData=e}getRuntimeData(){return this._runtimeData}setRuntimeData(e){this._runtimeData=e}getArrayFormulaCellData(){return this._arrayFormulaCellData}setArrayFormulaCellData(e){this._arrayFormulaCellData=e}getRuntimeArrayFormulaCellData(){return this._runtimeArrayFormulaCellData}setRuntimeArrayFormulaCellData(e){this._runtimeArrayFormulaCellData=e}getRuntimeFeatureCellData(){return this._runtimeFeatureCellData}setRuntimeFeatureCellData(e){this._runtimeFeatureCellData=e}getRowCount(){return this.getCurrentActiveSheetData().rowCount}getColumnCount(){return this.getCurrentActiveSheetData().columnCount}isCell(){return!1}isColumn(){return!1}isRow(){return!1}isRange(){return!1}isTable(){return!1}unionBy(e){return me.create(ce.REF)}unionRange(e,n){return{startRow:-1,startColumn:-1,endRow:-1,endColumn:-1}}getCellValueObject(e){const n=e.v||0;return vDe.has(n)?me.create(n):e.t===er.NUMBER?new tt(n):e.t===er.STRING||e.t===er.FORCE_STRING?new co(n):e.t===er.BOOLEAN?new ko(n):W6.create(n)}getCellByRow(e){return this.getCellByPosition(e)}getCellByColumn(e){return this.getCellByPosition(void 0,e)}getCurrentActiveSheetData(){return this._unitData[this.getUnitId()][this.getSheetId()]}getCurrentRuntimeSheetData(){var e,n;return(n=(e=this._runtimeData)==null?void 0:e[this.getUnitId()])==null?void 0:n[this.getSheetId()]}getCurrentActiveArrayFormulaCellData(){var e,n;return(n=(e=this._arrayFormulaCellData)==null?void 0:e[this.getUnitId()])==null?void 0:n[this.getSheetId()]}getCurrentRuntimeActiveArrayFormulaCellData(){var e,n;return(n=(e=this._runtimeArrayFormulaCellData)==null?void 0:e[this.getUnitId()])==null?void 0:n[this.getSheetId()]}getCellData(e,n){const r=this.getCurrentActiveSheetData(),i=this.getCurrentRuntimeSheetData(),o=this.getCurrentActiveArrayFormulaCellData(),s=this.getCurrentRuntimeActiveArrayFormulaCellData();return(i==null?void 0:i.getValue(e,n))||(s==null?void 0:s.getValue(e,n))||this.getRuntimeFeatureCellValue(e,n)||(o==null?void 0:o.getValue(e,n))||r.cellData.getValue(e,n)}getRuntimeFeatureCellValue(e,n){var r;const i=Object.keys(this._runtimeFeatureCellData);for(const o of i){const s=this._runtimeFeatureCellData[o],a=(r=s==null?void 0:s[this.getUnitId()])==null?void 0:r[this.getSheetId()];if(a==null)continue;const l=a.getValue(e,n);if(l!=null)return l}}getCellByPosition(e,n){e||(e=this._rangeData.startRow),n||(n=this._rangeData.startColumn);const r=this.getCellData(e,n);return r?this.getCellValueObject(r):me.create(ce.VALUE)}toArrayValueObject(){var e;const{startRow:n,endRow:r,startColumn:i,endColumn:o}=this.getRangePosition(),s=`${this.getUnitId()}_${this.getSheetId()}_${n+this._refOffsetY}_${r+this._refOffsetY}_${i+this._refOffsetX}_${o+this._refOffsetX}`,a=l_.get(s);if(a)return a;const l=r-n+1,u=o-i+1,c=new Array(l);this.iterator((f,m,p)=>{const g=m-n,v=p-i;c[g]||(c[g]=new Array(u)),f==null&&(f=new HP(0)),c[g][v]=f});const d={calculateValueList:c,rowCount:c.length,columnCount:((e=c[0])==null?void 0:e.length)||0,unitId:this.getUnitId(),sheetId:this.getSheetId(),row:n,column:i},h=new sl(d);return l_.set(s,h),h}toUnitRange(){return{range:this._rangeData,sheetId:this.getSheetId(),unitId:this.getUnitId()}}_checkIfWorksheetMiss(){return(this._forcedSheetId==null||this._forcedSheetId.length===0)&&this._forcedSheetName.length>0}},ZDe=class extends af{constructor(e){super(),this._promise=e}isAsyncObject(){return!0}async getValue(){return this._promise}},qDe=class extends af{constructor(e){super(),this._promiseList=e}isAsyncArrayObject(){return!0}async getValue(){var e;const n=[];for(let i=0;i<this._promiseList.length;i++){const o=this._promiseList[i];n[i]==null&&(n[i]=[]);for(let s=0;s<o.length;s++){const a=o[s];a.isAsyncObject()?n[i][s]=await a.getValue():n[i][s]=a}}const r={calculateValueList:n,rowCount:n.length,columnCount:((e=n[0])==null?void 0:e.length)||0,unitId:"",sheetId:"",row:0,column:0};return new sl(r)}},VP=class extends k4{constructor(e,n,r){super(""),this.setRangeData(e),n&&this.setForcedSheetIdDirect(n),r&&this.setForcedUnitIdDirect(r)}isRange(){return!0}};var my=(t=>(t.MAKEARRAY="MAKEARRAY",t))(my||{});class Fr extends je{constructor(e){super(),this._name=e}get name(){return this._name}isAsync(){return!1}isAddress(){return!1}calculate(...e){return me.create(ce.VALUE)}checkArrayType(e){return e.isReferenceObject()||e.isValueObject()&&e.isArray()}}var uf=(t=>(t.CONCATENATE="CONCATENATE",t))(uf||{}),u_=(t=>(t.INDIRECT="INDIRECT",t.OFFSET="OFFSET",t))(u_||{}),ci=(t=>(t.ABS="ABS",t.ACOS="ACOS",t.ACOSH="ACOSH",t.ACOT="ACOT",t.SUM="SUM",t.SUMIF="SUMIF",t.SUMIFS="SUMIFS",t.POWER="POWER",t))(ci||{}),Vn=(t=>(t.AVERAGE="AVERAGE",t.COUNT="COUNT",t.MAX="MAX",t.MIN="MIN",t.COUNTA="COUNTA",t))(Vn||{});let QDe=class extends je{constructor(){super(...arguments),Fe(this,"_definedNameMap",new Map)}dispose(){this._definedNameMap.clear()}registerDefinedName(e,n,r){var i;this._definedNameMap.get(e)==null&&this._definedNameMap.set(e,new Map),(i=this._definedNameMap.get(e))==null||i.set(n,r)}removeDefinedName(e,n){var r;(r=this._definedNameMap.get(e))==null||r.delete(n)}getDefinedNameMap(e){return this._definedNameMap.get(e)}getValue(e,n){var r;return(r=this._definedNameMap.get(e))==null?void 0:r.get(n)}hasDefinedName(e){var n;return(((n=this._definedNameMap.get(e))==null?void 0:n.size)||0)!==0}};const cf=nn("univer.formula.defined-names.service");var JDe=Object.defineProperty,eIe=Object.getOwnPropertyDescriptor,tIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?eIe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&JDe(e,n,i),i},nIe=(t,e)=>(n,r)=>e(n,r,t);let c_=class extends je{constructor(e){super(),Fe(this,"_unitData",{}),Fe(this,"_arrayFormulaCellData",{}),Fe(this,"_formulaData",{}),Fe(this,"_sheetNameMap",{}),Fe(this,"_forceCalculate",!1),Fe(this,"_dirtyRanges",[]),Fe(this,"_dirtyNameMap",{}),Fe(this,"_dirtyUnitFeatureMap",{}),Fe(this,"_excludedCell"),this._currentUniverService=e}dispose(){this._unitData={},this._formulaData={},this._arrayFormulaCellData={},this._sheetNameMap={},this._dirtyRanges=[],this._dirtyNameMap={},this._dirtyUnitFeatureMap={},this._excludedCell={}}getExcludedRange(){return this._excludedCell}getUnitData(){return this._unitData}getFormulaData(){return this._formulaData}getArrayFormulaCellData(){return this._arrayFormulaCellData}getSheetNameMap(){return this._sheetNameMap}isForceCalculate(){return this._forceCalculate}getDirtyRanges(){return this._dirtyRanges}getDirtyNameMap(){return this._dirtyNameMap}getDirtyUnitFeatureMap(){return this._dirtyUnitFeatureMap}load(e){const{allUnitData:n,unitSheetNameMap:r}=this._loadSheetData();this._unitData=n,this._formulaData=e.formulaData,this._arrayFormulaCellData=IP(e.arrayFormulaCellData),this._sheetNameMap=r,this._forceCalculate=e.forceCalculate,this._dirtyRanges=e.dirtyRanges,this._dirtyNameMap=e.dirtyNameMap,this._dirtyUnitFeatureMap=e.dirtyUnitFeatureMap,this._excludedCell=e.excludedCell}loadDirtyRangesAndExcludedCell(e,n){this._dirtyRanges=e,this._excludedCell=n}registerUnitData(e){this._unitData=e}registerFormulaData(e){this._formulaData=e}registerSheetNameMap(e){this._sheetNameMap=e}_loadSheetData(){const e=this._currentUniverService.getAllUniverSheetsInstance(),n={},r={};for(const i of e){const o=i.getUnitId(),s=i.getSheets(),a={},l={};for(const u of s){const c=u.getSheetId(),d=u.getConfig();a[c]={cellData:new nt(d.cellData),rowCount:d.rowCount,columnCount:d.columnCount},l[u.getName()]=u.getSheetId()}n[o]=a,r[o]=l}return{allUnitData:n,unitSheetNameMap:r}}};c_=tIe([nIe(0,oe)],c_);const w0=nn("univer.formula.current-data.service");var rIe=Object.defineProperty,iIe=Object.getOwnPropertyDescriptor,oIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?iIe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&rIe(e,n,i),i},sIe=(t,e)=>(n,r)=>e(n,r,t),Qa=(t=>(t[t.IDLE=0]="IDLE",t[t.START_DEPENDENCY=1]="START_DEPENDENCY",t[t.START_CALCULATION=2]="START_CALCULATION",t[t.CURRENTLY_CALCULATING=3]="CURRENTLY_CALCULATING",t[t.START_DEPENDENCY_ARRAY_FORMULA=4]="START_DEPENDENCY_ARRAY_FORMULA",t[t.START_CALCULATION_ARRAY_FORMULA=5]="START_CALCULATION_ARRAY_FORMULA",t[t.CURRENTLY_CALCULATING_ARRAY_FORMULA=6]="CURRENTLY_CALCULATING_ARRAY_FORMULA",t[t.CALCULATION_COMPLETED=7]="CALCULATION_COMPLETED",t))(Qa||{}),s1=(t=>(t[t.INITIAL=0]="INITIAL",t[t.STOP_EXECUTION=1]="STOP_EXECUTION",t[t.NOT_EXECUTED=2]="NOT_EXECUTED",t[t.SUCCESS=3]="SUCCESS",t))(s1||{});let d_=class extends je{constructor(e){super(),Fe(this,"_formulaExecuteStage",0),Fe(this,"_stopState",!1),Fe(this,"_currentRow",0),Fe(this,"_currentColumn",0),Fe(this,"_currentSubComponentId",""),Fe(this,"_currentUnitId",""),Fe(this,"_runtimeData",{}),Fe(this,"_runtimeOtherData",{}),Fe(this,"_unitArrayFormulaRange",{}),Fe(this,"_runtimeArrayFormulaCellData",{}),Fe(this,"_runtimeClearArrayFormulaCellData",{}),Fe(this,"_runtimeFeatureRange",{}),Fe(this,"_runtimeFeatureCellData",{}),Fe(this,"_functionsExecutedState",0),Fe(this,"_functionDefinitionPrivacyVar",new Map),Fe(this,"_totalFormulasToCalculate",0),Fe(this,"_completedFormulasCount",0),Fe(this,"_totalArrayFormulasToCalculate",0),Fe(this,"_completedArrayFormulasCount",0),Fe(this,"_isCycleDependency",!1),this._currentConfigService=e}get currentRow(){return this._currentRow}get currentColumn(){return this._currentColumn}get currentSubComponentId(){return this._currentSubComponentId}get currentUnitId(){return this._currentUnitId}dispose(){this.reset(),this._runtimeFeatureCellData={},this._runtimeFeatureRange={}}enableCycleDependency(){this._isCycleDependency=!0}disableCycleDependency(){this._isCycleDependency=!1}isCycleDependency(){return this._isCycleDependency}setTotalArrayFormulasToCalculate(e){this._totalArrayFormulasToCalculate=e}getTotalArrayFormulasToCalculate(){return this._totalArrayFormulasToCalculate}setCompletedArrayFormulasCount(e){this._completedArrayFormulasCount=e}getCompletedArrayFormulasCount(){return this._completedArrayFormulasCount}setTotalFormulasToCalculate(e){this._totalFormulasToCalculate=e}getTotalFormulasToCalculate(){return this._totalFormulasToCalculate}setCompletedFormulasCount(e){this._completedFormulasCount=e}getCompletedFormulasCount(){return this._completedFormulasCount}markedAsSuccessfullyExecuted(){this._functionsExecutedState=3}markedAsNoFunctionsExecuted(){this._functionsExecutedState=2}markedAsStopFunctionsExecuted(){this._functionsExecutedState=1}markedAsInitialFunctionsExecuted(){this._functionsExecutedState=0}stopExecution(){this._stopState=!0,this.setFormulaExecuteStage(0)}isStopExecution(){return this._stopState}setFormulaExecuteStage(e){this._formulaExecuteStage=e}getFormulaExecuteStage(){return this._formulaExecuteStage}reset(){this._formulaExecuteStage=0,this._runtimeData={},this._runtimeOtherData={},this._unitArrayFormulaRange={},this._runtimeArrayFormulaCellData={},this._runtimeClearArrayFormulaCellData={},this._functionDefinitionPrivacyVar.clear(),this.markedAsInitialFunctionsExecuted(),this._isCycleDependency=!1,this._totalFormulasToCalculate=0,this._completedFormulasCount=0}setCurrent(e,n,r,i){this._currentRow=e,this._currentColumn=n,this._currentSubComponentId=r,this._currentUnitId=i}clearFunctionDefinitionPrivacyVar(){this._functionDefinitionPrivacyVar.clear()}registerFunctionDefinitionPrivacyVar(e,n){this._functionDefinitionPrivacyVar.set(e,n)}getFunctionDefinitionPrivacyVar(e){return this._functionDefinitionPrivacyVar.get(e)}setRuntimeOtherData(e,n){const r=this._currentSubComponentId,i=this._currentUnitId;this._runtimeOtherData[i]===void 0&&(this._runtimeOtherData[i]={});const o=this._runtimeOtherData[i];o[r]===void 0&&(o[r]={});const s=o[r];s[e]=this._objectValueToCellValue(n)}setRuntimeData(e){const n=this._currentRow,r=this._currentColumn,i=this._currentSubComponentId,o=this._currentUnitId;this._runtimeData[o]==null&&(this._runtimeData[o]={});const s=this._runtimeData[o];s[i]==null&&(s[i]=new nt),this._unitArrayFormulaRange[o]==null&&(this._unitArrayFormulaRange[o]={});const a=this._unitArrayFormulaRange[o];let l=new nt;a[i]||(l=new nt(a[i])),this._runtimeArrayFormulaCellData[o]===void 0&&(this._runtimeArrayFormulaCellData[o]={});const u=this._runtimeArrayFormulaCellData[o];u[i]==null&&(u[i]=new nt),this._runtimeClearArrayFormulaCellData[o]===void 0&&(this._runtimeClearArrayFormulaCellData[o]={});const c=this._runtimeClearArrayFormulaCellData[o];c[i]==null&&(c[i]=new nt);const d=s[i],h=u[i],f=c[i];if(e.isReferenceObject()||e.isValueObject()&&e.isArray()){const m=e,{startRow:p,startColumn:g,endRow:v,endColumn:_}=m.getRangePosition();if(p===v&&g===_){const y=this._objectValueToCellValue(m.getFirstCell());d.setValue(n,r,y),f.setValue(n,r,y);return}const C={startRow:n,startColumn:r,endRow:v-p+n,endColumn:_-g+r};if(this._checkIfArrayFormulaRangeHasData(o,i,n,r,C)){const y=this._objectValueToCellValue(new me(ce.SPILL));d.setValue(n,r,y),f.setValue(n,r,y)}else{const y=new me(ce.SPILL);m.iterator((S,E,w)=>{const R=this._objectValueToCellValue(S);if(E===p&&w===g){if(S!=null&&S.isError()&&S.isEqualType(y))return f.setValue(n,r,{}),d.setValue(n,r,{...this._objectValueToCellValue(y)}),!1;d.setValue(n,r,{...R})}h.setValue(E-p+n,w-g+r,R)}),l.setValue(n,r,C),a[i]=l.getData()}}else{const m=this._objectValueToCellValue(e);d.setValue(n,r,m),f.setValue(n,r,m)}}getUnitData(){return this._runtimeData}getUnitArrayFormula(){return this._unitArrayFormulaRange}getRuntimeOtherData(){return this._runtimeOtherData}getRuntimeArrayFormulaCellData(){return this._runtimeArrayFormulaCellData}getRuntimeClearArrayFormulaCellData(){return this._runtimeClearArrayFormulaCellData}getRuntimeFeatureRange(){return this._runtimeFeatureRange}setRuntimeFeatureRange(e,n){this._runtimeFeatureRange[e]=n}getRuntimeFeatureCellData(){return this._runtimeFeatureCellData}setRuntimeFeatureCellData(e,n){this._runtimeFeatureCellData[e]=n}getAllRuntimeData(){return{unitData:this.getUnitData(),arrayFormulaRange:this.getUnitArrayFormula(),unitOtherData:this.getRuntimeOtherData(),functionsExecutedState:this._functionsExecutedState,arrayFormulaCellData:this.getRuntimeArrayFormulaCellData(),clearArrayFormulaCellData:this.getRuntimeClearArrayFormulaCellData(),runtimeFeatureRange:this.getRuntimeFeatureRange(),runtimeFeatureCellData:this.getRuntimeFeatureCellData()}}getRuntimeState(){return{totalFormulasToCalculate:this.getTotalFormulasToCalculate(),completedFormulasCount:this.getCompletedFormulasCount(),totalArrayFormulasToCalculate:this.getTotalArrayFormulasToCalculate(),completedArrayFormulasCount:this.getCompletedArrayFormulasCount(),stage:this.getFormulaExecuteStage()}}_objectValueToCellValue(e){if(e==null)return{v:0,t:er.NUMBER};if(e.isError())return{v:e.getErrorType(),t:er.STRING};if(e.isValueObject()){const n=e,r=n.getValue();return n.isNumber()?{v:r,t:er.NUMBER}:n.isBoolean()?{v:r,t:er.BOOLEAN}:{v:r,t:er.STRING}}}_checkIfArrayFormulaRangeHasData(e,n,r,i,o){var s,a,l,u,c,d;const{startRow:h,startColumn:f,endRow:m,endColumn:p}=o,g=this._currentConfigService.getUnitData();for(let v=h;v<=m;v++)for(let _=f;_<=p;_++){if(v===r&&i===_)continue;const C=(l=(a=(s=this._runtimeData)==null?void 0:s[e])==null?void 0:a[n])==null?void 0:l.getValue(v,_),y=(d=(c=(u=g==null?void 0:g[e])==null?void 0:u[n])==null?void 0:c.cellData)==null?void 0:d.getValue(v,_);if((!dh(C)||!dh(y))&&this._isInDirtyRange(e,n,v,_))return!0}return!1}_isInDirtyRange(e,n,r,i){const o=this._currentConfigService.getDirtyRanges();return gDe(o,e,n,r,i)}};d_=oIe([sIe(0,w0)],d_);const Fa=nn("univer.formula.runtime.service");var aIe=Object.defineProperty,lIe=Object.getOwnPropertyDescriptor,uIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?lIe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&aIe(e,n,i),i},ip=(t,e)=>(n,r)=>e(n,r,t);let Zu=class extends je{constructor(e,n,r){super(),this._definedNamesService=e,this._runtimeService=n,this._lexerTreeBuilder=r}treeBuilder(e,n=!0){return this._lexerTreeBuilder.treeBuilder(e,n,this._injectDefinedName.bind(this))}_injectDefinedName(e){var n;const r=this._runtimeService.currentUnitId;if(!this._definedNamesService.hasDefinedName(r))return{sequenceString:"",hasDefinedName:!1};const i=this._lexerTreeBuilder.getSequenceNode(e);let o="",s=!1;for(let a=0,l=i.length;a<l;a++){const u=i[a];if(typeof u=="string"){o+=u;continue}const{nodeType:c,token:d}=u;if(c===Hr.REFERENCE||c===Hr.FUNCTION){const h=(n=this._definedNamesService.getDefinedNameMap(r))==null?void 0:n.get(d);h?(o+=h,s=!0):o+=d}else o+=d}return{sequenceString:o,hasDefinedName:s}}};Zu=uIe([ip(0,cf),ip(1,Fa),ip(2,ne(Ba))],Zu);var _n=(t=>(t.REFERENCE="ReferenceNode",t.VALUE="ValueNode",t.OPERATOR="OperatorNode",t.FUNCTION="FunctionNode",t.LAMBDA="LambdaNode",t.LAMBDA_PARAMETER="LambdaNodeParameter",t.ERROR="ErrorNode",t.BASE="Base",t.ROOT="Root",t.UNION="UnionNode",t.PREFIX="PrefixNode",t.SUFFIX="SuffixNode",t.NULL="NullNode",t))(_n||{});const Ua=new Map([["ReferenceNode",7],["ValueNode",9],["OperatorNode",8],["FunctionNode",6],["LambdaNode",1],["LambdaNodeParameter",2],["Root",10],["UnionNode",3],["PrefixNode",4],["SuffixNode",5]]);class Xo extends je{constructor(e){super(),Fe(this,"_children",[]),Fe(this,"_parent"),Fe(this,"_valueObject"),Fe(this,"_calculateState",!1),Fe(this,"_async",!1),Fe(this,"_address",!1),Fe(this,"_refOffsetX",0),Fe(this,"_refOffsetY",0),this._token=e}dispose(){var e;this._children.forEach(n=>{n.dispose()}),(e=this._valueObject)==null||e.dispose(),this._parent=null}get nodeType(){return _n.BASE}isAsync(){return this._async}isAddress(){return this._address}setAsync(){this._async=!0}setAddress(){this._address=!0}getParent(){return this._parent}setParent(e){this._parent=e,e.addChildren(this)}getChildren(){return this._children}addChildren(...e){this._children.push(...e)}getToken(){return this._token}setValue(e){this._valueObject=e}getValue(){return this._valueObject}isCalculated(){return this._calculateState}setCalculated(){this._calculateState=!0}execute(){}setNotEmpty(e=!0){}setRefOffset(e=0,n=0){this._refOffsetX=e,this._refOffsetY=n}getRefOffset(){return{x:this._refOffsetX,y:this._refOffsetY}}async executeAsync(){return Promise.resolve(ol.SUCCESS)}serialize(){const e=this.getToken(),n=this.getChildren(),r=[],i=n.length;for(let s=0;s<i;s++){const a=n[s];r.push(a.serialize())}const o={token:e,nodeType:this.nodeType};return i>0&&(o.children=r),o}}class di extends Xo{constructor(e){super(e),Fe(this,"_errorValueObject"),this._errorValueObject=me.create(e)}get nodeType(){return _n.ERROR}static create(e){return new di(e)}getValue(){return this._errorValueObject}}const Ha=100;let Va=class extends je{get zIndex(){return 0}create(e,n,r){let i;return e instanceof bn?i=e.getToken():i=e,new Xo(i)}checkAndCreateNodeType(e){}},h_=class extends Xo{get nodeType(){return _n.ROOT}execute(){const e=this.getChildren()[0];this.setValue(e.getValue())}},jP=class extends Va{get zIndex(){return Ua.get(_n.ROOT)||Ha}checkAndCreateNodeType(e){if(e instanceof bn&&e.getToken()===El)return new h_(El)}};var Xi=(t=>(t.COMPARE="COMPARE",t.DIVIDED="DIVIDED",t.MINUS="MINUS",t.MULTIPLY="MULTIPLY",t.PLUS="PLUS",t.UNION="UNION",t))(Xi||{});let cIe=class extends je{constructor(){super(...arguments),Fe(this,"_functionExecutors",new Map),Fe(this,"_functionDescriptions",new Map)}dispose(){this._functionExecutors.clear(),this._functionDescriptions.clear()}registerExecutors(...e){for(let n=0;n<e.length;n++){const r=e[n];this._functionExecutors.set(r.name,r)}}getExecutors(){return this._functionExecutors}getExecutor(e){return this._functionExecutors.get(e)}hasExecutor(e){return this._functionExecutors.has(e)}registerDescriptions(...e){for(let n=0;n<e.length;n++){const r=e[n];this._functionDescriptions.set(r.functionName,r)}}getDescriptions(){return this._functionDescriptions}getDescription(e){return this._functionDescriptions.get(e)}hasDescription(e){return this._functionDescriptions.has(e)}};const x1=nn("univer.formula.function.service");var dIe=Object.defineProperty,hIe=Object.getOwnPropertyDescriptor,fIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?hIe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&dIe(e,n,i),i},yD=(t,e)=>(n,r)=>e(n,r,t);let h5=class extends Xo{constructor(e,n,r){super(n),this._accessor=e,this._operatorString=n,this._functionExecutor=r}get nodeType(){return _n.PREFIX}execute(){let e=this.getChildren()[0].getValue(),n;if(e==null)throw new Error("object is null");e.isReferenceObject()&&(e=e.toArrayValueObject()),this._operatorString===ri.MINUS?n=this._functionExecutor.calculate(new tt(0),e):this._operatorString===ri.AT?n=this._handlerAT(e):n=me.create(ce.VALUE),this.setValue(n)}_handlerAT(e){if(!e.isReferenceObject())return me.create(ce.VALUE);const n=e;if(n.isCell())return me.create(ce.VALUE);const r=this._accessor.get(Fa),i=r.currentRow||0,o=r.currentColumn||0;return n.isRow()?n.getCellByColumn(o):n.isColumn()?n.getCellByRow(i):n.isRange()||n.isTable()?n.getCellByPosition():me.create(ce.VALUE)}},f5=class extends Va{constructor(e,n){super(),this._functionService=e,this._injector=n}get zIndex(){return Ua.get(_n.PREFIX)||Ha}checkAndCreateNodeType(e){if(!(e instanceof bn))return;const n=e.getToken(),r=n.trim();if(r.charAt(0)==='"'&&r.charAt(r.length-1)==='"')return;let i="";if(r===ri.MINUS)i=Xi.MINUS;else return r===ri.AT?new h5(this._injector,r):void 0;const o=this._functionService.getExecutor(i);return o?new h5(this._injector,r,o):(console.error(`No function ${n}`),di.create(ce.NAME))}};f5=fIe([yD(0,x1),yD(1,ne(Tn))],f5);var mIe=Object.defineProperty,pIe=Object.getOwnPropertyDescriptor,gIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?pIe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&mIe(e,n,i),i},SD=(t,e)=>(n,r)=>e(n,r,t);let vIe=class extends Xo{constructor(e,n){super(e),this._functionExecutor=n,this._functionExecutor.isAsync()&&this.setAsync(),this._functionExecutor.isAddress()&&this.setAddress()}get nodeType(){return _n.FUNCTION}async executeAsync(){const e=[],n=this.getChildren(),r=n.length;for(let o=0;o<r;o++){const s=n[o].getValue();s!=null&&(s.isReferenceObject()?e.push(s.toArrayValueObject()):e.push(s))}const i=this._functionExecutor.calculate(...e);return i.isAsyncObject()||i.isAsyncArrayObject()?this.setValue(await i.getValue()):this.setValue(i),Promise.resolve(ol.SUCCESS)}execute(){const e=[],n=this.getChildren(),r=n.length;for(let o=0;o<r;o++){const s=n[o].getValue();s!=null&&(s.isReferenceObject()?e.push(s.toArrayValueObject()):e.push(s))}const i=this._functionExecutor.calculate(...e);this.setValue(i)}},m5=class extends Va{constructor(e,n){super(),this._functionService=e,this._injector=n}get zIndex(){return Ua.get(_n.FUNCTION)||Ha}create(e){const n=this._functionService.getExecutor(e);return n?new vIe(e,n):(console.error(`No function ${e}`),di.create(ce.NAME))}checkAndCreateNodeType(e){if(typeof e=="string")return;let n=e.getToken().trim().toUpperCase(),r,i;const o=n.slice(0,2);let s=0;if(new RegExp(ri.MINUS,"g").test(o)){const a=this._functionService.getExecutor(Xi.MINUS);r=new h5(this._injector,ri.MINUS,a),s++}if(new RegExp(ri.AT,"g").test(o)&&(i=new h5(this._injector,ri.AT),r&&i.setParent(r),s++),s>0&&(n=n.slice(s)),this._functionService.hasExecutor(n)){const a=this.create(n);return i?a.setParent(i):r&&a.setParent(r),a}}};m5=gIe([SD(0,x1),SD(1,ne(Tn))],m5);var _Ie=Object.defineProperty,bIe=Object.getOwnPropertyDescriptor,CIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?bIe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&_Ie(e,n,i),i},yIe=(t,e)=>(n,r)=>e(n,r,t);let n0=class extends je{constructor(e){super(),this._runtimeService=e}dispose(){}async executeAsync(e){if(!e)return me.create(ce.VALUE);await this._executeAsync(e);const n=e.getValue();if(n==null)throw new Error("node value is null");return Promise.resolve(n)}execute(e){if(!e)return me.create(ce.VALUE);this._execute(e);const n=e.getValue();if(n==null)throw new Error("node value is null");return n}executePreCalculateNode(e){return e.execute(),e.getValue()}checkAsyncNode(e){const n=[];this._checkAsyncNode(e,n);for(let r=0,i=n.length;r<i;r++)if(n[r]===!0)return!0;return!1}_checkAsyncNode(e,n){const r=e.getChildren(),i=r.length;for(let o=0;o<i;o++){const s=r[o];n.push(s.isAsync()),this._checkAsyncNode(s,n)}}async _executeAsync(e){if(this._runtimeService.isStopExecution())return Promise.resolve(ol.ERROR);const n=e.getChildren(),r=n.length;for(let i=0;i<r;i++){const o=n[i];if(o.getToken().toUpperCase()===z6&&o.isEmptyParamFunction()){await o.executeAsync();continue}await this._executeAsync(o)}return e.nodeType===_n.FUNCTION&&e.isAsync()?await e.executeAsync():e.execute(),Promise.resolve(ol.SUCCESS)}_execute(e){if(this._runtimeService.isStopExecution())return ol.ERROR;const n=e.getChildren(),r=n.length;for(let i=0;i<r;i++){const o=n[i];if(o.getToken().toUpperCase()===z6&&o.isEmptyParamFunction()){o.execute();continue}this._execute(o)}return e.execute(),ol.SUCCESS}};n0=CIe([yIe(0,Fa)],n0);function zP(t){return t instanceof bn?t.getToken()===e0:!1}function SIe(t){return t instanceof bn?t.getToken()===MP:!1}let ED=class extends dc{constructor(e,n,r){super(0),Fe(this,"_lambdaPrivacyValueMap",new Map),this._lambdaNode=e,this._interpreter=n,this._lambdaPrivacyVarKeys=r,this._lambdaPrivacyValueMap.clear()}isLambda(){return!0}execute(...e){const n=this._lambdaPrivacyVarKeys.length;if(e.length!==n)return new me(ce.VALUE);this._setLambdaPrivacyValueMap(e),this._setLambdaNodeValue(this._lambdaNode),this._lambdaNode.setNotEmpty(!1);let r;if(this._interpreter.checkAsyncNode(this._lambdaNode))r=new ZDe(this._interpreter.executeAsync(this._lambdaNode));else{const i=this._interpreter.execute(this._lambdaNode);i.isReferenceObject()?r=i.toArrayValueObject():r=i}return this._lambdaNode.setNotEmpty(!0),r}_setLambdaNodeValue(e){const n=e.getChildren(),r=n.length;for(let i=0;i<r;i++){const o=n[i];if(o.getToken()===of){const s=o.getLambdaParameter(),a=this._lambdaPrivacyValueMap.get(s);a&&o.setValue(a);continue}this._setLambdaNodeValue(o)}}_setLambdaPrivacyValueMap(e){for(let n=0;n<e.length;n++){const r=e[n],i=this._lambdaPrivacyVarKeys[n];this._lambdaPrivacyValueMap.set(i,r)}}};var EIe=Object.defineProperty,wIe=Object.getOwnPropertyDescriptor,RIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?wIe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&EIe(e,n,i),i},wD=(t,e)=>(n,r)=>e(n,r,t);let DIe=class extends Xo{constructor(e,n,r,i){super(e),Fe(this,"_isNotEmpty",!0),this._lambdaId=n,this._interpreter=r,this._lambdaPrivacyVarKeys=i}get nodeType(){return _n.LAMBDA}setNotEmpty(e=!1){this._isNotEmpty=e}isEmptyParamFunction(){return this.getChildren().length<2&&this._isNotEmpty}isFunctionParameter(){return this._lambdaId===null}getLambdaId(){return this._lambdaId}execute(){if(this.isEmptyParamFunction())this.setValue(new ED(this,this._interpreter,this._lambdaPrivacyVarKeys));else{const e=this.getChildren(),n=e.length;this.setValue(e[n-1].getValue())}}async executeAsync(){if(this.isEmptyParamFunction())await this.setValue(new ED(this,this._interpreter,this._lambdaPrivacyVarKeys));else{const e=this.getChildren(),n=e.length;await this.setValue(e[n-1].getValue())}return Promise.resolve(ol.SUCCESS)}},p5=class extends Va{constructor(e,n){super(),this._runtimeService=e,this._interpreter=n}get zIndex(){return Ua.get(_n.LAMBDA)||Ha}create(e){const n=e.getChildren(),r=n[0];let i=n.slice(1,-1);const o=n[n.length-1];if(!(r instanceof bn&&o instanceof bn))return di.create(ce.NAME);if(r.getToken()===e0){const l=r.getChildren();if(i.length!==l.length)return di.create(ce.VALUE)}else i=n.slice(0,-1);const s=De.generateRandomId(8),a=new Map;for(let l=0;l<i.length;l++){const u=i[l];if(u instanceof bn){const c=u.getChildren()[0];u.setToken(MP),a.set(c.trim(),void 0)}else return di.create(ce.VALUE)}return this._runtimeService.registerFunctionDefinitionPrivacyVar(s,a),this._updateLambdaStatement(o,s,a),new DIe(e.getToken(),s,this._interpreter,[...a.keys()])}checkAndCreateNodeType(e){if(!(!(e instanceof bn)||e.getToken().trim().toUpperCase()!==z6))return this.create(e)}_updateLambdaStatement(e,n,r){this._updateTree(e,n,r)}_updateTree(e,n,r){const i=e.getChildren(),o=i.length,s=i[0];for(let a=0;a<o;a++){const l=i[a];if(!(zP(s)&&a!==0))if(l instanceof bn)this._updateTree(l,n,r);else{const u=l.trim();if(r.has(u)){const c=new bn;c.setToken(of),c.setLambdaId(n),c.setLambdaPrivacyVar(r),c.setLambdaParameter(u),i[a]=c}}}}};p5=RIe([wD(0,Fa),wD(1,ne(n0))],p5);let IIe=class extends Xo{constructor(e,n,r){super(e),this._lambdaParameter=n,this._currentLambdaPrivacyVar=r}getLambdaParameter(){return this._lambdaParameter}getCurrentLambdaPrivacyVar(){return this._currentLambdaPrivacyVar}get nodeType(){return _n.LAMBDA_PARAMETER}execute(){const e=this._getRootLexerNode(this._currentLambdaPrivacyVar.get(this._lambdaParameter));if(e)this.setValue(e.getValue());else{const n=this.getValue();(n==null||n.isError())&&this.setValue(me.create(ce.SPILL))}}_getRootLexerNode(e){if(!e)return;if(e.getToken()!==of)return e;const n=e,r=n.getCurrentLambdaPrivacyVar(),i=n.getLambdaParameter();if(r)return this._getRootLexerNode(r.get(i))}},WP=class extends Va{get zIndex(){return Ua.get(_n.LAMBDA_PARAMETER)||Ha}create(e){const n=e.getFunctionDefinitionPrivacyVar(),r=e.getLambdaParameter();return n?new IIe(e.getToken(),r,n):new di(ce.SPILL)}checkAndCreateNodeType(e){if(!(!(e instanceof bn)||e.getToken().trim()!==of))return this.create(e)}},xIe=class extends Xo{constructor(e){super(e),this._operatorString=e}get nodeType(){return _n.NULL}execute(){this.setValue(new HP(0))}};var MIe=Object.defineProperty,OIe=Object.getOwnPropertyDescriptor,TIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?OIe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&MIe(e,n,i),i},$Ie=(t,e)=>(n,r)=>e(n,r,t);let kIe=class extends Xo{constructor(e,n){super(e),this._operatorString=e,this._functionExecutor=n}get nodeType(){return _n.OPERATOR}execute(){const e=this.getChildren();this._functionExecutor.name===Xi.COMPARE&&this._functionExecutor.setCompareType(this.getToken());let n=e[0].getValue(),r=e[1].getValue();if(n==null||r==null)throw new Error("object1 or object2 is null");n.isReferenceObject()&&(n=n.toArrayValueObject()),r.isReferenceObject()&&(r=r.toArrayValueObject()),this.setValue(this._functionExecutor.calculate(n,r))}},g5=class extends Va{constructor(e){super(),this._functionService=e}get zIndex(){return Ua.get(_n.OPERATOR)||Ha}create(e){let n="";const r=e;r===$o.PLUS?n=Xi.PLUS:r===$o.MINUS?n=Xi.MINUS:r===$o.MULTIPLY?n=Xi.MULTIPLY:r===$o.DIVIDED?n=Xi.DIVIDED:r===$o.CONCATENATE?n=uf.CONCATENATE:r===$o.POWER?n=ci.POWER:_De.has(r)&&(n=Xi.COMPARE);const i=this._functionService.getExecutor(n);return i?new kIe(r,i):(console.error(`No function ${e}`),di.create(ce.NAME))}checkAndCreateNodeType(e){if(e instanceof bn)return;const n=e.trim();if(!(n.charAt(0)==='"'&&n.charAt(n.length-1)==='"')&&$d.has(n))return this.create(n)}};g5=TIe([$Ie(0,x1)],g5);let AIe=class extends je{constructor(){super(...arguments),Fe(this,"_tableMap",new Map),Fe(this,"_tableOptionMap",new Map)}dispose(){this._tableMap.clear(),this._tableOptionMap.clear()}remove(e,n){var r;(r=this._tableMap.get(e))==null||r.delete(n)}getTableMap(e){return this._tableMap.get(e)}getTableOptionMap(){return this._tableOptionMap}registerTable(e,n,r){var i;this._tableMap.get(e)==null&&this._tableMap.set(e,new Map),(i=this._tableMap.get(e))==null||i.set(n,r)}registerTableOptionMap(e,n){this._tableOptionMap.set(e,n)}};const py=nn("univer.formula.super-table.service");let gy=class extends k4{constructor(e){super(e);const n=xa(e);this.setForcedUnitIdDirect(n.unitId),this.setForcedSheetName(n.sheetName),this.setRangeData(n.range)}isCell(){return!0}unionBy(e){if(!e.isCell())return me.create(ce.REF);const n=e,r=this.unionRange(this.getRangeData(),n.getRangeData());return this._createRange(r)}unionRange(e,n){const r=e.startRow,i=e.startColumn,o=n.startRow,s=n.startColumn,a={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1};return r>o?(a.startRow=o,a.endRow=r):(a.startRow=r,a.endRow=o),i>s?(a.startColumn=s,a.endColumn=i):(a.startColumn=i,a.endColumn=s),a}_createRange(e){const n=new VP(e,this.getForcedSheetId(),this.getForcedUnitId());n.setUnitData(this.getUnitData()),n.setDefaultSheetId(this.getDefaultSheetId()),n.setDefaultUnitId(this.getDefaultUnitId()),n.setRuntimeData(this.getRuntimeData()),n.setArrayFormulaCellData(this.getArrayFormulaCellData()),n.setRuntimeArrayFormulaCellData(this.getRuntimeArrayFormulaCellData()),n.setRuntimeFeatureCellData(this.getRuntimeFeatureCellData());const{x:r,y:i}=this.getRefOffset();n.setRefOffset(r,i);const o=this.getForcedSheetId();n.setForcedSheetName(this.getForcedSheetName()),o!=null&&n.setForcedSheetIdDirect(o);const s=this.getForcedUnitId();return s&&n.setForcedUnitIdDirect(s),n}},NIe=class extends k4{constructor(e){super(e);const n=xa(e);this.setForcedUnitIdDirect(n.unitId),this.setForcedSheetName(n.sheetName);const r={startColumn:n.range.startColumn,startRow:-1,endColumn:-1,endRow:-1};this.setRangeData(r)}isColumn(){return!0}unionBy(e){if(!e.isColumn())return me.create(ce.REF);const n=e;if(n.getForcedSheetName()!==void 0)return me.create(ce.REF);const r=this.getRangeData();if(r.endColumn!==-1)return me.create(ce.REF);const i=n.getRangeData().startColumn,o=r.startColumn;return i>o?r.endColumn=i:(r.startColumn=i,r.endColumn=o),this}},LIe=class extends k4{constructor(e){super(e);const n=xa(e);this.setForcedUnitIdDirect(n.unitId),this.setForcedSheetName(n.sheetName);const r={startColumn:-1,startRow:n.range.startRow,endColumn:-1,endRow:-1};this.setRangeData(r)}isRow(){return!0}unionBy(e){if(!e.isRow())return me.create(ce.REF);const n=e;if(n.getForcedSheetName()!==void 0)return me.create(ce.REF);const r=this.getRangeData();if(r.endRow!==-1)return me.create(ce.REF);const i=n.getRangeData().startRow,o=r.startRow;return i>o?r.endRow=i:(r.startRow=i,r.endRow=o),this}},PIe=class extends k4{constructor(e,n,r,i){super(e),this._tableData=n,this._columnDataString=r;const o=this._tableData.sheetId,s=this._tableData.range,a=this._tableData.titleMap;this.setForcedSheetIdDirect(o);const l=this._stringToColumnData(this._columnDataString,a,i),u=l.startColumn,c=l.endColumn,d=l.type;let h=-1,f=-1;const m=s.startRow,p=s.startColumn;d===_u.ALL?(h=m,f=p):d===_u.DATA?(h=m+1,f=p):d===_u.HEADERS?(h=m,f=m):d===_u.TOTALS&&(h=p,f=p),this.setRangeData({startColumn:u,endColumn:c,startRow:h,endRow:f})}isTable(){return!0}_stringToColumnData(e,n,r){e=e.substring(1,-1);const i=e.indexOf(cn.COMMA);let o=-1,s=-1,a=_u.ALL;if(i===-1){const l=this._columnHandler(e,n);o=l.startColumn,s=l.endColumn}else{const l=e.substring(0,i).substring(1,-1),u=e.substring(i+1),c=this._columnHandler(u,n,!0);o=c.startColumn,s=c.endColumn,a=r.get(l),a||(a=_u.ALL)}return{startColumn:o,endColumn:s,type:a}}_columnHandler(e,n,r=!1){let i=-1,o=-1;const s=e.indexOf(cn.COLON);if(new RegExp(xP,"g").test(e)){const a=e.substring(0,s).substring(1,-1),l=e.substring(s+1).substring(1,-1);i=n.get(a)??-1,o=n.get(l)??-1}else r&&(e=e.substring(1,-1)),i=n.get(e)??-1,o=i;return{startColumn:i,endColumn:o}}};var BIe=Object.defineProperty,FIe=Object.getOwnPropertyDescriptor,UIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?FIe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&BIe(e,n,i),i},ld=(t,e)=>(n,r)=>e(n,r,t);let X7=class extends Xo{constructor(e,n,r){super(n),this._accessor=e,this._operatorString=n,this._referenceObject=r}get nodeType(){return _n.REFERENCE}execute(){const e=this._accessor.get(w0),n=this._accessor.get(Fa);this._referenceObject.setDefaultUnitId(n.currentUnitId),this._referenceObject.setDefaultSheetId(n.currentSubComponentId),this._referenceObject.setForcedSheetId(e.getSheetNameMap()),this._referenceObject.setUnitData(e.getUnitData()),this._referenceObject.setArrayFormulaCellData(e.getArrayFormulaCellData()),this._referenceObject.setRuntimeData(n.getUnitData()),this._referenceObject.setRuntimeArrayFormulaCellData(n.getRuntimeArrayFormulaCellData()),this._referenceObject.setRuntimeFeatureCellData(n.getRuntimeFeatureCellData());const{x:r,y:i}=this.getRefOffset();this._referenceObject.setRefOffset(r,i),this.setValue(this._referenceObject)}},v5=class extends Va{constructor(e,n,r,i,o){super(),this._definedNamesService=e,this._superTableService=n,this._formulaRuntimeService=r,this._lexer=i,this._injector=o}get zIndex(){return Ua.get(_n.REFERENCE)||Ha}checkAndCreateNodeType(e){let n=!1,r;if(e instanceof bn?(n=!0,r=e.getToken().trim()):r=e.trim(),!n&&r.charAt(0)==='"'&&r.charAt(r.length-1)==='"')return;if(new RegExp(uy).test(r))return new X7(this._injector,r,new gy(r));if(n&&new RegExp(RDe).test(r))return new X7(this._injector,r,new LIe(r));if(n&&new RegExp(DDe).test(r))return new X7(this._injector,r,new NIe(r));const i=this._formulaRuntimeService.currentUnitId,o=this._superTableService.getTableMap(i),s=new RegExp(xP,"g"),a=r.replace(s,"");if(!n&&o!=null&&o.has(a)){const l=s.exec(r);let u="";l&&(u=l[0]);const c=o.get(a),d=this._superTableService.getTableOptionMap();return new X7(this._injector,r,new PIe(r,c,u,d))}}};v5=UIe([ld(0,cf),ld(1,py),ld(2,Fa),ld(3,ne(Zu)),ld(4,ne(Tn))],v5);var HIe=Object.defineProperty,VIe=Object.getOwnPropertyDescriptor,jIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?VIe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&HIe(e,n,i),i},RD=(t,e)=>(n,r)=>e(n,r,t);let DD=class extends Xo{constructor(e,n,r){super(n),this._accessor=e,this._operatorString=n,this._functionExecutor=r}get nodeType(){return _n.SUFFIX}execute(){let e=this.getChildren()[0].getValue(),n;if(e==null)throw new Error("object is null");this._operatorString===Ol.PERCENTAGE?(e.isReferenceObject()&&(e=e.toArrayValueObject()),n=this._functionExecutor.calculate(e,new tt(100))):this._operatorString===Ol.POUND?n=this._handlerPound(e):n=me.create(ce.VALUE),this.setValue(n)}_handlerPound(e){var n,r,i,o;if(!e.isReferenceObject()||!e.isCell())return me.create(ce.VALUE);const s=this._accessor.get(w0),a=this._accessor.get(Zu),l=e,u=l.getRangeData(),c=l.getUnitId(),d=l.getSheetId(),h=s.getFormulaData(),f=(o=(i=(r=(n=h==null?void 0:h[c])==null?void 0:n[d])==null?void 0:r[u.startRow])==null?void 0:i[u.startColumn])==null?void 0:o.f;return f&&a.treeBuilder(f),me.create(ce.VALUE)}},_5=class extends Va{constructor(e,n){super(),this._functionService=e,this._injector=n}get zIndex(){return Ua.get(_n.SUFFIX)||Ha}checkAndCreateNodeType(e){if(!(e instanceof bn))return;const n=e.getToken().trim();if(n.charAt(0)==='"'&&n.charAt(n.length-1)==='"')return;let r="";if(n===Ol.PERCENTAGE)r=Xi.DIVIDED;else return n===Ol.POUND?new DD(this._injector,n):void 0;const i=this._functionService.getExecutor(r);return i?new DD(this._injector,n,i):(console.error(`No function ${e}`),di.create(ce.NAME))}};_5=jIe([RD(0,x1),RD(1,ne(Tn))],_5);var zIe=Object.defineProperty,WIe=Object.getOwnPropertyDescriptor,XIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?WIe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&zIe(e,n,i),i},YIe=(t,e)=>(n,r)=>e(n,r,t);let GIe=class extends Xo{constructor(e){super(e),this._operatorString=e}get nodeType(){return _n.UNION}execute(){const e=this.getChildren(),n=e[0].getValue(),r=e[1].getValue();if(n==null||r==null)throw new Error("leftNode and rightNode");let i;this._operatorString===cn.COLON?i=this._unionFunction(n,r):i=me.create(ce.NAME),this.setValue(i)}_unionFunction(e,n){return e.isError()||n.isError()||!e.isReferenceObject()||!n.isReferenceObject()?me.create(ce.REF):(e=e,n=n,e.isCell()&&n.isCell()||e.isRow()&&n.isRow()||e.isColumn()&&n.isColumn()?e.unionBy(n):me.create(ce.REF))}},b5=class extends Va{constructor(e){super(),this._functionService=e}get zIndex(){return Ua.get(_n.UNION)||Ha}create(e){return new GIe(e)}checkAndCreateNodeType(e){if(!(e instanceof bn))return;const n=e.getToken().trim();if(!(n.charAt(0)==='"'&&n.charAt(n.length-1)==='"')&&n===cn.COLON)return this.create(n)}};b5=XIe([YIe(0,x1)],b5);let KIe=class extends Xo{constructor(e){super(e),this._operatorString=e}get nodeType(){return _n.VALUE}execute(){this.setValue(W6.create(this._operatorString))}},XP=class extends Va{get zIndex(){return Ua.get(_n.VALUE)||Ha}_checkValueNode(e){if(isNaN(Number(e))){const n=e.trim(),r=n.charAt(0),i=n.charAt(n.length-1);if(r==='"'&&i==='"')return this.create(n);if(r==="{"&&i==="}")return this.create(n);if(n===Gu.TRUE||n===Gu.FALSE)return this.create(n)}else return this.create(e)}create(e){return new KIe(e)}checkAndCreateNodeType(e){if(!(e instanceof bn))return this._checkValueNode(e)}};var ZIe=Object.defineProperty,qIe=Object.getOwnPropertyDescriptor,QIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?qIe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&ZIe(e,n,i),i},Cs=(t,e)=>(n,r)=>e(n,r,t);let X6=class extends je{constructor(e,n,r,i,o,s,a,l,u,c,d){super(),Fe(this,"_astNodeFactoryList",[]),Fe(this,"_refOffsetX",0),Fe(this,"_refOffsetY",0),this._runtimeService=e,this._astRootNodeFactory=n,this._functionNodeFactory=r,this._lambdaNodeFactory=i,this._lambdaParameterNodeFactory=o,this._operatorNodeFactory=s,this._prefixNodeFactory=a,this._referenceNodeFactory=l,this._suffixNodeFactory=u,this._unionNodeFactory=c,this._valueNodeFactory=d,this._initializeAstNode()}dispose(){this._astNodeFactoryList.forEach(e=>{e.dispose()}),this._astNodeFactoryList=[]}parse(e,n=0,r=0){const i=new h_(El);return this._refOffsetX=n,this._refOffsetY=r,this._parse(e,i)}_lambdaParameterHandler(e,n){const r=n.getLambdaId(),i=new h_(El),o=this._runtimeService.getFunctionDefinitionPrivacyVar(r);if(!o)return!1;const s=[...o.keys()],a=e.getChildren(),l=a.length;for(let d=0;d<l;d++){const h=a[d];if(h instanceof bn)this._parse(h,i);else return!1}const u=i.getChildren(),c=u.length;for(let d=0;d<c;d++){const h=u[d];o.set(s[d],h)}return i.setParent(n),n}_changeLetToLambda(e){const n=e.getChildren(),r=n.length;if(r%2!==1||r===0)return;const i=new bn;i.setToken(z6);const o=new bn;o.setToken(e0);const s=[...n];for(let l=0;l<r;l++){const u=s[l];if(!(u instanceof bn))return;l%2===0?u.changeToParent(i):u.changeToParent(o)}i.addChildrenFirst(o),o.setParent(i);const a=e.getParent();return a==null||a.replaceChild(e,i),i}_getTopParent(e){let n=e;for(;n!=null&&n.getParent();)n=n.getParent();return n}_parse(e,n){const r=e.getChildren(),i=r.length,o=[];let s=null;const a=e.getToken().trim().toUpperCase();if(a===MDe){const c=this._changeLetToLambda(e);return c!=null?this._parse(c,n):di.create(ce.ERROR)}if(a===vu){if(s=n,i===0)return new xIe(El).setParent(n),s}else{if(a===e0){let c=this._lambdaParameterHandler(e,n);return c===!1&&(c=di.create(ce.ERROR)),c}if(s=this._checkAstNode(e),s==null)return di.create(ce.ERROR)}const l=r[0];for(let c=0;c<i;c++){const d=r[c];if(zP(l)){if(c!==0&&c!==i-1)continue}else if(SIe(d)&&c!==i-1)continue;let h=null;if(d instanceof bn){if(h=this._parse(d,s),h===s)continue}else h=this._checkAstNode(d);if(h==null)return di.create(ce.ERROR);if(h=this._getTopParent(h),h==null)return;switch(h.nodeType){case _n.ERROR:return h;case _n.FUNCTION:o.push(h);break;case _n.LAMBDA:o.push(h);break;case _n.LAMBDA_PARAMETER:o.push(h);break;case _n.OPERATOR:{const f=o.pop(),m=o.pop();if(m)m.setParent(h);else return di.create(ce.ERROR);if(f)f.setParent(h);else return di.create(ce.ERROR);o.push(h);break}case _n.REFERENCE:h.setRefOffset(this._refOffsetX,this._refOffsetY),o.push(h);break;case _n.ROOT:o.push(h);break;case _n.UNION:o.push(h);break;case _n.VALUE:o.push(h);break;case _n.PREFIX:o.push(h);break;case _n.SUFFIX:o.push(h);break}}const u=o.length;for(let c=0;c<u;c++)o[c].setParent(s);return s}_checkAstNode(e){let n=null;const r=this._astNodeFactoryList.length;for(let i=0;i<r&&(n=this._astNodeFactoryList[i].checkAndCreateNodeType(e),n==null);i++);return n}_initializeAstNode(){this._astNodeFactoryList=[this._astRootNodeFactory,this._functionNodeFactory,this._lambdaNodeFactory,this._lambdaParameterNodeFactory,this._operatorNodeFactory,this._prefixNodeFactory,this._referenceNodeFactory,this._suffixNodeFactory,this._unionNodeFactory,this._valueNodeFactory].sort(Ns)}};X6=QIe([Cs(0,Fa),Cs(1,ne(jP)),Cs(2,ne(m5)),Cs(3,ne(p5)),Cs(4,ne(WP)),Cs(5,ne(g5)),Cs(6,ne(f5)),Cs(7,ne(v5)),Cs(8,ne(_5)),Cs(9,ne(b5)),Cs(10,ne(XP))],X6);let JIe=class extends je{constructor(){super(...arguments),Fe(this,"_referenceExecutorMap",new Map)}dispose(){this._referenceExecutorMap.clear()}remove(e){this._referenceExecutorMap.delete(e)}get(e){return this._referenceExecutorMap.get(e)}has(e){return this._referenceExecutorMap.has(e)}register(e,n){this._referenceExecutorMap.set(e,n)}getReferenceExecutorMap(){return this._referenceExecutorMap}};const df=nn("univer.formula.feature-calculation-manager.service");let exe=class extends je{constructor(){super(...arguments),Fe(this,"_otherFormulaData",{})}dispose(){this._otherFormulaData={}}remove(e){var n,r,i;const{unitId:o,subComponentId:s,formulaId:a}=e;(i=(r=(n=this._otherFormulaData)==null?void 0:n[o])==null?void 0:r[s])==null||delete i[a]}get(e){var n,r;const{unitId:i,subComponentId:o,formulaId:s}=e;return(r=(n=this._otherFormulaData[i])==null?void 0:n[o])==null?void 0:r[s]}has(e){var n,r;const{unitId:i,subComponentId:o,formulaId:s}=e;return((r=(n=this._otherFormulaData[i])==null?void 0:n[o])==null?void 0:r[s])!=null}register(e){const{unitId:n,subComponentId:r,formulaId:i,item:o}=e;this._otherFormulaData[n]&&(this._otherFormulaData[n]={}),this._otherFormulaData[n][r]&&(this._otherFormulaData[n][r]={}),this._otherFormulaData[n][r][i]=o}getOtherFormulaData(){return this._otherFormulaData}};const vy=nn("univer.formula.other-formula-manager.service");let op=class extends je{constructor(){super(...arguments),Fe(this,"node"),Fe(this,"children",[]),Fe(this,"parents",[]),Fe(this,"formula",""),Fe(this,"row",-1),Fe(this,"column",-1),Fe(this,"subComponentId",""),Fe(this,"unitId",""),Fe(this,"rangeList",[]),Fe(this,"formulaId"),Fe(this,"featureId"),Fe(this,"getDirtyData"),Fe(this,"_state",0)}dispose(){var e;this.children.forEach(n=>{n.dispose()}),this.rangeList=[],this.parents=[],(e=this.node)==null||e.dispose()}setAdded(){this._state=1}isAdded(){return this._state===1}setSkip(){this._state=2}isSkip(){return this._state===2}inRangeData(e){const n=e.startRow,r=e.startColumn,i=e.endRow,o=e.endColumn;return!(this.row<n||this.row>i||this.column<r||this.column>o)}dependencyRange(e,n,r){var i,o;if(this.rangeList.length===0)return!1;for(let s=0,a=this.rangeList.length;s<a;s++){const l=this.rangeList[s],{unitId:u,sheetId:c,range:d}=l;if(!e.has(u))continue;const h=e.get(u);if(!h.has(c))continue;const f=h.get(c),m=(i=r==null?void 0:r[u])==null?void 0:i[c];for(const p of f){const{startRow:g,startColumn:v,endRow:_,endColumn:C}=p;if(!(d.startRow>_||d.endRow<g||d.startColumn>C||d.endColumn<v)){let y=!0;if(m==null||m.forValue((S,E)=>{if(S>=d.startRow&&S<=d.endRow&&E>=d.startColumn&&E<=d.endColumn)return y=!1,!1}),y)return!0}}if(((o=n[u])==null?void 0:o[c])!=null)return!0}return!1}pushChildren(e){this.children.push(e),e._pushParent(this)}pushRangeList(e){this.rangeList.push(e)}dependency(e){if(this.rangeList.length===0)return!1;for(let n=0,r=this.rangeList.length;n<r;n++){const i=this.rangeList[n],o=i.unitId,s=i.sheetId,a=i.range;if(e.unitId===o&&e.subComponentId===s&&e.inRangeData(a))return!0}return!1}_pushParent(e){this.parents.push(e)}};var txe=Object.defineProperty,nxe=Object.getOwnPropertyDescriptor,rxe=(t,e,n,r)=>{for(var i=r>1?void 0:r?nxe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&txe(e,n,i),i},eu=(t,e)=>(n,r)=>e(n,r,t);const ixe=1e5,sp=new rf(ixe);let t6=class extends je{constructor(e,n,r,i,o,s,a){super(),Fe(this,"_updateRangeFlattenCache",new Map),Fe(this,"_dirtyUnitSheetNameMap",{}),this._currentConfigService=e,this._runtimeService=n,this._otherFormulaManagerService=r,this._featureCalculationManagerService=i,this._interpreter=o,this._astTreeBuilder=s,this._lexer=a}dispose(){this._updateRangeFlattenCache.clear(),sp.clear(),this._dirtyUnitSheetNameMap={}}async generate(){this._updateRangeFlatten();const e=this._currentConfigService.getFormulaData(),n=this._otherFormulaManagerService.getOtherFormulaData(),r=await this._generateTreeList(e,n),i=this._getUpdateTreeListAndMakeDependency(r);this._checkIsCycleDependency(i)&&this._runtimeService.enableCycleDependency();const o=this._calculateRunList(i);return Promise.resolve(o)}_isCyclicUtil(e,n,r){if(!n.has(e)){n.add(e),r.add(e);for(let i=0;i<e.children.length;i++)if(!n.has(e.children[i])&&this._isCyclicUtil(e.children[i],n,r)||r.has(e.children[i]))return!0}return r.delete(e),!1}_checkIsCycleDependency(e){const n=new Set,r=new Set;for(let i=0,o=e.length;i<o;i++){const s=e[i];if(this._isCyclicUtil(s,n,r)===!0)return!0}return!1}async _generateTreeList(e,n){const r=Object.keys(e),i=Object.keys(n),o=[];for(const s of r){const a=e[s],l=Object.keys(a);for(const u of l)new nt(a[u]).forValue((c,d,h)=>{if(h==null)return!0;const{f,x:m,y:p}=h,g=this._generateAstNode(f,m,p),v=new op;v.node=g,v.formula=f,v.unitId=s,v.subComponentId=u,v.row=c,v.column=d,o.push(v)})}for(const s of i){const a=n[s],l=Object.keys(a);for(const u of l){const c=a[u],d=Object.keys(c);for(const h of d){const f=c[h],{f:m}=f,p=this._generateAstNode(m),g=new op;g.node=p,g.formula=m,g.unitId=s,g.subComponentId=u,g.formulaId=h,o.push(g)}}}this._featureCalculationManagerService.getReferenceExecutorMap().forEach((s,a)=>{const{unitId:l,subComponentId:u,dependencyRanges:c,getDirtyData:d}=s,h=new op;h.unitId=l,h.subComponentId=u,h.getDirtyData=d,h.featureId=a,h.rangeList=c,o.push(h)});for(let s=0,a=o.length;s<a;s++){const l=o[s];if(this._runtimeService.setCurrent(l.row,l.column,l.subComponentId,l.unitId),l.node==null)continue;const u=await this._getRangeListByNode(l.node);for(let c=0,d=u.length;c<d;c++)l.pushRangeList(u[c])}return o}_updateRangeFlatten(){const e=this._currentConfigService.isForceCalculate(),n=this._currentConfigService.getDirtyRanges();if(!e){this._updateRangeFlattenCache.clear();for(let r=0;r<n.length;r++){const i=n[r],o=i.range,s=i.sheetId,a=i.unitId;this._addFlattenCache(a,s,o)}this._dirtyUnitSheetNameMap=this._currentConfigService.getDirtyNameMap()}}_generateAstNode(e,n=0,r=0){let i=sp.get(`${e}##${n}${r}`);if(i)return i;const o=this._lexer.treeBuilder(e);if(o in ce)return di.create(o);if(i=this._astTreeBuilder.parse(o,n,r),i==null)throw new Error("astNode is null");return sp.set(`${e}##${n}${r}`,i),i}_addFlattenCache(e,n,r){let i=this._updateRangeFlattenCache.get(e);i==null&&(i=new Map,this._updateRangeFlattenCache.set(e,i));let o=i.get(n);o==null&&(o=[],i.set(n,o)),o.push(r)}_isPreCalculateNode(e){return e.nodeType===_n.UNION||e.nodeType===_n.PREFIX&&e.getToken()===ri.AT||e.nodeType===_n.SUFFIX&&e.getToken()===Ol.POUND}_nodeTraversalRef(e,n){const r=e.getChildren(),i=r.length;for(let o=0;o<i;o++){const s=r[o];if(this._isPreCalculateNode(s)){n.push(s);continue}else s.nodeType===_n.REFERENCE&&n.push(s);this._nodeTraversalRef(s,n)}}_nodeTraversalReferenceFunction(e,n){const r=e.getChildren(),i=r.length;for(let o=0;o<i;o++){const s=r[o];if(s.nodeType===_n.FUNCTION&&s.isAddress()){n.push(s);continue}this._nodeTraversalReferenceFunction(s,n)}}async _executeNode(e){let n;return this._interpreter.checkAsyncNode(e)?n=await this._interpreter.executeAsync(e):n=this._interpreter.execute(e),n}async _getRangeListByNode(e){const n=[],r=[];this._nodeTraversalRef(e,n),this._nodeTraversalReferenceFunction(e,r);const i=[];for(let o=0,s=n.length;o<s;o++){const a=n[o],l=(await this._executeNode(a)).toUnitRange();i.push(l)}for(let o=0,s=r.length;o<s;o++){const a=r[o],l=(await this._executeNode(a)).toUnitRange();i.push(l)}return i}_getUpdateTreeListAndMakeDependency(e){const n=[],r=new Set,i=this._currentConfigService.isForceCalculate();for(let o=0,s=e.length;o<s;o++){const a=e[o];for(let l=0,u=e.length;l<u;l++){const c=e[l];a!==c&&a.dependency(c)&&a.pushChildren(c)}(i||a.dependencyRange(this._updateRangeFlattenCache,this._dirtyUnitSheetNameMap,this._currentConfigService.getExcludedRange())||this._includeTree(a))&&!r.has(a)&&(n.push(a),r.add(a))}return n}_includeTree(e){var n,r,i,o;const s=e.unitId,a=e.subComponentId,l=e.featureId;if(l!=null){const f=this._currentConfigService.getDirtyUnitFeatureMap();if(((r=(n=f==null?void 0:f[s])==null?void 0:n[a])==null?void 0:r[l])!=null)return!0}const u=(o=(i=this._currentConfigService.getExcludedRange())==null?void 0:i[s])==null?void 0:o[a];let c=!1;if(u==null||u.forValue((f,m)=>{if(e.row===f&&e.column===m)return c=!0,!1}),c||!this._updateRangeFlattenCache.has(s))return!1;const d=this._updateRangeFlattenCache.get(s);if(!d.has(a))return!1;const h=d.get(a);for(const f of h)if(e.inRangeData(f))return!0;return!1}_calculateRunList(e){let n=e;const r=[];for(;n.length>0;){const i=n.pop();if(i===void 0||i.isSkip())continue;if(i.isAdded()){r.push(i);continue}const o=[];for(let s=0,a=i.parents.length;s<a;s++){const l=i.parents[s];o.push(l)}o.length===0?(r.push(i),i.setSkip()):(i.setAdded(),n.push(i),n=n.concat(o))}return r.reverse()}};t6=rxe([yt(it.Rendered,t6),eu(0,w0),eu(1,Fa),eu(2,vy),eu(3,df),eu(4,ne(n0)),eu(5,ne(X6)),eu(6,ne(Zu))],t6);var oxe=Object.defineProperty,sxe=Object.getOwnPropertyDescriptor,axe=(t,e,n,r)=>{for(var i=r>1?void 0:r?sxe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&oxe(e,n,i),i},tu=(t,e)=>(n,r)=>e(n,r,t);const lxe=1;let n6=class extends je{constructor(e,n,r,i,o,s,a){super(),Fe(this,"_executionStartListener$",new Qt),Fe(this,"executionStartListener$",this._executionStartListener$.asObservable()),Fe(this,"_executionCompleteListener$",new Qt),Fe(this,"executionCompleteListener$",this._executionCompleteListener$.asObservable()),Fe(this,"_executionInProgressListener$",new Qt),Fe(this,"executionInProgressListener$",this._executionInProgressListener$.asObservable()),this._configService=e,this._lexer=n,this._currentConfigService=r,this._runtimeService=i,this._formulaDependencyGenerator=o,this._interpreter=s,this._astTreeBuilder=a}dispose(){}stopFormulaExecution(){this._runtimeService.stopExecution()}setRuntimeFeatureCellData(e,n){this._runtimeService.setRuntimeFeatureCellData(e,n)}setRuntimeFeatureRange(e,n){this._runtimeService.setRuntimeFeatureRange(e,n)}async execute(e){this._executionStartListener$.next(!0),this._currentConfigService.load(e),this._runtimeService.reset();const n=this._configService.getConfig("CYCLE_REFERENCE_COUNT")||lxe;for(let r=0;r<n&&(await this._execute(),!!this._runtimeService.isCycleDependency());r++);this._runtimeService.setFormulaExecuteStage(Qa.CALCULATION_COMPLETED),this._executionInProgressListener$.next(this._runtimeService.getRuntimeState()),this._executionCompleteListener$.next(this._runtimeService.getAllRuntimeData()),l_.clear(),bu.clear()}async _execute(){const e=await this._apply();if(e==null)return;const{arrayFormulaRange:n,runtimeFeatureRange:r}=e,{dirtyRanges:i,excludedCell:o}=this._getArrayFormulaDirtyRangeAndExcludedRange(n,r);return i==null||i.length===0||(this._currentConfigService.loadDirtyRangesAndExcludedCell(i,o),await this._apply(!0)),!0}_getArrayFormulaDirtyRangeAndExcludedRange(e,n){const r=[],i={};return Object.keys(e).forEach(o=>{const s=e[o];Object.keys(s).forEach(a=>{const l=new nt(s[a]);if(l==null)return!0;const u=new nt;l.forValue((c,d,h)=>{u.setValue(c,d,!0),r.push({unitId:o,sheetId:a,range:h})}),i[o]==null&&(i[o]={}),i[o][a]=u})}),Object.keys(n).forEach(o=>{const s=n[o];Object.keys(s).forEach(a=>{const l=s[a];Object.keys(l).forEach(u=>{const c=l[u];if(c==null)return!0;for(const d of c)r.push({unitId:a,sheetId:u,range:d})})})}),{dirtyRanges:r,excludedCell:i}}async _apply(e=!1){e?this._runtimeService.setFormulaExecuteStage(Qa.START_DEPENDENCY_ARRAY_FORMULA):this._runtimeService.setFormulaExecuteStage(Qa.START_DEPENDENCY),this._executionInProgressListener$.next(this._runtimeService.getRuntimeState());const n=await this._formulaDependencyGenerator.generate(),r=this._interpreter;e?(this._runtimeService.setFormulaExecuteStage(Qa.START_CALCULATION_ARRAY_FORMULA),this._runtimeService.setTotalArrayFormulasToCalculate(n.length)):(this._runtimeService.setFormulaExecuteStage(Qa.START_CALCULATION),this._runtimeService.setTotalFormulasToCalculate(n.length)),this._executionInProgressListener$.next(this._runtimeService.getRuntimeState());for(let i=0,o=n.length;i<o;i++){if(await new Promise(c=>{rM(c)}),this._runtimeService.isStopExecution()){this._runtimeService.setFormulaExecuteStage(Qa.IDLE),this._runtimeService.markedAsStopFunctionsExecuted(),this._executionCompleteListener$.next(this._runtimeService.getAllRuntimeData());return}const s=n[i],a=s.node,l=s.getDirtyData;let u;if(a==null&&l==null)throw new Error("AstNode or executor is null");if(this._runtimeService.setCurrent(s.row,s.column,s.subComponentId,s.unitId),l!=null&&s.featureId!=null){const{runtimeCellData:c,dirtyRanges:d}=l(s);this._runtimeService.setRuntimeFeatureCellData(s.featureId,c),this._runtimeService.setRuntimeFeatureRange(s.featureId,d)}else a!=null&&(r.checkAsyncNode(a)?u=await r.executeAsync(a):u=r.execute(a),s.formulaId!=null?this._runtimeService.setRuntimeOtherData(s.formulaId,u):this._runtimeService.setRuntimeData(u));e?(this._runtimeService.setFormulaExecuteStage(Qa.CURRENTLY_CALCULATING_ARRAY_FORMULA),this._runtimeService.setCompletedArrayFormulasCount(i+1)):(this._runtimeService.setFormulaExecuteStage(Qa.CURRENTLY_CALCULATING),this._runtimeService.setCompletedFormulasCount(i+1)),this._executionInProgressListener$.next(this._runtimeService.getRuntimeState())}return n.length>0?this._runtimeService.markedAsSuccessfullyExecuted():e||this._runtimeService.markedAsNoFunctionsExecuted(),this._runtimeService.getAllRuntimeData()}calculate(e,n=!0){const r=this._lexer.treeBuilder(e,n);if(Object.values(ce).includes(r))return di.create(r);const i=this._astTreeBuilder.parse(r);console.log("astNode",i==null?void 0:i.serialize())}};n6=axe([yt(it.Rendered,n6),tu(0,d0),tu(1,ne(Zu)),tu(2,w0),tu(3,Fa),tu(4,ne(t6)),tu(5,ne(n0)),tu(6,ne(X6))],n6);var uxe=Object.defineProperty,cxe=Object.getOwnPropertyDescriptor,dxe=(t,e,n,r)=>{for(var i=r>1?void 0:r?cxe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&uxe(e,n,i),i},Y7=(t,e)=>(n,r)=>e(n,r,t);let K3=class extends je{constructor(e,n,r,i){super(),this._commandService=e,this._calculateFormulaService=n,this._currentUniverService=r,this._formulaDataModel=i,this._initialize()}_initialize(){this._commandExecutedListener(),this._initialExecuteFormulaListener(),this._initialExecuteFormulaProcessListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted((e,n)=>{if(e.id===AP.id)this._calculateFormulaService.stopFormulaExecution();else if(e.id===y2.id){const r=e.params.formulaData;this._formulaDataModel.setFormulaData(r)}else if(e.id===c5.id){const r=e.params;if(r.forceCalculation===!0)this._calculate(!0);else{const{dirtyRanges:i,dirtyNameMap:o,dirtyUnitFeatureMap:s}=r;this._calculate(!1,i,o,s)}}else if(e.id===t0.id){const r=e.params;if(r==null)return;const{arrayFormulaRange:i,arrayFormulaCellData:o}=r;this._formulaDataModel.setArrayFormulaRange(i),this._formulaDataModel.setArrayFormulaCellData(o)}}))}async _calculate(e=!1,n=[],r={},i={}){if(n.length===0&&Object.keys(r).length===0&&Object.keys(i).length===0&&e===!1)return;const o=this._formulaDataModel.getFormulaData(),s=this._formulaDataModel.getArrayFormulaCellData();this._calculateFormulaService.execute({formulaData:o,arrayFormulaCellData:s,forceCalculate:e,dirtyRanges:n,dirtyNameMap:r,dirtyUnitFeatureMap:i})}_initialExecuteFormulaListener(){this._calculateFormulaService.executionCompleteListener$.subscribe(e=>{const n=e.functionsExecutedState;switch(n){case s1.NOT_EXECUTED:break;case s1.STOP_EXECUTION:break;case s1.SUCCESS:this._applyFormula(e);break;case s1.INITIAL:break}this._commandService.executeCommand(d5.id,{functionsExecutedState:n},{onlyLocal:!0})})}_initialExecuteFormulaProcessListener(){this._calculateFormulaService.executionInProgressListener$.subscribe(e=>{const{totalFormulasToCalculate:n,completedFormulasCount:r,totalArrayFormulasToCalculate:i,completedArrayFormulasCount:o,stage:s}=e;i>0?console.log(`Stage ${s} Array formula.There are ${i} functions to be executed, ${o} complete.`):console.log(`Stage ${s} .There are ${n} functions to be executed, ${r} complete.`),this._commandService.executeCommand(d5.id,{stageInfo:e},{onlyLocal:!0})})}async _applyFormula(e){const{unitData:n,unitOtherData:r,arrayFormulaRange:i,arrayFormulaCellData:o,clearArrayFormulaCellData:s}=e;if(!n){console.error("No sheetData from Formula Engine!");return}i&&(this._formulaDataModel.clearPreviousArrayFormulaCellData(s),this._formulaDataModel.mergeArrayFormulaCellData(o),this._formulaDataModel.mergeArrayFormulaRange(i),this._commandService.executeCommand(t0.id,{arrayFormulaRange:this._formulaDataModel.getArrayFormulaRange(),arrayFormulaCellData:this._formulaDataModel.getArrayFormulaCellData()},{onlyLocal:!0})),this._commandService.executeCommand(sf.id,{unitData:n,unitOtherData:r},{onlyLocal:!0})}};K3=dxe([yt(it.Ready,K3),Y7(0,le),Y7(1,ne(n6)),Y7(2,oe),Y7(3,ne(Vo))],K3);let hxe=class extends Fr{calculate(...e){if(e.length!==3)return new me(ce.VALUE);let n=e[0],r=e[1];if(!(e[2].isValueObject()&&e[2].isLambda()))return new me(ce.VALUE);if(n.isArray()&&(n=n.getFirstCell()),r.isArray()&&(r=r.getFirstCell()),!n.isNumber())return new me(ce.VALUE);if(!r.isNumber())return new me(ce.VALUE);const i=e[2],o=[];for(let s=0;s<n.getValue();s++){o[s]==null&&(o[s]=[]);for(let a=0;a<r.getValue();a++){const l=i.execute(new tt(s+1),new tt(a+1));o[s][a]=l}}return new qDe(o)}isAsync(){return!0}};const fxe=[[hxe,my.MAKEARRAY]];let mxe=class extends Fr{calculate(e,n){return me.create(ce.VALUE)}};const pxe=[[mxe,uf.CONCATENATE]],gxe=[],vxe=[],_xe=[],bxe=[],Cxe=[],yxe=[],Sxe=[];let Exe=class extends Fr{calculate(e,n){return new gy("A5")}},wxe=class extends Fr{calculate(e,n,r,i,o){return new gy("A5")}};const Rxe=[[Exe,u_.INDIRECT],[wxe,u_.OFFSET]];let Dxe=class extends Fr{calculate(e){return e.isError()?me.create(ce.VALUE):(e.isReferenceObject()&&(e=e.toArrayValueObject()),e.abs())}},Ixe=class extends Fr{calculate(e){return e.isError()?me.create(ce.VALUE):(e.isReferenceObject()&&(e=e.toArrayValueObject()),e.acos())}},xxe=class extends Fr{calculate(e){return e.isError()?me.create(ce.VALUE):(e.isReferenceObject()&&(e=e.toArrayValueObject()),e.acosh())}},Mxe=class extends Fr{calculate(e){return e.isError()?me.create(ce.VALUE):(e.isReferenceObject()&&(e=e.toArrayValueObject()),e.isArray()?e.map(n=>n.isError()?n:ID(n)):ID(e))}};function ID(t){let e=t.getValue();if(t.isBoolean()&&(e=e?1:0),!Number.isFinite(e))return me.create(ce.VALUE);const n=Math.atan(1/Number(e));return Number.isNaN(n)?me.create(ce.VALUE):new tt(n)}let Oxe=class extends Fr{calculate(e,n){return me.create(ce.VALUE)}},Txe=class extends Fr{calculate(...e){let n=new tt(0);for(let r=0;r<e.length;r++){let i=e[r];if(i.isError())return i;if(n.isError())return n;i.isArray()&&(i=i.sum()),n=n.plus(i)}return n}};function $xe(t){const e=[St.EQUALS,St.NOT_EQUAL,St.GREATER_THAN_OR_EQUAL,St.GREATER_THAN,St.LESS_THAN_OR_EQUAL,St.LESS_THAN];for(const n of e)if(t.startsWith(n)){const r=t.substring(n.length);return[n,W6.create(r)]}return[St.EQUALS,W6.create(t)]}function kxe(t,e){const n=t.toArrayValueObject(),r=`${e.getValue()}`,[i,o]=$xe(r);return PDe(r)?n.wildcard(o,i):n.compare(o,i)}let Axe=class extends Fr{calculate(...e){if(e.length<2||e.length>3)return me.create(ce.NA);const n=e[0],r=e[1],i=e[2];if(n.isError()||r.isError()||i&&i.isError())return me.create(ce.VALUE);let o=new tt(0);if(n.isReferenceObject()||n.isValueObject()&&n.isArray()){const s=kxe(n,r).getArrayValue(),a=i||n,{startRow:l,startColumn:u}=a.getRangePosition();a.iterator((c,d,h)=>{if(!(c!=null&&c.isError())){const f=s[d-l][h-u].getValue()?c:new tt(0);o=o.plus(f)}})}else r.isValueObject()&&(o=this._validator(n,r));return o}_validator(e,n){const r=n.getValue();if(r){const i=r.substring(0,1),o=r.substring(1);e.compare(new tt(o),i).getValue()||(e=new tt(0))}return e}},Nxe=class extends Fr{calculate(...e){return me.create(ce.VALUE)}};const Lxe=[[Dxe,ci.ABS],[Ixe,ci.ACOS],[xxe,ci.ACOSH],[Mxe,ci.ACOT],[Txe,ci.SUM],[Axe,ci.SUMIF],[Nxe,ci.SUMIFS],[Oxe,ci.POWER]];let Pxe=class extends Fr{constructor(){super(...arguments),Fe(this,"_compareType",St.EQUALS)}setCompareType(e){this._compareType=e}calculate(e,n){return e.isError()||n.isError()?me.create(ce.VALUE):(e.isReferenceObject()&&(e=e.toArrayValueObject()),n.isReferenceObject()&&(n=n.toArrayValueObject()),e.compare(n,this._compareType))}},Bxe=class extends Fr{calculate(e,n){return e.isError()||n.isError()?me.create(ce.VALUE):(e.isReferenceObject()&&(e=e.toArrayValueObject()),n.isReferenceObject()&&(n=n.toArrayValueObject()),!n.isArray()&&n.getValue()===0?me.create(ce.DIV_BY_ZERO):e.divided(n))}},Fxe=class extends Fr{calculate(e,n){return e.isError()||n.isError()?e:(e.isReferenceObject()&&(e=e.toArrayValueObject()),n.isReferenceObject()&&(n=n.toArrayValueObject()),e.minus(n))}},Uxe=class extends Fr{calculate(e,n){return e.isError()||n.isError()?me.create(ce.VALUE):(e.isReferenceObject()&&(e=e.toArrayValueObject()),n.isReferenceObject()&&(n=n.toArrayValueObject()),e.multiply(n))}},Hxe=class extends Fr{calculate(e,n){return e.isError()||n.isError()?me.create(ce.VALUE):(e.isReferenceObject()&&(e=e.toArrayValueObject()),n.isReferenceObject()&&(n=n.toArrayValueObject()),e.plus(n))}};const Vxe=[[Pxe,Xi.COMPARE],[Bxe,Xi.DIVIDED],[Fxe,Xi.MINUS],[Uxe,Xi.MULTIPLY],[Hxe,Xi.PLUS]];let jxe=class extends Fr{calculate(...e){let n=new tt(0),r=new tt(0);for(let i=0;i<e.length;i++){const o=e[i];if(o.isError())return o;if(n.isError())return n;o.isArray()?(n=n.plus(o.sum()),r=r.plus(o.count())):o.isNull()||(r=r.plus(new tt(1)))}return n.divided(r)}},zxe=class extends Fr{calculate(...e){let n=new tt(0);for(let r=0;r<e.length;r++){let i=e[r];i.isError()||(i.isArray()?(i=i.count(),n=n.plus(i)):!i.isNull()&&!i.isString()&&(n=n.plus(new tt(1))))}return n}},Wxe=class extends Fr{calculate(...e){let n=new tt(0);for(let r=0;r<e.length;r++){let i=e[r];if(i.isError()){n=n.plus(new tt(1));continue}i.isArray()?(i=i.countA(),n=n.plus(i)):i.isNull()||(n=n.plus(new tt(1)))}return n}},Xxe=class extends Fr{calculate(...e){let n=new tt(-1/0);for(let r=0;r<e.length;r++){let i=e[r];if(i.isError())return i;i.isArray()&&(i=i.max()),!i.isNull()&&(n=this._validator(n,i))}return n}_validator(e,n){return e.isLessThan(n).getValue()&&(e=n),e}},xD=class extends Fr{calculate(...e){let n=new tt(1/0);for(let r=0;r<e.length;r++){let i=e[r];if(i.isError())return i;i.isArray()&&(i=i.min()),!i.isNull()&&(n=this._validator(n,i))}return n}_validator(e,n){return e.isGreaterThan(n).getValue()&&(e=n),e}};const Yxe=[[jxe,Vn.AVERAGE],[zxe,Vn.COUNT],[Xxe,Vn.MAX],[xD,Vn.MIN],[xD,Vn.MIN],[Wxe,Vn.COUNTA]],Gxe=[],Kxe=[],Zxe=[];var qxe=Object.defineProperty,Qxe=Object.getOwnPropertyDescriptor,Jxe=(t,e,n,r)=>{for(var i=r>1?void 0:r?Qxe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&qxe(e,n,i),i},ap=(t,e)=>(n,r)=>e(n,r,t);let Z3=class extends je{constructor(e,n,r){super(),this._commandService=e,this._injector=n,this._functionService=r,this._initialize()}_initialize(){this._registerCommands(),this._registerFunctions()}_registerCommands(){[y2,t0,c5,AP,d5,sf,dy,hy,$P,kP,NP,LP,kDe,ADe,PP].forEach(e=>this.disposeWithMe(this._commandService.registerCommand(e)))}_registerFunctions(){const e=[...fxe,...pxe,...gxe,...vxe,..._xe,...bxe,...Cxe,...yxe,...Sxe,...Rxe,...Lxe,...Vxe,...Yxe,...Gxe,...Kxe,...Zxe].map(n=>{const r=n[0],i=n[1];return new r(i)});this._functionService.registerExecutors(...e)}};Z3=Jxe([yt(it.Ready,Z3),ap(0,le),ap(1,ne(Tn)),ap(2,x1)],Z3);var eMe=Object.defineProperty,tMe=Object.getOwnPropertyDescriptor,nMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?tMe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&eMe(e,n,i),i},MD=(t,e)=>(n,r)=>e(n,r,t);let q3=class extends je{constructor(e,n){super(),this._commandService=e,this._definedNamesService=n,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===dy.id){const n=e.params;if(n==null)return;const{unitId:r,name:i,formulaOrRefString:o}=n;this._definedNamesService.registerDefinedName(r,i,o)}else if(e.id===hy.id){const n=e.params;if(n==null)return;const{unitId:r,name:i}=n;this._definedNamesService.removeDefinedName(r,i)}}))}};q3=nMe([yt(it.Ready,q3),MD(0,le),MD(1,cf)],q3);var rMe=Object.defineProperty,iMe=Object.getOwnPropertyDescriptor,oMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?iMe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&rMe(e,n,i),i},OD=(t,e)=>(n,r)=>e(n,r,t);let Q3=class extends je{constructor(e,n){super(),this._commandService=e,this._featureCalculationManagerService=n,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===$P.id){const n=e.params;if(n==null)return;const{featureId:r,calculationParam:i}=n;this._featureCalculationManagerService.register(r,i)}else if(e.id===kP.id){const n=e.params;if(n==null)return;const{featureId:r}=n;this._featureCalculationManagerService.remove(r)}}))}};Q3=oMe([yt(it.Ready,Q3),OD(0,le),OD(1,df)],Q3);var sMe=Object.defineProperty,aMe=Object.getOwnPropertyDescriptor,lMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?aMe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&sMe(e,n,i),i},TD=(t,e)=>(n,r)=>e(n,r,t);let J3=class extends je{constructor(e,n){super(),this._commandService=e,this._otherFormulaManagerService=n,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===NP.id){const n=e.params;if(n==null)return;this._otherFormulaManagerService.register(n)}else if(e.id===LP.id){const n=e.params;if(n==null)return;this._otherFormulaManagerService.remove(n)}}))}};J3=lMe([yt(it.Ready,J3),TD(0,le),TD(1,vy)],J3);var uMe=Object.defineProperty,cMe=Object.getOwnPropertyDescriptor,dMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?cMe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&uMe(e,n,i),i},$D=(t,e)=>(n,r)=>e(n,r,t);let e8=class extends je{constructor(e,n){super(),this._commandService=e,this._superTableService=n,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===dy.id){const n=e.params;if(n==null)return;const{unitId:r,tableName:i,reference:o}=n;this._superTableService.registerTable(r,i,o)}else if(e.id===hy.id){const n=e.params;if(n==null)return;const{unitId:r,tableName:i}=n;this._superTableService.remove(r,i)}else if(e.id===PP.id){const n=e.params;if(n==null)return;const{tableOption:r,tableOptionType:i}=n;this._superTableService.registerTableOptionMap(r,i)}}))}};e8=dMe([yt(it.Ready,e8),$D(0,le),$D(1,py)],e8);var hMe=Object.defineProperty,fMe=Object.getOwnPropertyDescriptor,mMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?fMe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&hMe(e,n,i),i},pMe=(t,e)=>(n,r)=>e(n,r,t);const gMe="base-formula-engine";let f_=class extends S1{constructor(e,n){super(gMe),this._config=e,this._injector=n}onStarting(){this._initialize()}_initialize(){var e;const n=[[x1,{useClass:cIe}],[df,{useClass:JIe}],[cf,{useClass:QDe}],[Vo],[Ba],[Z3],[Q3]];(e=this._config)!=null&&e.notExecuteFormula||n.push([n6],[vy,{useClass:exe}],[py,{useClass:AIe}],[w0,{useClass:c_}],[Fa,{useClass:d_}],[K3],[q3],[J3],[e8],[t6],[n0],[X6],[Zu],[jP],[m5],[p5],[WP],[g5],[f5],[v5],[_5],[b5],[XP]),n.forEach(r=>this._injector.add(r))}onReady(){this._injector.get(Vo).initFormulaData()}};f_=mMe([pMe(1,ne(Tn))],f_);var vMe=Object.defineProperty,_Me=(t,e,n)=>e in t?vMe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Jn=(t,e,n)=>(_Me(t,typeof e!="symbol"?e+"":e,n),n),bMe=Object.defineProperty,CMe=Object.getOwnPropertyDescriptor,yMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?CMe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&bMe(e,n,i),i},SMe=(t,e)=>(n,r)=>e(n,r,t);const On="normalSelectionPluginName";var t8=(t=>(t[t.MOVE_START=0]="MOVE_START",t[t.MOVING=1]="MOVING",t[t.MOVE_END=2]="MOVE_END",t))(t8||{});let ut=class{constructor(e){Jn(this,"_selectionInfo",new Map),Jn(this,"_currentSelection",null),Jn(this,"_selectionMoveStart$",new Qt),Jn(this,"selectionMoveStart$",this._selectionMoveStart$.asObservable()),Jn(this,"_selectionMoving$",new Qt),Jn(this,"selectionMoving$",this._selectionMoving$.asObservable()),Jn(this,"_selectionMoveEnd$",new rn(null)),Jn(this,"selectionMoveEnd$",this._selectionMoveEnd$.asObservable()),Jn(this,"_dirty",!0),this._themeService=e}getCurrent(){return this._currentSelection}getLastByPlugin(e){if(this._currentSelection!=null)return this._getLastByParam({...this._currentSelection,pluginName:e})}changePlugin(e){var n,r;this._currentSelection!=null&&(this._currentSelection={pluginName:e,unitId:(n=this._currentSelection)==null?void 0:n.unitId,sheetId:(r=this._currentSelection)==null?void 0:r.sheetId},this._refresh(this._currentSelection))}changePluginNoRefresh(e){var n,r;this._currentSelection!=null&&(this._currentSelection={pluginName:e,unitId:(n=this._currentSelection)==null?void 0:n.unitId,sheetId:(r=this._currentSelection)==null?void 0:r.sheetId})}reset(){var e,n;this._currentSelection!=null&&(this._currentSelection={pluginName:On,unitId:(e=this._currentSelection)==null?void 0:e.unitId,sheetId:(n=this._currentSelection)==null?void 0:n.sheetId},this._selectionInfo.clear(),this._refresh(this._currentSelection))}resetPlugin(){this._currentSelection!=null&&(this._currentSelection.pluginName=On,this._refresh(this._currentSelection))}dispose(){this._selectionMoveEnd$.complete(),this._selectionMoveStart$.complete(),this._selectionMoving$.complete()}makeDirty(e=!0){this._dirty=e}refreshSelection(){this._currentSelection!=null&&this._refresh(this._currentSelection)}setCurrentSelection(e){this._dirty!==!1&&(this._currentSelection=e,this._refresh(e))}setCurrentSelectionNotRefresh(e){this._currentSelection=e}getSelectionInfo(){return this._selectionInfo}getSelectionDatasByParam(e){return this._getSelectionDatas(e)}getSelections(){return this._getSelectionDatas(this._currentSelection)}getSelectionRanges(){const e=this.getSelections();if(e!=null)return e.map(n=>n.range)}getFirst(){return this._getFirstByParam(this._currentSelection)}getLast(){return this._getLastByParam(this._currentSelection)}addNoRefresh(e){this._currentSelection!=null&&this._addByParam({...this._currentSelection,selectionDatas:e},!1)}add(e){this._currentSelection!=null&&this._addByParam({...this._currentSelection,selectionDatas:e})}replace(e,n=2){this._currentSelection!=null&&(this._replaceByParam({...this._currentSelection,selectionDatas:e}),n===0?this._refreshStart(this._currentSelection):n===1?this._refreshMoving(this._currentSelection):this._refresh(this._currentSelection))}replaceWithNoRefresh(e){this._currentSelection!=null&&this._replaceByParam({...this._currentSelection,selectionDatas:e})}clear(){this._currentSelection!=null&&this._clearByParam(this._currentSelection)}remove(e){this._currentSelection!=null&&this._removeByParam(e,this._currentSelection)}createDefaultAutoFillSelection(){return{strokeWidth:2,stroke:"#FFF000",fill:"rgba(0, 0, 0, 0.2)",widgets:{},hasAutoFill:!0}}createCopyPasteSelection(){return{strokeWidth:1.5,stroke:this._themeService.getCurrentTheme().primaryColor,fill:"rgba(178, 178, 178, 0.10)",widgets:{},hasAutoFill:!1,strokeDash:8}}createDefaultSelection(){return{strokeWidth:2,stroke:"#FFF000",fill:"rgba(0, 0, 0, 0.2)",widgets:{tr:!0,tl:!0,br:!0,bl:!0},hasAutoFill:!1}}isOverlapping(){const e=this.getSelections();return e==null?!1:e.some(({range:n},r)=>e.some(({range:i},o)=>r===o?!1:n.startRow<=i.endRow&&n.endRow>=i.startRow&&n.startColumn<=i.endColumn&&n.endColumn>=i.startColumn))}_getSelectionDatas(e){var n,r;if(e==null)return;const{pluginName:i,unitId:o,sheetId:s}=e;return(r=(n=this._selectionInfo.get(i))==null?void 0:n.get(o))==null?void 0:r.get(s)}_refresh(e){this._selectionMoveEnd$.next(this._getSelectionDatas(e))}_refreshStart(e){this._selectionMoveStart$.next(this._getSelectionDatas(e))}_refreshMoving(e){this._selectionMoving$.next(this._getSelectionDatas(e))}_getFirstByParam(e){const n=this._getSelectionDatas(e);return n==null?void 0:n[0]}_getLastByParam(e){const n=this._getSelectionDatas(e);return n==null?void 0:n[n.length-1]}_addByParam(e,n=!0){const{pluginName:r,unitId:i,sheetId:o,selectionDatas:s}=e;this._selectionInfo.has(r)||this._selectionInfo.set(r,new Map);const a=this._selectionInfo.get(r);a.has(i)||a.set(i,new Map);const l=a.get(i);if(!l.has(o))l.set(o,[...s]);else{let u=l.get(o);u==null&&(u=[],l.set(o,u)),u.push(...s)}n&&this._refresh({pluginName:r,unitId:i,sheetId:o})}_replaceByParam(e){const{pluginName:n,unitId:r,sheetId:i,selectionDatas:o}=e;this._selectionInfo.has(n)||this._selectionInfo.set(n,new Map);const s=this._selectionInfo.get(n);s.has(r)||s.set(r,new Map);const a=s.get(r);if(!a.has(i))a.set(i,o);else{let l=a.get(i);l==null&&(l=[],a.set(i,l)),l.splice(0,l.length,...o)}}_clearByParam(e){const n=this._getSelectionDatas(e);n==null||n.splice(0),this._refresh(e)}_removeByParam(e,n){const r=this._getSelectionDatas(n);r==null||r.splice(e,1),this._refresh(n)}};ut=yMe([SMe(0,ne(Ki))],ut);const EMe=h0("CELL_CONTENT"),wMe=h0("PERMISSION"),Ra={CELL_CONTENT:EMe,PERMISSION:wMe};var RMe=Object.defineProperty,DMe=Object.getOwnPropertyDescriptor,IMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?DMe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&RMe(e,n,i),i},xMe=(t,e)=>(n,r)=>e(n,r,t);let En=class extends je{constructor(t){super(),Jn(this,"_interceptorsByName",new Map),Jn(this,"_commandInterceptors",[]),Jn(this,"_workbookDisposables",new Map),Jn(this,"_worksheetDisposables",new Map),this._currentUniverService=t,this.disposeWithMe(Be(this._currentUniverService.sheetAdded$.subscribe(e=>{this._interceptWorkbook(e)}))),this.disposeWithMe(Be(this._currentUniverService.sheetDisposed$.subscribe(e=>this._disposeWorkbookInterceptor(e)))),this.intercept(Ra.CELL_CONTENT,{priority:-1,handler(e,n){const r=n.worksheet.getCellRaw(n.row,n.col);return e?{...r,...e}:r}}),this.intercept(Ra.PERMISSION,{priority:-1,handler:()=>!0})}dispose(){super.dispose(),this._workbookDisposables.forEach(t=>t.dispose()),this._workbookDisposables.clear(),this._worksheetDisposables.clear()}interceptCommand(t){if(this._commandInterceptors.includes(t))throw new Error("[SheetInterceptorService]: Interceptor already exists!");return this._commandInterceptors.push(t),this._commandInterceptors.sort((e,n)=>(n.priority??0)-(e.priority??0)),this.disposeWithMe(Be(()=>ga(this._commandInterceptors,t)))}onCommandExecute(t){const e=this._commandInterceptors.map(n=>n.getMutations(t));return{undos:e.map(n=>n.undos).flat(),redos:e.map(n=>n.redos).flat()}}intercept(t,e){const n=t;this._interceptorsByName.has(n)||this._interceptorsByName.set(n,[]);const r=this._interceptorsByName.get(n);return r.push(e),this._interceptorsByName.set(n,r.sort((i,o)=>(o.priority??0)-(i.priority??0))),this.disposeWithMe(Be(()=>ga(this._interceptorsByName.get(n),e)))}fetchThroughInterceptors(t){const e=t,n=this._interceptorsByName.get(e);return oM(n||[])}_interceptWorkbook(t){const e=new Ia,n=t.getUnitId(),r=this,i=o=>{const s=o.getSheetId();o.__interceptViewModel(a=>{const l=new Ia,u=a.registerCellContentInterceptor({getCell(c,d){return r.fetchThroughInterceptors(Ra.CELL_CONTENT)(o.getCellRaw(c,d),{unitId:n,subUnitId:s,row:c,col:d,worksheet:o,workbook:t})}});l.add(u),r._worksheetDisposables.set(kD(n,o),l)})};t.getSheets().forEach(o=>i(o)),e.add(Be(t.sheetCreated$.subscribe(o=>i(o)))),e.add(Be(t.sheetDisposed$.subscribe(o=>this._disposeSheetInterceptor(n,o)))),e.add(Be(()=>t.getSheets().forEach(o=>this._disposeSheetInterceptor(n,o))))}_disposeWorkbookInterceptor(t){const e=t.getUnitId(),n=this._workbookDisposables.get(e);n&&(n.dispose(),this._workbookDisposables.delete(e))}_disposeSheetInterceptor(t,e){const n=kD(t,e),r=this._worksheetDisposables.get(n);r&&(r.dispose(),this._worksheetDisposables.delete(n))}};En=IMe([yt(it.Starting,En),xMe(0,oe)],En);function kD(t,e){return`${t}|${e.getSheetId()}`}const Bi=(t,e)=>{const{unitId:n,subUnitId:r,cellValue:i}=e,o=t.get(oe).getUniverSheetInstance(n);if(o==null)throw new Error("workbook is null error!");const s=o.getSheetBySheetId(r);if(s==null)throw new Error("worksheet is null error!");const a=s.getCellMatrix(),l=o.getStyles(),u=new nt;return new nt(i).forValue((c,d,h)=>{const f=De.deepClone(a==null?void 0:a.getValue(c,d))||{},m=l.getStyleByCell(f),p=TMe(m,h&&h.s?h.s:null);f.s=p,u.setValue(c,d,MMe(f))}),{...e,options:{},cellValue:u.getMatrix()}};function MMe(t){return t==null?null:(t.f===void 0&&(t.f=null),t.si===void 0&&(t.si=null),t.p===void 0&&(t.p=null),t.v===void 0&&(t.v=null),t.t===void 0&&(t.t=null),t.s===void 0&&(t.s=null),t)}const Pt={id:"sheet.mutation.set-range-values",type:se.MUTATION,handler:(t,e)=>{const{cellValue:n,subUnitId:r,unitId:i}=e,o=t.get(oe).getUniverSheetInstance(i);if(!o)return!1;const s=o.getSheetBySheetId(r);if(!s)return!1;const a=s.getCellMatrix(),l=o.getStyles();return new nt(n).forValue((u,c,d)=>{if(!d)a==null||a.setValue(u,c,{});else{const h=a.getValue(u,c)||{},f=d.t===er.FORCE_STRING?d.t:OMe(d.v===void 0?h.v:d.v);if(d.f!==void 0&&(h.f=d.f),d.si!==void 0&&(h.si=d.si),d.p!==void 0&&(h.p=d.p),d.v!==void 0&&(h.v=f===er.NUMBER?Number(d.v):d.v),h.v!==void 0&&(h.t=f),d.s!==void 0){const m=l.getStyleByCell(h);m==null&&delete h.s,typeof d.s=="string"&&(d.s=l.get(d.s));const p=YP(m,d.s?d.s:null);p&&De.removeNull(p),De.isEmptyObject(p)?delete h.s:h.s=l.setValue(p),!d.p&&h.p&&AMe(h.p,d.s?d.s:null)}a.setValue(u,c,De.removeNull(h))}}),!0}};function OMe(t){return t===null?null:typeof t=="string"?LMe(t)?er.NUMBER:er.STRING:typeof t=="number"?er.NUMBER:typeof t=="boolean"?er.BOOLEAN:er.FORCE_STRING}function TMe(t,e){return $Me(t,e)}function $Me(t,e){if(!e||!Object.keys(e).length)return t;const n=t||{};for(const r in e)r==="bd"?n[r]=kMe(n[r]||{},e[r]):r in n||(n[r]=null);return n}function kMe(t,e){if(!e||!Object.keys(e).length)return t;for(const n in e)n in t||(t[n]=null);return t}function YP(t,e,n=!1){if(e===null)return e;if(e===void 0)return t;const r=De.deepClone(t)||{};if(r){for(const i in e)n&&["bd","tr","td","ht","vt","tb","pd"].includes(i)||(i in r&&i==="bd"?r[i]=Object.assign(r[i],e[i]):r[i]=e[i]);return"cl"in r&&("ul"in r&&(r.ul.cl=r.cl),"ol"in r&&(r.ol.cl=r.cl),"st"in r&&(r.st.cl=r.cl)),r}}function AMe(t,e){var n,r;(r=(n=t.body)==null?void 0:n.textRuns)==null||r.forEach(i=>{i.ts||(i.ts={});const o=i.ts||{},s=YP(o,e,!0);s&&De.removeNull(s),De.isEmptyObject(s)?delete i.ts:i.ts=s})}function NMe(t){return/^-?\d+(\.\d+)?$/.test(t)}function LMe(t){return NMe(t)?Number(t)<=Number.MAX_SAFE_INTEGER:!1}const A4={id:"sheet.command.clear-selection-all",type:se.COMMAND,handler:async t=>{const e=t.get(oe),n=t.get(le),r=t.get(ut),i=t.get(At),o=t.get(En),s=e.getCurrentUniverSheetInstance(),a=s.getUnitId(),l=s.getActiveSheet().getSheetId(),u=r.getSelectionRanges();if(!(u!=null&&u.length))return!1;const c=[],d=[],h={subUnitId:l,unitId:a,cellValue:PMe(u)},f=Bi(t,h);c.push({id:Pt.id,params:h}),d.push({id:Pt.id,params:f});const m=o.onCommandExecute({id:A4.id});return c.push(...m.redos),d.unshift(...m.undos),Xn(c,n)?(i.pushUndoRedo({unitID:a,undoMutations:d,redoMutations:c}),!0):!1}};function PMe(t){const e=new nt;return t.forEach(n=>{const{startRow:r,startColumn:i,endRow:o,endColumn:s}=n;for(let a=r;a<=o;a++)for(let l=i;l<=s;l++)e.setValue(a,l,null)}),e.getData()}const hf={id:"sheet.command.clear-selection-content",type:se.COMMAND,handler:async t=>{const e=t.get(oe),n=t.get(le),r=t.get(ut),i=t.get(At),o=t.get(En),s=e.getCurrentUniverSheetInstance(),a=s.getUnitId(),l=s.getActiveSheet().getSheetId(),u=r.getSelectionRanges();if(!(u!=null&&u.length))return!1;const c={subUnitId:l,unitId:a,cellValue:BMe(u)},d=Bi(t,c),h=o.onCommandExecute({id:hf.id}),f=[{id:Pt.id,params:c},...h.redos],m=[...h.undos,{id:Pt.id,params:d}];return Xn(f,n).result?(i.pushUndoRedo({unitID:a,undoMutations:m,redoMutations:f}),!0):!1}};function BMe(t){const e=new nt;return t.forEach(n=>{const{startRow:r,startColumn:i,endRow:o,endColumn:s}=n;for(let a=r;a<=o;a++)for(let l=i;l<=s;l++)e.setValue(a,l,{v:null,p:null,f:null,si:null})}),e.getData()}const N4={id:"sheet.command.clear-selection-format",type:se.COMMAND,handler:async t=>{const e=t.get(oe),n=t.get(le),r=t.get(ut),i=t.get(At),o=t.get(En),s=e.getCurrentUniverSheetInstance(),a=s.getUnitId(),l=s.getActiveSheet().getSheetId(),u=r.getSelectionRanges();if(!(u!=null&&u.length))return!1;const c=[],d=[],h={subUnitId:l,unitId:a,cellValue:FMe(u)},f=Bi(t,h);c.push({id:Pt.id,params:h}),d.push({id:Pt.id,params:f});const m=o.onCommandExecute({id:N4.id});return c.push(...m.redos),d.unshift(...m.undos),Xn(c,n)?(i.pushUndoRedo({unitID:a,undoMutations:d,redoMutations:c}),!0):!1}};function FMe(t){const e=new nt;return t.forEach(n=>{const{startRow:r,startColumn:i,endRow:o,endColumn:s}=n;for(let a=r;a<=o;a++)for(let l=i;l<=s;l++)e.setValue(a,l,{s:null})}),e.getData()}const GP=(t,e)=>({subUnitId:e.sheet.id,unitId:e.unitId}),ps={id:"sheet.mutation.insert-sheet",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe),{sheet:r,index:i,unitId:o}=e,s=n.getUniverSheetInstance(o);return s?s.addWorksheet(r.id,i,r):!1}},UMe=(t,e)=>{const n=t.get(oe).getCurrentUniverSheetInstance(),{subUnitId:r,unitId:i}=e,o=n.getSheetBySheetId(r).getConfig();return{index:n.getConfig().sheetOrder.findIndex(s=>s===r),sheet:o,unitId:i}},Zs={id:"sheet.mutation.remove-sheet",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe),{subUnitId:r,unitId:i}=e,o=n.getUniverSheetInstance(i);if(!o)return!1;const s=o.getWorksheets(),a=o.getConfig(),{sheets:l}=a;if(l[r]==null)throw new Error(`Remove sheet fail ${r} does not exist`);const u=a.sheetOrder.findIndex(c=>c===r);return delete l[r],a.sheetOrder.splice(u,1),s.delete(r),!0}},KP={type:se.COMMAND,id:"sheet.command.copy-sheet",handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe),o=t.get(mn);let s=i.getCurrentUniverSheetInstance().getUnitId(),a=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();e&&(s=e.unitId??s,a=e.subUnitId??a);const l=i.getUniverSheetInstance(s);if(!l)return!1;const u=l.getSheetBySheetId(a);if(!u)return!1;const c=De.deepClone(u.getConfig());c.name+=o.t("sheets.sheetCopy"),c.id=De.generateRandomId();const d={index:l.getSheetIndex(u)+1,sheet:c,unitId:s},h=GP(t,d);return n.syncExecuteCommand(ps.id,d)?(r.pushUndoRedo({unitID:s,undoMutations:[{id:Zs.id,params:h}],redoMutations:[{id:ps.id,params:d}]}),!0):!1}},ff=(t,e)=>{const n=t.get(oe).getCurrentUniverSheetInstance().getSheetBySheetId(e.subUnitId);if(!n)return null;const r=n.getCellMatrix(),i=new nt,o=n.getConfig().rowCount,s=n.getConfig().columnCount,{startRow:a,endRow:l,startColumn:u,endColumn:c}=e.range;if(e.shiftDimension===sr.ROWS){for(let d=a;d<=o;d++)for(let h=u;h<=c;h++)if(d<=l){const f=r.getValue(d,h);i.setValue(d,h,f)}}else if(e.shiftDimension===sr.COLUMNS)for(let d=a;d<=l;d++)for(let h=u;h<=s;h++)if(h<=c){const f=r.getValue(d,h);i.setValue(d,h,f)}else for(let f=0;f<=c;f++){const m=r.getValue(d,h);i.setValue(d,h+f,m)}return{...De.deepClone(e),cellValue:i.getData()}},yo={id:"sheet.mutation.delete-range",type:se.MUTATION,handler:(t,e)=>{const{unitId:n,subUnitId:r,range:i,shiftDimension:o}=e,s=t.get(oe).getUniverSheetInstance(n);if(!s)return!1;const a=s.getSheetBySheetId(r);if(!a)return!1;const l=a.getCellMatrix(),u=a.getLastRowWithContent(),c=a.getLastColumnWithContent();return L4(l,i,u,c,o),!0}};function L4(t,e,n,r,i){const{startRow:o,endRow:s,startColumn:a,endColumn:l}=e,u=s-o+1,c=l-a+1;if(i===sr.ROWS)for(let d=o;d<=n;d++)for(let h=a;h<=l;h++){const f=t.getValue(d+u,h);f==null?t.realDeleteValue(d,h):t.setValue(d,h,f)}else if(i===sr.COLUMNS)for(let d=o;d<=s;d++)for(let h=a;h<=r;h++){const f=t.getValue(d,h+c);f==null?t.realDeleteValue(d,h):t.setValue(d,h,f)}}const mf=(t,e)=>({unitId:e.unitId,subUnitId:e.subUnitId,range:e.range,shiftDimension:e.shiftDimension}),So={id:"sheet.mutation.insert-range",type:se.MUTATION,handler:(t,e)=>{const{unitId:n,subUnitId:r,range:i,cellValue:o,shiftDimension:s}=e,a=t.get(oe).getUniverSheetInstance(n);if(!a)return!1;const l=a.getSheetBySheetId(r);if(!l)return!1;const u=l.getCellMatrix(),c=l.getLastRowWithContent(),d=l.getLastColumnWithContent();return P4(u,i,c,d,s,o),!0}};function P4(t,e,n,r,i,o){const{startRow:s,endRow:a,startColumn:l,endColumn:u}=e;if(i===sr.ROWS){const c=a-s+1;for(let d=n;d>=s;d--)for(let h=l;h<=u;h++){const f=t.getValue(d,h);f==null?t.realDeleteValue(d+c,h):t.setValue(d+c,h,f)}for(let d=a;d>=s;d--)for(let h=l;h<=u;h++)o&&o[d]&&o[d][h]?t.setValue(d,h,o[d][h]):t.realDeleteValue(d,h)}else if(i===sr.COLUMNS){const c=u-l+1;for(let d=s;d<=a;d++)for(let h=r;h>=l;h--){const f=t.getValue(d,h);f==null?t.realDeleteValue(d,h+c):t.setValue(d,h+c,f)}for(let d=s;d<=a;d++)for(let h=u;h>=l;h--)o&&o[d]&&o[d][h]?t.setValue(d,h,o[d][h]):t.realDeleteValue(d,h)}}const ZP="sheet.command.delete-range-move-left",R0={type:se.COMMAND,id:ZP,handler:async(t,e)=>{var n;const r=t.get(le),i=t.get(At),o=t.get(oe),s=t.get(ut),a=t.get(En),l=o.getCurrentUniverSheetInstance().getUnitId(),u=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();let c=e==null?void 0:e.range;if(c||(c=(n=s.getLast())==null?void 0:n.range),!c)return!1;const d=o.getUniverSheetInstance(l);if(!d||!d.getSheetBySheetId(u))return!1;const h={range:c,subUnitId:u,unitId:l,shiftDimension:sr.COLUMNS},f=ff(t,h);if(!f)return!1;const m=a.onCommandExecute({id:R0.id,params:{range:c}}),p=[{id:yo.id,params:h}],g=[{id:So.id,params:f}];return p.push(...m.redos),g.push(...m.undos),Xn(p,r).result?(i.pushUndoRedo({unitID:l,undoMutations:g.reverse(),redoMutations:p}),!0):!1}},qP="sheet.command.delete-range-move-up",D0={type:se.COMMAND,id:qP,handler:async(t,e)=>{var n;const r=t.get(le),i=t.get(At),o=t.get(oe),s=t.get(ut),a=t.get(En),l=o.getCurrentUniverSheetInstance().getUnitId(),u=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();let c=e==null?void 0:e.range;if(c||(c=(n=s.getLast())==null?void 0:n.range),!c)return!1;const d=o.getUniverSheetInstance(l);if(!d||!d.getSheetBySheetId(u))return!1;const h={range:c,subUnitId:u,unitId:l,shiftDimension:sr.ROWS},f=ff(t,h);if(!f)return!1;const m=a.onCommandExecute({id:D0.id,params:{range:c}}),p=[{id:yo.id,params:h}],g=[{id:So.id,params:f}];return p.push(...m.redos),g.push(...m.undos),await Xn(p,r).result?(i.pushUndoRedo({unitID:l,undoMutations:g.reverse(),redoMutations:p}),!0):!1}},QP=(t,e)=>{if(t.get(oe).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,range:e.range}},qu={id:"sheet.mutation.insert-row",type:se.MUTATION,handler:(t,e)=>{const{unitId:n,subUnitId:r,range:i,rowInfo:o}=e,s=t.get(oe).getUniverSheetInstance(n);if(s==null)throw new Error("universheet is null error!");const a=s.getSheetBySheetId(r);if(a==null)throw new Error("worksheet is null error!");const l=a.getRowManager().getRowData(),u={h:a.getConfig().defaultRowHeight,hd:0},c=i.startRow,d=i.endRow-i.startRow+1;for(let h=c;h<c+d;h++)o?oh(h,o[h-i.startRow]??u,l):oh(h,u,l);return a.setRowCount(a.getRowCount()+i.endRow-i.startRow+1),!0}},JP=(t,e)=>{if(t.get(oe).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,range:e.range}},Qu={id:"sheet.mutation.insert-col",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(!r)return!1;const i=r.getColumnManager(),{range:o,colInfo:s}=e,a=i.getColumnData(),l=o.startColumn,u=o.endColumn-o.startColumn+1,c=r.getConfig().defaultColumnWidth;for(let d=l;d<l+u;d++){const h={w:c,hd:0};s?oh(d,s[d-o.startColumn]??h,a):oh(d,h,a)}return r.setColumnCount(r.getColumnCount()+o.endColumn-o.startColumn+1),!0}},HMe=(t,e)=>{const n=e.getRowManager().getRowData(),r={},i=t.range,o=Ax(i.startRow,i.endRow,n);return kx(r,o),{unitId:t.unitId,subUnitId:t.subUnitId,range:t.range,rowInfo:r}},$l={id:"sheet.mutation.remove-rows",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(!r)return!1;const i=e.range,o=r.getRowManager().getRowData(),s=i.endRow-i.startRow+1;return $x(i.startRow,s,o),r.setRowCount(r.getRowCount()-s),!0}},VMe=(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(r==null)throw new Error("worksheet is null error!");const i=r.getColumnManager().getColumnData(),o={},s=e.range,a=Ax(s.startColumn,s.endColumn,i);return kx(o,a),{unitId:e.unitId,subUnitId:e.subUnitId,range:e.range,colInfo:o}},kl={id:"sheet.mutation.remove-col",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(!r)return!1;const i=e.range,o=r.getColumnManager().getColumnData(),s=i.endColumn-i.startColumn+1;return $x(i.startColumn,s,o),r.setColumnCount(r.getColumnCount()-s),!0}},jMe="sheet.command.insert-range-move-down",I0={type:se.COMMAND,id:"sheet.command.insert-range-move-down",handler:async(t,e)=>{var n;const r=t.get(le),i=t.get(At),o=t.get(oe),s=t.get(hs),a=t.get(ut),l=t.get(En);if(a.isOverlapping())return s.error("Cannot use that command on overlapping selections."),!1;const u=o.getCurrentUniverSheetInstance().getUnitId(),c=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();let d=e==null?void 0:e.range;if(d||(d=(n=a.getLast())==null?void 0:n.range),!d)return!1;const h=o.getUniverSheetInstance(u);if(!h)return!1;const f=h.getSheetBySheetId(c);if(!f)return!1;const m=[],p=[],g={};Er.foreach(d,(O,$)=>{const N=f.getCell(O,$);!N||!N.s||(g[O]||(g[O]={}),g[O][$]={s:N.s})});const v={range:d,subUnitId:c,unitId:u,shiftDimension:sr.ROWS,cellValue:g};m.push({id:So.id,params:v});const _=mf(t,v);p.push({id:yo.id,params:_});let C=!1,y=0;const S=f.getMaxRows()-1,{startRow:E,endRow:w,startColumn:R,endColumn:D}=d;for(let O=R;O<=D;O++){const $=f.getCell(S,O),N=$==null?void 0:$.v;if(N&&N!==""){C=!0,y=f.getRowHeight(S);break}}const I=w-E+1;if(C){const O={startRow:S,endRow:S,startColumn:d.startColumn,endColumn:d.endColumn},$={unitId:u,subUnitId:c,range:O,rowInfo:new Array(I).fill(void 0).map(()=>({h:y,hd:ke.FALSE}))};m.push({id:qu.id,params:$});const N=QP(t,$);p.push({id:$l.id,params:N})}const k=l.onCommandExecute({id:I0.id,params:{range:d}});return m.push(...k.redos),p.push(...k.undos),Xn(m,r)?(i.pushUndoRedo({unitID:u,undoMutations:p.reverse(),redoMutations:m}),!0):!1}},eB="sheet.command.insert-range-move-right",x0={type:se.COMMAND,id:eB,handler:async(t,e)=>{var n;const r=t.get(le),i=t.get(At),o=t.get(oe),s=t.get(hs),a=t.get(ut),l=t.get(En);if(a.isOverlapping())return s.error("Cannot use that command on overlapping selections."),!1;const u=o.getCurrentUniverSheetInstance().getUnitId(),c=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();let d=e==null?void 0:e.range;if(d||(d=(n=a.getLast())==null?void 0:n.range),!d)return!1;const h=o.getUniverSheetInstance(u);if(!h)return!1;const f=h.getSheetBySheetId(c);if(!f)return!1;const m=[],p=[],g={};Er.foreach(d,(O,$)=>{const N=f.getCell(O,$);!N||!N.s||(g[O]||(g[O]={}),g[O][$]={s:N.s})});const v={range:d,subUnitId:c,unitId:u,shiftDimension:sr.COLUMNS,cellValue:g};m.push({id:So.id,params:v});const _=mf(t,v);p.push({id:yo.id,params:_});let C=!1,y=0;const S=f.getMaxColumns()-1,{startRow:E,endRow:w,startColumn:R,endColumn:D}=d;for(let O=E;O<=w;O++){const $=f.getCell(O,S),N=$==null?void 0:$.v;if(N&&N!==""){C=!0,y=f.getColumnWidth(S);break}}const I=D-R+1;if(C){const O={startRow:d.startRow,endRow:d.endRow,startColumn:S,endColumn:S},$={unitId:u,subUnitId:c,range:O,colInfo:new Array(I).fill(void 0).map(()=>({w:y,hd:ke.FALSE}))};m.push({id:Qu.id,params:$});const N=JP(t,$);p.push({id:kl.id,params:N})}const k=l.onCommandExecute({id:x0.id,params:{range:d}});return m.push(...k.redos),p.push(...k.undos),Xn(m,r).result?(i.pushUndoRedo({unitID:u,undoMutations:p.reverse(),redoMutations:m}),!0):!1}},tB="sheet.command.insert-row",mc={type:se.COMMAND,id:tB,handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe).getUniverSheetInstance(e.unitId).getSheetBySheetId(e.subUnitId),{range:o,direction:s,unitId:a,subUnitId:l,cellValue:u}=e,{startRow:c,endRow:d}=o,h=s===ge.UP?c:c-1,f=i.getRowHeight(h),m={unitId:a,subUnitId:l,range:o,rowInfo:new Array(d-c+1).fill(void 0).map(()=>({h:f,hd:ke.FALSE}))},p=QP(t,m),g={unitId:e.unitId,subUnitId:e.subUnitId,range:e.range,shiftDimension:sr.ROWS,cellValue:u},v=mf(t,g),_=t.get(En).onCommandExecute({id:mc.id,params:e});return Xn([{id:qu.id,params:m},{id:So.id,params:g},..._.redos],n).result?(r.pushUndoRedo({unitID:e.unitId,undoMutations:[..._.undos,{id:yo.id,params:v},{id:$l.id,params:p}],redoMutations:[{id:qu.id,params:m},{id:So.id,params:g},..._.redos]}),!0):!1}},nB={type:se.COMMAND,id:"sheet.command.insert-row-before",handler:async t=>{var e;const n=(e=t.get(ut).getSelections())==null?void 0:e.map(d=>d.range);let r;if((n==null?void 0:n.length)===1)r=n[0];else return!1;const i=t.get(oe).getCurrentUniverSheetInstance();if(!i)return!1;const o=i.getActiveSheet();if(!o)return!1;const s=i.getUnitId(),a=o.getSheetId(),l=r.endRow-r.startRow+1,u={};Er.foreach(r,(d,h)=>{const f=o.getCell(d,h);!f||!f.s||(u[d]||(u[d]={}),u[d][h]={s:f.s})});const c={unitId:s,subUnitId:a,direction:ge.UP,range:{startRow:r.startRow,endRow:r.startRow+l-1,startColumn:0,endColumn:o.getColumnCount()-1},cellValue:u};return t.get(le).executeCommand(mc.id,c)}},rB={type:se.COMMAND,id:"sheet.command.insert-row-after",handler:async t=>{var e;const n=(e=t.get(ut).getSelections())==null?void 0:e.map(c=>c.range);let r;if((n==null?void 0:n.length)===1)r=n[0];else return!1;const i=t.get(oe).getCurrentUniverSheetInstance();if(!i)return!1;const o=i.getActiveSheet();if(!o)return!1;const s=i.getUnitId(),a=o.getSheetId(),l=r.endRow-r.startRow+1,u={unitId:s,subUnitId:a,direction:ge.DOWN,range:{startRow:r.endRow+1,endRow:r.endRow+l,startColumn:0,endColumn:o.getColumnCount()-1}};return t.get(le).executeCommand(mc.id,u)}},iB="sheet.command.insert-col",pc={type:se.COMMAND,id:iB,handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe),o=t.get(En),{range:s,direction:a,subUnitId:l,unitId:u,cellValue:c}=e,{startColumn:d,endColumn:h}=e.range,f=i.getUniverSheetInstance(e.unitId).getSheetBySheetId(e.subUnitId),m=a===ge.LEFT?d:d-1,p=f.getColumnWidth(m),g={unitId:u,subUnitId:l,range:s,colInfo:new Array(h-d+1).fill(void 0).map(()=>({w:p,hd:ke.FALSE}))},v=JP(t,g),_={unitId:e.unitId,subUnitId:e.subUnitId,range:e.range,shiftDimension:sr.COLUMNS,cellValue:c},C=mf(t,_),y=o.onCommandExecute({id:pc.id,params:e});return Xn([{id:Qu.id,params:g},{id:So.id,params:_},...y.redos],n).result?(r.pushUndoRedo({unitID:e.unitId,undoMutations:[...y.undos,{id:yo.id,params:C},{id:kl.id,params:v}],redoMutations:[{id:Qu.id,params:g},{id:So.id,params:_},...y.redos]}),!0):!1}},oB={type:se.COMMAND,id:"sheet.command.insert-col-before",handler:async t=>{const e=t.get(ut).getSelections();let n;if((e==null?void 0:e.length)===1)n=e[0].range;else return!1;const r=t.get(oe).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),s=i.getSheetId(),a=n.endColumn-n.startColumn+1,l={};Er.foreach(n,(c,d)=>{const h=i.getCell(c,d);!h||!h.s||(l[c]||(l[c]={}),l[c][d]={s:h.s})});const u={unitId:o,subUnitId:s,direction:ge.LEFT,range:{startColumn:n.startColumn,endColumn:n.startColumn+a-1,startRow:0,endRow:i.getLastRowWithContent()},cellValue:l};return t.get(le).executeCommand(pc.id,u)}},sB={type:se.COMMAND,id:"sheet.command.insert-col-after",handler:async t=>{const e=t.get(ut).getSelections();let n;if((e==null?void 0:e.length)===1)n=e[0].range;else return!1;const r=t.get(oe).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),s=i.getSheetId(),a=n.endColumn-n.startColumn+1,l={unitId:o,subUnitId:s,direction:ge.RIGHT,range:{startColumn:n.endColumn+1,endColumn:n.endColumn+a,startRow:0,endRow:i.getLastRowWithContent()}};return t.get(le).executeCommand(pc.id,l)}},aB={id:"sheet.command.insert-sheet",type:se.COMMAND,handler:(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe);let o=i.getCurrentUniverSheetInstance().getUnitId();e&&(o=e.unitId??o);const s=i.getUniverSheetInstance(o);if(!s)return!1;let a=s.getSheets().length,l=De.deepClone(ch);e?(a=e.index??a,e.sheet?l=e.sheet:(l.id=De.generateRandomId(),l.name=`${++s.getSheets().length}`)):(l.id=De.generateRandomId(),l.name=`${++s.getSheets().length}`);const u={index:a,sheet:l,unitId:o},c=GP(t,u);return n.syncExecuteCommand(ps.id,u)?(r.pushUndoRedo({unitID:o,undoMutations:[{id:Zs.id,params:c}],redoMutations:[{id:ps.id,params:u}]}),!0):!1}},Al={id:"sheet.mutation.move-range",type:se.MUTATION,handler:(t,e)=>{const{from:n,to:r}=e;if(!n||!r)return!1;const i=t.get(oe).getCurrentUniverSheetInstance();if(!i)return!1;const o=i.getSheetBySheetId(e.subUnitId);if(!o)return!1;const s=o.getCellMatrix();return new nt(n).forValue((a,l,u)=>{s.setValue(a,l,u)}),new nt(r).forValue((a,l,u)=>{s.setValue(a,l,u)}),!0}},dn={id:"sheet.operation.set-selections",type:se.OPERATION,handler:(t,e)=>{const n=t.get(ut);if(!e)return!1;const{selections:r,type:i}=e;return n.replace(r,i),!0}},lB="sheet.command.move-range",gc={type:se.COMMAND,id:lB,handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe),o=t.get(En),s=i.getCurrentUniverSheetInstance(),a=s.getActiveSheet(),l=s.getUnitId(),u=a.getSheetId(),c=a.getRange(e.fromRange).getValues(),d=c.reduce((y,S,E)=>(S.forEach((w,R)=>{y.setValue(e.fromRange.startRow+E,e.fromRange.startColumn+R,null)}),y),new nt),h=c.reduce((y,S,E)=>(S.forEach((w,R)=>{y.setValue(e.fromRange.startRow+E,e.fromRange.startColumn+R,w)}),y),new nt),f=c.reduce((y,S,E)=>(S.forEach((w,R)=>{y.setValue(e.toRange.startRow+E,e.toRange.startColumn+R,w)}),y),new nt),m=a.getRange(e.toRange).getValues().reduce((y,S,E)=>(S.forEach((w,R)=>{y.setValue(e.toRange.startRow+E,e.toRange.startColumn+R,w)}),y),new nt),p={from:d.getMatrix(),to:f.getMatrix(),unitId:l,subUnitId:u},g={from:h.getMatrix(),to:m.getMatrix(),unitId:l,subUnitId:u},v=o.onCommandExecute({id:gc.id,params:e}),_=[{id:Al.id,params:p},...v.redos,{id:dn.id,params:{unitId:l,sheetId:u,pluginName:On,selections:[{range:e.toRange}]}}],C=[{id:dn.id,params:{unitId:l,sheetId:u,pluginName:On,selections:[{range:e.fromRange}]}},...v.undos,{id:Al.id,params:g}];return await Xn(_,n).result?(r.pushUndoRedo({unitID:l,undoMutations:C,redoMutations:_}),!0):!1}},so=(t,e)=>{if(t.get(oe).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},wn={id:"sheet.mutation.add-worksheet-merge",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(!r)return!1;const i=r.getConfig().mergeData,o=e.ranges;for(let s=0;s<o.length;s++)i.push(o[s]);return!0}};function zMe(t,e){const{unitId:n,subUnitId:r,sourceRange:i,targetRange:o}=e,s=i.startRow>o.startRow,a=i.endRow-i.startRow+1;return s?{unitId:n,subUnitId:r,sourceRange:pt.clone(o),targetRange:{...i,endRow:i.endRow+a,startRow:i.startRow+a}}:{unitId:n,subUnitId:r,targetRange:pt.clone(i),sourceRange:pt.clone(o)}}const r0={id:"sheet.mutation.move-rows",type:se.MUTATION,handler:(t,e)=>{const{unitId:n,subUnitId:r,sourceRange:i,targetRange:o}=e,s=t.get(oe).getUniverSheetInstance(n);if(!s)throw new Error("[MoveRowMutation] univerSheet is null!");const a=s.getSheetBySheetId(r);if(!a)throw new Error("[MoveRowMutation] worksheet is null!");const l=i.startRow,u=i.endRow-i.startRow+1,c=o.startRow,d=a.getRowManager().getRowData();return sh(l,u,c,d),a.getCellMatrix().moveRows(l,u,c),!0}};function WMe(t,e){const{unitId:n,subUnitId:r,sourceRange:i,targetRange:o}=e,s=i.startColumn>o.startColumn,a=i.endColumn-i.startColumn+1;return s?{unitId:n,subUnitId:r,sourceRange:pt.clone(o),targetRange:{...i,endColumn:i.endColumn+a,startColumn:i.startColumn+a}}:{unitId:n,subUnitId:r,targetRange:pt.clone(i),sourceRange:pt.clone(o)}}const i0={id:"sheet.mutation.move-columns",type:se.MUTATION,handler:(t,e)=>{const{unitId:n,subUnitId:r,sourceRange:i,targetRange:o}=e,s=t.get(oe).getUniverSheetInstance(n);if(!s)throw new Error("[MoveColumnMutation] univerSheet is null!");const a=s.getSheetBySheetId(r);if(!a)throw new Error("[MoveColumnMutation] worksheet is null!");const l=i.startColumn,u=i.endColumn-i.startColumn+1,c=o.startColumn,d=a.getColumnManager().getColumnData();return sh(l,u,c,d),a.getCellMatrix().moveColumns(l,u,c),!0}},Ai=(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(r==null)throw new Error("worksheet is null error!");const i=r.getConfig().mergeData,o=e.ranges,s=[];for(let a=0;a<o.length;a++)for(let l=i.length-1;l>=0;l--){const u=i[l],c=o[a];pt.intersects(u,c)&&s.push(i[l])}return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:s}},Rn={id:"sheet.mutation.remove-worksheet-merge",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(!r)return!1;const i=r.getConfig().mergeData,o=e.ranges;for(let s=0;s<o.length;s++)for(let a=i.length-1;a>=0;a--){const l=i[a],u=o[s];pt.intersects(l,u)&&i.splice(a,1)}return!0}};function XMe(t,e){return e.getMergeData().some(n=>n.startRow<t&&t<=n.endRow)}function YMe(t,e){return e.getMergeData().some(n=>n.startColumn<t&&t<=n.endColumn)}function cs(t,e,n=!0){const r=e.getMatrixWithMergedCells(...QV(t)),i=[];if(r.forValue((s,a,l)=>{if(l.colSpan!==void 0&&l.rowSpan!==void 0){const u={startRow:s,startColumn:a,endRow:s+l.rowSpan-1,endColumn:a+l.colSpan-1};pt.contains(t,u)||i.push(u)}}),i.length===0)return t;const o=pt.union(t,...i);return n?cs(o,e,n):o}function C5(t,e,n){let r=null;return n.getMatrixWithMergedCells(t,e,t,e).forValue((i,o,s)=>(r={actualRow:i,actualColumn:o,startRow:i,startColumn:o,isMerged:s.rowSpan!==void 0||s.colSpan!==void 0,isMergedMainCell:s.rowSpan!==void 0&&s.colSpan!==void 0,endRow:i+(s.rowSpan!==void 0?s.rowSpan-1:0),endColumn:o+(s.colSpan!==void 0?s.colSpan-1:0),rangeType:Rt.NORMAL},!1)),r||{actualColumn:e,actualRow:t,startRow:t,startColumn:e,endRow:t,endColumn:e,isMerged:!1,isMergedMainCell:!1,rangeType:Rt.NORMAL}}function qs(t,e){const n=e.getMergedCell(t.startRow,t.startColumn);return n?{...n,actualRow:t.startRow,actualColumn:t.startColumn,rangeType:Rt.NORMAL,isMerged:!0,isMergedMainCell:!0}:{startRow:t.startRow,startColumn:t.startColumn,endRow:t.startRow,endColumn:t.startColumn,actualRow:t.startRow,actualColumn:t.startColumn,rangeType:Rt.NORMAL,isMerged:!1,isMergedMainCell:!1}}const B4={id:"sheet.command.move-rows",type:se.COMMAND,handler:async(t,e)=>{const n=t.get(ut).getSelections(),{fromRow:r,toRow:i}=e,o=n==null?void 0:n.filter(te=>te.range.rangeType===Rt.ROW&&te.range.startRow<=r&&r<=te.range.endRow);if((o==null?void 0:o.length)!==1)return!1;const s=t.get(En),a=t.get(oe).getCurrentUniverSheetInstance();if(!a)return!1;const l=a.getActiveSheet();if(!l)return!1;const u=a.getUnitId(),c=l.getSheetId(),d=t.get(q6),h=o[0].range,f=o[0].primary,m=cs(h,l,!1);if(!pt.equals(h,m))return d.emit("Only part of a merged cell is selected."),!1;if(XMe(i,l))return d.emit("Across a merged cell."),!1;const p={...h,startRow:i,endRow:i+h.endRow-h.startRow},g={unitId:u,subUnitId:c,sourceRange:h,targetRange:p},v=zMe(t,g),_=i-r,C=_<0,y=h.endRow-h.startRow+1,S=De.deepClone(l.getMergeData());for(let te=0;te<S.length;te++){const z=S[te],{startRow:A,endRow:T}=z;C?pt.contains(h,z)?(z.startRow+=_,z.endRow+=_):T<h.startRow&&A>=p.startRow&&(z.startRow+=y,z.endRow+=y):pt.contains(h,z)?(z.startRow+=_,z.endRow+=_):h.endRow<A&&T<p.startRow&&(z.startRow-=y,z.endRow-=y)}const E={unitId:u,subUnitId:c,ranges:De.deepClone(l.getMergeData())},w=Ai(t,E),R={unitId:u,subUnitId:c,ranges:S},D=so(t,R),I=C?p:{...p,startRow:p.startRow-y,endRow:p.endRow-y},k={unitId:u,subUnitId:c,pluginName:On,selections:[{range:I,primary:qs(I,l),style:null}]},O={unitId:u,subUnitId:c,pluginName:On,selections:[{range:h,primary:f,style:null}]},$=t.get(le),N=s.onCommandExecute({id:B4.id,params:e}),H=[{id:r0.id,params:g},{id:Rn.id,params:E},{id:wn.id,params:R},{id:dn.id,params:k},...N.redos],X=[{id:r0.id,params:v},{id:Rn.id,params:D},{id:wn.id,params:w},{id:dn.id,params:O},...N.undos];return Xn(H,$).result?(t.get(At).pushUndoRedo({unitID:u,undoMutations:X,redoMutations:H}),!0):!1}},F4={id:"sheet.command.move-cols",type:se.COMMAND,handler:async(t,e)=>{const n=t.get(ut).getSelections(),{fromCol:r,toCol:i}=e,o=n==null?void 0:n.filter(te=>te.range.rangeType===Rt.COLUMN&&te.range.startColumn<=r&&r<=te.range.endColumn);if((o==null?void 0:o.length)!==1)return!1;const s=t.get(En),a=t.get(oe).getCurrentUniverSheetInstance();if(!a)return!1;const l=a.getActiveSheet();if(!l)return!1;const u=a.getUnitId(),c=l.getSheetId(),d=t.get(q6),h=o[0].range,f=o[0].primary,m=cs(h,l,!1);if(!pt.equals(h,m))return d.emit("Only part of a merged cell is selected."),!1;if(YMe(i,l))return d.emit("Across a merged cell."),!1;const p={...h,startColumn:i,endColumn:i+h.endColumn-h.startColumn},g={unitId:u,subUnitId:c,sourceRange:h,targetRange:p},v=WMe(t,g),_=h.endColumn-h.startColumn+1,C=i-r,y=C<0,S=De.deepClone(l.getMergeData());for(let te=0;te<S.length;te++){const z=S[te],{startColumn:A,endColumn:T}=z;y?pt.contains(h,z)?(z.startColumn+=C,z.endColumn+=C):T<h.startColumn&&A>=p.startColumn&&(z.startColumn+=_,z.endColumn+=_):pt.contains(h,z)?(z.startColumn+=C,z.endColumn+=C):h.endColumn<A&&T<p.startColumn&&(z.startColumn-=_,z.endColumn-=_)}const E={unitId:u,subUnitId:c,ranges:De.deepClone(l.getMergeData())},w=Ai(t,E),R={unitId:u,subUnitId:c,ranges:S},D=so(t,R),I=y?p:{...p,startColumn:p.startColumn-_,endColumn:p.endColumn-_},k={unitId:u,subUnitId:c,pluginName:On,selections:[{range:I,primary:qs(I,l),style:null}]},O={unitId:u,subUnitId:c,pluginName:On,selections:[{range:h,primary:f,style:null}]},$=t.get(le),N=s.onCommandExecute({id:F4.id,params:e}),H=[{id:i0.id,params:g},{id:Rn.id,params:E},{id:wn.id,params:R},{id:dn.id,params:k},...N.redos],X=[{id:i0.id,params:v},{id:Rn.id,params:D},{id:wn.id,params:w},{id:dn.id,params:O},...N.undos];return Xn(H,$).result&&t.get(At).pushUndoRedo({unitID:u,undoMutations:X,redoMutations:H}),!0}},uB="sheet.command.remove-row",M0={type:se.COMMAND,id:uB,handler:async(t,e)=>{var n;const r=t.get(ut),i=t.get(En);let o=e==null?void 0:e.range;if(o||(o=(n=r.getLast())==null?void 0:n.range),!o)return!1;const s=t.get(oe).getCurrentUniverSheetInstance(),a=s.getActiveSheet(),l=s.getUnitId(),u=a.getSheetId();o={...o,startColumn:0,endColumn:Math.max(a.getMaxColumns()-1,0)};const c={unitId:l,subUnitId:u,range:o},d=HMe(c,a),h={unitId:l,subUnitId:u,range:o,shiftDimension:sr.ROWS},f=ff(t,h);if(!f)return!1;const m=i.onCommandExecute({id:M0.id,params:{range:o}}),p=t.get(le);return Xn([{id:yo.id,params:h},{id:$l.id,params:c},...m.redos],p).result?(t.get(At).pushUndoRedo({unitID:l,undoMutations:[...m.undos,{id:qu.id,params:d},{id:So.id,params:f}],redoMutations:[{id:yo.id,params:h},{id:$l.id,params:c},...m.redos]}),!0):!1}},cB="sheet.command.remove-col",O0={type:se.COMMAND,id:cB,handler:async(t,e)=>{var n;const r=t.get(ut),i=t.get(En);let o=e==null?void 0:e.range;if(o||(o=(n=r.getLast())==null?void 0:n.range),!o)return!1;const s=t.get(oe).getCurrentUniverSheetInstance(),a=s.getActiveSheet(),l=s.getUnitId(),u=a.getSheetId();o={...o,startRow:0,endRow:Math.max(a.getMaxRows()-1,0)};const c={unitId:l,subUnitId:u,range:o},d=VMe(t,c),h={unitId:l,subUnitId:u,range:o,shiftDimension:sr.COLUMNS},f=ff(t,h);if(!f)throw new Error;const m=i.onCommandExecute({id:O0.id,params:{range:o}}),p=t.get(le);return Xn([{id:kl.id,params:c},{id:yo.id,params:h},...m.redos],p).result?(t.get(At).pushUndoRedo({unitID:l,undoMutations:[...m.undos,{id:Qu.id,params:d},{id:So.id,params:f}],redoMutations:[{id:kl.id,params:c},{id:yo.id,params:h},...m.redos]}),!0):!1}},pf={id:"sheet.command.remove-sheet",type:se.COMMAND,handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe),o=t.get(En);let s=i.getCurrentUniverSheetInstance().getUnitId(),a=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();e&&(s=e.unitId??s,a=e.subUnitId??a);const l=i.getUniverSheetInstance(s);if(!l)return!1;const u=l.getSheetBySheetId(a);if(!u||l.getSheets().length<=1)return!1;const c=l.getSheetIndex(u);l.getConfig().sheetOrder[c+1];const d={subUnitId:a,unitId:s},h=UMe(t,d),f=o.onCommandExecute({id:pf.id,params:{unitId:s,subUnitId:a}}),m=[{id:Zs.id,params:d},...f.redos],p=[...f.undos,{id:ps.id,params:h}];return Xn(m,n)?(r.pushUndoRedo({unitID:s,undoMutations:p,redoMutations:m}),!0):!1}},dB={type:se.COMMAND,id:"sheet.command.remove-worksheet-merge",handler:async t=>{const e=t.get(ut),n=t.get(le),r=t.get(At),i=t.get(oe),o=e.getSelectionRanges();if(!(o!=null&&o.length))return!1;const s=i.getCurrentUniverSheetInstance().getUnitId(),a=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),l=i.getUniverSheetInstance(s);if(!l)return!1;const u=l.getSheetBySheetId(a);if(!u)return!1;const c={unitId:s,subUnitId:a,ranges:o};let d=!1;const h=u.getConfig().mergeData;if(o.forEach(m=>{h.forEach(p=>{pt.intersects(m,p)&&(d=!0)})}),!d)return!1;const f=Ai(t,c);return n.syncExecuteCommand(Rn.id,c)?(r.pushUndoRedo({unitID:s,undoMutations:[{id:wn.id,params:f}],redoMutations:[{id:Rn.id,params:c}]}),!0):!1}};let Nl=class{constructor(){Jn(this,"_borderInfo",{type:Wr.ALL,color:"#000000",style:wt.THIN,activeBorderType:!1}),Jn(this,"_borderInfo$",new rn(this._borderInfo)),Jn(this,"borderInfo$",this._borderInfo$.asObservable())}dispose(){this._borderInfo$.complete()}setType(e){this._borderInfo.type=e,this.setActiveBorderType(!0),this.refresh()}setColor(e){this._borderInfo.color=e,this.refresh()}setStyle(e){this._borderInfo.style=e,this.refresh()}setActiveBorderType(e){this._borderInfo.activeBorderType=e}getBorderInfo(){return this._borderInfo}refresh(){this._borderInfo$.next(this._borderInfo)}};function G7(t,e){const{startRow:n,startColumn:r,endRow:i,endColumn:o}=t;for(let s=n;s<=i;s++)for(let a=r;a<=o;a++)e(s,a)}const m_={id:"sheet.command.set-border-basic",type:se.COMMAND,handler:async(t,e)=>{const{type:n,color:r,style:i}=e.value,o=t.get(le),s=t.get(Nl);return s.setType(n),s.setColor(r),s.setStyle(i),o.executeCommand(vc.id)}},GMe={id:"sheet.command.set-border-position",type:se.COMMAND,handler:async(t,e)=>{if(!e.value)return!1;const n=t.get(le);return t.get(Nl).setType(e.value),n.executeCommand(vc.id)}},KMe={id:"sheet.command.set-border-style",type:se.COMMAND,handler:async(t,e)=>{const n=t.get(le);return t.get(Nl).setStyle(e.value),n.executeCommand(vc.id)}},ZMe={id:"sheet.command.set-border-color",type:se.COMMAND,handler:async(t,e)=>{const n=t.get(le);return t.get(Nl).setColor(e.value),n.executeCommand(vc.id)}},vc={id:"sheet.command.set-border",type:se.COMMAND,handler:async t=>{const e=t.get(le),n=t.get(At),r=t.get(oe),i=t.get(ut),o=t.get(Nl),s=i.getSelectionRanges(),a=r.getCurrentUniverSheetInstance(),l=a.getUnitId(),u=a.getActiveSheet(),c=u.getSheetId(),d=u.getConfig().mergeData;if(!(s!=null&&s.length))return!1;const{style:h,color:f,type:m,activeBorderType:p}=o.getBorderInfo();if(!p)return!1;const g=m===Wr.TOP||m===Wr.ALL||m===Wr.OUTSIDE,v=m===Wr.LEFT||m===Wr.ALL||m===Wr.OUTSIDE,_=m===Wr.BOTTOM||m===Wr.ALL||m===Wr.OUTSIDE,C=m===Wr.RIGHT||m===Wr.ALL||m===Wr.OUTSIDE,y=m===Wr.VERTICAL||m===Wr.ALL||m===Wr.INSIDE,S=m===Wr.HORIZONTAL||m===Wr.ALL||m===Wr.INSIDE,E=m.indexOf("tlbr")>-1,w=m.indexOf("tlbc")>-1,R=m.indexOf("tlmr")>-1,D=m.indexOf("bltr")>-1,I=m.indexOf("mltr")>-1,k=m.indexOf("bctr")>-1,O=s[0],$={startRow:O.startRow-1,startColumn:O.startColumn,endRow:O.startRow-1,endColumn:O.endColumn},N={startRow:O.startRow,startColumn:O.startColumn-1,endRow:O.endRow,endColumn:O.startColumn-1},H={startRow:O.endRow+1,startColumn:O.startColumn,endRow:O.endRow+1,endColumn:O.endColumn},X={startRow:O.startRow,startColumn:O.endColumn+1,endRow:O.endRow,endColumn:O.endColumn+1},te={startRow:O.startRow,startColumn:O.startColumn,endRow:O.startRow,endColumn:O.endColumn},z={startRow:O.startRow,startColumn:O.startColumn,endRow:O.endRow,endColumn:O.startColumn},A={startRow:O.endRow,startColumn:O.startColumn,endRow:O.endRow,endColumn:O.endColumn},T={startRow:O.startRow,startColumn:O.endColumn,endRow:O.endRow,endColumn:O.endColumn},P=new nt,K={s:h,cl:{rgb:f}},ee=(Q,re)=>{let Se=null;return d.forEach(_e=>{pt.intersects(_e,{startColumn:re,endColumn:re,startRow:Q,endRow:Q})&&(Se=_e)}),Se};function ue(Q,re,Se){Q.startRow<0||Q.startColumn<0||G7(Q,(_e,He)=>{var Ne,we;const Me=ee(_e,He);let mt=re;if(Me){if(Se){const vt=De.deepClone((Ne=P.getValue(Me.startRow,Me.startColumn))==null?void 0:Ne.s);mt=vt!=null&&vt.bd?Object.assign(vt.bd,re):re}P.setValue(Me.startRow,Me.startColumn,{s:{bd:mt}})}else{if(Se){const vt=De.deepClone((we=P.getValue(_e,He))==null?void 0:we.s);mt=vt!=null&&vt.bd?Object.assign(vt.bd,re):re}P.setValue(_e,He,{s:{bd:mt}})}})}g&&ue(te,{t:De.deepClone(K)},!0),_&&ue(A,{b:De.deepClone(K)},!0),v&&ue(z,{l:De.deepClone(K)},!0),C&&ue(T,{r:De.deepClone(K)},!0),E&&ue(O,{tl_br:De.deepClone(K)},!0),w&&ue(O,{tl_bc:De.deepClone(K)},!0),R&&ue(O,{tl_mr:De.deepClone(K)},!0),D&&ue(O,{bl_tr:De.deepClone(K)},!0),I&&ue(O,{ml_tr:De.deepClone(K)},!0),k&&ue(O,{bc_tr:De.deepClone(K)},!0),y&&G7(O,(Q,re)=>{var Se,_e,He,Ne;const we=ee(Q,re);if(we){if(we.endColumn!==O.endColumn){const Me=(Se=P.getValue(we.startRow,we.startColumn))==null?void 0:Se.s;P.setValue(Q,re,{s:{bd:Me!=null&&Me.bd?Object.assign(Me.bd,{r:De.deepClone(K)}):{r:De.deepClone(K)}}})}if(we.startColumn!==O.startColumn){const Me=(_e=P.getValue(we.startRow,we.startColumn))==null?void 0:_e.s;P.setValue(Q,re,{s:{bd:Me!=null&&Me.bd?Object.assign(Me.bd,{l:De.deepClone(K)}):{l:De.deepClone(K)}}})}}else{if(re!==O.endColumn){const Me=(He=P.getValue(Q,re))==null?void 0:He.s;P.setValue(Q,re,{s:{bd:Me!=null&&Me.bd?Object.assign(Me.bd,{r:De.deepClone(K)}):{r:De.deepClone(K)}}})}if(re!==O.startColumn){const Me=(Ne=P.getValue(Q,re))==null?void 0:Ne.s;P.setValue(Q,re,{s:{bd:Me!=null&&Me.bd?Object.assign(Me.bd,{l:De.deepClone(K)}):{l:De.deepClone(K)}}})}}}),S&&G7(O,(Q,re)=>{var Se,_e,He,Ne;const we=ee(Q,re);if(we){if(we.endRow!==O.endRow){const Me=(Se=P.getValue(we.startRow,we.startColumn))==null?void 0:Se.s;P.setValue(Q,re,{s:{bd:Me!=null&&Me.bd?Object.assign(Me.bd,{b:De.deepClone(K)}):{b:De.deepClone(K)}}})}if(we.startRow!==O.startRow){const Me=(_e=P.getValue(we.startRow,we.startColumn))==null?void 0:_e.s;P.setValue(Q,re,{s:{bd:Me!=null&&Me.bd?Object.assign(Me.bd,{t:De.deepClone(K)}):{t:De.deepClone(K)}}})}}else{if(Q!==O.endRow){const Me=(He=P.getValue(Q,re))==null?void 0:He.s;P.setValue(Q,re,{s:{bd:Me!=null&&Me.bd?Object.assign(Me.bd,{b:De.deepClone(K)}):{b:De.deepClone(K)}}})}if(Q!==O.startRow){const Me=(Ne=P.getValue(Q,re))==null?void 0:Ne.s;P.setValue(Q,re,{s:{bd:Me!=null&&Me.bd?Object.assign(Me.bd,{t:De.deepClone(K)}):{t:De.deepClone(K)}}})}}}),!g&&!_&&!v&&!C&&!y&&!S&&!E&&!w&&!R&&!D&&!I&&!k&&(ue($,{b:null}),ue(te,{t:null},!0),ue(H,{t:null}),ue(A,{b:null},!0),ue(N,{r:null}),ue(z,{l:null},!0),ue(X,{l:null}),ue(T,{r:null},!0),ue(O,{tl_br:null},!0),ue(O,{tl_bc:null},!0),ue(O,{tl_mr:null},!0),ue(O,{bl_tr:null},!0),ue(O,{ml_tr:null},!0),ue(O,{bc_tr:null},!0),G7(O,(Q,re)=>{var Se,_e,He,Ne,we,Me,mt,vt;const ft=ee(Q,re);if(ft){if(ft.endColumn!==O.endColumn){const et=(Se=P.getValue(ft.startRow,ft.startColumn))==null?void 0:Se.s;P.setValue(Q,re,{s:{bd:et!=null&&et.bd?Object.assign(et.bd,{r:null}):{r:null}}})}if(ft.startColumn!==O.startColumn){const et=(_e=P.getValue(ft.startRow,ft.startColumn))==null?void 0:_e.s;P.setValue(Q,re,{s:{bd:et!=null&&et.bd?Object.assign(et.bd,{l:null}):{l:null}}})}if(ft.endRow!==O.endRow){const et=(He=P.getValue(ft.startRow,ft.startColumn))==null?void 0:He.s;P.setValue(Q,re,{s:{bd:et!=null&&et.bd?Object.assign(et.bd,{b:null}):{b:null}}})}if(ft.startRow!==O.startRow){const et=(Ne=P.getValue(ft.startRow,ft.startColumn))==null?void 0:Ne.s;P.setValue(Q,re,{s:{bd:et!=null&&et.bd?Object.assign(et.bd,{t:null}):{t:null}}})}}else{if(re!==O.endColumn){const et=(we=P.getValue(Q,re))==null?void 0:we.s;P.setValue(Q,re,{s:{bd:et!=null&&et.bd?Object.assign(et.bd,{r:null}):{r:null}}})}if(re!==O.startColumn){const et=(Me=P.getValue(Q,re))==null?void 0:Me.s;P.setValue(Q,re,{s:{bd:et!=null&&et.bd?Object.assign(et.bd,{l:null}):{l:null}}})}if(Q!==O.endRow){const et=(mt=P.getValue(Q,re))==null?void 0:mt.s;P.setValue(Q,re,{s:{bd:et!=null&&et.bd?Object.assign(et.bd,{b:null}):{b:null}}})}if(Q!==O.startRow){const et=(vt=P.getValue(Q,re))==null?void 0:vt.s;P.setValue(Q,re,{s:{bd:et!=null&&et.bd?Object.assign(et.bd,{t:null}):{t:null}}})}}}));const fe={unitId:l,subUnitId:c,cellValue:P.getData()},Ee=Bi(t,fe);return e.syncExecuteCommand(Pt.id,fe)?(n.pushUndoRedo({unitID:l,undoMutations:[{id:Pt.id,params:Ee}],redoMutations:[{id:Pt.id,params:fe}]}),!0):!1}},qMe=(t,e)=>{if(t.get(oe).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},Ju={id:"sheet.mutation.set-col-hidden",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(!n)return!1;const r=n.getSheetBySheetId(e.subUnitId).getColumnManager();for(let i=0;i<e.ranges.length;i++){const o=e.ranges[i];for(let s=o.startColumn;s<o.endColumn+1;s++){const a=r.getColumnOrCreate(s);a!=null&&(a.hd=ke.TRUE)}}return!0}},QMe=(t,e)=>{if(t.get(oe).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},ec={id:"sheet.mutation.set-col-visible",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(!n)return!1;const r=n.getSheetBySheetId(e.subUnitId).getColumnManager();for(let i=0;i<e.ranges.length;i++){const o=e.ranges[i];for(let s=o.startColumn;s<o.endColumn+1;s++){const a=r.getColumnOrCreate(s);a!=null&&(a.hd=ke.FALSE)}}return!0}},_y={type:se.COMMAND,id:"sheet.command.set-col-visible-on-cols",handler:async(t,e)=>{const{unitId:n,subUnitId:r,ranges:i}=e,o=t.get(oe).getUniverSheetInstance(n).getSheetBySheetId(r),s={unitId:n,subUnitId:r,ranges:i},a=QMe(t,s),l={unitId:n,subUnitId:r,pluginName:On,selections:i.map(d=>({range:d,primary:qs(d,o),style:null}))},u={unitId:n,subUnitId:r,pluginName:On,selections:fB(i).map(d=>({range:d,primary:qs(d,o),style:null}))},c=t.get(le);return Xn([{id:ec.id,params:s},{id:dn.id,params:l}],c).result&&t.get(At).pushUndoRedo({unitID:n,undoMutations:[{id:Ju.id,params:a},{id:dn.id,params:u}],redoMutations:[{id:ec.id,params:s},{id:dn.id,params:l}]}),!0}},hB={type:se.COMMAND,id:"sheet.command.set-selected-cols-visible",handler:async t=>{var e;const n=(e=t.get(ut).getSelections())==null?void 0:e.map(l=>l.range).filter(l=>l.rangeType===Rt.COLUMN);if(!(n!=null&&n.length))return!1;const r=t.get(oe).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),s=i.getSheetId(),a=n.map(l=>i.getHiddenCols(l.startColumn,l.endColumn)).flat();return t.get(le).executeCommand(_y.id,{unitId:o,subUnitId:s,ranges:a})}},by={type:se.COMMAND,id:"sheet.command.set-col-hidden",handler:async t=>{var e;const n=(e=t.get(ut).getSelections())==null?void 0:e.map(d=>d.range).filter(d=>d.rangeType===Rt.COLUMN);if(!(n!=null&&n.length))return!1;const r=t.get(oe).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),s=i.getSheetId(),a={unitId:o,subUnitId:s,ranges:n},l={unitId:o,subUnitId:s,pluginName:On,selections:fB(n).map(d=>({range:d,primary:qs(d,i),style:null}))},u={unitId:o,subUnitId:s,pluginName:On,selections:n.map(d=>({range:d,primary:qs(d,i),style:null}))},c=t.get(le);if(Xn([{id:Ju.id,params:a},{id:dn.id,params:l}],c).result){const d=t.get(At),h=qMe(t,a);return d.pushUndoRedo({unitID:o,undoMutations:[{id:ec.id,params:h},{id:dn.id,params:u}],redoMutations:[{id:Ju.id,params:a},{id:dn.id,params:l}]}),!0}return!1}};function fB(t){return JMe(t).map(e=>{const n=e.startColumn===0?e.endColumn+1:e.startColumn-1;return{...e,startColumn:n,endColumn:n}})}function JMe(t){const e=[];let n;return t.sort((r,i)=>r.startColumn-i.startColumn).forEach(r=>{if(!n){n=r;return}n.endColumn===r.startColumn-1?n.endColumn=r.endColumn:(e.push(n),n=r)}),e.push(n),e}const gf=(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(r==null)throw new Error("worksheet is null error!");const i=r.getConfig().freeze;return{unitId:e.unitId,subUnitId:e.subUnitId,...i}},vo={id:"sheet.mutation.set-frozen",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(!r)return!1;const i=r.getConfig(),{startRow:o,startColumn:s,ySplit:a,xSplit:l}=e;return i.freeze={startRow:o,startColumn:s,ySplit:a,xSplit:l},!0}},mB={type:se.COMMAND,id:"sheet.command.set-frozen",handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe),o=i.getCurrentUniverSheetInstance().getUnitId(),s=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),a=i.getUniverSheetInstance(o);if(!a)return!1;const l=a.getSheetBySheetId(s);if(!l)return!1;const{startColumn:u,startRow:c,xSplit:d,ySplit:h}=e;if(c>=l.getRowCount()||u>=l.getColumnCount()||d>=l.getColumnCount()||h>=l.getRowCount())return!1;const f={unitId:o,subUnitId:s,...e},m=gf(t,f);return n.syncExecuteCommand(vo.id,f)?(r.pushUndoRedo({unitID:o,undoMutations:[{id:vo.id,params:m}],redoMutations:[{id:vo.id,params:f}]}),!0):!1}},eOe={type:se.COMMAND,id:"sheet.command.set-frozen-cancel",handler:async t=>{const e=t.get(le),n=t.get(At),r=t.get(oe),i=r.getCurrentUniverSheetInstance().getUnitId(),o=r.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),s=r.getUniverSheetInstance(i);if(!s||!s.getSheetBySheetId(o))return!1;const a={unitId:i,subUnitId:o,startRow:-1,startColumn:-1,ySplit:0,xSplit:0},l=gf(t,a);return e.syncExecuteCommand(vo.id,a)?(n.pushUndoRedo({unitID:i,undoMutations:[{id:vo.id,params:l}],redoMutations:[{id:vo.id,params:a}]}),!0):!1}},Oa={id:"sheet.command.set-range-values",type:se.COMMAND,handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe),o=t.get(ut),s=t.get(En),{value:a,range:l,unitId:u=i.getCurrentUniverSheetInstance().getUnitId(),subUnitId:c=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId()}=e,d=l?[l]:o.getSelectionRanges();if(!d||!d.length)return!1;const h=new nt;let f;if(De.isArray(a))for(let y=0;y<d.length;y++){const{startRow:S,startColumn:E,endRow:w,endColumn:R}=d[y];for(let D=0;D<=w-S;D++)for(let I=0;I<=R-E;I++)h.setValue(D+S,I+E,a[D][I])}else if(qx(a))for(let y=0;y<d.length;y++){const{startRow:S,startColumn:E}=d[y];h.setValue(S,E,a)}else f=a;const m={subUnitId:c,unitId:u,cellValue:f??h.getMatrix()},p=Bi(t,m);if(!s.fetchThroughInterceptors(Ra.PERMISSION)(null,{id:Oa.id,params:m}))return!1;const g=n.syncExecuteCommand(Pt.id,m),{undos:v,redos:_}=s.onCommandExecute({id:Oa.id,params:{...m,range:d}}),C=await Xn([..._],n);return g&&C.result?(r.pushUndoRedo({unitID:u,undoMutations:[{id:Pt.id,params:p},...v],redoMutations:[{id:Pt.id,params:m},..._]}),!0):!1}},tOe=(t,e)=>{if(t.get(oe).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},tc={id:"sheet.mutation.set-row-visible",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId).getRowManager();for(let i=0;i<e.ranges.length;i++){const o=e.ranges[i];for(let s=o.startRow;s<o.endRow+1;s++){const a=r.getRowOrCreate(s);a!=null&&(a.hd=0)}}return!0}},nOe=(t,e)=>{if(t.get(oe).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},nc={id:"sheet.mutation.set-row-hidden",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId).getRowManager();for(let i=0;i<e.ranges.length;i++){const o=e.ranges[i];for(let s=o.startRow;s<o.endRow+1;s++){const a=r.getRowOrCreate(s);a!=null&&(a.hd=1)}}return!0}},Cy={type:se.COMMAND,id:"sheet.command.set-specific-rows-visible",handler:async(t,e)=>{const{unitId:n,subUnitId:r,ranges:i}=e,o=t.get(le),s=t.get(At),a=t.get(oe).getUniverSheetInstance(n).getSheetBySheetId(r),l={unitId:n,subUnitId:r,ranges:i},u=tOe(t,l),c={unitId:n,subUnitId:r,pluginName:On,selections:i.map(h=>({range:h,primary:qs(h,a),style:null}))},d={unitId:n,subUnitId:r,pluginName:On,selections:gB(i).map(h=>({range:h,primary:qs(h,a),style:null}))};return Xn([{id:tc.id,params:l},{id:dn.id,params:c}],o).result&&s.pushUndoRedo({unitID:n,undoMutations:[{id:nc.id,params:u},{id:dn.id,params:d}],redoMutations:[{id:tc.id,params:l},{id:dn.id,params:c}]}),!0}},pB={type:se.COMMAND,id:"sheet.command.set-selected-rows-visible",handler:async t=>{var e;const n=t.get(ut),r=t.get(oe),i=(e=n.getSelections())==null?void 0:e.map(c=>c.range).filter(c=>c.rangeType===Rt.ROW);if(!(i!=null&&i.length))return!1;const o=r.getCurrentUniverSheetInstance();if(!o)return!1;const s=o.getActiveSheet();if(!s)return!1;const a=o.getUnitId(),l=s.getSheetId(),u=i.map(c=>s.getHiddenRows(c.startRow,c.endRow)).flat();return t.get(le).executeCommand(Cy.id,{unitId:a,subUnitId:l,ranges:u})}},yy={type:se.COMMAND,id:"sheet.command.set-rows-hidden",handler:async t=>{var e;const n=t.get(ut),r=t.get(le),i=t.get(At),o=t.get(oe),s=(e=n.getSelections())==null?void 0:e.map(p=>p.range).filter(p=>p.rangeType===Rt.ROW);if(!(s!=null&&s.length))return!1;const a=o.getCurrentUniverSheetInstance().getUnitId(),l=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),u=o.getUniverSheetInstance(a);if(!u)return!1;const c=u.getSheetBySheetId(l);if(!c)return!1;const d={unitId:a,subUnitId:l,ranges:s},h={unitId:a,subUnitId:l,pluginName:On,selections:gB(s).map(p=>({range:p,primary:qs(p,c),style:null}))},f={unitId:a,subUnitId:l,pluginName:On,selections:s.map(p=>({range:p,primary:qs(p,c),style:null}))},m=nOe(t,d);return Xn([{id:nc.id,params:d},{id:dn.id,params:h}],r).result&&i.pushUndoRedo({unitID:a,undoMutations:[{id:tc.id,params:m},{id:dn.id,params:f}],redoMutations:[{id:nc.id,params:d},{id:dn.id,params:h}]}),!0}};function gB(t){return rOe(t).map(e=>{const n=e.startRow===0?e.endRow+1:e.startRow-1;return{...e,startRow:n,endRow:n}})}function rOe(t){const e=[];let n;return t.sort((r,i)=>r.startRow-i.startRow).forEach(r=>{if(!n){n=r;return}r.startRow===n.endRow+1?n.endRow=r.endRow:(e.push(n),n=r)}),e.push(n),e}const qr={type:se.COMMAND,id:"sheet.command.set-style",handler:async(t,e)=>{const n=t.get(oe),{unitId:r=n.getCurrentUniverSheetInstance().getUnitId(),subUnitId:i=n.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),range:o,style:s}=e,a=t.get(le),l=t.get(At),u=t.get(ut),c=o?[o]:u.getSelectionRanges();if(!(c!=null&&c.length))return!1;const d=n.getUniverSheetInstance(r);if((d==null?void 0:d.getSheetBySheetId(i))==null)return!1;const h=new nt;if(De.isArray(s.value))for(let C=0;C<c.length;C++){const{startRow:y,endRow:S,startColumn:E,endColumn:w}=c[C];for(let R=0;R<=S-y;R++)for(let D=0;D<=w-E;D++)h.setValue(R+y,D+E,{s:{[s.type]:s.value[R][D]}})}else for(let C=0;C<c.length;C++){const{startRow:y,endRow:S,startColumn:E,endColumn:w}=c[C],R={s:{[s.type]:s.value}};for(let D=y;D<=S;D++)for(let I=E;I<=w;I++)h.setValue(D,I,R)}const f={subUnitId:i,unitId:r,cellValue:h.getMatrix()},m=Bi(t,f),p=a.syncExecuteCommand(Pt.id,f),{undos:g,redos:v}=t.get(En).onCommandExecute({id:qr.id,params:e}),_=Xn([...v],a);return p&&_.result?(l.pushUndoRedo({unitID:r,undoMutations:[{id:Pt.id,params:m},...g],redoMutations:[{id:Pt.id,params:f},...v]}),!0):!1}},vB={type:se.COMMAND,id:"sheet.command.set-bold",handler:async t=>{const e=t.get(ut).getLast();if(!e)return!1;const n=t.get(oe).getCurrentUniverSheetInstance().getActiveSheet(),{actualRow:r,actualColumn:i}=e.primary,o={style:{type:"bl",value:n.getRange(r,i).getFontWeight()===N2.BOLD?ke.FALSE:ke.TRUE}};return t.get(le).executeCommand(qr.id,o)}},_B={type:se.COMMAND,id:"sheet.command.set-italic",handler:async t=>{const e=t.get(ut).getLast();if(!e)return!1;const n=t.get(oe).getCurrentUniverSheetInstance().getActiveSheet();let r=!0;if(e.primary){const{startRow:o,startColumn:s}=e.primary;r=n.getRange(o,s).getFontStyle()===A2.ITALIC}const i={style:{type:"it",value:r?ke.FALSE:ke.TRUE}};return t.get(le).executeCommand(qr.id,i)}},bB={type:se.COMMAND,id:"sheet.command.set-underline",handler:async t=>{const e=t.get(ut).getLast();if(!e)return!1;const n=t.get(oe).getCurrentUniverSheetInstance().getActiveSheet();let r=!0;e.primary&&(r=!!n.getRange(e.primary.startRow,e.primary.startColumn).getUnderline().s);const i={style:{type:"ul",value:{s:r?ke.FALSE:ke.TRUE}}};return t.get(le).executeCommand(qr.id,i)}},CB={type:se.COMMAND,id:"sheet.command.set-stroke",handler:async t=>{const e=t.get(ut).getLast();if(!e)return!1;const n=t.get(oe).getCurrentUniverSheetInstance().getActiveSheet();let r=!0;e.primary&&(r=!!n.getRange(e.primary.actualRow,e.primary.actualColumn).getStrikeThrough().s);const i={style:{type:"st",value:{s:r?ke.FALSE:ke.TRUE}}};return t.get(le).executeCommand(qr.id,i)}};se.COMMAND;const yB={type:se.COMMAND,id:"sheet.command.set-font-family",handler:async(t,e)=>{if(!e)return!1;const n=t.get(le),r={style:{type:"ff",value:e.value}};return n.executeCommand(qr.id,r)}},SB={type:se.COMMAND,id:"sheet.command.set-font-size",handler:async(t,e)=>{if(!e)return!1;const n=t.get(le),r={style:{type:"fs",value:e.value}};return n.executeCommand(qr.id,r)}},EB={type:se.COMMAND,id:"sheet.command.set-text-color",handler:async(t,e)=>{if(!e||!e.value)return!1;const n=t.get(le),r={style:{type:"cl",value:{rgb:e.value}}};return n.executeCommand(qr.id,r)}},wB={type:se.COMMAND,id:"sheet.command.reset-text-color",handler:async t=>{const e=t.get(le),n={style:{type:"cl",value:{rgb:null}}};return e.executeCommand(qr.id,n)}},y5={type:se.COMMAND,id:"sheet.command.set-background-color",handler:async(t,e)=>{if(!e||!e.value)return!1;const n=t.get(le),r={style:{type:"bg",value:{rgb:e.value}}};return n.executeCommand(qr.id,r)}},RB={type:se.COMMAND,id:"sheet.command.reset-background-color",handler:async t=>{const e=t.get(le),n={style:{type:"bg",value:{rgb:null}}};return e.executeCommand(qr.id,n)}},p_={type:se.COMMAND,id:"sheet.command.set-vertical-text-align",handler:async(t,e)=>{if(!e)return!1;const n=t.get(le),r={style:{type:"vt",value:e.value}};return n.executeCommand(qr.id,r)}},g_={type:se.COMMAND,id:"sheet.command.set-horizontal-text-align",handler:async(t,e)=>{if(!e)return!1;const n=t.get(le),r={style:{type:"ht",value:e.value}};return n.executeCommand(qr.id,r)}},v_={type:se.COMMAND,id:"sheet.command.set-text-wrap",handler:async(t,e)=>{if(!e)return!1;const n=t.get(le),r={style:{type:"tb",value:e.value}};return n.executeCommand(qr.id,r)}},__={type:se.COMMAND,id:"sheet.command.set-text-rotation",handler:async(t,e)=>{if(!e)return!1;const n=typeof e.value=="number"?{a:e.value}:{a:0,v:ke.TRUE},r=t.get(le),i={style:{type:"tr",value:n}};return r.executeCommand(qr.id,i)}},iOe=(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId).getSheetBySheetId(e.subUnitId).getConfig().tabColor;return{...De.deepClone(e),color:n}},r6={id:"sheet.mutation.set-tab-color",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(!n)return!1;const r=n.getSheetBySheetId(e.subUnitId);return r?(r.getConfig().tabColor=e.color,!0):!1}},DB={type:se.COMMAND,id:"sheet.command.set-tab-color",handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe),o=i.getCurrentUniverSheetInstance().getUnitId(),s=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),a=i.getUniverSheetInstance(o);if(!a||!a.getSheetBySheetId(s))return!1;const l={color:e.value,unitId:o,subUnitId:s},u=iOe(t,l);return n.syncExecuteCommand(r6.id,l)?(r.pushUndoRedo({unitID:o,undoMutations:[{id:r6.id,params:u}],redoMutations:[{id:r6.id,params:l}]}),!0):!1}},ja={id:"sheet.operation.set-worksheet-active",type:se.OPERATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(!n)return!1;const r=n.getWorksheets();for(const[,i]of r)i.getSheetId()===e.subUnitId?(i.getConfig().status=ke.TRUE,n.__setActiveSheet(i)):i.getConfig().status=ke.FALSE;return!0}},T0={type:se.COMMAND,id:"sheet.command.set-worksheet-activate",handler:(t,e)=>{const n=t.get(le),r=t.get(oe);let i=r.getCurrentUniverSheetInstance().getUnitId(),o=r.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();e&&(i=e.unitId??i,o=e.subUnitId??o);const s={unitId:i,subUnitId:o};return n.syncExecuteCommand(ja.id,s)}},IB=(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(r==null)throw new Error("universheet is null error!");const i={},o=r.getColumnManager(),s=e.ranges;for(let a=0;a<s.length;a++){const l=s[a];for(let u=l.startColumn;u<l.endColumn+1;u++){const c=o.getColumnOrCreate(u);i[u]=c.w}}return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges,colWidth:i}},js={id:"sheet.mutation.set-worksheet-col-width",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(!r)return!1;const i=r.getConfig().defaultColumnWidth,o=r.getColumnManager(),s=e.ranges;for(let a=0;a<s.length;a++){const l=s[a];for(let u=l.startColumn;u<l.endColumn+1;u++){const c=o.getColumnOrCreate(u);typeof e.colWidth=="number"?c.w=e.colWidth:c.w=e.colWidth[u-l.startColumn]??i}}return!0}},vf={type:se.COMMAND,id:"sheet.command.delta-column-width",handler:async(t,e)=>{const n=t.get(ut).getSelections();if(!(n!=null&&n.length))return!1;const r=t.get(le),i=t.get(At),o=t.get(oe).getCurrentUniverSheetInstance(),s=o.getActiveSheet(),a=o.getUnitId(),l=s.getSheetId(),{anchorCol:u,deltaX:c}=e,d=s.getColumnWidth(u)+c,h=n.length===1&&n[0].range.rangeType===Rt.ALL,f=n.filter(S=>S.range.rangeType===Rt.COLUMN),m=h?Rt.ALL:f.some(({range:S})=>{const{startColumn:E,endColumn:w}=S;return E<=u&&u<=w})?Rt.COLUMN:Rt.NORMAL;let p;if(m===Rt.ALL){const S=s.getRowCount(),E=new Array(s.getColumnCount()).fill(void 0).map((w,R)=>({startRow:0,endRow:S-1,startColumn:R,endColumn:R}));p={subUnitId:l,unitId:a,colWidth:d,ranges:E}}else m===Rt.COLUMN?p={subUnitId:l,unitId:a,ranges:f.map(S=>pt.clone(S.range)),colWidth:d}:p={subUnitId:l,unitId:a,colWidth:d,ranges:[{startRow:0,endRow:s.getMaxRows()-1,startColumn:u,endColumn:u}]};const g=IB(t,p),v=r.syncExecuteCommand(js.id,p),{undos:_,redos:C}=t.get(En).onCommandExecute({id:vf.id,params:p}),y=Xn([...C],r);return v&&y.result&&i.pushUndoRedo({unitID:a,undoMutations:[{id:js.id,params:g},..._],redoMutations:[{id:js.id,params:p},...C]}),!0}},Sy={type:se.COMMAND,id:"sheet.command.set-worksheet-col-width",handler:async(t,e)=>{const n=t.get(ut),r=t.get(le),i=t.get(At),o=t.get(oe),s=n.getSelectionRanges();if(!(s!=null&&s.length))return!1;const a=o.getCurrentUniverSheetInstance().getUnitId(),l={subUnitId:o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),unitId:a,ranges:s,colWidth:e.value},u=IB(t,l),c=r.syncExecuteCommand(js.id,l),{undos:d,redos:h}=t.get(En).onCommandExecute({id:Sy.id,params:l}),f=Xn([...h],r);return c&&f.result?(i.pushUndoRedo({unitID:a,undoMutations:[{id:js.id,params:u},...d],redoMutations:[{id:js.id,params:l},...h]}),!0):!1}},xB=(t,e)=>{const n=t.get(oe).getCurrentUniverSheetInstance().getSheetBySheetId(e.subUnitId);if(n==null)throw new Error("worksheet is null error!");return{hidden:n.isSheetHidden(),unitId:e.unitId,subUnitId:n.getSheetId()}},zs={id:"sheet.mutation.set-worksheet-hidden",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)return!1;const r=n.getSheetBySheetId(e.subUnitId);return r?(r.getConfig().hidden=e.hidden,!0):!1}},MB={type:se.COMMAND,id:"sheet.command.set-worksheet-hidden",handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe),o=t.get(q6),s=i.getCurrentUniverSheetInstance().getUnitId();let a=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();e&&(a=e.subUnitId??a);const l=i.getUniverSheetInstance(s);if(!l)return!1;const u=l.getSheetBySheetId(a);if(!u||u.getConfig().hidden===ke.TRUE)return!1;const c={unitId:s,subUnitId:a,hidden:ke.TRUE},d=xB(t,c);return l.getSheets().filter(h=>h.getConfig().hidden===ke.FALSE).length===1?(o.emit("No visible sheet after you hide this."),!1):n.syncExecuteCommand(zs.id,c)?(r.pushUndoRedo({unitID:s,undoMutations:[{id:zs.id,params:d}],redoMutations:[{id:zs.id,params:c}]}),!0):!1}},oOe=(t,e)=>{const n=t.get(oe).getCurrentUniverSheetInstance().getSheetBySheetId(e.subUnitId);if(n==null)throw new Error("worksheet is null error!");return{unitId:e.unitId,name:n.getName(),subUnitId:n.getSheetId()}},Y6={id:"sheet.mutation.set-worksheet-name",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(n==null)return!1;const r=n.getSheetBySheetId(e.subUnitId);return r?(r.getConfig().name=e.name,!0):!1}},_f={type:se.COMMAND,id:"sheet.command.set-worksheet-name",handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe),o=t.get(En),s=e.unitId||i.getCurrentUniverSheetInstance().getUnitId(),a={subUnitId:e.subUnitId||i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),name:e.name,unitId:s},l=oOe(t,a),u=o.onCommandExecute({id:_f.id,params:e}),c=[{id:Y6.id,params:a},...u.redos],d=[...u.undos,{id:Y6.id,params:l}];return await Xn(c,n).result?(r.pushUndoRedo({unitID:s,undoMutations:d,redoMutations:c}),!0):!1}},sOe=(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId).getConfig().sheetOrder.findIndex(r=>r===e.subUnitId);return{...De.deepClone(e),order:n}},T2={id:"sheet.mutation.set-worksheet-order",type:se.MUTATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(!n)return!1;const r=n.getConfig(),i=r.sheetOrder.filter(o=>o!==e.subUnitId);return i.splice(e.order,0,e.subUnitId),r.sheetOrder=i,!0}},OB={type:se.COMMAND,id:"sheet.command.set-worksheet-order",handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe),o=e.unitId||i.getCurrentUniverSheetInstance().getUnitId(),s=e.subUnitId||i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),a=i.getUniverSheetInstance(o);if(!a||!a.getSheetBySheetId(s))return!1;const l={order:e.order,unitId:o,subUnitId:s},u=sOe(t,l);return n.syncExecuteCommand(T2.id,l)?(r.pushUndoRedo({unitID:o,undoMutations:[{id:T2.id,params:u}],redoMutations:[{id:T2.id,params:l}]}),!0):!1}},aOe=2e3,TB=(t,e)=>{const{unitId:n,subUnitId:r,ranges:i}=e,o=t.get(oe).getUniverSheetInstance(n),s=o==null?void 0:o.getSheetBySheetId(r);if(s==null)throw new Error("worksheet is null error!");const a={},l=s.getRowManager();for(const{startRow:u,endRow:c}of i)for(let d=u;d<c+1;d++){const h=l.getRowOrCreate(d);a[d]=h.h}return{unitId:n,subUnitId:r,ranges:i,rowHeight:a}},Ey=(t,e)=>{const{unitId:n,subUnitId:r,ranges:i}=e,o=t.get(oe).getUniverSheetInstance(n).getSheetBySheetId(r),s={},a=o.getRowManager();for(const{startRow:l,endRow:u}of i)for(let c=l;c<=u;c++){const d=a.getRowOrCreate(c);s[c]=d.isAutoHeight}return{unitId:n,subUnitId:r,ranges:i,autoHeightInfo:s}},lOe=(t,e)=>{const{unitId:n,subUnitId:r,rowsAutoHeightInfo:i}=e,o=t.get(oe).getUniverSheetInstance(n),s=o==null?void 0:o.getSheetBySheetId(r),a=[],l=s.getRowManager();for(const u of i){const{row:c}=u,{ah:d}=l.getRowOrCreate(c);a.push({row:c,autoHeight:d})}return{unitId:n,subUnitId:r,rowsAutoHeightInfo:a}},d1={id:"sheet.mutation.set-worksheet-row-height",type:se.MUTATION,handler:(t,e)=>{const{unitId:n,subUnitId:r,ranges:i,rowHeight:o}=e,s=t.get(oe).getUniverSheetInstance(n),a=s==null?void 0:s.getSheetBySheetId(r);if(!a)return!1;const l=a.getConfig().defaultRowHeight,u=a.getRowManager();for(const{startRow:c,endRow:d}of i)for(let h=c;h<=d;h++){const f=u.getRowOrCreate(h);typeof o=="number"?f.h=o:f.h=o[h]??l,f.h=Math.min(aOe,f.h)}return!0}},Ws={id:"sheet.mutation.set-worksheet-row-is-auto-height",type:se.MUTATION,handler:(t,e)=>{const{unitId:n,subUnitId:r,ranges:i,autoHeightInfo:o}=e,s=t.get(oe).getUniverSheetInstance(n),a=s==null?void 0:s.getSheetBySheetId(r);if(!a)return!1;const l=void 0,u=a.getRowManager();for(const{startRow:c,endRow:d}of i)for(let h=c;h<=d;h++){const f=u.getRowOrCreate(h);typeof o=="boolean"?f.isAutoHeight=o:f.isAutoHeight=o[h-c]??l}return!0}},G6={id:"sheet.mutation.set-worksheet-row-auto-height",type:se.MUTATION,handler:(t,e)=>{const{unitId:n,subUnitId:r,rowsAutoHeightInfo:i}=e,o=t.get(oe).getUniverSheetInstance(n),s=o==null?void 0:o.getSheetBySheetId(r);if(!s||!o)return!1;const a=s.getRowManager();for(const{row:l,autoHeight:u}of i){const c=a.getRowOrCreate(l);c.ah=u}return!0}},wy={type:se.COMMAND,id:"sheet.command.delta-row-height",handler:async(t,e)=>{const n=t.get(ut).getSelections();if(!(n!=null&&n.length))return!1;const r=t.get(oe).getCurrentUniverSheetInstance(),i=r.getActiveSheet(),o=r.getUnitId(),s=i.getSheetId(),{anchorRow:a,deltaY:l}=e,u=i.getRowHeight(a)+l,c=n.length===1&&n[0].range.rangeType===Rt.ALL,d=n.filter(C=>C.range.rangeType===Rt.ROW),h=c?Rt.ALL:d.some(({range:C})=>{const{startRow:y,endRow:S}=C;return y<=a&&a<=S})?Rt.ROW:Rt.NORMAL;let f;if(h===Rt.ALL){const C=i.getRowCount(),y=new Array(i.getColumnCount()).fill(void 0).map((S,E)=>({startRow:E,endRow:E,startColumn:0,endColumn:C-1}));f={subUnitId:s,unitId:o,rowHeight:u,ranges:y}}else h===Rt.ROW?f={subUnitId:s,unitId:o,ranges:d.map(C=>pt.clone(C.range)),rowHeight:u}:f={subUnitId:s,unitId:o,rowHeight:u,ranges:[{startRow:a,endRow:a,startColumn:0,endColumn:i.getMaxColumns()-1}]};const m=TB(t,f),p={unitId:o,subUnitId:s,ranges:f.ranges,autoHeightInfo:!1},g=Ey(t,p),v=t.get(le),_=t.get(At);return(await Xn([{id:d1.id,params:f},{id:Ws.id,params:p}],v)).result?(_.pushUndoRedo({unitID:o,undoMutations:[{id:d1.id,params:m},{id:Ws.id,params:g}],redoMutations:[{id:d1.id,params:f},{id:Ws.id,params:p}]}),!0):!1}},$B={type:se.COMMAND,id:"sheet.command.set-row-height",handler:(t,e)=>{const n=t.get(ut),r=t.get(le),i=t.get(At),o=t.get(oe),s=n.getSelectionRanges();if(!(s!=null&&s.length))return!1;const a=o.getCurrentUniverSheetInstance(),l=a.getUnitId(),u=a.getActiveSheet().getSheetId(),c={subUnitId:u,unitId:l,ranges:s,rowHeight:e.value},d=TB(t,c),h={unitId:l,subUnitId:u,ranges:c.ranges,autoHeightInfo:!1},f=Ey(t,h);return Xn([{id:d1.id,params:c},{id:Ws.id,params:h}],r).result?(i.pushUndoRedo({unitID:l,undoMutations:[{id:d1.id,params:d},{id:Ws.id,params:f}],redoMutations:[{id:d1.id,params:c},{id:Ws.id,params:h}]}),!0):!1}},U4={type:se.COMMAND,id:"sheet.command.set-row-is-auto-height",handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(ut),o=t.get(oe),s=o.getCurrentUniverSheetInstance().getUnitId(),a=o.getCurrentUniverSheetInstance().getActiveSheet(),l=a.getSheetId(),{anchorRow:u}=e??{},c=u!=null?[{startRow:u,endRow:u,startColumn:0,endColumn:a.getMaxColumns()-1}]:i.getSelectionRanges();if(!(c!=null&&c.length))return!1;const d={unitId:s,subUnitId:l,ranges:c,autoHeightInfo:!0},h=Ey(t,d),f=n.syncExecuteCommand(Ws.id,d),{undos:m,redos:p}=t.get(En).onCommandExecute({id:U4.id,params:d}),g=Xn([...p],n);return f&&g.result?(r.pushUndoRedo({unitID:s,undoMutations:[{id:Ws.id,params:h},...m],redoMutations:[{id:Ws.id,params:d},...p]}),!0):!1}},kB={type:se.COMMAND,id:"sheet.command.set-worksheet-show",handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe),o=i.getCurrentUniverSheetInstance().getUnitId();let s=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();e&&(s=e.value??s);const a=i.getUniverSheetInstance(o);if(!a)return!1;const l=a.getSheetBySheetId(s);if(!l||l.getConfig().hidden===ke.FALSE)return!1;const u={unitId:o,subUnitId:s,hidden:ke.FALSE},c=xB(t,u),d=n.syncExecuteCommand(zs.id,u),h={unitId:o,subUnitId:s},f=n.syncExecuteCommand(ja.id,h);return d&&f?(r.pushUndoRedo({unitID:o,undoMutations:[{id:zs.id,params:c}],redoMutations:[{id:zs.id,params:u}]}),!0):!1}},uOe=t=>{const e=new nt;return t.forEach(n=>{Er.foreach(n,(r,i)=>{e.setValue(r,i,1)})}),e.forValue((n,r)=>{const i=e.getValue(n-1,r);i&&e.setValue(n,r,i+1)}),e},AD=t=>{const e={area:0},n=(r,i)=>e.area<r?(e.area=r,e.range=i,!0):!1;return t.forValue((r,i,o)=>{let s=1,a=o;n(s*a,{startRow:r-a+1,endRow:r,startColumn:i,endColumn:i});const l={startRow:r-a+1,endRow:r,startColumn:0,endColumn:i};for(let u=i-1;u>=0&&t.getValue(r,u);u--){a=Math.min(t.getValue(r,u)||0,a),s++;const c=a*s;l.startColumn=u,l.startRow=r-a+1,n(c,l)}}),e},cOe=(t,e)=>(Er.foreach(e,(n,r)=>{t.realDeleteValue(n,r);let i=n+1,o=t.getValue(i,r)||0;for(;o>1;)t.setValue(i,r,o-1),i+=1,o=t.getValue(i,r)||0}),t),dOe=t=>{const e=[];let n=AD(t);for(;n.area>0;)n.range&&(e.push(n.range),cOe(t,n.range)),n=AD(t);return e},Ta=t=>{const e=uOe(t);return dOe(e)},hOe=(t,e,n="")=>t.reduce((r,i)=>{const o=i&&i[e];return typeof o!="string"?(console.log(i,`${e} is not string`),r):(o?(r[o]||(r[o]=[]),r[o].push(i)):r[n].push(i),r)},{}),fOe=(t=0)=>{let e=t;return function(){return e++}},eo=nn("INumfmtService");V5(it.Rendered,eo);const H4=(t,e)=>{const n=t.get(eo),{values:r,unitId:i,subUnitId:o}=e,s=[],a=[],l=n.getModel(i,o)||void 0;Object.keys(r).forEach(c=>{r[c].ranges.forEach(d=>{Er.foreach(d,(h,f)=>{const m=n.getValue(i,o,h,f,l);m?s.push({pattern:m.pattern,type:m.type,row:h,col:f}):a.push({startColumn:f,endColumn:f,startRow:h,endRow:h})})})});const u=[];if(s){const c=Ll(i,o,s);Object.keys(c.values).forEach(d=>{const h=c.values[d];h.ranges=Ta(h.ranges)}),u.push({id:Zi.id,params:Ll(i,o,s)})}return a&&u.push({id:Fo.id,params:{unitId:i,subUnitId:o,ranges:a}}),u},Zi={id:"sheet.mutation.set.numfmt",type:se.MUTATION,handler:(t,e)=>{if(!e)return!1;const{values:n,refMap:r}=e,i=t.get(eo),o=e.unitId,s=e.subUnitId,a=Object.keys(n).reduce((l,u)=>{const c=r[u],d=n[u].ranges;return c&&l.push({...c,ranges:d}),l},[]);return i.setValues(o,s,a),!0}},Fo={id:"sheet.mutation.remove.numfmt",type:se.MUTATION,handler:(t,e)=>{if(!e)return!1;const{unitId:n,subUnitId:r,ranges:i}=e;return t.get(eo).deleteValues(n,r,i),!0}},rc=(t,e)=>{const n=t.get(eo),{ranges:r,unitId:i,subUnitId:o}=e,s=[],a=n.getModel(i,o)||void 0;r.forEach(u=>{Er.foreach(u,(c,d)=>{const h=n.getValue(i,o,c,d,a);h&&s.push({pattern:h.pattern,type:h.type,row:c,col:d})})});const l=Ll(i,o,s);return Object.keys(l.values).forEach(u=>{const c=l.values[u];c.ranges=Ta(c.ranges)}),[{id:Zi.id,params:l}]},Ll=(t,e,n)=>{const r=hOe(n,"pattern"),i={},o={},s=fOe();return Object.keys(r).forEach(a=>{const l=r[a],u=l[0],c=s();i[c]={pattern:a,type:u.type},l.forEach(d=>{o[c]||(o[c]={ranges:[]}),o[c].ranges.push(mOe(d.row,d.col))})}),{unitId:t,subUnitId:e,refMap:i,values:o}},mOe=(t,e)=>({startRow:t,endRow:t,startColumn:e,endColumn:e}),AB="maxCellsPerSheet",pOe=3e6;var gOe=Object.defineProperty,vOe=Object.getOwnPropertyDescriptor,_Oe=(t,e,n,r)=>{for(var i=r>1?void 0:r?vOe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&gOe(e,n,i),i},ND=(t,e)=>(n,r)=>e(n,r,t);let n8=class extends je{constructor(t,e){super(),this._commandService=t,this._configService=e,[wn,A4,hf,N4,KP,R0,D0,yo,vf,wy,sB,oB,pc,Qu,I0,x0,So,rB,nB,mc,qu,aB,ps,F4,i0,gc,Al,B4,r0,O0,kl,M0,$l,pf,Zs,dB,Rn,RB,wB,y5,m_,ZMe,vc,GMe,KMe,by,Ju,ec,Sy,eOe,mB,vo,g_,Oa,Pt,$B,yy,nc,tc,hB,pB,_y,Cy,qr,DB,r6,EB,__,v_,p_,T0,ja,js,MB,zs,_f,Y6,OB,T2,G6,d1,U4,Ws,kB,Zi,dn,Fo].forEach(n=>this.disposeWithMe(this._commandService.registerCommand(n))),this._configService.setConfig(AB,pOe)}};n8=_Oe([yt(it.Starting,n8),ND(0,le),ND(1,d0)],n8);var bOe=Object.defineProperty,COe=Object.getOwnPropertyDescriptor,yOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?COe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&bOe(e,n,i),i},SOe=(t,e)=>(n,r)=>e(n,r,t);let r8=class extends je{constructor(e){super(),this._commandService=e,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id!==sf.id)return;const n=e.params,{unitData:r,unitOtherData:i}=n,o=Object.keys(r),s=[];return o.forEach(a=>{const l=r[a];Object.keys(l).forEach(u=>{const c=l[u];if(c==null)return!0;const d={subUnitId:u,unitId:a,cellValue:c.getData()};s.push({id:Pt.id,params:d})})}),s.every(a=>this._commandService.executeCommand(a.id,a.params,{onlyLocal:!0}))}))}};r8=yOe([yt(it.Ready,r8),SOe(0,le)],r8);var EOe=Object.defineProperty,wOe=Object.getOwnPropertyDescriptor,ROe=(t,e,n,r)=>{for(var i=r>1?void 0:r?wOe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&EOe(e,n,i),i},K7=(t,e)=>(n,r)=>e(n,r,t);let i8=class extends je{constructor(e,n,r,i){super(),this._commandService=e,this._featureCalculationManagerService=n,this._currentUniverService=r,this._formulaDataModel=i,this._initialize()}_initialize(){const e="test",n="workbook-01",r="sheet-0011",i={[n]:{[r]:new nt({4:{0:{v:10,t:2}}})}},o={[n]:{[r]:[{startRow:4,startColumn:0,endRow:4,endColumn:0}]}};this._featureCalculationManagerService.register(e,{unitId:n,subComponentId:r,dependencyRanges:[{unitId:n,sheetId:r,range:{startRow:0,endRow:3,startColumn:0,endColumn:3}}],getDirtyData:()=>(console.log("test reference executor register"),{runtimeCellData:i,dirtyRanges:o})})}};i8=ROe([yt(it.Ready,i8),K7(0,le),K7(1,df),K7(2,oe),K7(3,ne(Vo))],i8);const cr={MoveRangeCommandId:lB,InsertRowCommandId:tB,InsertColCommandId:iB,RemoveColCommandId:cB,RemoveRowCommandId:uB,DeleteRangeMoveLeftCommandId:ZP,DeleteRangeMoveUpCommandId:qP,InsertRangeMoveDownCommandId:jMe,InsertRangeMoveRightCommandId:eB};var tr=(t=>(t[t.Set=0]="Set",t[t.Delete=1]="Delete",t[t.HorizontalMove=2]="HorizontalMove",t[t.VerticalMove=3]="VerticalMove",t[t.Unknown=4]="Unknown",t))(tr||{}),DOe=Object.defineProperty,IOe=Object.getOwnPropertyDescriptor,xOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?IOe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&DOe(e,n,i),i},lp=(t,e)=>(n,r)=>e(n,r,t);const MOe=h0("MERGE_REDO"),OOe=h0("MERGE_UNDO");let $2=class extends je{constructor(e,n,r){super(),Jn(this,"interceptor",new sM({MERGE_REDO:MOe,MERGE_UNDO:OOe})),Jn(this,"_refRangeManagerMap",new Map),Jn(this,"_serializer",TOe()),Jn(this,"_onRefRangeChange",()=>{this._sheetInterceptorService.interceptCommand({getMutations:i=>{const o=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet(),s=LD(this._univerInstanceService),a=PD(this._univerInstanceService),l=((()=>{switch(i.id){case cr.MoveRangeCommandId:{const d=i;return this._checkRange([d.params.fromRange,d.params.toRange],s,a)}case cr.InsertRowCommandId:{const d={startRow:i.params.range.startRow,endRow:o.getRowCount()-1,startColumn:0,endColumn:o.getColumnCount()-1};return this._checkRange([d],s,a)}case cr.InsertColCommandId:{const d=i.params.range.startColumn,h={startRow:0,endRow:o.getRowCount()-1,startColumn:d,endColumn:o.getColumnCount()-1};return this._checkRange([h],s,a)}case cr.RemoveRowCommandId:{const d={startRow:i.params.range.startRow,endRow:o.getRowCount()-1,startColumn:0,endColumn:o.getColumnCount()-1};return this._checkRange([d],s,a)}case cr.RemoveColCommandId:{const d=i.params.range.startColumn,h={startRow:0,endRow:o.getRowCount()-1,startColumn:d,endColumn:o.getColumnCount()-1};return this._checkRange([h],s,a)}case cr.DeleteRangeMoveUpCommandId:case cr.InsertRangeMoveDownCommandId:{const d=i.params.range||BD(this._selectionManagerService)[0],h={startRow:d.startRow,startColumn:d.startColumn,endColumn:d.endColumn,endRow:o.getRowCount()-1};return this._checkRange([h],s,a)}case cr.DeleteRangeMoveLeftCommandId:case cr.InsertRangeMoveRightCommandId:{const d=i.params.range||BD(this._selectionManagerService)[0],h={startRow:d.startRow,startColumn:d.startColumn,endColumn:o.getColumnCount()-1,endRow:d.endRow};return this._checkRange([h],s,a)}}})()||[]).reduce((d,h)=>{const f=h(i);return d.push(f),d},[]).reduce((d,h)=>(d.redos.push(...h.redos),d.undos.push(...h.undos),d),{redos:[],undos:[]}),u=this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().MERGE_REDO)(l.redos,null)||[],c=this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().MERGE_UNDO)(l.undos,null)||[];return{redos:u,undos:c}}})}),Jn(this,"_checkRange",(i,o,s)=>{const a=FD(o,s),l=this._refRangeManagerMap.get(a);if(l){const u=new Set;return[...l.keys()].forEach(c=>{const d=l.get(c),h=this._serializer.deserialize(c);i.some(f=>pt.intersects(f,h))&&d&&d.forEach(f=>{u.add(f)})}),[...u]}return[]}),Jn(this,"registerRefRange",(i,o,s,a)=>{const l=s||LD(this._univerInstanceService),u=a||PD(this._univerInstanceService),c=FD(l,u),d=this._serializer.serialize(i);let h=this._refRangeManagerMap.get(c);h||(h=new Map,this._refRangeManagerMap.set(c,h));const f=h.get(d);return f?f.add(o):h.set(d,new Set([o])),Be(()=>{const m=h.get(d);m&&(m.delete(o),m.size||(h.delete(d),h.size||this._refRangeManagerMap.delete(c)))})}),this._sheetInterceptorService=e,this._univerInstanceService=n,this._selectionManagerService=r,this._onRefRangeChange(),this.interceptor.intercept(this.interceptor.getInterceptPoints().MERGE_REDO,{priority:-1,handler:i=>i}),this.interceptor.intercept(this.interceptor.getInterceptPoints().MERGE_UNDO,{priority:-1,handler:i=>i})}};$2=xOe([yt(it.Steady,$2),lp(0,ne(En)),lp(1,ne(oe)),lp(2,ne(ut))],$2);function LD(t){return t.getCurrentUniverSheetInstance().getUnitId()}function PD(t){return t.getCurrentUniverSheetInstance().getActiveSheet().getSheetId()}function BD(t){return t.getSelectionRanges()||[]}function FD(t,e){return`${t}_${e}`}function TOe(){const t=["startRow","startColumn","endRow","endColumn","rangeType"],e="_";return{deserialize:n=>{const r=t.reduce((i,o,s)=>(i[String(s)]=o,i),{});return n.split(e).reduce((i,o,s)=>{const a=String(s);return o&&r[a]&&(i[r[a]]=o),i},{})},serialize:n=>t.reduce((r,i,o)=>{const s=n[i];return s!==void 0?`${r}${o>0?e:""}${s}`:`${r}`},"")}}var $Oe=Object.defineProperty,kOe=Object.getOwnPropertyDescriptor,AOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?kOe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&$Oe(e,n,i),i},Bc=(t,e)=>(n,r)=>e(n,r,t);function bf(t,e){let n=t;if(e!==void 0){const r=[];for(let i=0;i<n.length;i++){const{startRow:o,endRow:s,startColumn:a,endColumn:l}=n[i];if(e===sr.ROWS)for(let u=o;u<=s;u++){const c={startRow:u,endRow:u,startColumn:a,endColumn:l};r.push(c)}else if(e===sr.COLUMNS)for(let u=a;u<=l;u++){const c={startRow:o,endRow:s,startColumn:u,endColumn:u};r.push(c)}}n=r}return n}let o8=class extends je{constructor(e,n,r,i,o,s){super(),this._commandService=e,this._refRangeService=n,this._univerInstanceService=r,this._injector=i,this._sheetInterceptorService=o,this._selectionManagerService=s,this._onRefRangeChange(),this._initCommandInterceptor()}_initCommandInterceptor(){const e=this;this._sheetInterceptorService.interceptCommand({getMutations(n){switch(n.id){case A4.id:case N4.id:{const r=e._univerInstanceService.getCurrentUniverSheetInstance(),i=r.getUnitId(),o=r.getActiveSheet(),s=o.getSheetId(),a=o.getConfig().mergeData,l=e._selectionManagerService.getSelectionRanges();if(l&&l.length>0&&l.some(u=>a.some(c=>pt.intersects(c,u)))){const u={unitId:i,subUnitId:s,ranges:l},c=Ai(e._injector,u),d=[{id:Rn.id,params:u}],h=[{id:wn.id,params:c}];return{redos:d,undos:h}}}}return{redos:[],undos:[]}}})}_onRefRangeChange(){const e=new Ia,n=(o,s)=>{const a=this._univerInstanceService.getUniverSheetInstance(o);if(!a)return;const l=a==null?void 0:a.getSheetBySheetId(s);if(!l)return;e.dispose();const u=l.getMergeData(),c=d=>{switch(d.id){case gc.id:{const h=d.params;return this._handleMoveRangeCommand(h,o,s)}case mc.id:{const h=d.params,f=h.unitId||o,m=h.subUnitId||s;return this._handleInsertRowCommand(h,f,m)}case pc.id:{const h=d.params,f=h.unitId||o,m=h.subUnitId||s;return this._handleInsertColCommand(h,f,m)}case O0.id:{const h=d.params;return this._handleRemoveColCommand(h,o,s)}case M0.id:{const h=d.params;return this._handleRemoveRowCommand(h,o,s)}case x0.id:{const h=d.params;return this._handleInsertRangeMoveRightCommand(h,o,s)}case I0.id:{const h=d.params;return this._handleInsertRangeMoveDownCommand(h,o,s)}case D0.id:{const h=d.params;return this._handleDeleteRangeMoveUpCommand(h,o,s)}case R0.id:{const h=d.params;return this._handleDeleteRangeMoveLeftCommand(h,o,s)}}return{redos:[],undos:[]}};u.forEach(d=>{e.add(this._refRangeService.registerRefRange(d,c,o,s))})};this.disposeWithMe(this._commandService.onCommandExecuted(o=>{if(o.id===T0.id){const s=o.params,a=s.subUnitId,l=s.unitId;if(!a||!l)return;n(l,a)}if(o.id===wn.id){const s=o.params,a=s.subUnitId,l=s.unitId;if(!a||!l)return;n(s.unitId,s.subUnitId)}}));const r=this._univerInstanceService.getCurrentUniverSheetInstance(),i=r.getActiveSheet();n(r.getUnitId(),i.getSheetId())}_handleMoveRangeCommand(e,n,r){const i=Ya(this._univerInstanceService,n);if(!i)return this._handleNull();const o=Ga(i,r);if(!o)return this._handleNull();const s=o.getMergeData(),a=s.filter(f=>pt.intersects(f,e.fromRange)),l=s.filter(f=>pt.intersects(f,e.toRange)),u=a.map(f=>pt.getRelativeRange(f,e.fromRange)).map(f=>pt.getPositionRange(f,e.toRange)),c=bf(u).filter(f=>!s.some(m=>pt.equals(f,m))),d=[{id:Rn.id,params:{unitId:n,subUnitId:r,ranges:a}},{id:Rn.id,params:{unitId:n,subUnitId:r,ranges:l}},{id:wn.id,params:{unitId:n,subUnitId:r,ranges:c}}],h=[{id:Rn.id,params:{unitId:n,subUnitId:r,ranges:c}},{id:wn.id,params:{unitId:n,subUnitId:r,ranges:l}},{id:wn.id,params:{unitId:n,subUnitId:r,ranges:a}}];return{redos:d,undos:h}}_handleInsertRowCommand(e,n,r){const i=Ya(this._univerInstanceService,n);if(!i)return this._handleNull();const o=Ga(i,r);if(!o)return this._handleNull();const{range:s}=e,{startRow:a,endRow:l}=s,u=De.deepClone(o.getMergeData()),c=De.deepClone(o.getMergeData()).map(v=>{const _=l-a+1;return a>v.endRow?v:a<=v.startRow?pt.moveVertical(v,_):(v.endRow+=_,v)}),d={unitId:n,subUnitId:r,ranges:u},h=Ai(this._injector,d),f={unitId:n,subUnitId:r,ranges:c},m=so(this._injector,f),p=[{id:Rn.id,params:d},{id:wn.id,params:f}],g=[{id:Rn.id,params:m},{id:wn.id,params:h}];return{redos:p,undos:g}}_handleInsertColCommand(e,n,r){const{range:i}=e,o=Ya(this._univerInstanceService,n);if(!o)return this._handleNull();const s=Ga(o,r);if(!s)return this._handleNull();const{startColumn:a,endColumn:l}=i,u=De.deepClone(s.getMergeData()),c=De.deepClone(s.getMergeData()).map(v=>{const _=l-a+1;return a>v.endColumn?v:a<=v.startColumn?pt.moveHorizontal(v,_):(v.endColumn+=_,v)}),d={unitId:n,subUnitId:r,ranges:u},h=Ai(this._injector,d),f={unitId:n,subUnitId:r,ranges:c},m=so(this._injector,f),p=[{id:Rn.id,params:d},{id:wn.id,params:f}],g=[{id:Rn.id,params:m},{id:wn.id,params:h}];return{redos:p,undos:g}}_handleRemoveColCommand(e,n,r){const i=Ya(this._univerInstanceService,n);if(!i)return this._handleNull();const o=Ga(i,r);if(!o)return this._handleNull();const{range:s}=e,a=De.deepClone(o.getMergeData());for(let m=0;m<a.length;m++){const p=a[m],{startColumn:g,endColumn:v}=p,_=v-g+1,{startColumn:C,endColumn:y}=s,S=y-C+1;if(y<p.startColumn)p.startColumn-=S,p.endColumn-=S;else{if(C>p.endColumn)continue;if(C<=p.startColumn&&y>=p.endColumn)a.splice(m,1),m--;else{const E=pt.getIntersects(s,p);E.endColumn-E.startColumn+1===_-1?(a.splice(m,1),m--):p.endColumn-=E.endColumn-E.startColumn+1}}}const l={unitId:n,subUnitId:r,ranges:De.deepClone(o.getMergeData())},u=Ai(this._injector,l),c={unitId:n,subUnitId:r,ranges:a},d=so(this._injector,c),h=[{id:Rn.id,params:l},{id:wn.id,params:c}],f=[{id:Rn.id,params:d},{id:wn.id,params:u}];return{redos:h,undos:f}}_handleRemoveRowCommand(e,n,r){const{range:i}=e,o=Ya(this._univerInstanceService,n);if(!o)return this._handleNull();const s=Ga(o,r);if(!s)return this._handleNull();const a=De.deepClone(s.getMergeData());for(let m=0;m<a.length;m++){const p=a[m],{startRow:g,endRow:v}=p,_=v-g+1,{startRow:C,endRow:y}=i,S=y-C+1;if(y<g)p.startRow-=S,p.endRow-=S;else{if(C>v)continue;if(C<=g&&y>=v)a.splice(m,1),m--;else{const E=pt.getIntersects(i,p);E.endRow-E.startRow+1===_-1?(a.splice(m,1),m--):p.endRow-=E.endRow-E.startRow+1}}}const l={unitId:n,subUnitId:r,ranges:De.deepClone(s.getMergeData())},u=Ai(this._injector,l),c={unitId:n,subUnitId:r,ranges:a},d=so(this._injector,c),h=[{id:Rn.id,params:l},{id:wn.id,params:c}],f=[{id:Rn.id,params:d},{id:wn.id,params:u}];return{redos:h,undos:f}}_handleInsertRangeMoveRightCommand(e,n,r){const i=Ya(this._univerInstanceService,n);if(!i)return this._handleNull();const o=Ga(i,r);if(!o)return this._handleNull();const s=e.range,a=o.getMaxColumns()-1,l=o.getMergeData(),u=[],c=[];l.forEach(p=>{const{startRow:g,endRow:v,startColumn:_,endColumn:C}=s;if(pt.intersects({startRow:g,startColumn:_,endRow:v,endColumn:a},p)&&(u.push(p),pt.contains({startRow:g,startColumn:_,endRow:v,endColumn:a},p))){const y=C-_+1;c.push({startRow:p.startRow,startColumn:p.startColumn+y,endRow:p.endRow,endColumn:p.endColumn+y})}});const d={unitId:n,subUnitId:r,ranges:u},h=Ai(this._injector,d),f={unitId:n,subUnitId:r,ranges:c},m=so(this._injector,f);return{redos:[{id:Rn.id,params:d},{id:wn.id,params:f}],undos:[{id:wn.id,params:h},{id:Rn.id,params:m}]}}_handleInsertRangeMoveDownCommand(e,n,r){const i=Ya(this._univerInstanceService,n);if(!i)return this._handleNull();const o=Ga(i,r);if(!o)return this._handleNull();const s=e.range,a=o.getMaxRows()-1,l=o.getMergeData(),u=[],c=[];l.forEach(v=>{const{startRow:_,startColumn:C,endColumn:y,endRow:S}=s;if(pt.intersects({startRow:_,startColumn:C,endRow:a,endColumn:y},v)&&(u.push(v),pt.contains({startRow:_,startColumn:C,endRow:a,endColumn:y},v))){const E=S-_+1;c.push({startRow:v.startRow+E,startColumn:v.startColumn,endRow:v.endRow+E,endColumn:v.endColumn})}});const d={unitId:n,subUnitId:r,ranges:u},h=Ai(this._injector,d),f={unitId:n,subUnitId:r,ranges:c},m=so(this._injector,f),p=[{id:Rn.id,params:d},{id:wn.id,params:f}],g=[{id:wn.id,params:h},{id:Rn.id,params:m}];return{redos:p,undos:g}}_handleDeleteRangeMoveUpCommand(e,n,r){const i=Ya(this._univerInstanceService,n);if(!i)return this._handleNull();const o=Ga(i,r);if(!o)return this._handleNull();const s=e.range,a=o.getMaxRows()-1,l=o.getMergeData(),u=[],c=[];l.forEach(v=>{const{startRow:_,startColumn:C,endColumn:y,endRow:S}=s;if(pt.intersects({startRow:_,startColumn:C,endRow:a,endColumn:y},v)&&(u.push(v),pt.contains({startRow:_,startColumn:C,endRow:a,endColumn:y},v))){const E=S-_+1,w=pt.moveVertical(v,-E);c.push(w)}});const d={unitId:n,subUnitId:r,ranges:u},h=Ai(this._injector,d),f={unitId:n,subUnitId:r,ranges:c},m=so(this._injector,f),p=[{id:Rn.id,params:d},{id:wn.id,params:f}],g=[{id:wn.id,params:h},{id:Rn.id,params:m}];return{redos:p,undos:g}}_handleDeleteRangeMoveLeftCommand(e,n,r){const i=Ya(this._univerInstanceService,n);if(!i)return this._handleNull();const o=Ga(i,r);if(!o)return this._handleNull();const s=e.range,a=o.getMaxColumns()-1,l=o.getMergeData(),u=[],c=[];l.forEach(p=>{const{startRow:g,endRow:v,startColumn:_,endColumn:C}=s;if(pt.intersects({startRow:g,startColumn:_,endRow:v,endColumn:a},p)&&(u.push(p),pt.contains({startRow:g,startColumn:_,endRow:v,endColumn:a},p))){const y=C-_+1;c.push({startRow:p.startRow,startColumn:p.startColumn-y,endRow:p.endRow,endColumn:p.endColumn-y})}});const d={unitId:n,subUnitId:r,ranges:u},h=Ai(this._injector,d),f={unitId:n,subUnitId:r,ranges:c},m=so(this._injector,f);return{redos:[{id:Rn.id,params:d},{id:wn.id,params:f}],undos:[{id:wn.id,params:h},{id:Rn.id,params:m}]}}_handleNull(){return{redos:[],undos:[]}}};o8=AOe([yt(it.Steady,o8),Bc(0,ne(le)),Bc(1,ne($2)),Bc(2,ne(oe)),Bc(3,ne(Tn)),Bc(4,ne(En)),Bc(5,ne(ut))],o8);function Ya(t,e){return e?t.getUniverSheetInstance(e):t.getCurrentUniverSheetInstance()}function Ga(t,e){return e?t.getSheetBySheetId(e):t.getActiveSheet()}const NOe={sheets:{sheetCopy:""}};var LOe=Object.defineProperty,POe=Object.getOwnPropertyDescriptor,BOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?POe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&LOe(e,n,i),i},Z7=(t,e)=>(n,r)=>e(n,r,t);const FOe="SHEET_NUMFMT_PLUGIN";let s8=class extends je{constructor(e,n,r,i){super(),Jn(this,"_numfmtModel",new Map),Jn(this,"_refAliasModel",new Map),Jn(this,"_modelReplace$",new Qt),Jn(this,"modelReplace$",this._modelReplace$.asObservable()),this._commandService=e,this._resourceManagerService=n,this._univerInstanceService=r,this._logService=i,this._initModel(),this.disposeWithMe(Be(()=>{this._numfmtModel.clear(),this._refAliasModel.clear()}))}_initModel(){const e=r=>{const i=r.getUnitId();this._resourceManagerService.registerPluginResource(i,FOe,{toJson:o=>this._toJson(o),parseJson:o=>this._parseJson(o),onChange:(o,s)=>{const{model:a,refModel:l}=s;if(a){const u=Object.keys(a).reduce((c,d)=>(c.set(d,new nt(a[d])),c),new Map);this._numfmtModel.set(o,u)}l&&this._refAliasModel.set(o,new Vf(l,["pattern","i"])),this._modelReplace$.next(o)}})};this.disposeWithMe(Be(this._univerInstanceService.sheetAdded$.subscribe(e))),this.disposeWithMe(Be(this._univerInstanceService.sheetDisposed$.subscribe(r=>{const i=r.getUnitId();this._numfmtModel.get(i)&&this._numfmtModel.delete(i),this._refAliasModel.get(i)&&this._refAliasModel.delete(i)})));const n=this._univerInstanceService.getCurrentUniverSheetInstance();e(n)}_toJson(e){const n=this._numfmtModel.get(e),r=this._refAliasModel.get(e);if(!n||!r)return"";const i=[...n.keys()].reduce((s,a)=>{const l=n.get(a);return s[a]=l.toJSON(),s},{}),o=r.getValues().filter(s=>s.count>0);return JSON.stringify({model:i,refModel:o})}_parseJson(e){try{return JSON.parse(e)}catch{return{model:{},refModel:[]}}}_setValue(e,n,r,i,o){let s=this.getModel(e,n);if(!s){const a=this._numfmtModel.get(e)||new Map,l=a.get(n)||new nt;a.set(n,l),this._numfmtModel.set(e,a),s=l}if(o)s.setValue(r,i,o);else if(s.realDeleteValue(r,i),!s.getSizeOf()){const a=this._numfmtModel.get(e);a==null||a.delete(n)}}_getUniqueRefId(e){const n=this._refAliasModel.get(e);if(!n)return"0";const r=n.getKeyMap("i");return`${Math.max(...r.map(i=>Number(i||0)),0)+1}`}getValue(e,n,r,i,o){const s=o||this.getModel(e,n);if(!s)return null;const a=this._refAliasModel.get(e),l=s.getValue(r,i);if(l&&a){const u=a.getValue(l==null?void 0:l.i);return u?{pattern:u.pattern,type:u.type}:(this._logService.error("[Numfmt Service]:","RefAliasModel is not match model"),null)}return null}deleteValues(e,n,r){let i=this._refAliasModel.get(e);const o=this.getModel(e,n);i||(i=new Vf([],["pattern","i"]),this._refAliasModel.set(e,i)),r.forEach(s=>{Er.foreach(s,(a,l)=>{const u=this.getValue(e,n,a,l,o);if(u&&u.pattern){const c=i.getValue(u.pattern);c&&c.count--}this._setValue(e,n,a,l,null)})})}setValues(e,n,r){const i=this.getModel(e,n);let o=this._refAliasModel.get(e);o||(o=new Vf([],["pattern","i"]),this._refAliasModel.set(e,o)),r.forEach(s=>{let a=o.getValue(s.pattern);a||(a={count:0,i:this._getUniqueRefId(e),pattern:s.pattern,type:r[0].type},o.addValue(a)),s.ranges.forEach(l=>{Er.foreach(l,(u,c)=>{if(i){const d=this.getValue(e,n,u,c,i);if(d&&d.pattern){const h=o.getValue(d.pattern);h&&h.count--}}this._setValue(e,n,u,c,{i:a.i}),a.count++})})})}getModel(e,n){const r=this._numfmtModel.get(e);return r==null?void 0:r.get(n)}getRefModel(e){return this._refAliasModel.get(e)}};s8=BOe([yt(it.Starting,s8),Z7(0,ne(le)),Z7(1,ne(lb)),Z7(2,ne(oe)),Z7(3,ne(hs))],s8);const UD="univer.sheet.editable";let Fc=class extends Lx{constructor(e,n){super(),Jn(this,"id",UD),Jn(this,"value",!0),Jn(this,"unitID"),this._unitId=e,this._subUnitId=n,this.unitID=e,this.id=`${UD}_${e}_${n}`}};var UOe=Object.defineProperty,HOe=Object.getOwnPropertyDescriptor,VOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?HOe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&UOe(e,n,i),i},up=(t,e)=>(n,r)=>e(n,r,t);let Da=class extends je{constructor(e,n,r){super(),this._permissionService=e,this._univerInstanceService=n,this._sheetInterceptorService=r,this._init(),this._interceptCommandPermission()}_init(){const e=this._univerInstanceService.getCurrentUniverSheetInstance(),n=e.getUnitId();e.getSheets().forEach(r=>{const i=r.getSheetId(),o=new Fc(n,i);this._permissionService.addPermissionPoint(e.getUnitId(),o)}),this.disposeWithMe(Be(e.sheetCreated$.subscribe(r=>{const i=r.getSheetId(),o=new Fc(n,i);this._permissionService.addPermissionPoint(e.getUnitId(),o)}))),this.disposeWithMe(Be(e.sheetDisposed$.subscribe(r=>{const i=r.getSheetId(),o=new Fc(n,i);this._permissionService.deletePermissionPoint(e.getUnitId(),o.id)})))}_interceptCommandPermission(){this.disposeWithMe(this._sheetInterceptorService.intercept(Ra.PERMISSION,{priority:99,handler:(e,n,r)=>{const i=this._univerInstanceService.getCurrentUniverSheetInstance(),o=i==null?void 0:i.getActiveSheet(),s=i==null?void 0:i.getUnitId(),a=o==null?void 0:o.getSheetId();if(!s||!a)return!1;switch(n.id){case Oa.id:return this.getSheetEditable(s,a)}return r()}}))}getEditable$(e,n){const r=this._univerInstanceService.getCurrentUniverSheetInstance(),i=e||r.getUnitId(),o=r.getActiveSheet(),s=n||o.getSheetId(),a=new Fc(i,s);return this._permissionService.composePermission$(i,[Jp,a.id]).pipe(Fs(([l,u])=>{const c=l.value&&u.value,d=qV([l,u]);return{value:c,status:d}}))}getSheetEditable(e,n){const r=this._univerInstanceService.getCurrentUniverSheetInstance(),i=e||r.getUnitId(),o=r.getActiveSheet(),s=n||o.getSheetId(),a=new Fc(i,s);return this._permissionService.composePermission(i,[Jp,a.id]).every(l=>l.value)}setSheetEditable(e,n,r){const i=this._univerInstanceService.getCurrentUniverSheetInstance(),o=n||i.getUnitId(),s=i.getActiveSheet(),a=r||s.getSheetId(),l=new Fc(o,a);this._permissionService.updatePermissionPoint(o,l.id,e)}};Da=VOe([yt(it.Ready,Da),up(0,ne(ub)),up(1,ne(oe)),up(2,ne(En))],Da);var jOe=Object.defineProperty,zOe=Object.getOwnPropertyDescriptor,WOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?zOe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&jOe(e,n,i),i},cp=(t,e)=>(n,r)=>e(n,r,t);const XOe="sheet";var dp;let b_=(dp=class extends S1{constructor(t,e,n,r){super(XOe),this._config=t,this._commandService=e,this._localeService=n,this._injector=r,this._initializeDependencies(r)}onRendered(){this._localeService.load({zhCN:NOe})}_initializeDependencies(t){var e;const n=[[Nl],[ut],[$2],[Da],[eo,{useClass:s8}],[En],[n8],[o8]];(e=this._config)!=null&&e.notExecuteFormula||n.push([r8],[i8]),n.forEach(r=>{t.add(r)})}},Jn(dp,"type",dr.Sheet),dp);b_=WOe([cp(1,le),cp(2,ne(mn)),cp(3,ne(Tn))],b_);const NB=[d1.id,Ws.id,G6.id,js.id,ja.id,r0.id,i0.id,Ju.id,ec.id,nc.id,tc.id,So.id,yo.id,Qu.id,qu.id,kl.id,$l.id],YOe=[Pt.id,Al.id,Rn.id,wn.id],S5=1.5,q7="rgba(255,255,255, 0.01)";function Pu(t){const e=t.getCurrentTheme(),n=new _o(e.colorBlack).setAlpha(.1).toRgbString();return{strokeWidth:1.5,stroke:e.primaryColor,fill:n,widgets:{},widgetSize:8,widgetStrokeWidth:1,widgetStroke:e.colorWhite,hasAutoFill:!0,AutofillSize:8,AutofillStrokeWidth:1,AutofillStroke:e.colorWhite,hasRowHeader:!0,rowHeaderFill:n,rowHeaderStroke:e.primaryColor,rowHeaderStrokeWidth:1,hasColumnHeader:!0,columnHeaderFill:n,columnHeaderStroke:e.primaryColor,columnHeaderStrokeWidth:1}}function a8(t){const{rangeWithCoord:e,primaryWithCoord:n,style:r}=t,i={range:{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn,rangeType:e.rangeType},primary:null,style:r};return n!=null&&(i.primary=GOe(n)),i}function GOe(t){const{actualRow:e,actualColumn:n,isMerged:r,isMergedMainCell:i}=t,{startRow:o,startColumn:s,endRow:a,endColumn:l}=t.mergeInfo;return{actualRow:e,actualColumn:n,isMerged:r,isMergedMainCell:i,startRow:o,startColumn:s,endRow:a,endColumn:l}}function KOe(t,e,n){const r=cc(t,e,n),i=BV(r);if(i)return{range:i,primary:r,style:null}}const $0=Number.MAX_SAFE_INTEGER,LB=(t,e)=>{var n,r;const i=(n=t.params)==null?void 0:n.toRange,o=(r=t.params)==null?void 0:r.fromRange;if(!i||!o)return[];const s=[];if(pt.intersects(o,e)){if(s.push({type:tr.Delete}),pt.contains(o,e)){const a=pt.getRelativeRange(e,o),l=pt.getPositionRange(a,i);return[{type:tr.Set,range:l}]}}else pt.intersects(i,e)&&s.push({type:tr.Delete});return s},PB=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;if(!r)return[];const i=[];if(r.endColumn<e.startColumn){const o={type:tr.HorizontalMove,step:-(r.endColumn-r.startColumn+1)};i.push(o)}else{if(r.startColumn<=e.startColumn&&r.endColumn>=e.endColumn||r.startColumn>=e.startColumn&&r.endColumn<=e.endColumn)return[{type:tr.Delete}];if(r.startColumn<=e.startColumn&&r.endColumn>=e.startColumn&&r.endColumn<=e.endColumn){const o={type:tr.HorizontalMove,step:-(e.startColumn-r.startColumn),length:-(r.endColumn-e.startColumn+1)};i.push(o)}else if(r.startColumn>=e.startColumn&&r.startColumn<=e.endColumn&&r.endColumn>=e.endColumn){const o={type:tr.HorizontalMove,step:0,length:-(e.endColumn-r.startColumn+1)};i.push(o)}}return i},BB=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;if(!r)return[];const i=[];if(r.endRow<e.startRow){const o={type:tr.VerticalMove,step:-(r.endRow-r.startRow+1)};i.push(o)}else{if(r.startRow<=e.startRow&&r.endRow>=e.endRow||r.startRow>=e.startRow&&r.endRow<=e.endRow)return[{type:tr.Delete}];if(r.startRow<=e.startRow&&r.endRow>=e.startRow&&r.endRow<=e.endRow){const o={type:tr.VerticalMove,step:-(e.startRow-r.startRow),length:-(r.endRow-e.startRow+1)};i.push(o)}else if(r.startRow>=e.startRow&&r.startRow<=e.endRow&&r.endRow>=e.endRow){const o={type:tr.VerticalMove,step:0,length:-(e.endRow-r.startRow+1)};i.push(o)}}return i},FB=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;return r?r.endRow<=e.startRow||r.startRow<=e.startRow&&r.endRow>=e.endRow?[{type:tr.VerticalMove,step:r.endRow-r.startRow+1}]:r.startRow>=e.startRow&&r.endRow<=e.endRow?[{type:tr.VerticalMove,step:0,length:r.endRow-r.startRow+1}]:pt.intersects({...r,endRow:$0},e)?[{type:tr.Delete}]:[]:[]},UB=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;return r?r.endColumn<e.startColumn||r.startColumn<=e.startColumn&&r.endColumn>=e.endColumn?[{type:tr.HorizontalMove,step:r.endColumn-r.startColumn+1}]:r.startColumn>=e.startColumn&&r.endColumn<=e.endColumn?[{type:tr.HorizontalMove,step:0,length:r.endColumn-r.startColumn+1}]:pt.intersects({...r,endColumn:$0},e)?[{type:tr.Delete}]:[]:[]},HB=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;return r?r.startColumn<=e.startColumn&&r.endColumn>=e.endColumn&&r.endRow<=e.startRow&&r.startRow<=e.startRow?[{type:tr.VerticalMove,step:r.endRow-r.startRow+1}]:pt.intersects({...r,endRow:$0},e)?[{type:tr.Delete}]:[]:[]},VB=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;return r?r.startRow<=e.startRow&&r.endRow>=e.endRow&&r.startColumn<=e.startColumn?[{type:tr.HorizontalMove,step:r.endColumn-r.startColumn+1}]:pt.intersects({...r,endColumn:$0},e)?[{type:tr.Delete}]:[]:[]},jB=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;return r?r.startRow<=e.startRow&&r.endRow>=e.endRow&&r.endColumn<e.startColumn?[{type:tr.HorizontalMove,step:-(r.endColumn-r.startColumn+1)}]:pt.intersects({...r,endColumn:$0},e)?[{type:tr.Delete}]:[]:[]},zB=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;return r?r.startColumn<=e.startColumn&&r.endColumn>=e.endColumn&&r.endRow<e.startRow?[{type:tr.VerticalMove,step:-(r.endRow-r.startRow+1)}]:pt.intersects({...r,endRow:$0},e)?[{type:tr.Delete}]:[]:[]},la=(t,e)=>{let n={...e};return t.forEach(r=>{switch(r.type){case tr.Delete:{n=null;break}case tr.HorizontalMove:{if(!n)return;n.startColumn+=r.step,n.endColumn+=r.step+(r.length||0);break}case tr.VerticalMove:{if(!n)return;n.startRow+=r.step,n.endRow+=r.step+(r.length||0);break}case tr.Set:{n=r.range;break}}}),n&&(n.endColumn<n.startColumn||n.endRow<n.startRow)?null:n};var ZOe=Object.defineProperty,qOe=(t,e,n)=>e in t?ZOe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,V=(t,e,n)=>(qOe(t,typeof e!="symbol"?e+"":e,n),n);const QOe="SheetUI";function o0(t,e){if(t==null)return;const n=e.getRenderById(t);if(n==null)return;const{mainComponent:r,scene:i,engine:o}=n;return{document:r,scene:i,engine:o}}const C_={type:se.COMMAND,id:"sheet.command.auto-fill",handler:async(t,e)=>{var n,r;const i=t.get(le),o=t.get(oe),s=t.get(At),{applyRange:a,selectionRange:l,applyDatas:u,unitId:c=o.getCurrentUniverSheetInstance().getUnitId(),subUnitId:d=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),applyMergeRanges:h}=e||{};if(!a||!u||!l)return!1;const f=[],m=[];let p=!0;const g=[],v=(r=(n=o.getUniverSheetInstance(c))==null?void 0:n.getSheetBySheetId(d))==null?void 0:r.getMergeData();v&&v.forEach(te=>{pt.intersects(te,a)&&g.push(te)});const _={unitId:c,subUnitId:d,ranges:g},C=Ai(t,_);p=i.syncExecuteCommand(Rn.id,_),f.push({id:wn.id,params:C}),m.push({id:Rn.id,params:_});const y=new nt,{startRow:S,startColumn:E,endRow:w,endColumn:R}=a;for(let te=0;te<=w-S;te++)for(let z=0;z<=R-E;z++)y.setValue(te+S,z+E,u[te][z]);const D={subUnitId:d,unitId:c,cellValue:y.getMatrix()},I=Bi(t,D),k=i.syncExecuteCommand(Pt.id,D);f.push({id:Pt.id,params:I}),m.push({id:Pt.id,params:D});const O=i.syncExecuteCommand(dn.id,{selections:[{primary:{...l,endColumn:l.startColumn,endRow:l.startRow},range:{...l,rangeType:Rt.NORMAL}}],unitId:c,subUnitId:d});f.push({id:Pt.id,params:I}),m.push({id:Pt.id,params:D});let $=!0;if(h!=null&&h.length){const te=bf(h),z={unitId:c,subUnitId:d,ranges:te},A=so(t,z);$=i.syncExecuteCommand(wn.id,z),f.push({id:Rn.id,params:A}),m.push({id:wn.id,params:z})}const{undo:N,redo:H}=e==null?void 0:e.extendMutations,X=H.every(te=>i.syncExecuteCommand(te.id,te.params));return N.forEach(te=>{f.push(te)}),H.forEach(te=>{m.push(te)}),k&&p&&$&&O&&X&&s.pushUndoRedo({unitID:c,undoMutations:f,redoMutations:m}),!0}},l8={id:"sheet.command.auto-clear-content",type:se.COMMAND,handler:async(t,e)=>{const n=t.get(oe),r=t.get(le),i=t.get(At),o=n.getCurrentUniverSheetInstance(),s=o.getUnitId(),a=o.getActiveSheet().getSheetId(),{clearRange:l,selectionRange:u}=e,c={subUnitId:a,unitId:s,cellValue:JOe([l])},d=Bi(t,c);return r.executeCommand(dn.id,{selections:[{primary:{...u},range:{...u}}],unitId:s,subUnitId:a}),r.syncExecuteCommand(Pt.id,c)?(i.pushUndoRedo({unitID:s,undoMutations:[{id:Pt.id,params:d}],redoMutations:[{id:Pt.id,params:c}],undo(){return r.syncExecuteCommand(Pt.id,d)},redo(){return r.syncExecuteCommand(Pt.id,c)}}),!0):!1}};function JOe(t){const e=new nt;return t.forEach(n=>{const{startRow:r,startColumn:i,endRow:o,endColumn:s}=n;for(let a=r;a<=o;a++)for(let l=i;l<=s;l++)e.setValue(a,l,{v:null,p:null,f:null,si:null})}),e.getData()}function qn(t){return t.getContextValue(Rl)&&!t.getContextValue(Dr)}function WB(t){return t.getContextValue(Rl)&&t.getContextValue(Dr)}function eTe(t){return t.getContextValue(e4)&&!t.getContextValue(Dr)}function tTe(t){return t.getContextValue(Dr)&&t.getContextValue(e4)}function XB(t){return t.getContextValue(l1)}function V4(t){return t.getContextValue(Rl)&&t.getContextValue(Dr)&&t.getContextValue(yu)}function E5(t){return t.getContextValue(Rl)&&t.getContextValue(Dr)&&!t.getContextValue(yu)}class nTe{constructor(){V(this,"_startColumn",-1),V(this,"_startRow",-1),V(this,"_endColumn",-1),V(this,"_endRow",-1),V(this,"_startX",0),V(this,"_startY",0),V(this,"_endX",0),V(this,"_endY",0),V(this,"_currentCell"),V(this,"_rangeType",Rt.NORMAL)}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get currentCell(){return this._currentCell}get rangeType(){return this._rangeType}isEqual(e){const{startColumn:n,startRow:r,endColumn:i,endRow:o}=this,{startColumn:s,startRow:a,endColumn:l,endRow:u}=e;return n===s&&r===a&&i===l&&o===u}isInclude(e){const{startColumn:n,startRow:r,endColumn:i,endRow:o}=this,{startColumn:s,startRow:a,endColumn:l,endRow:u}=e;return!(l<n||s>i||a>o||u<r)}highlightToSelection(){return ib(this._currentCell)}getRange(){return{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY,rangeType:this.rangeType}}getCell(){return this._currentCell}getRangeType(){return this._rangeType}getValue(){return{rangeWithCoord:{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY,rangeType:this._rangeType},primaryWithCoord:this._currentCell}}setValue(e,n){const{startColumn:r,startRow:i,endColumn:o,endRow:s,startX:a,startY:l,endX:u,endY:c,rangeType:d}=e;this._startColumn=r,this._startRow=i,this._endColumn=o,this._endRow=s,this._startX=a,this._startY=l,this._endX=u,this._endY=c,d!=null&&(this._rangeType=d),this.setCurrentCell(n)}setCurrentCell(e){e&&(this._currentCell=e)}clearCurrentCell(){this._currentCell=null}}const HD=.3;class w5{constructor(e,n,r=!0,i){V(this,"_leftControl"),V(this,"_rightControl"),V(this,"_topControl"),V(this,"_bottomControl"),V(this,"_backgroundControlTop"),V(this,"_backgroundControlBottom"),V(this,"_backgroundControlMiddleLeft"),V(this,"_backgroundControlMiddleRight"),V(this,"_fillControl"),V(this,"_selectionShape"),V(this,"_rowHeaderBackground"),V(this,"_rowHeaderBorder"),V(this,"_rowHeaderGroup"),V(this,"_rowHeaderHighlight"),V(this,"_columnHeaderBackground"),V(this,"_columnHeaderBorder"),V(this,"_columnHeaderGroup"),V(this,"_columnHeaderHighlight"),V(this,"_topLeftWidget"),V(this,"_topCenterWidget"),V(this,"_topRightWidget"),V(this,"_middleLeftWidget"),V(this,"_middleRightWidget"),V(this,"_bottomLeftWidget"),V(this,"_bottomCenterWidget"),V(this,"_bottomRightWidget"),V(this,"_dashRect"),V(this,"_selectionModel"),V(this,"_selectionStyle"),V(this,"_rowHeaderWidth",0),V(this,"_columnHeaderHeight",0),V(this,"_widgetRects",[]),V(this,"_dispose$",new rn(this)),V(this,"dispose$",this._dispose$.asObservable()),V(this,"selectionMoving$",new Qt),V(this,"selectionMoved$",new Qt),V(this,"selectionScaling$",new Qt),V(this,"selectionScaled$",new Qt),V(this,"selectionFilling$",new Qt),V(this,"_selectionFilled$",new Qt),V(this,"selectionFilled$",this._selectionFilled$.asObservable()),V(this,"_defaultStyle"),V(this,"_isHelperSelection",!0),this._scene=e,this._zIndex=n,this._isHeaderHighlight=r,this._themeService=i,this._initialize()}get zIndex(){return this._zIndex}get leftControl(){return this._leftControl}get rightControl(){return this._rightControl}get topControl(){return this._topControl}get bottomControl(){return this._bottomControl}get fillControl(){return this._fillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShape}get model(){return this._selectionModel}get topLeftWidget(){return this._topLeftWidget}get topCenterWidget(){return this._topCenterWidget}get topRightWidget(){return this._topRightWidget}get middleLeftWidget(){return this._middleLeftWidget}get middleRightWidget(){return this._middleRightWidget}get bottomLeftWidget(){return this._bottomLeftWidget}get bottomCenterWidget(){return this._bottomCenterWidget}get bottomRightWidget(){return this._bottomRightWidget}get selectionStyle(){return this._selectionStyle}get dashRect(){return this._dashRect}get isHelperSelection(){return this._isHelperSelection}enableHeaderHighlight(){this._isHelperSelection=!0}disableHeaderHighlight(){this._isHeaderHighlight=!1}refreshSelectionFilled(e){this._selectionFilled$.next(e)}updateStyle(e){this._updateControl(e,this._rowHeaderWidth,this._columnHeaderHeight)}update(e,n=0,r=0,i,o){this._selectionModel.setValue(e,o),i==null&&(i=this._selectionStyle),this._updateControl(i,n,r)}clearHighlight(){this._selectionModel.clearCurrentCell(),this._updateControl(this._selectionStyle,this._rowHeaderWidth,this._columnHeaderHeight)}getScene(){return this._scene}dispose(){var e,n,r,i,o,s,a,l,u,c,d,h,f,m,p,g,v,_,C,y,S,E,w,R,D;(e=this._leftControl)==null||e.dispose(),(n=this._rightControl)==null||n.dispose(),(r=this._topControl)==null||r.dispose(),(i=this._bottomControl)==null||i.dispose(),(o=this._backgroundControlTop)==null||o.dispose(),(s=this._backgroundControlMiddleLeft)==null||s.dispose(),(a=this._backgroundControlMiddleRight)==null||a.dispose(),(l=this._backgroundControlBottom)==null||l.dispose(),(u=this._fillControl)==null||u.dispose(),(c=this._selectionShape)==null||c.dispose(),(d=this._rowHeaderBackground)==null||d.dispose(),(h=this._rowHeaderBorder)==null||h.dispose(),(f=this._rowHeaderGroup)==null||f.dispose(),(m=this._rowHeaderBackground)==null||m.dispose(),(p=this._columnHeaderBackground)==null||p.dispose(),(g=this._columnHeaderBorder)==null||g.dispose(),(v=this._columnHeaderGroup)==null||v.dispose(),(_=this._topLeftWidget)==null||_.dispose(),(C=this._topCenterWidget)==null||C.dispose(),(y=this._topRightWidget)==null||y.dispose(),(S=this._middleLeftWidget)==null||S.dispose(),(E=this._middleRightWidget)==null||E.dispose(),(w=this._bottomLeftWidget)==null||w.dispose(),(R=this._bottomCenterWidget)==null||R.dispose(),(D=this._bottomRightWidget)==null||D.dispose(),this._dispose$.next(this),this._dispose$.complete()}getCurrentCellInfo(){const e=this.model.currentCell;if(e){let n;if(e.isMerged){const r=e.mergeInfo;n={startRow:r.startRow,endRow:r.endRow,startColumn:r.startColumn,endColumn:r.endColumn,startX:r.startX,endX:r.endX,startY:r.startY,endY:r.endY}}else{const{actualRow:r,actualColumn:i,startX:o,endX:s,startY:a,endY:l}=e;n={startRow:r,endRow:r,startColumn:i,endColumn:i,startX:o,endX:s,startY:a,endY:l}}return n}}getValue(){return{...this._selectionModel.getValue(),style:this._selectionStyle}}getRange(){return this._selectionModel.getValue().rangeWithCoord}enableHelperSelection(){this._isHelperSelection=!0}disableHelperSelection(){this._isHelperSelection=!1}updateStyleId(e){this._selectionStyle!=null&&(this._selectionStyle.id=e)}_updateControl(e,n,r){let{startX:i,startY:o,endX:s,endY:a}=this._selectionModel;const l=this._defaultStyle;e==null&&(e=l);const{stroke:u=l.stroke,widgets:c=l.widgets,hasAutoFill:d=l.hasAutoFill,AutofillStroke:h=l.AutofillStroke,strokeDash:f}=e;let{strokeWidth:m=l.strokeWidth,AutofillSize:p=l.AutofillSize,AutofillStrokeWidth:g=l.AutofillStrokeWidth}=e;const v=this._getScale();i=Et(i,v),o=Et(o,v),s=Et(s,v),a=Et(a,v);const _=(m+S5)/2/v;m/=this._getPureScale(),p/=v,g/=v;const C=S5/v,y=ii/v;this.leftControl.transformByState({height:a-o,left:-_+y,width:m,strokeWidth:C,top:-C/2+y}),this.leftControl.setProps({fill:u,stroke:q7}),this.rightControl.transformByState({height:a-o,left:s-i-_+y,width:m,strokeWidth:C,top:-C/2+y}),this.rightControl.setProps({fill:u,stroke:q7}),this.topControl.transformByState({width:s-i+m,top:-_+y,left:-_+y,height:m,strokeWidth:C}),this.topControl.setProps({fill:u,stroke:q7}),this.bottomControl.transformByState({width:s-i+m,top:a-o-_+y,height:m,left:-_+y,strokeWidth:C}),this.bottomControl.setProps({fill:u,stroke:q7}),f==null?this.dashRect.hide():(this.dashRect.transformByState({height:a-o-m/2,width:s-i-m/2,strokeWidth:m,left:m/2-1/v,top:m/2-1/v}),this.dashRect.setProps({strokeDashArray:[0,f]}),this.dashRect.show()),d===!0&&!this._hasWidgets(c)?(this.fillControl.setProps({fill:u,stroke:h}),this.fillControl.transformByState({width:p-g,height:p-g,left:s-i-p/2,top:a-o-p/2,strokeWidth:g}),this.fillControl.show()):this.fillControl.hide(),this._updateBackgroundControl(e),this._updateBackgroundTitle(e,Et(n,v),r),this._updateWidgets(e),this.selectionShape.show(),this.selectionShape.translate(i,o),this._selectionStyle=e,this._rowHeaderWidth=n||0,this._columnHeaderHeight=r||0,this.selectionShape.makeDirtyNoDebounce(!0)}_initialize(){this._defaultStyle=Pu(this._themeService),this._selectionModel=new nTe;const e=this._zIndex;this._leftControl=new qt("__SpreadsheetSelectionShapeLeftControl__"+e,{zIndex:e}),this._rightControl=new qt("__SpreadsheetSelectionShapeRightControl__"+e,{zIndex:e}),this._topControl=new qt("__SpreadsheetSelectionTopControl__"+e,{zIndex:e}),this._bottomControl=new qt("__SpreadsheetSelectionBottomControl__"+e,{zIndex:e}),this._backgroundControlTop=new qt("__SpreadsheetSelectionBackgroundControlTop__"+e,{zIndex:e-1,evented:!1}),this._backgroundControlBottom=new qt("__SpreadsheetSelectionBackgroundControlBottom__"+e,{zIndex:e-1,evented:!1}),this._backgroundControlMiddleLeft=new qt("__SpreadsheetSelectionBackgroundControlMiddleLeft__"+e,{zIndex:e-1,evented:!1}),this._backgroundControlMiddleRight=new qt("__SpreadsheetSelectionBackgroundControlMiddleRight__"+e,{zIndex:e-1,evented:!1}),this._fillControl=new qt("__SpreadsheetSelectionFillControl__"+e,{zIndex:e+1}),this._dashRect=new qt("__SpreadsheetDragDashControl__"+e,{zIndex:e+2,evented:!1,stroke:"#fff"});const n=[this._fillControl,this._leftControl,this._rightControl,this._topControl,this._bottomControl,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom,this._dashRect];this._widgetRects=this._initialWidget(),this._selectionShape=new $3("__SpreadsheetSelectionShape__"+e,...n,...this._widgetRects),this._selectionShape.hide(),this._selectionShape.evented=!1,this._selectionShape.zIndex=e,this.getScene().addObject(this._selectionShape),this._initialTitle()}_initialTitle(){const e=this._zIndex;this._rowHeaderBackground=new qt("__SpreadSheetSelectionRowHeaderBackground__"+e,{zIndex:e-1,evented:!1}),this._rowHeaderBorder=new qt("__SpreadSheetSelectionRowHeaderBorder__"+e,{zIndex:e-1,evented:!1}),this._rowHeaderGroup=new $3("__SpreadSheetSelectionRowHeaderGroup__"+e,this._rowHeaderBackground,this._rowHeaderBorder),this._rowHeaderGroup.hide(),this._rowHeaderGroup.evented=!1,this._rowHeaderGroup.zIndex=e,this._columnHeaderBackground=new qt("__SpreadSheetSelectionColumnHeaderBackground__"+e,{zIndex:e-1,evented:!1}),this._columnHeaderBorder=new qt("__SpreadSheetSelectionColumnHeaderBorder__"+e,{zIndex:e-1,evented:!1}),this._columnHeaderGroup=new $3("__SpreadSheetSelectionColumnHeaderGroup__"+e,this._columnHeaderBackground,this._columnHeaderBorder),this._columnHeaderGroup.hide(),this._columnHeaderGroup.evented=!1,this._columnHeaderGroup.zIndex=e,this.getScene().addObjects([this._rowHeaderGroup,this._columnHeaderGroup],Cae)}_initialWidget(){const e=this._zIndex;return this._topLeftWidget=new qt("__SpreadSheetSelectionTopLeftWidget__"+e,{zIndex:e+1}),this._topCenterWidget=new qt("__SpreadSheetSelectionTopCenterWidget__"+e,{zIndex:e+1}),this._topRightWidget=new qt("__SpreadSheetSelectionTopRightWidget__"+e,{zIndex:e+1}),this._middleLeftWidget=new qt("__SpreadSheetSelectionMiddleLeftWidget__"+e,{zIndex:e+1}),this._middleRightWidget=new qt("__SpreadSheetSelectionMiddleRightWidget__"+e,{zIndex:e+1}),this._bottomLeftWidget=new qt("__SpreadSheetSelectionBottomLeftWidget__"+e,{zIndex:e+1}),this._bottomCenterWidget=new qt("__SpreadSheetSelectionBottomCenterWidget__"+e,{zIndex:e+1}),this._bottomRightWidget=new qt("__SpreadSheetSelectionBottomRightWidget__"+e,{zIndex:e+1}),[this._topLeftWidget,this._topCenterWidget,this._topRightWidget,this._middleLeftWidget,this._middleRightWidget,this._bottomLeftWidget,this._bottomCenterWidget,this._bottomRightWidget]}_updateBackgroundTitle(e,n,r){const{startX:i,startY:o,endX:s,endY:a,rangeType:l}=this._selectionModel,u=this._defaultStyle;e==null&&(e=u);const c=this._getScale(),{stroke:d,hasRowHeader:h,rowHeaderFill:f=u.rowHeaderFill,rowHeaderStroke:m=u.rowHeaderStroke,hasColumnHeader:p,columnHeaderFill:g=u.columnHeaderFill,columnHeaderStroke:v=u.columnHeaderStroke}=e;let{rowHeaderStrokeWidth:_=u.rowHeaderStrokeWidth,columnHeaderStrokeWidth:C=u.columnHeaderStrokeWidth}=e;if(_/=c,C/=c,p===!0){let y=g;this._isHeaderHighlight&&l===Rt.COLUMN&&(y=new _o(d).setAlpha(HD).toString()),this._columnHeaderBackground.setProps({fill:y}),this._columnHeaderBackground.resize(s-i,r),this._columnHeaderBorder.setProps({fill:v}),this._columnHeaderBorder.transformByState({width:s-i,height:C,top:r-C+1/c}),this._columnHeaderGroup.show(),this._columnHeaderGroup.translate(i,0)}else this._columnHeaderGroup.hide();if(this._columnHeaderGroup.makeDirty(!0),h===!0){let y=f;this._isHeaderHighlight&&l===Rt.ROW&&(y=new _o(d).setAlpha(HD).toString()),this._rowHeaderBackground.setProps({fill:y}),this._rowHeaderBackground.resize(n,a-o),this._rowHeaderBorder.setProps({fill:m}),this._rowHeaderBorder.transformByState({width:_,height:a-o,left:n-_+1/c}),this._rowHeaderGroup.show(),this._rowHeaderGroup.translate(0,o)}else this._rowHeaderGroup.hide();this._rowHeaderGroup.makeDirty(!0)}_updateBackgroundControl(e){let{startX:n,startY:r,endX:i,endY:o}=this._selectionModel;const s=this._defaultStyle;e==null&&(e=s);const a=this._getScale(),{fill:l=s.fill}=e;let{strokeWidth:u=s.strokeWidth}=e;u/=a;const c=this._selectionModel.highlightToSelection();if(n=Et(n,a),r=Et(r,a),i=Et(i,a),o=Et(o,a),!c){this._backgroundControlTop.resize(i-n,o-r),this._backgroundControlTop.setProps({fill:l}),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),this._backgroundControlMiddleRight.resize(0,0);return}let{startX:d,startY:h,endX:f,endY:m}=c;d=Et(d,a),h=Et(h,a),f=Et(f,a),m=Et(m,a);const p=Et(u/2,a),g={left:-p,top:-p,width:i-n+p*2,height:h-r+p};g.height<0&&(g.width=0,g.height=0),this._backgroundControlTop.transformByState(g);const v={left:-p,top:h-r,width:d-n+p,height:m-h};v.width<0&&(v.width=0,v.height=0),this._backgroundControlMiddleLeft.transformByState(v);const _={left:f-n-p,top:h-r,width:i-f+p*2,height:m-h};_.width<0&&(_.width=0,_.height=0),this._backgroundControlMiddleRight.transformByState(_);const C={left:-p,top:m-r,width:i-n+p*2,height:o-m+p};C.height<0&&(C.width=0,C.height=0),this._backgroundControlBottom.transformByState(C),this._backgroundControlTop.setProps({fill:l}),this._backgroundControlMiddleLeft.setProps({fill:l}),this._backgroundControlMiddleRight.setProps({fill:l}),this._backgroundControlBottom.setProps({fill:l})}_updateWidgets(e){const{startX:n,startY:r,endX:i,endY:o}=this._selectionModel,s=this._defaultStyle;e==null&&(e=s);const{stroke:a=s.stroke,widgets:l=s.widgets,widgetStroke:u=s.widgetStroke}=e,c=this._getScale();let{widgetSize:d=s.widgetSize,widgetStrokeWidth:h=s.widgetStrokeWidth}=e;d/=c,h/=c;const f={left:-d/2,center:(i-n)/2-d/2,right:i-n-d/2,top:-d/2,middle:(o-r)/2-d/2,bottom:o-r-d/2},m=d-h;this._widgetRects.forEach(p=>{p.setProps({fill:a,stroke:u})}),l.tl===!0?(this._topLeftWidget.transformByState({height:m,width:m,left:f.left,top:f.top,strokeWidth:h}),this._topLeftWidget.show()):this._topLeftWidget.hide(),l.tc===!0?(this._topCenterWidget.transformByState({height:m,width:m,left:f.center,top:f.top,strokeWidth:h}),this._topCenterWidget.show()):this._topCenterWidget.hide(),l.tr===!0?(this._topRightWidget.transformByState({height:m,width:m,left:f.right,top:f.top,strokeWidth:h}),this._topRightWidget.show()):this._topRightWidget.hide(),l.ml===!0?(this._middleLeftWidget.transformByState({height:m,width:m,left:f.left,top:f.middle,strokeWidth:h}),this._middleLeftWidget.show()):this._middleLeftWidget.hide(),l.mr===!0?(this._middleRightWidget.transformByState({height:m,width:m,left:f.right,top:f.middle,strokeWidth:h}),this._middleRightWidget.show()):this._middleRightWidget.hide(),l.bl===!0?(this._bottomLeftWidget.transformByState({height:m,width:m,left:f.left,top:f.bottom,strokeWidth:h}),this._bottomLeftWidget.show()):this._bottomLeftWidget.hide(),l.bc===!0?(this._bottomCenterWidget.transformByState({height:m,width:m,left:f.center,top:f.bottom,strokeWidth:h}),this._bottomCenterWidget.show()):this._bottomCenterWidget.hide(),l.br===!0?(this._bottomRightWidget.transformByState({height:m,width:m,left:f.right,top:f.bottom,strokeWidth:h}),this._bottomRightWidget.show()):this._bottomRightWidget.hide()}_hasWidgets(e){if(e==null)return!1;const n=Object.keys(e);if(n.length===0)return!1;for(const r of n)if(e[r]===!0)return!0;return!0}_getScale(){const e=this._getPixelRatio(),{scaleX:n,scaleY:r}=this._scene.getAncestorScale();return Math.max(n*e,r*e)}_getPureScale(){const{scaleX:e,scaleY:n}=this._scene.getAncestorScale();return Math.max(e,n)}_getPixelRatio(){var e;return((e=this._scene.getEngine())==null?void 0:e.getPixelRatio())||1}}const VD="__SpreadsheetHelperSelectionTempRect",rTe=35;class jD{constructor(e,n,r,i){V(this,"_startOffsetX",0),V(this,"_startOffsetY",0),V(this,"_relativeSelectionPositionRow",0),V(this,"_relativeSelectionPositionColumn",0),V(this,"_relativeSelectionRowLength",0),V(this,"_relativeSelectionColumnLength",0),V(this,"_moveObserver"),V(this,"_upObserver"),V(this,"_helperSelection"),V(this,"_scrollTimer"),V(this,"_targetSelection",{startY:0,endY:0,startX:0,endX:0,startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}),V(this,"_isInMergeState",!1),V(this,"_fillControlColors",[]),this._control=e,this._skeleton=n,this._scene=r,this._themeService=i,this._initialControl(),this._initialWidget(),this._initialFill(),this._control.dispose$.subscribe(()=>{this.dispose()})}get isHelperSelection(){return this._control.isHelperSelection}dispose(){var e,n;(e=this._scrollTimer)==null||e.dispose(),this._fillControlColors=[],this._clearObserverEvent(),(n=this._helperSelection)==null||n.dispose()}_clearObserverEvent(){this._scene.onPointerMoveObserver.remove(this._moveObserver),this._scene.onPointerUpObserver.remove(this._upObserver),this._moveObserver=null,this._upObserver=null}_initialControl(){const{leftControl:e,rightControl:n,topControl:r,bottomControl:i}=this._control;[e,n,r,i].forEach(o=>{o.onPointerEnterObserver.add(()=>{o.setCursor(Yt.MOVE)}),o.onPointerLeaveObserver.add(()=>{o.resetCursor()}),o.onPointerDownObserver.add(this._controlEvent.bind(this))})}_controlMoving(e,n){var r;const i=this._scene,o=i.getScrollXYByRelativeCoords(Ft.FromArray([this._startOffsetX,this._startOffsetY])),{scaleX:s,scaleY:a}=i.getAncestorScale(),l=this._skeleton.getCellPositionByOffset(e,n,s,a,o),{row:u,column:c}=l,d=this._skeleton.getRowCount()-1,h=this._skeleton.getColumnCount()-1;let f=u+this._relativeSelectionPositionRow;f<0&&(f=0);let m=f+this._relativeSelectionRowLength;m>d&&(m=d,m-f<this._relativeSelectionRowLength&&(f=m-this._relativeSelectionRowLength));let p=c+this._relativeSelectionPositionColumn;p<0&&(p=0);let g=p+this._relativeSelectionColumnLength;g>h&&(g=h,g-p<this._relativeSelectionColumnLength&&(p=g-this._relativeSelectionColumnLength));const v=this._skeleton.getNoMergeCellPositionByIndex(f,p,s,a),_=this._skeleton.getNoMergeCellPositionByIndex(m,g,s,a),C=(v==null?void 0:v.startY)||0,y=(_==null?void 0:_.endY)||0,S=(v==null?void 0:v.startX)||0,E=(_==null?void 0:_.endX)||0;(r=this._helperSelection)==null||r.transformByState({left:S,top:C,width:E-S,height:y-C}),this._targetSelection={startY:C,endY:y,startX:S,endX:E,startRow:f,endRow:m,startColumn:p,endColumn:g},this._control.selectionMoving$.next(this._targetSelection)}_controlEvent(e){const{offsetX:n,offsetY:r}=e,i=this._scene,o=i.getRelativeCoord(Ft.FromArray([n,r])),{x:s,y:a}=o,l=i.getScrollXYByRelativeCoords(o),{scaleX:u,scaleY:c}=i.getAncestorScale(),d=this._skeleton.getCellPositionByOffset(s,a,u,c,l);this._startOffsetX=s,this._startOffsetY=a;const{row:h,column:f}=d,{startRow:m,startColumn:p,endRow:g,endColumn:v}=this._control.model;let _=0,C=0;h<m?_-=1:h>g&&(_+=1),f<p?C-=1:f>v&&(C+=1),this._relativeSelectionPositionRow=m-h+_,this._relativeSelectionPositionColumn=p-f+C,this._relativeSelectionRowLength=g-m,this._relativeSelectionColumnLength=v-p;const y=this._control.selectionStyle,S=this._getScale();this.isHelperSelection&&(this._helperSelection=new qt(VD,{stroke:y.stroke,strokeWidth:y.strokeWidth/S}),i.addObject(this._helperSelection));const E=yl.create(i);E.startScroll(s,a),this._scrollTimer=E,i.disableEvent(),this._moveObserver=i.onPointerMoveObserver.add(w=>{const{offsetX:R,offsetY:D}=w,{x:I,y:k}=i.getRelativeCoord(Ft.FromArray([R,D]));this._controlMoving(I,k),i.setCursor(Yt.MOVE),E.scrolling(I,k,()=>{this._controlMoving(I,k)})}),this._upObserver=i.onPointerUpObserver.add(()=>{var w,R;(w=this._helperSelection)==null||w.dispose();const D=this._scene;D.resetCursor(),this._clearObserverEvent(),D.enableEvent(),(R=this._scrollTimer)==null||R.dispose(),this._control.selectionMoved$.next(this._targetSelection)})}_initialWidget(){const{topLeftWidget:e,topCenterWidget:n,topRightWidget:r,middleLeftWidget:i,middleRightWidget:o,bottomLeftWidget:s,bottomCenterWidget:a,bottomRightWidget:l}=this._control,u=[Yt.NORTH_WEST_RESIZE,Yt.NORTH_RESIZE,Yt.NORTH_EAST_RESIZE,Yt.WEST_RESIZE,Yt.EAST_RESIZE,Yt.SOUTH_WEST_RESIZE,Yt.SOUTH_RESIZE,Yt.SOUTH_EAST_RESIZE];[e,n,r,i,o,s,a,l].forEach((c,d)=>{c.onPointerEnterObserver.add(()=>{c.setCursor(u[d])}),c.onPointerLeaveObserver.add(()=>{c.resetCursor()}),c.onPointerDownObserver.add(h=>{this._widgetEvent(h,u[d])})})}_widgetMoving(e,n,r){const i=this._scene,o=i.getScrollXYByRelativeCoords(Ft.FromArray([this._startOffsetX,this._startOffsetY])),{scaleX:s,scaleY:a}=i.getAncestorScale(),l=this._skeleton.getCellPositionByOffset(e,n,s,a,o),{row:u,column:c}=l,{rowHeaderWidth:d,columnHeaderHeight:h}=this._skeleton;let f=this._relativeSelectionPositionRow,m=this._relativeSelectionPositionColumn,p=u,g=c;r===Yt.NORTH_WEST_RESIZE?(f=u,m=c,p=this._relativeSelectionPositionRow,g=this._relativeSelectionPositionColumn):r===Yt.NORTH_RESIZE?(f=u,m=this._relativeSelectionPositionColumn,p=this._relativeSelectionPositionRow,g=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength):r===Yt.NORTH_EAST_RESIZE?(f=u,m=this._relativeSelectionPositionColumn,p=this._relativeSelectionPositionRow,g=c):r===Yt.WEST_RESIZE?(f=this._relativeSelectionPositionRow,m=c,p=this._relativeSelectionPositionRow+this._relativeSelectionRowLength,g=this._relativeSelectionPositionColumn):r===Yt.EAST_RESIZE?p=this._relativeSelectionPositionRow+this._relativeSelectionRowLength:r===Yt.SOUTH_WEST_RESIZE?(f=this._relativeSelectionPositionRow,m=c,p=u,g=this._relativeSelectionPositionColumn):r===Yt.SOUTH_RESIZE&&(f=this._relativeSelectionPositionRow,m=this._relativeSelectionPositionColumn,p=u,g=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength);const{startRow:v,startColumn:_,endRow:C,endColumn:y}=this._swapPositions(f,m,p,g),S=this._skeleton.getNoMergeCellPositionByIndex(v,_,s,a),E=this._skeleton.getNoMergeCellPositionByIndex(C,y,s,a),w=(S==null?void 0:S.startY)||0,R=(E==null?void 0:E.endY)||0,D=(S==null?void 0:S.startX)||0,I=(E==null?void 0:E.endX)||0;this._targetSelection={startY:w,endY:R,startX:D,endX:I,startRow:f,endRow:p,startColumn:m,endColumn:g},this._control.update(this._targetSelection,d,h,this._control.selectionStyle),this._control.clearHighlight(),this._control.selectionScaling$.next(this._targetSelection)}_widgetEvent(e,n){const{offsetX:r,offsetY:i}=e,o=this._scene,s=o.getRelativeCoord(Ft.FromArray([r,i])),{x:a,y:l}=s;this._startOffsetX=r,this._startOffsetY=i;const{startRow:u,startColumn:c,endRow:d,endColumn:h}=this._control.model;this._relativeSelectionPositionRow=u,this._relativeSelectionPositionColumn=c,this._relativeSelectionRowLength=d-u,this._relativeSelectionColumnLength=h-c,n===Yt.NORTH_WEST_RESIZE?(this._relativeSelectionPositionRow=d,this._relativeSelectionPositionColumn=h):n===Yt.NORTH_RESIZE?this._relativeSelectionPositionRow=d:n===Yt.NORTH_EAST_RESIZE?this._relativeSelectionPositionRow=d:n===Yt.WEST_RESIZE?this._relativeSelectionPositionColumn=h:n===Yt.SOUTH_WEST_RESIZE&&(this._relativeSelectionPositionColumn=h);const f=yl.create(o);f.startScroll(a,l),this._scrollTimer=f,o.disableEvent(),this._moveObserver=o.onPointerMoveObserver.add(m=>{const{offsetX:p,offsetY:g}=m,{x:v,y:_}=o.getRelativeCoord(Ft.FromArray([p,g]));this._widgetMoving(v,_,n),o.setCursor(n),f.scrolling(v,_,()=>{this._widgetMoving(v,_,n)})}),this._upObserver=o.onPointerUpObserver.add(()=>{var m;const p=this._scene;p.resetCursor(),this._clearObserverEvent(),p.enableEvent(),(m=this._scrollTimer)==null||m.dispose(),this._control.selectionScaled$.next(this._targetSelection)})}_initialFill(){const{fillControl:e}=this._control;e.onPointerEnterObserver.add(()=>{e.setCursor(Yt.CROSSHAIR)}),e.onPointerLeaveObserver.add(()=>{e.resetCursor()}),e.onPointerDownObserver.add(this._fillEvent.bind(this))}_fillMoving(e,n){var r,i,o;const s=this._scene,a=s.getScrollXYByRelativeCoords(Ft.FromArray([this._startOffsetX,this._startOffsetY])),{scaleX:l,scaleY:u}=s.getAncestorScale(),c=this._skeleton.getCellPositionByOffset(e,n,l,u,a),{row:d,column:h}=c,f=s.getRelativeCoord(Ft.FromArray([e,n])),m=this._skeleton.getRowCount()-1,p=this._skeleton.getColumnCount()-1;let g=this._relativeSelectionPositionRow,v=this._relativeSelectionPositionColumn,_=this._relativeSelectionPositionRow+this._relativeSelectionRowLength,C=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength,y=!1,S=!0;if((h<v||h>C)&&d>=g&&d<=_){const $=this._fillRuler(h,v,C,this._relativeSelectionColumnLength,p);v=$.startRowOrColumn,C=$.endRowOrColumn,y=$.isLighten,S=!1}else if((d<g||d>_)&&h>=v&&h<=C){const $=this._fillRuler(d,g,_,this._relativeSelectionRowLength,m);g=$.startRowOrColumn,_=$.endRowOrColumn,y=$.isLighten}else if(Math.abs(this._startOffsetX-f.x-a.x)/2>Math.abs(this._startOffsetY-f.y-a.y)){const $=this._fillRuler(h,v,C,this._relativeSelectionColumnLength,p);v=$.startRowOrColumn,C=$.endRowOrColumn,y=$.isLighten,S=!1}else{const $=this._fillRuler(d,g,_,this._relativeSelectionRowLength,m);g=$.startRowOrColumn,_=$.endRowOrColumn,y=$.isLighten}const E=this._skeleton.getNoMergeCellPositionByIndex(g,v,l,u),w=this._skeleton.getNoMergeCellPositionByIndex(_,C,l,u),R=(E==null?void 0:E.startY)||0,D=(w==null?void 0:w.endY)||0,I=(E==null?void 0:E.startX)||0,k=(w==null?void 0:w.endX)||0;y?this._controlHandler(($,N)=>{const H=new _o(this._fillControlColors[N]).lighten(rTe).toRgbString();$.setProps({fill:H})}):this._controlHandler(($,N)=>{$.setProps({fill:this._fillControlColors[N]})});const O=S5/this._getScale();g===_&&S===!0||v===C&&S===!1?(r=this._helperSelection)==null||r.hide():((i=this._helperSelection)==null||i.transformByState({left:I-O/2,top:R-O/2,width:k-I,height:D-R}),(o=this._helperSelection)==null||o.show()),this._targetSelection={startY:R,endY:D,startX:I,endX:k,startRow:g,endRow:_,startColumn:v,endColumn:C},this._control.selectionFilling$.next(this._targetSelection)}_fillEvent(e){const{offsetX:n,offsetY:r}=e,i=this._scene,o=i.getRelativeCoord(Ft.FromArray([n,r])),{x:s,y:a}=o;this._startOffsetX=s,this._startOffsetY=a;const{startRow:l,startColumn:u,endRow:c,endColumn:d}=this._control.model;this._isInMergeState=this._hasMergeInRange(l,u,c,d),this._relativeSelectionPositionRow=l,this._relativeSelectionPositionColumn=u,this._relativeSelectionRowLength=c-l,this._relativeSelectionColumnLength=d-u;const h=this._control.selectionStyle;let f=h==null?void 0:h.stroke,m=h==null?void 0:h.strokeWidth;const p=Pu(this._themeService);f==null&&(f=p.stroke),m==null&&(m=p.strokeWidth);const g=this._getScale();m/=g;const v=S5/g,_=new _o(f).darken(2).toRgbString();this.isHelperSelection&&(this._helperSelection=new qt(VD,{stroke:_,strokeWidth:m+v/2}),i.addObject(this._helperSelection));const C=yl.create(i);C.startScroll(s,a),this._scrollTimer=C,i.disableEvent(),this._controlHandler(y=>{this._fillControlColors.push(y.fill)}),this._moveObserver=i.onPointerMoveObserver.add(y=>{const{offsetX:S,offsetY:E}=y,{x:w,y:R}=i.getRelativeCoord(Ft.FromArray([S,E]));this._fillMoving(w,R),i.setCursor(Yt.CROSSHAIR),C.scrolling(w,R,()=>{this._fillMoving(w,R)})}),this._upObserver=i.onPointerUpObserver.add(()=>{var y,S;(y=this._helperSelection)==null||y.dispose();const E=this._scene;E.resetCursor(),this._clearObserverEvent(),E.enableEvent(),(S=this._scrollTimer)==null||S.dispose(),this._control.refreshSelectionFilled(this._targetSelection),this._isInMergeState=!1,this._controlHandler((w,R)=>{w.setProps({fill:this._fillControlColors[R]})}),this._fillControlColors=[]})}_hasMergeInRange(e,n,r,i){const o=this._skeleton.mergeData;if(!o)return!1;for(const s of o){const{startRow:a,startColumn:l,endRow:u,endColumn:c}=s;if(Wk({left:n,top:e,right:i,bottom:r},{left:l,top:a,right:c,bottom:u}))return!0}return!1}_swapPositions(e,n,r,i){const o=Math.min(e,r),s=Math.min(n,i),a=Math.max(e,r),l=Math.max(n,i);return{startRow:o,startColumn:s,endRow:a,endColumn:l}}_controlHandler(e){const{leftControl:n,rightControl:r,topControl:i,bottomControl:o,backgroundControlTop:s,backgroundControlMiddleLeft:a,backgroundControlMiddleRight:l,backgroundControlBottom:u,fillControl:c}=this._control,d=[n,r,i,o,s,a,l,u,c];for(let h=0,f=d.length;h<f;h++){const m=d[h];e(m,h)}}_fillRuler(e,n,r,i,o){let s=!1;if(e<n)if(this._isInMergeState&&e<n){const a=n-e,l=i+1,u=Math.ceil(a/l);let c=n-u*l;c<0&&(c=n-(u-1)*l),n=c}else n=e;else if(e>=n&&e<=r)s=!0,r=e;else if(this._isInMergeState&&e>r){const a=e-r,l=i+1,u=Math.ceil(a/l);let c=r+u*l;c>o&&(c=r+(u-1)*l),r=c}else r=e;return{rowOrColumn:e,startRowOrColumn:n,endRowOrColumn:r,isLighten:s}}_getScale(){const{scaleX:e,scaleY:n}=this._scene.getAncestorScale();return Math.max(e,n)}}var iTe=Object.defineProperty,oTe=Object.getOwnPropertyDescriptor,sTe=(t,e,n,r)=>{for(var i=r>1?void 0:r?oTe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&iTe(e,n,i),i},zD=(t,e)=>(n,r)=>e(n,r,t);let y_=class{constructor(t,e){V(this,"hasSelection",!1),V(this,"_downObserver"),V(this,"_moveObserver"),V(this,"_upObserver"),V(this,"_controlFillConfig$",new rn(null)),V(this,"controlFillConfig$",this._controlFillConfig$.asObservable()),V(this,"_selectionControls",[]),V(this,"_startSelectionRange",{startY:0,endY:0,startX:0,endX:0,startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}),V(this,"_startOffsetX",0),V(this,"_startOffsetY",0),V(this,"_scrollTimer"),V(this,"_cancelDownObserver"),V(this,"_cancelUpObserver"),V(this,"_skeleton"),V(this,"_scene"),V(this,"_isHeaderHighlight",!0),V(this,"_isDetectMergedCell",!0),V(this,"_selectionStyle"),V(this,"_isSelectionEnabled",!0),V(this,"_isShowPreviousEnable",0),V(this,"_isRemainLastEnable",!0),V(this,"_isSkipRemainLastEnable",!1),V(this,"_selectionMoveEnd$",new rn([])),V(this,"selectionMoveEnd$",this._selectionMoveEnd$.asObservable()),V(this,"_selectionMoving$",new Qt),V(this,"selectionMoving$",this._selectionMoving$.asObservable()),V(this,"_selectionMoveStart$",new Qt),V(this,"selectionMoveStart$",this._selectionMoveStart$.asObservable()),V(this,"_activeViewport"),this._themeService=t,this._shortcutService=e,this._selectionStyle=Pu(this._themeService)}enableHeaderHighlight(){this._isHeaderHighlight=!0}disableHeaderHighlight(){this._isHeaderHighlight=!1}enableDetectMergedCell(){this._isDetectMergedCell=!0}disableDetectMergedCell(){this._isDetectMergedCell=!1}setStyle(t){this._selectionStyle=t}resetStyle(){this.setStyle(Pu(this._themeService))}enableSelection(){this._isSelectionEnabled=!0}disableSelection(){this._isSelectionEnabled=!1}enableShowPrevious(){this._isShowPreviousEnable=!0}disableShowPrevious(){this._isShowPreviousEnable=!1}enableRemainLast(){this._isRemainLastEnable=!0}disableRemainLast(){this._isRemainLastEnable=!1}enableSkipRemainLast(){this._isSkipRemainLastEnable=!0}disableSkipRemainLast(){this._isSkipRemainLastEnable=!1}getViewPort(){return this._activeViewport}addControlToCurrentByRangeData(t){const e=this.getCurrentControls();if(!e)return;const{rangeWithCoord:n,primaryWithCoord:r}=t,i=this._skeleton;let o=t.style;o==null&&(o=Pu(this._themeService));const s=this._scene;if(s==null||i==null)return;const a=new w5(s,e.length,this._isHeaderHighlight,this._themeService);new jD(a,i,s,this._themeService);const{rowHeaderWidth:l,columnHeaderHeight:u}=i;a.update(n,l,u,o,r),this._isHeaderHighlight?a.enableHeaderHighlight():a.disableHeaderHighlight(),e.push(a)}changeRuntime(t,e,n){this._skeleton=t,this._scene=e,this._activeViewport=n||e.getViewports()[0]}getSelectionDataWithStyle(){return this._selectionControls.map(t=>t.getValue())}getCurrentControls(){return this._selectionControls}_clearSelectionControls(){const t=this.getCurrentControls();if(t.length>0){for(const e of t)e.dispose();t.length=0}}getActiveSelections(){const t=this.getCurrentControls();if(t&&t.length>0)return t==null?void 0:t.map(e=>{const n=e.model,r=n.currentCell;let i=null;return r&&(i={actualRow:r.actualRow,actualColumn:r.actualColumn,isMerged:r.isMerged,isMergedMainCell:r.isMergedMainCell,startRow:r.mergeInfo.startRow,startColumn:r.mergeInfo.startColumn,endRow:r.mergeInfo.endRow,endColumn:r.mergeInfo.endColumn}),{range:{startRow:n.startRow,startColumn:n.startColumn,endRow:n.endRow,endColumn:n.endColumn},primary:i}})}getActiveRange(){const t=this.getCurrentControls(),e=t&&t[t.length-1].model;return e&&{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}getActiveSelection(){const t=this.getCurrentControls();return t&&t[t.length-1]}endSelection(){this._endSelection()}reset(){this._clearSelectionControls(),this._moveObserver=null,this._upObserver=null,this._downObserver=null}resetAndEndSelection(){this.endSelection(),this.reset()}eventTrigger(t,e=0,n=Rt.NORMAL,r,i=r5.ALL){if(this._isSelectionEnabled===!1)return;const o=this._skeleton,{offsetX:s,offsetY:a}=t,l=this._scene;if(l==null||o==null)return;r!=null&&(this._activeViewport=r);const u=l.getRelativeCoord(Ft.FromArray([s,a]));let{x:c,y:d}=u;this._startOffsetX=c,this._startOffsetY=d;const h=l.getScrollXYByRelativeCoords(u),{scaleX:f,scaleY:m}=l.getAncestorScale();n===Rt.ROW?c=0:n===Rt.COLUMN&&(d=0);const p=this._getSelectedRangeWithMerge(c,d,f,m,h);if(!p)return!1;const{rangeWithCoord:g,primaryWithCoord:v}=p,{startRow:_,startColumn:C,endColumn:y,endRow:S,startY:E,endY:w,startX:R,endX:D}=g,{rowHeaderWidth:I,columnHeaderHeight:k}=o,O={startColumn:C,startRow:_,endColumn:y,endRow:S,startY:E,endY:w,startX:R,endX:D,rangeType:n};this._startSelectionRange=O;let $=this.getActiveSelection();const N=this.getCurrentControls();if(!N)return!1;for(const te of N){if(t.button===2&&te.model.isInclude(O)){$=te;return}if(te.model.isEqual(O)){$=te;break}t.shiftKey||te.clearHighlight()}if(N.length>0&&!t.ctrlKey&&!t.shiftKey&&!this._isShowPreviousEnable&&!this._isRemainLastEnable){for(const te of N)te.dispose();N.length=0}const H=$&&$.model.currentCell;if($&&t.shiftKey&&H){const{actualRow:te,actualColumn:z,mergeInfo:A}=H,T=Math.min(te,O.startRow,A.startRow),P=Math.max(te,O.endRow,A.endRow),K=Math.min(z,O.startColumn,A.startColumn),ee=Math.max(z,O.endColumn,A.endColumn),ue=o.getMergeBounding(T,K,P,ee),fe=o.getNoMergeCellPositionByIndex(ue.startRow,ue.startColumn,f,m),Ee=o.getNoMergeCellPositionByIndex(ue.endRow,ue.endColumn,f,m),Q={startColumn:ue.startColumn,startRow:ue.startRow,endColumn:ue.endColumn,endRow:ue.endRow,startY:fe.startY,endY:Ee.endY,startX:fe.startX,endX:Ee.endX,rangeType:n},re=o.getCellByIndex(te,z,f,m);this._startSelectionRange={startColumn:re.mergeInfo.startColumn,startRow:re.mergeInfo.startRow,endColumn:re.mergeInfo.endColumn,endRow:re.mergeInfo.endRow,startY:re.mergeInfo.startY||0,endY:re.mergeInfo.endY||0,startX:re.mergeInfo.startX||0,endX:re.mergeInfo.endX||0,rangeType:n},$.update(Q,I,k,this._selectionStyle,H)}else this._isRemainLastEnable&&$&&!t.ctrlKey&&!t.shiftKey&&!this._isSkipRemainLastEnable?$.update(O,I,k,this._selectionStyle,v):($=new w5(l,N.length+e,this._isHeaderHighlight,this._themeService),new jD($,o,l,this._themeService),$.update(O,I,k,this._selectionStyle,v),N.push($));this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this.hasSelection=!0,this._endSelection(),l.disableEvent();const X=yl.create(this._scene,i);X.startScroll(c,d,r),this._scrollTimer=X,this._addCancelObserver(),(n===Rt.ROW||n===Rt.COLUMN)&&this._moving(c,d,$,n),this._moveObserver=l.onPointerMoveObserver.add(te=>{const{offsetX:z,offsetY:A}=te,{x:T,y:P}=l.getRelativeCoord(Ft.FromArray([z,A]));this._moving(T,P,$,n),X.scrolling(T,P,()=>{this._moving(T,P,$,n)})}),this._upObserver=l.onPointerUpObserver.add(te=>{this._endSelection(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()),this._shortcutService.setDisable(!1)}),this._shortcutService.setDisable(!0)}convertSelectionRangeToData(t){const{range:e,primary:n,style:r}=t;let i=this.convertRangeDataToSelection(e);return i==null&&(i={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1,startY:0,endY:0,startX:0,endX:0,rangeType:Rt.NORMAL}),{rangeWithCoord:i,primaryWithCoord:this.convertCellRangeToInfo(n),style:r}}convertRangeDataToSelection(t){const{startRow:e,startColumn:n,endRow:r,endColumn:i,rangeType:o}=t,s=this._scene,a=this._skeleton;if(s==null||a==null)return;const{scaleX:l,scaleY:u}=s.getAncestorScale(),c=a.getNoMergeCellPositionByIndex(e,n,l,u),d=a.getNoMergeCellPositionByIndex(r,i,l,u);return{startRow:e,startColumn:n,endRow:r,endColumn:i,rangeType:o,startY:(c==null?void 0:c.startY)||0,endY:(d==null?void 0:d.endY)||0,startX:(c==null?void 0:c.startX)||0,endX:(d==null?void 0:d.endX)||0}}convertCellRangeToInfo(t){if(t==null)return;const e=this._scene,n=this._skeleton;if(e==null||n==null)return;const{actualRow:r,actualColumn:i,isMerged:o,isMergedMainCell:s,startRow:a,startColumn:l,endRow:u,endColumn:c}=t,{scaleX:d,scaleY:h}=e.getAncestorScale(),f=n.getNoMergeCellPositionByIndex(r,i,d,h),m=n.getNoMergeCellPositionByIndex(a,l,d,h),p=n.getNoMergeCellPositionByIndex(u,c,d,h);return{actualRow:r,actualColumn:i,isMerged:o,isMergedMainCell:s,startX:f.startX,startY:f.startY,endX:f.endX,endY:f.endY,mergeInfo:{startRow:a,startColumn:l,endRow:u,endColumn:c,startY:(m==null?void 0:m.startY)||0,endY:(p==null?void 0:p.endY)||0,startX:(m==null?void 0:m.startX)||0,endX:(p==null?void 0:p.endX)||0}}}_moving(t,e,n,r){const i=this._skeleton,o=this._scene;if(o==null||i==null)return!1;const{startRow:s,startColumn:a,endRow:l,endColumn:u}=this._startSelectionRange,c=o.getScrollXYByRelativeCoords(Ft.FromArray([this._startOffsetX,this._startOffsetY]),this._activeViewport),{scaleX:d,scaleY:h}=o.getAncestorScale(),{rowHeaderWidth:f,columnHeaderHeight:m}=i;r===Rt.ROW?t=1/0:r===Rt.COLUMN&&(e=1/0);const p=this._getSelectedRangeWithMerge(t,e,d,h,c);if(!p)return!1;const{rangeWithCoord:g,primaryWithCoord:v}=p,{startRow:_,startColumn:C,endColumn:y,endRow:S}=g,E=Math.min(_,s),w=Math.min(C,a),R=Math.max(S,l),D=Math.max(y,u);let I={startRow:E,startColumn:w,endRow:R,endColumn:D};if(this._isDetectMergedCell&&(I=i.getSelectionBounding(E,w,R,D)),!I)return!1;const{startRow:k,startColumn:O,endRow:$,endColumn:N}=I,H=i.getNoMergeCellPositionByIndex(k,O,d,h),X=i.getNoMergeCellPositionByIndex($,N,d,h),te={startColumn:O,startRow:k,endColumn:N,endRow:$,startY:(H==null?void 0:H.startY)||0,endY:(X==null?void 0:X.endY)||0,startX:(H==null?void 0:H.startX)||0,endX:(X==null?void 0:X.endX)||0},{startRow:z,endRow:A,startColumn:T,endColumn:P}=(n==null?void 0:n.model)||{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1};(T!==O||z!==k||P!==N||A!==$)&&n!=null&&(n.update(te,f,m),this._selectionMoving$.next(this.getSelectionDataWithStyle()))}_endSelection(){var t,e;const n=this._scene;if(n==null)return;n.onPointerMoveObserver.remove(this._moveObserver),n.onPointerUpObserver.remove(this._upObserver),n.enableEvent(),(t=this._scrollTimer)==null||t.dispose();const r=(e=n.getEngine())==null?void 0:e.activeScene;r==null||r.onPointerDownObserver.remove(this._cancelDownObserver),r==null||r.onPointerUpObserver.remove(this._cancelUpObserver)}_addCancelObserver(){var t;const e=this._scene;if(e==null)return;const n=(t=e.getEngine())==null?void 0:t.activeScene;n==null||n===e||(n.onPointerDownObserver.remove(this._cancelDownObserver),n.onPointerUpObserver.remove(this._cancelUpObserver),this._cancelDownObserver=n.onPointerDownObserver.add(r=>{this._endSelection()}),this._cancelUpObserver=n.onPointerUpObserver.add(r=>{this._endSelection()}))}_getSelectedRangeWithMerge(t,e,n,r,i){var o;if(this._isDetectMergedCell){const g=(o=this._skeleton)==null?void 0:o.calculateCellIndexByPosition(t,e,n,r,i),v=ib(g);return v==null?void 0:{primaryWithCoord:g,rangeWithCoord:v}}const s=this._skeleton;if(s==null)return;const a=s.getCellPositionByOffset(t,e,n,r,i),{row:l,column:u}=a,c=s.getNoMergeCellPositionByIndex(l,u,n,r),{startX:d,startY:h,endX:f,endY:m}=c,p={startY:h,endY:m,startX:d,endX:f,startRow:l,endRow:l,startColumn:u,endColumn:u};return{primaryWithCoord:{actualRow:l,actualColumn:u,isMerged:!1,isMergedMainCell:!1,startY:h,endY:m,startX:d,endX:f,mergeInfo:p},rangeWithCoord:p}}};y_=sTe([zD(0,ne(Ki)),zD(1,Xl)],y_);const to=nn("deprecated.univer.sheet.selection-render-service");var aTe=Object.defineProperty,lTe=Object.getOwnPropertyDescriptor,uTe=(t,e,n,r)=>{for(var i=r>1?void 0:r?lTe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&aTe(e,n,i),i},WD=(t,e)=>(n,r)=>e(n,r,t);let kr=class{constructor(t,e){V(this,"_currentSkeleton",{unitId:"",sheetId:""}),V(this,"_sheetSkeletonParam",[]),V(this,"_currentSkeleton$",new rn(null)),V(this,"currentSkeleton$",this._currentSkeleton$.asObservable()),V(this,"_currentSkeletonBefore$",new rn(null)),V(this,"currentSkeletonBefore$",this._currentSkeletonBefore$.asObservable()),this._currentUniverService=t,this._localeService=e}dispose(){this._currentSkeletonBefore$.complete(),this._currentSkeleton$.complete(),this._sheetSkeletonParam=[]}getCurrent(){return this._getCurrentBySearch(this._currentSkeleton)}setCurrent(t){const e=this._getCurrentBySearch(t);if(e!=null)this._reCalculate(e);else{const{unitId:r,sheetId:i}=t,o=this._currentUniverService.getUniverSheetInstance(t.unitId),s=o==null?void 0:o.getSheetBySheetId(t.sheetId);if(s==null||o==null)return;const a=this._buildSkeleton(s,o);this._sheetSkeletonParam.push({unitId:r,sheetId:i,skeleton:a,dirty:!1})}this._currentSkeleton=t;const n=this.getCurrent();return this._currentSkeletonBefore$.next(n),this._currentSkeleton$.next(n),this.getCurrent()}reCalculate(){const t=this.getCurrent();t!=null&&this._reCalculate(t)}_reCalculate(t){t.dirty&&(t.skeleton.makeDirty(!0),t.dirty=!1),t.skeleton.calculate()}makeDirtyCurrent(t=!0){this.makeDirty(this._currentSkeleton,t)}makeDirty(t,e=!0){const n=this._getCurrentBySearch(t);n!=null&&(n.dirty=e)}_getCurrentBySearch(t){const e=this._sheetSkeletonParam.find(n=>n.unitId===t.unitId&&n.sheetId===t.sheetId);return e!=null&&(e.commandId=t.commandId),e}_buildSkeleton(t,e){const n=t.getConfig();return XC.create(t,n,t.getCellMatrix(),e.getStyles(),this._localeService)}};kr=uTe([WD(0,oe),WD(1,ne(mn))],kr);var cTe=Object.defineProperty,dTe=Object.getOwnPropertyDescriptor,hTe=(t,e,n,r)=>{for(var i=r>1?void 0:r?dTe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&cTe(e,n,i),i},nu=(t,e)=>(n,r)=>e(n,r,t);const fTe=1e4,Cf=nn("univer.mark-selection-service");let S_=class extends je{constructor(t,e,n,r,i,o,s){super(),V(this,"_shapeMap",new Map),this._currentService=t,this._renderManagerService=e,this._selectionRenderService=n,this._commandService=r,this._sheetSkeletonManagerService=i,this._themeService=o,this._selectionManagerService=s}addShape(t,e=fTe){const n=this._currentService.getCurrentUniverSheetInstance(),r=n.getActiveSheet().getSheetId(),i=De.generateRandomId();return this._shapeMap.set(i,{selection:t,subUnitId:r,unitId:n.getUnitId(),zIndex:e,control:null}),this.refreshShapes(),i}refreshShapes(){const t=this._currentService.getCurrentUniverSheetInstance().getUnitId(),e=this._currentService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();this._shapeMap.forEach(n=>{var r;const{unitId:i,subUnitId:o,selection:s,control:a,zIndex:l}=n;if(i!==t||o!==e){a&&a.dispose();return}const{style:u}=s,{scene:c}=this._renderManagerService.getRenderById(i)||{},{rangeWithCoord:d,primaryWithCoord:h}=this._selectionRenderService.convertSelectionRangeToData(s),f=(r=this._sheetSkeletonManagerService.getCurrent())==null?void 0:r.skeleton;if(!c||!f)return;const{rowHeaderWidth:m,columnHeaderHeight:p}=f,g=new w5(c,l,!1,this._themeService);g.update(d,m,p,u,h),n.control=g})}removeShape(t){const e=this._shapeMap.get(t);if(!e)return;const{control:n}=e;n&&n.dispose(),this._shapeMap.delete(t)}removeAllShapes(){for(const t of this._shapeMap.values()){const{control:e}=t;e&&e.dispose()}this._shapeMap.clear()}};S_=hTe([nu(0,oe),nu(1,kn),nu(2,to),nu(3,le),nu(4,ne(kr)),nu(5,ne(Ki)),nu(6,ne(ut))],S_);const mTe=10,pTe=6;function gTe(){return De.generateRandomId(pTe)}function vTe(t){const e=t.match(/data-copy-id="([^\s]+)"/);return e&&e[1]?e[1]:null}class _Te{constructor(){V(this,"_cache",new U5(mTe))}set(e,n){this._cache.set(e,n)}get(e){return this._cache.get(e)}del(e){this._cache.delete(e)}clear(){this._cache.clear()}}const hp=new _Te;function bTe(t){const e=new DOMParser,n=`<x-univer id="univer-root">${t}</x-univer>`;return e.parseFromString(n,"text/html").querySelector("#univer-root")}function CTe(t){const e=t.style,n={};for(let r=0;r<e.length;r++){const i=e[r],o=e.getPropertyValue(i);switch(i){case"margin-top":{const s=parseInt(o);n.spaceAbove=/pt/.test(o)?E_(s):s;break}case"margin-bottom":{const s=parseInt(o);n.spaceBelow=/pt/.test(o)?E_(s):s;break}}}return Object.getOwnPropertyNames(n).length?n:null}function E_(t){return t/.75}function XD(t,e){const n=[];for(let r=0,i=t.length;r<i;r++)t[r]===en.PARAGRAPH&&n.push({startIndex:r});if(e)for(const r of n)e.bullet&&(r.bullet=De.deepClone(e.bullet)),e.paragraphStyle&&(r.paragraphStyle=De.deepClone(e.paragraphStyle));return n}function Ry(t){const e=t.style,n={},r=t.tagName.toLowerCase();switch(r){case"b":case"em":case"strong":{n.bl=ke.TRUE;break}case"s":{n.st={s:ke.TRUE};break}case"u":{n.ul={s:ke.TRUE};break}case"i":{n.it=ke.TRUE;break}case"sub":case"sup":{n.va=r==="sup"?Cr.SUPERSCRIPT:Cr.SUBSCRIPT;break}}for(let i=0;i<e.length;i++){const o=e[i],s=e.getPropertyValue(o);switch(o){case"font-family":{n.ff=s;break}case"font-size":{const a=parseInt(s);Number.isNaN(a)||(n.fs=/pt$/.test(s)?E_(a):a);break}case"font-style":{s==="italic"&&(n.it=ke.TRUE);break}case"font-weight":{Number(s)>400&&(n.bl=ke.TRUE);break}case"text-decoration":{/underline/.test(s)?n.ul={s:ke.TRUE}:/overline/.test(s)?n.ol={s:ke.TRUE}:/line-through/.test(s)&&(n.st={s:ke.TRUE});break}case"color":{const a=new _o(s);a.isValid&&(n.cl={rgb:a.toRgbString()});break}case"background-color":{const a=new _o(s);a.isValid&&(n.bg={rgb:a.toRgbString()});break}}}return n}function YD(t,e){const n=t.tagName.toLowerCase();return typeof e=="string"?n===e:Array.isArray(e)?e.some(r=>r===n):e(t)}const YB=class GB{constructor(e){V(this,"styleCache",new Map),V(this,"styleRules",[]),V(this,"afterProcessRules",[]),V(this,"getCurrentSkeleton"),this.getCurrentSkeleton=e.getCurrentSkeleton}static use(e){if(this.pluginList.includes(e))throw new Error(`Univer paste plugin ${e.name} already added`);this.pluginList.push(e)}convert(e){const n=GB.pluginList.find(h=>h.checkPasteType(e));n&&(this.styleRules=[...n.stylesRules],this.afterProcessRules=[...n.afterProcessRules]);const r=new nt,i=bTe(e),o={dataStream:"",textRuns:[]},s=[],a=e.match(/<table.*?>([\s\S]*?)<\/table>/gi),l=[];this.process(null,i==null?void 0:i.childNodes,o,l);const{paragraphs:u,dataStream:c,textRuns:d}=o;if(u){const h=u.map(f=>f.startIndex+1);h.unshift(0);for(let f=0;f<h.length;f++){let m;f===h.length-1?m=`${c.substring(h[f])}\r
`:m=`${c.substring(h[f],h[f+1]-1)}\r
`;const p=[];d==null||d.forEach(v=>{v.st>=h[f]&&v.ed<=h[f+1]&&p.push({st:v.st-h[f],ed:v.ed-h[f],ts:v.ts})});const g=this._generateDocumentDataModelSnapshot({body:{dataStream:m,textRuns:p,paragraphs:XD(m)}});r.setValue(r.getLength(),0,{v:m,p:g}),s.push({}),a&&l.forEach(v=>{const _=r.getLength();if(v.index===f){const C=a.shift(),{cellMatrix:y,colProperties:S,rowProperties:E}=this._parseTable(C);y&&y.forValue((w,R,D)=>{r.setValue(_+w,R,D)}),s.push(...E)}})}}else{if(c){const h=`${c}\r
`,f={dataStream:h,textRuns:d,paragraphs:XD(h)},m=this._generateDocumentDataModelSnapshot({body:f});r.setValue(0,0,{v:c,p:m}),s.push({})}a&&a.forEach(h=>{const f=r.getLength(),{cellMatrix:m}=this._parseTable(h);m&&m.forValue((p,g,v)=>{r.setValue(f+p,g,v)}),s.push(...s)})}return{rowProperties:[],colProperties:[],cellMatrix:r}}_parseTable(e){const n=new nt;ETe(e);const{rowProperties:r,rowCount:i,cellMatrix:o}=yTe(e);return o&&o.forValue((s,a,l)=>{var u;const c=Owe(void 0,(u=l.properties)==null?void 0:u.style);n.setValue(s,a,{v:l.content,s:c,rowSpan:l.rowSpan,colSpan:l.colSpan})}),{rowProperties:[],colProperties:[],cellMatrix:n}}_generateDocumentDataModelSnapshot(e){var n;const r=this.getCurrentSkeleton();if(r==null)return null;const{skeleton:i}=r,o=(n=i.getBlankCellDocumentModel())==null?void 0:n.documentModel,s={...o==null?void 0:o.getSnapshot(),...e};return o==null||o.reset(s),o==null?void 0:o.getSnapshot()}process(e,n,r,i){var o,s;for(const a of n)if(a.nodeName.toLowerCase()==="table")i.push({index:((o=r==null?void 0:r.paragraphs)==null?void 0:o.length)||0});else if(a.nodeType===Node.TEXT_NODE){const l=(s=a.nodeValue)==null?void 0:s.replace(/[\r\n]/g,"");let u;e&&this.styleCache.has(e)&&(u=this.styleCache.get(e));const c={dataStream:"",textRuns:[]};r.dataStream+=l,c.dataStream+=l,u&&Object.getOwnPropertyNames(u).length&&(r.textRuns.push({st:r.dataStream.length-l.length,ed:r.dataStream.length,ts:u}),c.textRuns.push({st:r.dataStream.length-l.length,ed:r.dataStream.length,ts:u}))}else if(a.nodeType===Node.ELEMENT_NODE){const l=e?this.styleCache.get(e):{},u=this.styleRules.find(({filter:f})=>YD(a,f)),c=u?u.getStyle(a):Ry(a);this.styleCache.set(a,{...l,...c});const{childNodes:d}=a;this.process(a,d,r,i);const h=this.afterProcessRules.find(({filter:f})=>YD(a,f));h&&h.handler(r,a)}}};V(YB,"pluginList",[]);let Dy=YB;function yTe(t){const e=/<tr([\s\S]*?)>([\s\S]*?)<\/tr>/gi,n=t.matchAll(e);if(!n)return{rowProperties:[],rowCount:0,colCount:0,cellMatrix:null};const r=Array.from(n),i=r.map(a=>Iy(a[1])),{colCount:o,cellMatrix:s}=STe(r.map(a=>a[2]));return{rowProperties:i,rowCount:i.length,colCount:o,cellMatrix:s}}function STe(t){const e=new nt,n=new Map,r=/<td([\s\S]*?)>([\s\S]*?)<\/td>/gi;let i=0,o=0,s=0;return t.forEach((a,l)=>{const u=l===0,c=a.matchAll(r);o=0,Array.from(c).forEach(d=>{const h=Iy(d[1]),f=d[2].replace(/&nbsp;/g," "),m=h.rowspan?+h.rowspan:1,p=h.colspan?+h.colspan:1;if(!u){for(let v=o;v<i;v++)if(!(n.get(v)>=s)){o=v;break}}const g={content:f,properties:h};p>1&&(g.colSpan=+p),m>1&&(g.rowSpan=+m),u&&(i+=p);for(let v=o;v<o+p;v++)n.set(v,s+m-1);e.setValue(s,o,g),o+=p}),s+=1}),{colCount:i,cellMatrix:e}}function Iy(t){if(!t)return{};const e=/([\w-]+)="([^"]*)"/gi,n=t.matchAll(e),r={};return Array.from(n).forEach(i=>{const[o,s,a]=i;r[s]=a}),r}function ETe(t){const e=/<colgroup([\s\S]*?)>(.*?)<\/colgroup>/,n=t.match(e);if(!n||!n[2])return null;const r=/<col([\s\S]*?)>/g,i=n[2].matchAll(r);return i?Array.from(i).map(o=>Iy(o[1])):null}const wTe={name:"univer-doc-paste-plugin-lark",checkPasteType(t){return/lark-record-clipboard/i.test(t)},stylesRules:[{filter:["s"],getStyle(t){const e=Ry(t);return{st:{s:ke.TRUE},...e}}}],afterProcessRules:[{filter(t){return t.tagName==="DIV"&&/ace-line/i.test(t.className)},handler(t){t.paragraphs==null&&(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r"}}]},RTe=wTe,DTe={name:"univer-doc-paste-plugin-word",checkPasteType(t){return/word|mso/i.test(t)},stylesRules:[{filter:["b"],getStyle(t){const e=Ry(t);return{bl:ke.TRUE,...e}}}],afterProcessRules:[{filter(t){return t.tagName==="P"&&/mso/i.test(t.className)},handler(t,e){t.paragraphs==null&&(t.paragraphs=[]);const n={startIndex:t.dataStream.length},r=CTe(e);r&&(n.paragraphStyle=r),t.paragraphs.push(n),t.dataStream+="\r"}}]},ITe=DTe;var al=(t=>(t.COPY="COPY",t.CUT="CUT",t))(al||{});function xTe(t,e,n,r){const i=n.map(l=>{var u;return(u=l.onCopyRow)==null?void 0:u.call(l,t)}).filter(l=>!!l),o=xy(i),s=My(o),a=e.map(l=>MTe(t,l,n,r)).filter(l=>!!l).join("");return`<tr${s}>${a}</tr>`}function MTe(t,e,n,r){const i=r.getValue(t,e),o=n.map(u=>{var c;return(c=u.onCopyCellStyle)==null?void 0:c.call(u,t,e,i==null?void 0:i.rowSpan,i==null?void 0:i.colSpan)}).filter(u=>!!u),s=xy(o),a=My(s),l=n.reduce((u,c)=>{var d;return u||((d=c.onCopyCellContent)==null?void 0:d.call(c,t,e))||""},"");return`<td${a}>${l}</td>`}function OTe(t,e){return`<colgroup>${t.map(n=>{const r=e.map(o=>{var s;return(s=o.onCopyColumn)==null?void 0:s.call(o,n)}).filter(o=>!!o),i=xy(r);return`<col ${My(i)}>`}).join("")}</colgroup>`}function xy(t){return t.reduce((e,n)=>(Object.keys(n).forEach(r=>{e[r]?e[r]+=`;${n[r]}`:e[r]=n[r]}),e),{})}function My(t){return Object.keys(t).reduce((e,n)=>(e+=` ${n}="${t[n]}"`,e),"")}function TTe(t,e){const n=[];for(let r=t;r<=e;r++)n.push(r);return n}class $Te{convert(e,n,r){const{startColumn:i,endColumn:o}=n,s=OTe(TTe(i,o),r),a=[];return e.forRow((l,u)=>{a.push(xTe(l,u,r,e))}),`<google-sheets-html-origin><table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" cellpadding="0" dir="ltr" border="1" style="table-layout:fixed;font-size:10pt;font-family:Arial;width:0px;border-collapse:collapse;border:none">${s}
<tbody>${a.join("")}</tbody></table>`}}var kTe=Object.defineProperty,ATe=Object.getOwnPropertyDescriptor,NTe=(t,e,n,r)=>{for(var i=r>1?void 0:r?ATe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&kTe(e,n,i),i},H1=(t,e)=>(n,r)=>e(n,r,t);const Wi={DEFAULT_COPY:"default-copy",DEFAULT_PASTE:"default-paste",SPECIAL_PASTE_VALUE:"special-paste-value",SPECIAL_PASTE_FORMAT:"special-paste-format",SPECIAL_PASTE_COL_WIDTH:"special-paste-col-width",SPECIAL_PASTE_BESIDES_BORDER:"special-paste-besides-border"};Dy.use(ITe);Dy.use(RTe);const _c=nn("sheet.clipboard-service");let w_=class extends je{constructor(t,e,n,r,i,o,s,a){super(),V(this,"_clipboardHooks",[]),V(this,"_clipboardHooks$",new rn([])),V(this,"clipboardHooks$",this._clipboardHooks$.asObservable()),V(this,"_htmlToUSM"),V(this,"_usmToHtml"),V(this,"_copyMarkId",null),V(this,"_pasteType",Wi.DEFAULT_PASTE),this._logService=t,this._currentUniverService=e,this._selectionManagerService=n,this._clipboardInterfaceService=r,this._undoRedoService=i,this._commandService=o,this._markSelectionService=s,this._sheetSkeletonManagerService=a,this._htmlToUSM=new Dy({getCurrentSkeleton:()=>this._sheetSkeletonManagerService.getCurrent()}),this._usmToHtml=new $Te}async copy(t=al.COPY){const e=this._selectionManagerService.getLast();if(!e)return!1;const n=this._clipboardHooks;n.reduce((p,g)=>{var v;const _=(v=g.getFilteredOutRows)==null?void 0:v.call(g);return _==null||_.forEach(C=>p.add(C)),p},new Set);const{startColumn:r,startRow:i,endColumn:o,endRow:s}=e.range,a=this._currentUniverService.getCurrentUniverSheetInstance(),l=a.getActiveSheet(),u=l.getMatrixWithMergedCells(i,r,s,o),c=new nt;for(let p=i;p<=s;p++)for(let g=r;g<=o;g++){const v=u.getValue(p,g);v?c.setValue(p-i,g-r,{...GD(),...De.deepClone(v)}):c.setValue(p-i,g-r,GD())}n.forEach(p=>{var g;return(g=p.onBeforeCopy)==null?void 0:g.call(p,a.getUnitId(),l.getSheetId(),e.range)});let d=this._usmToHtml.convert(u,e.range,n);const h=LTe(c),f=gTe();d=d.replace(/(<[a-z]+)/,(p,g)=>`${g} data-copy-id="${f}"`),hp.set(f,{unitId:a.getUnitId(),subUnitId:l.getSheetId(),range:e.range,matrix:c,copyType:t}),await this._clipboardInterfaceService.write(h,d),this._markSelectionService.removeAllShapes();const m=this._selectionManagerService.createCopyPasteSelection();return this._copyMarkId=this._markSelectionService.addShape({...e,style:m}),n.forEach(p=>{var g;return(g=p.onAfterCopy)==null?void 0:g.call(p)}),!0}async cut(){return this.copy(al.CUT)}async paste(t,e=Wi.DEFAULT_PASTE){const n=t.types,r=n.indexOf(H6)!==-1?await t.getType(H6).then(o=>o&&o.text()):"",i=n.indexOf(V6)!==-1?await t.getType(V6).then(o=>o&&o.text()):"";return i?this._pasteHTML(i,e):r?this._pastePlainText(r):(this._logService.error("[SheetClipboardService]","No valid data on clipboard"),!1)}addClipboardHook(t){if(this._clipboardHooks.findIndex(n=>n.hookName===t.hookName)!==-1)return this._logService.error("[SheetClipboardService]","hook already exists",t.hookName),{dispose:()=>{}};const e=this._clipboardHooks.findIndex(n=>{const r=n.priority||0;return(t.priority||0)<r});return this._clipboardHooks.splice(e!==-1?e:this._clipboardHooks.length,0,t),this._notifyClipboardHook(),Be(()=>{const n=this._clipboardHooks.indexOf(t);n>-1&&(this._clipboardHooks.splice(n,1),this._notifyClipboardHook())})}getClipboardHooks(){return this._clipboardHooks}_notifyClipboardHook(){this._clipboardHooks$.next(this._clipboardHooks)}async _pastePlainText(t){const e=this._getPastingTarget();if(!e.selection)return!1;const n=e.selection.range,r={[n.startRow]:{[n.endColumn]:{v:t}}},i={unitId:e.unitId,subUnitId:e.subUnitId,cellValue:r};return this._commandService.syncExecuteCommand(Pt.id,i)}async _pasteHTML(t,e){const n=vTe(t);return n?this._pasteInternal(n,e):this._pasteExternal(t,e)}async _pasteExternal(t,e){const n=this._getPastingTarget(),{selection:r,unitId:i,subUnitId:o}=n;if(!r)return!1;const{rowProperties:s,colProperties:a,cellMatrix:l}=this._htmlToUSM.convert(t),{startColumn:u,endColumn:c,startRow:d,endRow:h}=l.getDataRange(),f=h-d+1,m=c-u+1;if(!l)return!1;const p=this._transformPastedData(f,m,l,r.range);return p?this._pasteUSM({rowProperties:s,colProperties:a,cellMatrix:l},{unitId:i,subUnitId:o,pastedRange:p},e):!1}async _pasteInternal(t,e){var n;const r=this._getPastingTarget(),{selection:i,unitId:o,subUnitId:s}=r,a=De.deepClone(hp.get(t)),{range:l,matrix:u}=a||{};if(!i||!u||!a||!l||!i||!u||!a)return!1;const c=(n=this._currentUniverService.getUniverSheetInstance(o))==null?void 0:n.getStyles();u.forValue((v,_,C)=>{if(typeof C.s=="string"){const y=De.deepClone(C);y.s=c==null?void 0:c.getStyleByCell(C),u.setValue(v,_,y)}});const{startColumn:d,endColumn:h,startRow:f,endRow:m}=l,p=this._transformPastedData(m-f+1,h-d+1,u,i.range);if(!p)return!1;const g=this._pasteUSM({cellMatrix:u},{unitId:o,subUnitId:s,pastedRange:p},e,{range:l,unitId:a.unitId,subUnitId:a.subUnitId,copyType:a.copyType,copyId:t});return a.copyType===al.CUT&&(hp.del(t),this._copyMarkId&&this._markSelectionService.removeShape(this._copyMarkId),this._copyMarkId=null),g}_pasteUSM(t,e,n,r){const{rowProperties:i,colProperties:o,cellMatrix:s}=t,{unitId:a,subUnitId:l,pastedRange:u}=e,{startColumn:c,endColumn:d}=u,h=d-c+1,f=this._clipboardHooks,m=[];if(f.some(y=>{var S;return m.push(y)&&((S=y.onBeforePaste)==null?void 0:S.call(y,a,l,u))===!1}))return m.forEach(y=>{var S;return(S=y.onAfterPaste)==null?void 0:S.call(y,!1)}),!1;if(!s)return!1;const p=r?{copyRange:r.range,copyType:r.copyType,unitId:r.unitId,subUnitId:r.subUnitId}:{copyType:al.COPY},g=[],v=[];f.filter(y=>!y.specialPasteInfo&&y.hookName!==Wi.DEFAULT_PASTE||n===y.hookName).forEach(y=>{var S,E,w;if(i){const I=(S=y.onPasteRows)==null?void 0:S.call(y,u,i,n);I&&(g.push(...I.redos),v.push(...I.undos))}const R=(E=y.onPasteColumns)==null?void 0:E.call(y,u,o||new Array(h).map(()=>({})),n);R&&(g.push(...R.redos),v.push(...R.undos));const D=(w=y.onPasteCells)==null?void 0:w.call(y,u,s,n,p);D&&(g.push(...D.redos),v.push(...D.undos))});const _=this._getSetSelectionOperation(a,l,u,s);_&&g.push(_),this._logService.log("[SheetClipboardService]","pasting mutations",{undoMutationsInfo:v,redoMutationsInfo:g});const C=g.every(y=>this._commandService.executeCommand(y.id,y.params));return C&&this._undoRedoService.pushUndoRedo({unitID:a,undoMutations:v,redoMutations:g}),C}_getSetSelectionOperation(t,e,n,r){var i;const o=(i=this._currentUniverService.getUniverSheetInstance(t))==null?void 0:i.getSheetBySheetId(e);if(!o)return null;const{startRow:s,startColumn:a}=n,l=qs({startRow:s,endRow:s,startColumn:a,endColumn:a},o),u=r.getValue(0,0),c=(u==null?void 0:u.rowSpan)||1,d=(u==null?void 0:u.colSpan)||1;if(c>1||d>1){const f={startRow:s,endRow:s+c-1,startColumn:a,endColumn:a+d-1};l.startRow=f.startRow,l.endRow=f.endRow,l.startColumn=f.startColumn,l.endColumn=f.endColumn,l.isMerged=!0,l.isMergedMainCell=!0}const h={unitId:t,subUnitId:e,pluginName:On,selections:[{range:n,primary:l,style:null}]};return{id:dn.id,params:h}}_getPastingTarget(){const t=this._currentUniverService.getCurrentUniverSheetInstance(),e=t.getActiveSheet(),n=this._selectionManagerService.getLast();return{unitId:t.getUnitId(),subUnitId:e.getSheetId(),selection:n}}_transformPastedData(t,e,n,r){const{startRow:i,startColumn:o,endRow:s,endColumn:a}=r,l=s-i+1,u=a-o+1,c=this._currentUniverService.getCurrentUniverSheetInstance().getActiveSheet().getMergeData().filter(g=>pt.intersects({startRow:i,startColumn:o,endRow:s,endColumn:a},g)),d=c[0];let h=0,f=0,m=0,p=0;if(d&&(h=d.startRow,f=d.startColumn,m=d.endRow,p=d.endColumn),l%t===0&&u%e===0)if(c.length>0&&(l!==t||u!==e))if(h===i&&f===o&&m===s&&p===a)if(HTe(n))for(let g=0;g<l;g++)for(let v=0;v<u;v++){const _=n.getValue(g%t,v%e);_&&n.setValue(g,v,_)}else n.forValue((g,v,_)=>{_.s=null,delete _.colSpan,delete _.rowSpan});else for(let g=0;g<l;g++)for(let v=0;v<u;v++){const _=n.getValue(g%t,v%e);_&&n.setValue(g,v,_)}else for(let g=0;g<l;g++)for(let v=0;v<u;v++){const _=n.getValue(g%t,v%e);_&&n.setValue(g,v,_)}else if(c.length>0)if(this._topLeftCellsMatch(t,e,r))r.endRow=i+t-1,r.endColumn=o+e-1;else{if(s>d.endRow||a>d.endColumn)return alert("We can't do that to a merged cell "),null;n.forValue((g,v,_)=>{_.s=null,delete _.colSpan,delete _.rowSpan})}else r.endRow=i+t-1,r.endColumn=o+e-1;return r}_topLeftCellsMatch(t,e,n){const r=this._currentUniverService.getCurrentUniverSheetInstance().getActiveSheet(),{startRow:i,startColumn:o,endRow:s,endColumn:a}=n,l=FTe(i+t-1,o,o+t-1,r),u=UTe(o+e-1,i,i+t-1,r);return!l&&!u}};w_=NTe([H1(0,hs),H1(1,oe),H1(2,ne(ut)),H1(3,D4),H1(4,At),H1(5,le),H1(6,Cf),H1(7,ne(kr))],w_);function LTe(t){let e="";return t.forRow((n,r)=>{const i=[];r.forEach(o=>{const s=t.getValue(n,o);if(s){const a=PTe(s);i.push(a)}}),e+=i.join("	"),n!==t.getLength()-1&&(e+=`
`)}),e}function PTe(t){const e=t.v;return BTe((e==null?void 0:e.toString())||"")}const BTe=t=>t.replace(/&/g,"&amp;").replace(/\ufeff/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;");function FTe(t,e,n,r){return r.getMergeData().some(i=>i.startRow<=t&&t<i.endRow&&e<=i.startColumn&&i.startColumn<=n)}function UTe(t,e,n,r){return r.getMergeData().some(i=>i.startColumn<=t&&t<i.endColumn&&e<=i.startRow&&i.startRow<=n)}function HTe(t){let e=0;return t.forValue((n,r,i)=>{if(i&&e++,e>1)return!1}),e>1}function GD(){return{p:null,v:null,s:null,f:null,si:null,t:null}}const VTe={id:b4.id,name:"sheet.command.copy",type:se.COMMAND,multi:!0,priority:1e3,preconditions:qn,handler:async t=>t.get(_c).copy()},jTe={id:V9.id,name:"sheet.command.cut",type:se.COMMAND,multi:!0,priority:1e3,preconditions:qn,handler:async t=>t.get(_c).cut()},k0={id:C4.id,type:se.COMMAND,multi:!0,name:"sheet.command.paste",priority:1e3,preconditions:qn,handler:async(t,e)=>{const n=t.get(hs);if(n.log("[SheetPasteCommand]","the focusing element is",document.activeElement),!document.execCommand("paste")){n.log("[SheetPasteCommand]","failed to execute paste command on the activeElement, trying to use clipboard API.");const r=await t.get(D4).read(),i=t.get(_c);return r.length!==0?i.paste(r[0],e==null?void 0:e.value):!1}return!1}},KB={id:"sheet.command.paste-value",type:se.COMMAND,handler:async t=>t.get(le).executeCommand(k0.id,{value:Wi.SPECIAL_PASTE_VALUE})},ZB={id:"sheet.command.paste-format",type:se.COMMAND,handler:async t=>t.get(le).executeCommand(k0.id,{value:Wi.SPECIAL_PASTE_FORMAT})},qB={id:"sheet.command.paste-col-width",type:se.COMMAND,handler:async t=>t.get(le).executeCommand(k0.id,{value:Wi.SPECIAL_PASTE_COL_WIDTH})},QB={id:"sheet.command.paste-besides-border",type:se.COMMAND,handler:async t=>t.get(le).executeCommand(k0.id,{value:Wi.SPECIAL_PASTE_BESIDES_BORDER})};function ll(t,e,n,r,i=!0,o=1,s=!0){let a={...t};r==null&&(r={startRow:0,endRow:n.getRowCount()-1,startColumn:0,endColumn:n.getColumnCount()-1});let l;switch(e){case ge.UP:for(l=t.startRow-o;l>-1&&!n.getRowVisible(l);)l-=1;l>=r.startRow?(a.startRow=l,a.endRow=l):s&&(a.startRow=r.endRow,a.endRow=r.endRow,i&&(a=ll(a,ge.LEFT,n,r,!1)));break;case ge.DOWN:for(l=t.endRow+o;l<n.getRowCount()&&!n.getRowVisible(l);)l+=1;l<=r.endRow?(a.startRow=l,a.endRow=l):s&&(a.startRow=r.startRow,a.endRow=r.startRow,i&&(a=ll(a,ge.RIGHT,n,r,!1)));break;case ge.LEFT:for(l=t.startColumn-o;l>-1&&!n.getColVisible(l);)l-=1;l>=r.startColumn?(a.startColumn=l,a.endColumn=l):s&&(a.startColumn=r.endColumn,a.endColumn=r.endColumn,i&&(a=ll(a,ge.UP,n,r,!1)));break;case ge.RIGHT:for(l=t.endColumn+o;l<n.getColumnCount()&&!n.getColVisible(l);)l+=1;l<=r.endColumn?(a.startColumn=l,a.endColumn=l):s&&(a.startColumn=r.startColumn,a.endColumn=r.startColumn,i&&(a=ll(a,ge.DOWN,n,r,!1)));break}return a}function Oy(t,e,n){const r={...t},{startRow:i,startColumn:o,endRow:s,endColumn:a}=K6(t,e,n);let l=ud(n,i,o,s,a).hasValue,u=!0,c=!0;for(;c;){if(ge.UP===e){let d=r.startRow-1;for(;d>-1&&!n.getRowVisible(d);)d-=1;if(d===-1){c=!1;break}const{hasValue:h,matrix:f}=ud(n,d,r.startColumn,d,r.endColumn);if(l&&!h&&!u){c=!1;break}else{if(f.getLength()!==0){let m=d;f.forValue(p=>{m=Math.min(p,m)}),r.startRow=m}else r.startRow=d;if(r.endRow=r.startRow,!l&&h){c=!1;break}l=h,u=!1}}if(ge.DOWN===e){let d=r.endRow+1;for(;d<n.getRowCount()&&!n.getRowVisible(d);)d+=1;if(d===n.getRowCount()){c=!1;break}const{hasValue:h,matrix:f}=ud(n,d,r.startColumn,d,r.endColumn);if(l&&!h&&!u){c=!1;break}else{if(f.getLength()!==0){let m=d;f.forValue((p,g,v)=>{m=Math.max(p+(v.rowSpan||1)-1,m)}),r.endRow=m}else r.endRow=d;if(r.startRow=r.endRow,!l&&h){c=!1;break}l=h,u=!1}}if(ge.LEFT===e){let d=r.startColumn-1;for(;d>-1&&!n.getColVisible(d);)d-=1;if(d===-1){c=!1;break}const{hasValue:h,matrix:f}=ud(n,r.startRow,d,r.endRow,d);if(l&&!h&&!u){c=!1;break}else{if(f.getLength()!==0){let m=d;f.forValue((p,g)=>{m=Math.min(g,m)}),r.startColumn=m}else r.startColumn=d;if(r.endColumn=r.startColumn,!l&&h){c=!1;break}l=h,u=!1}}if(ge.RIGHT===e){let d=r.endColumn+1;for(;d<n.getColumnCount()&&!n.getColVisible(d);)d+=1;if(d===n.getColumnCount()){c=!1;break}const{hasValue:h,matrix:f}=ud(n,r.startRow,d,r.endRow,d);if(l&&!h&&!u){c=!1;break}else{if(f.getLength()!==0){let m=d;f.forValue((p,g,v)=>{m=Math.max(g+(v.colSpan||1)-1,m)}),r.endColumn=m}else r.endColumn=d;if(r.startColumn=r.endColumn,!l&&h){c=!1;break}l=h,u=!1}}}return cs(r,n,!0)}function JB(t,e,n){return ll(t,e,n,void 0,!1,1,!1)}function zTe(t,e,n){const r=Oy(t,e,n);return cs(pt.union(r,t),n,!0)}function WTe(t,e,n){const r=JB(t,e,n),i={startRow:Math.min(t.startRow,r.startRow),startColumn:Math.min(t.startColumn,r.startColumn),endRow:Math.max(t.endRow,r.endRow),endColumn:Math.max(t.endColumn,r.endColumn)};return cs(pt.union(t,i),n)}function XTe(t,e,n,r){const i=yx(n),o=Oy(K6(t,i,r),n,r);return n===ge.UP&&o.startRow<=t.startRow?cs({...e,startColumn:t.startColumn,endColumn:t.endColumn},r,!0):n===ge.DOWN&&o.endRow>=t.endRow?cs({...e,startColumn:t.startColumn,endColumn:t.endColumn},r,!0):n===ge.LEFT&&o.startColumn<=t.startColumn?cs({...e,startRow:t.startRow,endRow:t.endRow},r,!0):n===ge.RIGHT&&o.endColumn>=t.endColumn?cs({...e,startRow:t.startRow,endRow:t.endRow},r,!0):pt.union(pt.clone(e),o)}function YTe(t,e,n){const r=yx(e),i=K6(t,r,n),o=K6(t,e,n),s=JB(i,e,n);return cs(pt.union(o,s),n,!1)}function GTe(t,e,n){const{left:r,right:i,up:o,down:s}=e,a=n.getMaxRows(),l=n.getMaxColumns();let u=!0;const c={...t};for(;u;){if(u=!1,o&&c.startRow!==0){const d=c.startRow-1;n.getMatrixWithMergedCells(d,c.startColumn,d,c.endColumn).forValue((h,f,m)=>{m.v&&(c.startRow=Math.min(h,c.startRow),c.startColumn=Math.min(f,c.startColumn),c.endColumn=Math.max(f,c.endColumn),u=!0)})}if(s&&c.endRow!==a-1){const d=c.endRow+1;n.getMatrixWithMergedCells(d,c.startColumn,d,c.endColumn).forValue((h,f,m)=>{m.v&&(c.endRow=Math.max(h+(m.rowSpan!==void 0?m.rowSpan-1:0),c.endRow),c.startColumn=Math.min(f,c.startColumn),c.endColumn=Math.max(f,c.endColumn),u=!0)})}if(r&&c.startColumn!==0){const d=c.startColumn-1;n.getMatrixWithMergedCells(c.startRow,d,c.endRow,d).forValue((h,f,m)=>{m.v&&(c.startColumn=Math.min(f,c.startColumn),c.startRow=Math.min(h,c.startRow),c.endRow=Math.max(h,c.endRow),u=!0)})}if(i&&c.endColumn!==l-1){const d=c.endColumn+1;n.getMatrixWithMergedCells(c.startRow,d,c.endRow,d).forValue((h,f,m)=>{m.v&&(c.endColumn=Math.max(f+(m.colSpan!==void 0?m.colSpan-1:0),c.endColumn),c.startRow=Math.min(h,c.startRow),c.endRow=Math.max(h,c.endRow),u=!0)})}}return c}function KD(t){return{startRow:0,startColumn:0,endRow:t.getRowCount()-1,endColumn:t.getColumnCount()-1,rangeType:Rt.ALL}}function K6(t,e,n){let r;switch(e){case ge.UP:r={startRow:t.startRow,startColumn:t.startColumn,endRow:t.startRow,endColumn:t.endColumn,rangeType:Rt.NORMAL};break;case ge.DOWN:r={startRow:t.endRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn,rangeType:Rt.NORMAL};break;case ge.LEFT:r={startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.startColumn,rangeType:Rt.NORMAL};break;case ge.RIGHT:r={startRow:t.startRow,startColumn:t.endColumn,endRow:t.endRow,endColumn:t.endColumn,rangeType:Rt.NORMAL};break;default:throw new Error("Invalid direction")}return cs(r,n,!1)}function ud(t,e,n,r,i){let o=!1;const s=t.getMatrixWithMergedCells(e,n,r,i).forValue((a,l,u)=>{if(u.v)return o=!0,!1});return{hasValue:o,matrix:s}}function R_(t,e,n){const r=pt.clone(t);if(e==null)return r;switch(n){case ge.UP:case ge.DOWN:r.startColumn=r.endColumn=e.actualColumn;break;case ge.LEFT:case ge.RIGHT:r.startRow=r.endRow=e.actualRow;break}return r}function KTe(t,e,n){const{primary:r,range:i}=t,o=pt.clone(i);switch(e){case ge.UP:case ge.DOWN:o.startRow=r.startRow,o.endRow=r.endRow;break;case ge.LEFT:case ge.RIGHT:o.startColumn=r.startColumn,o.endColumn=r.endColumn;break}const s=K6(o,e,n);switch(e){case ge.DOWN:return i.startRow<s.startRow;case ge.UP:return i.endRow>s.endRow;case ge.LEFT:return s.endColumn<i.endColumn;case ge.RIGHT:return s.startColumn>i.startColumn}}var Qs=(t=>(t[t.moveStopeOne=0]="moveStopeOne",t[t.moveGap=1]="moveGap",t[t.moveStepPage=2]="moveStepPage",t[t.moveStepEnd=3]="moveStepEnd",t))(Qs||{});const Yi={id:"sheet.command.move-selection",type:se.COMMAND,handler:async(t,e)=>{if(!e)return!1;const n=t.get(oe).getCurrentUniverSheetInstance(),r=n.getActiveSheet(),i=t.get(ut).getLast();if(!i)return!1;const{direction:o,jumpOver:s}=e,{range:a,primary:l}=i,u=R_(a,l,o),c=s===1?Oy(u,o,r):ll(u,o,r),d=C5(c.startRow,c.startColumn,r);return pt.equals(d,u)?!1:(t.get(j6).remove({unitId:n.getUnitId(),sheetId:r.getSheetId(),keycode:Xe.TAB}),t.get(le).executeCommand(dn.id,{unitId:n.getUnitId(),sheetId:r.getSheetId(),pluginName:On,selections:[{range:pt.clone(d),primary:{startRow:d.startRow,startColumn:d.startColumn,endRow:d.endRow,endColumn:d.endColumn,actualRow:c.startRow,actualColumn:c.startColumn,isMerged:d.isMerged,isMergedMainCell:d.startRow===c.startRow&&d.startColumn===c.startColumn}}]}))}},bc={id:"sheet.command.move-selection-enter-tab",type:se.COMMAND,handler:async(t,e)=>{if(!e)return!1;const n=t.get(oe).getCurrentUniverSheetInstance(),r=n.getActiveSheet(),i=t.get(ut).getLast(),o=n.getUnitId(),s=r.getSheetId();if(!i)return!1;const{direction:a,keycode:l}=e,{range:u,primary:c}=i;let d=R_(u,c,a);const h=t.get(j6),f=h.getCurrentBySearch({unitId:o,sheetId:s,keycode:Xe.TAB});let m;const{startRow:p,endRow:g,startColumn:v,endColumn:_}=u;if(pt.equals(u,c)){if(l===Xe.TAB)f==null&&h.addOrUpdate({unitId:o,sheetId:s,keycode:Xe.TAB,selection:i});else{const S=f==null?void 0:f.selection;if(S!=null){const{range:E,primary:w}=S;d=R_(E,w,a)}h.remove({unitId:o,sheetId:s,keycode:Xe.TAB})}const C=ll(d,a,r),y=C5(C.startRow,C.startColumn,r);if(pt.equals(y,d))return!1;m={range:pt.clone(y),primary:{startRow:y.startRow,startColumn:y.startColumn,endRow:y.endRow,endColumn:y.endColumn,actualRow:C.startRow,actualColumn:C.startColumn,isMerged:y.isMerged,isMergedMainCell:y.startRow===C.startRow&&y.startColumn===C.startColumn}}}else{h.remove({unitId:o,sheetId:s,keycode:Xe.TAB});const C=De.deepClone(c),y=ll({startRow:C.startRow,startColumn:C.startColumn,endRow:C.endRow,endColumn:C.endColumn},a,r,{startRow:p,endRow:g,startColumn:v,endColumn:_}),S=C5(y.startRow,y.startColumn,r);m={range:pt.clone(u),primary:{startRow:S.startRow,startColumn:S.startColumn,endRow:S.endRow,endColumn:S.endColumn,actualRow:y.startRow,actualColumn:y.startColumn,isMerged:S.isMerged,isMergedMainCell:S.startRow===y.startRow&&S.startColumn===y.startColumn}}}return t.get(le).executeCommand(dn.id,{unitId:o,sheetId:s,pluginName:On,selections:[m]})}},Js={id:"sheet.command.expand-selection",type:se.COMMAND,handler:async(t,e)=>{if(!e)return!1;const n=t.get(oe).getCurrentUniverSheetInstance(),r=n.getActiveSheet(),i=t.get(ut).getLast();if(!i)return!1;const{range:o,primary:s}=i,{jumpOver:a,direction:l}=e,u=KTe(i,l,r)?a===1?XTe(o,{...pt.clone(s),rangeType:Rt.NORMAL},l,r):YTe(o,l,r):a===1?zTe(o,l,r):WTe(o,l,r);return pt.equals(u,o)?!1:t.get(le).executeCommand(dn.id,{unitId:n.getUnitId(),sheetId:r.getSheetId(),pluginName:On,selections:[{range:u,primary:s}]})}};let ra=[],fp="";const eF={id:"sheet.command.select-all",type:se.COMMAND,onDispose(){ra=[],fp=""},handler:async(t,e={expandToGapFirst:!0,loop:!1})=>{const n=t.get(ut).getLast(),r=t.get(oe).getCurrentUniverSheetInstance(),i=r.getActiveSheet();if(!n||!i)return!1;const o=`${r.getUnitId()}|${i.getSheetId()}`;o!==fp&&(ra=[],fp=o);const s=i.getMaxRows(),a=i.getMaxColumns(),{expandToGapFirst:l,loop:u}=e,{range:c,primary:d}=n,h=c.endColumn===a-1&&c.endRow===s-1&&c.startRow===0&&c.startColumn===0;ra.some(m=>pt.equals(m,c))||(ra=[],ra.push(c));let f;if(h)if(u){if(ra.findIndex(m=>pt.equals(m,c))!==ra.length-1)return!1;f=ra[0]}else return!1;else l?(f=GTe(c,{left:!0,right:!0,up:!0,down:!0},i),pt.equals(f,c)&&(f=KD(i))):f=KD(i);return ra.some(m=>pt.equals(m,f))||ra.push(f),t.get(le).executeCommand(dn.id,{unitId:r.getUnitId(),sheetId:i.getSheetId(),pluginName:On,selections:[{range:f,primary:d}]})}},ZTe=h0("BEFORE_CELL_EDIT"),qTe=h0("AFTER_CELL_EDIT");class QTe extends je{constructor(){super(),V(this,"_state",null),V(this,"_isForceKeepVisible",!1),V(this,"_editorIsDirty",!1),V(this,"_visible",{visible:!1,eventType:Zn.Dblclick}),V(this,"_state$",new rn(null)),V(this,"state$",this._state$.asObservable()),V(this,"_visible$",new rn(this._visible)),V(this,"visible$",this._visible$.asObservable()),V(this,"_afterVisible$",new rn(this._visible)),V(this,"afterVisible$",this._afterVisible$.asObservable()),V(this,"interceptor",new sM({BEFORE_CELL_EDIT:ZTe,AFTER_CELL_EDIT:qTe})),this.disposeWithMe(Be(()=>{this._state$.complete(),this._state=null})),this.disposeWithMe(Be(this.interceptor.intercept(this.interceptor.getInterceptPoints().AFTER_CELL_EDIT,{priority:-1,handler:e=>e}))),this.disposeWithMe(Be(this.interceptor.intercept(this.interceptor.getInterceptPoints().BEFORE_CELL_EDIT,{priority:-1,handler:e=>e})))}setState(e){this._state=e,this._state$.next(e)}getState(){return this._state}getCurrentEditorId(){var e;return(e=this._state)==null?void 0:e.editorUnitId}changeVisible(e){this._visible=e,e.visible&&(this._editorIsDirty=!1),this._visible$.next(this._visible),this._afterVisible$.next(this._visible)}isVisible(){return this._visible}enableForceKeepVisible(){this._isForceKeepVisible=!0}disableForceKeepVisible(){this._isForceKeepVisible=!1}isForceKeepVisible(){return this._isForceKeepVisible}changeEditorDirty(e){this._editorIsDirty=e}getEditorDirty(){return this._editorIsDirty}}const Eo=nn("univer.sheet-editor-bridge.service"),$a={id:"sheet.operation.set-cell-edit-visible",type:se.OPERATION,handler:(t,e)=>{const n=t.get(Eo);return e==null?!1:(n.changeVisible(e),!0)}},R5={id:"sheet.operation.set-cell-edit-visible-arrow",type:se.OPERATION,handler:()=>!0};let Yl=class{constructor(){V(this,"_scrollInfo",new Map),V(this,"_currentScroll",null),V(this,"_scrollInfo$",new rn(null)),V(this,"scrollInfo$",this._scrollInfo$.asObservable())}dispose(){this._scrollInfo$.complete()}setCurrentScroll(e){this._currentScroll=e,this._refresh(e)}getScrollByParam(e){return this._getCurrentScroll(e)}getCurrentScroll(){return this._getCurrentScroll(this._currentScroll)}addOrReplace(e){this._currentScroll!=null&&this._addByParam({...this._currentScroll,...e})}addOrReplaceNoRefresh(e){this._currentScroll!=null&&this._addByParam({...this._currentScroll,...e},!1)}addOrReplaceByParam(e){this._addByParam(e)}clear(){this._currentScroll!=null&&this._clearByParam(this._currentScroll)}_addByParam(e,n=!0){const{unitId:r,sheetId:i,sheetViewStartColumn:o,sheetViewStartRow:s,offsetX:a,offsetY:l}=e;this._scrollInfo.has(r)||this._scrollInfo.set(r,new Map),this._scrollInfo.get(r).set(i,{sheetViewStartRow:s,sheetViewStartColumn:o,offsetX:a,offsetY:l}),n===!0&&this._refresh({unitId:r,sheetId:i})}_clearByParam(e){this._addByParam({...e,sheetViewStartRow:0,sheetViewStartColumn:0,offsetX:0,offsetY:0}),this._refresh(e)}_getCurrentScroll(e){var n;if(e==null)return;const{unitId:r,sheetId:i}=e;return(n=this._scrollInfo.get(r))==null?void 0:n.get(i)}_refresh(e){this._scrollInfo$.next(this._getCurrentScroll(e))}};const yf={id:"sheet.operation.set-scroll",type:se.OPERATION,handler:(t,e)=>{if(!e)return!1;const n=t.get(Yl),r=t.get(oe).getUniverSheetInstance(e.unitId).getSheetBySheetId(e.sheetId),{xSplit:i,ySplit:o}=r.getConfig().freeze;return n.addOrReplaceByParam({...e,sheetViewStartRow:e.sheetViewStartRow-o,sheetViewStartColumn:e.sheetViewStartColumn-i}),!0}},Sf={id:"sheet.operation.set-editor-resize",type:se.OPERATION,handler:(t,e)=>!0},Gl={id:"sheet.operation.set-zoom-ratio",type:se.OPERATION,handler:(t,e)=>{const n=t.get(oe).getUniverSheetInstance(e.unitId);if(!n)return!1;const r=n.getSheetBySheetId(e.subUnitId);return r?(r.getConfig().zoomRatio=e.zoomRatio,!0):!1}};var zi=(t=>(t.MAIN="__SpreadsheetRender__",t.ROW="__SpreadsheetRowHeader__",t.COLUMN="__SpreadsheetColumnHeader__",t.LEFT_TOP="__SpreadsheetLeftTopPlaceholder__",t))(zi||{}),Kn=(t=>(t.VIEW_MAIN="viewMain",t.VIEW_MAIN_LEFT_TOP="viewMainLeftTop",t.VIEW_MAIN_TOP="viewMainTop",t.VIEW_MAIN_LEFT="viewMainLeft",t.VIEW_ROW_TOP="viewRowTop",t.VIEW_ROW_BOTTOM="viewRowBottom",t.VIEW_COLUMN_LEFT="viewColumnLeft",t.VIEW_COLUMN_RIGHT="viewColumnRight",t.VIEW_LEFT_TOP="viewLeftTop",t))(Kn||{});const ZD=0,Pl=2,D_=[10,400],qD=1001;var tF={exports:{}},Ef={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JTe=Qe,e$e=Symbol.for("react.element"),t$e=Symbol.for("react.fragment"),n$e=Object.prototype.hasOwnProperty,r$e=JTe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i$e={key:!0,ref:!0,__self:!0,__source:!0};function nF(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)n$e.call(e,r)&&!i$e.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:e$e,type:t,key:o,ref:s,props:i,_owner:r$e.current}}Ef.Fragment=t$e;Ef.jsx=nF;Ef.jsxs=nF;tF.exports=Ef;var F=tF.exports,is=function(){return is=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},is.apply(this,arguments)},o$e=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},Yo=b.forwardRef(function(t,e){var n=t.icon,r=t.id,i=t.className,o=t.extend,s=o$e(t,["icon","id","className","extend"]),a="univerjs-icon univerjs-icon-".concat(r," ").concat(i||"").trim(),l=b.useRef("_".concat(l$e()));return rF(n,"".concat(r),{defIds:n.defIds,idSuffix:l.current},is({ref:e,className:a},s),o)});function rF(t,e,n,r,i){return b.createElement(t.tag,is(is({key:e},s$e(t,n,i)),r),(a$e(t,n).children||[]).map(function(o,s){return rF(o,"".concat(e,"-").concat(t.tag,"-").concat(s),n,void 0,i)}))}function s$e(t,e,n){var r=is({},t.attrs);n!=null&&n.colorChannel1&&r.fill==="colorChannel1"&&(r.fill=n.colorChannel1);var i=e.defIds;return!i||i.length===0||(t.tag==="use"&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+e.idSuffix),Object.entries(r).forEach(function(o){var s=o[0],a=o[1];typeof a=="string"&&(r[s]=a.replace(/url\(#(.*)\)/,"url(#$1".concat(e.idSuffix,")")))})),r}function a$e(t,e){var n,r=e.defIds;return!r||r.length===0?t:t.tag==="defs"&&!((n=t.children)===null||n===void 0)&&n.length?is(is({},t),{children:t.children.map(function(i){return typeof i.attrs.id=="string"&&r&&r.indexOf(i.attrs.id)>-1?is(is({},i),{attrs:is(is({},i.attrs),{id:i.attrs.id+e.idSuffix})}):i})}):t}function l$e(){return Math.random().toString(36).substring(2,8)}Yo.displayName="UniverIcon";var u$e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M11.5261 12.834V14.634C11.5261 14.9654 11.7948 15.234 12.1261 15.234V15.234C12.4575 15.234 12.7261 14.9654 12.7261 14.634V12.834H14.5262C14.8576 12.834 15.1262 12.5654 15.1262 12.234V12.234C15.1262 11.9027 14.8576 11.634 14.5262 11.634H12.7261V9.83401C12.7261 9.50264 12.4575 9.23401 12.1261 9.23401V9.23401C11.7948 9.23401 11.5261 9.50264 11.5261 9.83401V11.634H9.72622C9.39485 11.634 9.12622 11.9027 9.12622 12.234V12.234C9.12622 12.5654 9.39485 12.834 9.72622 12.834H11.5261Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.05352 1.9613C2.39077 1.9613 1.85352 2.49856 1.85352 3.1613V6.7613C1.85352 7.42405 2.39077 7.9613 3.05352 7.9613H6.65352C7.31626 7.9613 7.85352 7.42405 7.85352 6.7613V3.1613C7.85352 2.49856 7.31626 1.9613 6.65352 1.9613H3.05352zM6.65352 3.1613H3.05352L3.05352 6.7613H6.65352V3.1613zM3.05352 9.23401C2.39077 9.23401 1.85352 9.77127 1.85352 10.434V14.034C1.85352 14.6968 2.39077 15.234 3.05352 15.234H6.65352C7.31626 15.234 7.85352 14.6968 7.85352 14.034V10.434C7.85352 9.77127 7.31626 9.23401 6.65352 9.23401H3.05352zM6.65352 10.434H3.05352L3.05352 14.034H6.65352V10.434zM10.3262 7.9613C9.66348 7.9613 9.12622 7.42405 9.12622 6.7613V3.1613C9.12622 2.49856 9.66348 1.9613 10.3262 1.9613H13.9262C14.589 1.9613 15.1262 2.49856 15.1262 3.1613V6.7613C15.1262 7.42405 14.589 7.9613 13.9262 7.9613H10.3262zM10.3262 6.7613V3.1613L13.9262 3.1613V6.7613H10.3262z",fillRule:"evenodd",clipRule:"evenodd"}}]},iF=b.forwardRef(function(t,e){return b.createElement(Yo,Object.assign({},t,{id:"autofill",ref:e,icon:u$e}))});iF.displayName="Autofill";const c$e=iF;var d$e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.6152 4.52067C14.8732 4.77869 14.8732 5.19703 14.6152 5.45505L6.61862 13.4514C6.46241 13.6077 6.20915 13.6077 6.05294 13.4514L1.73512 9.13354C1.4771 8.87551 1.4771 8.45718 1.73513 8.19915C1.99315 7.94113 2.41149 7.94114 2.66951 8.19916L6.19436 11.7241C6.27247 11.8022 6.3991 11.8022 6.47721 11.7241L13.6808 4.52067C13.9388 4.26264 14.3571 4.26264 14.6152 4.52067Z",fillRule:"evenodd",clipRule:"evenodd"}}]},oF=b.forwardRef(function(t,e){return b.createElement(Yo,Object.assign({},t,{id:"check-mark-single",ref:e,icon:d$e}))});oF.displayName="CheckMarkSingle";const D5=oF;var h$e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.48712 4.59907C5.23328 4.34523 4.82172 4.34523 4.56788 4.59907C4.31404 4.85291 4.31404 5.26447 4.56788 5.51831L7.9973 8.94773L4.56773 12.3773C4.31389 12.6311 4.31389 13.0427 4.56773 13.2965C4.82157 13.5504 5.23313 13.5504 5.48697 13.2965L8.91654 9.86697L12.3461 13.2965C12.5999 13.5503 13.0114 13.5503 13.2653 13.2965C13.5191 13.0426 13.5191 12.6311 13.2653 12.3772L9.83577 8.94773L13.2651 5.51836C13.519 5.26452 13.519 4.85296 13.2651 4.59912C13.0113 4.34528 12.5997 4.34528 12.3459 4.59912L8.91654 8.02849L5.48712 4.59907Z"}}]},sF=b.forwardRef(function(t,e){return b.createElement(Yo,Object.assign({},t,{id:"close-single",ref:e,icon:h$e}))});sF.displayName="CloseSingle";const f$e=sF;var m$e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1213",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.54 0.32H16.54V16.32H0.54z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_1213)"},children:[{tag:"path",attrs:{d:"M1.76539 1.27148C1.89532 1.2465 2.05784 1.23193 2.25712 1.23193H7.39957C7.59852 1.23193 7.76228 1.24644 7.89394 1.27682 8.02979 1.30817 8.13912 1.36697 8.22237 1.45577 8.30591 1.54488 8.35813 1.6636 8.38857 1.80057L8.38913 1.80311C8.41406 1.93772 8.42854 2.10966 8.42854 2.31825V7.47982C8.42854 7.67924 8.41396 7.84153 8.38908 7.97584 8.36281 8.11247 8.3041 8.22717 8.22073 8.31054 8.13704 8.39424 8.02807 8.4472 7.89934 8.4781 7.77208 8.50864 7.60803 8.52313 7.41869 8.52313H2.25712C2.06419 8.52313 1.90591 8.51354 1.77494 8.48836 1.64209 8.46281 1.53156 8.41527 1.4464 8.33054 1.3606 8.24999 1.30815 8.13434 1.27781 8.00286 1.2476 7.87192 1.22815 7.69892 1.22815 7.47982V2.27524C1.22815 2.07123 1.24271 1.90413 1.26761 1.76966 1.29388 1.63303 1.35259 1.51833 1.43596 1.43496 1.52104 1.34988 1.63137 1.30236 1.76275 1.27204L1.76539 1.27148zM2.56975 2.39137C2.49306 2.39568 2.45433 2.41469 2.43395 2.43562 2.41191 2.46884 2.39718 2.51452 2.39715 2.57614L2.40631 4.24285H4.26296V2.39137H2.56975zM5.44152 2.39615V4.24285H7.24998V2.51898C7.24998 2.47398 7.24652 2.44245 7.24141 2.42201 7.23917 2.41305 7.23709 2.40806 7.23591 2.40567 7.22586 2.40059 7.20631 2.39615 7.16061 2.39615H5.44152zM2.40708 5.39751L2.41626 7.22616C2.41626 7.26829 2.41965 7.29933 2.42492 7.32085 2.42882 7.33675 2.43309 7.34502 2.43572 7.34893 2.43572 7.34893 2.43928 7.35079 2.44202 7.35193 2.44831 7.35455 2.45718 7.35739 2.46908 7.35996 2.49304 7.36512 2.52583 7.36847 2.56777 7.36847H4.26774V5.39751H2.40708zM5.44152 5.39751V7.36847H7.09848C7.1739 7.36847 7.21416 7.35941 7.23151 7.35088 7.23281 7.34891 7.23591 7.34357 7.23933 7.33216 7.24553 7.3115 7.24998 7.27978 7.24998 7.23608V5.39751H5.44152zM9.19356 8.15082C9.3235 8.12583 9.48601 8.11127 9.6853 8.11127H14.8277C15.0267 8.11127 15.1905 8.12577 15.3221 8.15616 15.458 8.18751 15.5673 8.2463 15.6506 8.33511 15.7341 8.42421 15.7863 8.54294 15.8167 8.67991L15.8173 8.68245C15.8422 8.81705 15.8567 8.98899 15.8567 9.19759V14.3592C15.8567 14.5586 15.8421 14.7209 15.8173 14.8552 15.791 14.9918 15.7323 15.1065 15.6489 15.1899 15.5652 15.2736 15.4562 15.3265 15.3275 15.3574 15.2003 15.388 15.0362 15.4025 14.8469 15.4025H9.6853C9.49237 15.4025 9.33408 15.3929 9.20312 15.3677 9.07027 15.3421 8.95974 15.2946 8.87458 15.2099 8.78878 15.1293 8.73633 15.0137 8.70599 14.8822 8.67578 14.7513 8.65633 14.5783 8.65633 14.3592V9.15457C8.65633 8.95057 8.67088 8.78346 8.69579 8.649 8.72206 8.51237 8.78077 8.39767 8.86414 8.3143 8.94922 8.22922 9.05955 8.1817 9.19093 8.15138L9.19356 8.15082zM9.99793 9.27071C9.92124 9.27501 9.88251 9.29403 9.86212 9.31496 9.84009 9.34817 9.82536 9.39386 9.82533 9.45548L9.83448 11.1222H11.6911V9.27071H9.99793zM12.8697 9.27549V11.1222H14.6782V9.39831C14.6782 9.35332 14.6747 9.32178 14.6696 9.30135 14.6673 9.29238 14.6653 9.2874 14.6641 9.285 14.654 9.27992 14.6345 9.27549 14.5888 9.27549H12.8697zM9.83525 12.2768L9.84444 14.1055C9.84444 14.1476 9.84783 14.1787 9.8531 14.2002 9.85699 14.2161 9.86127 14.2244 9.86389 14.2283L9.86689 14.2298 9.87019 14.2313C9.87648 14.2339 9.88535 14.2367 9.89726 14.2393 9.92122 14.2445 9.95401 14.2478 9.99594 14.2478H11.6959V12.2768H9.83525zM12.8697 12.2768V14.2478H14.5267C14.6021 14.2478 14.6423 14.2387 14.6597 14.2302 14.661 14.2282 14.6641 14.2229 14.6675 14.2115 14.6737 14.1908 14.6782 14.1591 14.6782 14.1154V12.2768H12.8697z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M10.0049 2.46747C10.0049 2.06363 10.3323 1.73625 10.7361 1.73625H12.9298C14.1413 1.73625 15.1234 2.71838 15.1234 3.9299V6.12354C15.1234 6.52738 14.796 6.85476 14.3922 6.85476 13.9883 6.85476 13.661 6.52738 13.661 6.12354V3.9299C13.661 3.52606 13.3336 3.19868 12.9298 3.19868H10.7361C10.3323 3.19868 10.0049 2.87131 10.0049 2.46747zM3.42396 10.5108C3.42396 10.107 3.09658 9.77962 2.69274 9.77962 2.2889 9.77962 1.96152 10.107 1.96152 10.5108V12.7045C1.96152 13.916 2.94365 14.8981 4.15517 14.8981H6.34882C6.75266 14.8981 7.08003 14.5707 7.08003 14.1669 7.08003 13.7631 6.75266 13.4357 6.34882 13.4357H4.15517C3.75134 13.4357 3.42396 13.1083 3.42396 12.7045V10.5108z"}}]}]},aF=b.forwardRef(function(t,e){return b.createElement(Yo,Object.assign({},t,{id:"convert-single",ref:e,icon:m$e}))});aF.displayName="ConvertSingle";const p$e=aF;var g$e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_371_77",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.87 0.63H16.87V16.63H0.87z"}}]},{tag:"g",attrs:{mask:"url(#mask0_371_77)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M9.72636 13.5549C9.25212 14.1041 8.48323 14.1041 8.00899 13.5549L1.22579 5.70056C0.46078 4.81474 1.00259 3.30013 2.08448 3.30013L15.6509 3.30013C16.7328 3.30013 17.2746 4.81474 16.5096 5.70056L9.72636 13.5549Z"}}]}]},lF=b.forwardRef(function(t,e){return b.createElement(Yo,Object.assign({},t,{id:"dropdown-single",ref:e,icon:g$e}))});lF.displayName="DropdownSingle";const QD=lF;var v$e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.90535 4.99197C2.23194 4.82196 2.63451 4.94889 2.80452 5.27548C2.96702 5.58764 3.22397 5.8971 3.57667 6.18615C4.57587 7.00507 6.2535 7.58331 8.21318 7.58331C10.1728 7.58331 11.8505 7.00508 12.8497 6.18616C13.2024 5.8971 13.4593 5.58763 13.6218 5.27549C13.7918 4.94889 14.1944 4.82196 14.521 4.99196C14.8476 5.16197 14.9745 5.56454 14.8045 5.89113C14.5439 6.39185 14.1596 6.83646 13.6948 7.2174C13.6514 7.25301 13.6071 7.28815 13.5621 7.3228L15.0214 8.78205C15.2817 9.0424 15.2817 9.46451 15.0214 9.72486C14.761 9.98521 14.3389 9.98521 14.0785 9.72486L12.3889 8.03522C11.8643 8.28584 11.2846 8.48827 10.6659 8.63563L11.2065 10.6532C11.3018 11.0088 11.0907 11.3744 10.7351 11.4697C10.3794 11.565 10.0139 11.3539 9.91857 10.9983L9.34529 8.85869C8.97555 8.89693 8.59724 8.91664 8.21318 8.91664C7.82639 8.91664 7.44544 8.89665 7.07321 8.85788L6.49971 10.9983C6.40441 11.354 6.03886 11.565 5.68321 11.4697C5.32757 11.3744 5.11651 11.0089 5.2118 10.6532L5.75288 8.63382C5.13793 8.48682 4.5615 8.28539 4.03968 8.03629L2.35121 9.72477C2.09086 9.98512 1.66875 9.98512 1.4084 9.72477C1.14805 9.46442 1.14805 9.04231 1.4084 8.78196L2.86611 7.32424C2.82044 7.28912 2.77557 7.2535 2.73152 7.2174C2.26668 6.83645 1.88248 6.39184 1.62183 5.89114C1.45182 5.56455 1.57876 5.16198 1.90535 4.99197Z"}}]},uF=b.forwardRef(function(t,e){return b.createElement(Yo,Object.assign({},t,{id:"eyelash-single",ref:e,icon:v$e}))});uF.displayName="EyelashSingle";const _$e=uF;var b$e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_367_60",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.06 0.78H16.06V16.78H0.06z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_367_60)"},children:[{tag:"path",attrs:{d:"M5.54303 5.67809C5.41486 5.67809 5.31977 5.55923 5.34791 5.43419L5.43336 5.05446C5.53338 4.62534 5.71701 4.25903 5.99076 3.96308 6.28977 3.63984 6.73293 3.49761 7.27633 3.49761 7.47741 3.49761 7.69254 3.52131 7.92082 3.56601 7.93983 3.56973 7.95869 3.57361 7.9774 3.57766 8.18885 3.62335 8.41593 3.52833 8.49925 3.32869L8.72661 2.78395C8.81351 2.57574 8.71072 2.3376 8.49476 2.27229 8.46253 2.26255 8.42923 2.25268 8.39485 2.24269 8.10639 2.15986 7.76287 2.11572 7.35969 2.11572 6.29909 2.11572 5.50608 2.38292 4.95354 2.88796 4.38882 3.40424 3.98783 4.14273 3.76308 5.11976L2.31598 11.3345C2.2402 11.6722 2.14495 12.0353 2.02739 12.4247 1.90869 12.8169 1.76625 13.2031 1.60116 13.5809 1.43472 13.9595 1.24707 14.3197 1.0385 14.6607.972389 14.7687.904093 14.8718.833608 14.9698.744025 15.0945.813644 15.2766.965497 15.2989 1.6153 15.3945 2.29684 15.2198 2.66091 14.6732 2.80556 14.456 2.94673 14.2082 3.08403 13.9287 3.44529 13.1932 3.78416 12.1538 4.09761 10.801L4.94794 7.15889C4.96907 7.06839 5.04977 7.00436 5.14271 7.00436H7.10372C7.28864 7.00436 7.44946 6.87761 7.49265 6.6978L7.61908 6.17153C7.67951 5.91998 7.48886 5.67809 7.23015 5.67809H5.54303zM13.8 5.86392L11.9914 8.11319 10.8878 5.92109C10.8211 5.77368 10.6743 5.67896 10.5125 5.67896H9.79183C9.48739 5.67896 9.28816 5.99784 9.42165 6.27145L10.8878 9.19857 8.27677 12.2928C8.04481 12.5594 8.23414 12.9751 8.58749 12.9751H9.16501C9.28566 12.9751 9.43944 12.9258 9.5177 12.834L11.5897 10.4084 12.5966 12.7046C12.6575 12.8666 12.8119 12.9751 12.9851 12.9751H13.779C14.062 12.9751 14.2207 12.7611 14.1216 12.4959L12.6517 9.42983C12.6517 9.42983 14.8799 6.59898 15.0802 6.32247 15.2756 6.05285 15.0812 5.67896 14.7482 5.67896H14.145C14.0064 5.67896 13.9122 5.73242 13.8 5.86392z"}}]}]},cF=b.forwardRef(function(t,e){return b.createElement(Yo,Object.assign({},t,{id:"fx-single",ref:e,icon:b$e}))});cF.displayName="FxSingle";const C$e=cF;var y$e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_249",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.37 0.77H16.37V16.77H0.37z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_249)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M9.12107 2.86418C9.12107 2.45648 8.78669 2.12598 8.37422 2.12598C7.96175 2.12598 7.62737 2.45648 7.62737 2.86418V8.03164H2.39931C1.98684 8.03164 1.65247 8.36214 1.65247 8.76984C1.65247 9.17754 1.98684 9.50805 2.39931 9.50805H7.62737V14.6754C7.62737 15.0831 7.96175 15.4136 8.37422 15.4136C8.78669 15.4136 9.12107 15.0831 9.12107 14.6754V9.50805H14.3489C14.7613 9.50805 15.0957 9.17754 15.0957 8.76984C15.0957 8.36214 14.7613 8.03164 14.3489 8.03164H9.12107V2.86418Z"}}]}]},dF=b.forwardRef(function(t,e){return b.createElement(Yo,Object.assign({},t,{id:"increase-single",ref:e,icon:y$e}))});dF.displayName="IncreaseSingle";const S$e=dF;var E$e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_556",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.56 0.77H16.56V16.77H0.56z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_556)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.19318 4.76988C1.70089 4.26222 2.524 4.26226 3.03166 4.76997L8.13929 9.87808C8.3736 10.1124 8.75352 10.1124 8.98784 9.8781L14.0959 4.77C14.6036 4.26232 15.4267 4.26232 15.9344 4.77C16.4421 5.27768 16.4421 6.1008 15.9344 6.60848L9.97775 12.5651C9.19667 13.3462 7.93029 13.3462 7.14925 12.5651L1.1931 6.60836C0.685438 6.10065 0.685477 5.27753 1.19318 4.76988Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},hF=b.forwardRef(function(t,e){return b.createElement(Yo,Object.assign({},t,{id:"more-down-single",ref:e,icon:E$e}))});hF.displayName="MoreDownSingle";const I_=hF;var w$e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.52628 3.57095C5.81918 3.26411 6.29405 3.26411 6.58695 3.57095L11.0869 8.28525C11.3798 8.59209 11.3798 9.08958 11.0869 9.39642L6.51623 14.04C6.22334 14.3468 5.74846 14.3468 5.45557 14.04C5.16268 13.7331 5.16268 13.2357 5.45557 12.9288L9.35939 8.979C9.43544 8.90205 9.43652 8.77857 9.36182 8.70031L5.52628 4.68212C5.23339 4.37528 5.23339 3.87779 5.52628 3.57095Z",fillRule:"evenodd",clipRule:"evenodd"}}]},fF=b.forwardRef(function(t,e){return b.createElement(Yo,Object.assign({},t,{id:"more-single",ref:e,icon:w$e}))});fF.displayName="MoreSingle";const JD=fF;var R$e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1204",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.25 0.41H16.25V16.41H0.25z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1204)"},children:[{tag:"rect",attrs:{width:12.62,height:2.79,x:1.94,y:12.66,fill:"colorChannel1",rx:1.4}},{tag:"path",attrs:{fill:"currentColor",d:"M7.99664 2.57069C7.59302 2.05771 7.10966 1.68854 6.63466 1.50243C6.11882 1.30028 5.40184 1.25862 4.95066 1.83566C4.5486 2.34994 4.581 3.10899 4.82709 3.91045C4.93826 4.27259 5.11865 4.62903 5.37541 4.97266C5.38713 4.98834 5.39945 5.00329 5.41229 5.01752C5.4217 5.02789 5.4314 5.03788 5.44133 5.04746C5.45477 5.06043 5.46874 5.07267 5.48315 5.08419L3.75659 6.81071C3.51774 7.04955 3.51774 7.43683 3.75659 7.67569L7.48775 11.4068C7.72666 11.6457 8.11394 11.6457 8.35278 11.4068L13.0831 6.67651C13.3219 6.43766 13.3219 6.05039 13.0831 5.81155L9.35191 2.08037C9.11306 1.84153 8.72579 1.84153 8.48695 2.08037L7.99664 2.57069ZM7.71181 4.91288C7.72271 4.98224 7.73182 5.05302 7.73898 5.12518C7.77251 5.46131 8.07213 5.70663 8.40825 5.6731C8.74438 5.6396 8.98972 5.33994 8.9562 5.00382C8.90804 4.52113 8.79269 4.0731 8.6291 3.66819L8.91946 3.37784L11.7856 6.24403L10.8608 7.16886H5.12843L7.6582 4.63909C7.67903 4.72777 7.69702 4.81905 7.71181 4.91288ZM7.12302 3.44433C6.8246 3.02658 6.47279 2.75283 6.18833 2.64136C6.05252 2.58814 5.96546 2.58477 5.92656 2.58984C5.92268 2.59037 5.91947 2.59093 5.91678 2.59147L5.91208 2.59257C5.89185 2.62604 5.78612 2.86628 5.99645 3.5514C6.0626 3.76685 6.1728 3.99252 6.34325 4.2241L7.12302 3.44433Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.4434 11.9528C12.8956 11.9528 13.2622 11.5862 13.2622 11.134C13.2622 10.854 12.9483 10.3347 12.7092 9.9798C12.5801 9.78823 12.3066 9.78823 12.1776 9.97981C11.9385 10.3347 11.6246 10.854 11.6246 11.134C11.6246 11.5862 11.9912 11.9528 12.4434 11.9528Z"}}]}]},mF=b.forwardRef(function(t,e){return b.createElement(Yo,Object.assign({},t,{id:"paint-bucket",ref:e,icon:R$e}))});mF.displayName="PaintBucket";const D$e=mF;var I$e={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.80805 1.53809C2.10674 1.53809 1.53821 2.10661 1.53821 2.80793V13.6016C1.53821 14.3029 2.10674 14.8714 2.80805 14.8714H9.74456C10.2968 14.8714 10.7446 14.4237 10.7446 13.8714V13.6016V11.128C10.7446 10.9623 10.8789 10.828 11.0446 10.828H13.6017H13.8715C14.4238 10.828 14.8715 10.3803 14.8715 9.82802V2.80793C14.8715 2.10661 14.303 1.53809 13.6017 1.53809H2.80805ZM9.17472 13.6016C9.3404 13.6016 9.47472 13.4673 9.47472 13.3016V11.128C9.47472 10.9623 9.3404 10.828 9.17472 10.828H6.91757C6.75189 10.828 6.61757 10.9623 6.61757 11.128V13.3016C6.61757 13.4673 6.75189 13.6016 6.91757 13.6016H9.17472ZM13.6017 9.25817C13.6017 9.42386 13.4674 9.55818 13.3017 9.55818H11.0446C10.8789 9.55818 10.7446 9.42386 10.7446 9.25818V7.17177C10.7446 7.00608 10.8789 6.87177 11.0446 6.87177H13.3017C13.4674 6.87177 13.6017 7.00608 13.6017 7.17177V9.25817ZM9.17472 9.55818C9.3404 9.55818 9.47472 9.42386 9.47472 9.25818V7.17177C9.47472 7.00608 9.3404 6.87177 9.17472 6.87177H6.91757C6.75189 6.87177 6.61757 7.00608 6.61757 7.17177V9.25817C6.61757 9.42386 6.75189 9.55818 6.91757 9.55818H9.17472ZM13.6017 5.30193C13.6017 5.46761 13.4674 5.60193 13.3017 5.60193H11.0446C10.8789 5.60193 10.7446 5.46761 10.7446 5.30193V3.10793C10.7446 2.94224 10.8789 2.80793 11.0446 2.80793H13.3017C13.4674 2.80793 13.6017 2.94224 13.6017 3.10793V5.30193ZM9.17472 5.60193C9.3404 5.60193 9.47472 5.46761 9.47472 5.30193V3.10793C9.47472 2.94224 9.3404 2.80793 9.17472 2.80793H6.91757C6.75189 2.80793 6.61757 2.94224 6.61757 3.10793V5.30193C6.61757 5.46761 6.75189 5.60193 6.91757 5.60193H9.17472ZM5.34773 3.10793C5.34773 2.94224 5.21342 2.80793 5.04773 2.80793H3.10805C2.94236 2.80793 2.80805 2.94224 2.80805 3.10793V5.30193C2.80805 5.46761 2.94236 5.60193 3.10805 5.60193H5.04773C5.21342 5.60193 5.34773 5.46761 5.34773 5.30193V3.10793ZM5.34773 7.17177C5.34773 7.00608 5.21342 6.87177 5.04773 6.87177H3.10805C2.94236 6.87177 2.80805 7.00608 2.80805 7.17177V9.25817C2.80805 9.42386 2.94236 9.55818 3.10805 9.55818H5.04773C5.21342 9.55818 5.34773 9.42386 5.34773 9.25818V7.17177ZM5.34773 11.128C5.34773 10.9623 5.21342 10.828 5.04773 10.828H3.10805C2.94236 10.828 2.80805 10.9623 2.80805 11.128V13.3016C2.80805 13.4673 2.94236 13.6016 3.10805 13.6016H5.04773C5.21342 13.6016 5.34773 13.4673 5.34773 13.3016V11.128Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.3869 12.1183C12.361 11.9546 12.5342 11.8323 12.6798 11.9114L14.9901 13.1655C15.1577 13.2565 15.1137 13.5049 14.932 13.5378C14.9212 13.5398 14.9102 13.5417 14.8996 13.5446L13.8966 13.8224L13.1603 14.7467C13.0651 14.9084 12.8197 14.8618 12.7904 14.6764L12.3869 12.1183Z"}}]},pF=b.forwardRef(function(t,e){return b.createElement(Yo,Object.assign({},t,{id:"select-range-single",ref:e,icon:I$e}))});pF.displayName="SelectRangeSingle";const x$e=pF,M$e="univer-range-selector",O$e="univer-range-selector-editor",T$e="univer-range-selector-icon",$$e="univer-range-selector-active",ru={rangeSelector:M$e,rangeSelectorEditor:O$e,rangeSelectorIcon:T$e,rangeSelectorActive:$$e};function k$e(t){const{onChange:e,onActive:n}=t,[r,i]=b.useState(!1),o=b.useRef(null),s=_t(mn),a=_t(ut);b.useEffect(()=>{var h;if(r){n(r);const f=a.selectionMoveEnd$.subscribe(m=>{const p=["A1","B2:C3","Sheet2!A1:B2","D10:E11,F1:G2,H3:I4"],g=Math.floor(Math.random()*p.length),v=p[g];o.current&&(o.current.innerHTML=v)});return document.addEventListener("click",l),()=>{document.removeEventListener("click",l),f.unsubscribe()}}e(((h=o.current)==null?void 0:h.innerHTML)||"")},[r]);function l(h){var f,m,p;if((f=h.target)!=null&&f.closest('[data-range-selector="true"]')||h.target===o.current)return;const g=(m=h.target)==null?void 0:m.closest(`.${ru.rangeSelector}`);(g==null?void 0:g.querySelector(`.${ru.rangeSelectorEditor}`))!==o.current&&(i(!1),(p=o.current)==null||p.blur())}function u(h){h.stopPropagation(),h.key==="Enter"&&(h.preventDefault(),h.currentTarget.blur(),i(!1))}function c(){i(!0)}function d(){var h;if(!r){(h=o.current)==null||h.focus();return}i(!r)}return F.jsxs("div",{className:r?`${ru.rangeSelector} ${ru.rangeSelectorActive}`:ru.rangeSelector,children:[F.jsx("div",{ref:o,className:ru.rangeSelectorEditor,contentEditable:!0,"data-placeholder":s.t("rangeSelector.placeholder"),onKeyDown:u,onFocus:c}),F.jsx(p4,{title:s.t("rangeSelector.tooltip"),placement:"bottom",children:F.jsx("button",{className:ru.rangeSelectorIcon,onClick:d,children:F.jsx(x$e,{})})})]})}const x_={:0,:1,:2,:3,:4,:5,:6,:7,:8,:9},I5=["","","","","","","","","",""],eI=["","","","",""],A$e=["","","",""],gF={:{value:10,secUnit:!1},:{value:100,secUnit:!1},:{value:1e3,secUnit:!1},:{value:1e4,secUnit:!0},:{value:1e8,secUnit:!0}};function r1(t){if(!t)return 0;let e=0,n=0,r=0,i=!1;const o=t.split("");for(let s=0;s<o.length;s++){const a=x_[o[s]];if(typeof a<"u")r=a,s===o.length-1&&(n+=r);else{const l=gF[o[s]],u=l.value;i=l.secUnit,i?(n=(n+r)*u,e+=n,n=0):n+=r*u,r=0}}return e+n}function N$e(t){let e="",n="",r=0,i=!0;for(;t>0;){const o=t%10;o===0?i||(i=!0,n=I5[o]+n):(i=!1,e=I5[o],e+=A$e[r],n=e+n),r++,t=Math.floor(t/10)}return n}function L$e(t){let e=0,n="",r="",i=!1;if(t===0)return I5[0];for(;t>0;){const o=t%1e4;i&&(r=I5[0]+r),n=N$e(o),n+=o!==0?eI[e]:eI[0],r=n+r,i=o<1e3&&o>0,t=Math.floor(t/1e4),e++}return r}function P$e(t){if(!t)return!1;let e=!0;if(t)if(t.length===1)t===""||t in x_?e=!0:e=!1;else{const n=t.split("");for(let r=0;r<n.length;r++)if(!(n[r]in x_||n[r]in gF)){e=!1;break}}return e}function Q7(t){if(!t)return{isExtendNumber:!1};const e=/0|([1-9]+[0-9]*)/g,n=e.test(t);if(n){const r=t.match(e);if(r&&r.length>0){const i=r[r.length-1],o=t.lastIndexOf(i),s=t.substr(0,o),a=t.substr(o+i.length);return{isExtendNumber:!0,matchTxt:Number(i),beforeTxt:s,afterTxt:a}}return{isExtendNumber:!1}}return{isExtendNumber:n}}function B$e(t){let e;return t.length===2&&(t===""||t===""||t===""||t===""||t===""||t===""||t==="")?e=!0:e=!1,e}function F$e(t){let e;return t.length===3&&(t===""||t===""||t===""||t===""||t===""||t===""||t==="")?e=!0:e=!1,e}function U$e(t,e){let n=0;for(let r=0;r<t.length&&t[r]<e;r++)n++;return n}function j4(t){let e=!0;const n=t[1]-t[0];for(let r=1;r<t.length;r++)if(t[r]-t[r-1]!==n){e=!1;break}return e}function H$e(t,e,n){const r=[],i=Math.floor(e/t),o=e%t;let s=0;if(i>0){for(let a=0;a<i;a++)for(let l=0;l<n.length;l++)r[n[l]+a*t]=s,s++;for(let a=0;a<n.length&&n[a]<o;a++)r[n[a]+t*i]=s,s++}else for(let a=0;a<n.length&&n[a]<o;a++)r[n[a]]=s,s++;return r}function ic(t,e){const n=[];for(let r=1;r<=e;r++){const i=(r-1)%t.length,o=De.deepClone(t[i]);n.push(o)}return n}function V$e(t,e){var n;const r=[];for(let i=1;i<=e;i++){const o=(i-1)%t.length,s={s:(n=t[o])==null?void 0:n.s};r.push(s)}return r}function j$e(t){let e=!0;const n=t[1]/t[0];for(let r=1;r<t.length;r++)if(t[r]/t[r-1]!==n){e=!1;break}return e}function z$e(t){const e=[];for(let n=1;n<=t;n++)e.push(n);return e}function W$e(t,e,n){var r,i,o,s,a,l,u;const c=[],d=[];for(let h=0;h<t.length;h++)d.push(Number((r=t[h])==null?void 0:r.v));if(t.length>2&&j$e(d))for(let h=1;h<=e;h++){const f=(h-1)%t.length,m=De.deepClone(t[f]);let p;n===ge.DOWN||n===ge.RIGHT?p=Number((i=t[t.length-1])==null?void 0:i.v)*(Number((o=t[1])==null?void 0:o.v)/Number((s=t[0])==null?void 0:s.v))**h:(n===ge.UP||n===ge.LEFT)&&(p=Number((a=t[0])==null?void 0:a.v)/(Number((l=t[1])==null?void 0:l.v)/Number((u=t[0])==null?void 0:u.v))**h),m&&(m.v=p,c.push(m))}else{const h=z$e(t.length);for(let f=1;f<=e;f++){const m=(f-1)%t.length,p=De.deepClone(t[m]);let g;n===ge.DOWN||n===ge.RIGHT?g=tI(t.length+f,d,h):g=tI(1-f,d,h),p&&(p.v=g,c.push(p))}}return c}function tI(t,e,n){function r(c){let d=0;for(let h=0;h<c.length;h++)d+=c[h];return d/c.length}const i=r(n),o=r(e);let s=0,a=0;for(let c=0;c<n.length;c++)s+=(n[c]-i)*(e[c]-o),a+=(n[c]-i)*(n[c]-i);let l;a===0?l=1:l=s/a;const u=o-l*i;return Math.round((u+l*t)*1e5)/1e5}function nI(t,e,n){var r;const i=[],o=/0|([1-9]+[0-9]*)/g;for(let s=1;s<=e;s++){const a=(s-1)%t.length,l=De.deepClone(t[a]),u=`${(r=t[t.length-1])==null?void 0:r.v}`,c=u==null?void 0:u.match(o),d=c==null?void 0:c[c.length-1],h=Math.abs(Number(d)+n*s);if(!u||!d)continue;const f=u.lastIndexOf(d),m=u.substr(0,f)+h.toString()+u.substr(f+d.length);l&&(l.v=m,i.push(l))}return i}function s0(t,e,n,r=0){var i,o;const s=[["","","","","","",""],["","","","","","",""],["","","","","","",""]];if(r>=s.length)return[];const a=s[r],l=[];for(let u=1;u<=e;u++){const c=(u-1)%t.length,d=De.deepClone(t[c]);let h=0;if(((i=t[t.length-1])==null?void 0:i.v)===a[0])h=7+n*u;else{const m=`${(o=t[t.length-1])==null?void 0:o.v}`;if(m){const p=m.substr(m.length-1,1);h=r1(p)+n*u}}h<0&&(h=Math.ceil(Math.abs(h)/7)*7+h);const f=h%7;d&&(d.v=a[f],l.push(d))}return l}function rI(t,e,n){var r;const i=[];for(let o=1;o<=e;o++){const s=(o-1)%t.length,a=De.deepClone(t[s]),l=`${(r=t[t.length-1])==null?void 0:r.v}`,u=r1(l)+n*o;let c;u<=0?c="":c=L$e(u),a&&(a.v=c,i.push(a))}return i}const i6={enWeek1:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],enWeek2:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],enMonth1:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],enMonth2:["January","February","March","April","May","June","July","August","September","October","November","December"],chnMonth1:["","","","","","","","","","","",""],chnMonth2:["","","","","","","","","","","",""],chHour1:["","","","","","","","","","","",""],chHour2:["","","","","","","","","","","",""],chYear1:["","","","","","","","","",""],chSeason1:["","","",""],chSeason2:["","","",""]};function X$e(t){let e=!1;return Object.keys(i6).forEach(n=>{i6[n].includes(t)&&(e=!0)}),e}function mp(t){let e="";const n=[];return Object.keys(i6).forEach(r=>{i6[r].includes(t)&&(e=r,n.push(...i6[r]))}),{name:e,series:n}}function iI(t,e,n,r){var i;const o=r.length,s=[];for(let a=1;a<=e;a++){const l=(a-1)%t.length,u=De.deepClone(t[l]),c=`${(i=t[t.length-1])==null?void 0:i.v}`,d=(r.indexOf(c)+n*a)%o;u&&(u.v=r[d],s.push(u))}return s}function Y$e(t,e){const n=[];let r;if(e.startRow<t.startRow)r=ge.UP;else if(e.endRow>t.endRow)r=ge.DOWN;else if(e.startColumn<t.startColumn)r=ge.LEFT;else if(e.endColumn>t.endColumn)r=ge.RIGHT;else return[];if(r===ge.DOWN||r===ge.UP){const i=t.endRow-t.startRow+1,o=e.endRow-e.startRow+1,s=o/i,a=o%i,l={startRow:0,startColumn:0,endRow:t.endRow-t.startRow,endColumn:t.endColumn-t.startColumn};if(r===ge.DOWN){for(let u=0;u<s;u++)n.push({repeatStartCell:{row:t.startRow+(u+1)*i,col:t.startColumn},relativeRange:l});a>0&&n.push({repeatStartCell:{row:t.startRow+(s+1)*i,col:t.startColumn},relativeRange:{startRow:0,startColumn:0,endRow:a-1,endColumn:t.endColumn-t.startColumn}})}else{for(let u=0;u<s;u++)n.push({repeatStartCell:{row:t.startRow-(u+1)*i,col:t.startColumn},relativeRange:l});a>0&&n.push({repeatStartCell:{row:t.startRow-(s+1)*i,col:t.startColumn},relativeRange:{startRow:i-a,endRow:i-1,startColumn:0,endColumn:t.endColumn-t.startColumn}})}}if(r===ge.RIGHT||r===ge.LEFT){const i=t.endColumn-t.startColumn+1,o=e.endColumn-e.startColumn+1,s=o/i,a=o%i,l={startRow:0,startColumn:0,endRow:t.endRow-t.startRow,endColumn:t.endColumn-t.startColumn};if(r===ge.RIGHT){for(let u=0;u<s;u++)n.push({repeatStartCell:{row:t.startRow,col:t.startColumn+(u+1)*i},relativeRange:l});a>0&&n.push({repeatStartCell:{row:t.startRow,col:t.startColumn+(s+1)*i},relativeRange:{startRow:0,startColumn:0,endRow:t.endRow-t.startRow,endColumn:a-1}})}else{for(let u=0;u<s;u++)n.push({repeatStartCell:{row:t.startRow,col:t.startColumn-(u+1)*i},relativeRange:l});a>0&&n.push({repeatStartCell:{row:t.startRow,col:t.startColumn-(s+1)*i},relativeRange:{startRow:0,startColumn:i-a,endRow:t.endRow-t.startRow,endColumn:i-1}})}}return n}var ai=(t=>(t.NUMBER="number",t.DATE="date",t.EXTEND_NUMBER="extendNumber",t.CHN_NUMBER="chnNumber",t.CHN_WEEK2="chnWeek2",t.CHN_WEEK3="chnWeek3",t.LOOP_SERIES="loopSeries",t.FORMULA="formula",t.OTHER="other",t))(ai||{}),Mn=(t=>(t.COPY="0",t.SERIES="1",t.ONLY_FORMAT="2",t.NO_FORMAT="3",t))(Mn||{});const G$e={type:ai.NUMBER,priority:1e3,match:t=>typeof(t==null?void 0:t.v)=="number"||!isNaN(Number(t==null?void 0:t.v)),isContinue:(t,e)=>t.type===ai.NUMBER,applyFunctions:{[Mn.SERIES]:(t,e,n)=>{const{data:r}=t;return(n===ge.LEFT||n===ge.UP)&&r.reverse(),W$e(r,e,n)}}},vF={type:ai.OTHER,priority:0,match:()=>!0,isContinue:(t,e)=>t.type===ai.OTHER},K$e={type:ai.EXTEND_NUMBER,priority:900,match:t=>Q7(`${t==null?void 0:t.v}`||"").isExtendNumber,isContinue:(t,e)=>{var n;if(t.type===ai.EXTEND_NUMBER){const{beforeTxt:r,afterTxt:i}=Q7(`${(n=t.cellData)==null?void 0:n.v}`||""),{beforeTxt:o,afterTxt:s}=Q7(`${e==null?void 0:e.v}`||"");if(r===o&&i===s)return!0}return!1},applyFunctions:{[Mn.SERIES]:(t,e,n)=>{var r;const{data:i}=t;let o;if(i.length===1)return o=n===ge.DOWN||n===ge.RIGHT?1:-1,nI(i,e,o);const s=[];for(let a=0;a<i.length;a++){const l=`${(r=i[a])==null?void 0:r.v}`;l&&s.push(Number(Q7(l).matchTxt))}return(n===ge.UP||n===ge.LEFT)&&(i.reverse(),s.reverse()),j4(s)?(o=s[1]-s[0],nI(i,e,o)):ic(i,e)}}},Z$e={type:ai.CHN_NUMBER,priority:830,match:t=>!!P$e(`${t==null?void 0:t.v}`||""),isContinue:(t,e)=>t.type===ai.CHN_NUMBER,applyFunctions:{[Mn.SERIES]:(t,e,n)=>{var r,i,o;const{data:s}=t,a=n===ge.LEFT||n===ge.UP;if(s.length===1){const d=`${(r=s[0])==null?void 0:r.v}`;let h;return a?h=-1:h=1,d&&(d===""||r1(d)<7)?s0(s,e,h):rI(s,e,h)}let l=!1;for(let d=0;d<s.length;d++)if(((i=s[d])==null?void 0:i.v)===""){l=!0;break}const u=[];let c=0;for(let d=0;d<s.length;d++){const h=`${(o=s[d])==null?void 0:o.v}`;h===""?d===0?u.push(0):(c++,u.push(c*7)):l&&r1(h)>0&&r1(h)<7?u.push(r1(h)+c*7):u.push(r1(h))}if(a&&(s.reverse(),u.reverse()),j4(u)){if(l||u[u.length-1]<6&&u[0]>0||u[0]<6&&u[u.length-1]>0){const h=u[1]-u[0];return s0(s,e,h)}const d=u[1]-u[0];return rI(s,e,d)}return ic(s,e)}}},q$e={type:ai.CHN_WEEK2,priority:820,match:t=>!!B$e(`${t==null?void 0:t.v}`||""),isContinue:(t,e)=>t.type===ai.CHN_WEEK2,applyFunctions:{[Mn.SERIES]:(t,e,n)=>{var r;const{data:i}=t,o=n===ge.LEFT||n===ge.UP;if(i.length===1){let l;return o?l=-1:l=1,s0(i,e,l,1)}const s=[];let a=0;for(let l=0;l<i.length;l++){const u=`${(r=i[l])==null?void 0:r.v}`,c=u==null?void 0:u.substr(u.length-1,1);u===""?l===0?s.push(0):(a++,s.push(a*7)):s.push(r1(c)+a*7)}if(o&&(i.reverse(),s.reverse()),j4(s)){const l=s[1]-s[0];return s0(i,e,l,1)}return ic(i,e)}}},Q$e={type:ai.CHN_WEEK3,priority:810,match:t=>F$e(`${t==null?void 0:t.v}`||""),isContinue:(t,e)=>t.type===ai.CHN_WEEK3,applyFunctions:{[Mn.SERIES]:(t,e,n)=>{var r;const{data:i}=t,o=n===ge.LEFT||n===ge.UP;if(i.length===1){let l;return o?l=-1:l=1,s0(i,e,l,2)}const s=[];let a=0;for(let l=0;l<i.length;l++){const u=`${(r=i[l])==null?void 0:r.v}`;if(u){const c=u.substr(u.length-1,1);u===""?l===0?s.push(0):(a++,s.push(a*7)):s.push(r1(c)+a*7)}}if(o&&(i.reverse(),s.reverse()),j4(s)){const l=s[1]-s[0];return s0(i,e,l,2)}return ic(i,e)}}},J$e={type:ai.LOOP_SERIES,priority:800,match:t=>X$e(`${t==null?void 0:t.v}`||""),isContinue:(t,e)=>{var n;return t.type===ai.LOOP_SERIES?mp(`${(n=t.cellData)==null?void 0:n.v}`||"").name===mp(`${e==null?void 0:e.v}`||"").name:!1},applyFunctions:{[Mn.SERIES]:(t,e,n)=>{var r,i;const{data:o}=t,s=n===ge.LEFT||n===ge.UP,{series:a}=mp(`${(r=o[0])==null?void 0:r.v}`||"");if(o.length===1){let c;return s?c=-1:c=1,iI(o,e,c,a)}const l=[];let u=0;for(let c=0;c<o.length;c++){const d=`${(i=o[c])==null?void 0:i.v}`;d&&(d===a[0]?c===0?l.push(0):(u++,l.push(u*a.length)):l.push(a.indexOf(d)+u*7))}if(s&&(o.reverse(),l.reverse()),j4(l)){const c=l[1]-l[0];return iI(o,e,c,a)}return ic(o,e)}}};var eke=Object.defineProperty,tke=Object.getOwnPropertyDescriptor,nke=(t,e,n,r)=>{for(var i=r>1?void 0:r?tke(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&eke(e,n,i),i},pp=(t,e)=>(n,r)=>e(n,r,t);let u8=class extends je{constructor(t,e,n){super(),V(this,"_rules",[]),V(this,"_hooks",[]),V(this,"_applyType$",new rn(Mn.SERIES)),V(this,"_isFillingStyle",!0),V(this,"_sourceRange",null),V(this,"_destRange",null),V(this,"_applyRange",null),V(this,"applyType$",this._applyType$.asObservable()),V(this,"_menu$",new rn([{label:"autoFill.copy",value:Mn.COPY,disable:!1},{label:"autoFill.series",value:Mn.SERIES,disable:!1},{label:"autoFill.formatOnly",value:Mn.ONLY_FORMAT,disable:!1},{label:"autoFill.noFormat",value:Mn.NO_FORMAT,disable:!1}])),V(this,"menu$",this._menu$.asObservable()),this._sheetInterceptorService=t,this._univerInstanceService=e,this._selectionManagerService=n,this._init()}_init(){this._rules=[G$e,K$e,Z$e,q$e,Q$e,J$e,vF].sort((t,e)=>e.priority-t.priority),this._isFillingStyle=!0}addHook(t){if(this._hooks.find(e=>e.hookName===t.hookName))throw new Error(`Add hook failed, hook name '${t.hookName}' already exist!`);return this._hooks.push(t),Be(()=>{const e=this._hooks.findIndex(n=>n===t);e>-1&&this._hooks.splice(e,1)})}registerRule(t){if(this._rules.find(n=>n.type===t.type))throw new Error(`Registry rule failed, type '${t.type}' already exist!`);const e=this._rules.findIndex(n=>n.priority<t.priority);this._rules.splice(e===-1?this._rules.length:e,0,t)}getRules(){return this._rules}getHooks(){return this._hooks}getApplyType(){return this._applyType$.getValue()}setApplyType(t){this._applyType$.next(t)}isFillingStyle(){return this._isFillingStyle}setFillingStyle(t){this._isFillingStyle=t}setRanges(t,e,n){this._sourceRange=e,this._destRange=t,this._applyRange=n}getRanges(){return{sourceRange:this._sourceRange,destRange:this._destRange,applyRange:this._applyRange}}setDisableApplyType(t,e){this._menu$.next(this._menu$.getValue().map(n=>n.value===t?{...n,disable:e}:n))}};u8=nke([yt(it.Rendered,u8),pp(0,ne(En)),pp(1,ne(oe)),pp(2,ne(ut))],u8);const A0=nn("univer.auto-fill-service");var rke=Object.defineProperty,ike=Object.getOwnPropertyDescriptor,oke=(t,e,n,r)=>{for(var i=r>1?void 0:r?ike(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&rke(e,n,i),i},Uc=(t,e)=>(n,r)=>e(n,r,t);let c8=class extends je{constructor(e,n,r,i,o,s){super(),V(this,"_direction",null),V(this,"_beforeApplyData",[]),V(this,"_applyType",Mn.SERIES),V(this,"_hasFillingStyle",!0),V(this,"_copyData",[]),this._univerInstanceService=e,this._selectionRenderService=n,this._commandService=r,this._autoFillService=i,this._editorBridgeService=o,this._selectionManagerService=s,this._init()}_init(){this._onSelectionControlFillChanged(),this._onApplyTypeChanged(),[C_,l8].forEach(e=>{this.disposeWithMe(this._commandService.registerCommand(e))})}_handleDbClickFill(e){const n=this._detectFillRange(e);n.endRow<=e.endRow||this._handleFill(e,n)}_detectFillRange(e){var n,r,i,o,s,a;const{startRow:l,endRow:u,startColumn:c,endColumn:d}=e,h=(n=this._univerInstanceService.getCurrentUniverSheetInstance())==null?void 0:n.getActiveSheet();if(!h)return e;const f=h.getCellMatrix(),m=h.getMaxRows()-1,p=h.getMaxColumns()-1;let g=u;if(c>0&&((r=f.getValue(l,c-1))==null?void 0:r.v)!=null){let v=l;for(;((i=f.getValue(v,c-1))==null?void 0:i.v)!=null&&v<m;)v+=1;g=v}else if(d<p&&((o=f.getValue(u,d+1))==null?void 0:o.v)!=null){let v=l;for(;((s=f.getValue(v,d+1))==null?void 0:s.v)!=null&&v<m;)v++;g=v}for(let v=u+1;v<=g;v++)for(let _=c;_<=d;_++)if(((a=f.getValue(v,_))==null?void 0:a.v)!=null){g=v-1;break}return{startColumn:c,endColumn:d,startRow:l,endRow:g}}_handleFill(e,n){if(!(e.startColumn===n.startColumn&&e.startRow===n.startRow&&e.endColumn===n.endColumn&&e.endRow===n.endRow)){if(n.endColumn<e.endColumn&&n.endColumn>e.startColumn){this._commandService.executeCommand(l8.id,{clearRange:{startRow:n.startRow,endRow:n.endRow,startColumn:n.endColumn+1,endColumn:e.endColumn},selectionRange:n});return}if(n.endRow<e.endRow&&n.endRow>e.startRow){this._commandService.executeCommand(l8.id,{clearRange:{startRow:n.endRow+1,endRow:e.endRow,startColumn:n.startColumn,endColumn:n.endColumn},selectionRange:n});return}this._presetAndCacheData(e,n)}}_onSelectionControlFillChanged(){const e=new Ia;this.disposeWithMe(Be(this._selectionManagerService.selectionMoveEnd$.subscribe(()=>{e.dispose();const n=this._selectionManagerService.getCurrent();(n==null?void 0:n.pluginName)===On&&this._selectionRenderService.getCurrentControls().forEach(r=>{e.add(Be(r.selectionFilled$.subscribe(i=>{if(i==null)return;const o={startColumn:r.model.startColumn,endColumn:r.model.endColumn,startRow:r.model.startRow,endRow:r.model.endRow},s={startColumn:i.startColumn,endColumn:i.endColumn,startRow:i.startRow,endRow:i.endRow};this._handleFill(o,s)}))),e.add(Be(r.fillControl.onDblclickObserver.add(()=>{const i={startColumn:r.model.startColumn,endColumn:r.model.endColumn,startRow:r.model.startRow,endRow:r.model.endRow};this._handleDbClickFill(i)}))),e.add(Be(r.fillControl.onPointerDownObserver.add(()=>{this._editorBridgeService.isVisible().visible&&this._editorBridgeService.changeVisible({visible:!1,eventType:Zn.PointerDown})})))})})))}_onApplyTypeChanged(){this.disposeWithMe(Be(this._autoFillService.applyType$.subscribe(e=>{e===Mn.NO_FORMAT?(this._applyType=Mn.SERIES,this._hasFillingStyle=!1):(this._applyType=e||Mn.SERIES,this._hasFillingStyle=!0),this._fillData()})))}_getApplyData(e,n,r,i,o,s=!0){const a=[],l=Math.floor(r/n),u=r%n,c=this._autoFillService.getRules();if(!s&&o===Mn.ONLY_FORMAT)return console.error("ERROR: only format can not be applied when hasStyle is false"),[];const d={};c.forEach(h=>{d[h.type]=[]}),c.forEach(h=>{const{type:f,applyFunctions:m={}}=h,p=e[f];p&&p.forEach(g=>{const v=U$e(g.index,u),_=g.index.length*l+v,C=this._applyFunctions(g,_,i,o,m,e),y=H$e(n,r,g.index);d[f].push({data:C,index:y})})});for(let h=0;h<r;h++)c.forEach(f=>{const{type:m}=f,p=d[m];for(let g=0;g<p.length;g++)h in p[g].index&&a.push(p[g].data[p[g].index[h]])});return a}_applyFunctions(e,n,r,i,o,s){const{data:a}=e,l=r===ge.UP||r===ge.LEFT;if(i===Mn.COPY){const u=o==null?void 0:o[Mn.COPY];return u?u(e,n,r,s):(l&&a.reverse(),ic(a,n))}if(i===Mn.SERIES){const u=o==null?void 0:o[Mn.SERIES];return u?u(e,n,r,s):(l&&a.reverse(),o!=null&&o[Mn.COPY]?o[Mn.COPY](e,n,r,s):ic(a,n))}if(i===Mn.ONLY_FORMAT){const u=o==null?void 0:o[Mn.ONLY_FORMAT];return u?u(e,n,r,s):V$e(a,n)}}_getCopyData(e,n){const{startRow:r,startColumn:i,endRow:o,endColumn:s}=e,a=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getCellMatrix(),l=this._autoFillService.getRules(),u=[],c=n===ge.DOWN||n===ge.UP;let d,h,f,m;c?(d=i,h=s,f=r,m=o):(d=r,h=o,f=i,m=s);for(let p=d;p<=h;p++){const g=this._getEmptyCopyDataPiece(),v={type:void 0,cellData:void 0};for(let _=f;_<=m;_++){let C;c?C=a.getValue(_,p):C=a.getValue(p,_);const{type:y,isContinue:S}=l.find(E=>E.match(C))||vF;if(S(v,C)){const E=g[y],w=E[E.length-1];w.data.push(C),w.index.push(_-f)}else{const E=g[y];E?E.push({data:[C],index:[_-f]}):g[y]=[{data:[C],index:[_-f]}]}v.type=y,v.cellData=C}u.push(g)}return u}_getEmptyCopyDataPiece(){const e={};return this._autoFillService.getRules().forEach(n=>{e[n.type]=[]}),e}_getMergeApplyData(e,n,r,i){const o=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getMergeData(),s=[];for(let a=e.startRow;a<=e.endRow;a++)for(let l=e.startColumn;l<=e.endColumn;l++){const{isMergedMainCell:u,startRow:c,startColumn:d,endRow:h,endColumn:f}=cc(a,l,o);if(u){if(r===ge.DOWN){let m=c+i,p=h+i;for(;p<=n.endRow;)s.push({startRow:m,startColumn:d,endRow:p,endColumn:f}),m+=i,p+=i}else if(r===ge.UP){let m=c-i,p=h-i;for(;m>=n.startRow;)s.push({startRow:m,startColumn:d,endRow:p,endColumn:f}),m-=i,p-=i}else if(r===ge.RIGHT){let m=d+i,p=f+i;for(;p<=n.endColumn;)s.push({startRow:c,startColumn:m,endRow:h,endColumn:p}),m+=i,p+=i}else if(r===ge.LEFT){const m=d-i,p=f-i;for(;m>=n.startColumn;)s.push({startRow:c,startColumn:m,endRow:h,endColumn:p})}}}return s}_presetAndCacheData(e,n){const r={startRow:n.startRow,endRow:n.endRow,startColumn:n.startColumn,endColumn:n.endColumn};let i=null;if(n.startRow<e.startRow)i=ge.UP,r.endRow=e.startRow-1;else if(n.endRow>e.endRow)i=ge.DOWN,r.startRow=e.endRow+1;else if(n.startColumn<e.startColumn)i=ge.LEFT,r.endColumn=e.startColumn-1;else if(n.endColumn>e.endColumn)i=ge.RIGHT,r.startColumn=e.endColumn+1;else return;this._direction=i;const o=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getCellMatrix(),s=[];for(let a=r.startRow;a<=r.endRow;a++){const l=[];for(let u=r.startColumn;u<=r.endColumn;u++)l.push(De.deepClone(o.getValue(a,u)));s.push(l)}this._beforeApplyData=s,this._autoFillService.setRanges(n,e,r),this._copyData=this._getCopyData(e,i),this._hasSeries(this._copyData)?(this._autoFillService.setDisableApplyType(Mn.SERIES,!1),this._autoFillService.setApplyType(Mn.SERIES)):(this._autoFillService.setDisableApplyType(Mn.SERIES,!0),this._autoFillService.setApplyType(Mn.COPY))}_fillData(){const{destRange:e,sourceRange:n,applyRange:r}=this._autoFillService.getRanges(),i=this._applyType,o=this._hasFillingStyle,s=this._direction;if(!e||!n||!r||s==null)return;const{startRow:a,startColumn:l,endRow:u,endColumn:c}=n,{startRow:d,startColumn:h,endRow:f,endColumn:m}=r,p=this._copyData;let g;s===ge.DOWN||s===ge.UP?g=u-a+1:g=c-l+1;const v=[];if(s===ge.DOWN||s===ge.UP){const R=f-d+1,D=[];for(let I=h;I<=m;I++){const k=p[I-h],O=this._getApplyData(k,g,R,s,i,o);D.push(O)}for(let I=0;I<D[0].length;I++){const k=[];for(let O=0;O<D.length;O++)k.push({v:null,s:null,...this._beforeApplyData[I][O],...D[O][I]});v.push(k)}}else{const R=m-h+1;for(let D=d;D<=f;D++){const I=p[D-d],k=this._getApplyData(I,g,R,s,i,o),O=[];for(let $=0;$<k.length;$++)O.push({v:null,s:null,...this._beforeApplyData[D-d][$],...k[$]});v.push(O)}}let _;const C=this._univerInstanceService.getCurrentUniverSheetInstance().getStyles();o?(_=this._getMergeApplyData(n,e,s,g),v.forEach(R=>{R.forEach(D=>{D&&C&&C&&(D.s=C.getStyleByCell(D))})})):v.forEach((R,D)=>{R.forEach((I,k)=>{I&&C&&(I.s=C.getStyleByCell(this._beforeApplyData[D][k])||null)})});const y=this._autoFillService.getHooks(),S=[],E=[],w=this._hasFillingStyle?i:Mn.NO_FORMAT;y.forEach(R=>{const{hook:D}=R,{redos:I,undos:k}=D==null?void 0:D[w](n,r);S.push(...I),E.push(...k)}),this._commandService.executeCommand(C_.id,{selectionRange:e,applyRange:r,applyDatas:v,unitId:this._univerInstanceService.getCurrentUniverSheetInstance().getUnitId(),subUnitId:this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),extendMutations:{undo:E,redo:S},applyMergeRanges:_})}_hasSeries(e){return e.some(n=>Object.keys(n).some(r=>{var i;return!!((i=n[r])!=null&&i.length&&![ai.OTHER,ai.FORMULA].includes(r))}))}};c8=oke([yt(it.Steady,c8),Uc(0,oe),Uc(1,to),Uc(2,le),Uc(3,A0),Uc(4,Eo),Uc(5,ne(ut))],c8);const Ty={type:se.COMMAND,id:"sheet.command.set-range-bold",handler:async t=>{const e=t.get(le);return t.get(Tr).getContextValue(Dr)?e.executeCommand(q2.id):e.executeCommand(vB.id)}},$y={type:se.COMMAND,id:"sheet.command.set-range-italic",handler:async t=>{const e=t.get(le);return t.get(Tr).getContextValue(Dr)?e.executeCommand(x4.id):e.executeCommand(_B.id)}},ky={type:se.COMMAND,id:"sheet.command.set-range-underline",handler:async t=>{const e=t.get(le);return t.get(Tr).getContextValue(Dr)?e.executeCommand(M4.id):e.executeCommand(bB.id)}},Ay={type:se.COMMAND,id:"sheet.command.set-range-stroke",handler:async t=>{const e=t.get(le);return t.get(Tr).getContextValue(Dr)?e.executeCommand(O4.id):e.executeCommand(CB.id)}},ske={type:se.COMMAND,id:"sheet.command.set-range-subscript",handler:async t=>{const e=t.get(le);return t.get(Tr).getContextValue(Dr)?e.executeCommand(xl.id):!1}},ake={type:se.COMMAND,id:"sheet.command.set-range-superscript",handler:async t=>{const e=t.get(le);return t.get(Tr).getContextValue(Dr)?e.executeCommand(Yu.id):!1}},_F={type:se.COMMAND,id:"sheet.command.set-range-fontsize",handler:async(t,e)=>{const n=t.get(le);return t.get(Tr).getContextValue(Dr)?n.executeCommand(Q2.id,e):n.executeCommand(SB.id,e)}},bF={type:se.COMMAND,id:"sheet.command.set-range-font-family",handler:async(t,e)=>{const n=t.get(le);return t.get(Tr).getContextValue(Dr)?n.executeCommand(J2.id,e):n.executeCommand(yB.id,e)}},x5={type:se.COMMAND,id:"sheet.command.set-range-text-color",handler:async(t,e)=>{const n=t.get(le);return t.get(Tr).getContextValue(Dr)?n.executeCommand(T4.id,e):n.executeCommand(EB.id,e)}};function CF(t,e){return e.some(n=>lke(t,n))}function lke(t,e){const{startRow:n,startColumn:r,endColumn:i,endRow:o}=e,s=t.getMatrixWithMergedCells(n,r,o,i);let a=!1;return s.forValue((l,u,c)=>{if(c&&(l!==n||u!==r)&&t.cellHasValue(c))return a=!0,!1}),a}function yF(t,e,n,r){const i=[],o=[],s=n.getSheetId();return r.forEach(a=>{const l=uke(n,a),u={unitId:e,subUnitId:s,cellValue:l.getData()},c=Bi(t,u);i.push({id:Pt.id,params:c}),o.push({id:Pt.id,params:u})}),{undos:i,redos:o}}function uke(t,e){const{startRow:n,startColumn:r,endColumn:i,endRow:o}=e,s=t.getMatrixWithMergedCells(n,r,o,i),a=new nt;return s.forValue((l,u,c)=>{c&&(l!==n||u!==r)&&a.setValue(l,u,null)}),a}var cke=Object.defineProperty,dke=Object.getOwnPropertyDescriptor,hke=(t,e,n,r)=>{for(var i=r>1?void 0:r?dke(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&cke(e,n,i),i},gp=(t,e)=>(n,r)=>e(n,r,t),Xs=(t=>(t[t.OFF=0]="OFF",t[t.ONCE=1]="ONCE",t[t.INFINITE=2]="INFINITE",t))(Xs||{});const N0=nn("univer.format-painter-service");let M_=class extends je{constructor(t,e,n){super(),V(this,"status$"),V(this,"_selectionFormat"),V(this,"_markId",null),V(this,"_status$"),this._selectionManagerService=t,this._univerInstanceService=e,this._markSelectionService=n,this._status$=new rn(0),this.status$=this._status$.asObservable(),this._selectionFormat={styles:new nt,merges:[]}}setStatus(t){t!==0&&this._getSelectionRangeFormat(),this._updateRangeMark(t),this._status$.next(t)}getStatus(){return this._status$.getValue()}_updateRangeMark(t){if(this._markSelectionService.removeAllShapes(),this._markId=null,t!==0){const e=this._selectionManagerService.getLast();if(e){const n=this._selectionManagerService.createCopyPasteSelection();this._markId=this._markSelectionService.addShape({...e,style:n})}}}_getSelectionRangeFormat(){const t=this._selectionManagerService.getLast(),e=t==null?void 0:t.range;if(!e)return;const{startRow:n,endRow:r,startColumn:i,endColumn:o}=e,s=this._univerInstanceService.getCurrentUniverSheetInstance(),a=(s==null?void 0:s.getActiveSheet()).getCellMatrix(),l=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getMergeData(),u=s.getStyles(),c=new nt;for(let d=n;d<=r;d++)for(let h=i;h<=o;h++){const f=a.getValue(d,h);c.setValue(d,h,u.getStyleByCell(f)||{});const{isMergedMainCell:m,...p}=cc(d,h,l);m&&this._selectionFormat.merges.push({startRow:p.startRow,startColumn:p.startColumn,endRow:p.endRow,endColumn:p.endColumn})}this._selectionFormat.styles=c}getSelectionFormat(){return this._selectionFormat}};M_=hke([gp(0,ne(ut)),gp(1,oe),gp(2,Cf)],M_);const Ny={id:"sheet.operation.set-format-painter",type:se.OPERATION,handler:(t,e)=>e?(t.get(N0).setStatus(e.status),!0):!1},SF={type:se.COMMAND,id:"sheet.command.set-infinite-format-painter",handler:async t=>{const e=t.get(N0).getStatus();let n;return e!==Xs.OFF?n=Xs.OFF:n=Xs.INFINITE,t.get(le).executeCommand(Ny.id,{status:n})}},Ly={type:se.COMMAND,id:"sheet.command.set-once-format-painter",handler:async t=>{const e=t.get(N0).getStatus();let n;return e!==Xs.OFF?n=Xs.OFF:n=Xs.ONCE,t.get(le).executeCommand(Ny.id,{status:n})}},EF={type:se.COMMAND,id:"sheet.command.apply-format-painter",handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe),o=t.get(ut),s=t.get(En),{styleValues:a,styleRange:l,mergeRanges:u,unitId:c=i.getCurrentUniverSheetInstance().getUnitId(),subUnitId:d=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId()}=e,h=l?[l]:o.getSelectionRanges();if(!h||!h.length)return!1;const f=new nt;let m;if(De.isArray(a))for(let N=0;N<h.length;N++){const{startRow:H,startColumn:X,endRow:te,endColumn:z}=h[N];for(let A=0;A<=te-H;A++)for(let T=0;T<=z-X;T++)f.setValue(A+H,T+X,a[A][T])}else if(qx(a))for(let N=0;N<h.length;N++){const{startRow:H,startColumn:X}=h[N];f.setValue(H,X,a)}else m=a;const p={subUnitId:d,unitId:c,cellValue:m??f.getMatrix()},g=Bi(t,p);if(!s.fetchThroughInterceptors(Ra.PERMISSION)(null,{id:Oa.id,params:p}))return!1;const v=n.syncExecuteCommand(Pt.id,p),{undos:_,redos:C}=s.onCommandExecute({id:Oa.id,params:{...p,range:h}}),y=bf(u),S=i.getUniverSheetInstance(c).getSheetBySheetId(d),E=[],w=[],R=CF(S,y),D={unitId:c,subUnitId:d,ranges:y},I={unitId:c,subUnitId:d,ranges:y};E.push({id:Rn.id,params:D}),E.push({id:wn.id,params:I});const k=Ai(t,D),O=so(t,I);if(w.push({id:Rn.id,params:O}),w.push({id:wn.id,params:k}),R){const N=yF(t,c,S,y);E.unshift(...N.redos),w.push(...N.undos)}const $=await Xn([...C,...E],n);return v&&$.result?(r.pushUndoRedo({unitID:c,undoMutations:[{id:Pt.id,params:g},..._,...w],redoMutations:[{id:Pt.id,params:p},...C,...E]}),!0):!1}},wf={type:se.COMMAND,id:"sheet.command.set-selection-frozen",handler:async(t,e)=>{const{type:n}=e||{},r=t.get(oe),i=t.get(At),o=r.getCurrentUniverSheetInstance().getUnitId(),s=r.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),a=t.get(le),l=t.get(ut).getSelections();if(!l)return!1;const u=l[(l==null?void 0:l.length)-1],{range:c}=u,d=t.get(Yl),{sheetViewStartRow:h=0,sheetViewStartColumn:f=0}=d.getCurrentScroll()||{};let m,p,g,v;const{startRow:_,startColumn:C,rangeType:y}=c;if(y===Rt.ROW||n===1)m=_,g=_-h,p=-1,v=0;else if(y===Rt.COLUMN||n===2)m=-1,g=0,p=C,v=C-f;else if(y===Rt.NORMAL)m=_,g=_-h,p=C,v=C-f;else return!1;const S={unitId:o,subUnitId:s,startRow:m,startColumn:p,xSplit:v,ySplit:g},E=gf(t,S);return a.syncExecuteCommand(vo.id,S)&&i.pushUndoRedo({unitID:o,undoMutations:[{id:vo.id,params:E}],redoMutations:[{id:vo.id,params:S}]}),!0}},wF={type:se.COMMAND,id:"sheet.command.set-row-frozen",handler:async t=>(t.get(le).executeCommand(wf.id,{type:1}),!0)},RF={type:se.COMMAND,id:"sheet.command.set-col-frozen",handler:async t=>(t.get(le).executeCommand(wf.id,{type:2}),!0)},DF={type:se.COMMAND,id:"sheet.command.cancel-frozen",handler:async t=>{const e=t.get(le),n=t.get(oe),r=t.get(At),i=n.getCurrentUniverSheetInstance().getUnitId(),o=n.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),s={unitId:i,subUnitId:o,startRow:-1,startColumn:-1,xSplit:0,ySplit:0},a=gf(t,s);return e.syncExecuteCommand(vo.id,s)&&r.pushUndoRedo({unitID:i,undoMutations:[{id:vo.id,params:a}],redoMutations:[{id:vo.id,params:s}]}),!0}},L0="UI_PLUGIN_SHEETS",Rf=`${L0}_COLOR_PICKER_COMPONENT`,fke="univer-ui-plugin-sheets-font-family",mke="univer-ui-plugin-sheets-font-family-item",IF={uiPluginSheetsFontFamily:fke,uiPluginSheetsFontFamilyItem:mke},pke=t=>{const{value:e}=t,n=_t(mn);return F.jsx("div",{className:IF.uiPluginSheetsFontFamily,style:{fontFamily:e},children:n.t(`fontFamily.${(`${e}`??"").replace(/\s/g,"")}`)})},gke=t=>{const{value:e}=t,n=_t(mn);return F.jsx("span",{className:IF.uiPluginSheetsFontFamilyItem,style:{fontFamily:e},children:n.t(`fontFamily.${(`${e}`??"").replace(/\s/g,"")}`)})},xF=`${L0}_FONT_FAMILY_COMPONENT`,ro=`${L0}_FONT_FAMILY_ITEM_COMPONENT`,vke="univer-ui-plugin-sheets-font-size",_ke="univer-ui-plugin-sheets-font-size-input",oI={uiPluginSheetsFontSize:vke,uiPluginSheetsFontSizeInput:_ke},bke=t=>{const{value:e,min:n,max:r,onChange:i}=t,[o,s]=b.useState(Number(e??0)),a=b.useMemo(()=>Number(e??o),[e]);function l(c){c!==null&&s(c)}function u(c){c.stopPropagation(),c.code==="Enter"&&i(o.toString())}return F.jsx("div",{className:oI.uiPluginSheetsFontSize,children:F.jsx(u4,{className:oI.uiPluginSheetsFontSizeInput,value:a,controls:!1,min:n,max:r,onKeyDown:u,onChange:l})})},MF=`${L0}_FONT_SIZE_COMPONENT`,Py=`${L0}_MENU_ITEM_INPUT_COMPONENT`,Cke="univer-sheets-ui-context-menu-input",yke="univer-sheets-ui-context-menu-input-container",Ske="univer-sheets-ui-context-menu-input-number",vp={sheetsUiContextMenuInput:Cke,sheetsUiContextMenuInputContainer:yke,sheetsUiContextMenuInputNumber:Ske},Eke=t=>{const{prefix:e,suffix:n,value:r,onChange:i}=t,o=_t(mn),[s,a]=b.useState(),l=c=>{a(c==null?void 0:c.toString()),i((c==null?void 0:c.toString())??"")};b.useEffect(()=>{a(r)},[r]);function u(c){c.key==="Backspace"&&c.stopPropagation()}return F.jsxs("div",{className:vp.sheetsUiContextMenuInput,children:[o.t(e),F.jsx("span",{className:vp.sheetsUiContextMenuInputContainer,onClick:c=>c.stopPropagation(),children:F.jsx(u4,{className:vp.sheetsUiContextMenuInputNumber,value:Number(s),precision:0,onKeyDown:u,onChange:l})}),o.t(n)]})};var si=(t=>(t.ROW_HEADER_CONTEXT_MENU="rowHeaderContextMenu",t.COL_HEADER_CONTEXT_MENU="colHeaderContextMenu",t.SHEET_BAR="sheetBar",t))(si||{});function wke(t){const e=t.get(N0);return t.get(oe),{id:Ly.id,subId:SF.id,group:un.TOOLBAR_FORMAT,type:gt.BUTTON,icon:"BrushSingle",title:"Format Painter",tooltip:"toolbar.formatPainter",positions:[yn.TOOLBAR_START],activated$:new tn(n=>{let r=!1;const i=e.status$.subscribe(o=>{r=o!==Xs.OFF,n.next(r)});return n.next(r),()=>{i.unsubscribe()}}),hidden$:jr(t,Pr.SHEET)}}function Rke(t){const e=t.get(le),n=t.get(Da),r=t.get(oe),i=t.get(ut),o=r.getCurrentUniverSheetInstance().getUnitId(),s=r.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();return{id:Ty.id,group:un.TOOLBAR_FORMAT,type:gt.BUTTON,icon:"BoldSingle",title:"Set bold",tooltip:"toolbar.bold",positions:[yn.TOOLBAR_START],disabled$:new tn(a=>{var l;const u=(l=n.getEditable$(o,s))==null?void 0:l.subscribe(c=>{a.next(!c.value)});return()=>{u==null||u.unsubscribe()}}),activated$:new tn(a=>{const l=e.onCommandExecuted(u=>{var c;const d=u.id;if(d!==Pt.id&&d!==dn.id)return;const h=(c=i.getLast())==null?void 0:c.primary,f=r.getCurrentUniverSheetInstance().getActiveSheet();let m=N2.NORMAL;if(h!=null){const p=f.getRange(h.startRow,h.startColumn);m=p==null?void 0:p.getFontWeight()}a.next(m===N2.BOLD)});return a.next(!1),l.dispose}),hidden$:jr(t,Pr.SHEET)}}function Dke(t){const e=t.get(le),n=t.get(oe),r=t.get(ut),i=t.get(Da),o=n.getCurrentUniverSheetInstance().getUnitId(),s=n.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();return{id:$y.id,group:un.TOOLBAR_FORMAT,type:gt.BUTTON,icon:"ItalicSingle",title:"Set italic",tooltip:"toolbar.italic",positions:[yn.TOOLBAR_START],disabled$:new tn(a=>{var l;const u=(l=i.getEditable$(o,s))==null?void 0:l.subscribe(c=>{a.next(!c.value)});return()=>{u==null||u.unsubscribe()}}),activated$:new tn(a=>{const l=e.onCommandExecuted(u=>{var c;const d=u.id;if(d!==Pt.id&&d!==dn.id)return;const h=(c=r.getLast())==null?void 0:c.primary,f=n.getCurrentUniverSheetInstance().getActiveSheet();let m=A2.NORMAL;if(h!=null){const p=f.getRange(h.startRow,h.startColumn);m=p==null?void 0:p.getFontStyle()}a.next(m===A2.ITALIC)});return a.next(!1),l.dispose}),hidden$:jr(t,Pr.SHEET)}}function Ike(t){const e=t.get(le),n=t.get(oe),r=t.get(ut),i=t.get(Da),o=n.getCurrentUniverSheetInstance().getUnitId(),s=n.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();return{id:ky.id,group:un.TOOLBAR_FORMAT,type:gt.BUTTON,icon:"UnderlineSingle",title:"Set underline",tooltip:"toolbar.underline",positions:[yn.TOOLBAR_START],disabled$:new tn(a=>{var l;const u=(l=i.getEditable$(o,s))==null?void 0:l.subscribe(c=>{a.next(!c.value)});return()=>{u==null||u.unsubscribe()}}),activated$:new tn(a=>{const l=e.onCommandExecuted(u=>{var c;const d=u.id;if(d!==Pt.id&&d!==dn.id)return;const h=(c=r.getLast())==null?void 0:c.primary,f=n.getCurrentUniverSheetInstance().getActiveSheet();let m;if(h!=null){const p=f.getRange(h.startRow,h.startColumn);m=p==null?void 0:p.getUnderline()}a.next(!!(m&&m.s))});return a.next(!1),l.dispose}),hidden$:jr(t,Pr.SHEET)}}function xke(t){const e=t.get(le),n=t.get(oe),r=t.get(ut),i=t.get(Da),o=n.getCurrentUniverSheetInstance().getUnitId(),s=n.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();return{id:Ay.id,group:un.TOOLBAR_FORMAT,type:gt.BUTTON,icon:"StrikethroughSingle",title:"Set strike through",tooltip:"toolbar.strikethrough",positions:[yn.TOOLBAR_START],disabled$:new tn(a=>{var l;const u=(l=i.getEditable$(o,s))==null?void 0:l.subscribe(c=>{a.next(!c.value)});return()=>{u==null||u.unsubscribe()}}),activated$:new tn(a=>{const l=e.onCommandExecuted(u=>{var c;const d=u.id;if(d!==Pt.id&&d!==dn.id)return;const h=(c=r.getLast())==null?void 0:c.primary,f=n.getCurrentUniverSheetInstance().getActiveSheet();let m;if(h!=null){const p=f.getRange(h.startRow,h.startColumn);m=p==null?void 0:p.getStrikeThrough()}a.next(!!(m&&m.s))});return a.next(!1),l.dispose}),hidden$:jr(t,Pr.SHEET)}}const Mke=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],sI=[{label:ro,value:"Times New Roman"},{label:ro,value:"Arial"},{label:ro,value:"Tahoma"},{label:ro,value:"Verdana"},{label:ro,value:"Microsoft YaHei"},{label:ro,value:"SimSun"},{label:ro,value:"SimHei"},{label:ro,value:"Kaiti"},{label:ro,value:"FangSong"},{label:ro,value:"NSimSun"},{label:ro,value:"STXinwei"},{label:ro,value:"STXingkai"},{label:ro,value:"STLiti"}];function Oke(t){const e=t.get(le),n=t.get(oe),r=t.get(ut),i=t.get(Da),o=n.getCurrentUniverSheetInstance().getUnitId(),s=n.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();return{id:bF.id,tooltip:"toolbar.font",group:un.TOOLBAR_FORMAT,type:gt.SELECTOR,label:xF,positions:[yn.TOOLBAR_START],selections:sI,disabled$:new tn(a=>{var l;const u=(l=i.getEditable$(o,s))==null?void 0:l.subscribe(c=>{a.next(!c.value)});return()=>{u==null||u.unsubscribe()}}),value$:new tn(a=>{const l=sI[0].value,u=e.onCommandExecuted(c=>{var d;const h=c.id;if(h!==Pt.id&&h!==dn.id)return;const f=(d=r.getLast())==null?void 0:d.primary,m=n.getCurrentUniverSheetInstance().getActiveSheet();let p;if(f!=null){const g=m.getRange(f.startRow,f.startColumn);p=g==null?void 0:g.getFontFamily()}a.next(p??l)});return a.next(l),u.dispose}),hidden$:jr(t,Pr.SHEET)}}function Tke(t){const e=t.get(le),n=t.get(oe),r=t.get(ut),i=t.get(Da),o=n.getCurrentUniverSheetInstance().getUnitId(),s=n.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();return{id:_F.id,group:un.TOOLBAR_FORMAT,type:gt.SELECTOR,tooltip:"toolbar.fontSize",label:{name:MF,props:{min:1,max:400}},positions:[yn.TOOLBAR_START],selections:Mke,disabled$:new tn(a=>{var l;const u=(l=i.getEditable$(o,s))==null?void 0:l.subscribe(c=>{a.next(!c.value)});return()=>{u==null||u.unsubscribe()}}),value$:new tn(a=>{const l=e.onCommandExecuted(u=>{var c;const d=u.id;if(d!==Pt.id&&d!==dn.id)return;const h=(c=r.getLast())==null?void 0:c.primary,f=n.getCurrentUniverSheetInstance().getActiveSheet();let m;if(h!=null){const p=f.getRange(h.startRow,h.startColumn);m=p==null?void 0:p.getFontSize()}a.next(m??14)});return a.next(14),l.dispose}),hidden$:jr(t,Pr.SHEET)}}function $ke(){return{id:wB.id,type:gt.BUTTON,title:"toolbar.resetColor",icon:"NoColor",positions:x5.id}}function kke(t){const e=t.get(le),n=t.get(Ki);return t.get(oe),{id:x5.id,icon:"FontColor",tooltip:"toolbar.textColor.main",group:un.TOOLBAR_FORMAT,type:gt.BUTTON_SELECTOR,positions:[yn.TOOLBAR_START],selections:[{label:{name:Rf,hoverable:!1}}],value$:new tn(r=>{const i=n.getCurrentTheme().textColor,o=e.onCommandExecuted(s=>{if(s.id===x5.id){const a=s.params.value;r.next(a??i)}});return r.next(i),o.dispose}),hidden$:jr(t,Pr.SHEET)}}function Ake(){return{id:RB.id,type:gt.BUTTON,title:"toolbar.resetColor",icon:"NoColor",positions:y5.id}}function Nke(t){const e=t.get(le),n=t.get(Ki);return t.get(oe),{id:y5.id,tooltip:"toolbar.fillColor.main",group:un.TOOLBAR_FORMAT,type:gt.BUTTON_SELECTOR,positions:[yn.TOOLBAR_START],icon:"PaintBucket",selections:[{label:{name:Rf,hoverable:!1}}],value$:new tn(r=>{const i=n.getCurrentTheme().primaryColor,o=e.onCommandExecuted(s=>{if(s.id===y5.id){const a=s.params.value;r.next(a??i)}});return r.next(i),o.dispose}),hidden$:jr(t,Pr.SHEET)}}const aI=[{label:"align.left",icon:"LeftJustifyingSingle",value:Ln.LEFT},{label:"align.center",icon:"HorizontallySingle",value:Ln.CENTER},{label:"align.right",icon:"RightJustifyingSingle",value:Ln.RIGHT}];function Lke(t){const e=t.get(oe),n=t.get(ut);return{id:g_.id,icon:aI[0].icon,positions:[yn.TOOLBAR_START],tooltip:"toolbar.horizontalAlignMode.main",group:un.TOOLBAR_LAYOUT,type:gt.SELECTOR,selections:aI,value$:new tn(r=>{const i=t.get(le).onCommandExecuted(o=>{var s;const a=o.id;if(a!==g_.id&&a!==dn.id)return;const l=(s=n.getLast())==null?void 0:s.primary,u=e.getCurrentUniverSheetInstance().getActiveSheet();let c;if(l!=null){const d=u.getRange(l.startRow,l.startColumn);c=d==null?void 0:d.getHorizontalAlignment()}r.next(c??Ln.LEFT)});return r.next(Ln.LEFT),i.dispose}),hidden$:jr(t,Pr.SHEET)}}const lI=[{label:"align.top",icon:"AlignTopSingle",value:Kr.TOP},{label:"align.middle",icon:"VerticalCenterSingle",value:Kr.MIDDLE},{label:"align.bottom",icon:"AlignBottomSingle",value:Kr.BOTTOM}];function Pke(t){const e=t.get(oe),n=t.get(ut);return{id:p_.id,icon:lI[0].icon,tooltip:"toolbar.verticalAlignMode.main",group:un.TOOLBAR_LAYOUT,type:gt.SELECTOR,positions:[yn.TOOLBAR_START],selections:lI,value$:new tn(r=>{const i=t.get(le).onCommandExecuted(o=>{var s;const a=o.id;if(a!==p_.id&&a!==dn.id)return;const l=(s=n.getLast())==null?void 0:s.primary,u=e.getCurrentUniverSheetInstance().getActiveSheet();let c;if(l!=null){const d=u.getRange(l.startRow,l.startColumn);c=d==null?void 0:d.getVerticalAlignment()}r.next(c??Kr.TOP)});return r.next(Kr.TOP),i.dispose}),hidden$:jr(t,Pr.SHEET)}}const uI=[{label:"textWrap.overflow",icon:"OverflowSingle",value:yr.OVERFLOW},{label:"textWrap.wrap",icon:"AutowrapSingle",value:yr.WRAP},{label:"textWrap.clip",icon:"TruncationSingle",value:yr.CLIP}];function Bke(t){const e=t.get(oe),n=t.get(ut);return{id:v_.id,tooltip:"toolbar.textWrapMode.main",icon:uI[0].icon,group:un.TOOLBAR_LAYOUT,type:gt.SELECTOR,positions:[yn.TOOLBAR_START],selections:uI,value$:new tn(r=>{const i=t.get(le).onCommandExecuted(o=>{var s;const a=o.id;if(a!==v_.id&&a!==dn.id)return;const l=(s=n.getLast())==null?void 0:s.primary,u=e.getCurrentUniverSheetInstance().getActiveSheet();let c;if(l!=null){const d=u.getRange(l.startRow,l.startColumn);c=d==null?void 0:d.getWrapStrategy()}r.next(c??yr.OVERFLOW)});return r.next(yr.OVERFLOW),i.dispose}),hidden$:jr(t,Pr.SHEET)}}const cI=[{label:"textRotate.none",icon:"NoRotationSingle",value:0},{label:"textRotate.angleUp",icon:"LeftRotationFortyFiveDegreesSingle",value:-45},{label:"textRotate.angleDown",icon:"RightRotationFortyFiveDegreesSingle",value:45},{label:"textRotate.vertical",icon:"VerticalTextSingle",value:"v"},{label:"textRotate.rotationUp",icon:"LeftRotationNinetyDegreesSingle",value:-90},{label:"textRotate.rotationDown",icon:"RightRotationNinetyDegreesSingle",value:90}];function Fke(t){const e=t.get(oe),n=t.get(ut);return{id:__.id,tooltip:"toolbar.textRotateMode.main",icon:cI[0].icon,group:un.TOOLBAR_LAYOUT,type:gt.SELECTOR,selections:cI,positions:[yn.TOOLBAR_START],value$:new tn(r=>{const i=t.get(le).onCommandExecuted(o=>{var s;const a=o.id;if(a!==__.id&&a!==dn.id)return;const l=(s=n.getLast())==null?void 0:s.primary,u=e.getCurrentUniverSheetInstance().getActiveSheet();let c;if(l!=null){const d=u.getRange(l.startRow,l.startColumn);c=d==null?void 0:d.getTextRotation()}(c==null?void 0:c.v)===ke.TRUE?r.next("v"):r.next((c&&c.a)??0)});return r.next(0),i.dispose}),hidden$:jr(t,Pr.SHEET)}}function Uke(){return{id:b4.id,group:un.CONTEXT_MENU_FORMAT,type:gt.BUTTON,title:"rightClick.copy",icon:"Copy",positions:[yn.CONTEXT_MENU,"colHeaderContextMenu","rowHeaderContextMenu"]}}function Hke(){return{id:C4.id,group:un.CONTEXT_MENU_FORMAT,type:gt.BUTTON,title:"rightClick.paste",icon:"PasteSpecial",positions:[yn.CONTEXT_MENU,"colHeaderContextMenu","rowHeaderContextMenu"]}}const P0="sheet.menu.paste-special";function Vke(){return{id:P0,group:un.CONTEXT_MENU_FORMAT,type:gt.SUBITEMS,icon:"PasteSpecial",title:"rightClick.pasteSpecial",positions:[yn.CONTEXT_MENU,"colHeaderContextMenu","rowHeaderContextMenu"]}}function jke(){return{id:KB.id,type:gt.BUTTON,title:"rightClick.pasteValue",positions:[P0]}}function zke(){return{id:ZB.id,type:gt.BUTTON,title:"rightClick.pasteFormat",positions:[P0]}}function Wke(){return{id:qB.id,type:gt.BUTTON,title:"rightClick.pasteColWidth",positions:[P0]}}function Xke(){return{id:QB.id,type:gt.BUTTON,title:"rightClick.pasteBesidesBorder",positions:[P0]}}function Yke(){return{id:U4.id,group:un.CONTEXT_MENU_LAYOUT,type:gt.BUTTON,positions:["rowHeaderContextMenu"],icon:"AutoHeight",title:"rightClick.fitContent"}}const z4="sheet.menu.sheet-frozen";function Gke(){return{id:z4,group:un.CONTEXT_MENU_LAYOUT,type:gt.SUBITEMS,title:"rightClick.freeze",icon:"FreezeToSelectedSingle",positions:[yn.CONTEXT_MENU]}}const By="sheet.header-menu.sheet-frozen";function Kke(){return{id:By,group:un.CONTEXT_MENU_LAYOUT,type:gt.SUBITEMS,title:"rightClick.freeze",icon:"FreezeToSelectedSingle",positions:["rowHeaderContextMenu","colHeaderContextMenu"]}}function Zke(){return{id:wf.id,type:gt.BUTTON,positions:[z4,By],title:"rightClick.freeze",icon:"FreezeToSelectedSingle"}}function qke(){return{id:wF.id,type:gt.BUTTON,positions:[z4],title:"rightClick.freezeRow",icon:"FreezeRowSingle"}}function Qke(){return{id:RF.id,type:gt.BUTTON,positions:[z4],title:"rightClick.freezeCol",icon:"FreezeColumnSingle"}}function Jke(){return{id:DF.id,type:gt.BUTTON,positions:[z4,By],title:"rightClick.cancelFreeze",icon:"CancelFreezeSingle"}}function eAe(){return{id:yy.id,group:un.CONTEXT_MENU_LAYOUT,type:gt.BUTTON,positions:["rowHeaderContextMenu"],icon:"Hide",title:"rightClick.hideSelectedRow"}}function tAe(){return{id:by.id,group:un.CONTEXT_MENU_LAYOUT,type:gt.BUTTON,positions:["colHeaderContextMenu"],icon:"Hide",title:"rightClick.hideSelectedColumn"}}function nAe(t){const e=t.get(oe),n=t.get(ut);function r(){var o;const s=e.getCurrentUniverSheetInstance().getActiveSheet(),a=(o=n.getSelections())==null?void 0:o.map(l=>l.range).filter(l=>l.rangeType===Rt.ROW);return!!(a!=null&&a.some(l=>{for(let u=l.startRow;u<=l.endRow;u++)if(!s.getRowVisible(u))return!0;return!1}))}const i=t.get(le);return{id:pB.id,group:un.CONTEXT_MENU_LAYOUT,type:gt.BUTTON,positions:["rowHeaderContextMenu"],title:"rightClick.showHideRow",hidden$:new tn(o=>{const s=i.onCommandExecuted(a=>{(a.id===dn.id||a.id===nc.id||a.id===tc.id)&&o.next(!r())});return o.next(!r()),()=>s.dispose()})}}function rAe(t){const e=t.get(oe),n=t.get(ut);function r(){var o;const s=e.getCurrentUniverSheetInstance().getActiveSheet(),a=(o=n.getSelections())==null?void 0:o.map(l=>l.range).filter(l=>l.rangeType===Rt.COLUMN);return!!(a!=null&&a.some(l=>{for(let u=l.startRow;u<=l.endRow;u++)if(!s.getColVisible(u))return!0;return!1}))}const i=t.get(le);return{id:hB.id,group:un.CONTEXT_MENU_LAYOUT,type:gt.BUTTON,positions:["colHeaderContextMenu"],title:"rightClick.showHideColumn",hidden$:new tn(o=>{const s=i.onCommandExecuted(a=>{(a.id===dn.id||a.id===Ju.id||a.id===ec.id)&&o.next(!r())});return o.next(!r()),()=>s.dispose()})}}function iAe(t){const e=t.get(le),n=t.get(oe),r=t.get(ut);return{id:$B.id,group:un.CONTEXT_MENU_LAYOUT,type:gt.BUTTON,icon:"AdjustHeight",positions:["rowHeaderContextMenu"],label:{name:Py,props:{prefix:"rightClick.rowHeight",suffix:"px"}},value$:new tn(i=>{function o(){var a;const l=(a=r.getLast())==null?void 0:a.primary,u=n.getCurrentUniverSheetInstance().getActiveSheet();let c;l!=null&&(c=u.getRowHeight(l.startRow)),i.next(c??0)}const s=e.onCommandExecuted(a=>{const l=a.id;if(l===Pt.id||l===dn.id)return o()});return o(),s.dispose})}}function oAe(t){const e=t.get(le),n=t.get(oe),r=t.get(ut);return{id:Sy.id,group:un.CONTEXT_MENU_LAYOUT,type:gt.BUTTON,icon:"AdjustWidth",positions:["colHeaderContextMenu"],label:{name:Py,props:{prefix:"rightClick.columnWidth",suffix:"px"}},value$:new tn(i=>{function o(){var a;const l=(a=r.getLast())==null?void 0:a.primary,u=n.getCurrentUniverSheetInstance().getActiveSheet();let c=0;l!=null&&(c=u.getColumnWidth(l.startColumn)),i.next(c)}const s=e.onCommandExecuted(a=>{const l=a.id;if(l===Pt.id||l===dn.id)return o()});return o(),s.dispose})}}function jo(t,e){const n=t.getCurrentUniverSheetInstance().getUnitId(),r=e.getRenderById(n);if(r==null)return;const{components:i,mainComponent:o,scene:s,engine:a}=r,l=o,u=i.get(zi.ROW),c=i.get(zi.COLUMN),d=i.get(zi.LEFT_TOP);return{spreadsheet:l,spreadsheetRowHeader:u,spreadsheetColumnHeader:c,spreadsheetLeftTopPlaceholder:d,scene:s,engine:a}}function dI(t,e,n,r){const{scaleX:i,scaleY:o}=n.getAncestorScale(),{startX:s,startY:a,endX:l,endY:u}=r.getCellByIndex(t,e,i,o);return{startX:s,startY:a,endX:l,endY:u}}function Z6(t,e,n,r,i){const o=n.getRelativeCoord(Ft.FromArray([t,e])),{x:s,y:a}=o,l=n.getScrollXYByRelativeCoords(o,i),{scaleX:u,scaleY:c}=n.getAncestorScale(),d=r.getCellPositionByOffset(s,a,u,c,l),{row:h,column:f}=d,m=r.getNoMergeCellPositionByIndex(h,f,u,c),{startX:p,startY:g,endX:v,endY:_}=m;return{startX:p,startY:g,endX:v,endY:_,row:h,column:f}}function _p(t,e,n,r){const i=n.getRelativeCoord(Ft.FromArray([t,e])),o=n.getViewport(Kn.VIEW_MAIN),s=n.getScrollXYByRelativeCoords(i,o),{scaleX:a,scaleY:l}=n.getAncestorScale(),{x:u,y:c}=s,d=t/a+u,h=e/l+c;return{x:d,y:h}}const sAe={spreadsheetLabel:"Plugin",spreadsheetRightLabel:"More Sheets",toolbar:{undo:"Undo",redo:"Redo",formatPainter:"Format Painter",currencyFormat:"Currency Format",percentageFormat:"Percentage Format",numberDecrease:"Decrease Decimal Places",numberIncrease:"Increase Decimal Places",moreFormats:"More Formats",font:"Font",fontSize:"Font Size",bold:"Bold",italic:"Italic",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",underline:"Underline",textColor:{main:"Text Color",right:"Color Picker"},resetColor:"Reset Color",customColor:"Custom",alternatingColors:"Alternating Colors",confirmColor:"Confirm Color",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Cell Color",right:"Color Picker"},border:{main:"Border",right:"Border Type"},mergeCell:{main:"Merge Cells",right:"Select Merge Type"},horizontalAlignMode:{main:"Horizontal Align",right:"Alignment"},verticalAlignMode:{main:"Vertical Align",right:"Alignment"},textWrapMode:{main:"Text Wrap",right:"Wrap Method"},textRotateMode:{main:"Text Rotate",right:"Rotate Method"},freezeTopRow:"Freeze Top Row",sortAndFilter:"Sort and Filter",findAndReplace:"Find and Replace",sum:"Sum",autoSum:"Auto Sum",moreFunction:"More Functions",conditionalalFormat:"Conditional Format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split Column",insertImage:"Insert Image",insertLink:"Insert Link",dataValidation:"Data Validation",protection:"Protect Worksheet",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",toolMore:"More",toolLess:"Less",toolClose:"Collapse",toolMoreTip:"More Features",moreOptions:"More Options",cellFormat:"Format Cells",print:"Print",borderMethod:{top:"Top Border",bottom:"Bottom Border",left:"Left Border",right:"Right Border"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percentage",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain Text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"(0.00)",example:"(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"100 million 20 million 2500"},Currency:{text:"Currency",value:"0.00",example:"1200.09"},Digit:{text:"Ten Thousand with 2 Decimals",value:"w0.00",example:"20,000.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date Time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date Time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More Currency Formats",moreDateTime:"More Date and Time Formats",moreNumber:"More Number Formats",titleCurrency:"Currency Format",decimalPlaces:"Decimal Places",titleDateTime:"Date and Time Format",titleNumber:"Number Format"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftYaHei:"Microsoft YaHei",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal View",layoutBtn:"Page Layout",pageBtn:"Page Break Preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print Area",menuItemRows:"Print Title Rows",menuItemColumns:"Print Title Columns"},align:{left:"Left Align",center:"Center Align",right:"Right Align",top:"Top Align",middle:"Middle Align",bottom:"Bottom Align"},button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"New",prevPage:"Previous Page",nextPage:"Next Page",total:"Total:"},punctuation:{tab:"Tab",semicolon:"Semicolon",comma:"Comma",space:"Space"},colorPicker:{collapse:"Collapse",customColor:"Custom",change:"Change",confirmColor:"Confirm",cancelColor:"Cancel"},borderLine:{borderTop:"Top Border",borderBottom:"Bottom Border",borderLeft:"Left Border",borderRight:"Right Border",borderNone:"None",borderAll:"All",borderOutside:"Outside",borderInside:"Inside",borderHorizontal:"Inside Horizontal",borderVertical:"Inside Vertical",borderColor:"Border Color",borderSize:"Border Size",borderType:"Border Line Type"},merge:{all:"Merge All",vertical:"Merge Vertical",horizontal:"Merge Horizontal",cancel:"Unmerge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells",confirm:{title:"Merging cells only keeps the value from the top-left cell. Continue?",cancel:"Cancel Merge",confirm:"Continue Merge"}},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"No Rotation",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Vertical Text",rotationUp:"Rotate Up 90",rotationDown:"Rotate Down 90"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change Color",hide:"Hide",unhide:"Unhide",moveLeft:"Move Left",moveRight:"Move Right",resetColor:"Reset Color",cancelText:"Cancel",chooseText:"Confirm Color",tipNameRepeat:"Sheet names cannot be duplicated! Please modify",noMoreSheet:"The workbook must contain at least one visible worksheet. To delete the selected sheet, please insert a new worksheet or unhide a hidden worksheet first.",confirmDelete:"Confirm Delete",redoDelete:"Can undo delete with Ctrl+Z",noHide:"Cannot hide, must keep at least one sheet tab",chartEditNoOpt:"This operation is not allowed in chart edit mode!",sheetNameErrorTitle:"Error",sheetNameSpecCharError:`Name cannot exceed 31 characters, cannot start or end with ' and cannot contain:\r
[ ] : \\ ? * /`,sheetNameCannotIsEmptyError:"Name cannot be empty.",sheetNameAlreadyExistsError:"Sheet already exists, please enter a different name.",deleteSheet:"Delete Sheet",deleteSheetContent:"Confirm deletion of this worksheet? Deleted sheets cannot be recovered."},rightClick:{copy:"Copy",copyAs:"Copy As",cut:"Cut",paste:"Paste",pasteSpecial:"Paste Special",pasteValue:"Paste Values Only",pasteFormat:"Paste Format Only",pasteColWidth:"Paste Column Width Only",pasteBesidesBorder:"Paste Except Borders",insert:"Insert",delete:"Delete",insertRow:"Insert Row",insertRowBefore:"Insert Row Above",insertColumn:"Insert Column",insertColumnBefore:"Insert Column Left",deleteCell:"Delete Cell",insertCell:"Insert Cell",deleteSelected:"Delete Selected",hide:"Hide",hideSelected:"Hide Selected",showHide:"Show Hidden",toTopAdd:"Add Above",toBottomAdd:"Add Below",toLeftAdd:"Add Left",toRightAdd:"Add Right",deleteSelectedRow:"Delete Selected Rows",deleteSelectedColumn:"Delete Selected Columns",hideSelectedRow:"Hide Selected Rows",showHideRow:"Show Hidden Rows",rowHeight:"Row Height",hideSelectedColumn:"Hide Selected Columns",showHideColumn:"Show Hidden Columns",columnWidth:"Column Width",to:"To",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move Left",moveUp:"Move Up",moveRight:"Move Right",moveDown:"Move Down",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"Sort A-Z",orderZA:"Sort Z-A",clearSelection:"Clear",clearContent:"Clear Content",clearFormat:"Clear Format",clearAll:"Clear All",matrix:"Matrix Operation Selection",sortSelection:"Sort Selection",filterSelection:"Filter Selection",chartGeneration:"Chart Generation",firstLineTitle:"First Row as Title",untitled:"Untitled",array1:"1D Array",array2:"2D Array",array3:"Multi-Dimensional Array",diagonal:"Diagonal",antiDiagonal:"Anti-Diagonal",diagonalOffset:"Diagonal Offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up Down",leftAndRight:"Left Right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix Calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divide",power:"Power",root:"Root",log:"Log",delete0:"Remove Leading/Trailing Zeros",removeDuplicate:"Remove Duplicates",byRow:"By Row",byCol:"By Column",generateNewMatrix:"Generate New Matrix",fitContent:"Fit Content",freeze:"Freeze",freezeCol:"Freeze Column",freezeRow:"Freeze Row",cancelFreeze:"Unfreeze",zenEditor:"Zen Mode Edit"},info:{tooltip:"Tip",notChangeMerge:"Cannot partially change merged cells",detailUpdate:"New Open",detailSave:"Local Cache Restored",row:"Row",column:"Column",loading:"Rendering...",copy:"Copy",return:"Return",rename:"Rename",tips:"Rename",noName:"Untitled Spreadsheet",wait:"Pending Update",add:"Add",addLast:"Add at Bottom",backTop:"Back to Top",pageInfo:"Total ${total} items, ${totalPage} pages, currently showing page ${currentPage}",nextPage:"Next Page",tipInputNumber:"Please enter a number",tipInputNumberLimit:"Increase range limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"Column width must be between 0 ~ 2038",pageInfoFull:"Total ${total} items, ${totalPage} pages, all data displayed"},clipboard:{paste:{exceedMaxCells:"Paste area exceeds maximum number of cells"}},statusbar:{sum:"Sum",average:"Average",min:"Min",max:"Max",count:"Count Numbers",countA:"Count",clickToCopy:"Click to copy value",copied:"Copied"},autoFill:{copy:"Copy Cells",series:"Fill Series",formatOnly:"Fill Format Only",noFormat:"Fill Without Format"},rangeSelector:{placeholder:"Select range or enter value",tooltip:"Select range"},shortcut:{sheet:{"zoom-in":"Zoom In","zoom-out":"Zoom Out","reset-zoom":"Reset Zoom","select-below-cell":"Select Cell Below","select-up-cell":"Select Cell Above","select-left-cell":"Select Cell Left","select-right-cell":"Select Cell Right","select-next-cell":"Select Next Cell","select-previous-cell":"Select Previous Cell","select-up-value-cell":"Select Value Cell Above","select-below-value-cell":"Select Value Cell Below","select-left-value-cell":"Select Value Cell Left","select-right-value-cell":"Select Value Cell Right","expand-selection-down":"Expand Selection Down","expand-selection-up":"Expand Selection Up","expand-selection-left":"Expand Selection Left","expand-selection-right":"Expand Selection Right","expand-selection-to-left-gap":"Expand Selection to Left Gap","expand-selection-to-below-gap":"Expand Selection to Below Gap","expand-selection-to-right-gap":"Expand Selection to Right Gap","expand-selection-to-up-gap":"Expand Selection to Up Gap","select-all":"Select All","toggle-editing":"Start/End Editing","delete-and-start-editing":"Clear and Start Editing","abort-editing":"Cancel Editing","break-line":"Line Break","set-bold":"Toggle Bold","set-italic":"Toggle Italic","set-underline":"Toggle Underline","set-strike-through":"Toggle Strikethrough"}},"sheet-view":"Browse Sheet","sheet-edit":"Edit Sheet"},aAe=(t,e,n=!1)=>{const r=d=>d.endRow-d.startRow+1,i=d=>d.endColumn-d.startColumn+1,o=r(e)%r(t),s=i(e)%i(t),a={startRow:0,endRow:r(t)-1,startColumn:0,endColumn:i(t)-1},l=Math.floor(r(e)/r(t)),u=Math.floor(i(e)/i(t)),c=[];if(!o&&!s)for(let d=1;d<=l;d++)for(let h=1;h<=u;h++){const f=r(t)*(d-1),m=i(t)*(h-1),p={startRow:f+e.startRow,endRow:f+e.startRow,startColumn:m+e.startColumn,endColumn:m+e.startColumn};c.push({repeatRelativeRange:a,startRange:p})}else if(!o&&s&&!n)for(let d=1;d<=l;d++){const h=r(t)*(d-1),f=0,m={startRow:h+e.startRow,endRow:h+e.startRow,startColumn:f+e.startColumn,endColumn:f+e.startColumn};c.push({repeatRelativeRange:a,startRange:m})}else if(o&&!s&&!n)for(let d=1;d<=u;d++){const h=i(t)*(d-1),f={startRow:0+e.startRow,endRow:0+e.startRow,startColumn:h+e.startColumn,endColumn:h+e.startColumn};c.push({repeatRelativeRange:a,startRange:f})}else{const d={startRow:e.startRow,endRow:e.startRow,startColumn:e.startColumn,endColumn:e.startColumn};c.push({startRange:d,repeatRelativeRange:a})}return c};class lAe{constructor(){V(this,"_state",null),V(this,"_rect",null),V(this,"_focus",!1),V(this,"_state$",new rn(null)),V(this,"state$",this._state$.asObservable()),V(this,"_rect$",new rn(null)),V(this,"rect$",this._rect$.asObservable()),V(this,"_focus$",new rn(this._focus)),V(this,"focus$",this._focus$.asObservable())}dispose(){this._state$.complete(),this._state=null,this._rect$.complete(),this._rect=null}setState(e){this._state=e,this._refresh(e)}getRect(){return this._rect}setRect(e){this._rect=e,this._rect$.next(e)}getState(){return this._state}setFocus(e=!1){this._focus=e,this._focus$.next(e)}_refresh(e){this._state$.next(e)}}const Cc=nn("univer.sheet-cell-editor-manager.service");class uAe{constructor(){V(this,"_position",null),V(this,"_position$",new rn(null)),V(this,"position$",this._position$.asObservable()),V(this,"_focus",!1),V(this,"_focus$",new rn(this._focus)),V(this,"focus$",this._focus$.asObservable()),V(this,"_fxBtnClick$",new rn(!1)),V(this,"fxBtnClick$",this._fxBtnClick$.asObservable())}dispose(){this._position$.complete(),this._focus$.complete(),this._position=null,this._focus=!1}setPosition(e){this._position=e,this._refresh(e)}getPosition(){return this._position}setFocus(e=!1){this._focus=e,this._focus$.next(e)}handleFxBtnClick(e){this._fxBtnClick$.next(e)}_refresh(e){this._position$.next(e)}}const W4=nn("univer.sheet-formula-editor-manager.service");var cAe=Object.defineProperty,dAe=Object.getOwnPropertyDescriptor,hAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?dAe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&cAe(e,n,i),i},hI=(t,e)=>(n,r)=>e(n,r,t);let d8=class extends je{constructor(e,n){super(),V(this,"_previousSheetIndex",-1),this._commandService=e,this._univerInstanceService=n,this.disposeWithMe(this._commandService.beforeCommandExecuted((r,i)=>{if(r.id===Zs.id)return this._beforeAdjustActiveSheetOnRemoveSheet(r)})),this.disposeWithMe(this._commandService.onCommandExecuted((r,i)=>{if(r.id===Zs.id)return this._adjustActiveSheetOnRemoveSheet(r);if(r.id===zs.id&&r.params.hidden)return this._adjustActiveSheetOnHideSheet(r);if(!(i!=null&&i.fromCollab)){if(r.id===ps.id)return this._adjustActiveSheetOnInsertSheet(r);if(r.id===zs.id&&!r.params.hidden)return this._adjustActiveSheetOnShowSheet(r)}}))}_adjustActiveSheetOnHideSheet(e){const{unitId:n,subUnitId:r}=e.params,i=this._univerInstanceService.getUniverSheetInstance(n);if(!i||(i==null?void 0:i.getRawActiveSheet())!==r)return;const o=i.getActiveSheetIndex(),s=fAe(i,o);this._switchToNextSheet(n,s)}_beforeAdjustActiveSheetOnRemoveSheet(e){const{unitId:n,subUnitId:r}=e.params,i=this._univerInstanceService.getUniverSheetInstance(n);if(!i)return;const o=i.getSheetBySheetId(r);o&&(this._previousSheetIndex=i.getSheetIndex(o))}_adjustActiveSheetOnRemoveSheet(e){if(this._previousSheetIndex===-1)return;const{unitId:n}=e.params,r=this._univerInstanceService.getUniverSheetInstance(n);if(!r||r.getRawActiveSheet())return;const i=this._previousSheetIndex,o=i>=1?i-1:0,s=r.getSheetByIndex(o);if(!s)throw new Error("[ActiveWorksheetController]: cannot find the next sheet!");this._switchToNextSheet(n,s.getSheetId())}_adjustActiveSheetOnInsertSheet(e){const{unitId:n,sheet:r}=e.params;this._switchToNextSheet(n,r.id)}_adjustActiveSheetOnShowSheet(e){const{unitId:n,subUnitId:r}=e.params;this._switchToNextSheet(n,r)}_switchToNextSheet(e,n){this._commandService.executeCommand(ja.id,{unitId:e,subUnitId:n})}};d8=hAe([yt(it.Ready,d8),hI(0,le),hI(1,oe)],d8);function fAe(t,e){const n=t.getSheetSize();for(let r=e;r>-1;r--){const i=t.getSheetByIndex(r);if(!i.getConfig().hidden)return i.getSheetId()}for(let r=e;r<n;r++){const i=t.getSheetByIndex(r);if(!i.getConfig().hidden)return i.getSheetId()}throw new Error("[ActiveWorksheetController]: could not find the next unhidden sheet! Collaboration error perhaps.")}var mAe=Object.defineProperty,pAe=Object.getOwnPropertyDescriptor,gAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?pAe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&mAe(e,n,i),i},cd=(t,e)=>(n,r)=>e(n,r,t);let h8=class{constructor(e,n,r,i,o){this._injector=e,this._sheetInterceptorService=n,this._selectionManagerService=r,this._univerInstanceService=i,this._sheetSkeletonManagerService=o,this._initialize()}_getUndoRedoParamsOfAutoHeight(e){const{_univerInstanceService:n,_sheetSkeletonManagerService:r,_injector:i}=this,{skeleton:o}=r.getCurrent(),s=o.calculateAutoHeightInRange(e),a=n.getCurrentUniverSheetInstance(),l=a.getUnitId(),u={subUnitId:a.getActiveSheet().getSheetId(),unitId:l,rowsAutoHeightInfo:s},c=lOe(i,u);return{undos:[{id:G6.id,params:c}],redos:[{id:G6.id,params:u}]}}_initialize(){const{_sheetInterceptorService:e,_selectionManagerService:n}=this;e.interceptCommand({getMutations:r=>r.id!==Oa.id?{redos:[],undos:[]}:this._getUndoRedoParamsOfAutoHeight(r.params.range)}),e.interceptCommand({getMutations:r=>r.id!==U4.id?{redos:[],undos:[]}:this._getUndoRedoParamsOfAutoHeight(r.params.ranges)}),e.interceptCommand({getMutations:r=>{var i;if(r.id!==qr.id)return{redos:[],undos:[]};if(!["ff","fs","tr","tb"].includes((i=r.params)==null?void 0:i.style.type))return{redos:[],undos:[]};const o=n.getSelectionRanges();return o!=null&&o.length?this._getUndoRedoParamsOfAutoHeight(o):{redos:[],undos:[]}}})}};h8=gAe([yt(it.Ready,h8),cd(0,ne(Tn)),cd(1,ne(En)),cd(2,ne(ut)),cd(3,ne(oe)),cd(4,ne(kr))],h8);function vAe(t,e,n,r,i,o){const s=[],a=[];if(i.copyType===al.CUT){const{undos:l,redos:u}=_Ae(t,n,r,i,o);s.push(...u),a.push(...l)}else{const{undos:l,redos:u}=$F(n,r,t,e,o);s.push(...u),a.push(...l);const{undos:c,redos:d}=OF(n,r,t,e,o);s.push(...d),a.push(...c);const{undos:h,redos:f}=TF(n,r,t,e,o);s.push(...f),a.push(...h);const{undos:m,redos:p}=O_(n,r,t,e,o);s.push(...p),a.push(...m)}return{undos:a,redos:s}}function _Ae(t,e,n,r,i){let o=[],s=[];const{copyRange:a}=r;if(a){const l=i.get(oe),u=i.get(En),c=l.getUniverSheetInstance(e),d=c==null?void 0:c.getSheetBySheetId(n);if(d){const h=d.getRange(a).getValues(),f=h.reduce((y,S,E)=>(S.forEach((w,R)=>{y.setValue(a.startRow+E,a.startColumn+R,null)}),y),new nt),m=h.reduce((y,S,E)=>(S.forEach((w,R)=>{y.setValue(a.startRow+E,a.startColumn+R,w)}),y),new nt),p=h.reduce((y,S,E)=>(S.forEach((w,R)=>{y.setValue(t.startRow+E,t.startColumn+R,w)}),y),new nt),g=d.getRange(t).getValues().reduce((y,S,E)=>(S.forEach((w,R)=>{y.setValue(t.startRow+E,t.startColumn+R,w)}),y),new nt),v={from:f.getMatrix(),to:p.getMatrix(),unitId:e,subUnitId:n},_={from:m.getMatrix(),to:g.getMatrix(),unitId:e,subUnitId:n},C=u.onCommandExecute({id:gc.id,params:{toRange:t,fromRange:a}});o=[{id:Al.id,params:v},...C.redos,{id:dn.id,params:{unitId:e,sheetId:n,pluginName:On,selections:[{range:t}]}}],s=[{id:dn.id,params:{unitId:e,sheetId:n,pluginName:On,selections:[{range:a}]}},...C.undos,{id:Al.id,params:_}]}}return{undos:s,redos:o}}function OF(t,e,n,r,i){const o=[],s=[],{startColumn:a,startRow:l}=n,u=new nt;r.forValue((h,f,m)=>{u.setValue(h+l,f+a,{v:m.v})});const c={unitId:t,subUnitId:e,cellValue:u.getData()};o.push({id:Pt.id,params:c});const d=Bi(i,c);return s.push({id:Pt.id,params:d}),{undos:s,redos:o}}function TF(t,e,n,r,i){const o=[],s=[],{startColumn:a,startRow:l}=n,u=new nt;r.forValue((h,f,m)=>{var p;u.setValue(h+l,f+a,{s:m.s}),(p=m.p)!=null&&p.body&&u.setValue(h+l,f+a,{p:m.p})});const c={unitId:t,subUnitId:e,cellValue:u.getData()};o.push({id:Pt.id,params:c});const d=Bi(i,c);return s.push({id:Pt.id,params:d}),{undos:s,redos:o}}function $F(t,e,n,r,i){const o=[],s=[],a=new nt,{startColumn:l,startRow:u}=n;if(r.forValue((c,d,h)=>{h.s&&a.setValue(c+u,d+l,{s:null})}),a.getLength()>0){const c={subUnitId:e,unitId:t,cellValue:a.getData()};o.push({id:Pt.id,params:c});const d=Bi(i,c);s.push({id:Pt.id,params:d})}return{undos:s,redos:o}}function O_(t,e,n,r,i){const o=[],s=[],{startColumn:a,startRow:l,endColumn:u,endRow:c}=n;let d=!1;const h=[];if(r.forValue((p,g,v)=>{if(v.rowSpan){const _=v.colSpan||1,C={startRow:l+p,endRow:l+p+v.rowSpan-1,startColumn:a+g,endColumn:a+g+_-1};h.push(C),d=!0}else if(v.colSpan){const _=v.rowSpan||1,C={startRow:l+p,endRow:l+p+_-1,startColumn:a+g,endColumn:a+g+v.colSpan-1};h.push(C),d=!0}}),d){const p=i.get(oe).getUniverSheetInstance(t),g=p==null?void 0:p.getSheetBySheetId(e);if(p&&g){const v=g.getMergeData().filter(y=>pt.intersects({startRow:l,startColumn:a,endRow:c,endColumn:u},y)),_={unitId:t,subUnitId:e,ranges:v};o.push({id:Rn.id,params:_});const C=Ai(i,_);s.push({id:wn.id,params:C})}}const f={unitId:t,subUnitId:e,ranges:h};o.push({id:wn.id,params:f});const m=so(i,f);return s.push({id:Rn.id,params:m}),{undos:s,redos:o}}var bAe=Object.defineProperty,CAe=Object.getOwnPropertyDescriptor,yAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?CAe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&bAe(e,n,i),i},iu=(t,e)=>(n,r)=>e(n,r,t);let f8=class extends je{constructor(e,n,r,i,o,s,a){super(),this._currentUniverSheet=e,this._commandService=n,this._configService=r,this._sheetClipboardService=i,this._messageService=o,this._injector=s,this._localService=a,this._init()}_init(){[VTe,jTe,k0].forEach(n=>this.disposeWithMe(this._commandService.registerAsMultipleCommand(n))),[KB,ZB,qB,QB].forEach(n=>this.disposeWithMe(this._commandService.registerCommand(n))),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initCopyingHooks())),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initPastingHook()));const e=this._initSpecialPasteHooks().map(n=>this._sheetClipboardService.addClipboardHook(n));this.disposeWithMe({dispose:()=>e.forEach(n=>n.dispose())})}_initCopyingHooks(){const e=this;let n=null;return{hookName:Wi.DEFAULT_COPY,isDefaultHook:!0,onBeforeCopy(r,i){n=e._getWorksheet(r,i)},onCopyCellContent(r,i){const o=n.getCell(r,i);return`${o==null?void 0:o.v}`||""},onCopyCellStyle:(r,i,o,s)=>{const a={};(o||s)&&(a.rowspan=`${o||1}`,a.colspan=`${s||1}`);const l=n.getRange(r,i).getTextStyle();let u="";return l&&(u=FV(l)),u&&(a.style=u),a},onCopyColumn(r){return{width:`${n.getColumnWidth(r)}`}},onCopyRow(r){return{style:`height: ${n.getRowHeight(r)}px;`}},onAfterCopy(){n=null}}}_initPastingHook(){const e=this;let n=null,r=null,i=null;return{hookName:Wi.DEFAULT_PASTE,isDefaultHook:!0,onBeforePaste(o,s,a){i=e._getWorksheet(o,s),n=o,r=s;const l=e._configService.getConfig(AB),{endRow:u,endColumn:c}=a;return l&&u*c>l?(e._messageService.show({type:T9.Error,content:e._localService.t("clipboard.paste.exceedMaxCells")}),!1):!0},onPasteRows(o,s){const a=[],l=i.getMaxRows(),u=o.endRow-l,c=s.length-u;if(u>0){const f={};s.slice(c).forEach((p,g)=>{const v=p==null?void 0:p.style;if(!v)return;const _=v.split(";");let C=Kp;_.find(y=>{y=y.toLowerCase();const S=C2(y.substr(0,y.indexOf(":"))),E=C2(y.substr(y.indexOf(":")+1));return S==="height"?(C=parseFloat(E),!0):!1}),f[g]={h:C,hd:ke.FALSE}});const m={unitId:n,subUnitId:r,range:{...o,startRow:l},rowInfo:f};a.push({id:qu.id,params:m})}const d={};s.slice(0,c).forEach((f,m)=>{const p=f.style;if(!p)return;const g=p.split(";");let v=Kp;g.find(_=>{_=_.toLowerCase();const C=C2(_.substr(0,_.indexOf(":"))),y=C2(_.substr(_.indexOf(":")+1));return C==="height"?(v=parseFloat(y),!0):!1}),d[m]=v});const h={unitId:n,subUnitId:r,ranges:[{...o,endRow:Math.min(o.endRow,l)}],rowHeight:d};return a.push({id:d1.id,params:h}),{redos:a,undos:[]}},onPasteColumns(o,s,a){const l=[],u=i.getMaxColumns(),c=o.endColumn-u,d=s.length-c;if(c>0){const f={unitId:n,subUnitId:r,range:{...o,startColumn:u},colInfo:s.slice(d).map(m=>({w:m.width?+m.width:c3,hd:ke.FALSE}))};l.push({id:Qu.id,params:f})}const h={unitId:n,subUnitId:r,ranges:[{...o,endRow:Math.min(o.endColumn,u)}],colWidth:s.slice(0,d).map(f=>f.width?+f.width:c3)};return l.push({id:js.id,params:h}),{redos:l,undos:[]}},onPasteCells(o,s,a,l){return e._onPasteCells(o,s,n,r,a,l)},onAfterPaste(o){i=null}}}_onPasteCells(e,n,r,i,o,s){const a={get:this._injector.get.bind(this._injector)};return vAe(e,n,r,i,s,a)}_initSpecialPasteHooks(){const e={get:this._injector.get.bind(this._injector)},n=this,r={hookName:Wi.SPECIAL_PASTE_VALUE,specialPasteInfo:{label:"specialPaste.value"},onPasteCells:(a,l,u,c)=>{const d=n._currentUniverSheet.getCurrentUniverSheetInstance(),h=d.getUnitId(),f=d.getActiveSheet().getSheetId();return OF(h,f,a,l,e)}},i={hookName:Wi.SPECIAL_PASTE_FORMAT,specialPasteInfo:{label:"specialPaste.format"},onPasteCells(a,l,u,c){const d=n._currentUniverSheet.getCurrentUniverSheetInstance(),h=d.getUnitId(),f=d.getActiveSheet().getSheetId(),m=[],p=[],{undos:g,redos:v}=$F(h,f,a,l,e);m.push(...v),p.push(...g);const{undos:_,redos:C}=O_(h,f,a,l,e);m.push(...C),p.push(..._);const{undos:y,redos:S}=TF(h,f,a,l,e);return m.push(...S),p.push(...y),{undos:p,redos:m}}},o={hookName:Wi.SPECIAL_PASTE_COL_WIDTH,specialPasteInfo:{label:"specialPaste.colWidth"},onPasteCells(){return{undos:[],redos:[]}},onPasteColumns(a,l,u){const c=n._currentUniverSheet.getCurrentUniverSheetInstance(),d=c.getUnitId(),h=c.getActiveSheet().getSheetId(),f=[],m=n._getWorksheet(d,h).getMaxColumns(),p=a.endColumn-m,g=l.length-p,v={unitId:d,subUnitId:h,ranges:[{...a,endRow:Math.min(a.endColumn,m)}],colWidth:l.slice(0,g).map(_=>_.width?+_.width:c3)};return f.push({id:js.id,params:v}),f.push({id:js.id,params:v}),{redos:f,undos:[]}}},s={hookName:Wi.SPECIAL_PASTE_BESIDES_BORDER,specialPasteInfo:{label:"specialPaste.besidesBorder"},onPasteCells(a,l,u,c){const d=n._currentUniverSheet.getCurrentUniverSheetInstance(),h=d.getUnitId(),f=d.getActiveSheet().getSheetId(),m=[],p=[],{startColumn:g,startRow:v,endColumn:_,endRow:C}=a,y=new nt;l.forValue((D,I,k)=>{const O=k.s;typeof O=="object"&&y.setValue(D+v,I+g,{s:{...O,bd:void 0},v:k.v})});const S={unitId:h,subUnitId:f,cellValue:y.getData()};m.push({id:Pt.id,params:S});const E=Bi(e,S);p.push({id:Pt.id,params:E});const{undos:w,redos:R}=O_(h,f,a,l,e);return p.push(...w),m.push(...R),{redos:m,undos:p}}};return[r,i,o,s]}_getWorksheet(e,n){var r;const i=(r=this._currentUniverSheet.getUniverSheetInstance(e))==null?void 0:r.getSheetBySheetId(n);if(!i)throw new Error(`[SheetClipboardController]: cannot find a worksheet with unitId ${e} and subUnitId ${n}.`);return i}};f8=yAe([yt(it.Rendered,f8),iu(0,oe),iu(1,le),iu(2,d0),iu(3,_c),iu(4,w4),iu(5,ne(Tn)),iu(6,ne(mn))],f8);var SAe=Object.defineProperty,EAe=Object.getOwnPropertyDescriptor,wAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?EAe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&SAe(e,n,i),i},dd=(t,e)=>(n,r)=>e(n,r,t);let m8=class extends je{constructor(e,n,r,i,o){super(),this._currentUniverService=e,this._contextMenuService=n,this._renderManagerService=r,this._selectionManagerService=i,this._selectionRenderService=o,this._currentUniverService.currentSheet$.subscribe(s=>{if(s==null)throw new Error("workbook is null");this._addListeners()})}_addListeners(){const e=jo(this._currentUniverService,this._renderManagerService);if(!e)return;const n=e.spreadsheet.onPointerDownObserver,r=n.add(s=>{if(s.button===2){const a=this._selectionManagerService.getSelections(),l=a==null?void 0:a[0];if(!l)return;const u=l.range.rangeType,c=this._selectionRenderService.convertSelectionRangeToData(l).rangeWithCoord,d=()=>{if(!c)return!1;const f=s.offsetX,m=s.offsetY;switch(u){case Rt.ROW:return c.startY<=m&&c.endY>=m;case Rt.COLUMN:return c.startX<=f&&c.endX>=f;default:return c.startX<=f&&c.endX>=f&&c.startY<=m&&c.endY>=m}},h=f=>{this._contextMenuService.triggerContextMenu(s,f)};d()?u===Rt.COLUMN?h(si.COL_HEADER_CONTEXT_MENU):u===Rt.ROW?h(si.ROW_HEADER_CONTEXT_MENU):h(yn.CONTEXT_MENU):h(yn.CONTEXT_MENU)}});this.disposeWithMe(Be(()=>n.remove(r)));const i=e.spreadsheetRowHeader.onPointerDownObserver.add(s=>{s.button===2&&this._contextMenuService.triggerContextMenu(s,si.ROW_HEADER_CONTEXT_MENU)});this.disposeWithMe(Be(()=>n.remove(i)));const o=e.spreadsheetColumnHeader.onPointerDownObserver.add(s=>{s.button===2&&this._contextMenuService.triggerContextMenu(s,si.COL_HEADER_CONTEXT_MENU)});this.disposeWithMe(Be(()=>n.remove(o)))}};m8=wAe([yt(it.Rendered,m8),dd(0,oe),dd(1,tf),dd(2,kn),dd(3,ne(ut)),dd(4,to)],m8);var RAe=Object.defineProperty,DAe=Object.getOwnPropertyDescriptor,IAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?DAe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&RAe(e,n,i),i},bp=(t,e)=>(n,r)=>e(n,r,t);let p8=class extends E1{constructor(e,n,r){super(),this._currentUniverService=e,this._renderManagerService=n,this._undoRedoService=r,this._initialize(),this._commandExecutedListener()}_initialize(){this._initialNormalInput(),this._listenEditorBlur()}_listenEditorBlur(){this._currentUniverService.currentDoc$.pipe(Ts(this.dispose$)).subscribe(e=>{e!=null&&e.getUnitId()!==Zr&&this._undoRedoService.clearUndoRedo(Zr)})}_initialNormalInput(){const e={};this._currentUniverService.getCurrentUniverSheetInstance().getSheets().forEach(n=>{const r=n.getConfig();e[n.getSheetId()]={cellData:new nt(r.cellData),rowCount:r.rowCount,columnCount:r.columnCount}})}_commandExecutedListener(){}_getDocObject(){return I4(this._currentUniverService,this._renderManagerService)}};p8=IAe([yt(it.Steady,p8),bp(0,oe),bp(1,kn),bp(2,ne(At))],p8);const kF=[Xe.ARROW_DOWN,Xe.ARROW_UP,Xe.ARROW_LEFT,Xe.ARROW_RIGHT],xAe=[Xe.ENTER,Xe.TAB,...kF];function MAe(){const t=[];for(const e of kF)t.push({id:R5.id,binding:e,preconditions:n=>E5(n),staticParameters:{visible:!1,eventType:Zn.Keyboard,keycode:e,isShift:!1}}),t.push({id:R5.id,binding:e|Ut.SHIFT,preconditions:n=>E5(n),staticParameters:{visible:!1,eventType:Zn.Keyboard,keycode:e,isShift:!0}});return t}const OAe={id:$a.id,binding:Xe.ENTER,description:"shortcut.sheet.toggle-editing",group:"4_sheet-edit",preconditions:t=>E5(t),staticParameters:{visible:!1,eventType:Zn.Keyboard,keycode:Xe.ENTER}},TAe={id:$a.id,binding:Xe.TAB,preconditions:t=>E5(t),staticParameters:{visible:!1,eventType:Zn.Keyboard,keycode:Xe.TAB}},$Ae={id:$a.id,binding:Xe.ESC,description:"shortcut.sheet.abort-editing",group:"4_sheet-edit",preconditions:t=>WB(t),staticParameters:{visible:!1,eventType:Zn.Keyboard,keycode:Xe.ESC}},kAe={id:ty.id,description:"shortcut.sheet.break-line",group:"4_sheet-edit",preconditions:t=>WB(t),binding:Xe.ENTER|Ut.ALT},AAe={id:ny.id,preconditions:t=>tTe(t)||XB(t),binding:Xe.BACKSPACE},NAe={id:$a.id,description:"shortcut.sheet.delete-and-start-editing",group:"4_sheet-edit",preconditions:t=>eTe(t)&&!XB(t),binding:Xe.BACKSPACE,staticParameters:{visible:!0,eventType:Zn.Keyboard,keycode:Xe.BACKSPACE}};var LAe=Object.defineProperty,PAe=Object.getOwnPropertyDescriptor,BAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?PAe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&LAe(e,n,i),i},ia=(t,e)=>(n,r)=>e(n,r,t);function FAe(t){const{textRuns:e=[],paragraphs:n=[]}=t;return e.some(r=>r.ts&&!De.isEmptyObject(r.ts))||n.some(r=>r.bullet)}let g8=class extends je{constructor(e,n,r,i,o,s,a,l,u,c){super(),V(this,"_onInputSubscription"),V(this,"_cursorChangeObservers"),V(this,"_editorVisiblePrevious",!1),V(this,"_isCursorChange",0),this._currentUniverService=e,this._renderManagerService=n,this._commandService=r,this._editorBridgeService=i,this._contextService=o,this._cellEditorManagerService=s,this._lexerTreeBuilder=a,this._undoRedoService=l,this._sheetInterceptorService=u,this._selectionManagerService=c,this._initialize(),this._commandExecutedListener()}dispose(){var e;(e=this._onInputSubscription)==null||e.unsubscribe();const n=this._getEditorObject();if(n==null)return;const{document:r}=n;r.onPointerDownObserver.remove(this._cursorChangeObservers)}_initialize(){this._initialExitInput(),this._cursorStateListener()}_initialExitInput(){this._onInputSubscription=this._editorBridgeService.visible$.subscribe(e=>{const{visible:n,keycode:r,eventType:i}=e;if(n===this._editorVisiblePrevious)return;if(this._editorVisiblePrevious=n,n===!0){this._isCursorChange=i===Zn.PointerDown?2:1;return}this._isCursorChange=0;const o=this._selectionManagerService.getSelections(),s=this._selectionManagerService.getCurrent();if(s==null)return;const{unitId:a,sheetId:l,pluginName:u}=s;if(this._exitInput(e),r===Xe.ESC){this._commandService.syncExecuteCommand(dn.id,{unitId:a,subUnitId:l,pluginName:u,selections:o});return}const c=this._editorBridgeService.getState();if(c==null)return;const{unitId:d,sheetId:h,row:f,column:m,documentLayoutObject:p}=c;if(p==null||(this._moveCursor(r),this._editorBridgeService.getEditorDirty()===!1))return;const g=this._currentUniverService.getUniverSheetInstance(d),v=g==null?void 0:g.getSheetBySheetId(h);if(v==null)return;const _=De.deepClone(v.getCellRaw(f,m)||{}),C=p.documentModel.getSnapshot(),y=C.body;if(y==null)return;const S=y.dataStream;let E=S.substring(S.length-2,S.length)===c6?S.substring(0,S.length-2):S;if(Ao(E)){if(_.f===E)return;const D=this._lexerTreeBuilder.checkIfAddBracket(E);for(let I=0;I<D;I++)E+=cn.CLOSE_BRACKET;_.f=E,_.v=null,_.p=null}else if(FAe(y))y.dataStream===`\r
`?(_.v="",_.f=null,_.p=null):(_.p=C,_.v=null,_.f=null);else{if(E==_.v||E==""&&_.v==null)return;_.v=E,_.f=null,_.p=null}const w={subUnitId:h,unitId:d,workbook:g,worksheet:v,row:f,col:m},R=this._editorBridgeService.interceptor.fetchThroughInterceptors(this._editorBridgeService.interceptor.getInterceptPoints().AFTER_CELL_EDIT)(_,w);this._commandService.executeCommand(Oa.id,{subUnitId:h,unitId:d,range:{startRow:f,startColumn:m,endRow:f,endColumn:m},value:R}),a===d&&h!==l&&this._commandService.executeCommand(T0.id,{subUnitId:h,unitId:d})})}_exitInput(e){this._contextService.setContextValue(yu,!1),this._contextService.setContextValue(Dr,!1),this._contextService.setContextValue(e4,!1),this._contextService.setContextValue(l1,!1),this._cellEditorManagerService.setState({show:e.visible});const n=this._editorBridgeService.getCurrentEditorId();n!=null&&(this._undoRedoService.clearUndoRedo(n),this._undoRedoService.clearUndoRedo(Un))}_moveCursor(e){if(e==null||!xAe.includes(e))return;let n=ge.LEFT;switch(e){case Xe.ENTER:n=ge.DOWN;break;case Xe.TAB:n=ge.RIGHT;break;case Xe.ARROW_DOWN:n=ge.DOWN;break;case Xe.ARROW_UP:n=ge.UP;break;case Xe.ARROW_LEFT:n=ge.LEFT;break;case Xe.ARROW_RIGHT:n=ge.RIGHT;break}e===Xe.ENTER||e===Xe.TAB?this._commandService.executeCommand(bc.id,{keycode:e,direction:n}):this._commandService.executeCommand(Yi.id,{direction:n})}_cursorStateListener(){const e=this._getEditorObject();if(e==null)return;const{document:n}=e;this._cursorChangeObservers=n.onPointerDownObserver.add(()=>{this._isCursorChange===1&&(this._isCursorChange=2)})}_commandExecutedListener(){const e=[R5.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(e.includes(n.id)){const r=n.params,{keycode:i,isShift:o}=r;if(i!=null&&this._isCursorChange===2){this._moveInEditor(i,o);return}this._editorBridgeService.changeVisible(r)}}))}_moveInEditor(e,n){let r=ge.LEFT;e===Xe.ARROW_DOWN?r=ge.DOWN:e===Xe.ARROW_UP?r=ge.UP:e===Xe.ARROW_RIGHT&&(r=ge.RIGHT),n?this._commandService.executeCommand(Ml.id,{direction:r}):this._commandService.executeCommand(_1.id,{direction:r})}_getEditorObject(){return o0(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}};g8=BAe([yt(it.Steady,g8),ia(0,oe),ia(1,kn),ia(2,le),ia(3,Eo),ia(4,Tr),ia(5,Cc),ia(6,ne(Ba)),ia(7,At),ia(8,ne(En)),ia(9,ne(ut))],g8);var UAe=Object.defineProperty,HAe=Object.getOwnPropertyDescriptor,VAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?HAe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&UAe(e,n,i),i},oa=(t,e)=>(n,r)=>e(n,r,t);let v8=class extends E1{constructor(e,n,r,i,o,s,a,l,u,c){super(),V(this,"_loadedMap",new Set),this._univerInstanceService=e,this._renderManagerService=n,this._editorBridgeService=r,this._docSkeletonManagerService=i,this._docViewModelManagerService=o,this._commandService=s,this._contextService=a,this._formulaEditorManagerService=l,this._undoRedoService=u,this._textSelectionManagerService=c,this._initialize()}_initialize(){this._syncFormulaEditorContent(),this._commandExecutedListener(),this._syncEditorSize(),this._listenFxBtnClick(),this._renderManagerService.currentRender$.pipe(Ts(this.dispose$)).subscribe(e=>{e===Un&&(this._loadedMap.has(e)||(this._initialMain(e),this._loadedMap.add(e)))}),this._textSelectionManagerService.textSelection$.pipe(Ts(this.dispose$)).subscribe(e=>{if(e==null)return;const{unitId:n}=e;n!==Un&&(this._contextService.setContextValue(l1,!1),this._undoRedoService.clearUndoRedo(Un))})}_listenFxBtnClick(){this._formulaEditorManagerService.fxBtnClick$.pipe(Ts(this.dispose$)).subscribe(()=>{var e;if(this._contextService.getContextValue(e4)&&!this._contextService.getContextValue(Dr)){this._univerInstanceService.setCurrentUniverDocInstance(Un),this._contextService.setContextValue(l1,!0);const n=this._univerInstanceService.getUniverDocInstance(Un);this._editorBridgeService.isVisible().visible===!1&&this._editorBridgeService.changeVisible({visible:!0,eventType:Zn.PointerDown});const r=(e=n==null?void 0:n.getBody())==null?void 0:e.dataStream;if(r==null)return;let i=r.startsWith("=")?r:`=${r}`;i=i.replace(/\r\n$/,"");const o=[{startOffset:i.length,endOffset:i.length}],s={unitId:Un,body:{dataStream:i},segmentId:""};this._commandService.executeCommand(bP.id,s),this._textSelectionManagerService.replaceTextRanges(o)}})}_initialMain(e){const n=this._renderManagerService.getRenderById(e);if(n==null)return;const{mainComponent:r}=n;r!=null&&this.disposeWithMe(Be(r.onPointerDownObserver.add(()=>{this._contextService.setContextValue(l1,!0),this._undoRedoService.clearUndoRedo(Un),this._editorBridgeService.isVisible().visible===!1&&this._editorBridgeService.changeVisible({visible:!0,eventType:Zn.PointerDown})})))}_syncEditorSize(){this._formulaEditorManagerService.position$.pipe(Ts(this.dispose$)).subscribe(e=>{if(e==null)return;const n=o0(Un,this._renderManagerService),r=this._univerInstanceService.getUniverDocInstance(Un);if(n==null||r==null)return;const{width:i,height:o}=e,{engine:s}=n;r.updateDocumentDataPageSize(i),this._autoScroll(),requestIdleCallback(()=>{s.resizeBySize(i,o)})})}_syncFormulaEditorContent(){this._editorBridgeService.state$.pipe(Ts(this.dispose$)).subscribe(e=>{e==null||this._editorBridgeService.isForceKeepVisible()||this._editorSyncHandler(e)}),this._editorBridgeService.visible$.pipe(Ts(this.dispose$)).subscribe(e=>{if(e==null||e.visible===!1||this._editorBridgeService.isForceKeepVisible())return;const n=this._editorBridgeService.getState();n!=null&&this._editorSyncHandler(n)})}_editorSyncHandler(e){var n;const r=(n=e.documentLayoutObject.documentModel)==null?void 0:n.getBody();let i=r==null?void 0:r.dataStream,o=r==null?void 0:r.paragraphs,s=[];i==null||o==null||(e.isInArrayFormulaRange===!0&&this._editorBridgeService.isVisible().eventType===Zn.Dblclick?(i=`\r
`,o=[{startIndex:0}]):e.isInArrayFormulaRange===!0&&(s=(r==null?void 0:r.textRuns)||[]),this._syncContentAndRender(Un,i,o,s),this._autoScroll())}_commandExecutedListener(){const e=[Kt.id,Sf.id],n=[Zr,Un];this.disposeWithMe(this._commandService.onCommandExecuted(r=>{var i,o;if(e.includes(r.id)){const s=r.params,{unitId:a}=s;if(n.includes(a)){const l=this._univerInstanceService.getUniverDocInstance(a),u=(i=l==null?void 0:l.getBody())==null?void 0:i.dataStream,c=(o=l==null?void 0:l.getBody())==null?void 0:o.paragraphs,d=a===Un?Zr:Un;if(u==null||c==null)return;this._syncContentAndRender(d,u,c),this._autoScroll()}}}))}_syncContentAndRender(e,n,r,i=[]){var o;const s=[Zr,Un],a=this._docSkeletonManagerService.getSkeletonByUnitId(e),l=this._univerInstanceService.getUniverDocInstance(e),u=this._docViewModelManagerService.getViewModel(e);if(l==null||u==null||a==null)return;l.getBody().dataStream=n,l.getBody().paragraphs=this._clearParagraph(r),e===Un&&(l.getBody().textRuns=[]),i.length>0&&(l.getBody().textRuns=i),u.reset(l);const{skeleton:c}=a,d=this._renderManagerService.getRenderById(e);d!=null&&(c.calculate(),s.includes(e)&&((o=d.mainComponent)==null||o.makeDirty()))}_clearParagraph(e){const n=De.deepClone(e);for(const r of n)r.paragraphStyle&&(r.paragraphStyle.horizontalAlign=Ln.UNSPECIFIED);return n}_autoScroll(){var e,n;const r=(e=this._docSkeletonManagerService.getSkeletonByUnitId(Un))==null?void 0:e.skeleton,i=this._formulaEditorManagerService.getPosition(),o=this._renderManagerService.getRenderById(Un),s=this._univerInstanceService.getUniverDocInstance(Un);if(r==null||i==null||o==null||s==null)return;const{marginTop:a=0,marginBottom:l=0}=s.getSnapshot().documentStyle,{scene:u,mainComponent:c}=o;let{actualHeight:d}=r.getActualSize();d+=a+l;const{width:h,height:f}=i,m=u.getViewport(Z2.VIEW_MAIN);let p=m==null?void 0:m.getScrollBar();d>f?p==null?m&&new b0(m,{enableHorizontal:!1}):m==null||m.resetSizeAndScrollBar():(p=null,m==null||m.scrollTo({x:0,y:0}),(n=m==null?void 0:m.getScrollBar())==null||n.dispose()),u.transformByState({width:h,height:d}),c==null||c.resize(h,d)}};v8=VAe([yt(it.Steady,v8),oa(0,oe),oa(1,kn),oa(2,Eo),oa(3,ne(Co)),oa(4,ne(v1)),oa(5,le),oa(6,Tr),oa(7,W4),oa(8,At),oa(9,ne(gr))],v8);var jAe=Object.defineProperty,zAe=Object.getOwnPropertyDescriptor,WAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?zAe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&jAe(e,n,i),i},XAe=(t,e)=>(n,r)=>e(n,r,t);let _8=class extends je{constructor(e){super(),this._currentUniverService=e,setTimeout(()=>{this._initialize()},0)}_initialize(){this._currentUniverService.createDoc({id:Zr,body:{dataStream:`${c6}`,textRuns:[],paragraphs:[{startIndex:0}]},documentStyle:{}});const e={id:Un,body:{dataStream:`${c6}`,textRuns:[],paragraphs:[{startIndex:0}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:5,marginBottom:5,marginRight:0,marginLeft:0,paragraphLineGapDefault:0,renderConfig:{horizontalAlign:Ln.UNSPECIFIED,verticalAlign:Kr.UNSPECIFIED,centerAngle:0,vertexAngle:0,wrapStrategy:yr.WRAP}}};this._currentUniverService.createDoc(e)}};_8=WAe([yt(it.Rendered,_8),XAe(0,oe)],_8);const YAe="36",GAe="univer-sheet-container",AF={sheetFooterBarHeight:YAe,sheetContainer:GAe};var KAe=Object.defineProperty,ZAe=Object.getOwnPropertyDescriptor,qAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?ZAe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&KAe(e,n,i),i},ys=(t,e)=>(n,r)=>e(n,r,t);const fI=-1e3,mI=5,QAe=2;let b8=class extends je{constructor(e,n,r,i,o,s,a,l,u,c,d){super(),V(this,"_onInputSubscription"),V(this,"_onInputActivateSubscription"),V(this,"_editorVisiblePrevious",!1),this._docSkeletonManagerService=e,this._docViewModelManagerService=n,this._contextService=r,this._currentUniverService=i,this._renderManagerService=o,this._editorBridgeService=s,this._cellEditorManagerService=a,this._textSelectionRenderManager=l,this._textSelectionManagerService=u,this._commandService=c,this._localService=d,this._initialize(),this._commandExecutedListener()}dispose(){var e,n;(e=this._onInputSubscription)==null||e.unsubscribe(),(n=this._onInputActivateSubscription)==null||n.unsubscribe()}_initialize(){this._initialEditFocusListener(),this._initialStartEdit(),this._initialKeyboardListener(),this._initialCursorSync(),this._listenEditorFocus()}_listenEditorFocus(){const e=this._getEditorObject();e!=null&&this.disposeWithMe(Be(e.document.onPointerDownObserver.add(()=>{var n;if(this._editorBridgeService.isVisible()){const r=this._editorBridgeService.getState(),i=this._editorBridgeService.getCurrentEditorId();if(r==null||i==null)return;const o=(n=this._docSkeletonManagerService.getSkeletonByUnitId(i))==null?void 0:n.skeleton;if(o==null)return;const{position:s,documentLayoutObject:a,canvasOffset:l,scaleX:u,scaleY:c}=r;this._fitTextSize(s,l,o,a,u,c)}})))}_initialCursorSync(){this._cellEditorManagerService.focus$.subscribe(()=>{this._textSelectionRenderManager.sync()})}_initialEditFocusListener(){this._onInputSubscription=this._editorBridgeService.state$.subscribe(e=>{if(e==null||this._editorBridgeService.isForceKeepVisible())return;const{position:n,documentLayoutObject:r,scaleX:i,editorUnitId:o}=e;if(this._getEditorObject()==null)return;const{startX:s,endX:a}=n,{textRotation:l,wrapStrategy:u,documentModel:c}=r,{a:d}=l;c.updateDocumentId(o),u===yr.WRAP&&d===0&&c.updateDocumentDataPageSize((a-s)/i),this._currentUniverService.changeDoc(o,c),this._contextService.setContextValue(e4,!0),this._textSelectionManagerService.replaceTextRanges([{startOffset:0,endOffset:0}]),this._textSelectionRenderManager.activate(fI,fI)})}_fitTextSize(e,n,r,i,o=1,s=1){const{startX:a,startY:l,endX:u,endY:c}=e,d=i.documentModel;if(d==null)return;const{actualWidth:h,actualHeight:f}=this._predictingSize(e,n,r,i,o,s),{verticalAlign:m,paddingData:p,fill:g}=i;let v=u-a,_=c-l;if(v<h&&(v=h),_<f)_=f,d.updateDocumentDataMargin(p);else{let C=p.t||0;m===Kr.MIDDLE?C=(_-f)/2:m===Kr.BOTTOM&&(C=_-f),C/=s,C=C<(p.t||0)?p.t||0:C,d.updateDocumentDataMargin({t:C})}r.calculate(),this._editAreaProcessing(v,_,e,n,g,o,s)}_predictingSize(e,n,r,i,o=1,s=1){const{startX:a,endX:l}=e,{textRotation:u,wrapStrategy:c}=i,d=i.documentModel,{a:h}=u,f=document.body.clientWidth;if(c===yr.WRAP&&h===0){const{actualWidth:g,actualHeight:v}=r.getActualSize();return{actualWidth:g*o,actualHeight:v*s}}d==null||d.updateDocumentDataPageSize((f-a-n.left)/o),r.calculate();const m=r.getActualSize();let p=l-a;return p<m.actualWidth*o+mI*o&&(p=m.actualWidth*o+mI),d==null||d.updateDocumentDataPageSize(p/o),d==null||d.updateDocumentRenderConfig({horizontalAlign:Ln.UNSPECIFIED}),{actualWidth:p,actualHeight:m.actualHeight*s}}_editAreaProcessing(e,n,r,i,o,s=1,a=1){var l;const u=this._getEditorObject();if(u==null)return;let{startX:c,startY:d}=r;const{document:h,scene:f,engine:m}=u,p=f.getViewport(Z2.VIEW_MAIN),g=document.body.clientHeight-d-parseFloat(AF.sheetFooterBarHeight)-i.top-QAe*2,v=document.body.clientWidth-c-i.left;let _=n,C=p==null?void 0:p.getScrollBar();_>g?(_=g,C==null?p&&new b0(p,{enableHorizontal:!1}):p==null||p.resetSizeAndScrollBar()):(C=null,(l=p==null?void 0:p.getScrollBar())==null||l.dispose()),e+=(C==null?void 0:C.barSize)||0,e>v&&(e=v);const y=m.getPixelRatio(),S=s*y,E=a*y;c=Et(c-ii,S),d=Et(d-ii,E),e=Et(e,S),n=Et(n,E),_=Et(n,E),this._addBackground(f,e/s,n/a,o),this._addBackground(f,e/s,n/a,o),f.transformByState({width:e,height:n}),h.resize(e,n),setTimeout(()=>{m.resizeBySize(e,_)},0),this._cellEditorManagerService.setState({startX:c,startY:d,endX:e+c,endY:_+d,show:!0})}_addBackground(e,n,r,i){const o="_backgroundRectHelperColor_",s=e.getObject(o);s==null&&i==null||(s==null?e.addObjects([new qt(o,{width:n,height:r,fill:i,evented:!1})],t_):i==null?s.dispose():(s.setProps({fill:i}),s.transformByState({width:n,height:r})))}_initialStartEdit(){this._onInputActivateSubscription=this._editorBridgeService.visible$.subscribe(e=>{var n,r,i;const{visible:o,eventType:s,keycode:a}=e;if(o===this._editorVisiblePrevious||(this._editorVisiblePrevious=o,o===!1))return;const l=this._editorBridgeService.getState();if(l==null)return;const{position:u,documentLayoutObject:c,canvasOffset:d,scaleX:h,scaleY:f,editorUnitId:m,unitId:p,isInArrayFormulaRange:g=!1}=l,v=this._getEditorObject();if(v==null)return;const{document:_,scene:C}=v;this._contextService.setContextValue(Dr,!0);const{documentModel:y}=c,S=this._docSkeletonManagerService.getSkeletonByUnitId(m);if(S==null||y==null)return;const{skeleton:E}=S;if(this._fitTextSize(u,d,E,c,h,f),s===Zn.Keyboard||s===Zn.Dblclick&&g){const w=De.deepClone(y.snapshot),R=(n=this._docViewModelManagerService.getCurrent())==null?void 0:n.docViewModel;this._resetBodyStyle(w.body),y.reset(w),R.reset(y),_.makeDirty(),(a===Xe.BACKSPACE||s===Zn.Dblclick)&&(E.calculate(),this._editorBridgeService.changeEditorDirty(!0)),this._textSelectionManagerService.replaceTextRanges([{startOffset:0,endOffset:0}])}else if(s===Zn.Dblclick){const w=y.getBody().dataStream.length-2||0;(r=C.getViewport(Z2.VIEW_MAIN))==null||r.scrollTo({y:1/0}),this._textSelectionManagerService.replaceTextRanges([{startOffset:w,endOffset:w}])}(i=this._renderManagerService.getRenderById(p))==null||i.scene.resetCursor()})}_resetBodyStyle(e){e.dataStream=c6,e.textRuns!=null&&(e.textRuns.length===1?(e.textRuns[0].st=0,e.textRuns[0].ed=1):e.textRuns=void 0),e.paragraphs!=null&&(e.paragraphs.length===1?e.paragraphs[0].startIndex=0:e.paragraphs=[{startIndex:0}]),e.sectionBreaks!=null&&(e.sectionBreaks=void 0),e.tables!=null&&(e.tables=void 0),e.customRanges!=null&&(e.customRanges=void 0),e.customBlocks!=null&&(e.customBlocks=void 0)}_initialKeyboardListener(){this._textSelectionRenderManager.onInputBefore$.subscribe(e=>{const n=this._contextService.getContextValue(l1);this._contextService.getContextValue(Rl)&&!n&&this._showEditorByKeyboard(e)})}_showEditorByKeyboard(e){if(e==null)return;const n=e.event;this._commandService.executeCommand($a.id,{visible:!0,eventType:Zn.Keyboard,keycode:n.which})}_commandExecutedListener(){const e=[Kt.id,Sf.id],n=[Zr,Un];this.disposeWithMe(this._commandService.onCommandExecuted(r=>{var i;if(e.includes(r.id)){const o=r.params,{unitId:s}=o,a=this._editorBridgeService.getCurrentEditorId();if(a==null)return;this._editorBridgeService.changeEditorDirty(!0);const l=(i=this._docSkeletonManagerService.getSkeletonByUnitId(a))==null?void 0:i.skeleton;if(l==null||!n.includes(s))return;const u=this._editorBridgeService.getState();if(u==null)return;const{position:c,documentLayoutObject:d,canvasOffset:h,scaleX:f,scaleY:m}=u;this._fitTextSize(c,h,l,d,f,m)}}))}_getEditorObject(){return o0(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}};b8=qAe([yt(it.Steady,b8),ys(0,ne(Co)),ys(1,ne(v1)),ys(2,Tr),ys(3,oe),ys(4,kn),ys(5,Eo),ys(6,Cc),ys(7,Wl),ys(8,ne(gr)),ys(9,le),ys(10,ne(mn))],b8);const NF={id:"sheet.operation.set-activate-cell-edit",type:se.OPERATION,handler:(t,e)=>(t.get(Eo).setState(e),!0)};var JAe=Object.defineProperty,eNe=Object.getOwnPropertyDescriptor,tNe=(t,e,n,r)=>{for(var i=r>1?void 0:r?eNe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&JAe(e,n,i),i},V1=(t,e)=>(n,r)=>e(n,r,t);let C8=class extends E1{constructor(e,n,r,i,o,s,a,l){super(),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._editorBridgeService=o,this._selectionManagerService=s,this._selectionRenderService=a,this._themeService=l,this._initialize(),this._commandExecutedListener()}dispose(){}_initialize(){this._initSelectionChangeListener(),this._initialEventListener()}_initSelectionChangeListener(){P5(this._selectionManagerService.selectionMoveEnd$,this._selectionManagerService.selectionMoveStart$).pipe(Ts(this.dispose$)).subscribe(e=>this._handleSelectionListener(e))}_handleSelectionListener(e){var n,r;const i=this._selectionManagerService.getCurrent();if((i==null?void 0:i.pluginName)!==On||this._editorBridgeService.isVisible().visible===!0)return;const o=this._sheetSkeletonManagerService.getCurrent(),s=this._getSheetObject();if(o==null||s==null)return;const{skeleton:a,unitId:l,sheetId:u}=o,{scene:c,engine:d}=s;if(e==null||e.length===0||a==null||e[e.length-1]==null)return;const{primary:h}=e[e.length-1];if(h==null)return;const{startRow:f,startColumn:m}=h,p=this._selectionRenderService.convertCellRangeToInfo(h);if(p==null)return;const g=ib(p);if(g==null)return;const v=OA(d);let{startX:_,startY:C,endX:y,endY:S}=g;const{scaleX:E,scaleY:w}=c.getAncestorScale(),R=c.getScrollXY(this._selectionRenderService.getViewPort());_=a.convertTransformToOffsetX(_,E,R),C=a.convertTransformToOffsetY(C,w,R),y=a.convertTransformToOffsetX(y,E,R),S=a.convertTransformToOffsetY(S,w,R);const D=this._currentUniverService.getCurrentUniverSheetInstance(),I=D.getActiveSheet(),k={workbook:D,worksheet:I,unitId:D.getUnitId(),subUnitId:I.getSheetId(),row:f,col:m},O=this._editorBridgeService.interceptor.fetchThroughInterceptors(this._editorBridgeService.interceptor.getInterceptPoints().BEFORE_CELL_EDIT)(I.getCell(f,m),k);let $=O&&a.getCellDocumentModelWithFormula(O);if((!$||$.documentModel==null)&&($=a.getBlankCellDocumentModel(O)),(n=$.documentModel)==null||n.setZoomRatio(Math.max(E,w)),(O==null?void 0:O.isInArrayFormulaRange)===!0){const N=(r=$.documentModel)==null?void 0:r.getBody();N&&(N.textRuns=[{st:0,ed:N.dataStream.length-2,ts:{cl:{rgb:this._themeService.getCurrentTheme().textColorSecondary}}}])}this._commandService.executeCommand(NF.id,{position:{startX:_,startY:C,endX:y,endY:S},scaleX:E,scaleY:w,canvasOffset:v,row:f,column:m,unitId:l,sheetId:u,documentLayoutObject:$,editorUnitId:Zr,isInArrayFormulaRange:O==null?void 0:O.isInArrayFormulaRange})}_initialEventListener(){const e=this._getSheetObject();if(e==null)return;const{spreadsheet:n,spreadsheetColumnHeader:r,spreadsheetLeftTopPlaceholder:i,spreadsheetRowHeader:o}=e;n.onDblclickObserver.add(s=>{s.button!==2&&this._commandService.executeCommand($a.id,{visible:!0,eventType:Zn.Dblclick})}),n.onPointerDownObserver.add(this._keepVisibleHideEditor.bind(this)),r.onPointerDownObserver.add(this._keepVisibleHideEditor.bind(this)),i.onPointerDownObserver.add(this._keepVisibleHideEditor.bind(this)),o.onPointerDownObserver.add(this._keepVisibleHideEditor.bind(this))}_keepVisibleHideEditor(){this._editorBridgeService.isForceKeepVisible()||this._hideEditor()}_hideEditor(){this._editorBridgeService.isVisible().visible===!0&&(this._selectionManagerService.makeDirty(!1),this._commandService.executeCommand($a.id,{visible:!1,eventType:Zn.PointerDown}),setTimeout(()=>{this._selectionManagerService.makeDirty(!0)},0))}_getSheetObject(){return jo(this._currentUniverService,this._renderManagerService)}_commandExecutedListener(){const e=NB;this.disposeWithMe(this._commandService.onCommandExecuted((n,r)=>{r!=null&&r.fromCollab||(n.id===ja.id?this._keepVisibleHideEditor():e.includes(n.id)&&this._hideEditor())}))}};C8=tNe([yt(it.Rendered,C8),V1(0,ne(kr)),V1(1,oe),V1(2,le),V1(3,kn),V1(4,Eo),V1(5,ne(ut)),V1(6,to),V1(7,ne(Ki))],C8);var nNe=Object.defineProperty,rNe=Object.getOwnPropertyDescriptor,iNe=(t,e,n,r)=>{for(var i=r>1?void 0:r?rNe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&nNe(e,n,i),i},hd=(t,e)=>(n,r)=>e(n,r,t);let y8=class extends je{constructor(e,n,r,i,o){super(),this._commandService=e,this._formatPainterService=n,this._currentUniverService=r,this._renderManagerService=i,this._selectionManagerService=o,this._initialize()}_initialize(){this._commandExecutedListener(),this._bindFormatPainterStatus()}_bindFormatPainterStatus(){this._formatPainterService.status$.subscribe(e=>{const{scene:n}=this._getSheetObject()||{};n&&(e!==Xs.OFF?n.setDefaultCursor(Yt.CELL):n.setDefaultCursor(Yt.DEFAULT))})}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===dn.id&&this._formatPainterService.getStatus()!==Xs.OFF){const{selections:n}=e.params,{range:r}=n[n.length-1];this._applyFormatPainter(r),this._formatPainterService.getStatus()===Xs.ONCE&&this._commandService.executeCommand(Ly.id)}}))}async _applyFormatPainter(e){const{styles:n,merges:r}=this._formatPainterService.getSelectionFormat(),i=this._currentUniverService.getCurrentUniverSheetInstance().getUnitId(),o=this._currentUniverService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();if(!n)return;const{startRow:s,startColumn:a,endRow:l,endColumn:u}=n.getDataRange(),c=l-s+1,d=u-a+1,h=Array.from({length:e.endRow-e.startRow+1},()=>Array.from({length:e.endColumn-e.startColumn+1},()=>({}))),f=[];h.forEach((p,g)=>{p.forEach((v,_)=>{const C=g%c+s,y=_%d+a,S=n.getValue(C,y);S&&(h[g][_].s=S)})}),r.forEach(p=>{const g={startRow:p.startRow-s,startColumn:p.startColumn-a,endRow:p.endRow-s,endColumn:p.endColumn-a},v=Math.floor((e.endRow-e.startRow+1)/c),_=Math.floor((e.endColumn-e.startColumn+1)/d);for(let C=0;C<v;C++)for(let y=0;y<_;y++)f.push({startRow:g.startRow+C*c+e.startRow,startColumn:g.startColumn+y*d+e.startColumn,endRow:g.endRow+C*c+e.startRow,endColumn:g.endColumn+y*d+e.startColumn})});const m={subUnitId:o,unitId:i,styleRange:e,styleValues:h,mergeRanges:f};await this._commandService.executeCommand(EF.id,m)}_getSheetObject(){return jo(this._currentUniverService,this._renderManagerService)}};y8=iNe([yt(it.Rendered,y8),hd(0,le),hd(1,N0),hd(2,oe),hd(3,kn),hd(4,ne(ut))],y8);const S8={id:"sheet.command.set-scroll-relative",type:se.COMMAND,handler:async(t,e={offsetX:0,offsetY:0})=>{const n=t.get(le),r=t.get(Yl),i=t.get(oe).getCurrentUniverSheetInstance(),o=i.getActiveSheet(),{xSplit:s,ySplit:a}=o.getConfig().freeze,l=r.getCurrentScroll(),{offsetX:u=0,offsetY:c=0}=e||{},{sheetViewStartRow:d=0,sheetViewStartColumn:h=0,offsetX:f=0,offsetY:m=0}=l||{};return n.executeCommand(yf.id,{unitId:i.getUnitId(),sheetId:o.getSheetId(),sheetViewStartRow:d+a,sheetViewStartColumn:h+s,offsetX:f+u,offsetY:m+c})}},Ou={id:"sheet.command.scroll-view",type:se.COMMAND,handler:async(t,e)=>{if(!e)return!1;const n=t.get(oe).getCurrentUniverSheetInstance(),r=n.getActiveSheet(),i=t.get(Yl).getCurrentScroll();if(!r)return!1;const o=t.get(le),{sheetViewStartRow:s,sheetViewStartColumn:a,offsetX:l,offsetY:u}=e,{sheetViewStartColumn:c,sheetViewStartRow:d,offsetX:h,offsetY:f}=i||{};return o.executeCommand(yf.id,{unitId:n.getUnitId(),sheetId:r.getSheetId(),sheetViewStartRow:s??c,sheetViewStartColumn:a??d,offsetX:l??h,offsetY:u??f})}};se.COMMAND;var oNe=Object.defineProperty,sNe=Object.getOwnPropertyDescriptor,aNe=(t,e,n,r)=>{for(var i=r>1?void 0:r?sNe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&oNe(e,n,i),i},j1=(t,e)=>(n,r)=>e(n,r,t);const lNe="__SpreadsheetFreezeRowMainName__",uNe="__SpreadsheetFreezeRowHeaderName__",cNe="__SpreadsheetFreezeColumnMainName__",dNe="__SpreadsheetFreezeColumnHeaderName__",Cp=4,hNe=.01;let E8=class extends je{constructor(e,n,r,i,o,s,a,l){super(),V(this,"_rowFreezeHeaderRect"),V(this,"_rowFreezeMainRect"),V(this,"_columnFreezeHeaderRect"),V(this,"_columnFreezeMainRect"),V(this,"_freezeDownObservers",[]),V(this,"_freezeMoveObservers",[]),V(this,"_freezeLeaveObservers",[]),V(this,"_moveObserver"),V(this,"_upObserver"),V(this,"_viewportObservers",[]),V(this,"_changeToRow",-1),V(this,"_changeToColumn",-1),V(this,"_changeToOffsetX",0),V(this,"_changeToOffsetY",0),V(this,"_freezeNormalHeaderColor",""),V(this,"_freezeNormalMainColor",""),V(this,"_freezeActiveColor",""),V(this,"_freezeHoverColor",""),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._selectionRenderService=o,this._selectionManagerService=s,this._scrollManagerService=a,this._themeService=l,this._initialize()}dispose(){super.dispose()}_initialize(){this._skeletonListener(),this._commandExecutedListener(),this._themeChangeListener()}_createFreeze(e=0){var n;const r=this._getFreeze();if(r==null)return;const i=(n=this._sheetSkeletonManagerService.getCurrent())==null?void 0:n.skeleton;if(i==null)return;const{startRow:o,startColumn:s}=r,a=this._getPositionByIndex(o,s);if(a==null)return;const l=this._getSheetObject();if(l==null)return;const u=l.engine,c=(u==null?void 0:u.width)||0,d=(u==null?void 0:u.height)||0,h=l.scene,{startX:f,startY:m}=a,{rowTotalHeight:p,columnTotalWidth:g,rowHeaderWidthAndMarginLeft:v,columnHeaderHeightAndMarginTop:_}=i,C=c>g+v?c:g+_,y=d>p+_?d:p+_;this._changeToRow=o,this._changeToColumn=s,this._changeToOffsetX=f,this._changeToOffsetY=m;const S=Math.max(h.scaleX,h.scaleY),E=Cp/(S<1?1:S);if(e===0){this._rowFreezeHeaderRect=new qt(uNe,{fill:this._freezeNormalHeaderColor,width:v,height:E,left:0,top:m-E,zIndex:3});let w=this._freezeNormalHeaderColor;(o===-1||o===0)&&(w=this._freezeNormalMainColor),this._rowFreezeMainRect=new qt(lNe,{fill:w,width:C*2,height:E,left:v,top:m-E,zIndex:3}),h.addObjects([this._rowFreezeHeaderRect,this._rowFreezeMainRect],Pl)}else{this._columnFreezeHeaderRect=new qt(dNe,{fill:this._freezeNormalHeaderColor,width:E,height:_,left:f-E,top:0,zIndex:3});let w=this._freezeNormalHeaderColor;(s===-1||s===0)&&(w=this._freezeNormalMainColor),this._columnFreezeMainRect=new qt(cNe,{fill:w,width:E,height:y*2,left:f-E,top:_,zIndex:3}),h.addObjects([this._columnFreezeHeaderRect,this._columnFreezeMainRect],Pl)}this._eventBinding(e)}_eventBinding(e=0){let n=this._rowFreezeHeaderRect,r=this._rowFreezeMainRect;e===1&&(n=this._columnFreezeHeaderRect,r=this._columnFreezeMainRect);const i=this._getSheetObject();if(i==null)return;const{scene:o}=i;this._freezeMoveObservers.push(n==null?void 0:n.onPointerEnterObserver.add(()=>{n==null||n.setProps({fill:this._freezeHoverColor,zIndex:4}),o.setCursor(Yt.GRAB)})),this._freezeMoveObservers.push(r==null?void 0:r.onPointerEnterObserver.add(()=>{n==null||n.setProps({fill:this._freezeHoverColor,zIndex:4}),o.setCursor(Yt.GRAB)})),this._freezeLeaveObservers.push(n==null?void 0:n.onPointerLeaveObserver.add(()=>{n==null||n.setProps({fill:this._freezeNormalHeaderColor,zIndex:3}),o.resetCursor()})),this._freezeLeaveObservers.push(r==null?void 0:r.onPointerLeaveObserver.add(()=>{n==null||n.setProps({fill:this._freezeNormalHeaderColor,zIndex:3}),o.resetCursor()})),this._freezeDownObservers.push(n==null?void 0:n.onPointerDownObserver.add(s=>{this._freezeDown(s,n,r,e)})),this._freezeDownObservers.push(r==null?void 0:r.onPointerDownObserver.add(s=>{this._freezeDown(s,n,r,e)}))}_getCurrentLastVisibleRow(){var e;const n=this._getSheetObject();if(n==null)return;const r=(e=this._sheetSkeletonManagerService.getCurrent())==null?void 0:e.skeleton;if(r==null)return;const i=n.scene,o=Math.max(i.scaleX,i.scaleY),s=this._scrollManagerService.getCurrentScroll(),a=(n.engine.height-r.columnHeaderHeight)/o,l=(s==null?void 0:s.sheetViewStartRow)??0,u=l===0?-((s==null?void 0:s.offsetY)??0):r.rowHeightAccumulation[l-1]-((s==null?void 0:s.offsetY)??0);let c=0;for(let d=l,h=r.rowHeightAccumulation.length;d<h;d++)if(r.rowHeightAccumulation[d]-u>a){c=d;break}return c}_freezeDown(e,n,r,i=0){var o;const s=(o=this._sheetSkeletonManagerService.getCurrent())==null?void 0:o.skeleton;if(s==null)return;const a=this._getSheetObject();if(a==null)return;const{scene:l}=a;l.setCursor(Yt.GRABBING),l.disableEvent();const u=this._getCurrentLastVisibleRow(),c=u===void 0?1/0:s.rowHeightAccumulation[u],d=l.getViewport(Kn.VIEW_MAIN);this._moveObserver=l.onPointerMoveObserver.add(h=>{var f,m,p,g;const{startX:v,startY:_,row:C,column:y}=Z6(h.offsetX,h.offsetY,l,s,d);l.setCursor(Yt.GRABBING);const S=Cp/Math.max(l.scaleX,l.scaleY);i===0?((f=n.transformByState({top:Math.min(_,c)-S/2}))==null||f.setProps({fill:this._freezeActiveColor}),(m=r.transformByState({top:Math.min(_,c)-S/2}))==null||m.setProps({fill:this._freezeNormalHeaderColor}),this._changeToRow=u===void 0?C:Math.min(C,u),this._changeToOffsetY=Math.min(_,c)):((p=n.transformByState({left:v-S/2}))==null||p.setProps({fill:this._freezeActiveColor}),(g=r.transformByState({left:v-S/2}))==null||g.setProps({fill:this._freezeNormalHeaderColor}),this._changeToColumn=y,this._changeToOffsetX=v)}),this._upObserver=l.onPointerUpObserver.add(()=>{var h;l.resetCursor(),l.enableEvent(),this._clearObserverEvent();const{rowHeaderWidthAndMarginLeft:f,columnHeaderHeightAndMarginTop:m}=s;i===0&&(this._changeToRow===0||this._changeToRow===-1)||i===1&&(this._changeToColumn===0||this._changeToColumn===-1)?(n.setProps({fill:this._freezeNormalHeaderColor}),r.setProps({fill:this._freezeNormalMainColor})):(n==null||n.setProps({fill:this._freezeNormalHeaderColor}),r==null||r.setProps({fill:this._freezeNormalHeaderColor}));const p=Cp/Math.max(l.scaleX,l.scaleY);i===0?(this._changeToRow===0||this._changeToRow===-1)&&(n.transformByState({top:m-p}),r.transformByState({top:m-p})):(this._changeToColumn===0||this._changeToColumn===-1)&&(n.transformByState({left:f-p}),r.transformByState({left:f-p}));const g=this._scrollManagerService.getCurrentScroll()||{sheetViewStartRow:0,sheetViewStartColumn:0},{sheetViewStartRow:v,sheetViewStartColumn:_}=g;if(_==null||v==null)return;const C=this._currentUniverService.getCurrentUniverSheetInstance(),y=C.getActiveSheet(),S=(h=y.getConfig())==null?void 0:h.freeze;let E=(S==null?void 0:S.xSplit)||0,w=(S==null?void 0:S.ySplit)||0;i===0&&(w=this._changeToRow-v,w=w<0?0:w),i===1&&(E=this._changeToColumn-_,E=E<0?0:E),this._commandService.executeCommand(mB.id,{startRow:this._changeToRow,startColumn:this._changeToColumn,ySplit:w,xSplit:E,unitId:C.getUnitId(),subUnitId:y.getSheetId()})})}_updateViewport(e=-1,n=-1,r=0,i=0){var o;const s=this._getSheetObject();if(s==null)return;const{scene:a}=s,l=(o=this._sheetSkeletonManagerService.getCurrent())==null?void 0:o.skeleton;if(l==null)return;const{rowHeaderWidthAndMarginLeft:u,columnHeaderHeightAndMarginTop:c}=l,d=a.getViewport(Kn.VIEW_COLUMN_LEFT),h=a.getViewport(Kn.VIEW_COLUMN_RIGHT),f=a.getViewport(Kn.VIEW_ROW_TOP),m=a.getViewport(Kn.VIEW_ROW_BOTTOM),p=a.getViewport(Kn.VIEW_LEFT_TOP),g=a.getViewport(Kn.VIEW_MAIN),v=a.getViewport(Kn.VIEW_MAIN_LEFT_TOP),_=a.getViewport(Kn.VIEW_MAIN_LEFT),C=a.getViewport(Kn.VIEW_MAIN_TOP);if(d==null||h==null||f==null||m==null||p==null||g==null||v==null||_==null||C==null)return;const{scaleX:y,scaleY:S}=a.getAncestorScale();this._viewportObservers.forEach(k=>{g.onScrollAfterObserver.remove(k)}),h.resize({left:u,top:0,height:c,right:0}),m.resize({left:0,top:c,bottom:0,width:u}),p.resize({left:0,top:0,width:u,height:c}),this._viewportObservers.push(g.onScrollAfterObserver.add(k=>{const{scrollX:O,scrollY:$,actualScrollX:N,actualScrollY:H}=k;h.updateScroll({scrollX:O,actualScrollX:N}).makeDirty(!0),m.updateScroll({scrollY:$,actualScrollY:H}).makeDirty(!0)}));let E=!0,w=!0;v.enable(),(e===-1||e===0)&&(E=!1),(n===-1||n===0)&&(w=!1);const R=l.getNoMergeCellPositionByIndexWithNoHeader(e-r,n-i,y,S),D=l.getNoMergeCellPositionByIndexWithNoHeader(e,n,y,S);v.disable(),C.disable(),_.disable(),f.disable(),d.disable(),v.resetPadding(),C.resetPadding(),_.resetPadding(),f.resetPadding(),d.resetPadding();const I=this._scrollManagerService.getCurrentScroll();if(E===!1&&w===!1)g.resize({left:u,top:c,bottom:0,right:0}),g.resetPadding(),this._commandService.executeCommand(Ou.id,I??{sheetViewStartRow:0,sheetViewStartColumn:0,offsetX:0,offsetY:0});else if(E===!0&&w===!1){const k=D.startY-R.startY;g.resize({left:u,top:c+k,bottom:0,right:0}),g.setPadding({startY:R.startY,endY:D.startY,startX:0,endX:0}),this._commandService.executeCommand(Ou.id,I??{sheetViewStartRow:0,offsetY:0}),C.resize({left:u,top:c,height:k,right:0}),C.updateScroll({actualScrollY:R.startY,x:g.scrollX,actualScrollX:g.actualScrollX}).makeDirty(!0),f.resize({left:0,top:c,width:u,height:k}),f.updateScroll({actualScrollY:R.startY}).makeDirty(!0),m.resize({left:0,top:c+k,bottom:0,width:u}),this._viewportObservers.push(g.onScrollAfterObserver.add(O=>{const{scrollX:$,actualScrollX:N}=O;C.updateScroll({scrollX:$,actualScrollX:N}).makeDirty(!0)})),C.enable(),f.enable()}else if(E===!1&&w===!0){const k=D.startX-R.startX;g.resize({left:u+k,top:c,bottom:0,right:0}),g.setPadding({startX:R.startX,endX:D.startX,startY:0,endY:0}),this._commandService.executeCommand(Ou.id,I??{sheetViewStartColumn:0,offsetX:0}),_.resize({left:u,top:c,width:k,bottom:0,right:0}),_.updateScroll({actualScrollX:R.startX,y:g.scrollY,actualScrollY:g.actualScrollY}).makeDirty(!0),d.resize({left:u,top:0,width:k,height:c}),d.updateScroll({actualScrollX:R.startX}).makeDirty(!0),h.resize({left:u+k,top:0,height:c,right:0}),this._viewportObservers.push(g.onScrollAfterObserver.add(O=>{const{scrollY:$,actualScrollY:N}=O;_.updateScroll({scrollY:$,actualScrollY:N}).makeDirty(!0)})),_.enable(),d.enable()}else{const k=D.startX-R.startX,O=D.startY-R.startY;g.resize({left:u+k,top:c+O,bottom:0,right:0}),g.setPadding({startY:R.startY,endY:D.startY,startX:R.startX,endX:D.startX}),this._commandService.executeCommand(Ou.id,{sheetViewStartRow:0,sheetViewStartColumn:0,offsetX:0,offsetY:0}),_.resize({left:u,top:c+O,width:k,bottom:0}),_.updateScroll({actualScrollX:R.startX,y:g.scrollY,actualScrollY:g.actualScrollY}).makeDirty(!0),C.resize({left:u+k,top:c,height:O,right:0}),C.updateScroll({actualScrollY:R.startY,x:g.scrollX,actualScrollX:g.actualScrollX}).makeDirty(!0),v.resize({left:u,top:c,width:k,height:O}),v.updateScroll({actualScrollX:R.startX,actualScrollY:R.startY}).makeDirty(!0),f.resize({left:0,top:c,width:u,height:O}),f.updateScroll({actualScrollY:R.startY}).makeDirty(!0),m.resize({left:0,top:c+O,bottom:0,width:u}),d.resize({left:u,top:0,width:k,height:c}),d.updateScroll({actualScrollX:R.startX}).makeDirty(!0),h.resize({left:u+k,top:0,height:c,right:0}),this._viewportObservers.forEach($=>{g.onScrollAfterObserver.remove($)}),this._viewportObservers.push(g.onScrollAfterObserver.add($=>{const{scrollX:N,scrollY:H,actualScrollX:X,actualScrollY:te}=$;m.updateScroll({scrollY:H,actualScrollY:te}).makeDirty(!0),h.updateScroll({scrollX:N,actualScrollX:X}).makeDirty(!0),_.updateScroll({scrollY:H,actualScrollY:te}).makeDirty(!0),C.updateScroll({scrollX:N,actualScrollX:X}).makeDirty(!0)})),v.enable(),C.enable(),_.enable(),f.enable(),d.enable()}}_skeletonListener(){this.disposeWithMe(Be(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{[ja.id].includes((e==null?void 0:e.commandId)||"")&&this._refreshCurrent()})))}_refreshCurrent(){const e=this._currentUniverService.getCurrentUniverSheetInstance().getActiveSheet().getConfig().freeze,{startRow:n=-1,startColumn:r=-1,ySplit:i=0,xSplit:o=0}=e;this._refreshFreeze(n,r,i,o)}_themeChangeListener(){this._themeChange(this._themeService.getCurrentTheme()),this.disposeWithMe(Be(this._themeService.currentTheme$.subscribe(e=>{this._clearFreeze(),this._themeChange(e),this._refreshCurrent()})))}_themeChange(e){this._freezeNormalHeaderColor=e.grey400,this._freezeNormalMainColor=new _o(e.grey400).setAlpha(hNe).toRgbString(),this._freezeActiveColor=e.primaryColor,this._freezeHoverColor=e.grey500}_commandExecutedListener(){const e=[vo.id,Gl.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(e.includes(n.id)){const r=this._currentUniverService.getCurrentUniverSheetInstance(),i=r.getActiveSheet(),o=n.params,{unitId:s,subUnitId:a}=o;if(!(s===r.getUnitId()&&a===i.getSheetId())||i.getConfig().freeze==null)return;const{startRow:l=-1,startColumn:u=-1,ySplit:c=0,xSplit:d=0}=i.getConfig().freeze;this._refreshFreeze(l,u,c,d)}else if(n.id===wy.id){const r=this._getFreeze();n.params&&r&&n.params.anchorRow<r.startRow&&this._refreshCurrent()}else if(n.id===vf.id){const r=this._getFreeze();n.params&&r&&n.params.anchorCol<r.startColumn&&this._refreshCurrent()}else if(n.id===G6.id){const r=n.params,i=this._getFreeze();if(i&&i.startRow>-1&&r.rowsAutoHeightInfo.some(o=>o.row<i.startRow)){const o=this._sheetSkeletonManagerService.currentSkeleton$.subscribe(()=>{this._refreshCurrent(),setTimeout(()=>{o.unsubscribe()})})}}}))}_clearObserverEvent(){const e=this._getSheetObject();if(e==null)return;const{scene:n}=e;n.onPointerMoveObserver.remove(this._moveObserver),n.onPointerUpObserver.remove(this._upObserver),this._moveObserver=null,this._upObserver=null}_clearFreeze(){var e,n,r,i;(e=this._rowFreezeHeaderRect)==null||e.dispose(),(n=this._rowFreezeMainRect)==null||n.dispose(),(r=this._columnFreezeHeaderRect)==null||r.dispose(),(i=this._columnFreezeMainRect)==null||i.dispose();const o=this._getSheetObject();if(o==null)return;const{scene:s}=o;[...this._freezeDownObservers,...this._freezeMoveObservers,...this._freezeLeaveObservers].forEach(a=>{s.onPointerDownObserver.remove(a),s.onPointerMoveObserver.remove(a),s.onPointerLeaveObserver.remove(a)}),s.onPointerEnterObserver.remove(this._moveObserver),s.onPointerMoveObserver.remove(this._upObserver)}_getPositionByIndex(e,n){var r;const i=this._getSheetObject();if(i==null)return;const{scaleX:o,scaleY:s}=i.scene.getAncestorScale(),a=(r=this._sheetSkeletonManagerService.getCurrent())==null?void 0:r.skeleton,l=a==null?void 0:a.getNoMergeCellPositionByIndex(e,n,o,s);if(a==null)return;if(l!=null&&(!isNaN(l.endX)||!isNaN(l.endY)))return l;const{rowHeaderWidthAndMarginLeft:u,columnHeaderHeightAndMarginTop:c}=a;return{startX:u,endX:u,startY:c,endY:c}}_getFreeze(){var e;const n=(e=this._sheetSkeletonManagerService.getCurrent())==null?void 0:e.skeleton.getWorksheetConfig();if(n!=null)return n.freeze}_getSheetObject(){return jo(this._currentUniverService,this._renderManagerService)}_refreshFreeze(e,n,r,i){var o;this._clearFreeze(),this._createFreeze(0),this._createFreeze(1),this._updateViewport(e,n,r,i),(o=this._getSheetObject())==null||o.spreadsheet.makeForceDirty()}};E8=aNe([yt(it.Rendered,E8),j1(0,ne(kr)),j1(1,oe),j1(2,le),j1(3,kn),j1(4,to),j1(5,ne(ut)),j1(6,ne(Yl)),j1(7,ne(Ki))],E8);var T_=(t=>(t[t.NORMAL=0]="NORMAL",t[t.HIGHLIGHT=1]="HIGHLIGHT",t))(T_||{});const fNe="rgba(0, 0, 0, 0.15)",Ja="rgb(0, 0, 0)",J7="rgb(255, 255, 255, 1)";class mNe extends g4{constructor(e,n){super(e,n),V(this,"_size",12),V(this,"_iconRatio",.4),V(this,"_mode",0),this.setShapeProps(n)}setShapeProps(e){e!=null&&e.size&&(this._size=e.size),e!=null&&e.mode&&(this._mode=e.mode),this.transformByState({width:this._size,height:this._size})}_draw(e){this._mode===1&&qt.drawWith(e,{width:this._size,height:this._size,radius:this._size,fill:fNe});const n=this._size*.5*this._iconRatio,r=Math.PI/180*60,i=n*Math.sin(r),o=n*Math.cos(r);v2.drawWith(e,{pointsGroup:[[{x:-i+this._size/2,y:-o+this._size/2},{x:i+this._size/2,y:-o+this._size/2},{x:this._size/2,y:n+this._size/2}]],fill:Ja})}}var pNe=Object.defineProperty,gNe=Object.getOwnPropertyDescriptor,vNe=(t,e,n,r)=>{for(var i=r>1?void 0:r?gNe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&pNe(e,n,i),i},fd=(t,e)=>(n,r)=>e(n,r,t);const _Ne="__SpreadsheetHeaderMenuSHAPEControllerShape__",bNe="__SpreadsheetHeaderMenuMAINControllerShape__",CNe="rgba(0, 0, 0, 0.1)";let w8=class extends je{constructor(e,n,r,i,o){super(),V(this,"_hoverRect"),V(this,"_hoverMenu"),V(this,"_currentColumn",1/0),V(this,"_observers",[]),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._renderManagerService=r,this._contextMenuService=i,this._selectionManagerService=o,this._initialize()}dispose(){var e,n;(e=this._hoverRect)==null||e.dispose(),(n=this._hoverMenu)==null||n.dispose();const r=this._getSheetObject();if(r==null)return;const{spreadsheetRowHeader:i,spreadsheetColumnHeader:o}=r;this._observers.forEach(s=>{i.onPointerEnterObserver.remove(s),i.onPointerMoveObserver.remove(s),i.onPointerLeaveObserver.remove(s),o.onPointerEnterObserver.remove(s),o.onPointerMoveObserver.remove(s),o.onPointerLeaveObserver.remove(s)})}_initialize(){const e=this._getSheetObject();if(e==null)return;const{scene:n}=e;this._hoverRect=new qt(_Ne,{fill:CNe,evented:!1}),this._hoverMenu=new mNe(bNe,{zIndex:100,visible:!1}),n.addObjects([this._hoverRect,this._hoverMenu],Pl),this._initialHover(0),this._initialHover(1),this._initialHoverMenu()}_initialHover(e=0){const n=this._getSheetObject();if(n==null)return;const{spreadsheetColumnHeader:r,spreadsheetRowHeader:i}=n,o=e===0?i:r;this._observers.push(o==null?void 0:o.onPointerEnterObserver.add(()=>{var s;(s=this._hoverRect)==null||s.show()})),this._observers.push(o==null?void 0:o.onPointerMoveObserver.add(s=>{var a,l,u;const c=(a=this._sheetSkeletonManagerService.getCurrent())==null?void 0:a.skeleton;if(c==null)return;const d=this._getSheetObject();if(d==null)return;const{rowHeaderWidth:h,columnHeaderHeight:f}=c,{startX:m,startY:p,endX:g,endY:v,column:_}=Z6(s.offsetX,s.offsetY,d.scene,c);if(e===0)(l=this._hoverRect)==null||l.transformByState({width:h,height:v-p,left:0,top:p});else{if(this._currentColumn=_,(u=this._hoverRect)==null||u.transformByState({width:g-m,height:f,left:m,top:0}),this._hoverMenu==null)return;if(g-m<f*2){this._hoverMenu.hide();return}const C=f*.8;this._hoverMenu.transformByState({left:g-f,top:f/2-C/2}),this._hoverMenu.setShapeProps({size:C}),this._hoverMenu.show()}})),this._observers.push(o==null?void 0:o.onPointerLeaveObserver.add(()=>{var s,a;(s=this._hoverRect)==null||s.hide(),(a=this._hoverMenu)==null||a.hide()}))}_initialHoverMenu(){this._hoverMenu!=null&&(this._hoverMenu.onPointerEnterObserver.add(()=>{if(this._hoverMenu==null)return;const e=this._getSheetObject();e!=null&&(this._hoverMenu.setProps({mode:T_.HIGHLIGHT,visible:!0}),e.scene.setCursor(Yt.POINTER))}),this._hoverMenu.onPointerLeaveObserver.add(()=>{if(this._hoverMenu==null)return;const e=this._getSheetObject();e!=null&&(this._hoverMenu.setProps({mode:T_.NORMAL,visible:!1}),e.scene.resetCursor())}),this._hoverMenu.onPointerDownObserver.add(e=>{const n=this._getSheetObject();if(n==null)return;const r=this._currentColumn,i=this._selectionManagerService.getSelectionRanges();(i==null?void 0:i.find(o=>{const{startColumn:s,endColumn:a}=o;return r>=s&&s<=a}))==null?n.spreadsheetColumnHeader.onPointerDownObserver.notifyObservers(e):(e.stopPropagation(),e.preventDefault(),this._contextMenuService.triggerContextMenu(e,si.COL_HEADER_CONTEXT_MENU))}))}_getSheetObject(){return jo(this._currentUniverService,this._renderManagerService)}};w8=vNe([yt(it.Rendered,w8),fd(0,ne(kr)),fd(1,oe),fd(2,kn),fd(3,tf),fd(4,ne(ut))],w8);var yNe=Object.defineProperty,SNe=Object.getOwnPropertyDescriptor,ENe=(t,e,n,r)=>{for(var i=r>1?void 0:r?SNe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&yNe(e,n,i),i},Hc=(t,e)=>(n,r)=>e(n,r,t);const wNe="__SpreadsheetHeaderMoveControllerBackground__",RNe="__SpreadsheetHeaderMoveControllerShapeLine__",DNe="rgba(0, 0, 0, 0.1)",INe="rgb(119, 119, 119)",xNe=4;let R8=class extends je{constructor(e,n,r,i,o,s){super(),V(this,"_startOffsetX",-1/0),V(this,"_startOffsetY",-1/0),V(this,"_moveHelperBackgroundShape"),V(this,"_moveHelperLineShape"),V(this,"_sheetObject"),V(this,"_rowOrColumnDownObservers",[]),V(this,"_rowOrColumnMoveObservers",[]),V(this,"_rowOrColumnLeaveObservers",[]),V(this,"_moveObserver"),V(this,"_upObserver"),V(this,"_scrollTimer"),V(this,"_changeFromColumn",-1),V(this,"_changeFromRow",-1),V(this,"_changeToColumn",-1),V(this,"_changeToRow",-1),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._renderManagerService=r,this._commandService=i,this._selectionRenderService=o,this._selectionManagerService=s,this._initialize()}dispose(){var e,n;(e=this._moveHelperBackgroundShape)==null||e.dispose(),(n=this._moveHelperLineShape)==null||n.dispose();const r=this._getSheetObject();if(r==null)return;const{spreadsheetRowHeader:i,spreadsheetColumnHeader:o,scene:s}=r;[...this._rowOrColumnDownObservers,...this._rowOrColumnMoveObservers,...this._rowOrColumnLeaveObservers].forEach(a=>{i.onPointerDownObserver.remove(a),o.onPointerDownObserver.remove(a)}),s.onPointerMoveObserver.remove(this._moveObserver),s.onPointerUpObserver.remove(this._upObserver),this._scrollTimer.dispose()}_initialize(){const e=this._getSheetObject();e!=null&&(this._sheetObject=e,this._initialRowOrColumn(0),this._initialRowOrColumn(1))}_initialRowOrColumn(e=0){const{spreadsheetColumnHeader:n,spreadsheetRowHeader:r,scene:i}=this._sheetObject,o=e===0?r:n;this._rowOrColumnMoveObservers.push(o==null?void 0:o.onPointerMoveObserver.add(s=>{var a;const l=(a=this._sheetSkeletonManagerService.getCurrent())==null?void 0:a.skeleton;if(l==null)return;const{row:u,column:c}=Z6(s.offsetX,s.offsetY,i,l);if(this._checkInHeaderRange(e===0?u:c,e)===!1){i.resetCursor(),this._selectionRenderService.enableSelection();return}i.setCursor(Yt.GRAB),this._selectionRenderService.disableSelection()})),this._rowOrColumnLeaveObservers.push(o==null?void 0:o.onPointerLeaveObserver.add(()=>{var s,a;(s=this._moveHelperBackgroundShape)==null||s.hide(),(a=this._moveHelperLineShape)==null||a.hide(),i.resetCursor(),this._selectionRenderService.enableSelection()})),this._rowOrColumnDownObservers.push(o==null?void 0:o.onPointerDownObserver.add(s=>{var a;const l=(a=this._sheetSkeletonManagerService.getCurrent())==null?void 0:a.skeleton;if(l==null)return;const{offsetX:u,offsetY:c}=s,d=i.getRelativeCoord(Ft.FromArray([u,c])),{x:h,y:f}=d;this._startOffsetX=h,this._startOffsetY=f;const{row:m,column:p}=Z6(s.offsetX,s.offsetY,i,l);e===0?this._changeFromRow=m:this._changeFromColumn=p;const g=this._checkInHeaderRange(e===0?m:p,e);if(g===!1)return;this._newBackgroundAndLine(),i.setCursor(Yt.GRABBING),i.disableEvent();const v=yl.create(i),_=i.getViewport(Kn.VIEW_MAIN);v.startScroll(h,f,_),this._scrollTimer=v,this._moveObserver=i.onPointerMoveObserver.add(C=>{const{offsetX:y,offsetY:S}=C,{x:E,y:w}=i.getRelativeCoord(Ft.FromArray([y,S]));i.setCursor(Yt.GRABBING),this._columnMoving(E,w,g,e),v.scrolling(E,w,()=>{this._columnMoving(E,w,g,e)})}),this._upObserver=i.onPointerUpObserver.add(()=>{var C;this._disposeBackgroundAndLine(),i.resetCursor(),i.enableEvent(),this._clearObserverEvent(),(C=this._scrollTimer)==null||C.dispose(),e===0?(this._changeFromRow!==this._changeToRow&&this._changeToRow!==-1&&this._commandService.executeCommand(B4.id,{fromRow:this._changeFromRow,toRow:this._changeToRow}),this._changeToRow=this._changeFromRow=-1):(this._changeFromColumn!==this._changeToColumn&&this._changeToColumn!==-1&&this._commandService.executeCommand(F4.id,{fromCol:this._changeFromColumn,toCol:this._changeToColumn}),this._changeToColumn=this._changeFromColumn=-1)})}))}_columnMoving(e,n,r,i){var o,s,a,l,u,c,d;const{scene:h}=this._sheetObject,f=(o=this._sheetSkeletonManagerService.getCurrent())==null?void 0:o.skeleton;if(f==null)return;const{rowHeaderWidth:m,columnHeaderHeight:p,rowTotalHeight:g,columnTotalWidth:v}=f,_=h.getScrollXYByRelativeCoords(Ft.FromArray([this._startOffsetX,this._startOffsetY])),{scaleX:C,scaleY:y}=h.getAncestorScale(),S=f.getCellPositionByOffset(e,n,C,y,_),{row:E,column:w}=S,R=f.getNoMergeCellPositionByIndex(E,w,C,y),{startX:D,startY:I,endX:k,endY:O}=R,$=this._selectionRenderService.convertRangeDataToSelection(r.range);if($==null)return;const N=Math.max(C,C),{startX:H,endX:X,startY:te,endY:z,startRow:A,startColumn:T,endRow:P,endColumn:K}=$;i===0?(s=this._moveHelperBackgroundShape)==null||s.transformByState({height:z-te,width:v+m,left:0,top:te+(n-this._startOffsetY)/N}):(a=this._moveHelperBackgroundShape)==null||a.transformByState({height:g+p,width:X-H,left:H+(e-this._startOffsetX)/N,top:0}),(l=this._moveHelperBackgroundShape)==null||l.show();const ee=xNe/N;if(i===0){let ue=0;if(E<=A)ue=I-ee/2,this._changeToRow=E;else if(E>P)ue=O-ee/2,this._changeToRow=E+1;else return;(u=this._moveHelperLineShape)==null||u.transformByState({height:ee,width:v,left:m,top:ue})}else{let ue=0;if(w<=T)ue=D-ee/2,this._changeToColumn=w;else if(w>K)ue=k-ee/2,this._changeToColumn=w+1;else return;(c=this._moveHelperLineShape)==null||c.transformByState({height:g,width:ee,left:ue,top:p})}(d=this._moveHelperLineShape)==null||d.show()}_checkInHeaderRange(e,n=0){const r=this._selectionManagerService.getSelections(),i=r==null?void 0:r.find(s=>{const a=s.range,{startRow:l,endRow:u,startColumn:c,endColumn:d}=a;return n===1?e>=c&&e<=d:e>=l&&e<=u}),o=i==null?void 0:i.range;return i==null||o==null||o.rangeType===Rt.ALL||o.rangeType===Rt.NORMAL||o.rangeType===Rt.ROW&&n!==0||o.rangeType===Rt.COLUMN&&n!==1?!1:i}_clearObserverEvent(){const{scene:e}=this._sheetObject;e.onPointerMoveObserver.remove(this._moveObserver),e.onPointerUpObserver.remove(this._upObserver),this._moveObserver=null,this._upObserver=null}_newBackgroundAndLine(){const{scene:e}=this._sheetObject;this._moveHelperBackgroundShape=new qt(wNe,{fill:DNe,evented:!1,zIndex:100}),this._moveHelperLineShape=new qt(RNe,{fill:INe,evented:!1,zIndex:100}),e.addObjects([this._moveHelperBackgroundShape,this._moveHelperLineShape],Pl)}_disposeBackgroundAndLine(){var e,n;(e=this._moveHelperBackgroundShape)==null||e.dispose(),(n=this._moveHelperLineShape)==null||n.dispose()}_getSheetObject(){return jo(this._currentUniverService,this._renderManagerService)}};R8=ENe([yt(it.Rendered,R8),Hc(0,ne(kr)),Hc(1,oe),Hc(2,kn),Hc(3,le),Hc(4,to),Hc(5,ne(ut))],R8);var $_=(t=>(t[t.VERTICAL=0]="VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL",t))($_||{});const MNe="rgba(120, 120, 120, 0.01)",yp="rgb(68, 71, 70)",kd=12,k_=4;let pI=class extends g4{constructor(e,n){super(e,n),V(this,"_size",kd),V(this,"_color",yp),V(this,"_mode",0),this.setShapeProps(n)}get size(){return this._size}get mode(){return this._mode}get color(){return this._color}_draw(e){let{width:n,height:r}=this,i=0,o=0;const s=this.getScene(),{scaleX:a,scaleY:l}=s.getAncestorScale(),u=Math.max(a,l),c=kd/u,d=k_/u;this.mode===0?(n=d,i=c-d):(r=d,o=c-d),qt.drawWith(e,{width:this.width,height:this.height,left:0,top:0,fill:MNe}),qt.drawWith(e,{width:n,height:r,fill:yp,radius:d}),e.save(),e.transform(1,0,0,1,i,o),qt.drawWith(e,{width:n,height:r,fill:yp,radius:d}),e.restore()}setShapeProps(e){return e!=null&&e.size&&(this._size=e.size),e!=null&&e.mode&&(this._mode=e.mode),e!=null&&e.color&&(this._color=e.color),this.mode===0?this.transformByState({width:kd,height:this.size}):this.transformByState({width:this.size,height:kd}),this}};var ONe=Object.defineProperty,TNe=Object.getOwnPropertyDescriptor,$Ne=(t,e,n,r)=>{for(var i=r>1?void 0:r?TNe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&ONe(e,n,i),i},md=(t,e)=>(n,r)=>e(n,r,t);const kNe="__SpreadsheetHeaderResizeControllerShapeRow__",ANe="__SpreadsheetHeaderResizeControllerShapeColumn__",gI="__SpreadsheetHeaderResizeControllerShapeHelper__",vI="rgb(199, 199, 199)",NNe=2;let D8=class extends je{constructor(e,n,r,i,o){super(),V(this,"_currentRow",0),V(this,"_currentColumn",0),V(this,"_rowResizeRect"),V(this,"_columnResizeRect"),V(this,"_observers",[]),V(this,"_moveObserver"),V(this,"_upObserver"),V(this,"_resizeHelperShape"),V(this,"_startOffsetX",1/0),V(this,"_startOffsetY",1/0),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._editorBridgeService=o,this._initialize()}dispose(){var e,n;(e=this._rowResizeRect)==null||e.dispose(),this._rowResizeRect=null,(n=this._columnResizeRect)==null||n.dispose(),this._columnResizeRect=null;const r=this._getSheetObject();if(r==null)throw new Error("sheetObject is null");const{spreadsheetRowHeader:i,spreadsheetColumnHeader:o}=r;this._observers.forEach(s=>{i.onPointerMoveObserver.remove(s),i.onPointerLeaveObserver.remove(s),o.onPointerMoveObserver.remove(s),o.onPointerLeaveObserver.remove(s)}),this._observers=[]}_initialize(){const e=this._getSheetObject();if(e==null)return;const{scene:n}=e;this._rowResizeRect=new pI(kNe,{visible:!1,mode:$_.HORIZONTAL,zIndex:100}),this._columnResizeRect=new pI(ANe,{visible:!1,mode:$_.VERTICAL,zIndex:100}),n.addObjects([this._rowResizeRect,this._columnResizeRect],Pl),this._initialHover(0),this._initialHover(1),this._initialHoverResize(0),this._initialHoverResize(1)}_initialHover(e=0){const n=this._getSheetObject();if(n==null)return;const{spreadsheetRowHeader:r,spreadsheetColumnHeader:i,scene:o}=n,s=e===0?r:i;this._observers.push(s==null?void 0:s.onPointerMoveObserver.add((a,l)=>{var u;const c=(u=this._sheetSkeletonManagerService.getCurrent())==null?void 0:u.skeleton;if(c==null||this._rowResizeRect==null||this._columnResizeRect==null)return;const{rowHeaderWidth:d,columnHeaderHeight:h}=c,{startX:f,startY:m,endX:p,endY:g,row:v,column:_}=Z6(a.offsetX,a.offsetY,o,c),C=_p(a.offsetX,a.offsetY,o),{scaleX:y,scaleY:S}=o.getAncestorScale(),E=Math.max(y,S),w=kd/E;if(e===0){let R=m-w/2;if(C.y<=m+w/2&&C.y>=m)this._currentRow=v-1;else if(C.y>=g-w/2&&C.y<=g)this._currentRow=v,R=g-w/2;else{this._rowResizeRect.hide();return}if(this._currentRow===-1)return;const D=d/3;this._rowResizeRect.transformByState({left:d/2-D/2,top:R}),this._rowResizeRect.setShapeProps({size:D}),this._rowResizeRect.show()}else{let R=f-w/2;if(C.x<=f+w/2&&C.x>=f)this._currentColumn=_-1;else if(C.x>=p-w/2&&C.x<=p)this._currentColumn=_,R=p-w/2;else{this._columnResizeRect.hide();return}if(this._currentColumn===-1)return;const D=h*.7;this._columnResizeRect.transformByState({left:R,top:h/2-D/2}),this._columnResizeRect.setShapeProps({size:D}),this._columnResizeRect.show()}})),this._observers.push(s==null?void 0:s.onPointerLeaveObserver.add((a,l)=>{var u,c;(u=this._rowResizeRect)==null||u.hide(),(c=this._columnResizeRect)==null||c.hide()}))}_initialHoverResize(e=0){const n=this._getSheetObject();if(n==null)return;const{scene:r}=n,i=e===0?this._rowResizeRect:this._columnResizeRect;if(i==null)return;const o=r.getEngine(),s=(o==null?void 0:o.width)||0,a=(o==null?void 0:o.height)||0;this.disposeWithMe(Be(i.onPointerEnterObserver.add(()=>{i!=null&&(i.show(),r.setCursor(e===0?Yt.ROW_RESIZE:Yt.COLUMN_RESIZE))}))),this.disposeWithMe(Be(i.onPointerLeaveObserver.add(()=>{i!=null&&(i.hide(),r.resetCursor())}))),this.disposeWithMe(Be(i.onPointerDownObserver.add((l,u)=>{var c,d,h,f,m,p,g;const v=(c=this._sheetSkeletonManagerService.getCurrent())==null?void 0:c.skeleton;if(v==null)return;const _=this._getSheetObject();if(_==null)return;const{scene:C}=_,y=C.getViewport(Kn.VIEW_MAIN),S=(((h=(d=y==null?void 0:y.getScrollBar())==null?void 0:d.horizonBarRect)==null?void 0:h.height)||0)+10,E=(((m=(f=y==null?void 0:y.getScrollBar())==null?void 0:f.verticalBarRect)==null?void 0:m.width)||0)+10,w=_p(l.offsetX,l.offsetY,C),{scaleX:R,scaleY:D}=C.getAncestorScale();this._startOffsetX=w.x,this._startOffsetY=w.y;const I=v.getOffsetByPositionX(this._currentColumn),k=v.getOffsetByPositionY(this._currentRow),O=v.getNoMergeCellPositionByIndex(this._currentRow,this._currentColumn,R,D);let $=!1,N=0,H=0;const{columnTotalWidth:X,rowHeaderWidth:te,rowTotalHeight:z,columnHeaderHeight:A}=v,T=s>X+te?s:X+te,P=a>z+A?a:z+A,K=Math.max(R,D),ee=k_/K;e===0?this._resizeHelperShape=new qt(gI,{width:T,height:ee,fill:vI,left:0,top:k-ee/2}):this._resizeHelperShape=new qt(gI,{width:ee,height:P,fill:vI,left:I-ee/2,top:0});const ue=((p=this._columnResizeRect)==null?void 0:p.left)||0,fe=((g=this._rowResizeRect)==null?void 0:g.top)||0;C.addObject(this._resizeHelperShape,Pl),C.disableEvent(),this._editorBridgeService.changeVisible({visible:!1,eventType:Zn.PointerDown}),this._moveObserver=C.onPointerMoveObserver.add(Ee=>{var Q,re,Se,_e,He,Ne;const we=C.getRelativeCoord(Ft.FromArray([this._startOffsetX,this._startOffsetY])),Me=C.getScrollXYByRelativeCoords(we,y),mt=_p(Ee.offsetX,Ee.offsetY,C),{x:vt,y:ft}=mt,{scaleX:et,scaleY:ve}=C.getAncestorScale(),Pe=Math.max(et,ve),Ye=k_/Pe;N=vt-this._startOffsetX-Ye/2,H=ft-this._startOffsetY-Ye/2,Math.abs(e===0?H:N)>=NNe&&($=!0),e===0?(H<-(O.endY-O.startY)+2&&(H=-(O.endY-O.startY)+2),H>a-S+Me.y-O.startY&&(H=a-S+Me.y-O.startY),$&&((Q=this._resizeHelperShape)==null||Q.transformByState({top:k+H}),(re=this._rowResizeRect)==null||re.transformByState({top:fe+H+Ye/2}),(Se=this._rowResizeRect)==null||Se.show(),C.setCursor(Yt.ROW_RESIZE))):(N<-(O.endX-O.startX)+2&&(N=-(O.endX-O.startX)+2),N>s-E+Me.x-O.startX&&(N=s-E+Me.x-O.startX),$&&((_e=this._resizeHelperShape)==null||_e.transformByState({left:I+N}),(He=this._columnResizeRect)==null||He.transformByState({left:ue+N+Ye/2}),(Ne=this._columnResizeRect)==null||Ne.show(),C.setCursor(Yt.COLUMN_RESIZE)))}),this._upObserver=C.onPointerUpObserver.add(Ee=>{var Q,re,Se;const _e=jo(this._currentUniverService,this._renderManagerService);if(_e==null)return;this._clearObserverEvent(),(Q=this._resizeHelperShape)==null||Q.dispose(),this._resizeHelperShape=null;const{scene:He}=_e;He.enableEvent(),$&&(He.resetCursor(),(re=this._rowResizeRect)==null||re.hide(),(Se=this._columnResizeRect)==null||Se.hide(),e===0?this._commandService.executeCommand(wy.id,{deltaY:H,anchorRow:this._currentRow}):this._commandService.executeCommand(vf.id,{deltaX:N,anchorCol:this._currentColumn}))})}))),this.disposeWithMe(Be(i.onDblclickObserver.add(()=>{var l;if(e===0){const u=this._getSheetObject();if(u==null)return;const{scene:c}=u;c.resetCursor(),this._commandService.executeCommand(U4.id,{anchorRow:this._currentRow}),(l=this._rowResizeRect)==null||l.hide()}})))}_clearObserverEvent(){const e=this._getSheetObject();if(e==null)return;const{scene:n}=e;n.onPointerMoveObserver.remove(this._moveObserver),n.onPointerUpObserver.remove(this._upObserver),this._moveObserver=null,this._upObserver=null}_getSheetObject(){return jo(this._currentUniverService,this._renderManagerService)}};D8=$Ne([yt(it.Rendered,D8),md(0,ne(kr)),md(1,oe),md(2,le),md(3,kn),md(4,Eo)],D8);var A_=(t=>(t[t.ROW=0]="ROW",t[t.COLUMN=1]="COLUMN",t))(A_||{});const Ad=12,LNe=.4;let _I=class extends g4{constructor(e,n,r){super(e,n),V(this,"_size",Ad),V(this,"_iconRatio",LNe),V(this,"_hovered",!0),V(this,"_hasPrevious",!0),V(this,"_hasNext",!0),V(this,"_unhideType"),n&&this.setShapeProps(n),this.onPointerEnterObserver.add(()=>this.setShapeProps({hovered:!0})),this.onPointerLeaveObserver.add(()=>this.setShapeProps({hovered:!1})),this.onPointerDownObserver.add(()=>r==null?void 0:r())}setShapeProps(e){e.type!==void 0&&(this._unhideType=e.type),e.hovered!==void 0&&(this._hovered=e.hovered),e.hasPrevious!==void 0&&(this._hasPrevious=e.hasPrevious),e.hasNext!==void 0&&(this._hasNext=e.hasNext),this.transformByState({width:this._size*(this._unhideType===1?2:1),height:this._size*(this._unhideType===0?2:1)})}_draw(e){this._unhideType===0?this._drawOnRow(e):this._drawOnCol(e)}_drawOnRow(e){this._hovered&&(!this._hasNext||!this._hasPrevious?qt.drawWith(e,{width:this._size,height:this._size,stroke:Ja,fill:J7}):qt.drawWith(e,{width:this._size,height:2*this._size,stroke:Ja,fill:J7}));const n=this._size*.5*this._iconRatio,r=Math.PI/3,i=n*Math.cos(r),o=n*Math.sin(r);if(this._hasPrevious&&v2.drawWith(e,{pointsGroup:[[{x:this._size/2,y:this._size/2-o},{x:this._size/2-o,y:this._size/2+i},{x:this._size/2+o,y:this._size/2+i}]],fill:Ja}),this._hasNext){const s=this._hasPrevious?3:1;v2.drawWith(e,{pointsGroup:[[{x:this._size/2,y:this._size*s/2+o},{x:this._size/2-o,y:this._size*s/2-i},{x:this._size/2+o,y:this._size*s/2-i}]],fill:Ja})}}_drawOnCol(e){this._hovered&&(!this._hasNext||!this._hasPrevious?qt.drawWith(e,{width:this._size,height:this._size,stroke:Ja,fill:J7}):qt.drawWith(e,{width:2*this._size,height:this._size,stroke:Ja,fill:J7}));const n=this._size*.5*this._iconRatio,r=Math.PI/3,i=n*Math.cos(r),o=n*Math.sin(r);if(this._hasPrevious&&v2.drawWith(e,{pointsGroup:[[{x:-i+this._size/2,y:this._size/2},{x:this._size/2+o,y:this._size/2-o},{x:this._size/2+o,y:this._size/2+o}]],fill:Ja}),this._hasNext){const s=this._hasPrevious?3:1;v2.drawWith(e,{pointsGroup:[[{x:i+this._size*s/2,y:this._size/2},{x:-o+this._size*s/2,y:this._size/2-o},{x:-o+this._size*s/2,y:this._size/2+o}]],fill:Ja})}}};var PNe=Object.defineProperty,BNe=Object.getOwnPropertyDescriptor,FNe=(t,e,n,r)=>{for(var i=r>1?void 0:r?BNe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&PNe(e,n,i),i},e3=(t,e)=>(n,r)=>e(n,r,t);const bI="__SpreadsheetHeaderUnhideSHAPEControllerShape__",UNe=[nc.id,tc.id,Ju.id,ec.id];let I8=class extends E1{constructor(e,n,r,i){super(),V(this,"_shapes",new Map),this._sheetSkeletonManagerService=e,this._cmdSrv=n,this._univerInstanceService=r,this._rendererManagerService=i,this._init()}dispose(){super.dispose()}_init(){if(!this._getSheetObject())return;const e=this._univerInstanceService.getCurrentUniverSheetInstance(),n=e.getActiveSheet();n&&this._initForWorksheet(e,n),this._sheetSkeletonManagerService.currentSkeleton$.pipe(Ts(this.dispose$)).subscribe(r=>{if(r){const i=this._univerInstanceService.getUniverSheetInstance(r.unitId),o=i.getSheetBySheetId(r.sheetId);this._updateWorksheet(i,o)}}),this.disposeWithMe(this._cmdSrv.onCommandExecuted(r=>{if(!UNe.includes(r.id)||!r.params||!r.params.unitId||!r.params.subUnitId)return;const i=this._univerInstanceService.getUniverSheetInstance(r.params.unitId),o=i==null?void 0:i.getSheetBySheetId(r.params.subUnitId);o&&this._updateWorksheet(i,o)}))}_initForWorksheet(e,n){var r;const i=(r=this._sheetSkeletonManagerService.getCurrent())==null?void 0:r.skeleton;if(!i)return;const o=n.getHiddenRows(),s=n.getHiddenCols(),a=this._getSheetObject();if(!a)return;const{scene:l}=a,u=n.getRowCount(),c=o.map(f=>{const{startRow:m,endRow:p}=f,g=dI(m,0,l,i),v=m!==0,_=p!==u-1;return new _I(bI,{type:A_.ROW,hovered:!1,hasPrevious:v,hasNext:_,top:g.startY-(v?Ad:0),left:g.startX-Ad},()=>this._cmdSrv.executeCommand(Cy.id,{unitId:e.getUnitId(),subUnitId:n.getSheetId(),ranges:[f]}))}),d=n.getColumnCount(),h=s.map(f=>{const{startColumn:m,endColumn:p}=f,g=dI(0,m,l,i),v=m!==0,_=p!==d-1;return new _I(bI,{type:A_.COLUMN,hovered:!1,hasPrevious:v,hasNext:_,left:g.startX-(v?Ad:0),top:20-Ad},()=>this._cmdSrv.executeCommand(_y.id,{unitId:e.getUnitId(),subUnitId:n.getSheetId(),ranges:[f]}))});l.addObjects(h,qD),l.addObjects(c,qD),this._shapes.set(wS(e,n),{cols:h,rows:c})}_updateWorksheet(e,n){const r=this._shapes.get(wS(e,n));r==null||r.cols.forEach(i=>i.dispose()),r==null||r.rows.forEach(i=>i.dispose()),this._initForWorksheet(e,n)}_getSheetObject(){return jo(this._univerInstanceService,this._rendererManagerService)}};I8=FNe([yt(it.Rendered,I8),e3(0,ne(kr)),e3(1,le),e3(2,oe),e3(3,kn)],I8);var HNe=Object.defineProperty,VNe=Object.getOwnPropertyDescriptor,jNe=(t,e,n,r)=>{for(var i=r>1?void 0:r?VNe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&HNe(e,n,i),i},Sp=(t,e)=>(n,r)=>e(n,r,t);let x8=class extends je{constructor(e,n,r){super(),this._markSelectionService=e,this._commandService=n,this._sheetSkeletonManagerService=r,this._initListeners()}_initListeners(){this._addRemoveListener(),this._addRefreshListener()}_addRemoveListener(){const e=[$a.id,Pt.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{e.includes(n.id)&&this._markSelectionService.removeAllShapes()}))}_addRefreshListener(){this.disposeWithMe(Be(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{e&&this._markSelectionService.refreshShapes()})))}};x8=jNe([yt(it.Steady,x8),Sp(0,ne(Cf)),Sp(1,le),Sp(2,ne(kr))],x8);var zNe=Object.defineProperty,WNe=Object.getOwnPropertyDescriptor,XNe=(t,e,n,r)=>{for(var i=r>1?void 0:r?WNe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&zNe(e,n,i),i},Ep=(t,e)=>(n,r)=>e(n,r,t);let M8=class extends je{constructor(e,n,r){super(),V(this,"_initialize",()=>{const i=new Ia;this.disposeWithMe(Be(this._selectionManagerService.selectionMoveEnd$.subscribe(()=>{i.dispose();const o=this._selectionManagerService.getCurrent();(o==null?void 0:o.pluginName)===On&&this._selectionRenderService.getCurrentControls().forEach(s=>{i.add(Be(s.selectionMoved$.subscribe(a=>{if(!a)return;const l=s.model.getRange(),u={startRow:l.startRow,startColumn:l.startColumn,endRow:l.endRow,endColumn:l.endColumn,rangeType:l.rangeType},c={startRow:a.startRow,startColumn:a.startColumn,endRow:a.endRow,endColumn:a.endColumn,rangeType:l.rangeType};if(u.startRow===c.startRow&&u.startColumn===c.startColumn||c.startRow<0||c.startColumn<0)return;const d={fromRange:u,toRange:c};this._commandService.executeCommand(gc.id,d)})))})})))}),this._selectionRenderService=e,this._selectionManagerService=n,this._commandService=r,this._initialize()}};M8=XNe([yt(it.Steady,M8),Ep(0,ne(to)),Ep(1,ne(ut)),Ep(2,ne(le))],M8);var YNe=Object.defineProperty,GNe=Object.getOwnPropertyDescriptor,KNe=(t,e,n,r)=>{for(var i=r>1?void 0:r?GNe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&YNe(e,n,i),i},Vc=(t,e)=>(n,r)=>e(n,r,t);let o6=class extends je{constructor(e,n,r,i,o,s){super(),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._selectionManagerService=o,this._scrollManagerService=s,this._initialize()}dispose(){super.dispose()}_initialize(){this._scrollEventBinding(),this._scrollSubscribeBinding(),this._skeletonListener()}_scrollEventBinding(){var e;const n=(e=this._getSheetObject())==null?void 0:e.scene;if(n==null)return;const r=n.getViewport(Kn.VIEW_MAIN);this.disposeWithMe(Be(r==null?void 0:r.onScrollAfterObserver.add(i=>{var o;const s=(o=this._sheetSkeletonManagerService.getCurrent())==null?void 0:o.skeleton;if(s==null||i.isTrigger===!1)return;const a=this._getSheetObject();if(s==null||a==null)return;const{actualScrollX:l=0,actualScrollY:u=0}=i,{row:c,column:d,rowOffset:h,columnOffset:f}=s.getDecomposedOffset(l,u);this._scrollManagerService.addOrReplaceNoRefresh({sheetViewStartRow:c,sheetViewStartColumn:d,offsetX:f,offsetY:h})}))),this.disposeWithMe(Be(r==null?void 0:r.onScrollByBarObserver.add(i=>{var o;const s=(o=this._sheetSkeletonManagerService.getCurrent())==null?void 0:o.skeleton;if(s==null||i.isTrigger===!1)return;const a=this._getSheetObject();if(s==null||a==null)return;const{actualScrollX:l=0,actualScrollY:u=0}=i,{row:c,column:d,rowOffset:h,columnOffset:f}=s.getDecomposedOffset(l,u);this._commandService.executeCommand(Ou.id,{sheetViewStartRow:c,sheetViewStartColumn:d,offsetX:f,offsetY:h})})))}scrollToVisible(e){var n,r,i;let o,s;const a=this._selectionManagerService.getLast();if(a==null)return;const{actualRow:l,actualColumn:u}=a.primary,{rowHeightAccumulation:c,columnWidthAccumulation:d}=((n=this._sheetSkeletonManagerService.getCurrent())==null?void 0:n.skeleton)??{};if(c==null||d==null)return;const h=(r=this._getSheetObject())==null?void 0:r.scene;if(h==null)return;const f=h.getViewport(Kn.VIEW_MAIN);if(f==null||this._getSheetObject()==null)return;const m=this._currentUniverService.getCurrentUniverSheetInstance().getActiveSheet(),{startColumn:p,startRow:g,ySplit:v,xSplit:_}=m.getFreeze(),C=f.getBounding(),y=(i=this._sheetSkeletonManagerService.getCurrent())==null?void 0:i.skeleton;if(y==null)return;const{startRow:S,startColumn:E,endRow:w,endColumn:R}=y.getRowColumnSegment(C);if(l>=g&&u>=p-_&&(l<=S&&(o=l),l>=w)){const $=c[l]-f.height;for(let N=S;N<=l;N++)if(c[N]>=$){o=N+1;break}}if(u>=p&&l>=g-v&&(u<=E&&(s=u),u>=R)){const $=d[u]-f.width;for(let N=E;N<=u;N++)if(d[N]>=$){s=N+1;break}}if(o===void 0&&s===void 0)return;const{sheetViewStartColumn:D,sheetViewStartRow:I,offsetX:k,offsetY:O}=this._scrollManagerService.getCurrentScroll()||{};this._commandService.executeCommand(Ou.id,{sheetViewStartRow:o??I,sheetViewStartColumn:s??D,offsetX:s===void 0?k:0,offsetY:o===void 0?O:0})}_scrollSubscribeBinding(){this.disposeWithMe(Be(this._scrollManagerService.scrollInfo$.subscribe(e=>{var n;const r=(n=this._sheetSkeletonManagerService.getCurrent())==null?void 0:n.skeleton,i=this._getSheetObject();if(r==null||i==null)return;const o=i.scene,{scaleX:s,scaleY:a}=i.scene.getAncestorScale(),l=o.getViewport(Kn.VIEW_MAIN);if(l==null)return;if(e==null){l.scrollTo({x:0,y:0});return}const{sheetViewStartRow:u,sheetViewStartColumn:c,offsetX:d,offsetY:h}=e,{startX:f,startY:m}=r.getCellByIndexWithNoHeader(u,c,s,a),p=f+d,g=m+h,v=l.getBarScroll(p,g);l.scrollTo(v)})))}_skeletonListener(){this.disposeWithMe(Be(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const{unitId:n,sheetId:r}=e;this._renderManagerService.getRenderById(n)!=null&&(this._updateSceneSize(e),this._scrollManagerService.setCurrentScroll({unitId:n,sheetId:r}))})))}_updateSceneSize(e){var n;if(e==null)return;const{skeleton:r,unitId:i}=e,o=(n=this._renderManagerService.getRenderById(i))==null?void 0:n.scene;if(r==null||o==null)return;const{rowTotalHeight:s,columnTotalWidth:a,rowHeaderWidthAndMarginLeft:l,columnHeaderHeightAndMarginTop:u}=r;o==null||o.transformByState({width:l+a,height:u+s})}_getSheetObject(){return jo(this._currentUniverService,this._renderManagerService)}};o6=KNe([yt(it.Rendered,o6),Vc(0,ne(kr)),Vc(1,oe),Vc(2,le),Vc(3,kn),Vc(4,ne(ut)),Vc(5,ne(Yl))],o6);var ZNe=Object.defineProperty,qNe=Object.getOwnPropertyDescriptor,QNe=(t,e,n,r)=>{for(var i=r>1?void 0:r?qNe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&ZNe(e,n,i),i},CI=(t,e)=>(n,r)=>e(n,r,t);const JNe=[Yi.id,bc.id];let O8=class extends je{constructor(e,n){super(),this._commandService=e,this._scrollController=n,this.disposeWithMe(this._commandService.onCommandExecuted(r=>{if(JNe.includes(r.id)){const i=r.params;this._scrollController.scrollToVisible(i.direction)}}))}};O8=QNe([yt(it.Rendered,O8),CI(0,le),CI(1,ne(o6))],O8);var eLe=Object.defineProperty,tLe=Object.getOwnPropertyDescriptor,nLe=(t,e,n,r)=>{for(var i=r>1?void 0:r?tLe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&eLe(e,n,i),i},ou=(t,e)=>(n,r)=>e(n,r,t);let T8=class extends je{constructor(e,n,r,i,o,s,a){super(),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._selectionRenderService=o,this._selectionManagerService=s,this._themeService=a,this._initialize()}_initialize(){const e=this._currentUniverService.getCurrentUniverSheetInstance(),n=e.getActiveSheet(),r=this._getSheetObject();if(r==null)return;this._initViewMainListener(r),this._initRowHeader(r),this._initColumnHeader(r),this._initLeftTop(r),this._initSelectionChangeListener(),this._initThemeChangeListener(),this._initSkeletonChangeListener(),this._initCommandListener(),this._initUserActionSyncListener();const i=e.getUnitId(),o=n.getSheetId();this._selectionManagerService.setCurrentSelection({pluginName:On,unitId:i,sheetId:o})}_initViewMainListener(e){const{spreadsheet:n,scene:r}=e,i=r.getViewport(Kn.VIEW_MAIN);this.disposeWithMe(Be(n==null?void 0:n.onPointerDownObserver.add((o,s)=>{this._selectionRenderService.enableDetectMergedCell(),this._selectionRenderService.eventTrigger(o,n.zIndex+1,Rt.NORMAL,i),o.button!==2&&s.stopPropagation()})))}_initThemeChangeListener(){this.disposeWithMe(Be(this._themeService.currentTheme$.subscribe(()=>{this._selectionRenderService.resetStyle();const e=this._selectionManagerService.getSelections(),n=this._selectionManagerService.getCurrent();e==null||(n==null?void 0:n.pluginName)!==On||this._refreshSelection(e)})))}_refreshSelection(e){this._selectionRenderService.reset();for(const n of e){if(n==null)continue;const r=this._selectionRenderService.convertSelectionRangeToData(n);r.style=Pu(this._themeService),this._selectionRenderService.addControlToCurrentByRangeData(r)}}_initRowHeader(e){const{spreadsheetRowHeader:n,spreadsheet:r,scene:i}=e,o=i.getViewport(Kn.VIEW_MAIN);this.disposeWithMe(Be(n==null?void 0:n.onPointerDownObserver.add((s,a)=>{this._selectionRenderService.disableDetectMergedCell(),this._selectionRenderService.eventTrigger(s,((r==null?void 0:r.zIndex)||1)+1,Rt.ROW,o,r5.Y),s.button!==2&&a.stopPropagation()})))}_initColumnHeader(e){const{spreadsheetColumnHeader:n,spreadsheet:r,scene:i}=e,o=i.getViewport(Kn.VIEW_MAIN);this.disposeWithMe(Be(n==null?void 0:n.onPointerDownObserver.add((s,a)=>{this._selectionRenderService.disableDetectMergedCell(),this._selectionRenderService.eventTrigger(s,((r==null?void 0:r.zIndex)||1)+1,Rt.COLUMN,o,r5.X),s.button!==2&&a.stopPropagation()})))}_initLeftTop(e){const{spreadsheetLeftTopPlaceholder:n}=e;this.disposeWithMe(Be(n==null?void 0:n.onPointerDownObserver.add((r,i)=>{var o;const s=(o=this._sheetSkeletonManagerService.getCurrent())==null?void 0:o.skeleton;s!=null&&(this._selectionManagerService.replace([this._getAllRange(s)]),r.button!==2&&i.stopPropagation())})))}_initSelectionChangeListener(){this.disposeWithMe(Be(this._selectionManagerService.selectionMoveEnd$.subscribe(e=>{if(this._selectionRenderService.reset(),e!=null)for(const n of e){if(n==null)continue;const r=this._selectionRenderService.convertSelectionRangeToData(n);this._selectionRenderService.addControlToCurrentByRangeData(r)}})))}_initUserActionSyncListener(){this._selectionRenderService.selectionMoveStart$.subscribe(e=>{this._move(e,t8.MOVE_START)}),this._selectionRenderService.selectionMoving$.subscribe(e=>{this._move(e,t8.MOVING)}),this._selectionRenderService.selectionMoveEnd$.subscribe(e=>{this._move(e,t8.MOVE_END)})}_move(e,n){const r=this._currentUniverService.getCurrentUniverSheetInstance(),i=r.getUnitId(),o=r.getActiveSheet().getSheetId(),s=this._selectionManagerService.getCurrent();e==null||e.length===0||this._commandService.executeCommand(dn.id,{unitId:i,subUnitId:o,type:n,pluginName:(s==null?void 0:s.pluginName)||On,selections:e.map(a=>a8(a))})}_getSheetObject(){return jo(this._currentUniverService,this._renderManagerService)}_initCommandListener(){const e=[Gl.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(e.includes(n.id)){const r=this._currentUniverService.getCurrentUniverSheetInstance(),i=r.getActiveSheet(),o=n.params,{unitId:s,subUnitId:a}=o;if(!(s===r.getUnitId()&&a===i.getSheetId()))return;this._selectionManagerService.refreshSelection()}}))}_initSkeletonChangeListener(){this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const{unitId:n,sheetId:r,skeleton:i}=e,o=this._renderManagerService.getRenderById(n);if(o==null)return;const{scene:s}=o,a=s.getViewport(Kn.VIEW_MAIN);this._selectionRenderService.changeRuntime(i,s,a);const l=this._selectionManagerService.getCurrent(),u=(l==null?void 0:l.pluginName)||On;if((l==null?void 0:l.unitId)===n&&l.sheetId===r){const c=this._selectionManagerService.getSelections();c!=null&&this._refreshSelection(c)}else this._selectionManagerService.setCurrentSelection({pluginName:u,unitId:n,sheetId:r});u===On&&this._selectionManagerService.getLast()==null&&this._selectionManagerService.add([this._getZeroRange(i)])})}_getAllRange(e){return{range:{startRow:0,startColumn:0,endRow:e.getRowCount()-1,endColumn:e.getColumnCount()-1,rangeType:Rt.ALL},primary:this._getZeroRange(e).primary,style:null}}_getZeroRange(e){const n=e.mergeData;return KOe(0,0,n)||{range:{startRow:0,startColumn:0,endRow:0,endColumn:0},primary:{actualRow:0,actualColumn:0,startRow:0,startColumn:0,endRow:0,endColumn:0,isMerged:!1,isMergedMainCell:!1},style:null}}};T8=nLe([yt(it.Rendered,T8),ou(0,ne(kr)),ou(1,oe),ou(2,le),ou(3,kn),ou(4,to),ou(5,ne(ut)),ou(6,ne(Ki))],T8);var rLe=Object.defineProperty,iLe=Object.getOwnPropertyDescriptor,oLe=(t,e,n,r)=>{for(var i=r>1?void 0:r?iLe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&rLe(e,n,i),i},jc=(t,e)=>(n,r)=>e(n,r,t);let $8=class extends je{constructor(e,n,r,i,o,s){super(),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._renderManagerService=r,this._commandService=i,this._selectionRenderService=o,this._selectionManagerService=s,this._initialize(),this._commandExecutedListener()}dispose(){super.dispose()}_initialize(){this._initialRenderRefresh()}_initialRenderRefresh(){this.disposeWithMe(Be(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const{skeleton:n,unitId:r,sheetId:i}=e,o=this._currentUniverService.getUniverSheetInstance(r),s=o==null?void 0:o.getSheetBySheetId(i);if(o==null||s==null)return;const a=this._renderManagerService.getRenderById(r);if(a==null)return;const{mainComponent:l,components:u,scene:c}=a,d=l,h=u.get(zi.ROW),f=u.get(zi.COLUMN),m=u.get(zi.LEFT_TOP),{rowHeaderWidth:p,columnHeaderHeight:g}=n;d==null||d.updateSkeleton(n),h==null||h.updateSkeleton(n),f==null||f.updateSkeleton(n),m==null||m.transformByState({width:p,height:g})})))}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted((e,n)=>{var r,i;const o=this._currentUniverService.getCurrentUniverSheetInstance(),s=o.getUnitId();if(NB.includes(e.id)){const a=o.getActiveSheet(),l=a.getSheetId(),u=e.params,{unitId:c,subUnitId:d}=u;if(!(c===o.getUnitId()&&d===a.getSheetId()))return;e.id!==ja.id&&this._sheetSkeletonManagerService.makeDirty({unitId:c,sheetId:l,commandId:e.id},!0),this._sheetSkeletonManagerService.setCurrent({unitId:c,sheetId:l,commandId:e.id})}else YOe.includes(e.id)&&this._sheetSkeletonManagerService.reCalculate();e.type===se.MUTATION&&((i=(r=this._renderManagerService.getRenderById(s))==null?void 0:r.mainComponent)==null||i.makeDirty())}))}};$8=oLe([yt(it.Ready,$8),jc(0,ne(kr)),jc(1,oe),jc(2,kn),jc(3,le),jc(4,to),jc(5,ne(ut))],$8);const M1={type:se.COMMAND,id:"sheet.command.add-worksheet-merge",handler:async(t,e)=>{const n=t.get(le),r=t.get(At),i=t.get(oe),o=t.get(R4),s=t.get(mn),a=e.unitId,l=e.subUnitId,u=e.selections,c=bf(u,e.value),d=i.getUniverSheetInstance(a).getSheetBySheetId(l),h=[],f=[],m=CF(d,c);if(m&&!await o.confirm({id:"merge.confirm.add-worksheet-merge",title:{title:"merge.confirm.title"},cancelText:s.t("merge.confirm.cancel"),confirmText:s.t("merge.confirm.confirm")}))return!1;const p={unitId:a,subUnitId:l,ranges:c},g={unitId:a,subUnitId:l,ranges:c};h.push({id:Rn.id,params:p}),h.push({id:wn.id,params:g});const v=Ai(t,p),_=so(t,g);if(f.push({id:Rn.id,params:_}),f.push({id:wn.id,params:v}),m){const C=yF(t,a,d,c);h.unshift(...C.redos),f.push(...C.undos)}return Xn(h,n).result?(r.pushUndoRedo({unitID:a,undoMutations:f,redoMutations:h}),!0):!1}},LF={type:se.COMMAND,id:"sheet.command.add-worksheet-merge-all",handler:async t=>{const e=t.get(le),n=t.get(ut).getSelectionRanges();if(!(n!=null&&n.length))return!1;const r=t.get(oe).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),s=i.getSheetId();return e.executeCommand(M1.id,{selections:n,unitId:o,subUnitId:s})}},PF={type:se.COMMAND,id:"sheet.command.add-worksheet-merge-vertical",handler:async t=>{const e=t.get(le),n=t.get(ut).getSelectionRanges();if(!(n!=null&&n.length))return!1;const r=t.get(oe).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),s=i.getSheetId();return e.executeCommand(M1.id,{value:sr.COLUMNS,selections:n,unitId:o,subUnitId:s})}},BF={type:se.COMMAND,id:"sheet.command.add-worksheet-merge-horizontal",handler:async t=>{const e=t.get(le),n=t.get(ut).getSelectionRanges();if(!(n!=null&&n.length))return!1;const r=t.get(oe).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),s=i.getSheetId();return e.executeCommand(M1.id,{value:sr.ROWS,selections:n,unitId:o,subUnitId:s})}},FF={id:"sheet.command.refill",type:se.COMMAND,handler:async(t,e)=>(t.get(A0).setApplyType(e.type),!0)},UF={id:"sheet.command.remove-sheet-confirm",type:se.COMMAND,handler:async(t,e)=>{const{subUnitId:n}=e,r=t.get(R4),i=t.get(le),o=t.get(mn);return await r.confirm({id:"merge.confirm.add-worksheet-merge",title:{title:o.t("sheetConfig.deleteSheet")},children:{title:o.t("sheetConfig.deleteSheetContent")},cancelText:o.t("button.cancel"),confirmText:o.t("button.confirm")})?(await i.executeCommand(pf.id,{subUnitId:n}),!0):!1}},Df={id:"sheet.command.change-zoom-ratio",type:se.COMMAND,handler:async(t,e)=>{if(!e)return!1;const{delta:n,reset:r}=e,i=t.get(oe).getCurrentUniverSheetInstance(),o=i.getActiveSheet(),s=i.getUnitId(),a=o.getSheetId();let l=r?100:Math.round((o.getConfig().zoomRatio+n)*100);l=Math.max(D_[0],l),l=Math.min(D_[1],l);const u=l/100;return t.get(le).executeCommand(Gl.id,{unitId:s,subUnitId:a,zoomRatio:u})}},Fy={id:"sheet.command.set-zoom-ratio",type:se.COMMAND,handler:async(t,e)=>{if(!e)return!1;const{unitId:n,subUnitId:r,zoomRatio:i}=e;return t.get(le).executeCommand(Gl.id,{unitId:n,subUnitId:r,zoomRatio:i})}},B0=nn("univer.sheetbar-service");class sLe extends je{constructor(){super(),V(this,"renameId$"),V(this,"removeId$"),V(this,"scroll$"),V(this,"scrollX$"),V(this,"addSheet$"),V(this,"_renameId$"),V(this,"_removeId$"),V(this,"_scroll$"),V(this,"_scrollX$"),V(this,"_addSheet$"),V(this,"_currentHandler",null),this._renameId$=new Qt,this.renameId$=this._renameId$.asObservable(),this._removeId$=new Qt,this.removeId$=this._removeId$.asObservable(),this._scroll$=new Qt,this.scroll$=this._scroll$.asObservable(),this._scrollX$=new Qt,this.scrollX$=this._scrollX$.asObservable(),this._addSheet$=new Qt,this.addSheet$=this._addSheet$.asObservable()}setRenameId(e){this._renameId$.next(e)}setRemoveId(e){this._removeId$.next(e)}setScroll(e){this._scroll$.next(e)}setScrollX(e){this._scrollX$.next(e)}setAddSheet(e){this._addSheet$.next(e)}triggerSheetBarMenu(){var e;(e=this._currentHandler)==null||e.handleSheetBarMenu()}registerSheetBarMenuHandler(e){if(this._currentHandler)throw new Error("There is already a context menu handler!");return this._currentHandler=e,Be(()=>{this._currentHandler=null})}}const HF={id:"ui-sheet.command.show-menu-list",type:se.OPERATION,handler:async t=>(t.get(B0).triggerSheetBarMenu(),!0)},VF={id:"sheet.operation.rename-sheet",type:se.OPERATION,handler:async(t,e)=>{const n=t.get(B0);return e&&n.setRenameId(e.subUnitId),!0}},aLe=()=>F.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[F.jsx("path",{d:"M0.98999 1.08218H-0.0100098V0.0821838H0.98999V1.08218Z",fill:"black"}),F.jsx("path",{d:"M5.78992 1.08218H2.78992V0.0821838H5.78992V1.08218Z",fill:"black"}),F.jsx("path",{d:"M7.58984 1.08218H8.58984V0.0821838H7.58984V1.08218Z",fill:"black"}),F.jsx("path",{d:"M14.9152 1.08218H13.9152V0.0821838H14.9152V1.08218Z",fill:"black"}),F.jsx("path",{d:"M16.7151 1.08218H19.7151V0.0821838H16.7151V1.08218Z",fill:"black"}),F.jsx("path",{d:"M22.515 1.08218H21.515V0.0821838H22.515V1.08218Z",fill:"black"}),F.jsx("path",{d:"M27.8405 1.08218H28.8405V0.0821838H27.8405V1.08218Z",fill:"black"}),F.jsx("path",{d:"M33.6404 1.08218H30.6404V0.0821838H33.6404V1.08218Z",fill:"black"}),F.jsx("path",{d:"M35.4403 1.08218H36.4403V0.0821838H35.4403V1.08218Z",fill:"black"}),F.jsx("path",{d:"M42.7657 1.08218H41.7657V0.0821838H42.7657V1.08218Z",fill:"black"}),F.jsx("path",{d:"M44.5657 1.08218H47.5657V0.0821838H44.5657V1.08218Z",fill:"black"}),F.jsx("path",{d:"M50.3656 1.08218H49.3656V0.0821838H50.3656V1.08218Z",fill:"black"}),F.jsx("path",{d:"M55.691 1.08218H56.691V0.0821838H55.691V1.08218Z",fill:"black"}),F.jsx("path",{d:"M61.491 1.08218H58.491V0.0821838H61.491V1.08218Z",fill:"black"}),F.jsx("path",{d:"M63.2909 1.08218H64.2909V0.0821838H63.2909V1.08218Z",fill:"black"}),F.jsx("path",{d:"M70.6163 1.08218H69.6163V0.0821838H70.6163V1.08218Z",fill:"black"}),F.jsx("path",{d:"M72.4163 1.08218H75.4163V0.0821838H72.4163V1.08218Z",fill:"black"}),F.jsx("path",{d:"M78.2162 1.08218H77.2162V0.0821838H78.2162V1.08218Z",fill:"black"}),F.jsx("path",{d:"M83.5416 1.08218H84.5416V0.0821838H83.5416V1.08218Z",fill:"black"}),F.jsx("path",{d:"M89.3416 1.08218H86.3416V0.0821838H89.3416V1.08218Z",fill:"black"}),F.jsx("path",{d:"M91.1415 1.08218H92.1415V0.0821838H91.1415V1.08218Z",fill:"black"}),F.jsx("path",{d:"M98.4669 1.08218H97.4669V0.0821838H98.4669V1.08218Z",fill:"black"}),F.jsx("path",{d:"M100.267 1.08218H103.267V0.0821838H100.267V1.08218Z",fill:"black"}),F.jsx("path",{d:"M106.067 1.08218H105.067V0.0821838H106.067V1.08218Z",fill:"black"}),F.jsx("path",{d:"M111.392 1.08218H112.392V0.0821838H111.392V1.08218Z",fill:"black"}),F.jsx("path",{d:"M117.192 1.08218H114.192V0.0821838H117.192V1.08218Z",fill:"black"}),F.jsx("path",{d:"M118.992 1.08218H119.992V0.0821838H118.992V1.08218Z",fill:"black"})]}),lLe=()=>F.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[F.jsx("path",{d:"M-0.0100098 1.15771H0.98999V0.157715H-0.0100098V1.15771Z",fill:"black"}),F.jsx("path",{d:"M2.78992 1.15771H5.78992V0.157715H2.78992V1.15771Z",fill:"black"}),F.jsx("path",{d:"M8.58984 1.15771H7.58984V0.157715H8.58984V1.15771Z",fill:"black"}),F.jsx("path",{d:"M10.3899 1.15771H11.3899V0.157715H10.3899V1.15771Z",fill:"black"}),F.jsx("path",{d:"M19.0903 1.15771H18.0903V0.157715H19.0903V1.15771Z",fill:"black"}),F.jsx("path",{d:"M20.8903 1.15771H23.8903V0.157715H20.8903V1.15771Z",fill:"black"}),F.jsx("path",{d:"M26.6902 1.15771H25.6902V0.157715H26.6902V1.15771Z",fill:"black"}),F.jsx("path",{d:"M28.4902 1.15771H29.4902V0.157715H28.4902V1.15771Z",fill:"black"}),F.jsx("path",{d:"M37.1907 1.15771H36.1907V0.157715H37.1907V1.15771Z",fill:"black"}),F.jsx("path",{d:"M38.9906 1.15771H41.9906V0.157715H38.9906V1.15771Z",fill:"black"}),F.jsx("path",{d:"M44.7905 1.15771H43.7905V0.157715H44.7905V1.15771Z",fill:"black"}),F.jsx("path",{d:"M46.5906 1.15771H47.5906V0.157715H46.5906V1.15771Z",fill:"black"}),F.jsx("path",{d:"M55.291 1.15771H54.291V0.157715H55.291V1.15771Z",fill:"black"}),F.jsx("path",{d:"M57.0909 1.15771H60.0909V0.157715H57.0909V1.15771Z",fill:"black"}),F.jsx("path",{d:"M62.8909 1.15771H61.8909V0.157715H62.8909V1.15771Z",fill:"black"}),F.jsx("path",{d:"M64.6909 1.15771H65.6909V0.157715H64.6909V1.15771Z",fill:"black"}),F.jsx("path",{d:"M73.3914 1.15771H72.3914V0.157715H73.3914V1.15771Z",fill:"black"}),F.jsx("path",{d:"M75.1913 1.15771H78.1913V0.157715H75.1913V1.15771Z",fill:"black"}),F.jsx("path",{d:"M80.9912 1.15771H79.9912V0.157715H80.9912V1.15771Z",fill:"black"}),F.jsx("path",{d:"M82.7913 1.15771H83.7913V0.157715H82.7913V1.15771Z",fill:"black"}),F.jsx("path",{d:"M91.4917 1.15771H90.4917V0.157715H91.4917V1.15771Z",fill:"black"}),F.jsx("path",{d:"M93.2916 1.15771H96.2916V0.157715H93.2916V1.15771Z",fill:"black"}),F.jsx("path",{d:"M99.0916 1.15771H98.0916V0.157715H99.0916V1.15771Z",fill:"black"}),F.jsx("path",{d:"M100.892 1.15771H101.892V0.157715H100.892V1.15771Z",fill:"black"}),F.jsx("path",{d:"M109.592 1.15771H108.592V0.157715H109.592V1.15771Z",fill:"black"}),F.jsx("path",{d:"M111.392 1.15771H114.392V0.157715H111.392V1.15771Z",fill:"black"}),F.jsx("path",{d:"M117.192 1.15771H116.192V0.157715H117.192V1.15771Z",fill:"black"}),F.jsx("path",{d:"M118.992 1.15771H119.992V0.157715H118.992V1.15771Z",fill:"black"})]}),uLe=()=>F.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[F.jsx("path",{d:"M-0.00842285 1.22449H2.99158V0.224487H-0.00842285V1.22449Z",fill:"black"}),F.jsx("path",{d:"M6.14941 1.22449H9.14941V0.224487H6.14941V1.22449Z",fill:"black"}),F.jsx("path",{d:"M15.3073 1.22449H12.3073V0.224487H15.3073V1.22449Z",fill:"black"}),F.jsx("path",{d:"M18.4651 1.22449H21.4651V0.224487H18.4651V1.22449Z",fill:"black"}),F.jsx("path",{d:"M27.6229 1.22449H24.6229V0.224487H27.6229V1.22449Z",fill:"black"}),F.jsx("path",{d:"M30.7808 1.22449H33.7808V0.224487H30.7808V1.22449Z",fill:"black"}),F.jsx("path",{d:"M39.9386 1.22449H36.9386V0.224487H39.9386V1.22449Z",fill:"black"}),F.jsx("path",{d:"M43.0964 1.22449H46.0964V0.224487H43.0964V1.22449Z",fill:"black"}),F.jsx("path",{d:"M52.2543 1.22449H49.2543V0.224487H52.2543V1.22449Z",fill:"black"}),F.jsx("path",{d:"M55.4121 1.22449H58.4121V0.224487H55.4121V1.22449Z",fill:"black"}),F.jsx("path",{d:"M64.5699 1.22449H61.5699V0.224487H64.5699V1.22449Z",fill:"black"}),F.jsx("path",{d:"M67.7278 1.22449H70.7278V0.224487H67.7278V1.22449Z",fill:"black"}),F.jsx("path",{d:"M76.8856 1.22449H73.8856V0.224487H76.8856V1.22449Z",fill:"black"}),F.jsx("path",{d:"M80.0435 1.22449H83.0435V0.224487H80.0435V1.22449Z",fill:"black"}),F.jsx("path",{d:"M89.2013 1.22449H86.2013V0.224487H89.2013V1.22449Z",fill:"black"}),F.jsx("path",{d:"M92.3591 1.22449H95.3591V0.224487H92.3591V1.22449Z",fill:"black"}),F.jsx("path",{d:"M101.517 1.22449H98.517V0.224487H101.517V1.22449Z",fill:"black"}),F.jsx("path",{d:"M104.675 1.22449H107.675V0.224487H104.675V1.22449Z",fill:"black"}),F.jsx("path",{d:"M113.833 1.22449H110.833V0.224487H113.833V1.22449Z",fill:"black"}),F.jsx("path",{d:"M116.99 1.22449H119.99V0.224487H116.99V1.22449Z",fill:"black"})]}),cLe=()=>F.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[F.jsx("path",{d:"M-0.00976562 1.65707H0.990234V0.657074H-0.00976562V1.65707Z",fill:"black"}),F.jsx("path",{d:"M2.32361 1.65707H3.32361V0.657074H2.32361V1.65707Z",fill:"black"}),F.jsx("path",{d:"M5.65698 1.65707H4.65698V0.657074H5.65698V1.65707Z",fill:"black"}),F.jsx("path",{d:"M6.99036 1.65707H7.99036V0.657074H6.99036V1.65707Z",fill:"black"}),F.jsx("path",{d:"M10.3237 1.65707H9.32373V0.657074H10.3237V1.65707Z",fill:"black"}),F.jsx("path",{d:"M11.6571 1.65707H12.6571V0.657074H11.6571V1.65707Z",fill:"black"}),F.jsx("path",{d:"M14.9905 1.65707H13.9905V0.657074H14.9905V1.65707Z",fill:"black"}),F.jsx("path",{d:"M16.3239 1.65707H17.3239V0.657074H16.3239V1.65707Z",fill:"black"}),F.jsx("path",{d:"M19.6572 1.65707H18.6572V0.657074H19.6572V1.65707Z",fill:"black"}),F.jsx("path",{d:"M20.9906 1.65707H21.9906V0.657074H20.9906V1.65707Z",fill:"black"}),F.jsx("path",{d:"M24.324 1.65707H23.324V0.657074H24.324V1.65707Z",fill:"black"}),F.jsx("path",{d:"M25.6573 1.65707H26.6573V0.657074H25.6573V1.65707Z",fill:"black"}),F.jsx("path",{d:"M28.9907 1.65707H27.9907V0.657074H28.9907V1.65707Z",fill:"black"}),F.jsx("path",{d:"M30.3241 1.65707H31.3241V0.657074H30.3241V1.65707Z",fill:"black"}),F.jsx("path",{d:"M33.6575 1.65707H32.6575V0.657074H33.6575V1.65707Z",fill:"black"}),F.jsx("path",{d:"M34.9908 1.65707H35.9908V0.657074H34.9908V1.65707Z",fill:"black"}),F.jsx("path",{d:"M38.3242 1.65707H37.3242V0.657074H38.3242V1.65707Z",fill:"black"}),F.jsx("path",{d:"M39.6576 1.65707H40.6576V0.657074H39.6576V1.65707Z",fill:"black"}),F.jsx("path",{d:"M42.991 1.65707H41.991V0.657074H42.991V1.65707Z",fill:"black"}),F.jsx("path",{d:"M44.3243 1.65707H45.3243V0.657074H44.3243V1.65707Z",fill:"black"}),F.jsx("path",{d:"M47.6577 1.65707H46.6577V0.657074H47.6577V1.65707Z",fill:"black"}),F.jsx("path",{d:"M48.9911 1.65707H49.9911V0.657074H48.9911V1.65707Z",fill:"black"}),F.jsx("path",{d:"M52.3245 1.65707H51.3245V0.657074H52.3245V1.65707Z",fill:"black"}),F.jsx("path",{d:"M53.6578 1.65707H54.6578V0.657074H53.6578V1.65707Z",fill:"black"}),F.jsx("path",{d:"M56.9912 1.65707H55.9912V0.657074H56.9912V1.65707Z",fill:"black"}),F.jsx("path",{d:"M58.3246 1.65707H59.3246V0.657074H58.3246V1.65707Z",fill:"black"}),F.jsx("path",{d:"M61.658 1.65707H60.658V0.657074H61.658V1.65707Z",fill:"black"}),F.jsx("path",{d:"M62.9913 1.65707H63.9913V0.657074H62.9913V1.65707Z",fill:"black"}),F.jsx("path",{d:"M66.3247 1.65707H65.3247V0.657074H66.3247V1.65707Z",fill:"black"}),F.jsx("path",{d:"M67.6581 1.65707H68.6581V0.657074H67.6581V1.65707Z",fill:"black"}),F.jsx("path",{d:"M70.9915 1.65707H69.9915V0.657074H70.9915V1.65707Z",fill:"black"}),F.jsx("path",{d:"M72.3248 1.65707H73.3248V0.657074H72.3248V1.65707Z",fill:"black"}),F.jsx("path",{d:"M75.6582 1.65707H74.6582V0.657074H75.6582V1.65707Z",fill:"black"}),F.jsx("path",{d:"M76.9916 1.65707H77.9916V0.657074H76.9916V1.65707Z",fill:"black"}),F.jsx("path",{d:"M80.325 1.65707H79.325V0.657074H80.325V1.65707Z",fill:"black"}),F.jsx("path",{d:"M81.6583 1.65707H82.6583V0.657074H81.6583V1.65707Z",fill:"black"}),F.jsx("path",{d:"M84.9917 1.65707H83.9917V0.657074H84.9917V1.65707Z",fill:"black"}),F.jsx("path",{d:"M86.3251 1.65707H87.3251V0.657074H86.3251V1.65707Z",fill:"black"}),F.jsx("path",{d:"M89.6584 1.65707H88.6584V0.657074H89.6584V1.65707Z",fill:"black"}),F.jsx("path",{d:"M90.9918 1.65707H91.9918V0.657074H90.9918V1.65707Z",fill:"black"}),F.jsx("path",{d:"M94.3252 1.65707H93.3252V0.657074H94.3252V1.65707Z",fill:"black"}),F.jsx("path",{d:"M95.6586 1.65707H96.6586V0.657074H95.6586V1.65707Z",fill:"black"}),F.jsx("path",{d:"M98.9919 1.65707H97.9919V0.657074H98.9919V1.65707Z",fill:"black"}),F.jsx("path",{d:"M100.325 1.65707H101.325V0.657074H100.325V1.65707Z",fill:"black"}),F.jsx("path",{d:"M103.659 1.65707H102.659V0.657074H103.659V1.65707Z",fill:"black"}),F.jsx("path",{d:"M104.992 1.65707H105.992V0.657074H104.992V1.65707Z",fill:"black"}),F.jsx("path",{d:"M108.325 1.65707H107.325V0.657074H108.325V1.65707Z",fill:"black"}),F.jsx("path",{d:"M109.659 1.65707H110.659V0.657074H109.659V1.65707Z",fill:"black"}),F.jsx("path",{d:"M112.992 1.65707H111.992V0.657074H112.992V1.65707Z",fill:"black"}),F.jsx("path",{d:"M114.325 1.65707H115.325V0.657074H114.325V1.65707Z",fill:"black"}),F.jsx("path",{d:"M117.659 1.65707H116.659V0.657074H117.659V1.65707Z",fill:"black"}),F.jsx("path",{d:"M118.992 1.65707H119.992V0.657074H118.992V1.65707Z",fill:"black"})]}),dLe=()=>F.jsx("svg",{width:"120",height:"3",viewBox:"0 0 120 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:F.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 2.42035H-0.0090332V0.420349H119.991V2.42035Z",fill:"black"})}),hLe=()=>F.jsxs("svg",{width:"120",height:"3",viewBox:"0 0 120 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[F.jsx("path",{d:"M-0.0100098 2.47614H1.98999V0.476135H-0.0100098V2.47614Z",fill:"black"}),F.jsx("path",{d:"M3.99014 2.47614H9.99014V0.476135H3.99014V2.47614Z",fill:"black"}),F.jsx("path",{d:"M13.9901 2.47614H11.9901V0.476135H13.9901V2.47614Z",fill:"black"}),F.jsx("path",{d:"M21.1904 2.47614H23.1904V0.476135H21.1904V2.47614Z",fill:"black"}),F.jsx("path",{d:"M31.1906 2.47614H25.1906V0.476135H31.1906V2.47614Z",fill:"black"}),F.jsx("path",{d:"M33.1906 2.47614H35.1906V0.476135H33.1906V2.47614Z",fill:"black"}),F.jsx("path",{d:"M44.3909 2.47614H42.3909V0.476135H44.3909V2.47614Z",fill:"black"}),F.jsx("path",{d:"M46.391 2.47614H52.391V0.476135H46.391V2.47614Z",fill:"black"}),F.jsx("path",{d:"M56.391 2.47614H54.391V0.476135H56.391V2.47614Z",fill:"black"}),F.jsx("path",{d:"M63.5913 2.47614H65.5913V0.476135H63.5913V2.47614Z",fill:"black"}),F.jsx("path",{d:"M73.5915 2.47614H67.5915V0.476135H73.5915V2.47614Z",fill:"black"}),F.jsx("path",{d:"M75.5915 2.47614H77.5915V0.476135H75.5915V2.47614Z",fill:"black"}),F.jsx("path",{d:"M86.7917 2.47614H84.7917V0.476135H86.7917V2.47614Z",fill:"black"}),F.jsx("path",{d:"M88.7919 2.47614H94.7919V0.476135H88.7919V2.47614Z",fill:"black"}),F.jsx("path",{d:"M98.7919 2.47614H96.7919V0.476135H98.7919V2.47614Z",fill:"black"}),F.jsx("path",{d:"M105.992 2.47614H107.992V0.476135H105.992V2.47614Z",fill:"black"}),F.jsx("path",{d:"M115.992 2.47614H109.992V0.476135H115.992V2.47614Z",fill:"black"}),F.jsx("path",{d:"M117.992 2.47614H119.992V0.476135H117.992V2.47614Z",fill:"black"})]}),fLe=()=>F.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[F.jsx("path",{d:"M-0.0100098 2.00415H1.98999V0.00415039H-0.0100098V2.00415Z",fill:"black"}),F.jsx("path",{d:"M3.99014 2.00415H9.99014V0.00415039H3.99014V2.00415Z",fill:"black"}),F.jsx("path",{d:"M13.9901 2.00415H11.9901V0.00415039H13.9901V2.00415Z",fill:"black"}),F.jsx("path",{d:"M15.9901 2.00415H17.9901V0.00415039H15.9901V2.00415Z",fill:"black"}),F.jsx("path",{d:"M27.4905 2.00415H25.4905V0.00415039H27.4905V2.00415Z",fill:"black"}),F.jsx("path",{d:"M29.4906 2.00415H35.4906V0.00415039H29.4906V2.00415Z",fill:"black"}),F.jsx("path",{d:"M39.4906 2.00415H37.4906V0.00415039H39.4906V2.00415Z",fill:"black"}),F.jsx("path",{d:"M41.4906 2.00415H43.4906V0.00415039H41.4906V2.00415Z",fill:"black"}),F.jsx("path",{d:"M52.991 2.00415H50.991V0.00415039H52.991V2.00415Z",fill:"black"}),F.jsx("path",{d:"M54.9911 2.00415H60.9911V0.00415039H54.9911V2.00415Z",fill:"black"}),F.jsx("path",{d:"M64.9911 2.00415H62.9911V0.00415039H64.9911V2.00415Z",fill:"black"}),F.jsx("path",{d:"M66.9911 2.00415H68.9911V0.00415039H66.9911V2.00415Z",fill:"black"}),F.jsx("path",{d:"M78.4915 2.00415H76.4915V0.00415039H78.4915V2.00415Z",fill:"black"}),F.jsx("path",{d:"M80.4916 2.00415H86.4916V0.00415039H80.4916V2.00415Z",fill:"black"}),F.jsx("path",{d:"M90.4916 2.00415H88.4916V0.00415039H90.4916V2.00415Z",fill:"black"}),F.jsx("path",{d:"M92.4916 2.00415H94.4916V0.00415039H92.4916V2.00415Z",fill:"black"}),F.jsx("path",{d:"M103.992 2.00415H101.992V0.00415039H103.992V2.00415Z",fill:"black"}),F.jsx("path",{d:"M105.992 2.00415H111.992V0.00415039H105.992V2.00415Z",fill:"black"}),F.jsx("path",{d:"M115.992 2.00415H113.992V0.00415039H115.992V2.00415Z",fill:"black"}),F.jsx("path",{d:"M117.992 2.00415H119.992V0.00415039H117.992V2.00415Z",fill:"black"})]}),mLe=()=>F.jsxs("svg",{width:"118",height:"3",viewBox:"0 0 118 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[F.jsx("path",{d:"M-0.00854492 2.94815H1.99146V0.948151H-0.00854492V2.94815Z",fill:"black"}),F.jsx("path",{d:"M6.09668 2.94815H8.09668V0.948151H6.09668V2.94815Z",fill:"black"}),F.jsx("path",{d:"M14.2019 2.94815H12.2019V0.948151H14.2019V2.94815Z",fill:"black"}),F.jsx("path",{d:"M18.3071 2.94815H20.3071V0.948151H18.3071V2.94815Z",fill:"black"}),F.jsx("path",{d:"M26.4124 2.94815H24.4124V0.948151H26.4124V2.94815Z",fill:"black"}),F.jsx("path",{d:"M30.5176 2.94815H32.5176V0.948151H30.5176V2.94815Z",fill:"black"}),F.jsx("path",{d:"M38.6228 2.94815H36.6228V0.948151H38.6228V2.94815Z",fill:"black"}),F.jsx("path",{d:"M42.728 2.94815H44.728V0.948151H42.728V2.94815Z",fill:"black"}),F.jsx("path",{d:"M50.8333 2.94815H48.8333V0.948151H50.8333V2.94815Z",fill:"black"}),F.jsx("path",{d:"M54.9385 2.94815H56.9385V0.948151H54.9385V2.94815Z",fill:"black"}),F.jsx("path",{d:"M63.0437 2.94815H61.0437V0.948151H63.0437V2.94815Z",fill:"black"}),F.jsx("path",{d:"M67.1489 2.94815H69.1489V0.948151H67.1489V2.94815Z",fill:"black"}),F.jsx("path",{d:"M75.2542 2.94815H73.2542V0.948151H75.2542V2.94815Z",fill:"black"}),F.jsx("path",{d:"M79.3594 2.94815H81.3594V0.948151H79.3594V2.94815Z",fill:"black"}),F.jsx("path",{d:"M87.4645 2.94815H85.4645V0.948151H87.4645V2.94815Z",fill:"black"}),F.jsx("path",{d:"M91.5697 2.94815H93.5697V0.948151H91.5697V2.94815Z",fill:"black"}),F.jsx("path",{d:"M99.6749 2.94815H97.6749V0.948151H99.6749V2.94815Z",fill:"black"}),F.jsx("path",{d:"M103.78 2.94815H105.78V0.948151H103.78V2.94815Z",fill:"black"}),F.jsx("path",{d:"M111.885 2.94815H109.885V0.948151H111.885V2.94815Z",fill:"black"}),F.jsx("path",{d:"M115.991 2.94815H117.991V0.948151H115.991V2.94815Z",fill:"black"})]}),pLe=()=>F.jsx("svg",{width:"120",height:"4",viewBox:"0 0 120 4",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:F.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 3.86215H-0.0090332V0.862152H119.991V3.86215Z",fill:"black"})}),yI=()=>F.jsx("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:F.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 1.15668H-0.0090332V0.156677H119.991V1.15668Z",fill:"black"})});function SI(t){const{type:e=wt.THIN}=t;switch(e){case wt.DASH_DOT:return F.jsx(aLe,{});case wt.DASH_DOT_DOT:return F.jsx(lLe,{});case wt.DASHED:return F.jsx(uLe,{});case wt.HAIR:return F.jsx(cLe,{});case wt.MEDIUM:return F.jsx(dLe,{});case wt.MEDIUM_DASH_DOT:return F.jsx(hLe,{});case wt.MEDIUM_DASH_DOT_DOT:return F.jsx(fLe,{});case wt.MEDIUM_DASHED:return F.jsx(mLe,{});case wt.THICK:return F.jsx(pLe,{});case wt.THIN:return F.jsx(yI,{});default:return F.jsx(yI,{})}}const gLe="univer-ui-plugin-sheets-border-panel",vLe="univer-ui-plugin-sheets-border-panel-position",_Le="univer-ui-plugin-sheets-border-panel-position-item",bLe="univer-ui-plugin-sheets-border-panel-styles",CLe="univer-ui-plugin-sheets-border-panel-board",yLe="univer-ui-plugin-sheets-border-panel-button",SLe="univer-ui-plugin-sheets-border-panel-more-icon",Ka={uiPluginSheetsBorderPanel:gLe,uiPluginSheetsBorderPanelPosition:vLe,uiPluginSheetsBorderPanelPositionItem:_Le,uiPluginSheetsBorderPanelStyles:bLe,uiPluginSheetsBorderPanelBoard:CLe,uiPluginSheetsBorderPanelButton:yLe,uiPluginSheetsBorderPanelMoreIcon:SLe},jF=`${L0}_BORDER_PANEL_COMPONENT`,zF=[{label:"borderLine.borderTop",icon:"UpBorder",value:"top"},{label:"borderLine.borderBottom",icon:"DownBorder",value:"bottom"},{label:"borderLine.borderLeft",icon:"LeftBorder",value:"left"},{label:"borderLine.borderRight",icon:"RightBorder",value:"right"},{label:"borderLine.borderNone",icon:"NoBorderSingle",value:"none"},{label:"borderLine.borderAll",icon:"AllBorderSingle",value:"all"},{label:"borderLine.borderOutside",icon:"OuterBorder",value:"outside"},{label:"borderLine.borderInside",icon:"InnerBorder",value:"inside"},{label:"borderLine.borderHorizontal",icon:"InnerBorder",value:"horizontal"},{label:"borderLine.borderVertical",icon:"InnerBorder",value:"vertical"},{label:"borderLine.borderTlbr",icon:"BackSlashSingle",value:"tlbr"},{label:"borderLine.borderTlbcTlmr",icon:"LeftDoubleDiagonalSingle",value:"tlbc_tlmr"},{label:"borderLine.borderTlbrTlbcTlmr",icon:"LeftTridiagonalSingle",value:"tlbr_tlbc_tlmr"},{label:"borderLine.borderBlTr",icon:"SlashSingle",value:"bltr"},{label:"borderLine.borderMltrBctr",icon:"RightDoubleDiagonalSingle",value:"mltr_bctr"}],ELe=[{label:wt.THIN,value:wt.THIN},{label:wt.HAIR,value:wt.HAIR},{label:wt.DOTTED,value:wt.DOTTED},{label:wt.DASHED,value:wt.DASHED},{label:wt.DASH_DOT,value:wt.DASH_DOT},{label:wt.DASH_DOT_DOT,value:wt.DASH_DOT_DOT},{label:wt.MEDIUM,value:wt.MEDIUM},{label:wt.MEDIUM_DASHED,value:wt.MEDIUM_DASHED},{label:wt.MEDIUM_DASH_DOT,value:wt.MEDIUM_DASH_DOT},{label:wt.MEDIUM_DASH_DOT_DOT,value:wt.MEDIUM_DASH_DOT_DOT},{label:wt.THICK,value:wt.THICK}];function wLe(t){const e=_t(Pa),{onChange:n,value:r}=t;function i(a,l){n==null||n({...r,[l]:a})}function o(a){const l=e.get(a);return l&&F.jsx(l,{extend:{colorChannel1:"rgb(var(--primary-color))"}})}function s(a){a.stopPropagation()}return F.jsxs("section",{className:Ka.uiPluginSheetsBorderPanel,children:[F.jsx("div",{className:Ka.uiPluginSheetsBorderPanelPosition,children:zF.map(a=>F.jsx("div",{className:Ka.uiPluginSheetsBorderPanelPositionItem,onClick:()=>i(a.value,"type"),children:o(a.icon)},a.value))}),F.jsxs("div",{className:Ka.uiPluginSheetsBorderPanelStyles,children:[F.jsx("div",{children:F.jsx(g1,{align:{offset:[0,18]},overlay:F.jsx("section",{className:Ka.uiPluginSheetsBorderPanelBoard,onClick:s,children:F.jsx(zT,{onChange:a=>i(a,"color")})}),children:F.jsxs("a",{className:Ka.uiPluginSheetsBorderPanelButton,onClick:s,children:[F.jsx(D$e,{extend:{colorChannel1:r.color??"rgb(var(--primary-color))"}}),F.jsx("span",{className:Ka.uiPluginSheetsBorderPanelMoreIcon,children:F.jsx(I_,{})})]})})}),F.jsx("div",{children:F.jsx(g1,{align:{offset:[0,18]},overlay:F.jsx("section",{onClick:s,children:F.jsx(sk,{children:ELe.map(a=>F.jsx(Xh,{eventKey:a.value.toString(),onClick:()=>i(a.value,"style"),children:F.jsx(SI,{type:a.value})},a.value))})}),children:F.jsxs("a",{className:Ka.uiPluginSheetsBorderPanelButton,onClick:s,children:[F.jsx(SI,{type:wt.THIN}),F.jsx("span",{className:Ka.uiPluginSheetsBorderPanelMoreIcon,children:F.jsx(I_,{})})]})})})]})]})}const RLe="univer-count-bar",DLe={countBar:RLe},ILe=[50,80,100,130,150,170,200,400];function xLe(){const t=_t(le),e=_t(oe),n=o(),[r,i]=b.useState(n);b.useEffect(()=>t.onCommandExecuted(a=>{if(a.id===Gl.id||a.id===T0.id){const l=o();i(l)}}).dispose,[t]);function o(){const a=e.getCurrentUniverSheetInstance().getActiveSheet().getZoomRatio()*100||100;return Math.round(a)}function s(a){i(a);const l=e.getCurrentUniverSheetInstance();if(!l)return;const u=l.getActiveSheet();if(!u)return;const c=a/100;t.executeCommand(Fy.id,{unitId:l.getUnitId(),subUnitId:u.getSheetId(),zoomRatio:c})}return F.jsx(Yre,{min:D_[0],value:r,shortcuts:ILe,onChange:s})}function MLe(t){return F.jsx("section",{className:DLe.countBar,children:F.jsx(xLe,{})})}const OLe="univer-editor-container",TLe="univer-editor-input",EI={editorContainer:OLe,editorInput:TLe},M5=-1e3,wI={width:0,height:0,top:M5,left:M5},$Le=()=>{const[t,e]=b.useState({...wI}),n=b.useRef(null),r=_t(kn),i=_t(Cc);return b.useEffect(()=>{const o=n.current;if(!o)return;const s=r.currentRender$.pipe(tb(()=>{var a;const l=(a=r.getRenderById(Zr))==null?void 0:a.engine;return l==null||l.setContainer(o),i.state$})).subscribe(a=>{if(a==null)return;const{startX:l=M5,startY:u=M5,endX:c=0,endY:d=0,show:h=!1}=a;if(!h)e({...wI});else{e({width:c-l,height:d-u,left:l,top:u});const f=n.current;if(!f)return;const{left:m,top:p,width:g,height:v}=f.getBoundingClientRect();i.setRect({left:m,top:p,width:g,height:v})}});return()=>{s.unsubscribe()}},[]),b.useEffect(()=>{i.setFocus(!0)},[t]),F.jsx("div",{className:EI.editorContainer,style:{left:t.left,top:t.top,width:t.width,height:t.height},children:F.jsx("div",{className:EI.editorInput,ref:n})})},kLe="univer-formula-box",ALe="univer-name-ranges",NLe="univer-name-ranges-input",LLe="univer-formula-bar",PLe="univer-formula-icon",BLe="univer-formula-icon-wrapper",FLe="univer-icon-container",ULe="univer-icon-container-success",HLe="univer-formula-active",VLe="univer-icon-container-error",jLe="univer-formula-input",zLe="univer-formula-content",WLe="univer-arrow-container",_i={formulaBox:kLe,nameRanges:ALe,nameRangesInput:NLe,formulaBar:LLe,formulaIcon:PLe,formulaIconWrapper:BLe,iconContainer:FLe,iconContainerSuccess:ULe,formulaActive:HLe,iconContainerError:VLe,formulaInput:jLe,formulaContent:zLe,arrowContainer:WLe};function XLe(){const[t,e]=b.useState(_i.formulaGrey),[n,r]=b.useState(0),i=b.useRef(null),o=_t(kn),s=_t(W4),a=_t(Eo);b.useEffect(()=>{const h=i.current;if(!h)return;const f=o.currentRender$.subscribe(p=>{var g;if(p!==Un)return;const v=(g=o.getRenderById(Un))==null?void 0:g.engine;v==null||v.setContainer(h)}),m=new ResizeObserver(()=>{const p=h.getBoundingClientRect();s.setPosition(p)});return m.observe(h),a.visible$.subscribe(p=>{e(p.visible?_i.formulaActive:_i.formulaGrey)}),()=>{m.unobserve(h),f.unsubscribe()}},[]);function l(){r(n===0?1:0)}function u(){a.isVisible().visible&&a.changeVisible({visible:!1,eventType:Zn.Keyboard,keycode:Xe.ESC})}function c(){a.isVisible().visible&&a.changeVisible({visible:!1,eventType:Zn.PointerDown})}function d(){s.handleFxBtnClick(!0)}return F.jsxs("div",{className:_i.formulaBox,style:{height:n===0?"28px":"82px"},children:[F.jsx("div",{className:_i.nameRanges,children:F.jsx("div",{className:_i.nameRangesInput})}),F.jsxs("div",{className:_i.formulaBar,children:[F.jsx("div",{className:_i.formulaIcon,children:F.jsxs("div",{className:_i.formulaIconWrapper,children:[F.jsx("span",{className:wi(_i.iconContainer,_i.iconContainerError,t),onClick:u,children:F.jsx(f$e,{})}),F.jsx("span",{className:wi(_i.iconContainer,_i.iconContainerSuccess,t),onClick:c,children:F.jsx(D5,{})}),F.jsx("span",{className:_i.iconContainer,onClick:d,children:F.jsx(C$e,{})})]})}),F.jsxs("div",{className:_i.formulaInput,children:[F.jsx("div",{onContextMenu:h=>h.preventDefault(),className:_i.formulaContent,ref:i}),F.jsx("div",{className:_i.arrowContainer,onClick:l,children:n===0?F.jsx(QD,{}):F.jsx(QD,{style:{transform:"rotateZ(180deg)"}})})]})]})]})}const YLe="univer-operate-container",GLe="univer-auto-fill-popup-menu",KLe="univer-auto-fill-popup-menu-item",ZLe="univer-auto-fill-popup-menu-item-icon",qLe="univer-auto-fill-popup-menu-item-title",QLe="univer-auto-fill-popup-menu-item-hide",JLe="univer-btn-container",ePe="univer-btn-container-expand",Cu={operateContainer:YLe,autoFillPopupMenu:GLe,autoFillPopupMenuItem:KLe,autoFillPopupMenuItemIcon:ZLe,autoFillPopupMenuItemTitle:qLe,autoFillPopupMenuItemHide:QLe,btnContainer:JLe,btnContainerExpand:ePe},tPe=()=>{const[,t]=b.useState({});return b.useCallback(()=>t({}),[])},nPe=()=>{var t;const e=_t(le),n=_t(kr),r=_t(oe),i=_t(kn),o=_t(to),s=_t(A0),a=_t(mn),[l,u]=b.useState([]),[c,d]=b.useState(!1),[h,f]=b.useState({row:-1,col:-1}),[m,p]=b.useState(Mn.SERIES),[g,v]=b.useState(!1),_=()=>{v(!0)},C=()=>{v(!1)},y=tPe(),S=jo(r,i);if(S==null)return null;const{scene:E}=S;if(b.useEffect(()=>{const T=[$a.id,l8.id,Gl.id,Pt.id];return e.onCommandExecuted(P=>{if(P.id===C_.id){const{endColumn:K,endRow:ee}=(P==null?void 0:P.params).selectionRange;f({row:ee,col:K})}P.id===yf.id&&y(),T.includes(P.id)&&f({row:-1,col:-1})}).dispose},[y,e]),b.useEffect(()=>Be(s.menu$.subscribe(T=>{u(T.map(P=>({...P,index:T.indexOf(P)})))})).dispose,[s]),b.useEffect(()=>Be(s.applyType$.subscribe(T=>{p(T)})).dispose,[s]),b.useEffect(()=>{function T(){d(!1)}return document.addEventListener("wheel",T),()=>{document.removeEventListener("wheel",T)}},[c]),h.col<0||h.row<0)return null;const w=(t=n.getCurrent())==null?void 0:t.skeleton,R=o.getViewPort(),D=E==null?void 0:E.scaleX,I=E==null?void 0:E.scaleY,k=E==null?void 0:E.getScrollXY(R);if(!D||!E||!D||!I||!k)return null;const O=(w==null?void 0:w.getNoMergeCellPositionByIndex(h.row,h.col,D,I).endX)||0,$=(w==null?void 0:w.getNoMergeCellPositionByIndex(h.row,h.col,D,I).endY)||0,N=w==null?void 0:w.convertTransformToOffsetX(O,D,k),H=w==null?void 0:w.convertTransformToOffsetY($,I,k);if(N==null||H==null)return null;const X=T=>{d(T)},te=T=>{e.executeCommand(FF.id,{type:T.value})},z=c||g,A=l.filter(T=>!T.disable);return F.jsx("div",{onMouseEnter:_,onMouseLeave:C,style:{left:`${N+2}px`,top:`${H+2}px`,position:"absolute"},children:F.jsx(g1,{placement:"bottomLeft",trigger:["click"],overlay:F.jsx("ul",{className:Cu.autoFillPopupMenu,children:A.map(T=>F.jsxs("li",{onClick:()=>te(T),className:Cu.autoFillPopupMenuItem,children:[F.jsx("span",{className:Cu.autoFillPopupMenuItemIcon,children:T.value===m&&F.jsx(D5,{style:{color:"rgb(var(--green-700, #409f11))"}})}),F.jsx("span",{className:Cu.autoFillPopupMenuItemTitle,children:a.t(T.label)})]},T.index))}),visible:c,onVisibleChange:X,children:F.jsxs("div",{className:wi(Cu.btnContainer,{[Cu.btnContainerExpand]:c}),children:[F.jsx(c$e,{style:{color:"#35322B"},extend:{colorChannel1:"rgb(var(--green-700, #409f11))"}}),z&&F.jsx(I_,{style:{color:"#CCCCCC",fontSize:"8px",marginLeft:"8px"}})]})})})},rPe=()=>F.jsx("div",{className:Cu.operateContainer,children:F.jsx(nPe,{})}),iPe="univer-sheet-bar",oPe="univer-sheet-bar-options",sPe="univer-sheet-bar-options-divider",t3={sheetBar:iPe,sheetBarOptions:oPe,sheetBarOptionsDivider:sPe},aPe="univer-sheet-bar-btn",lPe={sheetBarBtn:aPe};function k8(t){const{children:e,className:n,style:r,disabled:i=!1,onClick:o,...s}=t,a=l=>{if(i){l.preventDefault();return}o&&o(l)};return F.jsx("button",{className:lPe.sheetBarBtn,style:r,disabled:i,onClick:a,...s,children:e})}const uPe="univer-sheet-bar-menu",cPe="univer-sheet-bar-menu-item",dPe="univer-sheet-bar-menu-item-icon",hPe="univer-sheet-bar-menu-item-hide",fPe="univer-sheet-bar-menu-item-select",mPe="univer-sheet-bar-menu-item-label",z1={sheetBarMenu:uPe,sheetBarMenuItem:cPe,sheetBarMenuItemIcon:dPe,sheetBarMenuItemHide:hPe,sheetBarMenuItemSelect:fPe,sheetBarMenuItemLabel:mPe};function pPe(t){const{style:e}=t,[n,r]=b.useState([]),[i,o]=b.useState(!1),s=_t(oe),a=_t(le),l=_t(B0),u=s.getCurrentUniverSheetInstance(),c=p=>{const{sheetId:g}=p;g&&(p.hidden?a.executeCommand(kB.id,{value:g}):p.selected||a.executeCommand(T0.id,{unitId:u.getUnitId(),subUnitId:g}),o(!1))};b.useEffect(()=>{h();const p=new Ia;return p.add(d()),p.add(l.registerSheetBarMenuHandler({handleSheetBarMenu:f})),()=>{p.dispose()}},[]);const d=()=>a.onCommandExecuted(p=>{switch(p.id){case zs.id:case Zs.id:case Y6.id:case ps.id:case T2.id:case ja.id:h();break}}),h=()=>{const p=u.getSheets().map((g,v)=>({label:g.getName(),index:`${v}`,sheetId:g.getSheetId(),hidden:g.isSheetHidden()===ke.TRUE,selected:g.getStatus()===ke.TRUE}));r(p)};function f(){o(!0)}const m=p=>{o(p)};return F.jsx(g1,{placement:"topLeft",trigger:["click"],overlay:F.jsx("ul",{className:z1.sheetBarMenu,style:{...e},children:n.map(p=>F.jsxs("li",{onClick:()=>c(p),className:p.selected?`${z1.sheetBarMenuItem} ${z1.sheetBarMenuItemSelect}`:p.hidden?`${z1.sheetBarMenuItem} ${z1.sheetBarMenuItemHide}`:z1.sheetBarMenuItem,children:[F.jsx("span",{className:z1.sheetBarMenuItemIcon,children:p.selected?F.jsx(D5,{}):p.hidden?F.jsx(_$e,{}):F.jsx(D5,{})}),F.jsx("span",{className:z1.sheetBarMenuItemLabel,children:p.label})]},p.index))}),visible:i,onVisibleChange:m,children:F.jsx(k8,{children:F.jsx(p$e,{})})})}const gPe="univer-slide-tab-bar-container",vPe="univer-slide-tab-bar",_Pe="univer-slide-tab-item",bPe="univer-slide-tab-active",CPe="univer-slide-tab-span",yPe="univer-slide-tab-span-edit",Os={slideTabBarContainer:gPe,slideTabBar:vPe,slideTabItem:_Pe,slideTabActive:bPe,slideTabSpan:CPe,slideTabSpanEdit:yPe};function SPe(t){const{sheetId:e,label:n,color:r,selected:i}=t,[o,s]=b.useState(!1),[a,l]=b.useState(i),u=_t(le),c=_t(Ki);b.useEffect(()=>{l(i)},[i]);const d=f=>{s(f)},h=f=>{const m=c.getCurrentTheme(),p=m.textColor,g=m.colorWhite;return new _o(f).isDark()?g:p};return F.jsx(g1,{visible:o,trigger:["contextMenu"],overlay:F.jsx(i5,{menuType:si.SHEET_BAR,onOptionSelect:f=>{const{label:m,value:p}=f;u.executeCommand(m,{value:p,subUnitId:e}),s(!1)}}),onVisibleChange:d,children:F.jsx("div",{"data-id":e,className:a?`${Os.slideTabActive} ${Os.slideTabItem}`:Os.slideTabItem,style:{backgroundColor:!a&&r?r:"",color:!a&&r?h(r):"",boxShadow:a&&r?`0px 0px 12px rgba(0, 0, 0, 0.2), inset 0px -2px 0px 0px ${r}`:""},children:F.jsx("span",{className:Os.slideTabSpan,children:n})},e)})}const EPe={easeOutStrong(t,e,n,r){return-n*((t=t/r-1)*t*t*t-1)+e},backOut(t,e,n,r,i){return typeof i>"u"&&(i=.7),n*((t=t/r-1)*t*((i+1)*t+i)+1)+e}},wPe={loop:!1,begin:0,end:0,duration:300,delay:0,type:"easeOutStrong",receive(t){},success(t){},cancel(t){},complete(t){}};class RPe{constructor(e){V(this,"_config"),V(this,"_status",0),V(this,"_start",0),V(this,"_handle",0),V(this,"_delayHandle",null),this._config={...wPe,...e},this._config.loop&&(this._config.complete=()=>{},this._config.success=()=>{this.request()})}static success(...e){let n=0;return new Promise(r=>{for(let i=0;i<e.length;i++){const o=e[i],s=o._config,a=s.success;s.loop||(s.success=l=>{n++,a&&a.call(o,l),n===e.length&&r()})}})}request(){this._config.delay===0?(this._status=0,this._start=Date.now(),this._fakeHandle()):(this._delayHandle&&clearTimeout(this._delayHandle),this._delayHandle=setTimeout(()=>{this._status=0,this._start=Date.now(),this._fakeHandle()},this._config.delay))}cancel(){this._status=1,this._delayHandle&&clearTimeout(this._delayHandle),cancelAnimationFrame(this._handle)}_fakeHandle(){let e=Date.now()-this._start;e=e>=this._config.duration?this._config.duration:e;const n=EPe[this._config.type](e,this._config.begin,this._config.end-this._config.begin,this._config.duration,.7).toFixed(2);if(this._config.receive(n),this._status===1){this._config.cancel(n),this._config.complete(n);return}if(e===this._config.duration){this._config.success(n),this._config.complete(n);return}this._handle=requestAnimationFrame(()=>{this._fakeHandle()})}}class Bu{constructor(e,n){V(this,"_slideTabItem"),V(this,"_animate"),V(this,"_midline",0),V(this,"_translateX"),V(this,"_scrollbar"),V(this,"_slideTabBar"),V(this,"_editMode"),V(this,"_placeholder"),this._slideTabItem=e,this._animate=null,this._translateX=0,this._editMode=!1,this._slideTabBar=n,this._placeholder=null,this._scrollbar=n.getScrollbar(),this.update()}static midline(e){return e.getBoundingRect().x+e.getBoundingRect().width/2}static leftLine(e){return e.getBoundingRect().x}static rightLine(e){return e.getBoundingRect().x+e.getBoundingRect().width}static make(e,n){const r=[];return e.forEach(i=>r.push(new Bu(i,n))),r}getSlideTabItem(){return this._slideTabItem}getEditor(){return this._slideTabItem.querySelector("span")}isEditMode(){return this._editMode}classList(){return this._slideTabItem.classList}translateX(e){return this._translateX=e,this._slideTabItem.style.transform=`translateX(${e}px)`,this.getTranslateXDirection()}setEditor(e){let n=!0;if(this._editMode===!1){const r=this._slideTabItem.querySelector("span"),i=u=>{if(!this.nameCheck()){if(this._editMode=!1,r&&(r.removeAttribute("contentEditable"),r.removeEventListener("blur",i),r.removeEventListener("compositionstart",s),r.removeEventListener("compositionend",a),r.removeEventListener("input",l),r.removeEventListener("keydown",o),r.classList.remove(this._slideTabBar.getConfig().slideTabBarSpanEditClassName)),this._slideTabBar.removeListener(),this._slideTabBar.updateItems(),this._slideTabBar.getConfig().onChangeName){const c=(r==null?void 0:r.innerText)||"",d=this.getId();this._slideTabBar.getConfig().onChangeName(d,c)}e&&e(u)}};let o=u=>{r&&(u.stopPropagation(),u.key==="Enter"&&r.blur())};const s=u=>{n=!1},a=u=>{n=!0},l=u=>{if(!r)return;const c=50;setTimeout(()=>{if(n){const d=r.innerText;d.length>c&&(r.innerText=d.substring(0,c),P_.keepLastIndex(r))}},0)};r&&(r.setAttribute("contentEditable","true"),r.addEventListener("blur",i),r.addEventListener("compositionstart",s),r.addEventListener("compositionend",a),r.addEventListener("input",l),r.addEventListener("keydown",o),r.classList.add(this._slideTabBar.getConfig().slideTabBarSpanEditClassName),this._editMode=!0,P_.keepSelectAll(r))}}nameCheck(){const e=this._slideTabItem.querySelector("span");if(!e)return!1;const n=e.innerText;return this._slideTabBar.getConfig().onNameCheckAlert(n)}animate(){return{translateX:e=>{this._translateX!==e&&(this._animate&&(this._animate.cancel(),this._animate=null),this._animate=new RPe({begin:this._translateX,end:e,receive:n=>{this._slideTabItem.style.transform=`translateX(${n}px)`}}),this._translateX=e,this._animate.request())},cancel:()=>{this._animate&&(this._animate.cancel(),this._animate=null)}}}after(e){this._slideTabItem.after(e._slideTabItem||e)}update(){this._midline=Bu.midline(this)}disableFixed(){if(this._placeholder){const e=this._slideTabBar.primeval();this._slideTabItem.style.removeProperty("position"),this._slideTabItem.style.removeProperty("left"),this._slideTabItem.style.removeProperty("top"),this._slideTabItem.style.removeProperty("width"),this._slideTabItem.style.removeProperty("height"),this._slideTabItem.style.removeProperty("background"),this._slideTabItem.style.removeProperty("padding"),this._slideTabItem.style.removeProperty("box-sizing"),this._slideTabItem.style.removeProperty("font-size"),this._slideTabItem.style.removeProperty("font-family"),this._slideTabItem.style.removeProperty("font-weight"),this._slideTabItem.style.removeProperty("color"),this._slideTabItem.style.removeProperty("border-radius"),this._placeholder.after(this._slideTabItem),e.removeChild(this._placeholder),this._placeholder=null}}enableFixed(){const e=document.createElement("div"),n=this.getBoundingRect(),r=getComputedStyle(this._slideTabItem),i=this._slideTabItem.querySelector("span");if(this._placeholder=e,this._placeholder.style.width=`${n.width}px`,this._placeholder.style.height=`${n.height}px`,this._placeholder.style.flexShrink="0",this._placeholder.style.margin=r.margin,this._slideTabItem.style.background=r.background,i){const o=getComputedStyle(i).padding;this._slideTabItem.style.padding=o}this._slideTabItem.style.boxSizing=r.boxSizing,this._slideTabItem.style.fontSize=r.fontSize,this._slideTabItem.style.fontFamily=r.fontFamily,this._slideTabItem.style.fontWeight=r.fontWeight,this._slideTabItem.style.color=r.color,this._slideTabItem.style.borderRadius=r.borderRadius,this._slideTabItem.style.left=`${n.x-this.getScrollbar().getScrollX()}px`,this._slideTabItem.style.top=`${n.y}px`,this._slideTabItem.style.width=`${n.width}px`,this._slideTabItem.style.height=`${n.height}px`,this._slideTabItem.style.position="fixed",this._slideTabItem.after(e),document.body.appendChild(this._slideTabItem)}addEventListener(e,n,r){this._slideTabItem.addEventListener(e,n,r)}removeEventListener(e,n,r){this._slideTabItem.removeEventListener(e,n,r)}getScrollbar(){return this._scrollbar}getMidLine(){return this._midline}getBoundingRect(){const e=this._slideTabItem.getBoundingClientRect();return e.x+=this._scrollbar.getScrollX(),e}getWidth(){return this.getBoundingRect().width}getTranslateXDirection(){const e=Bu.midline(this);return e>this._midline?1:e<this._midline?-1:0}equals(e){return e&&e._slideTabItem===this._slideTabItem}getId(){return this._slideTabItem.dataset.id||""}}class DPe{constructor(e){V(this,"_slideTabBar"),V(this,"_scrollX");const n=e.primeval();this._scrollX=n.scrollLeft,this._slideTabBar=e}scrollX(e){const n=this._slideTabBar.primeval();n.scrollLeft=e,this._scrollX=n.scrollLeft}scrollRight(){const e=this._slideTabBar.primeval();e.scrollLeft=e.scrollWidth,this._scrollX=e.scrollLeft}getScrollX(){return this._scrollX}}const N_=class L_{constructor(e){if(V(this,"_activeTabItemIndex",0),V(this,"_slideTabBar"),V(this,"_slideTabItems",[]),V(this,"_config"),V(this,"_downActionX",0),V(this,"_moveActionX",0),V(this,"_compareIndex",0),V(this,"_activeTabItem",null),V(this,"_moveAction"),V(this,"_upAction"),V(this,"_downAction"),V(this,"_wheelAction"),V(this,"_scrollIncremental",0),V(this,"_compareDirection",0),V(this,"_autoScrollTime",null),V(this,"_slideScrollbar"),V(this,"_longPressTimer",null),V(this,"_leftBoundingLine",0),V(this,"_rightBoundingLine",0),V(this,"_leftMoveX",0),V(this,"_rightMoveX",0),e.slideTabBarContainer==null)throw new Error("not found slide-tab-bar root element");const n=e.slideTabBarContainer.querySelector(`.${e.slideTabBarClassName??"slide-tab-bar"}`);if(n==null)throw new Error("not found slide-tab-bar");this._slideTabBar=n,this._slideScrollbar=new DPe(this),this._config=e,this._initConfig();let r=0,i=0,o=0;this._downAction=s=>{var a,l,u,c,d,h;if((a=this._activeTabItem)!=null&&a.isEditMode())return;const f=(u=(l=s.target)==null?void 0:l.closest(`.${e.slideTabBarItemClassName}`))==null?void 0:u.getAttribute("data-id"),m=this._slideTabItems.findIndex(k=>k.getId()===f);if(f==null||m===-1)return;if(this._activeTabItemIndex!==m){(c=this._activeTabItem)==null||c.removeEventListener("pointermove",this._moveAction),(d=this._activeTabItem)==null||d.removeEventListener("pointerup",this._upAction),this.removeListener(),this._config.onChangeTab(s,f);return}if(this._compareIndex=m,this._downActionX=s.pageX,this._moveActionX=0,this._scrollIncremental=0,this._activeTabItem=this._slideTabItems[m],!this._activeTabItem){console.error("Not found active slide-tab-item in sheet bar");return}const p=this._activeTabItem.getSlideTabItem();p==null||p.setPointerCapture(s.pointerId),(h=this._activeTabItem)==null||h.addEventListener("pointerup",this._upAction);const{x:g,width:v}=this._activeTabItem.getBoundingRect(),{x:_,width:C}=this.getBoundingRect(),y=this._slideScrollbar.getScrollX();if(this._leftBoundingLine=this._downActionX-(g-y),this._rightBoundingLine=g-y+v-this._downActionX,this._leftMoveX=g-_-y,this._rightMoveX=_+C-(g+v)+y,s.button===2||this._hasEditItem())return;const{pageX:S,pageY:E}=s,w=Date.now(),R=w-o<=L_.DoubleClickDelay,D=Math.abs(S-r)<10,I=Math.abs(E-i)<10;R&&D&&I&&this._activeTabItem.setEditor(),r=S,i=E,o=w,this._longPressTimer=setTimeout(()=>{var k,O;(k=this._activeTabItem)==null||k.enableFixed(),this._startAutoScroll(),p&&(p.setPointerCapture(s.pointerId),p.style.cursor="move",(O=this._activeTabItem)==null||O.addEventListener("pointermove",this._moveAction))},L_.LongPressDelay)},this._upAction=s=>{var a,l,u;if(this._longPressTimer&&(clearTimeout(this._longPressTimer),this._longPressTimer=null),!this._activeTabItem)return;this._closeAutoScroll(),this._activeTabItem.disableFixed(),this.updateItems();const c=(a=this._activeTabItem)==null?void 0:a.getSlideTabItem();c&&(c.style.cursor="",c.releasePointerCapture(s.pointerId),(l=this._activeTabItem)==null||l.removeEventListener("pointermove",this._moveAction),(u=this._activeTabItem)==null||u.removeEventListener("pointerup",this._upAction),this._config.onSlideEnd&&this._activeTabItemIndex!==this._compareIndex&&(this.removeListener(),this._config.onSlideEnd(s,this._compareIndex||0)),this._scrollIncremental=0,this._downActionX=0,this._moveActionX=0,this._compareIndex=0)},this._moveAction=s=>{this._activeTabItem&&(this._moveActionX=s.pageX-this._downActionX,this._moveActionX<=-this._leftMoveX?this._moveActionX=-this._leftMoveX:this._moveActionX>=this._rightMoveX&&(this._moveActionX=this._rightMoveX),this._scrollIncremental=0,this._scrollLeft(s),this._scrollRight(s))},this._wheelAction=s=>{this.setScroll(s.deltaY)},this.addListener()}static checkedSkipSlide(e){let n=e.target;for(;n!=null&&n!==document.body;){if(n.getAttribute("data-slide-skip"))return!0;n=n.parentElement}return!1}static keepLastIndex(e){setTimeout(()=>{const n=window.getSelection();n&&(n.selectAllChildren(e),n.collapseToEnd())})}static keepSelectAll(e){setTimeout(()=>{const n=window.getSelection();if(!n)return;const r=document.createRange();r.selectNodeContents(e),n.removeAllRanges(),n.addRange(r)})}update(e){this._config.currentIndex=e,this._initConfig(),this.removeListener(),this.addListener()}primeval(){return this._slideTabBar}updateItems(){for(let e=0;e<this._slideTabItems.length;e++)this._slideTabItems[e].animate().cancel(),this._slideTabItems[e].translateX(0),this._slideTabItems[e].update()}getScrollbar(){return this._slideScrollbar}getConfig(){return this._config}getBoundingRect(){return this._slideTabBar.getBoundingClientRect()}getSlideTabItems(){return this._slideTabItems}getActiveItem(){return this._activeTabItem}isLeftEnd(){return this._slideTabBar.scrollLeft===0}isRightEnd(){const e=this._slideTabBar.parentElement;return e?this._slideTabBar.scrollWidth-e.clientWidth===this._slideTabBar.scrollLeft:!1}addListener(){this._slideTabBar.addEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(e=>{e.addEventListener("pointerdown",this._downAction)})}removeListener(){this._slideTabBar.removeEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(e=>{e.removeEventListener("pointerdown",this._downAction)})}setScroll(e){if(this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+e),e>0){const n=this.calculateLeftScrollX();this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+n)}else if(e<0){const n=this.calculateRightScrollX();this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+n)}this._config.onScroll({leftEnd:this.isLeftEnd(),rightEnd:this.isRightEnd()})}flipPage(e){if(e>0){const n=this.calculateLeftScrollX(!0);this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+n)}else if(e<0){const n=this.calculateRightScrollX(!0);this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+n)}this._config.onScroll({leftEnd:this.isLeftEnd(),rightEnd:this.isRightEnd()})}calculateLeftScrollX(e){let n=0;const r=4;return this._slideTabItems.some(i=>{const o=this._slideTabBar.getBoundingClientRect(),s=o.left+o.width,a=i.getSlideTabItem().getBoundingClientRect(),l=a.left,u=a.width;return l<s&&l+u+r*2>s?(n=e?l-o.left-r:l+u-s+r,!0):!1}),n}calculateRightScrollX(e){let n=0;const r=4;return this._slideTabItems.some(i=>{const o=this._slideTabBar.getBoundingClientRect(),s=o.left,a=i.getSlideTabItem().getBoundingClientRect(),l=a.left,u=a.width;return l-r*2<s&&l+u>s?(n=e?l+u-o.left-o.width+r:l-s-r,!0):!1}),n}destroy(){this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._slideTabItems=[],this._activeTabItem=null,this.removeListener()}_hasEditItem(){for(let e=0;e<this._slideTabItems.length;e++)if(this._slideTabItems[e].isEditMode())return!0;return!1}_autoScrollFrame(){if(this._activeTabItem)switch(this._compareDirection=this._activeTabItem.translateX(this._moveActionX),this._compareDirection){case 1:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareRight();break}case 0:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareIndex=this._activeTabItemIndex;break}case-1:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareLeft();break}}this._autoScrollTime=requestAnimationFrame(()=>{this._autoScrollFrame()})}_startAutoScroll(){this._autoScrollTime==null&&this._autoScrollFrame()}_closeAutoScroll(){this._autoScrollTime&&cancelAnimationFrame(this._autoScrollTime),this._autoScrollTime=null}_scrollLeft(e){const n=this.getBoundingRect(),r=e.pageX-n.x;r<this._leftBoundingLine&&(this._scrollIncremental=-Math.min(Math.abs(r-this._leftBoundingLine)*.1,50))}_scrollRight(e){const n=this.getBoundingRect(),r=e.pageX-n.x;r>n.width-this._rightBoundingLine&&(this._scrollIncremental=Math.min(Math.abs(r-(n.width-this._rightBoundingLine))*.1,50))}_sortedItems(){if(this._activeTabItem!=null&&this._activeTabItemIndex!=null&&this._compareIndex!=null&&(this._slideTabItems.splice(this._activeTabItemIndex,1),this._slideTabItems.splice(this._compareIndex,0,this._activeTabItem),this._config.slideTabBarItemAutoSort))for(let e=0;e<this._slideTabItems.length;e++){const n=this._slideTabItems[e],r=this._slideTabItems[e+1];r&&n.after(r)}}_compareLeft(){if(this._activeTabItem&&this._activeTabItemIndex){const e=this._slideTabItems.findIndex(o=>o.equals(this._activeTabItem)),n=this._slideTabItems.length,r=[];for(let o=0;o<e&&!(o>=e);o++)r.push(this._slideTabItems[o]);for(let o=e+1;o<n;o++)this._slideTabItems[o].animate().translateX(0);let i=!0;for(let o=r.length-1;o>=0;o--){const s=r[o];Bu.leftLine(this._activeTabItem)<s.getMidLine()?(s.animate().translateX(this._activeTabItem.getWidth()),this._compareIndex=o,i=!1):(s.animate().translateX(0),i&&(this._compareIndex=this._activeTabItemIndex))}}}_compareRight(){if(this._activeTabItem){const e=this._slideTabItems.findIndex(o=>o.equals(this._activeTabItem)),n=this._slideTabItems.length,r=[];for(let o=e+1;o<n;o++)r.push(this._slideTabItems[o]);for(let o=0;o<e;o++)this._slideTabItems[o].animate().translateX(0);let i=!0;for(let o=0;o<r.length;o++){const s=r[o];Bu.rightLine(this._activeTabItem)>s.getMidLine()?(s.animate().translateX(-this._activeTabItem.getWidth()),this._compareIndex=e+o+1,i=!1):(s.animate().translateX(0),i&&(this._compareIndex=this._activeTabItemIndex))}}}_initConfig(){const e=this._slideTabBar.querySelectorAll(`.${this._config.slideTabBarItemClassName??"slide-tab-item"}`);this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._slideTabItems=Bu.make(e,this),this._activeTabItemIndex=this._config.currentIndex,this._activeTabItem=this._slideTabItems[this._activeTabItemIndex]}};V(N_,"LongPressDelay",500),V(N_,"DoubleClickDelay",300);let P_=N_;function IPe(){const[t,e]=b.useState([]),[n,r]=b.useState(""),[i,o]=b.useState(""),s=b.useRef({slideTabBar:null}),a=b.useRef(null),l=_t(oe),u=_t(le),c=_t(B0),d=_t(mn),h=_t(R4),f=l.getCurrentUniverSheetInstance();b.useEffect(()=>{S();const $=m(),N=y(),H=[E(),w(),R(),D()];return()=>{N.dispose(),$.destroy(),H.forEach(X=>X.unsubscribe())}},[]),b.useEffect(()=>{t.length>0&&C()},[t]);const m=()=>{const $=new P_({slideTabBarClassName:Os.slideTabBar,slideTabBarItemActiveClassName:Os.slideTabActive,slideTabBarItemClassName:Os.slideTabItem,slideTabBarSpanEditClassName:Os.slideTabSpanEdit,slideTabBarItemAutoSort:!0,slideTabBarContainer:a.current,currentIndex:0,onChangeName:(N,H)=>{u.executeCommand(_f.id,{subUnitId:N,name:H})},onSlideEnd:(N,H)=>{u.executeCommand(OB.id,{order:H})},onChangeTab:(N,H)=>{u.executeCommand(T0.id,{subUnitId:H,unitId:f.getUnitId()})},onScroll:N=>{c.setScroll(N)},onNameCheckAlert:N=>p(N)||g(N)});return s.current.slideTabBar=$,O($),$},p=$=>{if($.trim()===""){const N="sheetNameEmptyAlert";return h.open({id:N,title:{title:d.t("sheetConfig.sheetNameErrorTitle")},children:{title:d.t("sheetConfig.sheetNameCannotIsEmptyError")},cancelText:d.t("button.cancel"),confirmText:d.t("button.confirm"),onClose(){h.close(N),v()},onConfirm(){h.close(N),v()}}),!0}return!1},g=$=>{const N=l.getCurrentUniverSheetInstance();if(N.getActiveSheet().getName()===$)return!1;const H=N.checkSheetName($);if(H){const X="sheetNameRepeatAlert";h.open({id:X,title:{title:d.t("sheetConfig.sheetNameErrorTitle")},children:{title:d.t("sheetConfig.sheetNameAlreadyExistsError")},cancelText:d.t("button.cancel"),confirmText:d.t("button.confirm"),onClose(){h.close(X),_()},onConfirm(){h.close(X),_()}})}return H},v=()=>{var $,N;const H=(N=($=s.current.slideTabBar)==null?void 0:$.getActiveItem())==null?void 0:N.getEditor();H&&H.focus()},_=()=>{var $,N;(N=($=s.current.slideTabBar)==null?void 0:$.getActiveItem())==null||N.setEditor()},C=()=>{var $;const N=t.findIndex(H=>H.selected);($=s.current.slideTabBar)==null||$.update(N)},y=()=>u.onCommandExecuted($=>{switch($.id){case r6.id:case zs.id:case Zs.id:case Y6.id:case ps.id:case T2.id:case ja.id:S();break}}),S=()=>{const $=f.getActiveSheet().getSheetId();r($);const N=f.getSheets().filter(H=>!H.isSheetHidden()).map((H,X)=>({sheetId:H.getSheetId(),label:H.getName(),index:X,selected:H.getStatus()===ke.TRUE,color:H.getTabColor()??void 0}));e(N)},E=()=>c.scroll$.subscribe($=>{I($)}),w=()=>c.scrollX$.subscribe($=>{var N;(N=s.current.slideTabBar)==null||N.flipPage($)}),R=()=>c.renameId$.subscribe(()=>{_()}),D=()=>c.addSheet$.subscribe(()=>{var $;($=s.current.slideTabBar)==null||$.getScrollbar().scrollRight()}),I=$=>{const{leftEnd:N,rightEnd:H}=$;let X="";N&&H?X="":N&&!H?X="inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)":!N&&H?X="inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2)":!N&&!H&&(X="inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2), inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)"),o(X)},k=$=>{c.setScroll({leftEnd:$.isLeftEnd(),rightEnd:$.isRightEnd()})},O=$=>{var N;const H=(N=a.current)==null?void 0:N.querySelector(`.${Os.slideTabBar}`);H&&new ResizeObserver(()=>{k($)}).observe(H)};return F.jsx("div",{className:Os.slideTabBarContainer,ref:a,children:F.jsx("div",{className:Os.slideTabBar,style:{boxShadow:i},children:t.map($=>b.createElement(SPe,{...$,key:$.sheetId,selected:n===$.sheetId}))})})}const RI=100,xPe=()=>{const[t,e]=b.useState(!0),[n,r]=b.useState(!0),i=_t(le),o=_t(B0);b.useEffect(()=>{const c=o.scroll$.subscribe(d=>{s(d)});return()=>{c.unsubscribe()}},[]);const s=c=>{const{leftEnd:d,rightEnd:h}=c;e(d),r(h)},a=()=>{i.executeCommand(aB.id),setTimeout(()=>{o.setAddSheet(0)},0)},l=()=>{o.setScrollX(-RI)},u=()=>{o.setScrollX(RI)};return F.jsxs("div",{className:t3.sheetBar,children:[F.jsxs("div",{className:t3.sheetBarOptions,children:[F.jsx(k8,{onClick:a,children:F.jsx(S$e,{})}),F.jsx(pPe,{})]}),F.jsx(IPe,{}),(!t||!n)&&F.jsxs("div",{className:`${t3.sheetBarOptions} ${t3.sheetBarOptionsDivider}`,children:[F.jsx(k8,{disabled:t,onClick:l,children:F.jsx(JD,{style:{transform:"rotateZ(180deg)"}})}),F.jsx(k8,{disabled:n,onClick:u,children:F.jsx(JD,{})})]})]})};class MPe{constructor(){V(this,"_functions",[{func:Vn.MAX,filter:e=>{var n,r;return(((n=e.find(i=>i.func===Vn.COUNTA))==null?void 0:n.value)??0)>1&&(((r=e.find(i=>i.func===Vn.COUNT))==null?void 0:r.value)??0)>0}},{func:Vn.MIN,filter:e=>{var n,r;return(((n=e.find(i=>i.func===Vn.COUNTA))==null?void 0:n.value)??0)>1&&(((r=e.find(i=>i.func===Vn.COUNT))==null?void 0:r.value)??0)>0}},{func:ci.SUM,filter:e=>{var n,r;return(((n=e.find(i=>i.func===Vn.COUNTA))==null?void 0:n.value)??0)>1&&(((r=e.find(i=>i.func===Vn.COUNT))==null?void 0:r.value)??0)>0}},{func:Vn.COUNTA,filter:e=>{var n;return(((n=e.find(r=>r.func===Vn.COUNTA))==null?void 0:n.value)??0)>1}},{func:Vn.COUNT,filter:e=>{var n,r;return(((n=e.find(i=>i.func===Vn.COUNTA))==null?void 0:n.value)??0)>1&&(((r=e.find(i=>i.func===Vn.COUNT))==null?void 0:r.value)??0)>0}},{func:Vn.AVERAGE,filter:e=>{var n,r;return(((n=e.find(i=>i.func===Vn.COUNTA))==null?void 0:n.value)??0)>1&&(((r=e.find(i=>i.func===Vn.COUNT))==null?void 0:r.value)??0)>0}}]),V(this,"_state$",new rn(null)),V(this,"state$",this._state$.asObservable())}dispose(){this._state$.complete()}setState(e){const n=[];e==null||e.forEach(r=>{const i=this._functions.find(o=>o.func===r.func);i&&(i.filter===void 0||i.filter(e))&&n.push(r)}),this._state$.next(n)}getState(){return this._state$.getValue()}getFunctions(){return this._functions}addFunctions(e){this._functions.push(...e)}}const Uy=nn("univer.sheet-status-bar.service"),OPe="univer-status-bar",TPe="univer-single-mode",$Pe="univer-status-bar-div",kPe="univer-statistic-list",APe="univer-statistic-list-column",NPe="univer-statistic-item",LPe="univer-statistic-picker",PPe="univer-statistic-picker-item",BPe="univer-statistic-more",Jc={statusBar:OPe,singleMode:TPe,statusBarDiv:$Pe,statisticList:kPe,statisticListColumn:APe,statisticItem:NPe,statisticPicker:LPe,statisticPickerItem:PPe,statisticMore:BPe},DI={[ci.SUM]:"statusbar.sum",[Vn.AVERAGE]:"statusbar.average",[Vn.MIN]:"statusbar.min",[Vn.MAX]:"statusbar.max",[Vn.COUNT]:"statusbar.count",[Vn.COUNTA]:"statusbar.countA",[uf.CONCATENATE]:"concatenate"},wp=t=>{const e=_t(mn),n=_t(w4),r=_t(D4),i=FPe(t.value),o=async()=>{await r.writeText(t.value.toString()),n.show({type:T9.Success,content:e.t("statusbar.copied")})};return F.jsx(p4,{title:e.t("statusbar.clickToCopy"),placement:"top",children:F.jsx("div",{className:Jc.statisticItem,onClick:o,children:F.jsx("span",{children:`${e.t((DI==null?void 0:DI[t.name])||t.name)}: ${i}`})},t.name)})};function FPe(t){return typeof t!="number"?"Invalid input":t>=1e8?t.toExponential(2):t.toLocaleString()}const II=800,UPe=3,HPe=()=>{const[t,e]=b.useState(window.innerWidth<II),[n,r]=b.useState(!0),i=_t(Uy),o=i.getFunctions().map((h,f)=>({name:h.func,value:0,show:!0,disable:!1})),[s,a]=b.useState(o),l=s.find(h=>h.show&&!h.disable),u=t&&l?[l]:s.filter(h=>h.show&&!h.disable);b.useEffect(()=>{const h=i.state$.subscribe(f=>{if(!f||f.length===0)r(!1);else{r(!0);const m=s.map(p=>{const g=f.find(v=>v.func===p.name);return g?(p.value=g.value,p.disable=!1):p.disable=!0,p});a(m)}});return()=>{h.unsubscribe()}},[i]);const c=VPe(()=>{const h=window.innerWidth<II;t!==h&&e(h)},100);b.useEffect(()=>(window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}),[t]);let d=null;if(u.length>UPe){const h=[];u.forEach((f,m)=>{m%2===0&&h.push(u.slice(m,m+2))}),d=F.jsxs(F.Fragment,{children:[" ",h.map((f,m)=>F.jsxs("div",{className:Jc.statisticListColumn,children:[(f==null?void 0:f[0])&&F.jsx(wp,{...f==null?void 0:f[0]},f==null?void 0:f[0].name),(f==null?void 0:f[1])&&F.jsx(wp,{...f==null?void 0:f[1]},f==null?void 0:f[1].name)]},`stat-col-${m}`))," "]})}else d=F.jsx(F.Fragment,{children:u.map(h=>F.jsx(wp,{...h},h.name))});return n&&F.jsxs("div",{className:wi(Jc.statusBar,{[Jc.singleMode]:t}),children:[F.jsx("div",{className:wi(Jc.statisticList),children:d}),F.jsx("div",{className:Jc.statusBarDiv})]})};function VPe(t,e){let n;return function(...r){const i=this,o=function(){n=null,t.apply(i,r)};clearTimeout(n),n=setTimeout(o,e)}}function jPe(){return F.jsxs("section",{className:AF.sheetContainer,"data-range-selector":!0,children:[F.jsx(xPe,{}),F.jsx(HPe,{}),F.jsx(MLe,{})]})}function zPe(){return F.jsx(F.Fragment,{children:F.jsx(XLe,{})})}function WPe(){return F.jsxs(F.Fragment,{children:[F.jsx($Le,{}),F.jsx(rPe,{})]})}function XPe(t){const e=t.get(Nl);return{id:m_.id,icon:new tn(n=>{const r="AllBorderSingle",i=t.get(Nl),o=t.get(le).onCommandExecuted(s=>{if(s.id!==m_.id)return;const{type:a}=i.getBorderInfo(),l=zF.find(c=>c.value===a),u=(l==null?void 0:l.icon)??r;n.next(u)});return n.next(r),o.dispose}),group:un.TOOLBAR_FORMAT,tooltip:"toolbar.border.main",positions:[yn.TOOLBAR_START],type:gt.BUTTON_SELECTOR,selections:[{label:{name:jF,hoverable:!1},value$:e.borderInfo$}],value$:e.borderInfo$,hidden$:jr(t,Pr.SHEET)}}const If="sheet.menu.clear-selection";function YPe(){return{id:If,group:un.CONTEXT_MENU_FORMAT,type:gt.SUBITEMS,icon:"ClearFormat",title:"rightClick.clearSelection",positions:[yn.CONTEXT_MENU,si.COL_HEADER_CONTEXT_MENU,si.ROW_HEADER_CONTEXT_MENU]}}function GPe(){return{id:hf.id,type:gt.BUTTON,title:"rightClick.clearContent",positions:[If]}}function KPe(){return{id:N4.id,type:gt.BUTTON,title:"rightClick.clearFormat",positions:[If]}}function ZPe(){return{id:A4.id,type:gt.BUTTON,title:"rightClick.clearAll",positions:[If]}}const X4="sheet.menu.delete";function qPe(){return{id:X4,group:un.CONTEXT_MENU_LAYOUT,type:gt.SUBITEMS,title:"rightClick.delete",icon:"Reduce",positions:[yn.CONTEXT_MENU]}}function QPe(){return{id:O0.id,group:un.CONTEXT_MENU_LAYOUT,type:gt.BUTTON,icon:"DeleteColumn",positions:[X4,si.COL_HEADER_CONTEXT_MENU],title:"rightClick.deleteSelectedColumn"}}function JPe(){return{id:M0.id,group:un.CONTEXT_MENU_LAYOUT,type:gt.BUTTON,icon:"DeleteRow",positions:[X4,si.ROW_HEADER_CONTEXT_MENU],title:"rightClick.deleteSelectedRow"}}function eBe(){return{id:R0.id,group:un.CONTEXT_MENU_LAYOUT,type:gt.BUTTON,title:"rightClick.moveLeft",icon:"DeleteCellShiftLeft",positions:[X4]}}function tBe(){return{id:D0.id,group:un.CONTEXT_MENU_LAYOUT,type:gt.BUTTON,title:"rightClick.moveUp",icon:"DeleteCellShiftUp",positions:[X4]}}const Hy="sheet.menu.col-insert";function nBe(){return{id:Hy,group:un.CONTEXT_MENU_LAYOUT,type:gt.SUBITEMS,title:"rightClick.insert",icon:"Insert",positions:[si.COL_HEADER_CONTEXT_MENU]}}const Vy="sheet.menu.row-insert";function rBe(){return{id:Vy,group:un.CONTEXT_MENU_LAYOUT,type:gt.SUBITEMS,title:"rightClick.insert",icon:"Insert",positions:[si.ROW_HEADER_CONTEXT_MENU]}}const Y4="sheet.menu.cell-insert";function iBe(){return{id:Y4,group:un.CONTEXT_MENU_LAYOUT,type:gt.SUBITEMS,title:"rightClick.insert",icon:"Insert",positions:[yn.CONTEXT_MENU]}}function oBe(t){const e=t.get(ut);return{id:nB.id,type:gt.BUTTON,title:"rightClick.insertRowBefore",icon:"InsertRowAbove",positions:[Vy,Y4],hidden$:new tn(n=>{const r=e.getSelections();n.next((r==null?void 0:r.length)!==1)})}}function sBe(t){const e=t.get(ut);return{id:rB.id,type:gt.BUTTON,positions:[Vy],title:"rightClick.insertRow",icon:"InsertRowBelow",hidden$:new tn(n=>{const r=e.getSelections();n.next((r==null?void 0:r.length)!==1)})}}function aBe(t){const e=t.get(ut);return{id:oB.id,type:gt.BUTTON,positions:[Hy,Y4],title:"rightClick.insertColumnBefore",icon:"LeftInsertColumn",hidden$:new tn(n=>{const r=e.getSelections();n.next((r==null?void 0:r.length)!==1)})}}function lBe(t){const e=t.get(ut);return{id:sB.id,type:gt.BUTTON,positions:[Hy],title:"rightClick.insertColumn",icon:"RightInsertColumn",hidden$:new tn(n=>{const r=e.getSelections();n.next((r==null?void 0:r.length)!==1)})}}function uBe(){return{id:x0.id,type:gt.BUTTON,title:"rightClick.moveRight",icon:"InsertCellShiftRight",positions:[Y4]}}function cBe(){return{id:I0.id,type:gt.BUTTON,title:"rightClick.moveDown",icon:"InsertCellDown",positions:[Y4]}}function dBe(t){return{id:M1.id,icon:"MergeAllSingle",tooltip:"toolbar.mergeCell.main",positions:[yn.TOOLBAR_START],group:un.TOOLBAR_LAYOUT,type:gt.SUBITEMS,hidden$:jr(t,Pr.SHEET)}}function hBe(t){return{id:LF.id,type:gt.BUTTON,title:"merge.all",icon:"MergeAllSingle",positions:[M1.id]}}function fBe(t){return{id:PF.id,type:gt.BUTTON,title:"merge.vertical",icon:"VerticalIntegrationSingle",positions:[M1.id]}}function mBe(t){return{id:BF.id,type:gt.BUTTON,title:"merge.horizontal",icon:"HorizontalMergeSingle",positions:[M1.id]}}function pBe(t){return{id:dB.id,type:gt.BUTTON,title:"merge.cancel",icon:"CancelMergeSingle",positions:[M1.id]}}function gBe(){return{id:UF.id,type:gt.BUTTON,positions:[si.SHEET_BAR],title:"sheetConfig.delete"}}function vBe(){return{id:KP.id,type:gt.BUTTON,positions:[si.SHEET_BAR],title:"sheetConfig.copy"}}function _Be(){return{id:VF.id,type:gt.BUTTON,positions:[si.SHEET_BAR],title:"sheetConfig.rename"}}function bBe(){return{id:DB.id,title:"sheetConfig.changeColor",positions:[si.SHEET_BAR],type:gt.SELECTOR,selections:[{label:{name:Rf,hoverable:!1}}]}}function CBe(){return{id:MB.id,type:gt.BUTTON,positions:[si.SHEET_BAR],title:"sheetConfig.hide"}}function yBe(){return{id:HF.id,type:gt.BUTTON,positions:[si.SHEET_BAR],title:"sheetConfig.unhide"}}const SBe={id:yy.id,preconditions:t=>qn(t),binding:Xe.Digit9|Ut.CTRL_COMMAND},EBe={id:by.id,preconditions:t=>qn(t),binding:Xe.Digit0|Ut.CTRL_COMMAND|Ut.SHIFT},wBe={id:Yi.id,description:"shortcut.sheet.select-below-cell",group:"3_sheet-view",binding:Xe.ARROW_DOWN,priority:100,preconditions:qn,staticParameters:{direction:ge.DOWN}},RBe={id:Yi.id,description:"shortcut.sheet.select-up-cell",group:"3_sheet-view",binding:Xe.ARROW_UP,priority:100,preconditions:qn,staticParameters:{direction:ge.UP}},DBe={id:Yi.id,description:"shortcut.sheet.select-left-cell",group:"3_sheet-view",binding:Xe.ARROW_LEFT,priority:100,preconditions:qn,staticParameters:{direction:ge.LEFT}},IBe={id:Yi.id,description:"shortcut.sheet.select-right-cell",group:"3_sheet-view",binding:Xe.ARROW_RIGHT,priority:100,preconditions:qn,staticParameters:{direction:ge.RIGHT}},xBe={id:bc.id,description:"shortcut.sheet.select-next-cell",group:"3_sheet-view",binding:Xe.TAB,priority:100,preconditions:qn,staticParameters:{direction:ge.RIGHT,keycode:Xe.TAB}},MBe={id:bc.id,description:"shortcut.sheet.select-previous-cell",group:"3_sheet-view",binding:Xe.TAB|Ut.SHIFT,priority:100,preconditions:qn,staticParameters:{direction:ge.LEFT,keycode:Xe.TAB}},OBe={id:bc.id,description:"shortcut.sheet.select-below-cell",group:"3_sheet-view",binding:Xe.ENTER,priority:100,preconditions:qn,staticParameters:{direction:ge.DOWN,keycode:Xe.ENTER}},TBe={id:bc.id,description:"shortcut.sheet.select-up-cell",group:"3_sheet-view",binding:Xe.ENTER|Ut.SHIFT,priority:100,preconditions:qn,staticParameters:{direction:ge.UP,keycode:Xe.ENTER}},$Be={id:Yi.id,description:"shortcut.sheet.select-below-value-cell",group:"3_sheet-view",binding:Xe.ARROW_DOWN|Ut.CTRL_COMMAND,preconditions:qn,staticParameters:{direction:ge.DOWN,jumpOver:Qs.moveGap}},kBe={id:Yi.id,description:"shortcut.sheet.select-up-value-cell",group:"3_sheet-view",binding:Xe.ARROW_UP|Ut.CTRL_COMMAND,preconditions:qn,staticParameters:{direction:ge.UP,jumpOver:Qs.moveGap}},ABe={id:Yi.id,description:"shortcut.sheet.select-left-value-cell",group:"3_sheet-view",binding:Xe.ARROW_LEFT|Ut.CTRL_COMMAND,preconditions:qn,staticParameters:{direction:ge.LEFT,jumpOver:Qs.moveGap}},NBe={id:Yi.id,description:"shortcut.sheet.select-right-value-cell",group:"3_sheet-view",binding:Xe.ARROW_RIGHT|Ut.CTRL_COMMAND,preconditions:qn,staticParameters:{direction:ge.RIGHT,jumpOver:Qs.moveGap}},LBe={id:Js.id,description:"shortcut.sheet.expand-selection-down",group:"3_sheet-view",binding:Xe.ARROW_DOWN|Ut.SHIFT,preconditions:qn,staticParameters:{direction:ge.DOWN}},PBe={id:Js.id,description:"shortcut.sheet.expand-selection-up",group:"3_sheet-view",binding:Xe.ARROW_UP|Ut.SHIFT,preconditions:qn,staticParameters:{direction:ge.UP}},BBe={id:Js.id,description:"shortcut.sheet.expand-selection-left",group:"3_sheet-view",binding:Xe.ARROW_LEFT|Ut.SHIFT,preconditions:qn,staticParameters:{direction:ge.LEFT}},FBe={id:Js.id,description:"shortcut.sheet.expand-selection-right",group:"3_sheet-view",binding:Xe.ARROW_RIGHT|Ut.SHIFT,preconditions:qn,staticParameters:{direction:ge.RIGHT}},UBe={id:Js.id,description:"shortcut.sheet.expand-selection-to-below-gap",group:"3_sheet-view",binding:Xe.ARROW_DOWN|Ut.SHIFT|Ut.CTRL_COMMAND,preconditions:qn,staticParameters:{direction:ge.DOWN,jumpOver:Qs.moveGap}},HBe={id:Js.id,description:"shortcut.sheet.expand-selection-to-up-gap",group:"3_sheet-view",binding:Xe.ARROW_UP|Ut.SHIFT|Ut.CTRL_COMMAND,preconditions:qn,staticParameters:{direction:ge.UP,jumpOver:Qs.moveGap}},VBe={id:Js.id,description:"shortcut.sheet.expand-selection-to-left-gap",group:"3_sheet-view",binding:Xe.ARROW_LEFT|Ut.SHIFT|Ut.CTRL_COMMAND,preconditions:qn,staticParameters:{direction:ge.LEFT,jumpOver:Qs.moveGap}},jBe={id:Js.id,description:"shortcut.sheet.expand-selection-to-right-gap",group:"3_sheet-view",binding:Xe.ARROW_RIGHT|Ut.SHIFT|Ut.CTRL_COMMAND,preconditions:qn,staticParameters:{direction:ge.RIGHT,jumpOver:Qs.moveGap}},zBe={id:eF.id,description:"shortcut.sheet.select-all",group:"3_sheet-view",binding:Xe.A|Ut.CTRL_COMMAND,preconditions:qn,staticParameters:{expandToGapFirst:!0,loop:!0}},WBe={id:Ty.id,description:"shortcut.sheet.set-bold",group:"4_sheet-edit",preconditions:t=>qn(t),binding:Xe.B|Ut.CTRL_COMMAND},XBe={id:$y.id,description:"shortcut.sheet.set-italic",group:"4_sheet-edit",preconditions:t=>qn(t),binding:Xe.I|Ut.CTRL_COMMAND},YBe={id:ky.id,description:"shortcut.sheet.set-underline",group:"4_sheet-edit",preconditions:t=>qn(t),binding:Xe.U|Ut.CTRL_COMMAND},GBe={id:Ay.id,description:"shortcut.sheet.set-strike-through",group:"4_sheet-edit",preconditions:t=>qn(t),binding:Xe.X|Ut.SHIFT|Ut.CTRL_COMMAND},KBe={id:hf.id,preconditions:t=>qn(t),binding:Xe.DELETE,mac:Xe.BACKSPACE},ZBe={id:Df.id,description:"shortcut.sheet.zoom-in",binding:Xe.EQUAL|Ut.CTRL_COMMAND,group:"3_sheet-view",staticParameters:{delta:.2}},qBe={id:Df.id,description:"shortcut.sheet.zoom-out",binding:Xe.MINUS|Ut.CTRL_COMMAND,group:"3_sheet-view",staticParameters:{delta:-.2}},QBe={id:Df.id,description:"shortcut.sheet.reset-zoom",binding:Xe.Digit0|Ut.CTRL_COMMAND,group:"3_sheet-view",staticParameters:{reset:!0}};var JBe=Object.defineProperty,eFe=Object.getOwnPropertyDescriptor,tFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?eFe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&JBe(e,n,i),i},zc=(t,e)=>(n,r)=>e(n,r,t);let A8=class extends je{constructor(e,n,r,i,o,s){super(),this._injector=e,this._componentManager=n,this._commandService=r,this._shortcutService=i,this._menuService=o,this._uiController=s,this._init()}_initCustomComponents(){const e=this._componentManager;this.disposeWithMe(e.register(Py,Eke)),this.disposeWithMe(e.register(jF,wLe)),this.disposeWithMe(e.register(Rf,zT)),this.disposeWithMe(e.register(xF,pke)),this.disposeWithMe(e.register(ro,gke)),this.disposeWithMe(e.register(MF,bke))}_initCommands(){[LF,M1,BF,PF,Df,Js,Yi,bc,VF,UF,Ou,eF,NF,Sf,vB,R5,$a,Ty,$y,ky,Ay,ske,ake,_F,bF,x5,_B,CB,yB,SB,Ny,SF,Ly,EF,yf,S8,wf,wF,RF,DF,bB,Fy,Gl,HF,FF].forEach(e=>{this.disposeWithMe(this._commandService.registerCommand(e))})}_initMenus(){[Uke,Hke,Vke,jke,zke,Wke,Xke,GPe,KPe,ZPe,YPe,nBe,rBe,iBe,oBe,sBe,aBe,lBe,JPe,eAe,nAe,tAe,rAe,QPe,iAe,Yke,oAe,qPe,eBe,tBe,uBe,cBe,Zke,qke,Qke,Jke,Gke,Kke,wke,Rke,Dke,Ike,xke,Oke,Tke,$ke,kke,Ake,Nke,XPe,dBe,hBe,fBe,mBe,pBe,Lke,Pke,Bke,Fke,gBe,vBe,_Be,bBe,CBe,yBe].forEach(e=>{this.disposeWithMe(this._menuService.addMenuItem(this._injector.invoke(e)))})}_initShortcuts(){[wBe,RBe,DBe,IBe,xBe,MBe,OBe,TBe,$Be,kBe,ABe,NBe,LBe,PBe,BBe,FBe,UBe,HBe,VBe,jBe,zBe,ZBe,qBe,QBe,WBe,XBe,YBe,GBe,KBe,...MAe(),OAe,TAe,kAe,AAe,NAe,$Ae,SBe,EBe].forEach(e=>{this.disposeWithMe(this._shortcutService.registerShortcut(e))})}_initWorkbenchParts(){this.disposeWithMe(this._uiController.registerHeaderComponent(()=>Qd(zPe,this._injector))),this.disposeWithMe(this._uiController.registerFooterComponent(()=>Qd(jPe,this._injector))),this.disposeWithMe(this._uiController.registerContentComponent(()=>Qd(WPe,this._injector)))}_init(){this._initCustomComponents(),this._initCommands(),this._initMenus(),this._initShortcuts(),this._initWorkbenchParts()}};A8=tFe([yt(it.Ready,A8),zc(0,ne(Tn)),zc(1,ne(Pa)),zc(2,le),zc(3,Xl),zc(4,I1),zc(5,U6)],A8);var nFe=Object.defineProperty,rFe=Object.getOwnPropertyDescriptor,iFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?rFe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&nFe(e,n,i),i},pd=(t,e)=>(n,r)=>e(n,r,t);let N8=class extends je{constructor(e,n,r,i,o){super(),V(this,"_calculateTimeout",-1),this._univerInstanceService=e,this._selectionManagerService=n,this._functionService=r,this._statusBarService=i,this._formulaDataModel=o,this._init()}_init(){this._registerSelectionListener()}_registerSelectionListener(){this.disposeWithMe(Be(this._selectionManagerService.selectionMoving$.subscribe(e=>{e&&(clearTimeout(this._calculateTimeout),this._calculateTimeout=setTimeout(()=>{this._calculateSelection(e.map(n=>n.range))},100))}))),this.disposeWithMe(Be(this._selectionManagerService.selectionMoveEnd$.subscribe(e=>{e&&this._calculateSelection(e.map(n=>n.range))})))}_calculateSelection(e){const n=this._univerInstanceService.getCurrentUniverSheetInstance(),r=n.getUnitId(),i=n.getActiveSheet().getSheetId(),o={},s=this._formulaDataModel.getArrayFormulaCellData();if(this._univerInstanceService.getCurrentUniverSheetInstance().getSheets().forEach(a=>{const l=a.getConfig();o[a.getSheetId()]={cellData:new nt(l.cellData),rowCount:l.rowCount,columnCount:l.columnCount}}),e!=null&&e.length){const a=e.map(c=>new VP(c,i,r));a.forEach(c=>{c.setUnitData({[r]:o}),s&&c.setArrayFormulaCellData(IP(s))});const l=this._statusBarService.getFunctions().map(c=>{const d=this._functionService.getExecutor(c.func);if(!d)return;const h=a.map(f=>f.toArrayValueObject());if((d==null?void 0:d.calculate(...h)).getValue)return{func:c.func,value:(d==null?void 0:d.calculate(...h)).getValue()}});if(l.every(c=>c===void 0))return;const u=l.filter(c=>c!==void 0);this._statusBarService.setState(u)}else this._statusBarService.setState(null)}_isSingleCell(e){return e.startRow===e.endRow&&e.startColumn===e.endColumn}};N8=iFe([yt(it.Ready,N8),pd(0,oe),pd(1,ne(ut)),pd(2,x1),pd(3,Uy),pd(4,ne(Vo))],N8);var oFe=Object.defineProperty,sFe=Object.getOwnPropertyDescriptor,aFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?sFe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&oFe(e,n,i),i},su=(t,e)=>(n,r)=>e(n,r,t);let L8=class extends je{constructor(e,n,r,i,o,s,a){super(),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._selectionRenderService=o,this._selectionManagerService=s,this._scrollManagerService=a,this._initialize()}dispose(){super.dispose()}_initialize(){this._skeletonListener(),this._commandExecutedListener(),this._zoomEventBinding()}_zoomEventBinding(){var e;const n=(e=this._getSheetObject())==null?void 0:e.scene;n!=null&&(n.getViewport(Kn.VIEW_MAIN),this.disposeWithMe(Be(n.onMouseWheelObserver.add((r,i)=>{if(!r.ctrlKey)return;const o=Math.abs(r.deltaX);let s=o<40?.2:o<80?.4:.2;s*=r.deltaY>0?-1:1,n.scaleX<1&&(s/=2);const a=this._currentUniverService.getCurrentUniverSheetInstance(),l=a.getActiveSheet(),u=l.getZoomRatio();let c=+parseFloat(`${u+s}`).toFixed(1);c=c>=4?4:c<=.1?.1:c,this._commandService.executeCommand(Fy.id,{zoomRatio:Math.round(c*10)/10,unitId:a.getUnitId(),subUnitId:l.getSheetId()}),r.preventDefault()}))))}_skeletonListener(){this.disposeWithMe(Be(this._sheetSkeletonManagerService.currentSkeletonBefore$.subscribe(e=>{if(e==null)return;const n=this._currentUniverService.getCurrentUniverSheetInstance().getActiveSheet().getZoomRatio()||1;this._updateViewZoom(n)})))}_commandExecutedListener(){const e=[Gl.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(e.includes(n.id)){const r=this._currentUniverService.getCurrentUniverSheetInstance(),i=r.getActiveSheet(),o=n.params,{unitId:s,subUnitId:a}=o;if(!(s===r.getUnitId()&&a===i.getSheetId()))return;const l=i.getConfig().zoomRatio||1;this._updateViewZoom(l)}}))}_updateViewZoom(e){const n=this._getSheetObject();n==null||n.scene.scale(e,e),n==null||n.spreadsheet.makeForceDirty()}_getSheetObject(){return jo(this._currentUniverService,this._renderManagerService)}};L8=aFe([yt(it.Rendered,L8),su(0,ne(kr)),su(1,oe),su(2,le),su(3,kn),su(4,to),su(5,ne(ut)),su(6,ne(Yl))],L8);var lFe=Object.defineProperty,uFe=Object.getOwnPropertyDescriptor,cFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?uFe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&lFe(e,n,i),i},gd=(t,e)=>(n,r)=>e(n,r,t);let P8=class extends E1{constructor(e,n,r,i,o){super(),V(this,"_scene"),V(this,"_currentWorkbook"),V(this,"_loadedMap",new Set),V(this,"_isLoadedEditor",!1),V(this,"_fps$",new rn("")),V(this,"fps$",this._fps$.asObservable()),this._currentUniverService=e,this._commandService=n,this._renderManagerService=r,this._selectionRenderService=i,this._sheetSkeletonManagerService=o,this._currentUniverService.currentSheet$.subscribe(s=>{if(s==null)return;const a=s.getUnitId();this._loadedMap.has(a)||(this._currentWorkbook=s,this._addNewRender(),this._loadedMap.add(a))})}dispose(){this._fps$.complete()}_addNewRender(){const e=this._currentWorkbook,n=e.getUnitId(),r=e.getContainer(),i=e.getParentRenderUnitId();if(r!=null&&i!=null)throw new Error("container or parentRenderUnitId can only exist one");const o=r==null&&i!=null;o?this._renderManagerService.createRenderWithParent(n,i):this._renderManagerService.createRender(n);const s=this._renderManagerService.getRenderById(n);if(s==null)return;const{scene:a,engine:l}=s;a.openTransformer(),this._scene=a,a.addLayer(new F6(a,[],0),new F6(a,[],2)),s!=null&&this._addComponent(s),e.getShouldRenderLoopImmediately()&&!o&&l.runRenderLoop(()=>{a.render(),this._fps$.next(Math.round(l.getFps()).toString())}),this._renderManagerService.setCurrent(n)}_addComponent(e){const n=this._scene,r=this._currentWorkbook,i=r.getActiveSheet(),o=r.getUnitId(),s=i.getSheetId();this._addViewport(i);const a=new gge(zi.MAIN),l=new mge(zi.ROW),u=new ege(zi.COLUMN),c=new qt(zi.LEFT_TOP,{zIndex:2,left:-1,top:-1,fill:"rgb(248, 249, 250)",stroke:"rgb(217, 217, 217)",strokeWidth:1});e.mainComponent=a,e.components.set(zi.MAIN,a),e.components.set(zi.ROW,l),e.components.set(zi.COLUMN,u),e.components.set(zi.LEFT_TOP,c),n.addObjects([a],ZD),n.addObjects([l,u,c],Pl),n.enableLayerCache(ZD,Pl),this._sheetSkeletonManagerService.setCurrent({sheetId:s,unitId:o})}_addViewport(e){const n=this._scene;if(n==null)return;const{rowHeader:r,columnHeader:i}=e.getConfig(),o=new aa(Kn.VIEW_MAIN,n,{left:r.width,top:i.height,bottom:0,right:0,isWheelPreventDefaultX:!0}),s=new aa(Kn.VIEW_ROW_TOP,n,{active:!1,isWheelPreventDefaultX:!0}),a=new aa(Kn.VIEW_ROW_BOTTOM,n,{left:0,top:i.height,bottom:0,width:r.width,isWheelPreventDefaultX:!0}),l=new aa(Kn.VIEW_COLUMN_LEFT,n,{active:!1,isWheelPreventDefaultX:!0}),u=new aa(Kn.VIEW_COLUMN_RIGHT,n,{left:r.width,top:0,height:i.height,right:0,isWheelPreventDefaultX:!0}),c=new aa(Kn.VIEW_LEFT_TOP,n,{left:0,top:0,width:r.width,height:i.height,isWheelPreventDefaultX:!0}),d=new aa(Kn.VIEW_MAIN_LEFT_TOP,n,{isWheelPreventDefaultX:!0,active:!1}),h=new aa(Kn.VIEW_MAIN_LEFT,n,{isWheelPreventDefaultX:!0,active:!1}),f=new aa(Kn.VIEW_MAIN_TOP,n,{isWheelPreventDefaultX:!0,active:!1});return n.onMouseWheelObserver.add((m,p)=>{if(m.ctrlKey)return;let g=0,v=0;const _=o.limitedScroll();if(m.inputIndex===xt.MouseWheelX){const C=Math.abs(m.deltaX);m.deltaX>0?g=C:g=-C,this._commandService.executeCommand(S8.id,{offsetX:g}),n.getParent().classType===Bt.SCENE_VIEWER?_!=null&&_.isLimitedX||p.stopPropagation():o.isWheelPreventDefaultX?m.preventDefault():_!=null&&_.isLimitedX||m.preventDefault()}if(m.inputIndex===xt.MouseWheelY){let C=Math.abs(m.deltaY);m.shiftKey?(C*=3,m.deltaY>0?g=C:g=-C,this._commandService.executeCommand(S8.id,{offsetX:g}),n.getParent().classType===Bt.SCENE_VIEWER?_!=null&&_.isLimitedX||p.stopPropagation():o.isWheelPreventDefaultX?m.preventDefault():_!=null&&_.isLimitedX||m.preventDefault()):(m.deltaY>0?v=C:v=-C,this._commandService.executeCommand(S8.id,{offsetY:v}),n.getParent().classType===Bt.SCENE_VIEWER?_!=null&&_.isLimitedY||p.stopPropagation():o.isWheelPreventDefaultY?m.preventDefault():_!=null&&_.isLimitedY||m.preventDefault())}m.inputIndex,xt.MouseWheelZ,this._scene.makeDirty(!0)}),new b0(o),n.addViewport(o,l,u,s,a,c,d,h,f).attachControl(),o}};P8=cFe([yt(it.Ready,P8),gd(0,oe),gd(1,le),gd(2,kn),gd(3,to),gd(4,ne(kr))],P8);var dFe=Object.defineProperty,hFe=Object.getOwnPropertyDescriptor,fFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?hFe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&dFe(e,n,i),i},Rp=(t,e)=>(n,r)=>e(n,r,t),Dp;let B_=(Dp=class extends S1{constructor(t,e,n,r){super(QOe),this._injector=e,this._localeService=n,this._currentUniverService=r,this._localeService.load({zhCN:sAe})}onStarting(t){[[P8],[Eo,{useClass:QTe}],[_c,{useClass:w_}],[B0,{useClass:sLe}],[N0,{useClass:M_}],[Cc,{useClass:lAe}],[W4,{useClass:uAe}],[A0,{useClass:u8}],[Yl],[kr],[to,{useClass:y_}],[Uy,{useClass:MPe}],[Cf,{useClass:S_}],[d8],[h8],[C8],[g8],[v8],[y8],[E8],[w8],[R8],[D8],[I8],[_8],[M8],[o6],[T8],[f8],[m8],[O8],[$8],[A8],[b8],[L8],[c8],[N8],[p8],[x8]].forEach(e=>t.add(e))}onReady(){this._markSheetAsFocused()}_markSheetAsFocused(){const t=this._currentUniverService;t.currentSheet$.pipe(Wp(e=>!!e)).subscribe(e=>{t.focusUniverInstance(e.getUnitId())})}},V(Dp,"type",dr.Sheet),Dp);B_=fFe([Rp(1,ne(Tn)),Rp(2,ne(mn)),Rp(3,oe)],B_);var mFe=Object.defineProperty,pFe=(t,e,n)=>e in t?mFe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fn=(t,e,n)=>(pFe(t,typeof e!="symbol"?e+"":e,n),n);const WF="formula-ui";let gFe=class extends je{constructor(){super(...arguments),fn(this,"_dirtyConversionMap",new Map)}dispose(){this._dirtyConversionMap.clear()}remove(e){this._dirtyConversionMap.delete(e)}get(e){return this._dirtyConversionMap.get(e)}has(e){return this._dirtyConversionMap.has(e)}register(e,n){this._dirtyConversionMap.set(e,n)}getDirtyConversionMap(){return this._dirtyConversionMap}};const jy=nn("univer.formula.active-dirty-manager.service");var vFe=Object.defineProperty,_Fe=Object.getOwnPropertyDescriptor,bFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?_Fe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&vFe(e,n,i),i},Ip=(t,e)=>(n,r)=>e(n,r,t);let B8=class extends je{constructor(t,e,n){super(),this._activeDirtyManagerService=t,this._currentUniverService=e,this._formulaDataModel=n,this._initialize()}_initialize(){this._initialConversion()}_initialConversion(){this._activeDirtyManagerService.register(Pt.id,{commandId:Pt.id,getDirtyData:t=>{const e=t.params;return e.trigger===qr.id?{}:{dirtyRanges:this._getSetRangeValuesMutationDirtyRange(e)}}}),this._activeDirtyManagerService.register(Al.id,{commandId:Al.id,getDirtyData:t=>{const e=t.params;return{dirtyRanges:this._getMoveRangeMutationDirtyRange(e)}}}),this._activeDirtyManagerService.register(r0.id,{commandId:r0.id,getDirtyData:t=>{const e=t.params;return{dirtyRanges:this._getMoveRowsMutationDirtyRange(e)}}}),this._activeDirtyManagerService.register(i0.id,{commandId:i0.id,getDirtyData:t=>{const e=t.params;return{dirtyRanges:this._getMoveRowsMutationDirtyRange(e)}}}),this._activeDirtyManagerService.register(yo.id,{commandId:yo.id,getDirtyData:t=>{const e=t.params;return{dirtyRanges:this._getDeleteRangeMutationDirtyRange(e)}}}),this._activeDirtyManagerService.register(So.id,{commandId:So.id,getDirtyData:t=>{const e=t.params;return{dirtyRanges:this._getDeleteRangeMutationDirtyRange(e)}}}),this._activeDirtyManagerService.register($l.id,{commandId:$l.id,getDirtyData:t=>{const e=t.params;return{dirtyRanges:this._getRemoveRowOrColumnMutation(e,!0)}}}),this._activeDirtyManagerService.register(kl.id,{commandId:kl.id,getDirtyData:t=>{const e=t.params;return{dirtyRanges:this._getRemoveRowOrColumnMutation(e,!1)}}}),this._activeDirtyManagerService.register(Zs.id,{commandId:Zs.id,getDirtyData:t=>{const e=t.params;return{dirtyNameMap:this._getRemoveSheetMutation(e)}}}),this._activeDirtyManagerService.register(ps.id,{commandId:ps.id,getDirtyData:t=>{const e=t.params;return{dirtyNameMap:this._getInsertSheetMutation(e)}}})}_getSetRangeValuesMutationDirtyRange(t){const{subUnitId:e,unitId:n,cellValue:r}=t,i=[];return r==null||(i.push(...this._getDirtyRangesByCellValue(n,e,r)),i.push(...this._getDirtyRangesForArrayFormula(n,e,r))),i}_getMoveRangeMutationDirtyRange(t){const{subUnitId:e,unitId:n,from:r,to:i}=t,o=[];return o.push(...this._getDirtyRangesByCellValue(n,e,r)),o.push(...this._getDirtyRangesByCellValue(n,e,i)),o.push(...this._getDirtyRangesForArrayFormula(n,e,i)),o}_getMoveRowsMutationDirtyRange(t){const{subUnitId:e,unitId:n,sourceRange:r,targetRange:i}=t,o=[],s=this._rangeToMatrix(r).getData(),a=this._rangeToMatrix(i).getData();return o.push(...this._getDirtyRangesByCellValue(n,e,s)),o.push(...this._getDirtyRangesByCellValue(n,e,a)),o.push(...this._getDirtyRangesForArrayFormula(n,e,a)),o}_getDeleteRangeMutationDirtyRange(t){const{subUnitId:e,unitId:n,range:r,shiftDimension:i}=t,o=[],s=this._currentUniverService.getUniverSheetInstance(n),a=s==null?void 0:s.getSheetBySheetId(e),l=(a==null?void 0:a.getLastRowWithContent())||0,u=(a==null?void 0:a.getLastColumnWithContent())||0,c=new nt;let d=null;const{startRow:h,startColumn:f,endRow:m,endColumn:p}=r;i===sr.ROWS?d=this._rangeToMatrix({startRow:h,startColumn:f,endRow:l,endColumn:p}):i===sr.COLUMNS&&(d=this._rangeToMatrix({startRow:h,startColumn:f,endRow:m,endColumn:u})),d!=null&&c.merge(d);const g=c.getData();return o.push(...this._getDirtyRangesByCellValue(n,e,g)),o.push(...this._getDirtyRangesForArrayFormula(n,e,g)),o}_getRemoveRowOrColumnMutation(t,e=!0){const{subUnitId:n,unitId:r,range:i}=t,o=[],s=this._currentUniverService.getUniverSheetInstance(r),a=s==null?void 0:s.getSheetBySheetId(n),l=(a==null?void 0:a.getRowCount())||0,u=(a==null?void 0:a.getColumnCount())||0,c=new nt;let d=null;const{startRow:h,endRow:f,startColumn:m,endColumn:p}=i;e===!0?d=this._rangeToMatrix({startRow:h,startColumn:0,endRow:f,endColumn:u-1}):d=this._rangeToMatrix({startRow:0,startColumn:m,endRow:l,endColumn:p}),d!=null&&c.merge(d);const g=c.getData();return o.push(...this._getDirtyRangesByCellValue(r,n,g)),o.push(...this._getDirtyRangesForArrayFormula(r,n,g)),o}_getRemoveSheetMutation(t,e){const n={},{subUnitId:r,unitId:i}=t;return n[i]==null&&(n[i]={}),n[i][r]=e,n}_getInsertSheetMutation(t,e){const n={},{sheet:r,unitId:i}=t;return n[i]==null&&(n[i]={}),n[i][r.id]=e,n}_rangeToMatrix(t){const e=new nt,{startRow:n,startColumn:r,endRow:i,endColumn:o}=t;for(let s=n;s<=i;s++)for(let a=r;a<=o;a++)e.setValue(s,a,{});return e}_getDirtyRangesByCellValue(t,e,n){const r=[];return n==null||new nt(n).getDiscreteRanges().forEach(i=>{r.push({unitId:t,sheetId:e,range:i})}),r}_getDirtyRangesForArrayFormula(t,e,n){var r,i;const o=[];if(n==null)return o;const s=new nt(n),a=this._formulaDataModel.getArrayFormulaRange();if((r=a==null?void 0:a[t])!=null&&r[e]){const l=new nt((i=a==null?void 0:a[t])==null?void 0:i[e]);s.forValue((u,c)=>{l.forValue((d,h,f)=>{if(f==null)return!0;const{startRow:m,startColumn:p,endRow:g,endColumn:v}=f;u>=m&&u<=g&&c>=p&&c<=v&&o.push({unitId:t,sheetId:e,range:{startRow:m,startColumn:p,endRow:m,endColumn:p}})})})}return o}};B8=bFe([yt(it.Ready,B8),Ip(0,jy),Ip(1,oe),Ip(2,ne(Vo))],B8);var CFe=Object.defineProperty,yFe=Object.getOwnPropertyDescriptor,SFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?yFe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&CFe(e,n,i),i},xp=(t,e)=>(n,r)=>e(n,r,t);let F8=class extends je{constructor(t,e,n){super(),this._commandService=t,this._sheetInterceptorService=e,this._formulaDataModel=n,this._initialize()}_initialize(){this._commandExecutedListener(),this._initInterceptorCellContent()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(t.id!==t0.id)return;const e=t.params;if(e==null)return;const{arrayFormulaRange:n,arrayFormulaCellData:r}=e;this._formulaDataModel.setArrayFormulaRange(n),this._formulaDataModel.setArrayFormulaCellData(r)}))}_initInterceptorCellContent(){this.disposeWithMe(this._sheetInterceptorService.intercept(Ra.CELL_CONTENT,{priority:100,handler:(t,e,n)=>{var r,i,o,s,a,l;const{unitId:u,subUnitId:c,row:d,col:h}=e,f=this._formulaDataModel.getArrayFormulaCellData(),m=this._formulaDataModel.getArrayFormulaRange(),p=(o=(i=(r=f==null?void 0:f[u])==null?void 0:r[c])==null?void 0:i[d])==null?void 0:o[h],g=(l=(a=(s=m==null?void 0:m[u])==null?void 0:s[c])==null?void 0:a[d])==null?void 0:l[h];return p==null||g!=null&&g.startRow===d&&g.startColumn===h?n(t):n({...t,...p})}}))}};F8=SFe([yt(it.Ready,F8),xp(0,le),xp(1,ne(En)),xp(2,ne(Vo))],F8);var EFe=Object.defineProperty,wFe=Object.getOwnPropertyDescriptor,RFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?wFe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&EFe(e,n,i),i},xI=(t,e)=>(n,r)=>e(n,r,t);let U8=class extends je{constructor(t,e){super(),this._autoFillService=t,this._lexerTreeBuilder=e,this._initialize()}_initialize(){this._registerAutoFill()}_registerAutoFill(){const t={type:ai.FORMULA,priority:1001,match:e=>Ao(e==null?void 0:e.f)||q1(e==null?void 0:e.si),isContinue:(e,n)=>e.type===ai.FORMULA,applyFunctions:{[Mn.COPY]:(e,n,r,i)=>{const{data:o,index:s}=e;return this._fillCopyFormula(o,n,r,s,i)}}};this._autoFillService.registerRule(t)}_fillCopyFormula(t,e,n,r,i){var o,s;const a=IFe(i),l=[],u=new Map;for(let c=1;c<=e;c++){const d=(c-1)%t.length,h=De.deepClone(t[d]);if(h){const f=((o=t[d])==null?void 0:o.f)||"",m=((s=t[d])==null?void 0:s.si)||"",p=Ao(f);if(q1(m))h.si=m,h.f=null,h.v=null,h.p=null,n===ge.DOWN||n===ge.RIGHT?l.push(h):l.unshift(h);else if(p){let g=u.get(d);if(g)h.si=g,h.f=null,h.v=null,h.p=null;else{g=De.generateRandomId(6),u.set(d,g);const{offsetX:v,offsetY:_}=DFe(a,n),C=this._lexerTreeBuilder.moveFormulaRefOffset(f,v,_);h.si=g,h.f=C,h.v=null,h.p=null}n===ge.DOWN||n===ge.RIGHT?l.push(h):l.unshift(h)}}}return l}};U8=RFe([yt(it.Ready,U8),xI(0,A0),xI(1,ne(Ba))],U8);function DFe(t,e){let n=0,r=0;switch(e){case ge.UP:r=-t;break;case ge.RIGHT:n=t;break;case ge.DOWN:r=t;break;case ge.LEFT:n=-t;break}return{offsetX:n,offsetY:r}}function IFe(t){let e=0;for(const n in t)t[n].forEach(r=>{e+=r.data.length});return e}const XF="special-paste-formula",YF={id:"sheet.command.paste-formula",type:se.COMMAND,handler:async t=>t.get(le).executeCommand(k0.id,{value:XF})};var xFe=Object.defineProperty,MFe=Object.getOwnPropertyDescriptor,OFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?MFe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&xFe(e,n,i),i},n3=(t,e)=>(n,r)=>e(n,r,t);const TFe="default-paste-formula";let H8=class extends je{constructor(t,e,n,r){super(),this._currentUniverSheet=t,this._lexerTreeBuilder=e,this._sheetClipboardService=n,this._injector=r,this._initialize()}_initialize(){this._registerClipboardHook()}_registerClipboardHook(){this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._pasteFormulaHook())),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._pasteWithFormulaHook()))}_pasteFormulaHook(){return{hookName:XF,specialPasteInfo:{label:"specialPaste.formula"},onPasteCells:(t,e,n,r)=>{const i=this._currentUniverSheet.getCurrentUniverSheetInstance(),o=i.getUnitId(),s=i.getActiveSheet().getSheetId();return this._injector.invoke(a=>MI(o,s,t,e,a,r,this._lexerTreeBuilder,!0))}}}_pasteWithFormulaHook(){return{hookName:TFe,onPasteCells:(t,e,n,r)=>{const i=this._currentUniverSheet.getCurrentUniverSheetInstance(),o=i.getUnitId(),s=i.getActiveSheet().getSheetId();return this._injector.invoke(a=>MI(o,s,t,e,a,r,this._lexerTreeBuilder))}}}};H8=OFe([yt(it.Ready,H8),n3(0,oe),n3(1,ne(Ba)),n3(2,_c),n3(3,ne(Tn))],H8);function MI(t,e,n,r,i,o,s,a=!1){const l=[],u=[],{startColumn:c,startRow:d}=n,h=new nt,f=new Map;let m=0,p=0,g=0,v=0;if(o){const{copyType:y,copyRange:S}=o;y===al.COPY&&S&&(g=S.startRow,v=S.startColumn,m=S.endRow-g+1,p=S.endColumn-v+1)}r.forValue((y,S,E)=>{const w=E.f||"",R={};if(a&&(R.v=E.v),Ao(w)&&m&&p){const D=y%m,I=S%p,k=`${D}_${I}`;let O=f.get(k);if(O)R.si=O,R.f=null,R.v=null,R.p=null;else{O=De.generateRandomId(6),f.set(k,O);const $=S+c-(v+I),N=y+d-(g+D),H=s.moveFormulaRefOffset(w,$,N);R.si=O,R.f=H,R.v=null,R.p=null}}h.setValue(y+d,S+c,R)});const _={unitId:t,subUnitId:e,cellValue:h.getData()};l.push({id:Pt.id,params:_});const C=Bi(i,_);return u.push({id:Pt.id,params:C}),{undos:u,redos:l}}var $Fe=Object.defineProperty,kFe=Object.getOwnPropertyDescriptor,AFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?kFe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&$Fe(e,n,i),i},Za=(t,e)=>(n,r)=>e(n,r,t);let V8=class extends je{constructor(t,e,n,r,i,o,s,a,l){super(),fn(this,"_previousShape"),this._editorBridgeService=t,this._formulaDataModel=e,this._lexerTreeBuilder=n,this._themeService=r,this._renderManagerService=i,this._selectionRenderService=o,this._sheetSkeletonManagerService=s,this._commandService=a,this._sheetInterceptorService=l,this._initInterceptorEditorStart(),this._commandExecutedListener(),this._initInterceptorCell()}_initInterceptorEditorStart(){this.disposeWithMe(Be(this._editorBridgeService.interceptor.intercept(this._editorBridgeService.interceptor.getInterceptPoints().BEFORE_CELL_EDIT,{handler:(t,e,n)=>{var r,i,o,s;const{row:a,col:l,unitId:u,subUnitId:c,worksheet:d}=e,h=this._formulaDataModel.getArrayFormulaRange(),f=this._formulaDataModel.getArrayFormulaCellData();if(this._removeArrayFormulaRangeShape(),t==null)return n(t);let m=null;const p=this._formulaDataModel.getFormulaDataItem(a,l,c,u);if(p!=null){const{f:v,si:_,x:C=0,y=0}=p;if(_!=null&&(C>0||y>0)){let S="";if(v.length>0)S=v;else{const E=this._formulaDataModel.getFormulaItemBySId(_,c,u);if(E==null||E.f.length===0)return n(t);S=E.f}m={f:this._lexerTreeBuilder.moveFormulaRefOffset(S,C,y)}}}if(t.v!=null&&t.v!==""&&((o=(i=(r=f[u])==null?void 0:r[c])==null?void 0:i[a])==null?void 0:o[l])==null)return m||n(t);const g=(s=h==null?void 0:h[u])==null?void 0:s[c];return g!=null&&new nt(g).forValue((v,_,C)=>{if(C==null)return!0;const{startRow:y,startColumn:S,endRow:E,endColumn:w}=C;if(v===a&&_===l)return this._createArrayFormulaRangeShape(C,u),!1;if(a>=y&&a<=E&&l>=S&&l<=w){const R=d.getCell(y,S);if((R==null?void 0:R.v)===ce.SPILL)return;const D=this._formulaDataModel.getFormulaDataItem(v,_,c,u);return D==null||D.f==null?!0:(m==null&&(m={f:D.f,isInArrayFormulaRange:!0}),this._createArrayFormulaRangeShape(C,u),!1)}}),m||n(t)}})))}_initInterceptorCell(){this.disposeWithMe(this._sheetInterceptorService.intercept(Ra.CELL_CONTENT,{handler:(t,e,n)=>{var r,i,o;const{row:s,col:a,unitId:l,subUnitId:u}=e,c=this._formulaDataModel.getArrayFormulaCellData(),d=(o=(i=(r=c==null?void 0:c[l])==null?void 0:r[u])==null?void 0:i[s])==null?void 0:o[a];return n(d?{...t,...d}:t)}}))}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{t.id===sf.id&&this._removeArrayFormulaRangeShape()}))}_createArrayFormulaRangeShape(t,e){var n;const r=this._themeService.getCurrentTheme(),i=new _o(r.colorWhite).setAlpha(0).toString(),o={strokeWidth:1,stroke:r.hyacinth700,fill:i,widgets:{},hasAutoFill:!1,hasRowHeader:!1,hasColumnHeader:!1},{scene:s}=this._renderManagerService.getRenderById(e)||{},{rangeWithCoord:a,primaryWithCoord:l}=this._selectionRenderService.convertSelectionRangeToData({range:t,primary:null,style:o}),u=(n=this._sheetSkeletonManagerService.getCurrent())==null?void 0:n.skeleton;if(!s||!u)return;const{rowHeaderWidth:c,columnHeaderHeight:d}=u,h=new w5(s,100,!1,this._themeService);h.update(a,c,d,o,l),this._previousShape=h}_removeArrayFormulaRangeShape(){this._previousShape!=null&&(this._previousShape.dispose(),this._previousShape=null)}};V8=AFe([yt(it.Rendered,V8),Za(0,ne(Eo)),Za(1,ne(Vo)),Za(2,ne(Ba)),Za(3,ne(Ki)),Za(4,kn),Za(5,to),Za(6,ne(kr)),Za(7,le),Za(8,ne(En))],V8);const zy={id:"formula-ui.operation.change-ref-to-absolute",type:se.OPERATION,handler:async t=>!0};class NFe{constructor(){fn(this,"_sequenceNodes",[]),fn(this,"_isSelectionMoving",!1),fn(this,"_isLockedOnSelectionChangeRefString",!1),fn(this,"_isLockedOnSelectionInsertRefString",!1),fn(this,"_syncToEditor$",new Qt),fn(this,"syncToEditor$",this._syncToEditor$.asObservable()),fn(this,"_changeRef$",new Qt),fn(this,"changeRef$",this._changeRef$.asObservable()),fn(this,"_inputFormula$",new Qt),fn(this,"inputFormula$",this._inputFormula$.asObservable())}dispose(){this._sequenceNodes=[]}inputFormula(e){this._inputFormula$.next(e)}syncToEditor(e){this._syncToEditor$.next({sequences:this.getSequenceNodes(),textSelectionOffset:e})}getSequenceNodes(){return[...this._sequenceNodes]}setSequenceNodes(e){this._sequenceNodes=e}clearSequenceNodes(){this._sequenceNodes=[]}getCurrentSequenceNode(e){return this._sequenceNodes[this.getCurrentSequenceNodeIndex(e)]}getCurrentSequenceNodeByIndex(e){return this._sequenceNodes[e]}getCurrentSequenceNodeIndex(e){let n=0;for(let r=0,i=this._sequenceNodes.length;r<i;r++){const o=this._sequenceNodes[r];if(typeof o=="string")n++;else{const{endIndex:s}=o;n=s}if(e<=n)return r}return this._sequenceNodes.length}updateSequenceRef(e,n){const r=this._sequenceNodes[e];if(typeof r=="string"||r.nodeType!==Hr.REFERENCE)return;const i=n.length-r.token.length,o={...r};o.token=n,o.endIndex+=i,this._sequenceNodes[e]=o;for(let s=e+1,a=this._sequenceNodes.length;s<a;s++){const l=this._sequenceNodes[s];if(typeof l=="string")continue;const u={...l};u.startIndex+=i,u.endIndex+=i,this._sequenceNodes[s]=u}this._changeRef$.next(!0)}insertSequenceRef(e,n){const r=n.length,i=this.getCurrentSequenceNodeIndex(e);this._sequenceNodes.splice(i,0,{token:n,startIndex:e,endIndex:e+r-1,nodeType:Hr.REFERENCE});for(let o=i+1,s=this._sequenceNodes.length;o<s;o++){const a=this._sequenceNodes[o];if(typeof a=="string")continue;const l={...a};l.startIndex+=r,l.endIndex+=r,this._sequenceNodes[o]=l}this._changeRef$.next(!0)}insertSequenceString(e,n){const r=this.getCurrentSequenceNodeIndex(e),i=n.split("");this._sequenceNodes.splice(r,0,...i);const o=i.length;for(let s=r+o,a=this._sequenceNodes.length;s<a;s++){const l=this._sequenceNodes[s];if(typeof l=="string")continue;const u={...l};u.startIndex+=o,u.endIndex+=o,this._sequenceNodes[s]=u}this._changeRef$.next(!0)}enableSelectionMoving(){this._isSelectionMoving=!0}disableSelectionMoving(){this._isSelectionMoving=!1}isSelectionMoving(){return this._isSelectionMoving}enableLockedSelectionChange(){this._isLockedOnSelectionChangeRefString=!0}disableLockedSelectionChange(){this._isLockedOnSelectionChangeRefString=!1}isLockedSelectionChange(){return this._isLockedOnSelectionChangeRefString}enableLockedSelectionInsert(){this._isLockedOnSelectionInsertRefString=!0}disableLockedSelectionInsert(){this._isLockedOnSelectionInsertRefString=!1}isLockedSelectionInsert(){return this._isLockedOnSelectionInsertRefString}}const G4=nn("formula-ui.input-service");var LFe=Object.defineProperty,PFe=Object.getOwnPropertyDescriptor,BFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?PFe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&LFe(e,n,i),i},au=(t,e)=>(n,r)=>e(n,r,t);let j8=class extends je{constructor(e,n,r,i,o,s,a){super(),fn(this,"_userCursorMove",!1),this._commandService=e,this._textSelectionRenderManager=n,this._editorBridgeService=r,this._lexerTreeBuilder=i,this._renderManagerService=o,this._formulaInputService=s,this._textSelectionManagerService=a,this._initialize()}_initialize(){this._commandExecutedListener(),this._initialEditorInputChange(),this._userMouseListener(),this._inputFormulaListener()}_initialEditorInputChange(){this.disposeWithMe(Be(this._textSelectionRenderManager.onInputBefore$.subscribe(e=>{const n=e==null?void 0:e.event;n!=null&&n.which!==Xe.F4&&(this._userCursorMove=!1)})))}_userMouseListener(){const e=this._getEditorObject();if(e==null)return;const{document:n}=e;this.disposeWithMe(Be(n.onPointerDownObserver.add(()=>{this._userCursorMove=!0})))}_inputFormulaListener(){this.disposeWithMe(Be(this._formulaInputService.inputFormula$.subscribe(e=>{this._editorBridgeService.isVisible().visible===!1&&this._editorBridgeService.changeVisible({visible:!0,eventType:Zn.Dblclick});const n=this._lexerTreeBuilder.sequenceNodesBuilder(e)||[];this._formulaInputService.setSequenceNodes(n),this._formulaInputService.syncToEditor(e.length-1)})))}_changeRefString(){const e=this._textSelectionManagerService.getActiveRange();if(e==null)return;const{startOffset:n}=e,r=n-2,i=this._formulaInputService.getCurrentSequenceNodeIndex(r),o=this._formulaInputService.getCurrentSequenceNodeByIndex(i);if(o==null||typeof o=="string"||o.nodeType!==Hr.REFERENCE)return;const s=o.token.split("!");let a=o.token;s.length>1&&(a=s[s.length-1]);let l="";for(let d=0,h=s.length;d<h-1;d++)l+=s[d];let u=a;if(a.indexOf(cn.COLON)>-1)if(!this._userCursorMove)u=this._changeRangeRef(a);else{const d=a.split(cn.COLON),h=d[0],f=d[1];r-o.startIndex<=h.length?u=this._changeSingleRef(h)+cn.COLON+f:u=h+cn.COLON+this._changeSingleRef(f)}else u=this._changeSingleRef(a);u=l+u;const c=u.length-o.token.length;this._formulaInputService.updateSequenceRef(i,u),this._formulaInputService.syncToEditor(r+c+1)}_changeRangeRef(e){const n=xa(e).range;let r="";return n.startAbsoluteRefType===br.NONE||n.startAbsoluteRefType==null?(n.startAbsoluteRefType=br.ALL,n.endAbsoluteRefType=br.ALL):(n.startAbsoluteRefType=br.NONE,n.endAbsoluteRefType=br.NONE),r=L2(n),r}_changeSingleRef(e){const n=xa(e).range,r=n.startAbsoluteRefType;let i="";return r===br.NONE||r==null?(n.startAbsoluteRefType=br.ALL,n.endAbsoluteRefType=br.ALL):r===br.ALL?(n.startAbsoluteRefType=br.ROW,n.endAbsoluteRefType=br.ROW):r===br.ROW?(n.startAbsoluteRefType=br.COLUMN,n.endAbsoluteRefType=br.COLUMN):(n.startAbsoluteRefType=br.NONE,n.endAbsoluteRefType=br.NONE),i=L2(n),i}_commandExecutedListener(){const e=[zy.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{e.includes(n.id)&&this._changeRefString()}))}_getEditorObject(){return o0(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}};j8=BFe([yt(it.Steady,j8),au(0,le),au(1,Wl),au(2,ne(Eo)),au(3,ne(Ba)),au(4,kn),au(5,G4),au(6,ne(gr))],j8);const GF={id:"formula-ui.command.insert-function",type:se.COMMAND,handler:async(t,e)=>{const{list:n}=e,r=t.get(le),i=new nt;n.forEach(s=>{const{range:a,primary:l,formula:u}=s,{row:c,column:d}=l,h=De.generateRandomId(6);i.setValue(c,d,{f:u,si:h});const{startRow:f,startColumn:m,endRow:p,endColumn:g}=a;for(let v=f;v<=p;v++)for(let _=m;_<=g;_++)(v!==c||_!==d)&&i.setValue(v,_,{si:h})});const o={value:i.getData()};return r.executeCommand(Oa.id,o)}},F0={id:"formula-ui.operation.select-editor-formula",type:se.OPERATION,handler:(t,e)=>!0},yc=nn("formula-ui.prompt-service");class FFe{constructor(){fn(this,"_search$",new Qt),fn(this,"_help$",new Qt),fn(this,"_navigate$",new Qt),fn(this,"_accept$",new Qt),fn(this,"_acceptFormulaName$",new Qt),fn(this,"search$",this._search$.asObservable()),fn(this,"help$",this._help$.asObservable()),fn(this,"navigate$",this._navigate$.asObservable()),fn(this,"accept$",this._accept$.asObservable()),fn(this,"acceptFormulaName$",this._acceptFormulaName$.asObservable()),fn(this,"_searching",!1),fn(this,"_helping",!1),fn(this,"_isInsertRefString",!1)}dispose(){this._search$.complete(),this._help$.complete(),this._navigate$.complete(),this._accept$.complete(),this._acceptFormulaName$.complete()}search(e){this._searching=e.visible,this._search$.next(e)}isSearching(){return this._searching}help(e){this._helping=e.visible,this._help$.next(e)}isHelping(){return this._helping}navigate(e){this._navigate$.next(e)}accept(e){this._accept$.next(e)}acceptFormulaName(e){this._acceptFormulaName$.next(e)}}const F_={id:"formula-ui.operation.help-function",type:se.OPERATION,handler:async(t,e)=>(t.get(yc).help(e),!0)},Wy={id:"formula-ui.operation.insert-function",type:se.OPERATION,handler:async(t,e)=>{const n=t.get(ut),r=t.get(G4),i=n.getSelections();if(!i||!i.length)return!1;const o=t.get(oe).getCurrentUniverSheetInstance(),s=o.getActiveSheet(),a=o.getUnitId(),l=s.getSheetId(),u=s.getCellMatrix(),{value:c}=e,d=t.get(le),h=[];let f=null,m=0,p=0;if(i.some(g=>{const{range:v,primary:_}=g,C=(_==null?void 0:_.actualRow)??v.startRow,y=(_==null?void 0:_.actualColumn)??v.startColumn,S=UFe(u,C,y);if(!S)return f=v,m=C,p=y,!0;const E=L2(S),w=`=${c}(${E})`;return h.push({range:v,primary:{row:C,column:y},formula:w}),!1}),f){const g=C5(m,p,s),v={range:pt.clone(f),primary:{startRow:g.startRow,startColumn:g.startColumn,endRow:g.endRow,endColumn:g.endColumn,actualRow:m,actualColumn:p,isMerged:g.isMerged,isMergedMainCell:g.startRow===m&&g.startColumn===p}},_={unitId:a,sheetId:l,pluginName:On,selections:[v]};await d.executeCommand(dn.id,_),setTimeout(()=>{r.inputFormula(`=${c}(`)},0)}return h.length===0?!1:d.executeCommand(GF.id,{list:h})}};function UFe(t,e,n){const r=HFe(t,e,n);if(r!==e)return{startRow:r,endRow:e-1,startColumn:n,endColumn:n};const i=VFe(t,e,n);return i!==n?{startRow:e,endRow:e,startColumn:i,endColumn:n-1}:null}function HFe(t,e,n){let r=!1;if(e===0)return e;for(let i=e-1;i>=0;i--){const o=t.getValue(i,n);if(O5(o)&&!r){if(i===0)return 0;r=!0}else{if(r&&!O5(o))return i+1;if(r&&i===0)return 0}}return e}function VFe(t,e,n){let r=!1;if(n===0)return n;for(let i=n-1;i>=0;i--){const o=t.getValue(e,i);if(O5(o)&&!r){if(i===0)return 0;r=!0}else{if(r&&!O5(o))return i+1;if(r&&i===0)return 0}}return n}function O5(t){return t&&(De.isStringNumber(t.v)||Ej(t)===er.NUMBER)}const KF=`${WF}_MORE_FUNCTIONS_COMPONENT`,ZF={id:"formula-ui.operation.more-functions",type:se.OPERATION,handler:async t=>(t.get(C0).open({header:{title:"formula.insert.tooltip"},children:{label:KF}}),!0)},U_={id:"formula-ui.operation.search-function",type:se.OPERATION,handler:async(t,e)=>(t.get(yc).search(e),!0)};var qF={exports:{}},xf={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jFe=Qe,zFe=Symbol.for("react.element"),WFe=Symbol.for("react.fragment"),XFe=Object.prototype.hasOwnProperty,YFe=jFe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,GFe={key:!0,ref:!0,__self:!0,__source:!0};function QF(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)XFe.call(e,r)&&!GFe.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:zFe,type:t,key:o,ref:s,props:i,_owner:YFe.current}}xf.Fragment=WFe;xf.jsx=QF;xf.jsxs=QF;qF.exports=xf;var Ct=qF.exports;const KFe="univer-formula-error-function",ZFe={formulaErrorFunction:KFe};function qFe(){const[t,e]=b.useState(!1),[n,r]=b.useState({left:0,top:0}),i=_t(yc),o=_t(Cc);return b.useEffect(()=>{const s=i.help$.subscribe(a=>{const l=o.getState();if(!l)return;const{visible:u}=a;if(!u){e(u);return}const{endX:c=0,startY:d=0}=l;r({left:c,top:d}),e(u)});return()=>{s==null||s.unsubscribe()}},[]),t?Ct.jsx("div",{className:ZFe.formulaErrorFunction,style:{left:n.left,top:n.top}}):null}var os=function(){return os=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},os.apply(this,arguments)},QFe=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},K4=b.forwardRef(function(t,e){var n=t.icon,r=t.id,i=t.className,o=t.extend,s=QFe(t,["icon","id","className","extend"]),a="univerjs-icon univerjs-icon-".concat(r," ").concat(i||"").trim(),l=b.useRef("_".concat(tUe()));return JF(n,"".concat(r),{defIds:n.defIds,idSuffix:l.current},os({ref:e,className:a},s),o)});function JF(t,e,n,r,i){return b.createElement(t.tag,os(os({key:e},JFe(t,n,i)),r),(eUe(t,n).children||[]).map(function(o,s){return JF(o,"".concat(e,"-").concat(t.tag,"-").concat(s),n,void 0,i)}))}function JFe(t,e,n){var r=os({},t.attrs);n!=null&&n.colorChannel1&&r.fill==="colorChannel1"&&(r.fill=n.colorChannel1);var i=e.defIds;return!i||i.length===0||(t.tag==="use"&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+e.idSuffix),Object.entries(r).forEach(function(o){var s=o[0],a=o[1];typeof a=="string"&&(r[s]=a.replace(/url\(#(.*)\)/,"url(#$1".concat(e.idSuffix,")")))})),r}function eUe(t,e){var n,r=e.defIds;return!r||r.length===0?t:t.tag==="defs"&&!((n=t.children)===null||n===void 0)&&n.length?os(os({},t),{children:t.children.map(function(i){return typeof i.attrs.id=="string"&&r&&r.indexOf(i.attrs.id)>-1?os(os({},i),{attrs:os(os({},i.attrs),{id:i.attrs.id+e.idSuffix})}):i})}):t}function tUe(){return Math.random().toString(36).substring(2,8)}K4.displayName="UniverIcon";var nUe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.6152 4.52067C14.8732 4.77869 14.8732 5.19703 14.6152 5.45505L6.61862 13.4514C6.46241 13.6077 6.20915 13.6077 6.05294 13.4514L1.73512 9.13354C1.4771 8.87551 1.4771 8.45718 1.73513 8.19915C1.99315 7.94113 2.41149 7.94114 2.66951 8.19916L6.19436 11.7241C6.27247 11.8022 6.3991 11.8022 6.47721 11.7241L13.6808 4.52067C13.9388 4.26264 14.3571 4.26264 14.6152 4.52067Z",fillRule:"evenodd",clipRule:"evenodd"}}]},eU=b.forwardRef(function(t,e){return b.createElement(K4,Object.assign({},t,{id:"check-mark-single",ref:e,icon:nUe}))});eU.displayName="CheckMarkSingle";const rUe=eU;var iUe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.48712 4.59907C5.23328 4.34523 4.82172 4.34523 4.56788 4.59907C4.31404 4.85291 4.31404 5.26447 4.56788 5.51831L7.9973 8.94773L4.56773 12.3773C4.31389 12.6311 4.31389 13.0427 4.56773 13.2965C4.82157 13.5504 5.23313 13.5504 5.48697 13.2965L8.91654 9.86697L12.3461 13.2965C12.5999 13.5503 13.0114 13.5503 13.2653 13.2965C13.5191 13.0426 13.5191 12.6311 13.2653 12.3772L9.83577 8.94773L13.2651 5.51836C13.519 5.26452 13.519 4.85296 13.2651 4.59912C13.0113 4.34528 12.5997 4.34528 12.3459 4.59912L8.91654 8.02849L5.48712 4.59907Z"}}]},tU=b.forwardRef(function(t,e){return b.createElement(K4,Object.assign({},t,{id:"close-single",ref:e,icon:iUe}))});tU.displayName="CloseSingle";const oUe=tU;var sUe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_891",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.51 0.5H16.51V16.5H0.51z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_891)"},children:[{tag:"path",attrs:{d:"M9.30291 5.78907C9.30291 6.22898 8.94629 6.5856 8.50637 6.5856 8.06646 6.5856 7.70984 6.22898 7.70984 5.78907 7.70984 5.34916 8.06646 4.99254 8.50637 4.99254 8.94629 4.99254 9.30291 5.34916 9.30291 5.78907zM9.1436 8.17867C9.1436 7.82674 8.8583 7.54144 8.50637 7.54144 8.15444 7.54144 7.86915 7.82674 7.86915 8.17867V12.002C7.86915 12.354 8.15444 12.6392 8.50637 12.6392 8.8583 12.6392 9.1436 12.354 9.1436 12.002V8.17867z"}},{tag:"path",attrs:{d:"M1.49689 8.49728C1.49689 4.62605 4.63514 1.48779 8.50637 1.48779C12.3776 1.48779 15.5159 4.62605 15.5159 8.49728C15.5159 12.3685 12.3776 15.5068 8.50637 15.5068C4.63514 15.5068 1.49689 12.3685 1.49689 8.49728ZM8.50637 2.76224C5.339 2.76224 2.77134 5.32991 2.77134 8.49728C2.77134 11.6646 5.339 14.2323 8.50637 14.2323C11.6737 14.2323 14.2414 11.6646 14.2414 8.49728C14.2414 5.32991 11.6737 2.76224 8.50637 2.76224Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},nU=b.forwardRef(function(t,e){return b.createElement(K4,Object.assign({},t,{id:"details-single",ref:e,icon:sUe}))});nU.displayName="DetailsSingle";const aUe=nU;var lUe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.52628 3.57095C5.81918 3.26411 6.29405 3.26411 6.58695 3.57095L11.0869 8.28525C11.3798 8.59209 11.3798 9.08958 11.0869 9.39642L6.51623 14.04C6.22334 14.3468 5.74846 14.3468 5.45557 14.04C5.16268 13.7331 5.16268 13.2357 5.45557 12.9288L9.35939 8.979C9.43544 8.90205 9.43652 8.77857 9.36182 8.70031L5.52628 4.68212C5.23339 4.37528 5.23339 3.87779 5.52628 3.57095Z",fillRule:"evenodd",clipRule:"evenodd"}}]},rU=b.forwardRef(function(t,e){return b.createElement(K4,Object.assign({},t,{id:"more-single",ref:e,icon:lUe}))});rU.displayName="MoreSingle";const uUe=rU,cUe="univer-formula-help-function",dUe="univer-formula-help-function-title",hUe="univer-formula-help-function-title-icons",fUe="univer-formula-help-function-title-icon",mUe="univer-formula-help-function-content",pUe="univer-formula-help-function-content-inner",gUe="univer-formula-help-function-content-params",vUe="univer-formula-help-function-content-params-title",_Ue="univer-formula-help-function-content-params-detail",bUe="univer-formula-help-function-active",CUe="univer-formula-help-decorator",Oo={formulaHelpFunction:cUe,formulaHelpFunctionTitle:dUe,formulaHelpFunctionTitleIcons:hUe,formulaHelpFunctionTitleIcon:fUe,formulaHelpFunctionContent:mUe,formulaHelpFunctionContentInner:pUe,formulaHelpFunctionContentParams:gUe,formulaHelpFunctionContentParamsTitle:vUe,formulaHelpFunctionContentParamsDetail:_Ue,formulaHelpFunctionActive:bUe,formulaHelpDecorator:CUe};function yUe(){const[t,e]=b.useState(!1),[n,r]=b.useState(!0),[i,o]=b.useState(!0),[s,a]=b.useState(0),[l,u]=b.useState([0,0]),[c,d]=b.useState({left:0,top:0}),[h,f]=b.useState(null),m=_t(yc),p=_t(Cc),g=_t(mn),v=_t(W4),_=_t(Tr),C=g.t("formula.prompt.required"),y=g.t("formula.prompt.optional");b.useEffect(()=>{const E=m.help$.subscribe(w=>{const{visible:R,paramIndex:D,functionInfo:I}=w;if(!R){e(R);return}const k=_.getContextValue(l1)?v.getPosition():p.getRect();if(k==null)return;const{left:O,top:$,height:N}=k,H={functionName:I.functionName,functionType:I.functionType,description:g.t(I.description),abstract:g.t(I.abstract),functionParameter:I.functionParameter.map(X=>({name:g.t(X.name),detail:g.t(X.detail),example:X.example,require:X.require,repeat:X.repeat}))};u([O,$+N]),a(D),f(H),d({left:O,top:$}),e(R)});return()=>{E==null||E.unsubscribe()}},[]);function S(E){a(E)}return Ct.jsx(Ct.Fragment,{children:i?Ct.jsx(OC,{visible:t,offset:l,children:h?Ct.jsxs("div",{className:Oo.formulaHelpFunction,children:[Ct.jsxs("div",{className:Oo.formulaHelpFunctionTitle,children:[Ct.jsx(SUe,{prefix:h.functionName,value:h.functionParameter,active:s,onClick:S}),Ct.jsxs("div",{className:Oo.formulaHelpFunctionTitleIcons,children:[Ct.jsx("div",{className:Oo.formulaHelpFunctionTitleIcon,style:{transform:n?"rotateZ(-90deg)":"rotateZ(90deg)"},onClick:()=>r(!n),children:Ct.jsx(uUe,{})}),Ct.jsx("div",{className:Oo.formulaHelpFunctionTitleIcon,onClick:()=>o(!i),children:Ct.jsx(oUe,{})})]})]}),Ct.jsx("div",{className:Oo.formulaHelpFunctionContent,style:{height:n?"unset":0,padding:n?"revert-layer":0},children:Ct.jsxs("div",{className:Oo.formulaHelpFunctionContentInner,children:[Ct.jsx(Mp,{title:g.t("formula.prompt.helpExample"),value:`${h.functionName}(${h.functionParameter.map(E=>E.example).join(",")})`}),Ct.jsx(Mp,{title:g.t("formula.prompt.helpAbstract"),value:h.description}),h&&h.functionParameter&&h.functionParameter.map((E,w)=>Ct.jsx(Mp,{className:s===w?Oo.formulaHelpFunctionActive:"",title:E.name,value:`${E.require?C:y} ${E.detail}`},w))]})})]}):Ct.jsx(Ct.Fragment,{})}):t?Ct.jsx("div",{className:Oo.formulaHelpDecorator,onClick:()=>o(!i),style:{left:c.left-24,top:c.top},children:Ct.jsx(aUe,{})}):Ct.jsx(Ct.Fragment,{})})}const Mp=t=>Ct.jsxs("div",{className:Oo.formulaHelpFunctionContentParams,children:[Ct.jsx("div",{className:`${Oo.formulaHelpFunctionContentParamsTitle} ${t.className}`,children:t.title}),Ct.jsx("div",{className:Oo.formulaHelpFunctionContentParamsDetail,children:t.value})]}),SUe=t=>{const{prefix:e,value:n,active:r,onClick:i}=t;return Ct.jsxs("div",{children:[Ct.jsxs("span",{children:[e,"("]}),n&&n.map((o,s)=>Ct.jsxs("span",{children:[Ct.jsx("span",{className:r===s?Oo.formulaHelpFunctionActive:"",onClick:()=>i(s),children:o.repeat?`[${o.name},...]`:o.name}),s===n.length-1?"":","]},s)),")"]})},EUe="univer-formula-search-function",wUe="univer-formula-search-function-item",RUe="univer-formula-search-function-item-name",DUe="univer-formula-search-function-item-name-light",IUe="univer-formula-search-function-item-desc",xUe="univer-formula-search-function-item-active",lu={formulaSearchFunction:EUe,formulaSearchFunctionItem:wUe,formulaSearchFunctionItemName:RUe,formulaSearchFunctionItemNameLight:DUe,formulaSearchFunctionItemDesc:IUe,formulaSearchFunctionItemActive:xUe};function MUe(){const[t,e]=b.useState(!1),[n,r]=b.useState(0),[i,o]=b.useState([0,0]),[s,a]=b.useState([]),[l,u]=b.useState(""),c=_t(yc),d=_t(Cc),h=_t(W4),f=_t(Tr);b.useEffect(()=>{let g=[],v=0;const _=c.search$.subscribe(S=>{const{visible:E,searchText:w,searchList:R}=S;if(!E){e(E);return}const D=f.getContextValue(l1)?h.getPosition():d.getRect();if(D==null)return;const{left:I,top:k,height:O}=D;u(w),a(R),g=R,o([I,k+O]),e(E),r(0),v=0}),C=c.navigate$.subscribe(S=>{const{direction:E}=S;if(E===ge.UP){let w=v-1;w=w<0?g.length-1:w,r(w),v=w}else if(E===ge.DOWN){let w=v+1;w=w>=g.length?0:w,r(w),v=w}}),y=c.accept$.subscribe(S=>{const E=g[v].name;c.acceptFormulaName(E)});return()=>{_==null||_.unsubscribe(),C==null||C.unsubscribe(),y==null||y.unsubscribe()}},[]);function m(g){r(g)}function p(){r(-1)}return Ct.jsx(OC,{visible:t,offset:i,children:Ct.jsx("ul",{className:lu.formulaSearchFunction,children:s.map((g,v)=>Ct.jsxs("li",{className:n===v?`${lu.formulaSearchFunctionItem} ${lu.formulaSearchFunctionItemActive}`:lu.formulaSearchFunctionItem,onMouseEnter:()=>m(v),onMouseLeave:p,onClick:()=>c.acceptFormulaName(g.name),children:[Ct.jsxs("span",{className:lu.formulaSearchFunctionItemName,children:[Ct.jsx("span",{className:lu.formulaSearchFunctionItemNameLight,children:l}),Ct.jsx("span",{children:g.name.slice(l.length)})]}),Ct.jsx("span",{className:lu.formulaSearchFunctionItemDesc,children:g.desc})]},v))})})}function OUe(){return Ct.jsxs(Ct.Fragment,{children:[Ct.jsx(MUe,{}),Ct.jsx(yUe,{}),Ct.jsx(qFe,{})]})}const TUe="univer-formula-more-functions",$Ue="univer-formula-more-functions-operation",OI={formulaMoreFunctions:TUe,formulaMoreFunctionsOperation:$Ue};function iU(t){const{prefix:e,value:n}=t;return Ct.jsxs("div",{children:[Ct.jsxs("span",{children:[e,"("]}),n&&n.map((r,i)=>Ct.jsxs("span",{children:[Ct.jsx("span",{children:r.repeat?`[${r.name},...]`:r.name}),i===n.length-1?"":","]},i)),")"]})}const kUe="univer-formula-function-params",AUe="univer-formula-function-params-title",NUe="univer-formula-function-params-detail",Op={formulaFunctionParams:kUe,formulaFunctionParamsTitle:AUe,formulaFunctionParamsDetail:NUe};function Nd(t){const{className:e,value:n,title:r}=t;return Ct.jsxs("div",{className:Op.formulaFunctionParams,children:[Ct.jsx("div",{className:`${Op.formulaFunctionParamsTitle} ${e}`,children:r}),Ct.jsx("div",{className:Op.formulaFunctionParamsDetail,children:n})]})}const LUe="univer-formula-input-params-list",PUe="univer-formula-input-params-list-item-name",BUe="univer-formula-input-params-list-item-selector",vd={formulaInputParamsList:LUe,formulaInputParamsListItemName:PUe,formulaInputParamsListItemSelector:BUe};function FUe(t){const{functionInfo:e,onChange:n}=t;if(!e)return null;const[r,i]=b.useState([]),[o,s]=b.useState(e.functionParameter),[a,l]=b.useState(-1);function u(d,h){const f=[...r];f[h]=d,i(f),n(f)}function c(d){if(d===o.length-1&&o[d].repeat){const h=[...o];h.push(o[d]),s(h)}l(d)}return Ct.jsxs("div",{className:vd.formulaInputParams,children:[Ct.jsx("div",{className:vd.formulaInputParamsList,children:o.map((d,h)=>Ct.jsxs("div",{children:[Ct.jsx("div",{className:vd.formulaInputParamsListItemName,children:d.name}),Ct.jsx("div",{className:vd.formulaInputParamsListItemSelector,children:Ct.jsx(k$e,{onChange:f=>u(f,h),onActive:()=>c(h)})})]},h))}),Ct.jsx("div",{className:vd.formulaInputParamsInfo,children:Ct.jsx(Nd,{title:a===-1?Ct.jsx(iU,{prefix:e.functionName,value:o}):o[a].name,value:a===-1?e.description:o[a].detail})})]})}const UUe=[{functionName:my.MAKEARRAY,aliasFunctionName:"formula.functionList.MAKEARRAY.aliasFunctionName",functionType:uo.Array,description:"formula.functionList.MAKEARRAY.description",abstract:"formula.functionList.MAKEARRAY.abstract",functionParameter:[{name:"formula.functionList.MAKEARRAY.functionParameter.number1.name",detail:"formula.functionList.MAKEARRAY.functionParameter.number1.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.MAKEARRAY.functionParameter.number2.name",detail:"formula.functionList.MAKEARRAY.functionParameter.number2.detail",example:"7",require:1,repeat:0},{name:"formula.functionList.MAKEARRAY.functionParameter.value3.name",detail:"formula.functionList.MAKEARRAY.functionParameter.value3.detail",example:"LAMBDA(r,c, r*c)",require:1,repeat:0}]}],HUe=[],VUe=[],jUe=[],zUe=[],WUe=[],XUe=[],YUe=[],GUe=[],KUe=[],ZUe=[{functionName:ci.ABS,functionType:uo.Math,description:"formula.functionList.ABS.description",abstract:"formula.functionList.ABS.abstract",functionParameter:[{name:"formula.functionList.ABS.functionParameter.number.name",detail:"formula.functionList.ABS.functionParameter.number.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ci.ACOS,functionType:uo.Math,description:"formula.functionList.ACOS.description",abstract:"formula.functionList.ACOS.abstract",functionParameter:[{name:"formula.functionList.ACOS.functionParameter.number.name",detail:"formula.functionList.ACOS.functionParameter.number.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ci.ACOSH,functionType:uo.Math,description:"formula.functionList.ACOSH.description",abstract:"formula.functionList.ACOSH.abstract",functionParameter:[{name:"formula.functionList.ACOSH.functionParameter.number.name",detail:"formula.functionList.ACOSH.functionParameter.number.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ci.ACOT,functionType:uo.Math,description:"formula.functionList.ACOT.description",abstract:"formula.functionList.ACOT.abstract",functionParameter:[{name:"formula.functionList.ACOT.functionParameter.number.name",detail:"formula.functionList.ACOT.functionParameter.number.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ci.SUM,aliasFunctionName:"formula.functionList.SUM.aliasFunctionName",functionType:uo.Math,description:"formula.functionList.SUM.description",abstract:"formula.functionList.SUM.abstract",functionParameter:[{name:"formula.functionList.SUM.functionParameter.number1.name",detail:"formula.functionList.SUM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUM.functionParameter.number2.name",detail:"formula.functionList.SUM.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:ci.SUMIF,aliasFunctionName:"formula.functionList.SUMIF.aliasFunctionName",functionType:uo.Math,description:"formula.functionList.SUMIF.description",abstract:"formula.functionList.SUMIF.abstract",functionParameter:[{name:"formula.functionList.SUMIF.functionParameter.range.name",detail:"formula.functionList.SUMIF.functionParameter.range.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUMIF.functionParameter.criteria.name",detail:"formula.functionList.SUMIF.functionParameter.criteria.detail",example:">5",require:1,repeat:0},{name:"formula.functionList.SUMIF.functionParameter.sum_range.name",detail:"formula.functionList.SUMIF.functionParameter.sum_range.detail",example:"B1:B20",require:0,repeat:0}]}],qUe=[{functionName:Vn.AVERAGE,aliasFunctionName:"formula.functionList.AVERAGE.aliasFunctionName",functionType:uo.Statistical,description:"formula.functionList.AVERAGE.description",abstract:"formula.functionList.AVERAGE.abstract",functionParameter:[{name:"formula.functionList.AVERAGE.functionParameter.number1.name",detail:"formula.functionList.AVERAGE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AVERAGE.functionParameter.number2.name",detail:"formula.functionList.AVERAGE.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:Vn.MAX,aliasFunctionName:"formula.functionList.MAX.aliasFunctionName",functionType:uo.Statistical,description:"formula.functionList.MAX.description",abstract:"formula.functionList.MAX.abstract",functionParameter:[{name:"formula.functionList.MAX.functionParameter.number1.name",detail:"formula.functionList.MAX.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MAX.functionParameter.number2.name",detail:"formula.functionList.MAX.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:Vn.COUNT,aliasFunctionName:"formula.functionList.COUNT.aliasFunctionName",functionType:uo.Statistical,description:"formula.functionList.COUNT.description",abstract:"formula.functionList.COUNT.abstract",functionParameter:[{name:"formula.functionList.COUNT.functionParameter.value1.name",detail:"formula.functionList.COUNT.functionParameter.value1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUNT.functionParameter.value2.name",detail:"formula.functionList.COUNT.functionParameter.value2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:Vn.MIN,aliasFunctionName:"formula.functionList.MIN.aliasFunctionName",functionType:uo.Statistical,description:"formula.functionList.MIN.description",abstract:"formula.functionList.MIN.abstract",functionParameter:[{name:"formula.functionList.MIN.functionParameter.number1.name",detail:"formula.functionList.MIN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MIN.functionParameter.number2.name",detail:"formula.functionList.MIN.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:Vn.COUNTA,aliasFunctionName:"formula.functionList.COUNTA.aliasFunctionName",functionType:uo.Statistical,description:"formula.functionList.COUNT_A.description",abstract:"formula.functionList.COUNT_A.abstract",functionParameter:[{name:"formula.functionList.COUNT_A.functionParameter.number1.name",detail:"formula.functionList.COUNT_A.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUNT_A.functionParameter.number2.name",detail:"formula.functionList.COUNT_A.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]}],QUe=[],JUe=[],eHe=[],tHe=[...XUe,...zUe,...ZUe,...qUe,...KUe,...jUe,...QUe,...GUe,...YUe,...WUe,...VUe,...HUe,...eHe,...UUe,...JUe];function nHe(t,e){return Object.keys(t).filter(n=>isNaN(Number(n))).map(n=>({label:e.t(`formula.functionType.${n.toLocaleLowerCase()}`),value:`${t[n]}`}))}function rHe(t,e){let n="";return t.aliasFunctionName?(n=e.t(t.aliasFunctionName),n===t.aliasFunctionName&&(n=t.functionName)):n=t.functionName,n}var iHe=Object.defineProperty,oHe=Object.getOwnPropertyDescriptor,sHe=(t,e,n,r)=>{for(var i=r>1?void 0:r?oHe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&iHe(e,n,i),i},TI=(t,e)=>(n,r)=>e(n,r,t);const Xy=nn("formula-ui.description-service");let H_=class{constructor(e,n,r){this._description=e,this._functionService=n,this._localeService=r,this._initialize(),this._registerDescription()}dispose(){this._localeService.localeChanged$.complete()}getDescriptions(){return this._functionService.getDescriptions()}hasFunction(e){return this._functionService.getDescriptions().get(e.toLocaleUpperCase())!==void 0}getFunctionInfo(e){return this._functionService.getDescriptions().get(e.toLocaleUpperCase())}getSearchListByName(e){const n=[],r=this._functionService.getDescriptions();return e=e.toLocaleUpperCase(),r.forEach(i=>{const{functionName:o,abstract:s}=i;o.indexOf(e)>-1&&n.push({name:o,desc:s})}),n}getSearchListByNameFirstLetter(e){const n=[],r=this._functionService.getDescriptions();return e=e.toLocaleUpperCase(),r.forEach(i=>{const{functionName:o,abstract:s}=i;o.indexOf(e)===0&&n.push({name:o,desc:s})}),n}getSearchListByType(e){const n=[];return this._functionService.getDescriptions().forEach(r=>{const{functionName:i,functionType:o,abstract:s}=r;(o===e||e===-1)&&n.push({name:i,desc:s})}),n}_initialize(){this._localeService.localeChanged$.subscribe(()=>{this._registerDescription()})}_registerDescription(){const e=this._localeService,n=tHe.concat(this._description||[]).map(r=>({functionName:rHe(r,e),functionType:r.functionType,description:e.t(r.description),abstract:e.t(r.abstract),functionParameter:r.functionParameter.map(i=>({name:e.t(i.name),detail:e.t(i.detail),example:i.example,require:i.require,repeat:i.repeat}))}));this._functionService.registerDescriptions(...n)}};H_=sHe([TI(1,x1),TI(2,ne(mn))],H_);const aHe="univer-formula-select-function-select",lHe="univer-formula-select-function-result",uHe="univer-formula-select-function-result-item",cHe="univer-formula-select-function-result-item-name-light",dHe="univer-formula-select-function-result-item-selected",hHe="univer-formula-select-function-result-item-active",fHe="univer-formula-select-function-content",qa={formulaSelectFunctionSelect:aHe,formulaSelectFunctionResult:lHe,formulaSelectFunctionResultItem:uHe,formulaSelectFunctionResultItemNameLight:cHe,formulaSelectFunctionResultItemSelected:dHe,formulaSelectFunctionResultItemActive:hHe,formulaSelectFunctionContent:fHe};function mHe(t){const{onChange:e}=t,n="-1",[r,i]=b.useState(""),[o,s]=b.useState([]),[a,l]=b.useState(0),[u,c]=b.useState(n),[d,h]=b.useState(0),[f,m]=b.useState(null),p=_t(Xy),g=_t(mn),v=nHe(uo,g);v.unshift({label:g.t("formula.moreFunctions.allFunctions"),value:n});const _=g.t("formula.prompt.required"),C=g.t("formula.prompt.optional");b.useEffect(()=>{E(n)},[]),b.useEffect(()=>{S(0)},[o]);const y=k=>{if(r.trim()==="")return k;const O=new RegExp(`(${r.toLocaleUpperCase()})`);return k.split(O).filter(Boolean).map(($,N)=>$.match(O)?Ct.jsx("span",{className:qa.formulaSelectFunctionResultItemNameLight,children:$},N):$)},S=k=>{if(o.length===0){m(null);return}h(k);const O=p.getFunctionInfo(o[k].name);if(!O){m(null);return}m(O),e(O)};function E(k){c(k);const O=p.getSearchListByType(+k);s(O)}function w(k){i(k);const O=p.getSearchListByName(k);s(O)}function R(k){if(k.stopPropagation(),k.key==="ArrowDown"){const O=a+1;l(O===o.length?0:O)}else if(k.key==="ArrowUp"){const O=a-1;l(O===-1?o.length-1:O)}else k.key==="Enter"&&S(a)}const D=k=>{l(k)},I=()=>{l(-1)};return Ct.jsxs("div",{children:[Ct.jsxs("div",{className:qa.formulaSelectFunctionSelect,children:[Ct.jsx(k9,{value:u,options:v,onChange:E}),Ct.jsx(eQ,{placeholder:g.t("formula.moreFunctions.searchFunctionPlaceholder"),onKeyDown:R,value:r,onChange:w,size:"large",allowClear:!0})]}),Ct.jsx("ul",{className:qa.formulaSelectFunctionResult,onKeyDown:R,tabIndex:-1,children:o.map(({name:k},O)=>Ct.jsxs("li",{className:a===O?`${qa.formulaSelectFunctionResultItem} ${qa.formulaSelectFunctionResultItemActive}`:qa.formulaSelectFunctionResultItem,onMouseEnter:()=>D(O),onMouseLeave:I,onClick:()=>S(O),children:[d===O&&Ct.jsx(rUe,{className:qa.formulaSelectFunctionResultItemSelected}),Ct.jsx("span",{className:qa.formulaSelectFunctionResultItemName,children:y(k)})]},O))}),f&&Ct.jsxs("div",{className:qa.formulaSelectFunctionContent,children:[Ct.jsx(Nd,{title:f.functionName,value:f.description}),Ct.jsx(Nd,{title:g.t("formula.moreFunctions.syntax"),value:Ct.jsx(iU,{prefix:f.functionName,value:f.functionParameter})}),Ct.jsx(Nd,{title:g.t("formula.prompt.helpExample"),value:`${f.functionName}(${f.functionParameter.map(k=>k.example).join(",")})`}),f.functionParameter&&f.functionParameter.map((k,O)=>Ct.jsx(Nd,{title:k.name,value:`${k.require?_:C} ${k.detail}`},O))]})]})}function pHe(){const[t,e]=b.useState(!0),[n,r]=b.useState(!1),[i,o]=b.useState([]),[s,a]=b.useState(null),l=_t(mn);_t(C0);const u=_t(G4);function c(){e(!t),r(!n)}function d(){u.inputFormula(`=${s==null?void 0:s.functionName}(`)}return Ct.jsxs("div",{className:OI.formulaMoreFunctions,children:[t&&Ct.jsx(mHe,{onChange:a}),n&&Ct.jsx(FUe,{functionInfo:s,onChange:o}),Ct.jsxs("div",{className:OI.formulaMoreFunctionsOperation,children:[n&&Ct.jsx(c1,{type:"primary",size:"small",onClick:c,children:l.t("formula.moreFunctions.next")}),n&&Ct.jsx(c1,{size:"small",onClick:c,children:l.t("formula.moreFunctions.prev")}),t&&Ct.jsx(c1,{type:"primary",size:"small",onClick:d,children:l.t("formula.moreFunctions.confirm")})]})]})}function gHe(t){return{id:Wy.id,icon:"FunctionSingle",tooltip:"formula.insert.tooltip",group:un.TOOLBAR_FORMULAS_INSERT,type:gt.SELECTOR,positions:[yn.TOOLBAR_START],selections:[{label:"SUM",value:"SUM",icon:"SumSingle"},{label:"AVERAGE",value:"AVERAGE",icon:"AvgSingle"},{label:"COUNT",value:"COUNT",icon:"CntSingle"},{label:"MAX",value:"MAX",icon:"MaxSingle"},{label:"MIN",value:"MIN",icon:"MinSingle"}],hidden$:jr(t,Pr.SHEET)}}function vHe(t){return{id:ZF.id,title:"formula.insert.more",positions:Wy.id,type:gt.BUTTON}}function _He(t){return{id:YF.id,type:gt.BUTTON,title:"formula.operation.pasteFormula",positions:[P0]}}const oU="meta_key_ctrl_And_Shift",Mf=[Xe.ARROW_DOWN,Xe.ARROW_UP,Xe.ARROW_LEFT,Xe.ARROW_RIGHT],bHe=[...Mf,Xe.ENTER,Xe.TAB];function CHe(){const t=[];for(const e of bHe)t.push({id:F0.id,binding:e,preconditions:n=>V4(n),staticParameters:{eventType:Zn.Keyboard,keycode:e}});return t}function yHe(){const t=[];for(const e of Mf)t.push({id:F0.id,binding:e|Ut.SHIFT,preconditions:n=>V4(n),staticParameters:{eventType:Zn.Keyboard,keycode:e,metaKey:Ut.SHIFT}});return t}function SHe(){const t=[];for(const e of Mf)t.push({id:F0.id,binding:e|Ut.CTRL_COMMAND,preconditions:n=>V4(n),staticParameters:{eventType:Zn.Keyboard,keycode:e,metaKey:Ut.CTRL_COMMAND}});return t}function EHe(){const t=[];for(const e of Mf)t.push({id:F0.id,binding:e|Ut.SHIFT|Ut.CTRL_COMMAND,preconditions:n=>V4(n),staticParameters:{eventType:Zn.Keyboard,keycode:e,metaKey:oU}});return t}const wHe={id:zy.id,binding:Xe.F4,preconditions:t=>V4(t)};var RHe=Object.defineProperty,DHe=Object.getOwnPropertyDescriptor,IHe=(t,e,n,r)=>{for(var i=r>1?void 0:r?DHe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&RHe(e,n,i),i},Wc=(t,e)=>(n,r)=>e(n,r,t);let z8=class extends je{constructor(t,e,n,r,i,o){super(),this._injector=t,this._menuService=e,this._commandService=n,this._shortcutService=r,this._uiController=i,this._componentManager=o,this._initialize()}_initialize(){this._registerCommands(),this._registerMenus(),this._registerShortcuts(),this._registerComponents()}_registerMenus(){[gHe,vHe,_He].forEach(t=>{this.disposeWithMe(this._menuService.addMenuItem(this._injector.invoke(t)))})}_registerCommands(){[GF,YF,Wy,ZF,U_,F_,F0,zy].forEach(t=>this.disposeWithMe(this._commandService.registerCommand(t)))}_registerShortcuts(){[...CHe(),...yHe(),...SHe(),...EHe(),wHe].forEach(t=>{this.disposeWithMe(this._shortcutService.registerShortcut(t))})}_registerComponents(){this.disposeWithMe(this._uiController.registerContentComponent(()=>Qd(OUe,this._injector))),this._componentManager.register(KF,pHe)}};z8=IHe([yt(it.Ready,z8),Wc(0,ne(Tn)),Wc(1,I1),Wc(2,le),Wc(3,Xl),Wc(4,U6),Wc(5,ne(Pa))],z8);const $I="formula_reference_selection_plugin_name";function Tp(t,e,n){const r=t.getCurrentTheme(),i=new _o(e).setAlpha(.05).toRgbString();return{id:n,strokeWidth:1.5,stroke:e,fill:i,widgets:{tl:!0,tc:!0,tr:!0,ml:!0,mr:!0,bl:!0,bc:!0,br:!0},widgetSize:6,widgetStrokeWidth:1,widgetStroke:r.colorWhite,hasAutoFill:!1,hasRowHeader:!1,hasColumnHeader:!1}}var xHe=Object.defineProperty,MHe=Object.getOwnPropertyDescriptor,OHe=(t,e,n,r)=>{for(var i=r>1?void 0:r?MHe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&xHe(e,n,i),i},$i=(t,e)=>(n,r)=>e(n,r,t);let W8=class extends je{constructor(t,e,n,r,i,o,s,a,l,u,c,d,h,f,m,p){super(),fn(this,"_formulaRefColors",[]),fn(this,"_previousSequenceNodes"),fn(this,"_previousRangesCount",0),fn(this,"_previousInsertRefStringIndex"),fn(this,"_currentInsertRefStringIndex",-1),fn(this,"_currentUnitId"),fn(this,"_currentSheetId"),fn(this,"_arrowMoveActionState",0),fn(this,"_isSelectionMovingRefSelections",[]),fn(this,"_stringColor",""),fn(this,"_numberColor",""),fn(this,"_insertSelections",[]),fn(this,"_inputPanelState",0),this._commandService=t,this._contextService=e,this._textSelectionRenderManager=n,this._editorBridgeService=r,this._formulaPromptService=i,this._lexerTreeBuilder=o,this._renderManagerService=s,this._themeService=a,this._selectionManagerService=l,this._sheetSkeletonManagerService=u,this._currentUniverService=c,this._selectionRenderService=d,this._descriptionService=h,this._textSelectionManagerService=f,this._formulaInputService=m,this._docViewModelManagerService=p,this._initialize()}dispose(){this._formulaRefColors=[],this._resetTemp()}_resetTemp(){this._previousSequenceNodes=null,this._previousInsertRefStringIndex=null,this._currentUnitId=null,this._currentSheetId=null,this._isSelectionMovingRefSelections=[],this._previousRangesCount=0,this._currentInsertRefStringIndex=-1}_initialize(){this._initialCursorSync(),this._initAcceptFormula(),this._initialFormulaTheme(),this._initialRefSelectionUpdateEvent(),this._initialRefSelectionInsertEvent(),this._initialExitEditor(),this._initialEditorInputChange(),this._commandExecutedListener(),this._cursorStateListener(),this._syncEditorListener()}_initialFormulaTheme(){const t=this._themeService.getCurrentTheme();this._formulaRefColors=[t.loopColor1,t.loopColor2,t.loopColor3,t.loopColor4,t.loopColor5,t.loopColor6,t.loopColor7,t.loopColor8,t.loopColor9,t.loopColor10,t.loopColor11,t.loopColor12],this._numberColor=t.hyacinth700,this._stringColor=t.verdancy800}_initialCursorSync(){this.disposeWithMe(Be(this._textSelectionManagerService.textSelection$.subscribe(t=>{if(this._editorBridgeService.isVisible().visible===!1||this._formulaInputService.isSelectionMoving()||(t==null?void 0:t.unitId)==null||![Un,Zr].includes(t.unitId))return;const e=this._getCurrentBody(),n=(e==null?void 0:e.dataStream)||"";this._contextSwitch(n),this._changeKeepVisibleHideState(),this._switchSelectionPlugin(),!this._formulaInputService.isLockedSelectionChange()&&(this._highlightFormula(),this._changeFunctionPanelState())})))}_initialEditorInputChange(){this.disposeWithMe(Be(this._textSelectionRenderManager.onInputBefore$.subscribe(t=>{this._previousSequenceNodes=null,this._previousInsertRefStringIndex=null,this._selectionRenderService.enableSkipRemainLast();const e=t==null?void 0:t.event;e!=null&&([Xe.ARROW_DOWN,Xe.ARROW_UP,Xe.ARROW_LEFT,Xe.ARROW_RIGHT].includes(e.which)?this._inputPanelState=2:(this._arrowMoveActionState!==1&&(this._arrowMoveActionState=2),this._inputPanelState=1))})))}_initialExitEditor(){this.disposeWithMe(Be(this._editorBridgeService.afterVisible$.subscribe(t=>{if(t.visible===!0){const{unitId:n,sheetId:r}=this._getCurrentUnitIdAndSheetId();this._currentUnitId==null&&(this._currentUnitId=n),this._currentSheetId==null&&(this._currentSheetId=r);return}const e=this._selectionManagerService.getCurrent();if((e==null?void 0:e.pluginName)===On){this._disableForceKeepVisible();return}this._selectionManagerService.clear(),this._selectionManagerService.changePlugin(On),this._updateEditorModel(`\r
`,[]),this._contextService.setContextValue(yu,!1),this._disableForceKeepVisible(),this._selectionRenderService.resetStyle(),this._resetTemp(),this._hideFunctionPanel()})))}_initialRefSelectionUpdateEvent(){const t=new Ia;this.disposeWithMe(Be(this._selectionManagerService.selectionMoveEnd$.subscribe(()=>{t.dispose();const e=this._selectionManagerService.getCurrent();this._formulaInputService.disableSelectionMoving(),(e==null?void 0:e.pluginName)===$I&&(this._updateRefSelectionStyle(this._isSelectionMovingRefSelections),this._selectionRenderService.getCurrentControls().forEach(n=>{n.disableHelperSelection(),t.add(Be(n.selectionMoving$.subscribe(r=>{this._changeControlSelection(r,n)}))),t.add(Be(n.selectionScaling$.subscribe(r=>{this._changeControlSelection(r,n)}))),t.add(Be(n.selectionMoved$.subscribe(()=>{this._formulaInputService.disableLockedSelectionChange()}))),t.add(Be(n.selectionScaled$.subscribe(()=>{this._formulaInputService.disableLockedSelectionChange()})))}))})))}_syncEditorListener(){this.disposeWithMe(Be(this._formulaInputService.syncToEditor$.subscribe(t=>{const{sequences:e,textSelectionOffset:n}=t;this._syncToEditor(e,n)})))}_selectionChanging(t,e=!1){if(t.length===0||!this._formulaInputService.isLockedSelectionInsert()||(this._formulaInputService.enableSelectionMoving(),this._inertControlSelection(t),e===!1))return;const n=t[t.length-1];this._inertControlSelectionReplace(n)}_initialRefSelectionInsertEvent(){this.disposeWithMe(Be(this._selectionRenderService.selectionMoving$.subscribe(t=>{this._selectionChanging(t.map(e=>a8(e)))}))),this.disposeWithMe(Be(this._selectionRenderService.selectionMoveStart$.subscribe(t=>{this._selectionChanging(t.map(e=>a8(e)),!0)})))}_initAcceptFormula(){this.disposeWithMe(Be(this._formulaPromptService.acceptFormulaName$.subscribe(t=>{const e=this._textSelectionManagerService.getActiveRange();if(e==null){this._hideFunctionPanel();return}const{startOffset:n}=e,r=this._formulaInputService.getSequenceNodes(),i=this._formulaInputService.getCurrentSequenceNodeIndex(n-2),o=r[i];if(o==null||typeof o=="string"){this._hideFunctionPanel();return}const s=t.length-o.token.length,a={...o};a.token=t,a.endIndex+=s,r[i]=a,r.splice(i+1,0,cn.OPEN_BRACKET);const l=t.length+1;for(let u=i+2,c=r.length;u<c;u++){const d=r[u];if(typeof d=="string")continue;const h={...d};h.startIndex+=l,h.endIndex+=l,r[u]=h}this._syncToEditor(r,a.endIndex+2)})))}_changeFunctionPanelState(){const t=this._textSelectionManagerService.getActiveRange();if(t==null){this._hideFunctionPanel();return}const{startOffset:e}=t,n=this._formulaInputService.getCurrentSequenceNode(e-2);if(n==null){this._hideFunctionPanel();return}if(typeof n!="string"&&n.nodeType===Hr.FUNCTION){const l=n.token.toUpperCase();if(this._inputPanelState===1){const u=this._descriptionService.getSearchListByNameFirstLetter(l);if(this._hideFunctionPanel(),u==null||u.length===0)return;this._commandService.executeCommand(U_.id,{visible:!0,searchText:l,searchList:u})}else this._descriptionService.hasFunction(l)&&this._changeHelpFunctionPanelState(l,-1);return}const r=this._getCurrentBody(),i=(r==null?void 0:r.dataStream)||"",o=this._lexerTreeBuilder.getFunctionAndParameter(i,e-1);if(o==null){this._hideFunctionPanel();return}const{functionName:s,paramIndex:a}=o;this._changeHelpFunctionPanelState(s.toUpperCase(),a)}_changeHelpFunctionPanelState(t,e){const n=this._descriptionService.getFunctionInfo(t);this._hideFunctionPanel(),n!=null&&this._commandService.executeCommand(F_.id,{visible:!0,paramIndex:e,functionInfo:n})}_hideFunctionPanel(){this._commandService.executeCommand(U_.id,{visible:!1,searchText:""}),this._commandService.executeCommand(F_.id,{visible:!1,paramIndex:-1})}_changeKeepVisibleHideState(){if(this._getContextState()===!1){this._disableForceKeepVisible();return}const t=this._getCurrentChar();if(t==null){this._disableForceKeepVisible();return}this._matchRefDrawToken(t)?(this._editorBridgeService.enableForceKeepVisible(),this._formulaInputService.enableLockedSelectionInsert(),this._selectionRenderService.enableRemainLast(),this._arrowMoveActionState!==1&&(this._arrowMoveActionState=2)):this._disableForceKeepVisible()}_matchRefDrawToken(t){return o_(t)&&t!==cn.CLOSE_BRACES&&t!==cn.CLOSE_BRACKET&&t!==cn.SINGLE_QUOTATION&&t!==cn.DOUBLE_QUOTATION||t===" "}_getCurrentChar(){const t=this._textSelectionManagerService.getActiveRange();if(t==null)return;const{startOffset:e}=t,n=this._getCurrentBody();return n==null||e==null?void 0:n.dataStream[e-1]}_disableForceKeepVisible(){this._editorBridgeService.disableForceKeepVisible(),this._formulaInputService.disableLockedSelectionInsert(),this._currentInsertRefStringIndex=-1,this._selectionRenderService.disableRemainLast(),this._arrowMoveActionState===2&&(this._arrowMoveActionState=4)}_getCurrentBody(){var t;const e=this._editorBridgeService.getCurrentEditorId();if(e==null)return;const n=this._currentUniverService.getUniverDocInstance(e);return(t=n==null?void 0:n.snapshot)==null?void 0:t.body}_getFormulaAndCellEditorBody(){return[Un,Zr].map(t=>{const e=this._currentUniverService.getUniverDocInstance(t);return e==null?void 0:e.getBody()})}_contextSwitch(t){if(Ao(t)){this._contextService.setContextValue(yu,!0);const e=this._lexerTreeBuilder.sequenceNodesBuilder(t.replace(/\r/g,"").replace(/\n/g,""))||[];this._formulaInputService.setSequenceNodes(e);const n=this._textSelectionManagerService.getActiveRange();if(n==null)return;const{startOffset:r}=n;this._currentInsertRefStringIndex=r-1}else this._contextService.setContextValue(yu,!1),this._formulaInputService.disableLockedSelectionChange(),this._formulaInputService.disableLockedSelectionInsert(),this._formulaInputService.clearSequenceNodes(),this._hideFunctionPanel()}_getContextState(){return this._contextService.getContextValue(yu)}_switchSelectionPlugin(){if(this._getContextState()===!0){this._selectionManagerService.changePluginNoRefresh($I);const t=Pu(this._themeService);t.strokeDash=8,t.hasAutoFill=!1,t.hasRowHeader=!1,t.hasColumnHeader=!1,this._selectionRenderService.setStyle(t)}else this._selectionManagerService.changePluginNoRefresh(On),this._selectionRenderService.resetStyle()}_highlightFormula(){if(this._getContextState()===!1)return;const t=this._formulaInputService.getSequenceNodes(),e=this._getFormulaAndCellEditorBody().filter(n=>!!n);if(this._selectionManagerService.clear(),t==null||t.length===0)e.forEach(n=>n.textRuns=[]);else{const{textRuns:n,refSelections:r}=this._buildTextRuns(t);e.forEach(i=>i.textRuns=n),this._refreshSelectionForReference(r)}this._refreshFormulaAndCellEditor()}_buildTextRuns(t){const e=[],n=[];let r=0;for(let i=0,o=t.length;i<o;i++){const s=t[i];if(typeof s=="string")continue;const{startIndex:a,endIndex:l,nodeType:u,token:c}=s;let d="";if(u===Hr.REFERENCE){const h=r%this._formulaRefColors.length;d=this._formulaRefColors[h],n.push({refIndex:i,themeColor:d,token:c}),r++}else u===Hr.NUMBER?d=this._numberColor:u===Hr.STRING?d=this._stringColor:u===Hr.ARRAY&&(d=this._stringColor);d&&d.length>0&&e.push({st:a+1,ed:l+2,ts:{cl:{rgb:d}}})}return{textRuns:e,refSelections:n}}_refreshSelectionForReference(t){var e;const{unitId:n,sheetId:r}=this._getCurrentUnitIdAndSheetId(),i=[],o=this._currentUniverService.getUniverSheetInstance(n);if((o==null?void 0:o.getSheetBySheetId(r))==null)return;let s=null;for(let a=0,l=t.length;a<l;a++){const u=t[a],{themeColor:c,token:d,refIndex:h}=u,f=xa(d),{unitId:m,sheetName:p,range:g}=f;if(m!=null&&m.length>0&&n!==m)continue;const v=this._getSheetIdByName(n,p.trim());if(p.length!==0&&v!==r)continue;const _=(e=this._insertSelections.find(C=>{const{startRow:y,startColumn:S,endRow:E,endColumn:w}=C.range;return y===g.startRow&&S===g.startColumn&&E===g.endRow&&w===g.endColumn||y===g.startRow&&S===g.startColumn&&g.startRow===g.endRow&&g.startColumn===g.endColumn}))==null?void 0:e.primary;if(_!=null){const{isMerged:C,isMergedMainCell:y,startRow:S,endRow:E,startColumn:w,endColumn:R}=_;(C||y)&&S===g.startRow&&w===g.startColumn&&g.startRow===g.endRow&&g.startColumn===g.endColumn&&(g.endRow=E,g.endColumn=R),s={range:g,primary:_,style:Tp(this._themeService,c,h.toString())};continue}i.push({range:g,primary:_,style:Tp(this._themeService,c,h.toString())})}s&&i.push(s),i.length!==0&&this._selectionManagerService.add(i)}_getSheetIdByName(t,e){var n;const r=this._currentUniverService.getUniverSheetInstance(t);return(n=r==null?void 0:r.getSheetBySheetName(yDe(e)))==null?void 0:n.getSheetId()}_getSheetNameById(t,e){var n;const r=this._currentUniverService.getUniverSheetInstance(t);let i=((n=r==null?void 0:r.getSheetBySheetId(e))==null?void 0:n.getName())||"";return i.length>0&&CDe(i)&&(i=`'${i}'`),i}_getCurrentUnitIdAndSheetId(){const t=this._sheetSkeletonManagerService.getCurrent();if(t==null){const i=this._currentUniverService.getCurrentUniverSheetInstance(),o=i.getActiveSheet();return{unitId:i.getUnitId(),sheetId:o.getSheetId()}}const{unitId:e,sheetId:n,skeleton:r}=t;return{unitId:e,sheetId:n,skeleton:r}}_getRefString(t){const{unitId:e,sheetId:n}=this._getCurrentUnitIdAndSheetId();let r="",i="";e===this._currentUnitId?r="":r=e,n===this._currentSheetId?i="":i=this._getSheetNameById(e,n);const{range:o,primary:s}=t;let{startRow:a,endRow:l,startColumn:u,endColumn:c}=o;if(s){const{isMerged:d,isMergedMainCell:h,startRow:f,endRow:m,startColumn:p,endColumn:g}=s;(d||h)&&f===a&&p===u&&m===l&&g===c&&(a=f,u=p,l=f,c=p)}return Bd({sheetName:i,unitId:r,range:{startRow:a,endRow:l,startColumn:u,endColumn:c}})}async _syncToEditor(t,e,n=!0){const r=cy(t),{textRuns:i,refSelections:o}=this._buildTextRuns(t);this._isSelectionMovingRefSelections=o;const s=this._textSelectionManagerService.getActiveRange();if(s==null)return;const{collapsed:a,style:l}=s;this._currentInsertRefStringIndex=e,await this._fitEditorSize(),n?this._commandService.executeCommand(_P.id,{unitId:this._editorBridgeService.getCurrentEditorId(),body:{dataStream:`=${r}`,textRuns:i},textRanges:[{startOffset:e+1,endOffset:e+1,collapsed:a,style:l}],segmentId:null}):(this._updateEditorModel(`=${r}\r
`,i),this._textSelectionManagerService.replaceTextRanges([{startOffset:e+1,endOffset:e+1,style:l}])),setTimeout(()=>{this._textSelectionRenderManager.focus()},0)}async _fitEditorSize(){const t=this._editorBridgeService.getCurrentEditorId();t!=null&&await this._commandService.syncExecuteCommand(Sf.id,{unitId:t})}_updateEditorModel(t,e){const n=this._editorBridgeService.getCurrentEditorId();if(n==null)return;const r=this._currentUniverService.getUniverDocInstance(n),i=this._docViewModelManagerService.getViewModel(n);if(i==null||r==null)return;const o=r==null?void 0:r.getSnapshot();if(o==null)return;const s={dataStream:t,textRuns:e};o.body=s,i.reset(r)}_inertControlSelectionReplace(t){this._previousSequenceNodes==null&&(this._previousSequenceNodes=this._formulaInputService.getSequenceNodes()),this._previousInsertRefStringIndex==null&&(this._previousInsertRefStringIndex=this._currentInsertRefStringIndex);const e=De.deepClone(this._previousSequenceNodes);if(e==null)return;const n=this._getRefString(t);this._formulaInputService.setSequenceNodes(e),this._formulaInputService.insertSequenceRef(this._previousInsertRefStringIndex,n),this._syncToEditor(e,this._previousInsertRefStringIndex+n.length);const r=this._selectionRenderService.getSelectionDataWithStyle();this._insertSelections=[],r.forEach(i=>{const o=a8(i);this._insertSelections.push(o)})}_inertControlSelection(t){const e=t[t.length-1];if((t.length===this._previousRangesCount||this._previousRangesCount===0)&&this._previousSequenceNodes!=null)this._inertControlSelectionReplace(e);else{let n=this._formulaInputService.getSequenceNodes();if(n==null)return;const r=this._getCurrentChar();if(r==null)return;this._previousInsertRefStringIndex=this._currentInsertRefStringIndex,this._matchRefDrawToken(r)||(this._formulaInputService.insertSequenceString(this._currentInsertRefStringIndex,cn.COMMA),n=this._formulaInputService.getSequenceNodes(),this._previousInsertRefStringIndex+=1),this._previousSequenceNodes=De.deepClone(n);const i=this._getRefString(e);this._formulaInputService.setSequenceNodes(n),this._formulaInputService.insertSequenceRef(this._previousInsertRefStringIndex,i),this._selectionRenderService.disableSkipRemainLast()}this._arrowMoveActionState=2,this._previousRangesCount=t.length}_updateRefSelectionStyle(t){const e=this._selectionRenderService.getCurrentControls(),{unitId:n,sheetId:r}=this._getCurrentUnitIdAndSheetId();for(let i=0,o=t.length;i<o;i++){const s=t[i],{refIndex:a,themeColor:l,token:u}=s,c=xa(u),{unitId:d,sheetName:h,range:f}=c;if(d!=null&&d.length>0&&n!==d)continue;const m=this._getSheetIdByName(n,h.trim());if(m!=null&&m!==r)continue;const p=e.find(v=>{const{startRow:_,startColumn:C,endRow:y,endColumn:S}=v.getRange();return _===f.startRow&&C===f.startColumn&&y===f.endRow&&S===f.endColumn||_===f.startRow&&C===f.startColumn&&f.startRow===f.endRow&&f.startColumn===f.endColumn});if(p==null)continue;const g=Tp(this._themeService,l,a.toString());p.updateStyle(g)}}_changeControlSelection(t,e){var n;if(!t)return;const{unitId:r,sheetId:i,skeleton:o}=this._getCurrentUnitIdAndSheetId();this._formulaInputService.enableLockedSelectionChange();const s=(n=e.selectionStyle)==null?void 0:n.id;if(s==null||!De.isStringNumber(s))return;let{startRow:a,endRow:l,startColumn:u,endColumn:c}=t;const d=cc(a,u,o==null?void 0:o.mergeData);if(d){const{isMerged:g,isMergedMainCell:v,startRow:_,endRow:C,startColumn:y,endColumn:S}=d;(g||v)&&_===a&&y===u&&C===l&&S===c&&(a=_,u=y,l=_,c=y)}const h=this._getRefString({range:{startRow:a,endRow:l,startColumn:u,endColumn:c},primary:d,style:null}),f=Number(s);this._formulaInputService.updateSequenceRef(f,h);const m=this._formulaInputService.getSequenceNodes(),p=m[f];typeof p!="string"&&(this._syncToEditor(m,p.endIndex+1),e.update(t,void 0,void 0,void 0,this._selectionRenderService.convertCellRangeToInfo(d)))}_refreshFormulaAndCellEditor(){var t;const e=[Un,Zr];for(const n of e){const r=o0(n,this._renderManagerService),i=r==null?void 0:r.document;i!=null&&((t=i.getSkeleton())==null||t.calculate(),i.makeDirty())}}_cursorStateListener(){const t=this._getEditorObject();if(t==null)return;const{document:e}=t;this.disposeWithMe(Be(e.onPointerDownObserver.add(()=>{this._arrowMoveActionState=1,this._inputPanelState=3})))}_commandExecutedListener(){const t=[F0.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)){const n=e.params,{keycode:r,metaKey:i}=n;if(r===Xe.ENTER){if(this._formulaPromptService.isSearching()){this._formulaPromptService.accept(!0);return}this._editorBridgeService.changeVisible({visible:!1,eventType:Zn.Keyboard,keycode:r}),this._commandService.executeCommand(Yi.id,{direction:ge.DOWN});return}if(r===Xe.TAB){if(this._formulaPromptService.isSearching()){this._formulaPromptService.accept(!0);return}this._editorBridgeService.changeVisible({visible:!1,eventType:Zn.Keyboard,keycode:r}),this._commandService.executeCommand(Yi.id,{direction:ge.RIGHT});return}if(this._formulaPromptService.isSearching()){if(r===Xe.ARROW_DOWN){this._formulaPromptService.navigate({direction:ge.DOWN});return}if(r===Xe.ARROW_UP){this._formulaPromptService.navigate({direction:ge.UP});return}}if(this._arrowMoveActionState===1){this._moveInEditor(r);return}if(this._arrowMoveActionState===4){this._editorBridgeService.changeVisible({visible:!1,eventType:Zn.Keyboard,keycode:r});return}if(this._arrowMoveActionState===2&&(this._arrowMoveActionState=3),(this._selectionManagerService.getSelectionRanges()||[]).length===0){const l=this._selectionManagerService.getLastByPlugin(On);if(l!=null){const u=De.deepClone(l);this._selectionManagerService.add([u])}}let o=ge.DOWN;r===Xe.ARROW_DOWN?o=ge.DOWN:r===Xe.ARROW_UP?o=ge.UP:r===Xe.ARROW_LEFT?o=ge.LEFT:r===Xe.ARROW_RIGHT&&(o=ge.RIGHT),i===Ut.CTRL_COMMAND?this._commandService.executeCommand(Yi.id,{direction:o,jumpOver:Qs.moveGap}):i===Ut.SHIFT?this._commandService.executeCommand(Js.id,{direction:o}):i===oU?this._commandService.executeCommand(Js.id,{direction:o,jumpOver:Qs.moveGap}):this._commandService.executeCommand(Yi.id,{direction:o});const s=this._selectionManagerService.getSelections()||[],a=s[s.length-1];this._inertControlSelectionReplace(a)}}))}_moveInEditor(t){if(t==null)return;let e=ge.LEFT;t===Xe.ARROW_DOWN?e=ge.DOWN:t===Xe.ARROW_UP?e=ge.UP:t===Xe.ARROW_RIGHT&&(e=ge.RIGHT),this._commandService.executeCommand(_1.id,{direction:e})}_getEditorObject(){return o0(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}};W8=OHe([yt(it.Steady,W8),$i(0,le),$i(1,Tr),$i(2,Wl),$i(3,ne(Eo)),$i(4,ne(yc)),$i(5,ne(Ba)),$i(6,kn),$i(7,ne(Ki)),$i(8,ne(ut)),$i(9,ne(kr)),$i(10,oe),$i(11,ne(to)),$i(12,ne(Xy)),$i(13,ne(gr)),$i(14,G4),$i(15,ne(v1))],W8);var THe=Object.defineProperty,$He=Object.getOwnPropertyDescriptor,kHe=(t,e,n,r)=>{for(var i=r>1?void 0:r?$He(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&THe(e,n,i),i},kI=(t,e)=>(n,r)=>e(n,r,t);let X8=class extends je{constructor(t,e){super(),fn(this,"_waitingCommandQueue",[]),fn(this,"_executingCommandQueue",[]),fn(this,"_setTimeoutKey",-1),fn(this,"_startExecutionTime",0),this._commandService=t,this._activeDirtyManagerService=e,this._initialize()}_initialize(){this._commandExecutedListener(),this._initialExecuteFormulaProcessListener(),this._initialExecuteFormula()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted((t,e)=>{if(this._activeDirtyManagerService.get(t.id)){if(t.id===Pt.id){const n=t.params;if(e&&e.onlyLocal===!0||n.trigger===qr.id||n.trigger===vc.id)return}this._waitingCommandQueue.push(t),clearTimeout(this._setTimeoutKey),this._setTimeoutKey=setTimeout(()=>{this._commandService.executeCommand(c5.id,{...this._generateDirty(this._waitingCommandQueue)},{local:!0}),this._startExecutionTime=performance.now(),this._executingCommandQueue=this._waitingCommandQueue,this._waitingCommandQueue=[]},100)}}))}_generateDirty(t){const e=[],n={},r={};for(const i of t){const o=this._activeDirtyManagerService.get(i.id);if(o==null)continue;const s=o.getDirtyData(i),{dirtyRanges:a,dirtyNameMap:l,dirtyUnitFeatureMap:u}=s;a!=null&&e.push(...a),l!=null&&this._mergeDirtyNameMap(n,l),u!=null&&this._mergeDirtyUnitFeatureMap(r,u)}return{dirtyRanges:e,dirtyNameMap:n,dirtyUnitFeatureMap:r}}_mergeDirtyNameMap(t,e){Object.keys(e).forEach(n=>{t[n]==null&&(t[n]={}),Object.keys(e[n]).forEach(r=>{t[n][r]=e[n][r]})})}_mergeDirtyUnitFeatureMap(t,e){Object.keys(e).forEach(n=>{t[n]==null&&(t[n]={}),Object.keys(e[n]).forEach(r=>{t[n][r]==null&&(t[n][r]={}),Object.keys(e[n][r]).forEach(i=>{t[n][r][i]=e[n][r][i]})})})}_initialExecuteFormulaProcessListener(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(t.id!==d5.id)return;const e=t.params;if(e.stageInfo!=null){const{totalFormulasToCalculate:n,completedFormulasCount:r,totalArrayFormulasToCalculate:i,completedArrayFormulasCount:o,stage:s}=e.stageInfo;i>0?console.log(`Stage ${s} Array formula.There are ${i} functions to be executed, ${o} complete.`):console.log(`Stage ${s} .There are ${n} functions to be executed, ${r} complete.`)}else{const n=e.functionsExecutedState;let r="";switch(n){case s1.NOT_EXECUTED:r="No tasks are being executed anymore",this._waitingCommandQueue.unshift(...this._executingCommandQueue),this._executingCommandQueue=[];break;case s1.STOP_EXECUTION:r="The execution of the formula has been stopped",this._waitingCommandQueue.unshift(...this._executingCommandQueue),this._executingCommandQueue=[];break;case s1.SUCCESS:r=`Formula calculation succeeded, Total time consumed: ${performance.now()-this._startExecutionTime} ms`,this._executingCommandQueue=[];break;case s1.INITIAL:r="Waiting for calculation",this._executingCommandQueue=[];break}console.log(`execution result${r}`)}}))}_initialExecuteFormula(){this._commandService.executeCommand(c5.id,{commands:[],forceCalculation:!0},{local:!0})}};X8=kHe([yt(it.Ready,X8),kI(0,le),kI(1,jy)],X8);function r3(t,e,n,r,i){const{id:o}=e;if(sU(t,n,r))return t;const s=new nt(t[n][r]);switch(o){case gc.id:AHe(s,e);break;case B4.id:NHe(s,e,i);break;case F4.id:LHe(s,e,i);break;case mc.id:PHe(s,e);break;case pc.id:BHe(s,e);break;case x0.id:FHe(s,e);break;case I0.id:UHe(s,e);break;case M0.id:HHe(s,e);break;case O0.id:VHe(s,e);break;case D0.id:jHe(s,e);break;case R0.id:zHe(s,e);break}return t}function AHe(t,e){const{params:n}=e;if(!n)return;const{fromRange:r,toRange:i}=n,{startRow:o,endRow:s,startColumn:a,endColumn:l}=r,{startRow:u,endRow:c,startColumn:d,endColumn:h}=i,f=new nt;for(let m=o;m<=s;m++)for(let p=a;p<=l;p++){const g=t.getValue(m,p);f.setValue(m-o,p-a,g),t.setValue(m,p,null)}for(let m=u;m<=c;m++)for(let p=d;p<=h;p++){const g=f.getValue(m-u,p-d);t.setValue(m,p,g)}}function NHe(t,e,n){const{params:r}=e;if(!r)return;const{fromRow:i,toRow:o}=r,s=n==null?void 0:n.filter(c=>c.range.rangeType===Rt.ROW&&c.range.startRow<=i&&i<=c.range.endRow);if((s==null?void 0:s.length)!==1)return;const a=s[0].range,l=a.startRow,u=a.endRow-a.startRow+1;t.moveRows(l,u,o)}function LHe(t,e,n){const{params:r}=e;if(!r)return;const{fromCol:i,toCol:o}=r,s=n==null?void 0:n.filter(c=>c.range.rangeType===Rt.COLUMN&&c.range.startColumn<=i&&i<=c.range.endColumn);if((s==null?void 0:s.length)!==1)return;const a=s[0].range,l=a.startColumn,u=a.endColumn-a.startColumn+1;t.moveColumns(l,u,o)}function PHe(t,e){const{params:n}=e;if(!n)return;const{range:r}=n,i=t.getLength()-1,o=t.getRange().endColumn;P4(t,r,i,o,sr.ROWS)}function BHe(t,e){const{params:n}=e;if(!n)return;const{range:r}=n,i=t.getLength()-1,o=t.getRange().endColumn;P4(t,r,i,o,sr.COLUMNS)}function FHe(t,e){const{params:n}=e;if(!n)return;const{range:r}=n,i=t.getLength()-1,o=t.getRange().endColumn;P4(t,r,i,o,sr.COLUMNS)}function UHe(t,e){const{params:n}=e;if(!n)return;const{range:r}=n,i=t.getLength()-1,o=t.getRange().endColumn;P4(t,r,i,o,sr.ROWS)}function HHe(t,e){const{params:n}=e;if(!n)return;const{range:r}=n,i=t.getLength()-1,o=t.getRange().endColumn;L4(t,r,i,o,sr.ROWS)}function VHe(t,e){const{params:n}=e;if(!n)return;const{range:r}=n,i=t.getLength()-1,o=t.getRange().endColumn;L4(t,r,i,o,sr.COLUMNS)}function jHe(t,e){const{params:n}=e;if(!n)return;const{range:r}=n,i=t.getLength()-1,o=t.getRange().endColumn;L4(t,r,i,o,sr.ROWS)}function zHe(t,e){const{params:n}=e;if(!n)return;const{range:r}=n,i=t.getLength()-1,o=t.getRange().endColumn;L4(t,r,i,o,sr.COLUMNS)}function WHe(t,e,n){if(sU(t,e,n))return t;const r=new nt(t[e][n]);return r.forValue((i,o,s)=>{const{startRow:a,startColumn:l,endRow:u,endColumn:c}=s;if(i===a&&o===l)return;const d=u-a,h=c-l,f={startRow:i,startColumn:o,endRow:i+d,endColumn:o+h};r.setValue(i,o,f)}),t}function sU(t,e,n){return t==null||t[e]==null||t[e][n]==null}function $p(t,e,n){t&&t[e]&&t[e][n]&&delete t[e][n]}var XHe=Object.defineProperty,YHe=Object.getOwnPropertyDescriptor,GHe=(t,e,n,r)=>{for(var i=r>1?void 0:r?YHe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&XHe(e,n,i),i},uu=(t,e)=>(n,r)=>e(n,r,t);let Y8=class extends je{constructor(t,e,n,r,i,o,s){super(),this._currentUniverService=t,this._commandService=e,this._lexerTreeBuilder=n,this._formulaDataModel=r,this._sheetInterceptorService=i,this._selectionManagerService=o,this._injector=s,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:t=>this._getUpdateFormula(t)})),this.disposeWithMe(this._commandService.onCommandExecuted((t,e)=>{if(t.params)if(t.id===Pt.id){const n=t.params;if(e&&e.onlyLocal===!0||n.trigger===qr.id||n.trigger===vc.id)return;this._handleSetRangeValuesMutation(n,e)}else t.id===Zs.id?this._handleRemoveSheetMutation(t.params):t.id===ps.id&&this._handleInsertSheetMutation(t.params)}))}_handleSetRangeValuesMutation(t,e){const{subUnitId:n,unitId:r,cellValue:i}=t;e&&e.onlyLocal===!0||i==null||(this._formulaDataModel.updateFormulaData(r,n,i),this._commandService.executeCommand(y2.id,{formulaData:this._formulaDataModel.getFormulaData()},{local:!0}))}_handleRemoveSheetMutation(t){const{subUnitId:e,unitId:n}=t,r=this._formulaDataModel.getFormulaData();$p(r,n,e);const i=this._formulaDataModel.getArrayFormulaRange();$p(i,n,e);const o=this._formulaDataModel.getArrayFormulaCellData();$p(o,n,e),this._commandService.executeCommand(y2.id,{formulaData:r}),this._commandService.executeCommand(t0.id,{arrayFormulaRange:i,arrayFormulaCellData:o})}_handleInsertSheetMutation(t){const{sheet:e,unitId:n}=t,r=this._formulaDataModel.getFormulaData(),{id:i,cellData:o}=e,s=new nt(o);TP(r,n,i,s),this._commandService.executeCommand(y2.id,{formulaData:r})}_getUpdateFormula(t){const{id:e}=t;let n=null;switch(e){case gc.id:n=this._handleMoveRange(t);break;case B4.id:n=this._handleMoveRows(t);break;case F4.id:n=this._handleMoveCols(t);break;case mc.id:n=this._handleInsertRow(t);break;case pc.id:n=this._handleInsertCol(t);break;case x0.id:n=this._handleInsertRangeMoveRight(t);break;case I0.id:n=this._handleInsertRangeMoveDown(t);break;case M0.id:n=this._handleRemoveRow(t);break;case O0.id:n=this._handleRemoveCol(t);break;case D0.id:n=this._handleDeleteRangeMoveUp(t);break;case R0.id:n=this._handleDeleteRangeMoveLeft(t);break;case _f.id:n=this._handleSetWorksheetName(t);break}if(n){const{unitSheetNameMap:r}=this._formulaDataModel.getCalculateData();let i=this._formulaDataModel.getFormulaData();const o=this._getFormulaReferenceMoveInfo(i,r,n),s=this._currentUniverService.getCurrentUniverSheetInstance(),a=s.getUnitId(),l=s.getActiveSheet().getSheetId(),u=this._selectionManagerService.getSelections(),c=this._formulaDataModel.getArrayFormulaRange(),d=this._formulaDataModel.getArrayFormulaCellData();let h=r3(c,t,a,l,u);h=WHe(h,a,l);const f=r3(d,t,a,l,u);this._commandService.executeCommand(t0.id,{arrayFormulaRange:h,arrayFormulaCellData:f},{local:!0}),i=r3(i,t,a,l,u);const m=r3(o,t,a,l,u);return this._commandService.executeCommand(y2.id,{formulaData:this._formulaDataModel.getFormulaData()}),this._getUpdateFormulaMutations(i,m)}return{undos:[],redos:[]}}_handleMoveRange(t){const{params:e}=t;if(!e)return null;const{fromRange:n,toRange:r}=e;if(!n||!r)return null;const{unitId:i,sheetId:o}=this._getCurrentSheetInfo();return{type:0,from:n,to:r,unitId:i,sheetId:o}}_handleMoveRows(t){const{params:e}=t;if(!e)return null;const{fromRow:n,toRow:r}=e,i=this._currentUniverService.getCurrentUniverSheetInstance(),o=i.getUnitId(),s=i.getActiveSheet(),a=s.getSheetId(),l={startRow:n,startColumn:0,endRow:n,endColumn:s.getColumnCount()-1,rangeType:Rt.ROW},u={startRow:r,startColumn:0,endRow:r,endColumn:s.getColumnCount()-1,rangeType:Rt.ROW};return{type:0,from:l,to:u,unitId:o,sheetId:a}}_handleMoveCols(t){const{params:e}=t;if(!e)return null;const{fromCol:n,toCol:r}=e,i=this._currentUniverService.getCurrentUniverSheetInstance(),o=i.getUnitId(),s=i.getActiveSheet(),a=s.getSheetId(),l={startRow:0,startColumn:n,endRow:s.getRowCount()-1,endColumn:n,rangeType:Rt.COLUMN},u={startRow:0,startColumn:r,endRow:s.getRowCount()-1,endColumn:r,rangeType:Rt.COLUMN};return{type:0,from:l,to:u,unitId:o,sheetId:a}}_handleInsertRow(t){const{params:e}=t;if(!e)return null;const{range:n,unitId:r,subUnitId:i}=e;return{type:1,ranges:[n],unitId:r,sheetId:i}}_handleInsertCol(t){const{params:e}=t;if(!e)return null;const{range:n,unitId:r,subUnitId:i}=e;return{type:2,ranges:[n],unitId:r,sheetId:i}}_handleInsertRangeMoveRight(t){const{params:e}=t;if(!e)return null;const{range:n}=e,{unitId:r,sheetId:i}=this._getCurrentSheetInfo();return{type:8,range:n,unitId:r,sheetId:i}}_handleInsertRangeMoveDown(t){const{params:e}=t;if(!e)return null;const{range:n}=e,{unitId:r,sheetId:i}=this._getCurrentSheetInfo();return{type:7,range:n,unitId:r,sheetId:i}}_handleRemoveRow(t){const{params:e}=t;if(!e)return null;const{range:n}=e,{unitId:r,sheetId:i}=this._getCurrentSheetInfo();return{type:3,range:n,unitId:r,sheetId:i}}_handleRemoveCol(t){const{params:e}=t;if(!e)return null;const{range:n}=e,{unitId:r,sheetId:i}=this._getCurrentSheetInfo();return{type:4,range:n,unitId:r,sheetId:i}}_handleDeleteRangeMoveUp(t){const{params:e}=t;if(!e)return null;const{range:n}=e,{unitId:r,sheetId:i}=this._getCurrentSheetInfo();return{type:6,range:n,unitId:r,sheetId:i}}_handleDeleteRangeMoveLeft(t){const{params:e}=t;if(!e)return null;const{range:n}=e,{unitId:r,sheetId:i}=this._getCurrentSheetInfo();return{type:5,range:n,unitId:r,sheetId:i}}_handleSetWorksheetName(t){const{params:e}=t;if(!e)return null;const{unitId:n,subUnitId:r,name:i}=e,{unitId:o,sheetId:s}=this._getCurrentSheetInfo();return{type:9,unitId:n||o,sheetId:r||s,sheetName:i}}_getUpdateFormulaMutations(t,e){const n=[],r=[],i={get:this._injector.get.bind(this._injector)},o=Object.keys(e);for(const s of o){const a=e[s],l=Object.keys(a);for(const u of l){const c=new nt(t[s][u]),d=new nt(a[u]),h=new nt;d.forValue((g,v,_)=>{var C;const y=(_==null?void 0:_.f)||"",S=((C=c.getValue(g,v))==null?void 0:C.f)||"";Ao(y)&&(Ao(S)&&y!==S?h.setValue(g,v,{f:y}):h.setValue(g,v,{f:y,si:null}))});const f=h.getData();if(De.isEmptyObject(f))continue;const m={subUnitId:u,unitId:s,cellValue:f};n.push({id:Pt.id,params:m});const p=Bi(i,m);r.push({id:Pt.id,params:p})}}return{redos:n,undos:r}}_getFormulaReferenceMoveInfo(t,e,n){if(t==null)return{};const r=Object.keys(t);if(r.length===0)return{};const i={};for(const o of r){const s=t[o],a=Object.keys(s);i[o]==null&&(i[o]={});for(const l of a){const u=new nt(s[l]),c=new nt;u.forValue((d,h,f)=>{var m;if(!f)return!0;const{f:p,x:g,y:v,si:_}=f,C=this._lexerTreeBuilder.sequenceNodesBuilder(p);if(C==null)return!0;let y=!1;const S=[];for(let w=0,R=C.length;w<R;w++){const D=C[w];if(typeof D=="string"||D.nodeType!==Hr.REFERENCE)continue;const{token:I}=D,k=xa(I),{range:O,sheetName:$,unitId:N}=k,H=N==null||N.length===0?o:N,X=(m=e==null?void 0:e[H])==null?void 0:m[$],te={range:O,sheetId:X,unitId:N,sheetName:$,refOffsetX:g||0,refOffsetY:v||0};let z=null;if(n.type===9){const{unitId:A,sheetId:T,sheetName:P}=n;if(P==null||X==null||X.length===0||T!==X)continue;z=Bd({range:O,sheetName:P,unitId:N})}else z=this._getNewRangeByMoveParam(te,n,o,l);z!=null&&(C[w]={...D,token:z},y=!0,S.push(w))}if(!y)return!0;const E=this._updateRefOffset(C,S,g,v);c.setValue(d,h,{f:`=${cy(E)}`,x:g,y:v,si:_})}),i[o][l]=c.getData()}}return i}_getNewRangeByMoveParam(t,e,n,r){const{type:i,unitId:o,sheetId:s,range:a,from:l,to:u}=e,{range:c,sheetId:d,unitId:h,sheetName:f,refOffsetX:m,refOffsetY:p}=t;if(!this._checkIsSameUnitAndSheet(o,s,n,r,h,d))return;const g=pt.moveOffset(c,m,p);let v=null;if(i===0){if(l==null||u==null)return;const _=this._checkMoveEdge(g,l),C=pt.getIntersects(g,l);if(C==null)return;const y=LB({id:cr.MoveRangeCommandId,params:{toRange:u,fromRange:l}},C),S=la(y,C);if(S==null)return;v=this._getMoveNewRange(_,S,l,u,g,C)}if(a!=null){if(i===1){const _=FB({id:cr.InsertRowCommandId,params:{range:a,unitId:"",subUnitId:"",direction:ge.DOWN}},g),C=la(_,g);if(C==null)return;v={...g,...C}}else if(i===2){const _=UB({id:cr.InsertColCommandId,params:{range:a,unitId:"",subUnitId:"",direction:ge.RIGHT}},g),C=la(_,g);if(C==null)return;v={...g,...C}}else if(i===3){const _=BB({id:cr.RemoveRowCommandId,params:{range:a}},g),C=la(_,g);if(C==null)return;v={...g,...C}}else if(i===4){const _=PB({id:cr.RemoveColCommandId,params:{range:a}},g),C=la(_,g);if(C==null)return;v={...g,...C}}else if(i===5){const _=jB({id:cr.DeleteRangeMoveLeftCommandId,params:{range:a}},g),C=la(_,g);if(C==null)return;v={...g,...C}}else if(i===6){const _=zB({id:cr.DeleteRangeMoveUpCommandId,params:{range:a}},g),C=la(_,g);if(C==null)return;v={...g,...C}}else if(i===7){const _=HB({id:cr.InsertRangeMoveDownCommandId,params:{range:a}},g),C=la(_,g);if(C==null)return;v={...g,...C}}else if(i===8){const _=VB({id:cr.InsertRangeMoveRightCommandId,params:{range:a}},g),C=la(_,g);if(C==null)return;v={...g,...C}}}if(v!=null)return Bd({range:v,sheetName:f,unitId:h})}_checkIsSameUnitAndSheet(t,e,n,r,i,o){if((i==null||i.length===0)&&(o==null||o.length===0)){if(t===n&&e===r)return!0}else if((t===i||i==null||i.length===0)&&e===o)return!0;return!1}_updateRefOffset(t,e,n=0,r=0){const i=[];for(let o=0,s=t.length;o<s;o++){const a=t[o];if(typeof a=="string"||a.nodeType!==Hr.REFERENCE||e.includes(o)){i.push(a);continue}const{token:l}=a,u=xa(l),{range:c,sheetName:d,unitId:h}=u,f=pt.moveOffset(c,n,r);i.push({...a,token:Bd({range:f,unitId:h,sheetName:d})})}return i}_checkMoveEdge(t,e){const{startRow:n,startColumn:r,endRow:i,endColumn:o}=t,{startRow:s,startColumn:a,endRow:l,endColumn:u}=e;if(n>=s&&i<=l&&r>=a&&o<=u)return 4;if(r>=a&&o<=u&&n>=s&&n<=l&&i>l)return 0;if(r>=a&&o<=u&&i>=s&&i<=l&&n<s)return 1;if(n>=s&&i<=l&&r>=a&&r<=u&&o>u)return 2;if(n>=s&&i<=l&&o>=a&&o<=u&&r<a)return 3}_getMoveNewRange(t,e,n,r,i,o){const{startRow:s,endRow:a,startColumn:l,endColumn:u}=e,{startRow:c,startColumn:d,endRow:h,endColumn:f}=n,{startRow:m,startColumn:p,endRow:g,endColumn:v}=r,{startRow:_,endRow:C,startColumn:y,endColumn:S}=o,{startRow:E,endRow:w,startColumn:R,endColumn:D}=i,I={...i};if(t===0)if(l===R&&u===D)if(s<E)I.startRow=s;else if(a<w)I.startRow=s;else if(a>=w&&m<=w)I.startRow=h+1,I.endRow=a;else return;else return;else if(t===1)if(l===R&&u===D)if(a>w)I.endRow=a;else if(s>E)I.endRow=a;else if(s<=E&&g>=E)I.endRow=c+1,I.startRow=s;else return;else return;else if(t===2)if(s===E&&a===w)if(l<R)I.startColumn=l;else if(u<D)I.startColumn=l;else if(u>=D&&p<=D)I.startColumn=f+1,I.endColumn=u;else return;else return;else if(t===3)if(s===E&&a===w)if(u>D)I.endColumn=u;else if(l>R)I.endColumn=u;else if(l<=R&&v>=R)I.endColumn=d+1,I.startColumn=l;else return;else return;else(t===4||(p<=S+1&&v>=D||p<=R&&v>=y-1)&&m<=E&&g>=w||(m<=C+1&&g>=w||m<=E&&g>=_-1)&&p<=R&&v>=D)&&(I.startRow=s,I.startColumn=l,I.endRow=a,I.endColumn=u);return I}_getInsertNewRange(){}_getCurrentSheetInfo(){const t=this._currentUniverService.getCurrentUniverSheetInstance(),e=t.getUnitId(),n=t.getActiveSheet().getSheetId();return{unitId:e,sheetId:n}}};Y8=GHe([yt(it.Ready,Y8),uu(0,oe),uu(1,le),uu(2,ne(Ba)),uu(3,ne(Vo)),uu(4,ne(En)),uu(5,ne(ut)),uu(6,ne(Tn))],Y8);const KHe={},ZHe={BETADIST:{description:" beta ",abstract:" beta ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/betadist-%E5%87%BD%E6%95%B0-49f1b9a9-a5da-470f-8077-5f1730b5fd47"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BETAINV:{description:" beta ",abstract:" beta ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/betainv-%E5%87%BD%E6%95%B0-8b914ade-b902-43c1-ac9c-c05c54f10d6c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BINOMDIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/binomdist-%E5%87%BD%E6%95%B0-506a663e-c4ca-428d-b9a8-05583d68789c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHIDIST:{description:" 2 ",abstract:" 2 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/chidist-%E5%87%BD%E6%95%B0-c90d0fbc-5b56-4f5f-ab57-34af1bf6897e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHIINV:{description:" 2 ",abstract:" 2 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/chiinv-%E5%87%BD%E6%95%B0-cfbea3f6-6e4f-40c9-a87f-20472e0512af"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHITEST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/chitest-%E5%87%BD%E6%95%B0-981ff871-b694-4134-848e-38ec704577ac"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CONCATENATE:{description:" 2  1 ",abstract:" 2  1 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/concatenate-%E5%87%BD%E6%95%B0-8f8ae884-2ca8-4f7a-b093-75d702bea31d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CONFIDENCE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/confidence-%E5%87%BD%E6%95%B0-75ccc007-f77c-4343-bc14-673642091ad6"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COVAR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/covar-%E5%87%BD%E6%95%B0-50479552-2c03-4daf-bd71-a5ab88b2db03"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CRITBINOM:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/critbinom-%E5%87%BD%E6%95%B0-eb6b871d-796b-4d21-b69b-e4350d5f407b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EXPONDIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/expondist-%E5%87%BD%E6%95%B0-68ab45fd-cd6d-4887-9770-9357eb8ee06a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FDIST:{description:" F ",abstract:" F ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/fdist-%E5%87%BD%E6%95%B0-ecf76fba-b3f1-4e7d-a57e-6a5b7460b786"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FINV:{description:" F ",abstract:" F ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/finv-%E5%87%BD%E6%95%B0-4d46c97c-c368-4852-bc15-41e8e31140b1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FLOOR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/floor-%E5%87%BD%E6%95%B0-14bb497c-24f2-4e04-b327-b0b4de5a8886"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORECAST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/forecast-%E5%92%8C-forecast-linear-%E5%87%BD%E6%95%B0-50ca49c9-7b40-4892-94e4-7ad38bbeda99"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FTEST:{description:" F ",abstract:" F ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/ftest-%E5%87%BD%E6%95%B0-4c9e1202-53fe-428c-a737-976f6fc3f9fd"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMADIST:{description:"  ",abstract:"  ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/gammadist-%E5%87%BD%E6%95%B0-7327c94d-0f05-4511-83df-1dd7ed23e19e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMAINV:{description:"  ",abstract:"  ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/gammainv-%E5%87%BD%E6%95%B0-06393558-37ab-47d0-aa63-432f99e7916d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HYPGEOMDIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/hypgeomdist-%E5%87%BD%E6%95%B0-23e37961-2871-4195-9629-d0b2c108a12e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOGINV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/loginv-%E5%87%BD%E6%95%B0-0bd7631a-2725-482b-afb4-de23df77acfe"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOGNORMDIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/lognormdist-%E5%87%BD%E6%95%B0-f8d194cb-9ee3-4034-8c75-1bdb3884100b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MODE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/mode-%E5%87%BD%E6%95%B0-e45192ce-9122-4980-82ed-4bdc34973120"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NEGBINOMDIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/negbinomdist-%E5%87%BD%E6%95%B0-f59b0a37-bae2-408d-b115-a315609ba714"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORMDIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/normdist-%E5%87%BD%E6%95%B0-126db625-c53e-4591-9a22-c9ff422d6d58"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORMINV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/norminv-%E5%87%BD%E6%95%B0-87981ab8-2de0-4cb0-b1aa-e21d4cb879b8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORMSDIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/normsdist-%E5%87%BD%E6%95%B0-463369ea-0345-445d-802a-4ff0d6ce7cac"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORMSINV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/normsinv-%E5%87%BD%E6%95%B0-8d1bce66-8e4d-4f3b-967c-30eed61f019d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERCENTILE:{description:" k ",abstract:" k ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/percentile-%E5%87%BD%E6%95%B0-91b43a53-543c-4708-93de-d626debdddca"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERCENTRANK:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/percentrank-%E5%87%BD%E6%95%B0-f1b5836c-9619-4847-9fc9-080ec9024442"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},POISSON:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/poisson-%E5%87%BD%E6%95%B0-d81f7294-9d7c-4f75-bc23-80aa8624173a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},QUARTILE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/quartile-%E5%87%BD%E6%95%B0-93cf8f62-60cd-4fdb-8a92-8451041e1a2a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RANK:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/rank-%E5%87%BD%E6%95%B0-6a2fc49d-1831-4a03-9d8c-c279cf99f723"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STDEV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/stdev-%E5%87%BD%E6%95%B0-51fecaaa-231e-4bbb-9230-33650a72c9b0"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STDEVP:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/stdevp-%E5%87%BD%E6%95%B0-1f7c1c88-1bec-4422-8242-e9f7dc8bb195"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TDIST:{description:" t-",abstract:" t-",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/tdist-%E5%87%BD%E6%95%B0-630a7695-4021-4853-9468-4a1f9dcdd192"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TINV:{description:" t-",abstract:" t-",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/tinv-%E5%87%BD%E6%95%B0-a7c85b9d-90f5-41fe-9ca5-1cd2f3e1ed7c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TTEST:{description:" t-",abstract:" t-",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/ttest-%E5%87%BD%E6%95%B0-1696ffc1-4811-40fd-9d13-a0eaad83c7ae"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VAR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/var-%E5%87%BD%E6%95%B0-1f2b7ab2-954d-4e17-ba2c-9e58b15a7da2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VARP:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/varp-%E5%87%BD%E6%95%B0-26a541c4-ecee-464d-a731-bd4c575b1a6b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WEIBULL:{description:" Weibull ",abstract:" Weibull ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/weibull-%E5%87%BD%E6%95%B0-b83dc2c6-260b-4754-bef2-633196f6fdcc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ZTEST:{description:" z ",abstract:" z ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/ztest-%E5%87%BD%E6%95%B0-8f33be8a-6bd6-4ecc-8e3a-d9a4420c4a6a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},qHe={CUBEKPIMEMBER:{description:" (KPI)  KPI  KPI ",abstract:" (KPI)  KPI  KPI ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/cubekpimember-%E5%87%BD%E6%95%B0-744608bf-2c62-42cd-b67a-a56109f4b03b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUBEMEMBER:{description:" ",abstract:" ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/cubemember-%E5%87%BD%E6%95%B0-0f6a15b9-2c18-4819-ae89-e1b5c8b398ad"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUBEMEMBERPROPERTY:{description:" ",abstract:" ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/cubememberproperty-%E5%87%BD%E6%95%B0-001e57d6-b35a-49e5-abcd-05ff599e8951"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUBERANKEDMEMBER:{description:" n   10 ",abstract:" n   10 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/cuberankedmember-%E5%87%BD%E6%95%B0-07efecde-e669-4075-b4bf-6b40df2dc4b3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUBESET:{description:" Microsoft Excel",abstract:" Microsoft Excel",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/cubeset-%E5%87%BD%E6%95%B0-5b2146bd-62d6-4d04-9d8f-670e993ee1d9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUBESETCOUNT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/cubesetcount-%E5%87%BD%E6%95%B0-c4c2a438-c1ff-4061-80fe-982f2d705286"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUBEVALUE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/cubevalue-%E5%87%BD%E6%95%B0-8733da24-26d1-4e34-9b3a-84a8f00dcbe0"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},QHe={DAVERAGE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/daverage-%E5%87%BD%E6%95%B0-a6a2d5ac-4b4b-48cd-a1d8-7b37834e5aee"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DCOUNT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dcount-%E5%87%BD%E6%95%B0-c1fc7b93-fb0d-4d8d-97db-8d5f076eaeb1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DCOUNTA:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dcounta-%E5%87%BD%E6%95%B0-00232a6d-5a66-4a01-a25b-c1653fda1244"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DGET:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dget-%E5%87%BD%E6%95%B0-455568bf-4eef-45f7-90f0-ec250d00892e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DMAX:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dmax-%E5%87%BD%E6%95%B0-f4e8209d-8958-4c3d-a1ee-6351665d41c2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DMIN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dmin-%E5%87%BD%E6%95%B0-4ae6f1d9-1f26-40f1-a783-6dc3680192a3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DPRODUCT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dproduct-%E5%87%BD%E6%95%B0-4f96b13e-d49c-47a7-b769-22f6d017cb31"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DSTDEV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dstdev-%E5%87%BD%E6%95%B0-026b8c73-616d-4b5e-b072-241871c4ab96"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DSTDEVP:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dstdevp-%E5%87%BD%E6%95%B0-04b78995-da03-4813-bbd9-d74fd0f5d94b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DSUM:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dsum-%E5%87%BD%E6%95%B0-53181285-0c4b-4f5a-aaa3-529a322be41b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DVAR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dvar-%E5%87%BD%E6%95%B0-d6747ca9-99c7-48bb-996e-9d7af00f3ed1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DVARP:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dvarp-%E5%87%BD%E6%95%B0-eb0ba387-9cb7-45c8-81e9-0394912502fc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},JHe={DATE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/date-%E5%87%BD%E6%95%B0-e36c0c8c-4104-49da-ab83-82328b832349"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DATEDIF:{description:" ",abstract:" ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/datedif-%E5%87%BD%E6%95%B0-25dba1a4-2812-480b-84dd-8b32a451b35c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DATEVALUE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/datevalue-%E5%87%BD%E6%95%B0-df8b07d4-7761-4a93-bc33-b7471bbff252"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DAY:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/day-%E5%87%BD%E6%95%B0-8a7d1cbb-6c7d-4ba1-8aea-25c134d03101"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DAYS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/days-%E5%87%BD%E6%95%B0-57740535-d549-4395-8728-0f07bff0b9df"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DAYS360:{description:" 360 ",abstract:" 360 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/days360-%E5%87%BD%E6%95%B0-b9a509fd-49ef-407e-94df-0cbda5718c2a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EDATE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/edate-%E5%87%BD%E6%95%B0-3c920eb2-6e66-44e7-a1f5-753ae47ee4f5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EOMONTH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/eomonth-%E5%87%BD%E6%95%B0-7314ffa1-2bc9-4005-9d66-f49db127d628"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HOUR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/hour-%E5%87%BD%E6%95%B0-a3afa879-86cb-4339-b1b5-2dd2d7310ac7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISOWEEKNUM:{description:" ISO ",abstract:" ISO ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/isoweeknum-%E5%87%BD%E6%95%B0-1c2d0afe-d25b-4ab1-8894-8d0520e90e0e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MINUTE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/minute-%E5%87%BD%E6%95%B0-af728df0-05c4-4b07-9eed-a84801a60589"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MONTH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/month-%E5%87%BD%E6%95%B0-579a2881-199b-48b2-ab90-ddba0eba86e8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NETWORKDAYS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/networkdays-%E5%87%BD%E6%95%B0-48e717bf-a7a3-495f-969e-5005e3eb18e7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NETWORKDAYS_INTL:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/networkdays-intl-%E5%87%BD%E6%95%B0-a9b26239-4f20-46a1-9ab8-4e925bfd5e28"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NOW:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/now-%E5%87%BD%E6%95%B0-3337fd29-145a-4347-b2e6-20c904739c46"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SECOND:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/second-%E5%87%BD%E6%95%B0-740d1cfc-553c-4099-b668-80eaa24e8af1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TIME:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/time-%E5%87%BD%E6%95%B0-9a5aff99-8f7d-4611-845e-747d0b8d5457"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TIMEVALUE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/timevalue-%E5%87%BD%E6%95%B0-0b615c12-33d8-4431-bf3d-f3eb6d186645"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TODAY:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/today-%E5%87%BD%E6%95%B0-5eb3078d-a82c-4736-8930-2f51a028fdd9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WEEKDAY:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/weekday-%E5%87%BD%E6%95%B0-60e44483-2ed1-439f-8bd0-e404c190949a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WEEKNUM:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/weeknum-%E5%87%BD%E6%95%B0-e5c43a03-b4ab-426c-b411-b18c13c75340"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WORKDAY:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/workday-%E5%87%BD%E6%95%B0-f764a5b7-05fc-4494-9486-60d494efbf33"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WORKDAY_INTL:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/workday-intl-%E5%87%BD%E6%95%B0-a378391c-9ba7-4678-8a39-39611a9bf81d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},YEAR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/year-%E5%87%BD%E6%95%B0-c64f017a-1354-490d-981f-578e8ec8d3b9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},YEARFRAC:{description:" start_date  end_date ",abstract:" start_date  end_date ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/yearfrac-%E5%87%BD%E6%95%B0-3844141e-c76d-4143-82b6-208454ddc6a8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},eVe={BESSELI:{description:" In(x)",abstract:" In(x)",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/besseli-%E5%87%BD%E6%95%B0-8d33855c-9a8d-444b-98e0-852267b1c0df"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BESSELJ:{description:" Jn(x)",abstract:" Jn(x)",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/besselj-%E5%87%BD%E6%95%B0-839cb181-48de-408b-9d80-bd02982d94f7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BESSELK:{description:" Kn(x)",abstract:" Kn(x)",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/besselk-%E5%87%BD%E6%95%B0-606d11bc-06d3-4d53-9ecb-2803e2b90b70"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BESSELY:{description:" Yn(x)",abstract:" Yn(x)",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/bessely-%E5%87%BD%E6%95%B0-f3a356b3-da89-42c3-8974-2da54d6353a2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BIN2DEC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/bin2dec-%E5%87%BD%E6%95%B0-63905b57-b3a0-453d-99f4-647bb519cd6c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BIN2HEX:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/bin2hex-%E5%87%BD%E6%95%B0-0375e507-f5e5-4077-9af8-28d84f9f41cc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BIN2OCT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/bin2oct-%E5%87%BD%E6%95%B0-0a4e01ba-ac8d-4158-9b29-16c25c4c23fd"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BITAND:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/bitand-%E5%87%BD%E6%95%B0-8a2be3d7-91c3-4b48-9517-64548008563a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BITLSHIFT:{description:" shift_amount ",abstract:" shift_amount ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/bitlshift-%E5%87%BD%E6%95%B0-c55bb27e-cacd-4c7c-b258-d80861a03c9c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BITOR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/bitor-%E5%87%BD%E6%95%B0-f6ead5c8-5b98-4c9e-9053-8ad5234919b2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BITRSHIFT:{description:" shift_amount ",abstract:" shift_amount ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/bitrshift-%E5%87%BD%E6%95%B0-274d6996-f42c-4743-abdb-4ff95351222c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BITXOR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/bitxor-%E5%87%BD%E6%95%B0-c81306a1-03f9-4e89-85ac-b86c3cba10e4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COMPLEX:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/complex-%E5%87%BD%E6%95%B0-f0b8f3a9-51cc-4d6d-86fb-3a9362fa4128"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CONVERT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/convert-%E5%87%BD%E6%95%B0-d785bef1-808e-4aac-bdcd-666c810f9af2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DEC2BIN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dec2bin-%E5%87%BD%E6%95%B0-0f63dd0e-5d1a-42d8-b511-5bf5c6d43838"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DEC2HEX:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dec2hex-%E5%87%BD%E6%95%B0-6344ee8b-b6b5-4c6a-a672-f64666704619"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DEC2OCT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dec2oct-%E5%87%BD%E6%95%B0-c9d835ca-20b7-40c4-8a9e-d3be351ce00f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DELTA:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/delta-%E5%87%BD%E6%95%B0-2f763672-c959-4e07-ac33-fe03220ba432"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ERF:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/erf-%E5%87%BD%E6%95%B0-c53c7e7b-5482-4b6c-883e-56df3c9af349"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ERF_PRECISE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/erf-precise-%E5%87%BD%E6%95%B0-9a349593-705c-4278-9a98-e4122831a8e0"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ERFC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/erfc-%E5%87%BD%E6%95%B0-736e0318-70ba-4e8b-8d08-461fe68b71b3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ERFC_PRECISE:{description:" x  ERF ",abstract:" x  ERF ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/erfc-precise-%E5%87%BD%E6%95%B0-e90e6bab-f45e-45df-b2ac-cd2eb4d4a273"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GESTEP:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/gestep-%E5%87%BD%E6%95%B0-f37e7d2a-41da-4129-be95-640883fca9df"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HEX2BIN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/hex2bin-%E5%87%BD%E6%95%B0-a13aafaa-5737-4920-8424-643e581828c1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HEX2DEC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/hex2dec-%E5%87%BD%E6%95%B0-8c8c3155-9f37-45a5-a3ee-ee5379ef106e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HEX2OCT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/hex2oct-%E5%87%BD%E6%95%B0-54d52808-5d19-4bd0-8a63-1096a5d11912"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMABS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imabs-%E5%87%BD%E6%95%B0-b31e73c6-d90c-4062-90bc-8eb351d765a1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMAGINARY:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imaginary-%E5%87%BD%E6%95%B0-dd5952fd-473d-44d9-95a1-9a17b23e428a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMARGUMENT:{description:" theta",abstract:" theta",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imargument-%E5%87%BD%E6%95%B0-eed37ec1-23b3-4f59-b9f3-d340358a034a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMCONJUGATE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imconjugate-%E5%87%BD%E6%95%B0-2e2fc1ea-f32b-4f9b-9de6-233853bafd42"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMCOS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imcos-%E5%87%BD%E6%95%B0-dad75277-f592-4a6b-ad6c-be93a808a53c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMCOSH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imcosh-%E5%87%BD%E6%95%B0-053e4ddb-4122-458b-be9a-457c405e90ff"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMCOT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imcot-%E5%87%BD%E6%95%B0-dc6a3607-d26a-4d06-8b41-8931da36442c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMCSC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imcsc-%E5%87%BD%E6%95%B0-9e158d8f-2ddf-46cd-9b1d-98e29904a323"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMCSCH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imcsch-%E5%87%BD%E6%95%B0-c0ae4f54-5f09-4fef-8da0-dc33ea2c5ca9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMDIV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imdiv-%E5%87%BD%E6%95%B0-a505aff7-af8a-4451-8142-77ec3d74d83f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMEXP:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imexp-%E5%87%BD%E6%95%B0-c6f8da1f-e024-4c0c-b802-a60e7147a95f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMLN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imln-%E5%87%BD%E6%95%B0-32b98bcf-8b81-437c-a636-6fb3aad509d8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMLOG10:{description:" 10 ",abstract:" 10 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imlog10-%E5%87%BD%E6%95%B0-58200fca-e2a2-4271-8a98-ccd4360213a5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMLOG2:{description:" 2 ",abstract:" 2 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imlog2-%E5%87%BD%E6%95%B0-152e13b4-bc79-486c-a243-e6a676878c51"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMPOWER:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/impower-%E5%87%BD%E6%95%B0-210fd2f5-f8ff-4c6a-9d60-30e34fbdef39"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMPRODUCT:{description:" 2  255 ",abstract:" 2  255 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/improduct-%E5%87%BD%E6%95%B0-2fb8651a-a4f2-444f-975e-8ba7aab3a5ba"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMREAL:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imreal-%E5%87%BD%E6%95%B0-d12bc4c0-25d0-4bb3-a25f-ece1938bf366"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSEC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imsec-%E5%87%BD%E6%95%B0-6df11132-4411-4df4-a3dc-1f17372459e0"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSECH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imsech-%E5%87%BD%E6%95%B0-f250304f-788b-4505-954e-eb01fa50903b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSIN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imsin-%E5%87%BD%E6%95%B0-1ab02a39-a721-48de-82ef-f52bf37859f6"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSINH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imsinh-%E5%87%BD%E6%95%B0-dfb9ec9e-8783-4985-8c42-b028e9e8da3d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSQRT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imsqrt-%E5%87%BD%E6%95%B0-e1753f80-ba11-4664-a10e-e17368396b70"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSUB:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imsub-%E5%87%BD%E6%95%B0-2e404b4d-4935-4e85-9f52-cb08b9a45054"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSUM:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imsum-%E5%87%BD%E6%95%B0-81542999-5f1c-4da6-9ffe-f1d7aaa9457f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMTAN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/imtan-%E5%87%BD%E6%95%B0-8478f45d-610a-43cf-8544-9fc0b553a132"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},OCT2BIN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/oct2bin-%E5%87%BD%E6%95%B0-55383471-3c56-4d27-9522-1a8ec646c589"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},OCT2DEC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/oct2dec-%E5%87%BD%E6%95%B0-87606014-cb98-44b2-8dbb-e48f8ced1554"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},OCT2HEX:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/oct2hex-%E5%87%BD%E6%95%B0-912175b4-d497-41b4-a029-221f051b858f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},tVe={ACCRINT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/accrint-%E5%87%BD%E6%95%B0-fe45d089-6722-4fb3-9379-e1f911d8dc74"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ACCRINTM:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/accrintm-%E5%87%BD%E6%95%B0-f62f01f9-5754-4cc4-805b-0e70199328a7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},AMORDEGRC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/amordegrc-%E5%87%BD%E6%95%B0-a14d0ca1-64a4-42eb-9b3d-b0dededf9e51"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},AMORLINC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/amorlinc-%E5%87%BD%E6%95%B0-7d417b45-f7f5-4dba-a0a5-3451a81079a8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUPDAYBS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/coupdaybs-%E5%87%BD%E6%95%B0-eb9a8dfb-2fb2-4c61-8e5d-690b320cf872"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUPDAYS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/coupdays-%E5%87%BD%E6%95%B0-cc64380b-315b-4e7b-950c-b30b0a76f671"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUPDAYSNC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/coupdaysnc-%E5%87%BD%E6%95%B0-5ab3f0b2-029f-4a8b-bb65-47d525eea547"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUPNCD:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/coupncd-%E5%87%BD%E6%95%B0-fd962fef-506b-4d9d-8590-16df5393691f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUPNUM:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/coupnum-%E5%87%BD%E6%95%B0-a90af57b-de53-4969-9c99-dd6139db2522"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUPPCD:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/couppcd-%E5%87%BD%E6%95%B0-2eb50473-6ee9-4052-a206-77a9a385d5b3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUMIPMT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/cumipmt-%E5%87%BD%E6%95%B0-61067bb0-9016-427d-b95b-1a752af0e606"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUMPRINC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/cumprinc-%E5%87%BD%E6%95%B0-94a4516d-bd65-41a1-bc16-053a6af4c04d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DB:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/db-%E5%87%BD%E6%95%B0-354e7d28-5f93-4ff1-8a52-eb4ee549d9d7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DDB:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/ddb-%E5%87%BD%E6%95%B0-519a7a37-8772-4c96-85c0-ed2c209717a5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DISC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/disc-%E5%87%BD%E6%95%B0-71fce9f3-3f05-4acf-a5a3-eac6ef4daa53"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DOLLARDE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dollarde-%E5%87%BD%E6%95%B0-db85aab0-1677-428a-9dfd-a38476693427"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DOLLARFR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dollarfr-%E5%87%BD%E6%95%B0-0835d163-3023-4a33-9824-3042c5d4f495"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DURATION:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/duration-%E5%87%BD%E6%95%B0-b254ea57-eadc-4602-a86a-c8e369334038"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EFFECT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/effect-%E5%87%BD%E6%95%B0-910d4e4c-79e2-4009-95e6-507e04f11bc4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/fv-%E5%87%BD%E6%95%B0-2eef9f44-a084-4c61-bdd8-4fe4bb1b71b3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FVSCHEDULE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/fvschedule-%E5%87%BD%E6%95%B0-bec29522-bd87-4082-bab9-a241f3fb251d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},INTRATE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/intrate-%E5%87%BD%E6%95%B0-5cb34dde-a221-4cb6-b3eb-0b9e55e1316f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IPMT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/ipmt-%E5%87%BD%E6%95%B0-5cce0ad6-8402-4a41-8d29-61a0b054cb6f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IRR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/irr-%E5%87%BD%E6%95%B0-64925eaa-9988-495b-b290-3ad0c163c1bc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISPMT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/ispmt-%E5%87%BD%E6%95%B0-fa58adb6-9d39-4ce0-8f43-75399cea56cc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MDURATION:{description:" 100  Macauley ",abstract:" 100  Macauley ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/mduration-%E5%87%BD%E6%95%B0-b3786a69-4f20-469a-94ad-33e5b90a763c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MIRR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/mirr-%E5%87%BD%E6%95%B0-b020f038-7492-4fb4-93c1-35c345b53524"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NOMINAL:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/nominal-%E5%87%BD%E6%95%B0-7f1ae29b-6b92-435e-b950-ad8b190ddd2b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NPER:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/nper-%E5%87%BD%E6%95%B0-240535b5-6653-4d2d-bfcf-b6a38151d815"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NPV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/npv-%E5%87%BD%E6%95%B0-8672cb67-2576-4d07-b67b-ac28acf2a568"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ODDFPRICE:{description:" 100 ",abstract:" 100 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/oddfprice-%E5%87%BD%E6%95%B0-d7d664a8-34df-4233-8d2b-922bcf6a69e1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ODDFYIELD:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/oddfyield-%E5%87%BD%E6%95%B0-66bc8b7b-6501-4c93-9ce3-2fd16220fe37"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ODDLPRICE:{description:" 100 ",abstract:" 100 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/oddlprice-%E5%87%BD%E6%95%B0-fb657749-d200-4902-afaf-ed5445027fc4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ODDLYIELD:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/oddlyield-%E5%87%BD%E6%95%B0-c873d088-cf40-435f-8d41-c8232fee9238"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PDURATION:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/pduration-%E5%87%BD%E6%95%B0-44f33460-5be5-4c90-b857-22308892adaf"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PMT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/pmt-%E5%87%BD%E6%95%B0-0214da64-9a63-4996-bc20-214433fa6441"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PPMT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/ppmt-%E5%87%BD%E6%95%B0-c370d9e3-7749-4ca4-beea-b06c6ac95e1b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PRICE:{description:" 100 ",abstract:" 100 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/price-%E5%87%BD%E6%95%B0-3ea9deac-8dfa-436f-a7c8-17ea02c21b0a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PRICEDISC:{description:" 100 ",abstract:" 100 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/pricedisc-%E5%87%BD%E6%95%B0-d06ad7c1-380e-4be7-9fd9-75e3079acfd3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PRICEMAT:{description:" 100 ",abstract:" 100 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/pricemat-%E5%87%BD%E6%95%B0-52c3b4da-bc7e-476a-989f-a95f675cae77"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/pv-%E5%87%BD%E6%95%B0-23879d31-0e02-4321-be01-da16e8168cbd"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RATE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/rate-%E5%87%BD%E6%95%B0-9f665657-4a7e-4bb7-a030-83fc59e748ce"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RECEIVED:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/received-%E5%87%BD%E6%95%B0-7a3f8b93-6611-4f81-8576-828312c9b5e5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RRI:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/rri-%E5%87%BD%E6%95%B0-6f5822d8-7ef1-4233-944c-79e8172930f4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SLN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sln-%E5%87%BD%E6%95%B0-cdb666e5-c1c6-40a7-806a-e695edc2f1c8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SYD:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/syd-%E5%87%BD%E6%95%B0-069f8106-b60b-4ca2-98e0-2a0f206bdb27"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TBILLEQ:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/tbilleq-%E5%87%BD%E6%95%B0-2ab72d90-9b4d-4efe-9fc2-0f81f2c19c8c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TBILLPRICE:{description:" 100 ",abstract:" 100 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/tbillprice-%E5%87%BD%E6%95%B0-eacca992-c29d-425a-9eb8-0513fe6035a2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TBILLYIELD:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/tbillyield-%E5%87%BD%E6%95%B0-6d381232-f4b0-4cd5-8e97-45b9c03468ba"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VDB:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/vdb-%E5%87%BD%E6%95%B0-dde4e207-f3fa-488d-91d2-66d55e861d73"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},XIRR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/xirr-%E5%87%BD%E6%95%B0-de1242ec-6477-445b-b11b-a303ad9adc9d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},XNPV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/xnpv-%E5%87%BD%E6%95%B0-1b42bbf6-370f-4532-a0eb-d67c16b664b7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},YIELD:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/yield-%E5%87%BD%E6%95%B0-f5f5ca43-c4bd-434f-8bd2-ed3c9727a4fe"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},YIELDDISC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/yielddisc-%E5%87%BD%E6%95%B0-a9dbdbae-7dae-46de-b995-615faffaaed7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},YIELDMAT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/yieldmat-%E5%87%BD%E6%95%B0-ba7d1809-0d33-4bcb-96c7-6c56ec62ef6f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},nVe={CELL:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/cell-%E5%87%BD%E6%95%B0-51bd39a5-f338-4dbe-a33f-955d67c2b2cf"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ERROR_TYPE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/error-type-%E5%87%BD%E6%95%B0-10958677-7c8d-44f7-ae77-b9a9ee6eefaa"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},INFO:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/info-%E5%87%BD%E6%95%B0-725f259a-0e4b-49b3-8b52-58815c69acae"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISBLANK:{description:" TRUE",abstract:" TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISERR:{description:" #N/A  TRUE",abstract:" #N/A  TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISERROR:{description:" TRUE",abstract:" TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISEVEN:{description:" TRUE",abstract:" TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/iseven-%E5%87%BD%E6%95%B0-aa15929a-d77b-4fbb-92f4-2f479af55356"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISFORMULA:{description:" TRUE",abstract:" TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/isformula-%E5%87%BD%E6%95%B0-e4d1355f-7121-4ef2-801e-3839bfd6b1e5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISLOGICAL:{description:" TRUE",abstract:" TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISNA:{description:" #N/A TRUE",abstract:" #N/A TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISNONTEXT:{description:" TRUE",abstract:" TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISNUMBER:{description:" TRUE",abstract:" TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISODD:{description:" TRUE",abstract:" TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISOMITTED:{description:" LAMBDA  TRUE  FALSE",abstract:" LAMBDA  TRUE  FALSE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/isomitted-%E5%87%BD%E6%95%B0-831d6fbc-0f07-40c4-9c5b-9c73fd1d60c1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISREF:{description:" TRUE",abstract:" TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISTEXT:{description:" TRUE",abstract:" TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},N:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/n-%E5%87%BD%E6%95%B0-a624cad1-3635-4208-b54a-29733d1278c9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NA:{description:" #N/A",abstract:" #N/A",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/na-%E5%87%BD%E6%95%B0-5469c2d1-a90c-4fb5-9bbc-64bd9bb6b47c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SHEET:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sheet-%E5%87%BD%E6%95%B0-44718b6f-8b87-47a1-a9d6-b701c06cff24"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SHEETS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sheets-%E5%87%BD%E6%95%B0-770515eb-e1e8-45ce-8066-b557e5e4b80b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TYPE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/type-%E5%87%BD%E6%95%B0-45b4e688-4bc3-48b3-a105-ffa892995899"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},rVe={AND:{description:" TRUE TRUE",abstract:" TRUE TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/and-%E5%87%BD%E6%95%B0-5f19b2e8-e1df-4408-897a-ce285a19e9d9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BYCOL:{description:" LAMBDA ",abstract:" LAMBDA ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/bycol-%E5%87%BD%E6%95%B0-58463999-7de5-49ce-8f38-b7f7a2192bfb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BYROW:{description:" LAMBDA ",abstract:" LAMBDA ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/byrow-%E5%87%BD%E6%95%B0-2e04c677-78c8-4e6b-8c10-a4602f2602bb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FALSE:{description:" FALSE",abstract:" FALSE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/false-%E5%87%BD%E6%95%B0-2d58dfa5-9c03-4259-bf8f-f0ae14346904"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IF:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/if-%E5%87%BD%E6%95%B0-69aed7c9-4e8a-4755-a9bc-aa8bbff73be2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IFERROR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/iferror-%E5%87%BD%E6%95%B0-c526fd07-caeb-47b8-8bb6-63f3e417f611"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IFNA:{description:" #N/A",abstract:" #N/A",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/ifna-%E5%87%BD%E6%95%B0-6626c961-a569-42fc-a49d-79b4951fd461"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IFS:{description:"  TRUE ",abstract:"  TRUE ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/ifs-%E5%87%BD%E6%95%B0-36329a26-37b2-467c-972b-4a39bd951d45"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LAMBDA:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/lambda-%E5%87%BD%E6%95%B0-bd212d27-1cd1-4321-a34a-ccbf254b8b67"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LET:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/let-%E5%87%BD%E6%95%B0-34842dd8-b92b-4d3f-b325-b8b8f9908999"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MAKEARRAY:{description:" LAMBDA ",abstract:" LAMBDA ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/makearray-%E5%87%BD%E6%95%B0-b80da5ad-b338-4149-a523-5b221da09097"}],functionParameter:{number1:{name:"rows",detail:" "},number2:{name:"cols",detail:" "},value3:{name:"lambda",detail:" LAMBDA  LAMBDA :row, col"}}},MAP:{description:" LAMBDA  () ",abstract:" LAMBDA  () ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/map-%E5%87%BD%E6%95%B0-48006093-f97c-47c1-bfcc-749263bb1f01"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NOT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/not-%E5%87%BD%E6%95%B0-9cfc6011-a054-40c7-a140-cd4ba2d87d77"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},OR:{description:" TRUE TRUE",abstract:" TRUE TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/or-%E5%87%BD%E6%95%B0-7d17ad14-8700-4281-b308-00b131e22af0"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},REDUCE:{description:" LAMBDA ",abstract:" LAMBDA ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/reduce-%E5%87%BD%E6%95%B0-42e39910-b345-45f3-84b8-0642b568b7cb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SCAN:{description:" LAMBDA ",abstract:" LAMBDA ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/scan-%E5%87%BD%E6%95%B0-d58dfd11-9969-4439-b2dc-e7062724de29"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SWITCH:{description:" ",abstract:" ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/switch-%E5%87%BD%E6%95%B0-47ab33c0-28ce-4530-8a45-d532ec4aa25e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TRUE:{description:" TRUE",abstract:" TRUE",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/true-%E5%87%BD%E6%95%B0-7652c6e3-8987-48d0-97cd-ef223246b3fb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},XOR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/xor-%E5%87%BD%E6%95%B0-1548d4c2-5e47-4f77-9a92-0533bba14f37"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},iVe={ADDRESS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/address-%E5%87%BD%E6%95%B0-d0c26c0d-3991-446b-8de4-ab46431d4f89"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},AREAS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/areas-%E5%87%BD%E6%95%B0-8392ba32-7a41-43b3-96b0-3695d2ec6152"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHOOSE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/choose-%E5%87%BD%E6%95%B0-fc5c184f-cb62-4ec7-a46e-38653b98f5bc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHOOSECOLS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/choosecols-%E5%87%BD%E6%95%B0-bf117976-2722-4466-9b9a-1c01ed9aebff"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHOOSEROWS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/chooserows-%E5%87%BD%E6%95%B0-51ace882-9bab-4a44-9625-7274ef7507a3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COLUMN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/column-%E5%87%BD%E6%95%B0-44e8c754-711c-4df3-9da4-47a55042554b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COLUMNS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/columns-%E5%87%BD%E6%95%B0-4e8e7b4e-e603-43e8-b177-956088fa48ca"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DROP:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/drop-%E5%87%BD%E6%95%B0-1cb4e151-9e17-4838-abe5-9ba48d8c6a34"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EXPAND:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/expand-%E5%87%BD%E6%95%B0-7433fba5-4ad1-41da-a904-d5d95808bc38"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FILTER:{description:"FILTER ",abstract:"FILTER ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/filter-%E5%87%BD%E6%95%B0-f4f7cb66-82eb-4767-8f7c-4877ad80c759"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORMULATEXT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/formulatext-%E5%87%BD%E6%95%B0-0a786771-54fd-4ae2-96ee-09cda35439c8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GETPIVOTDATA:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/getpivotdata-%E5%87%BD%E6%95%B0-8c083b99-a922-4ca0-af5e-3af55960761f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HLOOKUP:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/hlookup-%E5%87%BD%E6%95%B0-a3034eec-b719-4ba3-bb65-e1ad662ed95f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HSTACK:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/hstack-%E5%87%BD%E6%95%B0-98c4ab76-10fe-4b4f-8d5f-af1c125fe8c2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HYPERLINK:{description:"Intranet  Internet ",abstract:"Intranet  Internet ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/hyperlink-%E5%87%BD%E6%95%B0-333c7ce6-c5ae-4164-9c47-7de9b76f577f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMAGE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/image-%E5%87%BD%E6%95%B0-7e112975-5e52-4f2a-b9da-1d913d51f5d5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},INDEX:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/index-%E5%87%BD%E6%95%B0-a5dcf0dd-996d-40a4-a822-b56b061328bd"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},INDIRECT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/indirect-%E5%87%BD%E6%95%B0-474b3a3a-8a26-4f44-b491-92b6306fa261"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOOKUP:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/lookup-%E5%87%BD%E6%95%B0-446d94af-663b-451d-8251-369d5e3864cb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MATCH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/match-%E5%87%BD%E6%95%B0-e8dffd45-c762-47d6-bf89-533f4a37673a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},OFFSET:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/offset-%E5%87%BD%E6%95%B0-c8de19ae-dd79-4b9b-a14e-b4d906d11b66"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ROW:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/row-%E5%87%BD%E6%95%B0-3a63b74a-c4d0-4093-b49a-e76eb49a6d8d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ROWS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/rows-%E5%87%BD%E6%95%B0-b592593e-3fc2-47f2-bec1-bda493811597"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RTD:{description:" COM ",abstract:" COM ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/rtd-%E5%87%BD%E6%95%B0-e0cc001a-56f0-470a-9b19-9455dc0eb593"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SORT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sort-%E5%87%BD%E6%95%B0-22f63bd0-ccc8-492f-953d-c20e8e44b86c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SORTBY:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sortby-%E5%87%BD%E6%95%B0-cd2d7a62-1b93-435c-b561-d6a35134f28f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TAKE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/take-%E5%87%BD%E6%95%B0-25382ff1-5da1-4f78-ab43-f33bd2e4e003"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TOCOL:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/tocol-%E5%87%BD%E6%95%B0-22839d9b-0b55-4fc1-b4e6-2761f8f122ed"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TOROW:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/torow-%E5%87%BD%E6%95%B0-b90d0964-a7d9-44b7-816b-ffa5c2fe2289"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TRANSPOSE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/transpose-%E5%87%BD%E6%95%B0-ed039415-ed8a-4a81-93e9-4b6dfac76027"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},UNIQUE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/unique-%E5%87%BD%E6%95%B0-c5ab87fd-30a3-4ce9-9d1a-40204fb85e1e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VLOOKUP:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/vlookup-%E5%87%BD%E6%95%B0-0bbc8083-26fe-4963-8ab8-93a18ad188a1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VSTACK:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/vstack-%E5%87%BD%E6%95%B0-a4b86897-be0f-48fc-adca-fcc10d795a9c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WRAPCOLS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/wrapcols-%E5%87%BD%E6%95%B0-d038b05a-57b7-4ee0-be94-ded0792511e2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WRAPROWS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/wraprows-%E5%87%BD%E6%95%B0-796825f3-975a-4cee-9c84-1bbddf60ade0"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},XLOOKUP:{description:"  XLOOKUP &nbsp;",abstract:"  XLOOKUP &nbsp;",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/xlookup-%E5%87%BD%E6%95%B0-b7fd680e-6d10-43e6-84f9-88eae8bf5929"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},XMATCH:{description:"&nbsp;",abstract:"&nbsp;",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/xmatch-%E5%87%BD%E6%95%B0-d966da31-7a6b-4a13-a1c6-5a33ed6a0312"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},oVe={ABS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/abs-%E5%87%BD%E6%95%B0-3420200f-5628-4e8c-99da-c99d7c87713c"}],functionParameter:{number:{name:"",detail:""}}},ACOS:{description:"  number   0 pi ",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/acos-%E5%87%BD%E6%95%B0-cb73173f-d089-4582-afa1-76e5524b5d5b"}],functionParameter:{number:{name:"",detail:" -1  1 "}}},ACOSH:{description:"  1  number  ACOSH(COSH(number))  number",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/acosh-%E5%87%BD%E6%95%B0-e3992cc1-103f-4e72-9f04-624b9ef5ebfe"}],functionParameter:{number:{name:"",detail:" 1 "}}},ACOT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/acot-%E5%87%BD%E6%95%B0-dc7e5008-fe6b-402e-bdd6-2eea8383d905"}],functionParameter:{number:{name:"",detail:"Number  "}}},ACOTH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/acoth-%E5%87%BD%E6%95%B0-cc49480f-f684-4171-9fc5-73e4e852300f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},AGGREGATE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/aggregate-%E5%87%BD%E6%95%B0-43b9278e-6aa7-4f17-92b6-e19993fa26df"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ARABIC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/arabic-%E5%87%BD%E6%95%B0-9a8da418-c17b-4ef9-a657-9370a30a674f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ASIN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/asin-%E5%87%BD%E6%95%B0-81fb95e5-6d6f-48c4-bc45-58f955c6d347"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ASINH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/asinh-%E5%87%BD%E6%95%B0-4e00475a-067a-43cf-926a-765b0249717c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ATAN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/atan-%E5%87%BD%E6%95%B0-50746fa8-630a-406b-81d0-4a2aed395543"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ATAN2:{description:" X  Y ",abstract:" X  Y ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/atan2-%E5%87%BD%E6%95%B0-c04592ab-b9e3-4908-b428-c96b3a565033"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ATANH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/atanh-%E5%87%BD%E6%95%B0-3cd65768-0de7-4f1d-b312-d01c8c930d90"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BASE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/base-%E5%87%BD%E6%95%B0-2ef61411-aee9-4f29-a811-1c42456c6342"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CEILING:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/ceiling-%E5%87%BD%E6%95%B0-0a5cd7c8-0720-4f0a-bd2c-c943e510899f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CEILING_MATH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/ceiling-math-%E5%87%BD%E6%95%B0-80f95d2f-b499-4eee-9f16-f795a8e306c8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CEILING_PRECISE:{description:" ",abstract:" ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/ceiling-precise-%E5%87%BD%E6%95%B0-f366a774-527a-4c92-ba49-af0a196e66cb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COMBIN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/combin-%E5%87%BD%E6%95%B0-12a3f276-0a21-423a-8de6-06990aaf638a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COMBINA:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/combina-%E5%87%BD%E6%95%B0-efb49eaa-4f4c-4cd2-8179-0ddfcf9d035d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/cos-%E5%87%BD%E6%95%B0-0fb808a5-95d6-4553-8148-22aebdce5f05"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COSH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/cosh-%E5%87%BD%E6%95%B0-e460d426-c471-43e8-9540-a57ff3b70555"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/cot-%E5%87%BD%E6%95%B0-c446f34d-6fe4-40dc-84f8-cf59e5f5e31a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COTH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/coth-%E5%87%BD%E6%95%B0-2e0b4cb6-0ba0-403e-aed4-deaa71b49df5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CSC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/csc-%E5%87%BD%E6%95%B0-07379361-219a-4398-8675-07ddc4f135c1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CSCH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/csch-%E5%87%BD%E6%95%B0-f58f2c22-eb75-4dd6-84f4-a503527f8eeb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DECIMAL:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/decimal-%E5%87%BD%E6%95%B0-ee554665-6176-46ef-82de-0a283658da2e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DEGREES:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/degrees-%E5%87%BD%E6%95%B0-4d6ec4db-e694-4b94-ace0-1cc3f61f9ba1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EVEN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/even-%E5%87%BD%E6%95%B0-197b5f06-c795-4c1e-8696-3c3b8a646cf9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EXP:{description:"e n ",abstract:"e n ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/exp-%E5%87%BD%E6%95%B0-c578f034-2c45-4c37-bc8c-329660a63abe"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FACT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/fact-%E5%87%BD%E6%95%B0-ca8588c2-15f2-41c0-8e8c-c11bd471a4f3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FACTDOUBLE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/factdouble-%E5%87%BD%E6%95%B0-e67697ac-d214-48eb-b7b7-cce2589ecac8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FLOOR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/floor-%E5%87%BD%E6%95%B0-14bb497c-24f2-4e04-b327-b0b4de5a8886"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FLOOR_MATH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/floor-math-%E5%87%BD%E6%95%B0-c302b599-fbdb-4177-ba19-2c2b1249a2f5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FLOOR_PRECISE:{description:" ",abstract:" ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/floor-precise-%E5%87%BD%E6%95%B0-f769b468-1452-4617-8dc3-02f842a0702e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GCD:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/gcd-%E5%87%BD%E6%95%B0-d5107a51-69e3-461f-8e4c-ddfc21b5073a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},INT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/int-%E5%87%BD%E6%95%B0-a6c4af9e-356d-4369-ab6a-cb1fd9d343ef"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISO_CEILING:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/iso-ceiling-%E5%87%BD%E6%95%B0-e587bb73-6cc2-4113-b664-ff5b09859a83"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LCM:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/lcm-%E5%87%BD%E6%95%B0-7152b67a-8bb5-4075-ae5c-06ede5563c94"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LET:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/let-%E5%87%BD%E6%95%B0-34842dd8-b92b-4d3f-b325-b8b8f9908999"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/ln-%E5%87%BD%E6%95%B0-81fe1ed7-dac9-4acd-ba1d-07a142c6118f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOG:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/log-%E5%87%BD%E6%95%B0-4e82f196-1ca9-4747-8fb0-6c4a3abb3280"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOG10:{description:" 10 ",abstract:" 10 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/log10-%E5%87%BD%E6%95%B0-c75b881b-49dd-44fb-b6f4-37e3486a0211"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MDETERM:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/mdeterm-%E5%87%BD%E6%95%B0-e7bfa857-3834-422b-b871-0ffd03717020"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MINVERSE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/minverse-%E5%87%BD%E6%95%B0-11f55086-adde-4c9f-8eb9-59da2d72efc6"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MMULT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/mmult-%E5%87%BD%E6%95%B0-40593ed7-a3cd-4b6b-b9a3-e4ad3c7245eb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MOD:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/mod-%E5%87%BD%E6%95%B0-9b6cd169-b6ee-406a-a97b-edf2a9dc24f3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MROUND:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/mround-%E5%87%BD%E6%95%B0-c299c3b0-15a5-426d-aa4b-d2d5b3baf427"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MULTINOMIAL:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/multinomial-%E5%87%BD%E6%95%B0-6fa6373c-6533-41a2-a45e-a56db1db1bf6"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MUNIT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/munit-%E5%87%BD%E6%95%B0-c9fe916a-dc26-4105-997d-ba22799853a3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ODD:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/odd-%E5%87%BD%E6%95%B0-deae64eb-e08a-4c88-8b40-6d0b42575c98"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PI:{description:" pi ",abstract:" pi ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/pi-%E5%87%BD%E6%95%B0-264199d0-a3ba-46b8-975a-c4a04608989b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},POWER:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/power-%E5%87%BD%E6%95%B0-d3f2908b-56f4-4c3f-895a-07fb519c362a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PRODUCT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/product-%E5%87%BD%E6%95%B0-8e6b5b24-90ee-4650-aeec-80982a0512ce"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},QUOTIENT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/quotient-%E5%87%BD%E6%95%B0-9f7bf099-2a18-4282-8fa4-65290cc99dee"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RADIANS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/radians-%E5%87%BD%E6%95%B0-ac409508-3d48-45f5-ac02-1497c92de5bf"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RAND:{description:" 0  1 ",abstract:" 0  1 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/rand-%E5%87%BD%E6%95%B0-4cbfa695-8869-4788-8d90-021ea9f5be73"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RANDARRAY:{description:"RANDARRAY  0  1  ",abstract:"RANDARRAY  0  1  ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/randarray-%E5%87%BD%E6%95%B0-21261e55-3bec-4885-86a6-8b0a47fd4d33"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RANDBETWEEN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/randbetween-%E5%87%BD%E6%95%B0-4cc7f0d1-87dc-4eb7-987f-a469ab381685"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ROMAN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/roman-%E5%87%BD%E6%95%B0-d6b0b99e-de46-4704-a518-b45a0f8b56f5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ROUND:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/round-%E5%87%BD%E6%95%B0-c018c5d8-40fb-4053-90b1-b3e7f61a213c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ROUNDDOWN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/rounddown-%E5%87%BD%E6%95%B0-2ec94c73-241f-4b01-8c6f-17e6d7968f53"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ROUNDUP:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/roundup-%E5%87%BD%E6%95%B0-f8bc9b23-e795-47db-8703-db171d0c42a7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SEC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sec-%E5%87%BD%E6%95%B0-ff224717-9c87-4170-9b58-d069ced6d5f7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SECH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sech-%E5%87%BD%E6%95%B0-e05a789f-5ff7-4d7f-984a-5edb9b09556f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SERIESSUM:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/seriessum-%E5%87%BD%E6%95%B0-a3ab25b5-1093-4f5b-b084-96c49087f637"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SEQUENCE:{description:"SEQUENCE 1234",abstract:"SEQUENCE 1234",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sequence-%E5%87%BD%E6%95%B0-57467a98-57e0-4817-9f14-2eb78519ca90"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SIGN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sign-%E5%87%BD%E6%95%B0-109c932d-fcdc-4023-91f1-2dd0e916a1d8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SIN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sin-%E5%87%BD%E6%95%B0-cf0e3432-8b9e-483c-bc55-a76651c95602"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SINH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sinh-%E5%87%BD%E6%95%B0-1e4e8b9f-2b65-43fc-ab8a-0a37f4081fa7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SQRT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sqrt-%E5%87%BD%E6%95%B0-654975c2-05c4-4831-9a24-2c65e4040fdf"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SQRTPI:{description:" pi ",abstract:" pi ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sqrtpi-%E5%87%BD%E6%95%B0-1fb4e63f-9b51-46d6-ad68-b3e7a8b519b4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUBTOTAL:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/subtotal-%E5%87%BD%E6%95%B0-7b027003-f060-4ade-9040-e478765b9939"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUM:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sum-%E5%87%BD%E6%95%B0-043e1c7d-7726-4e80-8f32-07b23e057f89"}],functionParameter:{number1:{name:"1",detail:"  4 B6  B2:B8 "},number2:{name:"2",detail:"  255 "}}},SUMIF:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sumif-%E5%87%BD%E6%95%B0-169b8c99-c05c-4483-a712-1697a653039b"}],functionParameter:{range:{name:"",detail:""},criteria:{name:"",detail:" - * ~"},sum_range:{name:"",detail:" sum_rangeExcel"}}},SUMIFS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sumifs-%E5%87%BD%E6%95%B0-c9e748f5-7ea7-455d-9406-611cebce642b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUMPRODUCT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sumproduct-%E5%87%BD%E6%95%B0-16753e75-9f68-4874-94ac-4d2145a2fd2e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUMSQ:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sumsq-%E5%87%BD%E6%95%B0-e3313c02-51cc-4963-aae6-31442d9ec307"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUMX2MY2:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sumx2my2-%E5%87%BD%E6%95%B0-9e599cc5-5399-48e9-a5e0-e37812dfa3e9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUMX2PY2:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sumx2py2-%E5%87%BD%E6%95%B0-826b60b4-0aa2-4e5e-81d2-be704d3d786f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUMXMY2:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/sumxmy2-%E5%87%BD%E6%95%B0-9d144ac1-4d79-43de-b524-e2ecee23b299"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TAN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/tan-%E5%87%BD%E6%95%B0-08851a40-179f-4052-b789-d7f699447401"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TANH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/tanh-%E5%87%BD%E6%95%B0-017222f0-a0c3-4f69-9787-b3202295dc6c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TRUNC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/trunc-%E5%87%BD%E6%95%B0-8b86a64c-3127-43db-ba14-aa5ceb292721"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},sVe={AVEDEV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/avedev-%E5%87%BD%E6%95%B0-58fe8d65-2a84-4dc7-8052-f3f87b5c6639"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},AVERAGE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/average-%E5%87%BD%E6%95%B0-047bac88-d466-426c-a32b-8f33eb960cf6"}],functionParameter:{number1:{name:"1",detail:""},number2:{name:"2",detail:" 255 "}}},AVERAGEA:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/averagea-%E5%87%BD%E6%95%B0-f5f84098-d453-4f4c-bbba-3d2c66356091"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},AVERAGEIF:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/averageif-%E5%87%BD%E6%95%B0-faec8e2e-0dec-4308-af69-f5576d8ac642"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},AVERAGEIFS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/averageifs-%E5%87%BD%E6%95%B0-48910c45-1fc0-4389-a028-f7c5c3001690"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BETA_DIST:{description:" beta ",abstract:" beta ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/beta-dist-%E5%87%BD%E6%95%B0-11188c9c-780a-42c7-ba43-9ecb5a878d31"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BETA_INV:{description:" beta ",abstract:" beta ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/beta-inv-%E5%87%BD%E6%95%B0-e84cb8aa-8df0-4cf6-9892-83a341d252eb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BINOM_DIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/binom-dist-%E5%87%BD%E6%95%B0-c5ae37b6-f39c-4be2-94c2-509a1480770c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BINOM_DIST_RANGE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/binom-dist-range-%E5%87%BD%E6%95%B0-17331329-74c7-4053-bb4c-6653a7421595"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BINOM_INV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/binom-inv-%E5%87%BD%E6%95%B0-80a0370c-ada6-49b4-83e7-05a91ba77ac9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHISQ_DIST:{description:" beta ",abstract:" beta ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/chisq-dist-%E5%87%BD%E6%95%B0-8486b05e-5c05-4942-a9ea-f6b341518732"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHISQ_DIST_RT:{description:" 2 ",abstract:" 2 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/chisq-dist-rt-%E5%87%BD%E6%95%B0-dc4832e8-ed2b-49ae-8d7c-b28d5804c0f2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHISQ_INV:{description:" beta ",abstract:" beta ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/chisq-inv-%E5%87%BD%E6%95%B0-400db556-62b3-472d-80b3-254723e7092f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHISQ_INV_RT:{description:" 2 ",abstract:" 2 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/chisq-inv-rt-%E5%87%BD%E6%95%B0-435b5ed8-98d5-4da6-823f-293e2cbc94fe"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHISQ_TEST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/chisq-test-%E5%87%BD%E6%95%B0-2e8a7861-b14a-4985-aa93-fb88de3f260f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CONFIDENCE_NORM:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/confidence-norm-%E5%87%BD%E6%95%B0-7cec58a6-85bb-488d-91c3-63828d4fbfd4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CONFIDENCE_T:{description:" t-",abstract:" t-",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/confidence-t-%E5%87%BD%E6%95%B0-e8eca395-6c3a-4ba9-9003-79ccc61d3c53"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CORREL:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/correl-%E5%87%BD%E6%95%B0-995dcef7-0c0a-4bed-a3fb-239d7b68ca92"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUNT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/count-%E5%87%BD%E6%95%B0-a59cd7fc-b623-4d93-87a4-d23bf411294c"}],functionParameter:{value1:{name:"1",detail:""},value2:{name:"2",detail:" 255 "}}},COUNTA:{description:` ("")
         COUNT `,abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/counta-%E5%87%BD%E6%95%B0-7dc98875-d5c1-46f1-9a82-53f3219e2509"}],functionParameter:{number1:{name:"1",detail:" "},number2:{name:"2",detail:"  255 "}}},COUNTBLANK:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/countblank-%E5%87%BD%E6%95%B0-6a92d772-675c-4bee-b346-24af6bd3ac22"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUNTIF:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/countif-%E5%87%BD%E6%95%B0-e0de10c6-f885-4e71-abb4-1f464816df34"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUNTIFS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/countifs-%E5%87%BD%E6%95%B0-dda3dc6e-f74e-4aee-88bc-aa8c2a866842"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COVARIANCE_P:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/covariance-p-%E5%87%BD%E6%95%B0-6f0e1e6d-956d-4e4b-9943-cfef0bf9edfc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COVARIANCE_S:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/covariance-s-%E5%87%BD%E6%95%B0-0a539b74-7371-42aa-a18f-1f5320314977"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DEVSQ:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/devsq-%E5%87%BD%E6%95%B0-8b739616-8376-4df5-8bd0-cfe0a6caf444"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EXPON_DIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/expon-dist-%E5%87%BD%E6%95%B0-4c12ae24-e563-4155-bf3e-8b78b6ae140e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},F_DIST:{description:" F ",abstract:" F ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/f-dist-%E5%87%BD%E6%95%B0-a887efdc-7c8e-46cb-a74a-f884cd29b25d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},F_DIST_RT:{description:" F ",abstract:" F ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/f-dist-rt-%E5%87%BD%E6%95%B0-d74cbb00-6017-4ac9-b7d7-6049badc0520"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},F_INV:{description:" F ",abstract:" F ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/f-inv-%E5%87%BD%E6%95%B0-0dda0cf9-4ea0-42fd-8c3c-417a1ff30dbe"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},F_INV_RT:{description:" F ",abstract:" F ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/f-inv-rt-%E5%87%BD%E6%95%B0-d371aa8f-b0b1-40ef-9cc2-496f0693ac00"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},F_TEST:{description:" F ",abstract:" F ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/f-test-%E5%87%BD%E6%95%B0-100a59e7-4108-46f8-8443-78ffacb6c0a7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FISHER:{description:" Fisher ",abstract:" Fisher ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/fisher-%E5%87%BD%E6%95%B0-d656523c-5076-4f95-b87b-7741bf236c69"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FISHERINV:{description:" Fisher ",abstract:" Fisher ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/fisherinv-%E5%87%BD%E6%95%B0-62504b39-415a-4284-a285-19c8e82f86bb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORECAST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/forecast-%E5%92%8C-forecast-linear-%E5%87%BD%E6%95%B0-50ca49c9-7b40-4892-94e4-7ad38bbeda99"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORECAST_ETS:{description:" (ETS)  AAA ",abstract:" (ETS)  AAA ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/%E9%A2%84%E6%B5%8B%E5%87%BD%E6%95%B0-%E5%8F%82%E8%80%83-897a2fe9-6595-4680-a0b0-93e0308d5f6e#_FORECAST.ETS"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORECAST_ETS_CONFINT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/%E9%A2%84%E6%B5%8B%E5%87%BD%E6%95%B0-%E5%8F%82%E8%80%83-897a2fe9-6595-4680-a0b0-93e0308d5f6e#_FORECAST.ETS.CONFINT"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORECAST_ETS_SEASONALITY:{description:" Excel ",abstract:" Excel ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/%E9%A2%84%E6%B5%8B%E5%87%BD%E6%95%B0-%E5%8F%82%E8%80%83-897a2fe9-6595-4680-a0b0-93e0308d5f6e#_FORECAST.ETS.SEASONALITY"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORECAST_ETS_STAT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/%E9%A2%84%E6%B5%8B%E5%87%BD%E6%95%B0-%E5%8F%82%E8%80%83-897a2fe9-6595-4680-a0b0-93e0308d5f6e#_FORECAST.ETS.STAT"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORECAST_LINEAR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/%E9%A2%84%E6%B5%8B%E5%87%BD%E6%95%B0-%E5%8F%82%E8%80%83-897a2fe9-6595-4680-a0b0-93e0308d5f6e#_FORECAST.LINEAR"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FREQUENCY:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/frequency-%E5%87%BD%E6%95%B0-44e3be2b-eca0-42cd-a3f7-fd9ea898fdb9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMA:{description:"  ",abstract:"  ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/gamma-%E5%87%BD%E6%95%B0-ce1702b1-cf55-471d-8307-f83be0fc5297"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMA_DIST:{description:"  ",abstract:"  ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/gamma-dist-%E5%87%BD%E6%95%B0-9b6f1538-d11c-4d5f-8966-21f6a2201def"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMA_INV:{description:"  ",abstract:"  ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/gamma-inv-%E5%87%BD%E6%95%B0-74991443-c2b0-4be5-aaab-1aa4d71fbb18"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMALN:{description:"  (x)",abstract:"  (x)",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/gammaln-%E5%87%BD%E6%95%B0-b838c48b-c65f-484f-9e1d-141c55470eb9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMALN_PRECISE:{description:"  (x)",abstract:"  (x)",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/gammaln-precise-%E5%87%BD%E6%95%B0-5cdfe601-4e1e-4189-9d74-241ef1caa599"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAUSS:{description:" 0.5 ",abstract:" 0.5 ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/gauss-%E5%87%BD%E6%95%B0-069f1b4e-7dee-4d6a-a71f-4b69044a6b33"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GEOMEAN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/geomean-%E5%87%BD%E6%95%B0-db1ac48d-25a5-40a0-ab83-0b38980e40d5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GROWTH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/growth-%E5%87%BD%E6%95%B0-541a91dc-3d5e-437d-b156-21324e68b80d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HARMEAN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/harmean-%E5%87%BD%E6%95%B0-5efd9184-fab5-42f9-b1d3-57883a1d3bc6"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HYPGEOM_DIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/hypgeom-dist-%E5%87%BD%E6%95%B0-6dbd547f-1d12-4b1f-8ae5-b0d9e3d22fbf"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},INTERCEPT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/intercept-%E5%87%BD%E6%95%B0-2a9b74e2-9d47-4772-b663-3bca70bf63ef"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},KURT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/kurt-%E5%87%BD%E6%95%B0-bc3a265c-5da4-4dcb-b7fd-c237789095ab"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LARGE:{description:" k ",abstract:" k ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/large-%E5%87%BD%E6%95%B0-3af0af19-1190-42bb-bb8b-01672ec00a64"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LINEST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/linest-%E5%87%BD%E6%95%B0-84d7d0d9-6e50-4101-977a-fa7abf772b6d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOGEST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/logest-%E5%87%BD%E6%95%B0-f27462d8-3657-4030-866b-a272c1d18b4b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOGNORM_DIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/lognorm-dist-%E5%87%BD%E6%95%B0-eb60d00b-48a9-4217-be2b-6074aee6b070"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOGNORM_INV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/lognorm-inv-%E5%87%BD%E6%95%B0-fe79751a-f1f2-4af8-a0a1-e151b2d4f600"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MAX:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/max-%E5%87%BD%E6%95%B0-e0012414-9ac8-4b34-9a47-73e662c08098"}],functionParameter:{number1:{name:"1",detail:""},number2:{name:"2",detail:" 255 "}}},MAXA:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/maxa-%E5%87%BD%E6%95%B0-814bda1e-3840-4bff-9365-2f59ac2ee62d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MAXIFS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/maxifs-%E5%87%BD%E6%95%B0-dfd611e6-da2c-488a-919b-9b6376b28883"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MEDIAN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/median-%E5%87%BD%E6%95%B0-d0916313-4753-414c-8537-ce85bdd967d2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MIN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/min-%E5%87%BD%E6%95%B0-61635d12-920f-4ce2-a70f-96f202dcc152"}],functionParameter:{number1:{name:"1",detail:""},number2:{name:"2",detail:" 255 "}}},MINA:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/mina-%E5%87%BD%E6%95%B0-245a6f46-7ca5-4dc7-ab49-805341bc31d3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MINIFS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/minifs-%E5%87%BD%E6%95%B0-6ca1ddaa-079b-4e74-80cc-72eef32e6599"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MODE_MULT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/mode-mult-%E5%87%BD%E6%95%B0-50fd9464-b2ba-4191-b57a-39446689ae8c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MODE_SNGL:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/mode-sngl-%E5%87%BD%E6%95%B0-f1267c16-66c6-4386-959f-8fba5f8bb7f8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NEGBINOM_DIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/negbinom-dist-%E5%87%BD%E6%95%B0-c8239f89-c2d0-45bd-b6af-172e570f8599"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORM_DIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/norm-dist-%E5%87%BD%E6%95%B0-edb1cc14-a21c-4e53-839d-8082074c9f8d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORM_INV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/norm-inv-%E5%87%BD%E6%95%B0-54b30935-fee7-493c-bedb-2278a9db7e13"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORM_S_DIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/norm-s-dist-%E5%87%BD%E6%95%B0-1e787282-3832-4520-a9ae-bd2a8d99ba88"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORM_S_INV:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/norm-s-inv-%E5%87%BD%E6%95%B0-d6d556b4-ab7f-49cd-b526-5a20918452b1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PEARSON:{description:" Pearson ",abstract:" Pearson ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/pearson-%E5%87%BD%E6%95%B0-0c3e30fc-e5af-49c4-808a-3ef66e034c18"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERCENTILE_EXC:{description:" k  k  0  1 0  1",abstract:" k  k  0  1 0  1",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/percentile-exc-%E5%87%BD%E6%95%B0-bbaa7204-e9e1-4010-85bf-c31dc5dce4ba"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERCENTILE_INC:{description:" k ",abstract:" k ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/percentile-inc-%E5%87%BD%E6%95%B0-680f9539-45eb-410b-9a5e-c1355e5fe2ed"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERCENTRANK_EXC:{description:" 0  1 0  1",abstract:" 0  1 0  1",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/percentrank-exc-%E5%87%BD%E6%95%B0-d8afee96-b7e2-4a2f-8c01-8fcdedaa6314"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERCENTRANK_INC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/percentrank-inc-%E5%87%BD%E6%95%B0-149592c9-00c0-49ba-86c1-c1f45b80463a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERMUT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/permut-%E5%87%BD%E6%95%B0-3bd1cb9a-2880-41ab-a197-f246a7a602d3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERMUTATIONA:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/permutationa-%E5%87%BD%E6%95%B0-6c7d7fdc-d657-44e6-aa19-2857b25cae4e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PHI:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/phi-%E5%87%BD%E6%95%B0-23e49bc6-a8e8-402d-98d3-9ded87f6295c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},POISSON_DIST:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/poisson-dist-%E5%87%BD%E6%95%B0-8fe148ff-39a2-46cb-abf3-7772695d9636"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PROB:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/prob-%E5%87%BD%E6%95%B0-9ac30561-c81c-4259-8253-34f0a238fc49"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},QUARTILE_EXC:{description:" 0  1 0  1",abstract:" 0  1 0  1",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/quartile-exc-%E5%87%BD%E6%95%B0-5a355b7a-840b-4a01-b0f1-f538c2864cad"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},QUARTILE_INC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/quartile-inc-%E5%87%BD%E6%95%B0-1bbacc80-5075-42f1-aed6-47d735c4819d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RANK_AVG:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/rank-avg-%E5%87%BD%E6%95%B0-bd406a6f-eb38-4d73-aa8e-6d1c3c72e83a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RANK_EQ:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/rank-eq-%E5%87%BD%E6%95%B0-284858ce-8ef6-450e-b662-26245be04a40"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RSQ:{description:" Pearson ",abstract:" Pearson ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/rsq-%E5%87%BD%E6%95%B0-d7161715-250d-4a01-b80d-a8364f2be08f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SKEW:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/skew-%E5%87%BD%E6%95%B0-bdf49d86-b1ef-4804-a046-28eaea69c9fa"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SKEW_P:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/skew-p-%E5%87%BD%E6%95%B0-76530a5c-99b9-48a1-8392-26632d542fcb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SLOPE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/slope-%E5%87%BD%E6%95%B0-11fb8f97-3117-4813-98aa-61d7e01276b9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SMALL:{description:" k ",abstract:" k ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/small-%E5%87%BD%E6%95%B0-17da8222-7c82-42b2-961b-14c45384df07"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STANDARDIZE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/standardize-%E5%87%BD%E6%95%B0-81d66554-2d54-40ec-ba83-6437108ee775"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STDEV_P:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/stdev-p-%E5%87%BD%E6%95%B0-6e917c05-31a0-496f-ade7-4f4e7462f285"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STDEV_S:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/stdev-s-%E5%87%BD%E6%95%B0-7d69cf97-0c1f-4acf-be27-f3e83904cc23"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STDEVA:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/stdeva-%E5%87%BD%E6%95%B0-5ff38888-7ea5-48de-9a6d-11ed73b29e9d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STDEVPA:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/stdevpa-%E5%87%BD%E6%95%B0-5578d4d6-455a-4308-9991-d405afe2c28c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STEYX:{description:" x  y ",abstract:" x  y ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/steyx-%E5%87%BD%E6%95%B0-6ce74b2c-449d-4a6e-b9ac-f9cef5ba48ab"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T_DIST:{description:" t-",abstract:" t-",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/t-dist-%E5%87%BD%E6%95%B0-4329459f-ae91-48c2-bba8-1ead1c6c21b2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T_DIST_2T:{description:" t-",abstract:" t-",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/t-dist-2t-%E5%87%BD%E6%95%B0-198e9340-e360-4230-bd21-f52f22ff5c28"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T_DIST_RT:{description:" t-",abstract:" t-",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/t-dist-rt-%E5%87%BD%E6%95%B0-20a30020-86f9-4b35-af1f-7ef6ae683eda"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T_INV:{description:" t  t ",abstract:" t  t ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/t-inv-%E5%87%BD%E6%95%B0-2908272b-4e61-4942-9df9-a25fec9b0e2e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T_INV_2T:{description:" t-",abstract:" t-",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/t-inv-2t-%E5%87%BD%E6%95%B0-ce72ea19-ec6c-4be7-bed2-b9baf2264f17"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T_TEST:{description:" t-",abstract:" t-",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/t-test-%E5%87%BD%E6%95%B0-d4e08ec3-c545-485f-962e-276f7cbed055"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TREND:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/trend-%E5%87%BD%E6%95%B0-e2f135f0-8827-4096-9873-9a7cf7b51ef1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TRIMMEAN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/trimmean-%E5%87%BD%E6%95%B0-d90c9878-a119-4746-88fa-63d988f511d3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VAR_P:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/var-p-%E5%87%BD%E6%95%B0-73d1285c-108c-4843-ba5d-a51f90656f3a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VAR_S:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/var-s-%E5%87%BD%E6%95%B0-913633de-136b-449d-813e-65a00b2b990b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VARA:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/vara-%E5%87%BD%E6%95%B0-3de77469-fa3a-47b4-85fd-81758a1e1d07"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VARPA:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/varpa-%E5%87%BD%E6%95%B0-59a62635-4e89-4fad-88ac-ce4dc0513b96"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WEIBULL_DIST:{description:" Weibull ",abstract:" Weibull ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/weibull-dist-%E5%87%BD%E6%95%B0-4e783c39-9325-49be-bbc9-a83ef82b45db"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},Z_TEST:{description:" z ",abstract:" z ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/z-test-%E5%87%BD%E6%95%B0-d633d5a3-2031-4614-a016-92180ad82bee"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},aVe={ASC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/asc-%E5%87%BD%E6%95%B0-0b6abf1c-c663-4004-a964-ebc00b723266"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ARRAYTOTEXT:{description:"ARRAYTOTEXT ",abstract:"ARRAYTOTEXT ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/arraytotext-%E5%87%BD%E6%95%B0-9cdcad46-2fa5-4c6b-ac92-14e7bc862b8b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BAHTTEXT:{description:" ",abstract:" ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/bahttext-%E5%87%BD%E6%95%B0-5ba4d0b4-abd3-4325-8d22-7a92d59aab9c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHAR:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/char-%E5%87%BD%E6%95%B0-bbd249c8-b36e-4a91-8017-1c133f9b837a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CLEAN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/clean-%E5%87%BD%E6%95%B0-26f3d7c5-475f-4a9c-90e5-4b8ba987ba41"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CODE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/code-%E5%87%BD%E6%95%B0-c32b692b-2ed0-4a04-bdd9-75640144b928"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CONCAT:{description:"/ IgnoreEmpty ",abstract:"/ IgnoreEmpty ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/concat-%E5%87%BD%E6%95%B0-9b1a9a3f-94ff-41af-9736-694cbd6b4ca2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CONCATENATE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/concatenate-%E5%87%BD%E6%95%B0-8f8ae884-2ca8-4f7a-b093-75d702bea31d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DBCS:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dbcs-%E5%87%BD%E6%95%B0-a4025e73-63d2-4958-9423-21a24794c9e5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DOLLAR:{description:" ",abstract:" ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/dollar-%E5%87%BD%E6%95%B0-a6cd05d9-9740-4ad3-a469-8109d18ff611"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EXACT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/exact-%E5%87%BD%E6%95%B0-d3087698-fc15-4a15-9631-12575cf29926"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FIND:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/find-findb-%E5%87%BD%E6%95%B0-c7912941-af2a-4bdf-a553-d0d89b0a0628"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FINDB:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/find-findb-%E5%87%BD%E6%95%B0-c7912941-af2a-4bdf-a553-d0d89b0a0628"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FIXED:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/fixed-%E5%87%BD%E6%95%B0-ffd5723c-324c-45e9-8b96-e41be2a8274a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LEFT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/left-leftb-%E5%87%BD%E6%95%B0-9203d2d2-7960-479b-84c6-1ea52b99640c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LEFTB:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/left-leftb-%E5%87%BD%E6%95%B0-9203d2d2-7960-479b-84c6-1ea52b99640c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LEN:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/len-lenb-%E5%87%BD%E6%95%B0-29236f94-cedc-429d-affd-b5e33d2c67cb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LENB:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/len-lenb-%E5%87%BD%E6%95%B0-29236f94-cedc-429d-affd-b5e33d2c67cb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOWER:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/lower-%E5%87%BD%E6%95%B0-3f21df02-a80c-44b2-afaf-81358f9fdeb4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MID:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/mid-midb-%E5%87%BD%E6%95%B0-d5f9e25c-d7d6-472e-b568-4ecb12433028"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MIDB:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/mid-midb-%E5%87%BD%E6%95%B0-d5f9e25c-d7d6-472e-b568-4ecb12433028"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NUMBERVALUE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/numbervalue-%E5%87%BD%E6%95%B0-1b05c8cf-2bfa-4437-af70-596c7ea7d879"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PHONETIC:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/phonetic-%E5%87%BD%E6%95%B0-9a329dac-0c0f-42f8-9a55-639086988554"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PROPER:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/proper-%E5%87%BD%E6%95%B0-52a5a283-e8b2-49be-8506-b2887b889f94"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},REPLACE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/replace-replaceb-%E5%87%BD%E6%95%B0-8d799074-2425-4a8a-84bc-82472868878a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},REPLACEB:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/replace-replaceb-%E5%87%BD%E6%95%B0-8d799074-2425-4a8a-84bc-82472868878a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},REPT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/rept-%E5%87%BD%E6%95%B0-04c4d778-e712-43b4-9c15-d656582bb061"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RIGHT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/right-rightb-%E5%87%BD%E6%95%B0-240267ee-9afa-4639-a02b-f19e1786cf2f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RIGHTB:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/right-rightb-%E5%87%BD%E6%95%B0-240267ee-9afa-4639-a02b-f19e1786cf2f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SEARCH:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/search-searchb-%E5%87%BD%E6%95%B0-9ab04538-0e55-4719-a72e-b6f54513b495"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SEARCHB:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/search-searchb-%E5%87%BD%E6%95%B0-9ab04538-0e55-4719-a72e-b6f54513b495"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUBSTITUTE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/substitute-%E5%87%BD%E6%95%B0-6434944e-a904-4336-a9b0-1e58df3bc332"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/t-%E5%87%BD%E6%95%B0-fb83aeec-45e7-4924-af95-53e073541228"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TEXT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/text-%E5%87%BD%E6%95%B0-20d5ac4d-7b94-49fd-bb38-93d29371225c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TEXTAFTER:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/textafter-%E5%87%BD%E6%95%B0-c8db2546-5b51-416a-9690-c7e6722e90b4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TEXTBEFORE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/textbefore-%E5%87%BD%E6%95%B0-d099c28a-dba8-448e-ac6c-f086d0fa1b29"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TEXTJOIN:{description:"/",abstract:"/",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/textjoin-%E5%87%BD%E6%95%B0-357b449a-ec91-49d0-80c3-0e8fc845691c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TEXTSPLIT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/textsplit-%E5%87%BD%E6%95%B0-b1ca414e-4c21-4ca0-b1b7-bdecace8a6e7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TRIM:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/trim-%E5%87%BD%E6%95%B0-410388fa-c5df-49c6-b16c-9e5630b479f9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},UNICHAR:{description:" Unicode ",abstract:" Unicode ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/unichar-%E5%87%BD%E6%95%B0-ffeb64f5-f131-44c6-b332-5cd72f0659b8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},UNICODE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/unicode-%E5%87%BD%E6%95%B0-adb74aaa-a2a5-4dde-aff6-966e4e81f16f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},UPPER:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/upper-%E5%87%BD%E6%95%B0-c11f29b3-d1a3-4537-8df6-04d0049963d6"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VALUE:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/value-%E5%87%BD%E6%95%B0-257d0108-07dc-437d-ae1c-bc2d3953d8c2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VALUETOTEXT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/valuetotext-%E5%87%BD%E6%95%B0-5fff61a2-301a-4ab2-9ffa-0a5242a08fea"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CALL:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/call-%E5%87%BD%E6%95%B0-32d58445-e646-4ffd-8d5e-b45077a5e995"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EUROCONVERT:{description:"",abstract:"",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/euroconvert-%E5%87%BD%E6%95%B0-79c8fd67-c665-450c-bb6c-15fc92f8345c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},REGISTER_ID:{description:" (DLL) ",abstract:" (DLL) ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/register-id-%E5%87%BD%E6%95%B0-f8f0af0f-fd66-4704-a0f2-87b27b175b50"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},lVe={},uVe={ENCODEURL:{description:" URL ",abstract:" URL ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/encodeurl-%E5%87%BD%E6%95%B0-07c7fb90-7c60-4bff-8687-fac50fe33d0e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FILTERXML:{description:" XPath XML ",abstract:" XPath XML ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/filterxml-%E5%87%BD%E6%95%B0-4df72efc-11ec-4951-86f5-c1374812f5b7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WEBSERVICE:{description:" Web ",abstract:" Web ",links:[{title:"",url:"https://support.microsoft.com/zh-cn/office/webservice-%E5%87%BD%E6%95%B0-0546a35a-ecc6-4739-aed7-c0b7ce1562c4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},cVe={formula:{insert:{tooltip:"",sum:"",average:"",count:"",max:"",min:"",more:"..."},functionList:{...tVe,...JHe,...oVe,...sVe,...iVe,...QHe,...aVe,...rVe,...nVe,...eVe,...qHe,...ZHe,...uVe,...KHe,...lVe},prompt:{helpExample:"",helpAbstract:"",required:"",optional:""},functionType:{financial:"",date:"",math:"",statistical:"",lookup:"",database:"",text:"",logical:"",information:"",engineering:"",cube:"",compatibility:"",web:"Web",array:"",univer:"Univer"},moreFunctions:{confirm:"",prev:"",next:"",searchFunctionPlaceholder:"",allFunctions:"",syntax:""},operation:{pasteFormula:""}}};var dVe=Object.defineProperty,hVe=Object.getOwnPropertyDescriptor,fVe=(t,e,n,r)=>{for(var i=r>1?void 0:r?hVe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&dVe(e,n,i),i},kp=(t,e)=>(n,r)=>e(n,r,t),Ap;let V_=(Ap=class extends S1{constructor(t,e,n,r){super(WF),this._config=t,this._injector=e,this._localeService=n,this._currentUniverService=r}initialize(){this._localeService.load({zhCN:cVe}),[[yc,{useClass:FFe}],[G4,{useClass:NFe}],[Xy,{useFactory:()=>{var t;return this._injector.createInstance(H_,((t=this._config)==null?void 0:t.description)||[])}}],[jy,{useClass:gFe}],[z8],[W8],[j8],[U8],[H8],[F8],[X8],[Y8],[V8],[B8]].forEach(t=>this._injector.add(t))}onReady(){this.initialize()}},fn(Ap,"type",dr.Sheet),Ap);V_=fVe([kp(1,ne(Tn)),kp(2,ne(mn)),kp(3,oe)],V_);var mVe=Object.defineProperty,pVe=(t,e,n)=>e in t?mVe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,k2=(t,e,n)=>(pVe(t,typeof e!="symbol"?e+"":e,n),n);const gVe={sheet:{numfmt:{title:"Number Format",numfmtType:"Format Type",cancel:"Cancel",confirm:"Confirm",general:"General",accounting:"Accounting",text:"Text",number:"Number",currency:"Currency",date:"Date",time:"Time",thousandthPercentile:"Thousands Separator",preview:"Preview",dateTime:"Date Time",decimalLength:"Decimal Places",currencyType:"Currency Type",moreFmt:"More Formats",financialValue:"Financial Value",roundingCurrency:"Currency Rounding",timeDuration:"Duration",currencyDes:"Currency format is used for general monetary values. Accounting format can align decimal points in a column of values.",accountingDes:"Accounting format aligns currency symbols and decimal points in a column of values.",dateType:"Date Type",dateDes:"Date format displays date and time series values as date values.",negType:"Negative Number Type",generalDes:"General format does not contain any specific number formatting.",thousandthPercentileDes:"Thousands separator format is used for general number representation. Currency and accounting formats provide specialized formats for monetary value calculations.",addDecimal:"Increase Decimal Places",subtractDecimal:"Decrease Decimal Places"}}},T5="SHEET_NUMFMT_PLUGIN",j_=t=>{const e=t.filter(i=>i.id===Fo.id).map(i=>i.params),n=t.filter(i=>i.id===Zi.id).map(i=>i.params),r=[];if(e[0]){const i=e.reduce((o,s)=>(o.ranges.push(...s.ranges),o),{ranges:[],unitId:n[0].unitId,subUnitId:n[0].subUnitId});i.ranges=Ta(i.ranges),r.push({id:Fo.id,params:i})}if(n[0]){const i=n.reduce((o,s)=>(Object.keys(s.values).forEach(a=>{const l=s.values[a],u=s.refMap[a];o.values[a]?o.values[a].ranges.push(...l.ranges):(o.values[a]={ranges:l.ranges},o.refMap[a]=u)}),o),{values:{},refMap:{},unitId:n[0].unitId,subUnitId:n[0].subUnitId});Object.keys(i.values).forEach(o=>{const s=i.values[o];s.ranges=Ta(s.ranges)}),r.push({id:Zi.id,params:i})}return r};var vVe=Object.defineProperty,_Ve=Object.getOwnPropertyDescriptor,bVe=(t,e,n,r)=>{for(var i=r>1?void 0:r?_Ve(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&vVe(e,n,i),i},i3=(t,e)=>(n,r)=>e(n,r,t);let G8=class extends je{constructor(t,e,n,r){super(),this._injector=t,this._univerInstanceService=e,this._numfmtService=n,this._autoFillService=r,this._initAutoFill()}_initAutoFill(){const t=()=>({redos:[],undos:[]}),e=(i,o,s)=>{const a=this._univerInstanceService.getCurrentUniverSheetInstance().getUnitId(),l=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),u={startRow:i.row,startColumn:i.col,endColumn:i.col,endRow:i.row},c={startRow:o.row,startColumn:o.col,endColumn:o.col,endRow:o.row},d=[];if(Er.foreach(s,(h,f)=>{const m=pt.getPositionRange({startRow:h,startColumn:f,endColumn:f,endRow:h},u),p=this._numfmtService.getValue(a,l,m.startRow,m.startColumn);if(p){const g=pt.getPositionRange({startRow:h,startColumn:f,endColumn:f,endRow:h},c);d.push({pattern:p.pattern,type:p.type,row:g.startRow,col:g.startColumn})}}),d.length){const h={id:Zi.id,params:Ll(a,l,d)},f=H4(this._injector,h.params);return{redos:[h],undos:f}}return{redos:[],undos:[]}},n=(i,o)=>{const s=[],a=[],l={row:i.startRow,col:i.startColumn};return Y$e(i,o).forEach(u=>{const{undos:c,redos:d}=e(l,u.repeatStartCell,u.relativeRange);s.push(...c),a.push(...d)}),{undos:j_(s),redos:j_(a)}},r={hookName:T5,hook:{[Mn.COPY]:n,[Mn.NO_FORMAT]:t,[Mn.ONLY_FORMAT]:n,[Mn.SERIES]:n}};this.disposeWithMe(this._autoFillService.addHook(r))}};G8=bVe([yt(it.Rendered,G8),i3(0,ne(Tn)),i3(1,ne(oe)),i3(2,ne(eo)),i3(3,ne(A0))],G8);var CVe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yVe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var aU={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(typeof self<"u"?self:CVe,function(){return function(){var n={d:function(W,j){for(var q in j)n.o(j,q)&&!n.o(W,q)&&Object.defineProperty(W,q,{enumerable:!0,get:j[q]})},o:function(W,j){return Object.prototype.hasOwnProperty.call(W,j)}},r={};n.d(r,{default:function(){return Bn}});var i={1078:"af",1052:"sq",1118:"am",5121:"ar_DZ",15361:"ar_BH",3073:"ar_EG",2049:"ar_IQ",11265:"ar_JO",13313:"ar_KW",12289:"ar_LB",4097:"ar_LY",6145:"ar_MA",8193:"ar_OM",16385:"ar_QA",1025:"ar_SA",10241:"ar_SY",7169:"ar_TN",14337:"ar_AE",9217:"ar_YE",1067:"hy",1101:"as",2092:"az_AZ",1068:"az_AZ",1069:"eu",1059:"be",2117:"bn",1093:"bn_IN",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh_CN",3076:"zh_HK",5124:"zh_MO",4100:"zh_SG",1028:"zh_TW",1050:"hr",1029:"cs",1030:"da",1125:"dv",2067:"nl_BE",1043:"nl_NL",1126:"bin",3081:"en_AU",10249:"en_BZ",4105:"en_CA",9225:"en_CB",2057:"en_GB",16393:"en_IN",6153:"en_IE",8201:"en_JM",5129:"en_NZ",13321:"en_PH",7177:"en_ZA",11273:"en_TT",1033:"en_US",12297:"en_ZW",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"fil",1035:"fi",2060:"fr_BE",11276:"fr_CM",3084:"fr_CA",9228:"fr_CG",12300:"fr_CI",1036:"fr_FR",5132:"fr_LU",13324:"fr_ML",6156:"fr_MC",14348:"fr_MA",10252:"fr_SN",4108:"fr_CH",7180:"fr",1122:"fy_NL",2108:"gd_IE",1084:"gd",1110:"gl",1079:"ka",3079:"de_AT",1031:"de_DE",5127:"de_LI",4103:"de_LU",2055:"de_CH",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig_NG",1057:"id",1040:"it_IT",2064:"it_CH",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms_BN",1086:"ms_MY",1100:"ml",1082:"mt",1112:"mni",1153:"mi",1102:"mr",1104:"mn",2128:"mn",1121:"ne",1044:"no_NO",2068:"no_NO",1096:"or",1045:"pl",1046:"pt_BR",2070:"pt_PT",1094:"pa",1047:"rm",2072:"ro_MO",1048:"ro_RO",1049:"ru",2073:"ru_MO",1083:"se",1103:"sa",3098:"sr_SP",2074:"sr_SP",1072:"st",1074:"tn",1113:"sd",1115:"si",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es_AR",16394:"es_BO",13322:"es_CL",9226:"es_CO",5130:"es_CR",7178:"es_DO",12298:"es_EC",17418:"es_SV",4106:"es_GT",18442:"es_HN",2058:"es_MX",19466:"es_NI",6154:"es_PA",15370:"es_PY",10250:"es_PE",20490:"es_PR",1034:"es_ES",14346:"es_UY",8202:"es_VE",1089:"sw",2077:"sv_FI",1053:"sv_SE",1114:"syc",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz_UZ",1091:"uz_UZ",1075:"ve",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"};const o=/^([a-z\d]+)(?:[_-]([a-z\d]+))?(?:\.([a-z\d]+))?(?:@([a-z\d]+))?$/i,s={},a={group:"",decimal:".",positive:"+",negative:"-",percent:"%",exponent:"E",nan:"NaN",infinity:"",ampm:["AM","PM"],mmmm6:["Muharram","Safar","Rabi I","Rabi II","Jumada I","Jumada II","Rajab","Shaban","Ramadan","Shawwal","Dhul-Qidah","Dhul-Hijjah"],mmm6:["Muh.","Saf.","Rab. I","Rab. II","Jum. I","Jum. II","Raj.","Sha.","Ram.","Shaw.","Dhul-Q.","Dhul-H."],mmmm:["January","February","March","April","May","June","July","August","September","October","November","December"],mmm:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dddd:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ddd:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};function l(W){const j=o.exec(W);if(!j)throw new SyntaxError("Malformed locale: ".concat(W));return{lang:j[1]+(j[2]?"_"+j[2]:""),language:j[1],territory:j[2]||"",codeset:j[3]||"",modifier:j[4]||""}}function u(W){if(typeof W=="number")return i[65535&W]||null;const j=parseInt(W,16);return isFinite(j)&&i[65535&j]?i[65535&j]||null:o.test(W)?W:null}function c(W){const j=u(W);let q=null;if(j){const pe=l(j);q=s[pe.lang]||s[pe.language]||null}return q}function d(W){return Object.assign({},a,W)}function h(W,j){const q=typeof j=="object"?j:l(j);return s[q.lang]=d(W),q.language===q.lang||s[q.language]||(s[q.language]=d(W)),s[q.lang]}const f=d({group:","});function m(W,j){if(typeof W!="number")return W;if(W<0)return-m(-W,j);if(j){const q=10**(j||0)||1;return m(W*q,0)/q}return Math.round(W)}f.isDefault=!0,h({group:",",ampm:["",""],mmmm:["","","","","","","","","","","",""],mmm:["1","2","3","4","5","6","7","8","9","10","11","12"],dddd:["","","","","","",""],ddd:["","","","","","",""]},"zh_CN"),h({group:",",nan:"",ampm:["",""],mmmm:["1","2","3","4","5","6","7","8","9","10","11","12"],mmm:["1","2","3","4","5","6","7","8","9","10","11","12"],dddd:["","","","","","",""],ddd:["","","","","","",""]},"zh_TW"),h({group:",",ampm:["",""],mmmm:["1","2","3","4","5","6","7","8","9","10","11","12"],mmm:["1","2","3","4","5","6","7","8","9","10","11","12"],dddd:["","","","","","",""],ddd:["","","","","","",""]},"ja"),h({group:",",ampm:["",""],mmmm:["1","2","3","4","5","6","7","8","9","10","11","12"],mmm:["1","2","3","4","5","6","7","8","9","10","11","12"],dddd:["","","","","","",""],ddd:["","","","","","",""]},"ko"),h({group:",",ampm:["",""],mmmm:["","","","","","","","","","","",""],mmm:["..","..","..","..","..","..","..","..","..","..","..",".."],dddd:["","","","","","",""],ddd:[".",".",".",".",".",".","."]},"th"),h({decimal:",",ampm:["dop.","odp."],mmmm:["ledna","nora","bezna","dubna","kvtna","ervna","ervence","srpna","z","jna","listopadu","prosince"],mmm:["led","no","be","dub","kv","vn","vc","srp","z","j","lis","pro"],dddd:["nedle","pondl","ter","steda","tvrtek","ptek","sobota"],ddd:["ne","po","t","st","t","p","so"]},"cs"),h({group:".",decimal:",",mmmm:["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],mmm:["jan.","feb.","mar.","apr.","maj","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["sndag","mandag","tirsdag","onsdag","torsdag","fredag","lrdag"],ddd:["sn.","man.","tir.","ons.","tor.","fre.","lr."]},"da"),h({group:".",decimal:",",ampm:["a.m.","p.m."],mmmm:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],mmm:["jan.","feb.","mrt.","apr.","mei","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],ddd:["zo","ma","di","wo","do","vr","za"]},"nl"),h({group:","},"en"),h({decimal:",",nan:"epluku",ampm:["ap.","ip."],mmmm:["tammikuuta","helmikuuta","maaliskuuta","huhtikuuta","toukokuuta","keskuuta","heinkuuta","elokuuta","syyskuuta","lokakuuta","marraskuuta","joulukuuta"],mmm:["tammik.","helmik.","maalisk.","huhtik.","toukok.","kesk.","heink.","elok.","syysk.","lokak.","marrask.","jouluk."],dddd:["sunnuntaina","maanantaina","tiistaina","keskiviikkona","torstaina","perjantaina","lauantaina"],ddd:["su","ma","ti","ke","to","pe","la"]},"fi"),h({group:"",decimal:",",mmmm:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"],mmm:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],dddd:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],ddd:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."]},"fr"),h({group:".",decimal:",",mmmm:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],mmm:["Jan.","Feb.","Mrz","Apr.","Mai","Juni","Juli","Aug.","Sept.","Okt.","Nov.","Dez."],dddd:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ddd:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."]},"de"),h({group:".",decimal:",",ampm:["..",".."],mmmm:["","","","","","","","","","","",""],mmm:["","","","","","","","","","","",""],dddd:["","","","","","",""],ddd:["","","","","","",""]},"el"),h({decimal:",",ampm:["de.","du."],mmmm:["janur","februr","mrcius","prilis","mjus","jnius","jlius","augusztus","szeptember","oktber","november","december"],mmm:["jan.","febr.","mrc.","pr.","mj.","jn.","jl.","aug.","szept.","okt.","nov.","dec."],dddd:["vasrnap","htf","kedd","szerda","cstrtk","pntek","szombat"],ddd:["V","H","K","Sze","Cs","P","Szo"]},"hu"),h({group:".",decimal:",",ampm:["f.h.","e.h."],mmmm:["janar","febrar","mars","aprl","ma","jn","jl","gst","september","oktber","nvember","desember"],mmm:["jan.","feb.","mar.","apr.","ma","jn.","jl.","g.","sep.","okt.","nv.","des."],dddd:["sunnudagur","mnudagur","rijudagur","mivikudagur","fimmtudagur","fstudagur","laugardagur"],ddd:["sun.","mn.","ri.","mi.","fim.","fs.","lau."]},"is"),h({group:".",decimal:",",mmmm:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],mmm:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],dddd:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],ddd:["Min","Sen","Sel","Rab","Kam","Jum","Sab"]},"id"),h({group:".",decimal:",",mmmm:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],mmm:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],dddd:["domenica","luned","marted","mercoled","gioved","venerd","sabato"],ddd:["dom","lun","mar","mer","gio","ven","sab"]},"it"),h({decimal:",",ampm:["a.m.","p.m."],mmmm:["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],mmm:["jan.","feb.","mar.","apr.","mai","jun.","jul.","aug.","sep.","okt.","nov.","des."],dddd:["sndag","mandag","tirsdag","onsdag","torsdag","fredag","lrdag"],ddd:["sn.","man.","tir.","ons.","tor.","fre.","lr."]},"nb"),h({decimal:",",mmmm:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","wrzenia","padziernika","listopada","grudnia"],mmm:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa","lis","gru"],dddd:["niedziela","poniedziaek","wtorek","roda","czwartek","pitek","sobota"],ddd:["niedz.","pon.","wt.","r.","czw.","pt.","sob."]},"pl"),h({group:".",decimal:",",mmmm:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],mmm:["jan.","fev.","mar.","abr.","mai.","jun.","jul.","ago.","set.","out.","nov.","dez."],dddd:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"],ddd:["dom.","seg.","ter.","qua.","qui.","sex.","sb."]},"pt"),h({decimal:",",nan:"",mmmm:["","","","","","","","","","","",""],mmm:[".",".",".",".","",".",".",".",".",".",".","."],dddd:["","","","","","",""],ddd:["","","","","","",""]},"ru"),h({decimal:",",mmmm:["janura","februra","marca","aprla","mja","jna","jla","augusta","septembra","oktbra","novembra","decembra"],mmm:["jan","feb","mar","apr","mj","jn","jl","aug","sep","okt","nov","dec"],dddd:["nedea","pondelok","utorok","streda","tvrtok","piatok","sobota"],ddd:["ne","po","ut","st","t","pi","so"]},"sk"),h({group:".",decimal:",",ampm:["a.m.","p.m."],mmmm:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],mmm:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],dddd:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],ddd:["dom.","lun.","mar.","mi.","jue.","vie.","sb."]},"es"),h({decimal:",",ampm:["fm","em"],mmmm:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],mmm:["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],dddd:["sndag","mndag","tisdag","onsdag","torsdag","fredag","lrdag"],ddd:["sn","mn","tis","ons","tors","fre","lr"]},"sv"),h({group:".",decimal:",",ampm:["","S"],mmmm:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],mmm:["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],dddd:["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi"],ddd:["Paz","Pzt","Sal","ar","Per","Cum","Cmt"]},"tr");function p(W,j,q){const pe=W<0?-1:1,Ae=10**(j||2),We=10**(q||2);let Re,Te,G=Math.abs(W),be=0,xe=0,ye=0,st=1;if((W=G)%1==0)Te=[W*pe,1];else if(W<1e-19)Te=[pe,1e19];else if(W>1e19)Te=[1e19*pe,1];else{do if(G=1/(G-Math.floor(G)),Re=st,st=st*Math.floor(G)+be,be=Re,xe=ye,ye=Math.floor(W*st+.5),ye>=Ae||st>=We)return[pe*xe,be];while(Math.abs(W-ye/st)>=1e-10&&G!==Math.floor(G));Te=[pe*ye,st]}return Te}const g={overflow:"######",dateErrorThrows:!1,dateErrorNumber:!0,dateSpanLarge:!0,leap1900:!0,nbsp:!0,throws:!0,invalid:"######",locale:"",ignoreTimezone:!1},v=Object.assign({},g);function _(W){if(W===null&&(W=g),W){for(const j in W)if(j in g){const q=W[j];v[j]=q??g[j]}}return{...v}}const C={"#":"",0:"0","?":""},y={"@":"text","-":"minus","+":"plus"},S=["#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#800","#080","#008","#880","#808","#088","#CCC","#888","#99F","#936","#FFC","#CFF","#606","#F88","#06C","#CCF","#008","#F0F","#FF0","#0FF","#808","#800","#088","#00F","#0CF","#CFF","#CFC","#FF9","#9CF","#F9C","#C9F","#FC9","#36F","#3CC","#9C0","#FC0"],E=["","$","","","","","","","","","","","","","","","","","","","","","","","","",""],w=new RegExp("["+E.join("")+"]");function R(W,j,q){return j[q+"_max"]=W.length,j[q+"_min"]=W.replace(/#/g,"").length,j}const D={};function I(W){if(!(W in D)){const j=[],q=W.replace(/^[#,]+/,"").replace(/[1-9]\d*/g,pe=>"?".repeat(pe.length));for(let pe=0;pe<q.length;pe++){const Ae=q.charAt(pe);j[pe]=Ae in C?C[Ae]:Ae}D[W]=j.join("")}return D[W]}function k(W,j){typeof W=="string"&&(W={type:"string",value:W=W.replace(/ /g,C["?"])}),j.push(W)}function O(W){const j=[],q={scale:1,percent:!1,text:!1,date:0,date_eval:!1,date_system:1,sec_decimals:0,general:!1,clock:24,int_pattern:[],frac_pattern:[],man_pattern:[],den_pattern:[],num_pattern:[],tokens:j};let pe=W+"",Ae="int",We=!1,Re=null;const Te=[];let G,be,xe=!1;for(;pe&&!We;){if(G=/^General/i.exec(pe))q.general=!0,k({type:"general"},j);else if(Ae==="int"&&(G=/^[#?0]+(?:,[#?0]+)*/.exec(pe))||Ae==="den"&&(G=/^[#?\d]+/.exec(pe))||(G=/^[#?0]+/.exec(pe)))q[Ae+"_pattern"].push(G[0]),Re={type:Ae,num:G[0]},k(Re,j);else if((G=/^\//.exec(pe))&&q[Ae+"_pattern"].length){if(!Re)throw new SyntaxError("Missing a numerator in pattern ".concat(W));q.fractions=!0,q.num_pattern.push(q[Ae+"_pattern"].pop()),Re.type="num",Ae="den",k({type:"div"},j)}else if(G=/^,+/.exec(pe)){const de=pe.charAt(1)in C;be.slice(-1)in C&&(G[0].length>1||!de)?q.scale=.001**G[0].length:q.dec_fractions||k(G[0],j)}else{if(G=/^;/.exec(pe)){We=!0;break}if(G=/^[@+-]/.exec(pe))G[0]==="@"&&(q.text=!0),k({type:y[G[0]]},j);else if(G=/^(?:\[(h+|m+|s+)\])/i.exec(pe)){const de=G[1].toLowerCase(),Le=de[0],Ve={type:"",size:0,date:1,raw:G[0],pad:de.length};Le==="h"?(Ve.size=16,Ve.type="hour-elap"):Le==="m"?(Ve.size=32,Ve.type="min-elap"):(Ve.size=64,Ve.type="sec-elap"),q.date=q.date|Ve.size,Te.push(Ve),k(Ve,j)}else if(G=/^(?:B2)/i.exec(pe))xe||(q.date_system=6);else if(G=/^(?:B1)/i.exec(pe))xe||(q.date_system=1);else if(G=/^(?:([hHmMsSyYbBdDegG])\1*)/.exec(pe)){const de={type:"",size:0,date:1,raw:G[0]},Le=G[0].toLowerCase(),Ve=Le[0];if(Le==="y"||Le==="yy")de.size=2,de.type="year-short";else if(Ve==="y"||Ve==="e")de.size=2,de.type="year";else if(Le==="b"||Le==="bb")de.size=2,de.type="b-year-short";else if(Ve==="b")de.size=2,de.type="b-year";else if(Le==="d"||Le==="dd")de.size=8,de.type="day",de.pad=/dd/.test(Le);else if(Le==="ddd")de.size=8,de.type="weekday-short";else if(Ve==="d")de.size=8,de.type="weekday";else if(Ve==="h")de.size=16,de.type="hour",de.pad=/hh/i.test(Le);else if(Ve==="m"){Le.length===3?(de.size=4,de.type="monthname-short"):Le.length===5?(de.size=4,de.type="monthname-single"):Le.length>=4&&(de.size=4,de.type="monthname");const Ze=Te[Te.length-1];!de.type&&Ze&&!Ze.used&&80&Ze.size&&(Ze.used=!0,de.size=32,de.type="min",de.pad=/mm/.test(Le)),de.type||(de.size=4,de.type="month",de.pad=/mm/.test(Le),de.indeterminate=!0)}else if(Ve==="s"){de.size=64,de.type="sec",de.pad=/ss/.test(Le);const Ze=Te[Te.length-1];Ze&&32&Ze.size?de.used=!0:Ze&&Ze.indeterminate&&(delete Ze.indeterminate,Ze.size=32,Ze.type="min",de.used=!0)}q.date=q.date|de.size,q.date_eval=!0,Te.push(de),k(de,j)}else if(G=/^(?:AM\/PM|am\/pm|A\/P)/.exec(pe))q.clock=12,q.date=16|q.date,q.date_eval=!0,k({type:"am",short:G[0]==="A/P"},j);else if(q.date&&(G=/^\.0{1,3}/i.exec(pe))){const de=G[0].length-1,Le=[64,128,256,512][de];q.date=q.date|Le,q.date_eval=!0,q.sec_decimals=Math.max(q.sec_decimals,de),k({type:"subsec",size:Le,decimals:de,date:1,raw:G[0]},j)}else if((G=/^\\(.)/.exec(pe))||(G=/^"([^"]*?)"/.exec(pe)))k(G[1],j);else if(G=/^\[(<[=>]?|>=?|=)\s*(-?[.\d]+)\]/.exec(pe))q.condition=[G[1],parseFloat(G[2],10)];else if(G=/^\[\$([^\]]+)\]/.exec(pe)){const de=G[1].split("-"),Le=de.length<2?"":de[de.length-1],Ve=de[0];Ve&&k(Ve,j);const Ze=u(Le);Ze&&(q.locale=Ze);const Dt=parseInt(Le,16);isFinite(Dt)&&16711680&Dt&&(Dt>>16&255)===6&&(q.date_system=6),xe=!0}else if(G=/^\[(black|blue|cyan|green|magenta|red|white|yellow|color\s*(\d+))\]/i.exec(pe))q.color=G[2]?S[parseInt(G[2],10)]||"#000":G[1].toLowerCase();else if(!(G=/^\[(DBNum1|ENG|HIJ|JPN|TWN)\]/i.exec(pe))){if(G=/^%/.exec(pe))q.scale=100,q.percent=!0,k("%",j);else if(G=/^_(\\.|.)/.exec(pe))k(" ",j);else if(G=/^\./.exec(pe))k({type:"point",value:G[0]},j),q.dec_fractions=!0,Ae="frac";else if(G=/^[Ee]([+-]?|(?=[0#?]))/.exec(pe))q.exponential=!0,q.exp_plus=G[1]==="+",Ae="man",k({type:"exp",plus:G[1]==="+"},j);else if(!(G=/^\*(\\.|.)/.exec(pe))){if(G=/^[BENn[]/.exec(pe))throw new SyntaxError("Unexpected char ".concat(pe.charAt(0)," in pattern ").concat(W));pe[0]==="("&&(q.parens=!0),G=[pe[0]],k(G[0],j)}}}be=G[0],pe=pe.slice(G?G[0].length:1)}if(q.pattern=W.slice(0,W.length-pe.length),/^((?:\[[^\]]+\])+)(;|$)/.test(q.pattern)&&!/^\[(?:h+|m+|s+)\]/.test(q.pattern)&&k({type:"text"},j),q.fractions&&q.dec_fractions||q.fractions&&q.exponential)throw new SyntaxError("Invalid pattern: ".concat(q.pattern));const ye=q.int_pattern.join("");if(q.grouping=ye.indexOf(",")>=0,q.grouping){const de=ye.split(","),Le=de.length;Le===2?(q.group_pri=de[1].length,q.group_sec=q.group_pri):Le>2&&(q.group_pri=de[Le-1].length,q.group_sec=de[Le-2].length)}else q.group_pri=0,q.group_sec=0;R(ye.replace(/[,]/g,""),q,"int"),R(q.frac_pattern.join(""),q,"frac"),R(q.man_pattern.join(""),q,"man");let st=q.num_pattern.join(""),Ge=q.den_pattern.join("");const lt=/\?/.test(Ge)||/\?/.test(st);return Ge=Ge.replace(/\d/g,lt?"?":"#"),lt&&(Ge=Ge.replace(/#$/g,"?")),R(st,q,"num"),R(Ge,q,"den"),lt&&(st=st.replace(/#$/g,"?")),q.int_padding=I(q.int_pattern.join("")),q.man_padding=I(q.man_pattern.join("")),q.num_padding=I(st),q.den_padding=I(Ge),q.den_pattern.length&&(q.denominator=parseInt(q.den_pattern.join("").replace(/\D/g,""),10)),q.integer=!!q.int_pattern.join("").length,q.fractions&&j.forEach((de,Le)=>{const Ve=j[Le+1];de.type==="string"&&Ve&&(Ve.type==="num"?de.rule="num+int":Ve.type==="div"?de.rule="num":Ve.type==="den"&&(de.rule="den"))}),q}const $=W=>{const j=W.condition;j&&j[1]<0&&(j[0]==="<"||j[0]==="<="||j[0]==="=")||W.tokens.unshift({type:"minus",volatile:!0})};function N(W){const j=[];let q,pe=!1,Ae=null,We=W,Re=0,Te=!1,G=0,be=0;do{if(Te=O(We),(Te.date||Te.general)&&(Te.int_pattern.length||Te.frac_pattern.length||Te.scale!==1||Te.text))throw new Error("Illegal format");if(Te.condition&&(be++,pe=!0),Te.text){if(Ae)throw new Error("Unexpected partition");Ae=Te}Te.locale&&(q=u(Te.locale)),j.push(Te),Re=We.charAt(Te.pattern.length)===";"?1:0,We=We.slice(Te.pattern.length+Re),G++}while(Re&&G<4&&be<3);if(Re)throw new Error("Unexpected partition");if(be>2)throw new Error("Unexpected condition");const xe=j[3];if(xe&&(xe.int_pattern.length||xe.frac_pattern.length||xe.date))throw new Error("Unexpected partition");if(pe){const ye=j.length;if(ye===1&&(j[1]=O("General"),j[1].generated=!0),ye<3){const st=j[0],Ge=j[1];if($(st),Ge.condition)$(Ge);else{const lt=st.condition;(lt[0]==="="||lt[1]>=0&&(lt[0]===">"||lt[0]===">="))&&Ge.tokens.unshift({type:"minus",volatile:!0})}}else j.forEach($)}else{if(j.length<4&&Ae)for(let ye=0,st=j.length;ye<st;ye++)j[ye]===Ae&&j.splice(ye,1);if(j.length<1&&Ae&&(j[0]=O("General"),j[0].generated=!0),j.length<2){const ye=O(j[0].pattern);ye.tokens.unshift({type:"minus",volatile:!0}),ye.generated=!0,j.push(ye)}if(j.length<3){const ye=O(j[0].pattern);ye.generated=!0,j.push(ye)}if(j.length<4)if(Ae)j.push(Ae);else{const ye=O("@");ye.generated=!0,j.push(ye)}j[0].condition=[">",0],j[1].condition=["<",0],j[2].condition=null}return{pattern:W,partitions:j,locale:q}}const H=Math.floor;function X(W){if((!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&W>=0){if(W===0)return[1900,1,0];if(W===60)return[1900,2,29];if(W<60)return[1900,W<32?1:2,(W-1)%31+1]}let j=W+68569+2415019;const q=H(4*j/146097);j-=H((146097*q+3)/4);const pe=H(4e3*(j+1)/1461001);j=j-H(1461*pe/4)+31;const Ae=H(80*j/2447),We=j-H(2447*Ae/80);j=H(Ae/11);const Re=Ae+2-12*j;return[0|100*(q-49)+pe+j,0|Re,0|We]}function te(W){return X(W+1462)}function z(W){if(W===60)throw new Error("#VALUE!");if(W<=1)return[1317,8,29];if(W<60)return[1317,W<32?9:10,1+(W-2)%30];const j=10631/30,q=.1335;let pe=W+466935;const Ae=H(pe/10631);pe-=10631*Ae;const We=H((pe-q)/j);pe-=H(We*j+q);const Re=H((pe+28.5001)/29.5);return Re===13?[30*Ae+We,12,30]:[30*Ae+We,Re,pe-H(29.5001*Re-29)]}function A(W){let j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,q=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];const pe=H(W);return j===6?z(pe):j===-1?te(pe):X(pe,q)}const T=Math.floor,P=86400;function K(W,j){let q=null;if(Array.isArray(W)){const[pe,Ae,We,Re,Te,G]=W;q=Date.UTC(pe,Ae==null?0:Ae-1,We??1,Re||0,Te||0,G||0)}else if(W instanceof Date&&(q=1*W,!j||!j.ignoreTimezone)){const pe=new Date;pe.setUTCFullYear(W.getFullYear(),W.getMonth(),W.getDate()),pe.setUTCHours(W.getHours(),W.getMinutes(),W.getSeconds(),W.getMilliseconds()),q=1*pe}if(q!=null&&isFinite(q)){const pe=q/864e5;return pe-(pe<=-25509?-25568:-25569)}return W}function ee(W,j){let q=0|W;const pe=P*(W-q);let Ae=T(pe);pe-Ae>.9999&&(Ae+=1,Ae===P&&(Ae=0,q+=1));const We=Ae<0?P+Ae:Ae,[Re,Te,G]=A(W,0,j&&j.leap1900),be=T(We/60/60)%60,xe=T(We/60)%60,ye=T(We)%60;if(j&&j.nativeDate){const st=new Date(0);return st.setUTCFullYear(Re,Te-1,G),st.setUTCHours(be,xe,ye),st}return[Re,Te,G,be,xe,ye]}function ue(W){return!!(W[0]&&W[0].percent||W[1]&&W[1].percent||W[2]&&W[2].percent||W[3]&&W[3].percent)}function fe(W){return!!(W[0]&&W[0].date||W[1]&&W[1].date||W[2]&&W[2].date||W[3]&&W[3].date)}function Ee(W){const[j,q,pe,Ae]=W;return!(j&&!j.generated||q&&!q.generated||pe&&!pe.generated||!Ae||!Ae.text||Ae.generated)}const Q={text:15,datetime:10.8,date:10.8,time:10.8,percent:10.6,currency:10.4,grouped:10.2,scientific:6,number:4,fraction:2,general:0,error:0},re=[["DMY",1],["DM",2],["MY",3],["MDY",4],["MD",5],["hmsa",6],["hma",7],["hms",8],["hm",9]],Se={total:1,sign:0,period:0,int:1,frac:0},_e=(W,j)=>W.replace(/\./,j.decimal);function He(W,j,q,pe){const Ae=0|q;if(typeof q=="string")W.push(q);else if(q===Ae)W.push(Math.abs(Ae));else{const We=Math.abs(q);let Re=We?Math.floor(Math.log10(We)):0,Te=Re<0?We*10**-Re:We/10**Re;Te===10&&(Te=1,Re++);const G=function(xe){let ye=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];const st=Math.abs(xe);if(!st)return Se;const Ge=ye&&xe<0?1:0,lt=Math.floor(st),de=Math.floor(Math.log10(st)+1);let Le=0,Ve=0;if(lt!==st){Le=1;const Ze=String(m(de<0?st*10**-de:st/10**de,15));let Dt=Ze.length,Mt=!0,pn=0;for(;pn<=Ze.length;){if(Ze[pn]==="."){Dt--;break}Ze[pn]==="0"&&Mt?Dt--:Mt=!1,pn++}Ve=Dt-de,Ve<0&&(Ve=0,Le=0)}return{total:Ge+Math.max(de,1)+Le+Ve,digits:Math.max(de,0)+Ve,sign:Ge,period:Le,int:Math.max(de,1),frac:Ve}}(We),be=()=>{const xe=Math.abs(Re);let ye;ye=Te===1?Te:m(Te,5),W.push(_e(ye+"",pe),pe.exponent,Re<0?pe.negative:pe.positive,xe<10?"0":"",xe)};if(Re>=-4&&Re<=-1){const xe=We.toPrecision(10+Re).replace(/\.?0+$/,"");W.push(_e(xe,pe))}else if(Re===10){const xe=We.toFixed(10).slice(0,12).replace(/\.$/,"");W.push(_e(xe,pe))}else if(Math.abs(Re)<=9)if(G.total<=11){const xe=m(We,9).toFixed(G.frac);W.push(_e(xe,pe))}else Re===9?W.push(Math.floor(We)):Re>=0&&Re<9?W.push(m(We,9-Re)):be();else G.total>=12?be():Math.floor(We)===We?W.push(Math.floor(We)):W.push(_e(m(We,9).toFixed(G.frac),pe))}return W}const Ne=86400,we={int:"integer",frac:"fraction",man:"mantissa",num:"numerator",den:"denominator"},Me=function(W){let j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const q=Math.floor(Math.log10(W));return j>1?Math.floor(q/j)*j:q};function mt(W,j,q,pe){let Ae="",We="",Re="",Te="",G="",be=0,xe=0|W,ye=0,st=0,Ge=1,lt=0,de=0,Le=0,Ve=0,Ze=0,Dt=0;const Mt=pe||f;if(!j.text&&isFinite(j.scale)&&j.scale!==1&&(W=function(zt){if(zt===0)return zt;const Ke=Math.ceil(Math.log10(zt<0?-zt:zt)),$e=10**(16-Math.floor(Ke));return Math.round(zt*$e)/$e}(W*j.scale)),j.exponential){let zt=Math.abs(W);if(zt){const Ke=10**-Me(zt,j.int_max),$e=m(zt*Ke,j.frac_max)/Ke;be=Me($e,j.int_max)}zt/=10**be,W=W<0?-zt:zt,Ae+=Math.abs(be)}if(j.integer){const zt=Math.abs(m(W,j.fractions?1:j.frac_max));G+=zt<1?"":Math.floor(zt)}if(j.grouping){let zt="",Ke=G.length;for(Ke>j.group_pri&&(Ke-=j.group_pri,zt=Mt.group+G.slice(Ke,Ke+j.group_pri)+zt);Ke>j.group_sec;)Ke-=j.group_sec,zt=Mt.group+G.slice(Ke,Ke+j.group_sec)+zt;G=Ke?G.slice(0,Ke)+zt:zt}j.dec_fractions&&(Te=String(m(W,j.frac_max)).split(".")[1]||"");let pn=!1;if(j.fractions){const zt=Math.abs(j.integer?W%1:W);if(zt)if(pn=!0,isFinite(j.denominator))Re+=j.denominator,We+=m(zt*j.denominator),We==="0"&&(We="",Re="",pn=!1,G||(G="0"));else{const Ke=p(zt,j.integer?j.num_max:1/0,j.den_max);We+=Ke[0],Re+=Ke[1],j.integer&&We==="0"&&(G||(G="0"),We="",Re="",pn=!1)}}if(j.date){xe=Math.trunc(W);const zt=Ne*(W-xe);if(ye=Math.floor(zt),Dt=zt-ye,Math.abs(Dt)<1e-6?Dt=0:Dt>.9999&&(Dt=0,ye+=1,ye===Ne&&(ye=0,xe+=1)),Dt){const Ke=512&j.date||256&j.date||128&j.date;(Ke===512&&Dt>.9995||Ke===256&&Dt>.995||Ke===128&&Dt>.95||!Ke&&Dt>=.5)&&(ye++,Dt=0)}if(xe||j.date_system){const Ke=A(W,j.date_system,q.leap1900);st=Ke[0],Ge=Ke[1],lt=Ke[2]}if(ye){const Ke=ye<0?Ne+ye:ye;Ze=Math.floor(Ke)%60,Ve=Math.floor(Ke/60)%60,Le=Math.floor(Ke/60/60)%60}if(de=(6+xe)%7,j.date_eval&&(Yn=W,Hn=xe+ye/Ne,q.dateSpanLarge?Yn<-694324||Hn>=35830291:Yn<0||Hn>=2958466)){if(q.dateErrorThrows)throw new Error("Date out of bounds");return q.dateErrorNumber?He(W<0?[Mt.negative]:[],0,W,Mt).join(""):q.overflow}}var Yn,Hn;if(j.int_padding&&(G=j.int_padding.length===1?G||j.int_padding:j.int_padding.substring(0,j.int_padding.length-G.length)+G),j.num_padding&&(We=j.num_padding.length===1?We||j.num_padding:j.num_padding.substring(0,j.num_padding.length-We.length)+We),j.den_padding&&(Re=j.den_padding.length===1?Re||j.den_padding:Re+j.den_padding.slice(Re.length)),j.man_padding){const zt=j.exp_plus?"+":"";Ae=j.man_padding.length===1?(be<0?"-":zt)+(Ae||j.man_padding):(be<0?"-":zt)+j.man_padding.slice(0,j.man_padding.length-Ae.length)+Ae}const ht=[];let Dn=0;const Gn={int:0,frac:0,man:0,num:0,den:0};for(let zt=0,Ke=j.tokens.length;zt<Ke;zt++){const $e=j.tokens[zt],hn=$e.num?$e.num.length:0;if($e.type==="string")$e.rule?$e.rule==="num"?pn?ht.push($e.value):(j.num_min>0||j.den_min>0)&&ht.push($e.value.replace(/./g,C["?"])):$e.rule==="num+int"?pn&&G?ht.push($e.value):j.den_min>0&&(G||j.num_min)&&ht.push($e.value.replace(/./g,C["?"])):$e.rule==="den"&&(pn?ht.push($e.value):(j.den_min>0||j.den_min>0)&&ht.push($e.value.replace(/./g,C["?"]))):ht.push($e.value);else if($e.type==="error")ht.push(q.invalid);else if($e.type==="point")ht.push(j.date?$e.value:Mt.decimal);else if($e.type==="general")He(ht,0,W,Mt);else if($e.type==="exp")ht.push(Mt.exponent);else if($e.type==="minus")$e.volatile&&j.date||$e.volatile&&(W>=0||typeof W!="number")||($e.volatile&&!j.fractions&&(j.integer||j.dec_fractions)?(W<0&&G&&G!=="0"||Te)&&ht.push(Mt.negative):ht.push(Mt.negative));else if($e.type==="plus")ht.push(Mt.positive);else if($e.type==="text")ht.push(W);else if($e.type==="div")pn?ht.push("/"):j.num_min>0||j.den_min>0?ht.push(C["?"]):ht.push(C["#"]);else if($e.type==="int")if(j.int_pattern.length===1)ht.push(G);else{const an=Dn?j.int_pattern.join("").length-Gn.int:1/0,Qn=Dn===j.int_pattern.length-1?0:j.int_pattern.join("").length-(Gn.int+$e.num.length);ht.push(G.substring(G.length-an,G.length-Qn)),Dn++,Gn.int+=$e.num.length}else if($e.type==="frac"){const an=Gn.frac;for(let Qn=0;Qn<hn;Qn++)ht.push(Te[Qn+an]||C[$e.num[Qn]]);Gn.frac+=hn}else if($e.type in we)j[$e.type+"_pattern"].length===1?($e.type==="int"&&ht.push(G),$e.type==="frac"&&ht.push(Te),$e.type==="man"&&ht.push(Ae),$e.type==="num"&&ht.push(We),$e.type==="den"&&ht.push(Re)):(ht.push(we[$e.type].slice(Gn[$e.type],Gn[$e.type]+hn)),Gn[$e.type]+=hn);else if($e.type==="year")st<0&&ht.push(Mt.negative),ht.push(String(Math.abs(st)).padStart(4,"0"));else if($e.type==="year-short"){const an=st%100;ht.push(an<10?"0":"",an)}else if($e.type==="month")ht.push($e.pad&&Ge<10?"0":"",Ge);else if($e.type==="monthname-single")j.date_system===6?ht.push(Mt.mmmm6[Ge-1].charAt(0)):ht.push(Mt.mmmm[Ge-1].charAt(0));else if($e.type==="monthname-short")j.date_system===6?ht.push(Mt.mmm6[Ge-1]):ht.push(Mt.mmm[Ge-1]);else if($e.type==="monthname")j.date_system===6?ht.push(Mt.mmmm6[Ge-1]):ht.push(Mt.mmmm[Ge-1]);else if($e.type==="weekday-short")ht.push(Mt.ddd[de]);else if($e.type==="weekday")ht.push(Mt.dddd[de]);else if($e.type==="day")ht.push($e.pad&&lt<10?"0":"",lt);else if($e.type==="hour"){const an=Le%j.clock||(j.clock<24?j.clock:0);ht.push($e.pad&&an<10?"0":"",an)}else if($e.type==="min")ht.push($e.pad&&Ve<10?"0":"",Ve);else if($e.type==="sec")ht.push($e.pad&&Ze<10?"0":"",Ze);else if($e.type==="subsec"){ht.push(Mt.decimal);const an=Dt.toFixed(j.sec_decimals);ht.push(an.slice(2,2+$e.decimals))}else if($e.type==="am"){const an=Le<12?0:1;$e.short&&!pe?ht.push("AP"[an]):ht.push(Mt.ampm[an])}else if($e.type==="hour-elap"){W<0&&ht.push(Mt.negative);const an=24*xe+Math.floor(Math.abs(ye)/3600);ht.push(String(Math.abs(an)).padStart($e.pad,"0"))}else if($e.type==="min-elap"){W<0&&ht.push(Mt.negative);const an=1440*xe+Math.floor(Math.abs(ye)/60);ht.push(String(Math.abs(an)).padStart($e.pad,"0"))}else if($e.type==="sec-elap"){W<0&&ht.push(Mt.negative);const an=xe*Ne+Math.abs(ye);ht.push(String(Math.abs(an)).padStart($e.pad,"0"))}else if($e.type==="b-year")ht.push(st+543);else if($e.type==="b-year-short"){const an=(st+543)%100;ht.push(an<10?"0":"",an)}}return q.nbsp?ht.join(""):ht.join("").replace(/\u00a0/g," ")}function vt(W,j){for(let q=0;q<3;q++){const pe=j[q];if(pe){let Ae;if(pe.condition){const We=pe.condition[0],Re=pe.condition[1];We==="="?Ae=W===Re:We===">"?Ae=W>Re:We==="<"?Ae=W<Re:We===">="?Ae=W>=Re:We==="<="?Ae=W<=Re:We==="<>"&&(Ae=W!==Re)}else Ae=!0;if(Ae)return pe}}}const ft=O("@"),et="black",ve={};function Pe(W,j){if(W){const q=W[0];j[q]=j[q]||{},Pe(W.slice(1),j[q])}else j.$=!0}["d-F-y","d-F-Y","d-M-y","d-M-Y","F-d-y","F-d-Y","F-j-y","F-j-Y","j-F-y","j-F-Y","j-M-y","j-M-Y","M-d-y","M-d-Y","M-j-y","M-j-Y","m-d-y","m-d-Y","m-j-y","m-j-Y","n-d-y","n-d-Y","n-j-y","n-j-Y","y-F-d","y-F-j","y-M-d","y-M-j","Y-F-d","Y-F-j","Y-M-d","Y-m-d","Y-M-j","Y-m-j","Y-n-d","Y-n-j","j-F","j-M","d-F","d-M","n-d","n-j","n-Y","m-d","m-j","m-Y","M-Y","M-y","F-y","F-Y","Y-M","Y-n","Y-m","Y-F","Y-M"].forEach(W=>{Pe(W,ve),Pe(W+" x",ve),Pe(W+" l",ve),Pe(W+" l x",ve),Pe("l "+W,ve),Pe("l "+W+" x",ve),Pe(W+" D",ve),Pe(W+" D x",ve),Pe("D "+W,ve),Pe("D "+W+" x",ve)});const Ye={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12},bt={january:1,february:2,march:3,april:4,june:6,july:7,august:8,september:9,october:10,november:11,december:12},Jt={sunday:"l",monday:"l",tuesday:"l",wednesday:"l",thursday:"l",friday:"l",saturday:"l",sun:"D",mon:"D",tue:"D",wed:"D",thu:"D",fri:"D",sat:"D"},Ht=new Date().getUTCFullYear();function Zt(W){const j=new RegExp("^([\\s+%"+E.join("")+"(-]*)(((?:(?:\\d[\\d,]*)(?:\\.\\d*)?|(?:\\.\\d+)))([eE][+-]?\\d+)?)([\\s%"+E.join("")+")]*)$").exec(W);if(j){const[,q,pe,Ae,We,Re]=j;let Te=1,G="",be=!1,xe=!1,ye=!1,st=!1,Ge=!1,lt=null,de=!1,Le=parseFloat(pe.replace(/,/g,""));if(!isFinite(Le))return null;for(let Ze=0;Ze<q.length;Ze++){const Dt=q[Ze];if(Dt==="-"){if(be||xe)return null;be=!0,Te=-1}else if(w.test(Dt)){if(Ge)return null;Ge=!0,lt=Dt}else if(Dt==="("){if(xe||be)return null;xe=!0,Te=-1}else if(Dt==="%"){if(st)return null;st=!0}}for(let Ze=0;Ze<Re.length;Ze++){const Dt=Re[Ze];if(w.test(Dt)){if(Ge)return null;Ge=!0,lt=Dt,de=!0}else if(Dt===")"){if(ye||!xe)return null;ye=!0}else if(Dt==="%"){if(st)return null;st=!0}}if(We){if(st||Ge)return null;G="0.00E+00"}else if(st){if(Ge)return null;G=Ae.includes(".")?"0.00%":"0%",Le*=.01}else if(Ge){const Ze=Ae.includes(".")?"#,##0.00":"#,##0";G=de?Ze+lt:lt+Ze}else Ae.includes(",")&&(G=Ae.includes(".")?"#,##0.00":"#,##0");const Ve={v:Le*Te};return G&&(Ve.z=G),Ve}}const kt=(W,j,q)=>{const pe=q.path||"",Ae=Object.keys(j);for(let We=0;We<Ae.length;We++){let Re;const Te=Ae[We];if(j[Te]){if(Te==="$"||Te==="")W||(Re=q);else if(Te==="-"){const G=/^(\s*([./-]|,\s)\s*|\s+)/.exec(W);if(G){const be=G[1]==="-"||G[1]==="/"||G[1]==="."?G[1]:" ";if(!q.sep||q.sep===be){const xe=G[0].replace(/\s+/g," ");Re=kt(W.slice(G[0].length),j[Te],{...q,sep:be,path:pe+xe})}}}else if(Te===" "){const G=/^[,.]?\s+/.exec(W);if(G){const be=G[0].replace(/\s+/g," ");Re=kt(W.slice(G[0].length),j[Te],{...q,path:pe+be})}}else if(Te==="j"||Te==="d"){const G=/^(0?[1-9]|1\d|2\d|3[01])\b/.exec(W);G&&(Re=kt(W.slice(G[0].length),j[Te],{...q,day:G[0],path:pe+Te}))}else if(Te==="n"||Te==="m"){const G=/^(0?[1-9]|1[012])\b/.exec(W);G&&(Re=kt(W.slice(G[0].length),j[Te],{...q,month:+G[0],_mon:G[0],path:pe+Te}))}else if(Te==="F"||Te==="M"){const G=/^([a-z]{3,9})\b/i.exec(W),be=G&&(Te==="F"?bt:Ye)[G[0].toLowerCase()];be&&(Re=kt(W.slice(G[0].length),j[Te],{...q,month:be,_mon:G[0],path:pe+Te}))}else if(Te==="l"||Te==="D"){const G=/^([a-z]{3,9})\b/i.exec(W);(G&&Jt[G[0].toLowerCase()])===Te&&(Re=kt(W.slice(G[0].length),j[Te],{...q,path:pe+Te}))}else if(Te==="y"){const G=/^\d\d\b/.exec(W);if(G){const be=+G[0]>=30?+G[0]+1900:+G[0]+2e3;Re=kt(W.slice(G[0].length),j[Te],{...q,year:be,path:pe+Te})}}else if(Te==="Y"){const G=/^\d\d\d\d\b/.exec(W);G&&(Re=kt(W.slice(G[0].length),j[Te],{...q,year:+G[0],path:pe+Te}))}else{if(Te!=="x")throw new Error('Unknown date token "'.concat(Te,'"'));{const G=vn(W);G&&(Re=kt("",j[Te],{...q,time:G.v,tf:G.z,path:pe+Te}))}}if(Re)return Re}}};function gn(W,j){const q=kt(W.trim(),ve,{path:""});if(q){var pe;if(q.sep==="."&&q.path.length===3)return null;const Ae=+((pe=q.year)!==null&&pe!==void 0?pe:Ht);if(q.day||(q.day=1),!function(Te,G,be){if(be<1||G<1||G>12)return!1;if(G===2){if(be>(Te%4==0&&Te%100!=0||Te%400==0||Te===1900?29:28))return!1}else if((G===4||G===6||G===9||G===11)&&be>30||(G===1||G===3||G===5||G===7||G===8||G===10||G===12)&&be>31)return!1;return!0}(Ae,q.month,q.day))return null;let We=-1/0;if(Ae<1900)return null;Ae<=1900&&q.month<=2?We=25568:Ae<1e4&&(We=25569);const Re=Date.UTC(Ae,q.month-1,q.day)/864e5+We+(q.time||0);if(Re>=0&&Re<=2958465){const Te=q._mon[0]==="0"||q.day[0]==="0"||q._mon.length===2&&q.day.length===2,G=q.path.replace(/[jdlDnmMFyYx-]/g,be=>be==="j"||be==="d"?Te?"dd":"d":be==="D"?"ddd":be==="l"?"dddd":be==="n"||be==="m"?Te?"mm":"m":be==="M"?"mmm":be==="F"?"mmmm":be==="y"?"yy":be==="x"?q.tf||"":be==="Y"?"yyyy":be);return j&&j.nativeDate?{v:ee(Re,j),z:G}:{v:Re,z:G}}}return null}function vn(W){const j=/^\s*([10]?\d|2[0-4])(?::([0-5]\d|\d))?(?::([0-5]\d|\d))?(\.\d{1,10})?(?:\s*([AP])M?)?\s*$/i.exec(W);if(j){const[,q,pe,Ae,We,Re]=j;if(We&&!Ae||!Re&&!pe&&!Ae)return null;let Te=1*(q||0);if(Re){if(Te>=13)return null;Re[0]!=="p"&&Re[0]!=="P"||(Te+=12)}return{v:(60*Te*60+60*(1*(pe||0))+1*(Ae||0)+1*(We||0))/86400,z:(q.length===2?"hh":"h")+":mm"+(Ae?":ss":"")+(Re?" AM/PM":"")}}return null}function Xt(W){return/^\s*true\s*$/i.test(W)?{v:!0}:/^\s*false\s*$/i.test(W)?{v:!1}:null}const Vt={};function jt(W,j){const{pattern:q,partitions:pe,locale:Ae}=W,We=G=>{const be=Object.assign({},_(),j,G);return Ae&&(be.locale=Ae),be},Re=(G,be)=>{const xe=We(be);return function(ye,st,Ge){const lt=c(Ge.locale),de=st[3]?st[3]:ft;if(typeof ye=="boolean"&&(ye=ye?"TRUE":"FALSE"),ye==null)return"";if(typeof ye!="number")return mt(ye,de,Ge,lt);if(!isFinite(ye)){const Ve=lt||f;return isNaN(ye)?Ve.nan:(ye<0?Ve.negative:"")+Ve.infinity}const Le=vt(ye,st);return Le?mt(ye,Le,Ge,lt):Ge.overflow}(K(G,xe),pe,xe)};Re.color=(G,be)=>function(xe,ye){if(typeof xe!="number"||!isFinite(xe))return(ye[3]?ye[3].color:ft.color)||et;const st=vt(xe,ye);return st&&st.color||et}(K(G,We(be)),pe);const Te=function(G){var be;let xe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const[ye,st]=G,Ge=ye.frac_max,lt={type:"general",isDate:fe(G),isText:Ee(G),isPercent:ue(G),maxDecimals:ye.general?9:Ge,scale:(be=ye.scale)!==null&&be!==void 0?be:1,color:0,parentheses:0,grouped:ye.grouping?1:0,_partitions:G},de=!lt.isDate&&!lt.isText&&!ye.error&&ye.tokens.some(Mt=>Mt.type==="string"&&(xe?Mt.value===xe:w.test(Mt.value)));let Le="G",Ve=Ge>=0?Math.min(15,Ge):"",Ze="",Dt="";if(st&&st.color&&(Dt="-",lt.color=1),ye.parens&&(Ze="()",lt.parentheses=1),de)Le="C",lt.type="currency";else if(ye.error)lt.type="error",lt.maxDecimals=0;else if(lt.isDate){let Mt=0,pn=0,Yn="";ye.tokens.forEach(ht=>{const Dn=ht.type;/^(b-)?year/.test(Dn)?(Yn+="Y",pn++):Dn.startsWith("month")?(Yn+="M",pn++):/^(week)?day/.test(Dn)?(Yn+="D",pn++):Dn!=="hour"&&Dn!=="min"&&Dn!=="sec"&&Dn!=="am"||(Yn+=Dn[0],Mt++)}),lt.type="date",pn&&Mt?lt.type="datetime":!pn&&Mt&&(lt.type="time");const Hn=re.find(ht=>Yn.startsWith(ht[0]));Le=Hn?"D":"G",Ve=Hn?Hn[1]:""}else lt.isText?(Le="G",lt.type="text",Ve="",lt.maxDecimals=0):ye.general?(Le="G",lt.type="general",Ve=""):ye.fractions?(Le="G",lt.type="fraction",Ve=""):ye.exponential?(Le="S",lt.type="scientific"):lt.isPercent?(Le="P",lt.type="percent"):ye.grouping?(Le=",",lt.type="grouped"):(ye.int_max||Ge)&&(Le="F",lt.type="number");return lt.code=Le+Ve+Dt+Ze,lt.level=Q[lt.type],Object.freeze(lt)}(pe,(j||{}).currency)||new SyntaxError;return Re.info=Te,Re.dateInfo=function(G){const[be]=G;return{year:!!(2&be.date),month:!!(4&be.date),day:!!(8&be.date),hours:!!(16&be.date),minutes:!!(32&be.date),seconds:!!(64&be.date),clockType:be.clock===12?12:24}}(pe),Re.isPercent=()=>!!Te.isPercent,Re.isDate=()=>!!Te.isDate,Re.isText=()=>!!Te.isText,Re.pattern=q,W.error&&(Re.error=W.error),Re.options=We,Re.locale=Ae||j&&j.locale||"",Object.freeze(Re)}function Nt(W,j){W||(W="General");let q=null;return Vt[W]?q=Vt[W]:(q=Object.assign({},_(),j).throws?N(W):function(pe){try{return N(pe)}catch(Ae){const We={tokens:[{type:"error"}],error:Ae.message};return{pattern:pe,partitions:[We,We,We,We],error:Ae.message,locale:null}}}(W),q.error||(Vt[W]=q)),jt(q,j)}Nt.isDate=W=>Nt(W,{throws:!1}).isDate(),Nt.isPercent=W=>Nt(W,{throws:!1}).isPercent(),Nt.isText=W=>Nt(W,{throws:!1}).isText(),Nt.getInfo=(W,j)=>Nt(W,{...j,throws:!1}).info,Nt.getDateInfo=(W,j)=>Nt(W,{...j,throws:!1}).dateInfo,Nt.dateToSerial=K,Nt.dateFromSerial=ee,Nt.options=_,Nt.dec2frac=p,Nt.round=m,Nt.codeToLocale=i,Nt.parseLocale=l,Nt.getLocale=c,Nt.addLocale=(W,j)=>{const q=l(j);return delete Vt[q.lang],delete Vt[q.language],h(W,q)},Nt.format=function(W,j,q){let pe=arguments.length>3&&arguments[3]!==void 0&&arguments[3];const Ae=q&&typeof q=="object"?q:{locale:q,throws:!pe};return Nt(W,Ae)(K(j,Ae),Ae)},Nt.is_date=Nt.isDate,Nt.parseNumber=Zt,Nt.parseDate=gn,Nt.parseTime=vn,Nt.parseBool=Xt,Nt.parseValue=function(W,j){var q,pe,Ae;return(q=(pe=(Ae=Zt(W))!==null&&Ae!==void 0?Ae:gn(W,j))!==null&&pe!==void 0?pe:vn(W))!==null&&q!==void 0?q:Xt(W)};var Bn=Nt;return r=r.default}()})})(aU);var SVe=aU.exports,EVe=SVe;const ka=yVe(EVe),Bl=(t,e=0)=>t?ka.getInfo(t).maxDecimals??e:e,U0=(t,e)=>{if(t&&!e||!t&&e)return!1;const n=u=>u.reduce((c,d)=>{if(c.isEnd)return c;const h=d.value||d.num;return d.type==="point"?(c.isEnd=!0,c):{...c,result:c.result+h}},{isEnd:!1,result:""}).result,r=ka.getInfo(t)._partitions,i=ka.getInfo(e)._partitions,o=n(r[0].tokens),s=n(i[0].tokens),a=n(r[1].tokens),l=n(i[1].tokens);return o===s&&a===l&&r[1].color===i[1].color},AI=t=>new Array(Math.min(Math.max(0,Number(t)),30)).fill(0).join(""),Lo=(t,e)=>t.split(";").map(n=>/\.0?/.test(n)?n.replace(/\.0*/g,`${e>0?".":""}${AI(Number(e||0))}`):/0([^0]?)|0$/.test(n)?n.replace(/0([^0]+)|0$/,`0${e>0?".":""}${AI(Number(e||0))}$1`):n).join(";"),wVe=t=>/\.0?/.test(t)||/0([^0]?)|0$/.test(t),a0={id:"sheet.command.numfmt.set.numfmt",type:se.COMMAND,handler:(t,e)=>{if(!e)return!1;const n=t.get(le),r=t.get(oe),i=t.get(At),o=r.getCurrentUniverSheetInstance(),s=o.getUnitId(),a=o.getActiveSheet().getSheetId(),l=e.values.filter(p=>!!p.pattern),u=e.values.filter(p=>!p.pattern),c=Ll(s,a,l),d={unitId:s,subUnitId:a,ranges:u.map(p=>({startColumn:p.col,startRow:p.row,endColumn:p.col,endRow:p.row}))},h=[],f=[];if(l.length){Object.keys(c.values).forEach(g=>{const v=c.values[g];v.ranges=Ta(v.ranges)}),h.push({id:Zi.id,params:c});const p=H4(t,c);f.push(...p)}if(u.length){d.ranges=Ta(d.ranges),h.push({id:Fo.id,params:d});const p=rc(t,d);f.push(...p)}const m=Xn(h,n).result;return m&&i.pushUndoRedo({unitID:s,undoMutations:f,redoMutations:h}),m}},lU={id:"sheet.command.numfmt.add.decimal.command",type:se.COMMAND,handler:async t=>{const e=t.get(le),n=t.get(ut),r=t.get(eo),i=t.get(oe),o=n.getSelections();if(!o||!o.length)return!1;const s=i.getCurrentUniverSheetInstance(),a=s.getActiveSheet(),l=s.getUnitId(),u=a.getSheetId();let c=0;o.forEach(m=>{Er.foreach(m.range,(p,g)=>{const v=r.getValue(l,u,p,g);if(!v)return;const _=Bl(v.pattern);c=_>c?_:c})});const d=c+1,h=Lo(`0${d>0?".0":""}`,d),f=[];return o.forEach(m=>{Er.foreach(m.range,(p,g)=>{const v=r.getValue(l,u,p,g);if(!v||U0(v.pattern,"0.0"))f.push({row:p,col:g,pattern:h});else{const _=Bl(v.pattern),C=Lo(v.pattern,_+1);C!==v.pattern&&f.push({row:p,col:g,pattern:C})}})}),f.length?await e.executeCommand(a0.id,{values:f}):!1}},RVe=[{label:"1930-08-05",suffix:"yyyy-MM-dd"},{label:"1930/08/05",suffix:"yyyy/MM/dd"},{label:"19300805",suffix:'yyyy""MM""dd""'},{label:"08-05",suffix:"MM-dd"},{label:"85",suffix:'M""d""'},{label:"13:30:30",suffix:"h:mm:ss"},{label:"13:30",suffix:"h:mm"},{label:"01:30",suffix:"A/P hh:mm"},{label:"1:30",suffix:"A/P h:mm"},{label:"1:30:30",suffix:"A/P h:mm:ss"},{label:"08-05  01:30",suffix:"MM-dd A/P hh:mm"}],DVe=[{label:"(1,235)",suffix:"#,##0_);(#,##0)"},{label:"(1,235) ",suffix:"#,##0_);[Red](#,##0)",color:"red"},{label:"1,234.56",suffix:"#,##0.00_);#,##0.00"},{label:"1,234.56",suffix:"#,##0.00_);[Red]#,##0.00",color:"red"},{label:"-1,234.56",suffix:"#,##0.00_);-#,##0.00"},{label:"-1,234.56",suffix:"#,##0.00_);[Red]-#,##0.00",color:"red"}],uU=[{label:t=>`${t}1,235`,suffix:t=>`"${t}"#,##0.00_);"${t}"#,##0.00`},{label:t=>`${t}1,235`,suffix:t=>`"${t}"#,##0.00_);[Red]"${t}"#,##0.00`,color:"red"},{label:t=>`(${t}1,235)`,suffix:t=>`"${t}"#,##0.00_);("${t}"#,##0.00)`},{label:t=>`(${t}1,235)`,suffix:t=>`"${t}"#,##0.00_);[Red]("${t}"#,##0.00)`,color:"red"},{label:t=>`-${t}1,235`,suffix:t=>`"${t}"#,##0.00_);-"${t}"#,##0.00`},{label:t=>`-${t}1,235`,suffix:t=>`"${t}"#,##0.00_);[Red]-"${t}"#,##0.00`,color:"red"}],cU={id:"sheet.command.numfmt.set.currency",type:se.COMMAND,handler:async t=>{const e=t.get(le),n=t.get(ut).getSelections();if(!n||!n.length)return!1;const r=[],i=uU[0].suffix("");return n.forEach(o=>{Er.foreach(o.range,(s,a)=>{r.push({row:s,col:a,pattern:i,type:"currency"})})}),await e.executeCommand(a0.id,{values:r})}},dU={id:"sheet.command.numfmt.subtract.decimal.command",type:se.COMMAND,handler:async t=>{const e=t.get(le),n=t.get(ut),r=t.get(eo),i=t.get(oe),o=n.getSelections();if(!o||!o.length)return!1;const s=i.getCurrentUniverSheetInstance(),a=s.getActiveSheet(),l=s.getUnitId(),u=a.getSheetId();let c=0;o.forEach(m=>{Er.foreach(m.range,(p,g)=>{const v=r.getValue(l,u,p,g);if(!v)return;const _=Bl(v.pattern);c=_>c?_:c})});const d=c-1,h=Lo(`0${d>0?".0":"."}`,d),f=[];return o.forEach(m=>{Er.foreach(m.range,(p,g)=>{const v=r.getValue(l,u,p,g);if(!v||U0(v.pattern,"0.0"))f.push({row:p,col:g,pattern:h});else{const _=Bl(v.pattern);f.push({row:p,col:g,pattern:Lo(v.pattern,_-1)})}})}),await e.executeCommand(a0.id,{values:f})}},Np={id:"sheet.operation.close.numfmt.panel",type:se.OPERATION,handler:()=>!0},Yy=nn("INumfmtController");V5(it.Rendered,Yy);const $5={id:"sheet.operation.open.numfmt.panel",type:se.OPERATION,handler:t=>(t.get(Yy).openPanel(),!0)};var hU={exports:{}},Of={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IVe=Qe,xVe=Symbol.for("react.element"),MVe=Symbol.for("react.fragment"),OVe=Object.prototype.hasOwnProperty,TVe=IVe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$Ve={key:!0,ref:!0,__self:!0,__source:!0};function fU(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)OVe.call(e,r)&&!$Ve.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:xVe,type:t,key:o,ref:s,props:i,_owner:TVe.current}}Of.Fragment=MVe;Of.jsx=fU;Of.jsxs=fU;hU.exports=Of;var Gt=hU.exports;const Gy=b.createContext([]),z_=["$","","","","","","","","","","","","","","","","","","","","","","","","",""];var kVe=Object.defineProperty,AVe=Object.getOwnPropertyDescriptor,NVe=(t,e,n,r)=>{for(var i=r>1?void 0:r?AVe(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&kVe(e,n,i),i},LVe=(t,e)=>(n,r)=>e(n,r,t);let k5=class{constructor(t){this._localStorageService=t}_getKey(t){return`userHabitController_${t}`}async addHabit(t,e){const n=this._getKey(t);return this._localStorageService.getItem(n).then(r=>{r||this._localStorageService.setItem(n,e)})}markHabit(t,e){const n=this._getKey(t);this._localStorageService.getItem(n).then(r=>{if(r){const i=r.findIndex(o=>o===e);i>-1&&r.splice(i,1),r.unshift(e),this._localStorageService.setItem(n,r)}})}async getHabit(t,e){const n=this._getKey(t),r=await this._localStorageService.getItem(n);if(e&&r){const i=r.map((o,s,a)=>{const l=a.length;return{value:o,priority:l-s}});return e.sort((o,s)=>{var a,l;const u=((a=i.find(c=>c.value===o))==null?void 0:a.priority)||-1;return(((l=i.find(c=>c.value===s))==null?void 0:l.priority)||-1)-u})}return r||[]}deleteHabit(t){this._localStorageService.removeItem(t)}};k5=NVe([LVe(0,ne(iM))],k5);const NI="numfmtCurrency",PVe=t=>{const e=_t(k5),[n,r]=b.useState(z_);return b.useEffect(()=>{e.addHabit("numfmtCurrency",[]).then(()=>{e.getHabit(NI,[...z_]).then(i=>{r(i),t&&t(i)})})},[]),{userHabitCurrency:n,mark:i=>{e.markHabit(NI,i)}}},BVe=()=>{const t=b.useRef([]),[e,n]=b.useState({});return b.useEffect(()=>{t.current.forEach(r=>{r()}),t.current=[]},[e]),r=>{t.current.push(r),n({})}},Z4=t=>z_.find(e=>t.includes(e)),FVe=t=>!!Z4(t)&&t.startsWith("_("),UVe=t=>{const[e,n]=b.useState(()=>Bl(t.defaultPattern||"",2)),r=b.useContext(Gy),[i,o]=b.useState(()=>Z4(t.defaultPattern)||r[0]),s=b.useMemo(()=>r.map(c=>({label:c,value:c})),[]),a=_t(mn).t;t.action.current=()=>Lo(`_("${i}"* #,##0${e>0?".0":""}_)`,e);const l=c=>{o(c),t.onChange(Lo(`_("${c}"* #,##0${e>0?".0":""}_)`,e))},u=c=>{const d=c||0;n(d),t.onChange(Lo(`_("${i}"* #,##0${d>0?".0":""}_)`,d))};return Gt.jsxs("div",{children:[Gt.jsxs("div",{className:"m-t-16 options ",children:[Gt.jsxs("div",{className:"option",children:[Gt.jsx("div",{className:"label",children:a("sheet.numfmt.decimalLength")}),Gt.jsx("div",{className:"m-t-8 w-120",children:Gt.jsx(u4,{value:e,max:20,min:0,onChange:u})})]}),Gt.jsxs("div",{className:"option",children:[Gt.jsx("div",{className:"label",children:a("sheet.numfmt.currencyType")}),Gt.jsx("div",{className:"m-t-8 w-140",children:Gt.jsx(k9,{onChange:l,options:s,value:i})})]})]}),Gt.jsx("div",{className:"describe m-t-14",children:a("sheet.numfmt.accountingDes")})]})},Lp=t=>uU.map(e=>({label:e.label(t),value:e.suffix(t),color:e.color})),mU=()=>RVe.map(t=>({label:t.label,value:t.suffix})),pU=()=>DVe.map(t=>({label:t.label,value:t.suffix,color:t.color})),HVe=t=>!!Z4(t)&&!t.startsWith("_("),VVe=t=>{const e=_t(mn).t,n=b.useContext(Gy),[r,i]=b.useState(()=>Z4(t.defaultPattern)||n[0]),[o,s]=b.useState(()=>Bl(t.defaultPattern||"",2)),[a,l]=b.useState(()=>{var m;const p=Lp(r);return((m=p.find(g=>U0(g.value,t.defaultPattern)))==null?void 0:m.value)||p[0].value}),u=b.useMemo(()=>Lp(r),[r]),c=b.useMemo(()=>n.map(m=>({label:m,value:m})),[n]);t.action.current=()=>Lo(a,o);const d=m=>{i(m);const p=Lp(m)[0].value;l(p),t.onChange(Lo(p,o))},h=m=>{l(m),t.onChange(Lo(m,o))},f=m=>{s(m||0),t.onChange(Lo(a,m||0))};return Gt.jsxs("div",{children:[Gt.jsxs("div",{className:"m-t-16 options ",children:[Gt.jsxs("div",{className:"option",children:[Gt.jsx("div",{className:"label",children:e("sheet.numfmt.decimalLength")}),Gt.jsx("div",{className:"m-t-8 w-120",children:Gt.jsx(u4,{value:o,max:20,min:0,onChange:f})})]}),Gt.jsxs("div",{className:"option",children:[Gt.jsxs("div",{className:"label",children:[" ",e("sheet.numfmt.currencyType")]}),Gt.jsx("div",{className:"m-t-8 w-140",children:Gt.jsx(k9,{onChange:d,options:c,value:r})})]})]}),Gt.jsxs("div",{className:"m-t-16 label",children:[" ",e("sheet.numfmt.negType")]}),Gt.jsx("div",{className:"m-t-8",children:Gt.jsx(kC,{onChange:h,options:u,value:a})}),Gt.jsx("div",{className:"describe m-t-14",children:e("sheet.numfmt.currencyDes")})]})},jVe=t=>{const e=ka.getInfo(t);return mU().map(n=>n.value).includes(t)||["date","datetime","time"].includes(e.type)},zVe=t=>{const e=b.useMemo(mU,[]),n=_t(mn).t,[r,i]=b.useState(()=>{if(t.defaultPattern){const s=e.find(a=>a.value===t.defaultPattern);if(s)return s.value}return e[0].value});t.action.current=()=>r;const o=s=>{i(s),t.onChange(s)};return Gt.jsxs("div",{children:[Gt.jsx("div",{className:"m-t-16 label",children:n("sheet.numfmt.dateType")}),Gt.jsx("div",{className:"m-t-8",children:Gt.jsx(kC,{value:r,options:e,onChange:o})}),Gt.jsx("div",{className:"describe m-t-14",children:n("sheet.numfmt.dateDes")})]})},WVe=t=>!t,XVe=t=>{const e=_t(mn).t;return t.action.current=()=>"",Gt.jsx("div",{children:Gt.jsx("div",{className:"describe m-t-14",children:e("sheet.numfmt.generalDes")})})},YVe=t=>pU().some(e=>U0(e.value,t)),GVe=t=>{const e=_t(mn),n=b.useMemo(pU,[]),[r,i]=b.useState(()=>Bl(t.defaultPattern||"",0)),[o,s]=b.useState(()=>{const d=n.find(h=>U0(h.value,t.defaultPattern||""));return(d==null?void 0:d.value)||n[0].value}),a=b.useMemo(()=>Lo(o,Number(r||0)),[o,r]),l=b.useMemo(()=>!wVe(o),[o]),u=d=>{i(d||0),t.onChange(Lo(o,Number(d||0)))},c=d=>{i(Bl(d,0)),s(d),t.onChange(d)};return t.action.current=()=>a,Gt.jsxs("div",{children:[Gt.jsx("div",{className:"m-t-16 label",children:e.t("sheet.numfmt.decimalLength")}),Gt.jsx("div",{className:"m-t-8",children:Gt.jsx(u4,{disabled:l,value:r,max:20,min:0,onChange:u})}),Gt.jsxs("div",{className:"m-t-16 label",children:[" ",e.t("sheet.numfmt.negType")]}),Gt.jsx("div",{className:"m-t-8",children:Gt.jsx(kC,{onChange:c,options:n,value:o})}),Gt.jsx("div",{className:"describe m-t-14",children:e.t("sheet.numfmt.thousandthPercentileDes")})]})},KVe=t=>{const{defaultValue:e,defaultPattern:n,row:r,col:i}=t.value,o=_t(mn),s=b.useRef(()=>""),a=o.t,l=BVe(),u=b.useMemo(()=>[{label:"sheet.numfmt.general",component:XVe},{label:"sheet.numfmt.accounting",component:UVe},{label:"sheet.numfmt.currency",component:VVe},{label:"sheet.numfmt.date",component:zVe},{label:"sheet.numfmt.thousandthPercentile",component:GVe}].map(R=>({...R,label:a(R.label)})),[]),[c,d]=b.useState(v),[h,f]=b.useState(()=>`${r}_${i}`),{mark:m,userHabitCurrency:p}=PVe(()=>f(`${r}_${i}_userCurrency'`)),g=b.useMemo(()=>{var R;return(R=u.find(D=>D.label===c))==null?void 0:R.component},[c]);function v(){return[WVe,FVe,HVe,jVe,YVe].reduce((R,D,I)=>R||(D(n)?u[I].label:""),"")||u[0].label}const _=u.map(R=>({label:R.label,value:R.label})),C=R=>{d(R),l(()=>t.onChange({type:"change",value:s.current()||""}))},y=R=>{t.onChange({type:"change",value:R})},S=()=>{const R=s.current()||"",D=Z4(R);D&&m(D),t.onChange({type:"confirm",value:R})},E=()=>{t.onChange({type:"cancel",value:""})},w={onChange:y,defaultValue:e,defaultPattern:n,action:s};return b.useEffect(()=>{d(v()),f(`${r}_${i}`)},[r,i]),Gt.jsxs("div",{className:"numfmt-panel p-b-20",children:[Gt.jsxs("div",{children:[Gt.jsx("div",{className:"label m-t-14",children:a("sheet.numfmt.numfmtType")}),Gt.jsx("div",{className:"m-t-8",children:Gt.jsx(k9,{onChange:C,options:_,value:c})}),Gt.jsx("div",{children:g&&Gt.jsx(Gy.Provider,{value:p,children:b.createElement(g,{...w,key:h})})})]}),Gt.jsxs("div",{className:"btn-list m-t-14 m-b-20",children:[Gt.jsx(c1,{size:"small",onClick:E,className:"m-r-12",children:a("sheet.numfmt.cancel")}),Gt.jsx(c1,{type:"primary",size:"small",onClick:S,children:a("sheet.numfmt.confirm")})]})]})};var ss=function(){return ss=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},ss.apply(this,arguments)},ZVe=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},q4=b.forwardRef(function(t,e){var n=t.icon,r=t.id,i=t.className,o=t.extend,s=ZVe(t,["icon","id","className","extend"]),a="univerjs-icon univerjs-icon-".concat(r," ").concat(i||"").trim(),l=b.useRef("_".concat(JVe()));return gU(n,"".concat(r),{defIds:n.defIds,idSuffix:l.current},ss({ref:e,className:a},s),o)});function gU(t,e,n,r,i){return b.createElement(t.tag,ss(ss({key:e},qVe(t,n,i)),r),(QVe(t,n).children||[]).map(function(o,s){return gU(o,"".concat(e,"-").concat(t.tag,"-").concat(s),n,void 0,i)}))}function qVe(t,e,n){var r=ss({},t.attrs);n!=null&&n.colorChannel1&&r.fill==="colorChannel1"&&(r.fill=n.colorChannel1);var i=e.defIds;return!i||i.length===0||(t.tag==="use"&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+e.idSuffix),Object.entries(r).forEach(function(o){var s=o[0],a=o[1];typeof a=="string"&&(r[s]=a.replace(/url\(#(.*)\)/,"url(#$1".concat(e.idSuffix,")")))})),r}function QVe(t,e){var n,r=e.defIds;return!r||r.length===0?t:t.tag==="defs"&&!((n=t.children)===null||n===void 0)&&n.length?ss(ss({},t),{children:t.children.map(function(i){return typeof i.attrs.id=="string"&&r&&r.indexOf(i.attrs.id)>-1?ss(ss({},i),{attrs:ss(ss({},i.attrs),{id:i.attrs.id+e.idSuffix})}):i})}):t}function JVe(){return Math.random().toString(36).substring(2,8)}q4.displayName="UniverIcon";var eje={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.93152 3.8348C4.93152 2.54613 5.9762 1.50146 7.26485 1.50146 8.55351 1.50146 9.59819 2.54613 9.59819 3.8348V6.46695C9.59819 7.75561 8.55351 8.80028 7.26485 8.80028 5.9762 8.80028 4.93152 7.75561 4.93152 6.46695V3.8348zM7.26485 2.8348C6.71257 2.8348 6.26485 3.28252 6.26485 3.8348V6.46695C6.26485 7.01923 6.71257 7.46695 7.26485 7.46695 7.81713 7.46695 8.26485 7.01923 8.26485 6.46695V3.8348C8.26485 3.28252 7.81713 2.8348 7.26485 2.8348zM10.9315 3.8348C10.9315 2.54613 11.9762 1.50146 13.2649 1.50146 14.5535 1.50146 15.5982 2.54613 15.5982 3.8348V6.46695C15.5982 7.75561 14.5535 8.80028 13.2649 8.80028 11.9762 8.80028 10.9315 7.75561 10.9315 6.46695V3.8348zM13.2649 2.8348C12.7126 2.8348 12.2649 3.28252 12.2649 3.8348V6.46695C12.2649 7.01923 12.7126 7.46695 13.2649 7.46695 13.8171 7.46695 14.2649 7.01923 14.2649 6.46695V3.8348C14.2649 3.28252 13.8171 2.8348 13.2649 2.8348z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.403 9.81183C13.1426 9.55148 12.7205 9.55148 12.4602 9.81183 12.1998 10.0722 12.1998 10.4943 12.4602 10.7546L13.3221 11.6166H7.26493C6.89674 11.6166 6.59827 11.915 6.59827 12.2832 6.59827 12.6514 6.89674 12.9499 7.26493 12.9499H13.3221L12.4602 13.8118C12.1998 14.0722 12.1998 14.4943 12.4602 14.7546 12.7205 15.015 13.1426 15.015 13.403 14.7546L15.3985 12.7591C15.4167 12.7412 15.4339 12.7224 15.4499 12.7026 15.48 12.6655 15.5055 12.6259 15.5264 12.5846 15.5724 12.4941 15.5983 12.3917 15.5983 12.2832 15.5983 12.1748 15.5724 12.0724 15.5264 11.9819 15.5055 11.9406 15.48 11.901 15.4499 11.8639 15.4339 11.8441 15.4167 11.8253 15.3986 11.8074L13.403 9.81183zM2.26489 8.21384C2.26489 7.84565 2.56337 7.54717 2.93156 7.54717H3.26489C3.63308 7.54717 3.93156 7.84565 3.93156 8.21384 3.93156 8.58203 3.63308 8.88051 3.26489 8.88051H2.93156C2.56337 8.88051 2.26489 8.58203 2.26489 8.21384z"}}]},vU=b.forwardRef(function(t,e){return b.createElement(q4,Object.assign({},t,{id:"add-digits-single",ref:e,icon:eje}))});vU.displayName="AddDigitsSingle";const tje=vU;var nje={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_556",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.56 0.77H16.56V16.77H0.56z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_556)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.19318 4.76988C1.70089 4.26222 2.524 4.26226 3.03166 4.76997L8.13929 9.87808C8.3736 10.1124 8.75352 10.1124 8.98784 9.8781L14.0959 4.77C14.6036 4.26232 15.4267 4.26232 15.9344 4.77C16.4421 5.27768 16.4421 6.1008 15.9344 6.60848L9.97775 12.5651C9.19667 13.3462 7.93029 13.3462 7.14925 12.5651L1.1931 6.60836C0.685438 6.10065 0.685477 5.27753 1.19318 4.76988Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},_U=b.forwardRef(function(t,e){return b.createElement(q4,Object.assign({},t,{id:"more-down-single",ref:e,icon:nje}))});_U.displayName="MoreDownSingle";const rje=_U;var ije={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.13281 3.84408C5.13281 2.55541 6.17749 1.51074 7.46615 1.51074C8.7548 1.51074 9.79948 2.55541 9.79948 3.84408V6.5337C9.79948 7.82236 8.7548 8.86704 7.46615 8.86704C6.17749 8.86704 5.13281 7.82236 5.13281 6.5337V3.84408ZM7.46615 2.84408C6.91387 2.84408 6.46615 3.29179 6.46615 3.84408V6.5337C6.46615 7.08598 6.91387 7.5337 7.46615 7.5337C8.01842 7.5337 8.46615 7.08598 8.46615 6.5337V3.84408C8.46615 3.29179 8.01842 2.84408 7.46615 2.84408Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.13281 8.20033C2.13281 7.83214 2.43129 7.53366 2.79948 7.53366H3.13281C3.501 7.53366 3.79948 7.83214 3.79948 8.20033 3.79948 8.56852 3.501 8.867 3.13281 8.867H2.79948C2.43129 8.867 2.13281 8.56852 2.13281 8.20033zM8.93763 9.7878C9.19798 10.0481 9.19798 10.4703 8.93763 10.7306L8.0757 11.5925H13.4662C13.8344 11.5925 14.1329 11.891 14.1329 12.2592 14.1329 12.6274 13.8344 12.9259 13.4662 12.9259H8.0757L8.93763 13.7878C9.19798 14.0482 9.19798 14.4703 8.93763 14.7306 8.67728 14.991 8.25517 14.991 7.99482 14.7306L5.99482 12.7306C5.93091 12.6667 5.88268 12.593 5.85015 12.5144 5.81755 12.4358 5.79956 12.3496 5.79956 12.2592 5.79956 12.1688 5.81755 12.0826 5.85015 12.004 5.88268 11.9254 5.93091 11.8517 5.99482 11.7878L7.99482 9.7878C8.25517 9.52745 8.67728 9.52745 8.93763 9.7878z"}}]},bU=b.forwardRef(function(t,e){return b.createElement(q4,Object.assign({},t,{id:"reduce-digits-single",ref:e,icon:ije}))});bU.displayName="ReduceDigitsSingle";const oje=bU;var sje={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.64671 1.77571C4.94126 1.55479 5.35913 1.61449 5.58004 1.90904L8.59224 6.20102L11.6044 1.90904C11.8254 1.61449 12.2432 1.55479 12.5378 1.77571C12.8323 1.99662 12.892 2.41449 12.6711 2.70904L9.92567 6.64535H12.6711C13.0393 6.64535 13.3378 6.94382 13.3378 7.31201C13.3378 7.6802 13.0393 7.97868 12.6711 7.97868H9.25887V9.91528H12.9271C13.2953 9.91528 13.5938 10.2138 13.5938 10.582C13.5938 10.9501 13.2953 11.2486 12.9271 11.2486H9.25887V14.1274C9.25887 14.4956 8.96039 14.794 8.5922 14.794C8.22401 14.794 7.92554 14.4956 7.92554 14.1274V11.2486H4.25736C3.88918 11.2486 3.5907 10.9501 3.5907 10.582C3.5907 10.2138 3.88918 9.91528 4.25736 9.91528H7.92554V7.97868H4.51338C4.14519 7.97868 3.84671 7.6802 3.84671 7.31201C3.84671 6.94382 4.14519 6.64535 4.51338 6.64535H7.25882L4.51338 2.70904C4.29246 2.41449 4.35216 1.99662 4.64671 1.77571Z"}}]},CU=b.forwardRef(function(t,e){return b.createElement(q4,Object.assign({},t,{id:"rmb-single",ref:e,icon:sje}))});CU.displayName="RmbSingle";const aje=CU,K8=[{label:"sheet.numfmt.general",pattern:null},{label:"sheet.numfmt.text",pattern:"@@@"},"|",{label:"sheet.numfmt.number",pattern:"0"},"|",{label:"sheet.numfmt.accounting",pattern:'"" #,##0.00_);[Red](""#,##0.00)'},{label:"sheet.numfmt.financialValue",pattern:"#,##0.00;[Red]#,##0.00"},{label:"sheet.numfmt.currency",pattern:'""#,##0.00_);[Red](""#,##0.00)'},{label:"sheet.numfmt.roundingCurrency",pattern:'""#,##0;[Red]""#,##0'},"|",{label:"sheet.numfmt.date",pattern:"yyyy-mm-dd;@"},{label:"sheet.numfmt.time",pattern:'am/pm h":"mm":"ss'},{label:"sheet.numfmt.dateTime",pattern:"yyyy-m-d am/pm h:mm"},{label:"sheet.numfmt.timeDuration",pattern:"h:mm:ss"},"|",{label:"sheet.numfmt.moreFmt",pattern:""}],Ky=t=>ka.getInfo(t).type||"unknown",LI=(t,e)=>{const n=ka.getInfo(t)._partitions[1],r=ka.format(t,e,{locale:"zh-CN"});return e<0?{result:r,color:n.color}:{result:r}},lje=t=>{const e=_t(mn),n=t.value??e.t("sheet.numfmt.general");return Gt.jsx("span",{className:"more-numfmt-type",children:n})},uje=()=>{const t=_t(le),e=_t(mn),n=_t(ut),r=s=>{const a=n.getLast();if(!a)return;const l=a.range,u=[];Er.foreach(l,(c,d)=>{s?u.push({row:c,col:d,pattern:s,type:Ky(s)}):u.push({row:c,col:d})}),t.executeCommand(a0.id,{values:u})},i=s=>{if(s===0)r(null);else if(s===K8.length-1)t.executeCommand($5.id);else{const a=K8[s];a.pattern&&r(a.pattern)}},o=1220;return Gt.jsx("div",{className:"more-numfmt-type-options",children:K8.map((s,a)=>s==="|"?Gt.jsx("div",{className:"line m-t-4",onClick:l=>l.stopPropagation()},a):Gt.jsxs("div",{className:"option-item m-t-4",onClick:()=>{i(a)},children:[Gt.jsx("div",{children:e.t(s.label)}),Gt.jsx("div",{className:"m-l-26",children:s.pattern?ka.format(s.pattern||"",o,{locale:"zh-CN"}):""})]},a))})},cje=t=>{const e="icon-rmbSingle";return t.register(e,aje),t.register("MoreDownSingle",rje),n=>({icon:e,id:cU.id,title:"sheet.numfmt.currency",tooltip:"sheet.numfmt.currency",type:gt.BUTTON,group:un.TOOLBAR_FORMULAS_INSERT,positions:[yn.TOOLBAR_START],hidden$:jr(n,Pr.SHEET)})},dje=t=>{const e="icon-addDigitsSingle";return t.register(e,tje),n=>({icon:e,id:lU.id,title:"sheet.numfmt.addDecimal",tooltip:"sheet.numfmt.addDecimal",type:gt.BUTTON,positions:[yn.TOOLBAR_START],group:un.TOOLBAR_FORMULAS_INSERT,hidden$:jr(n,Pr.SHEET)})},hje=t=>{const e="icon-reduceDigitsSingle";return t.register(e,oje),n=>({icon:e,id:dU.id,title:"sheet.numfmt.subtractDecimal",tooltip:"sheet.numfmt.subtractDecimal",type:gt.BUTTON,group:un.TOOLBAR_FORMULAS_INSERT,positions:[yn.TOOLBAR_START],hidden$:jr(n,Pr.SHEET)})},fje=t=>{const e="sheet.numfmt.moreNumfmtType",n="sheet.numfmt.moreNumfmtType.options";return t.register(e,lje),t.register(n,uje),r=>{const i=r.get(eo),o=r.get(oe),s=r.get(le),a=r.get(mn),l=r.get(ut),u=new tn(c=>P5(l.selectionMoveEnd$,new tn(d=>{const h=s.onCommandExecuted(f=>{f.id===Zi.id&&d.next(null)});return()=>h.dispose()})).subscribe(()=>{const d=l.getSelections();if(d&&d[0]){const h=o.getCurrentUniverSheetInstance(),f=h.getActiveSheet(),m=d[0].range,p=m.startRow,g=m.startColumn,v=i.getValue(h.getUnitId(),f.getSheetId(),p,g);let _=a.t("sheet.numfmt.general");if(v){const C=v.pattern,y=K8.filter(S=>typeof S=="object"&&S.pattern).find(S=>U0(C,S.pattern));y&&typeof y=="object"&&y.pattern&&(_=a.t(y.label))}c.next(_)}}));return{label:e,id:$5.id,tooltip:"sheet.numfmt.title",type:gt.SELECTOR,group:un.TOOLBAR_FORMULAS_INSERT,positions:[yn.TOOLBAR_START],selections:[{label:{name:n,hoverable:!1}}],value$:u,hidden$:jr(r,Pr.SHEET)}}};var mje=Object.defineProperty,pje=Object.getOwnPropertyDescriptor,gje=(t,e,n,r)=>{for(var i=r>1?void 0:r?pje(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&mje(e,n,i),i},Io=(t,e)=>(n,r)=>e(n,r,t);let Z8=class extends je{constructor(t,e,n,r,i,o,s,a,l,u,c,d,h){super(),k2(this,"_previewPattern",""),k2(this,"openPanel",()=>{const f=this._sidebarService,m=this._selectionManagerService,p=this._commandService,g=this._univerInstanceService,v=this._numfmtService,_=this._localeService,C=(m.getSelectionRanges()||[])[0];if(!C)return!1;const y=g.getCurrentUniverSheetInstance(),S=y.getActiveSheet(),E=S.getCellRaw(C.startRow,C.startColumn),w=v.getValue(y.getUnitId(),S.getSheetId(),C.startRow,C.startColumn);let R="";w&&(R=w.pattern);const D=(E==null?void 0:E.t)===er.NUMBER?E.v:12345678,I={onChange:k=>{var O,$;if(k.type==="change")this._previewPattern=k.value,this._sheetSkeletonManagerService.reCalculate(),($=(O=this._renderManagerService.getRenderById(y.getUnitId()))==null?void 0:O.mainComponent)==null||$.makeDirty();else if(k.type==="confirm"){const N=m.getSelectionRanges()||[],H={values:[]},X=Ky(k.value);N.forEach(te=>{Er.foreach(te,(z,A)=>{H.values.push({row:z,col:A,pattern:k.value,type:X})})}),p.executeCommand(a0.id,H),f.close()}else k.type==="cancel"&&f.close()},value:{defaultPattern:R,defaultValue:D,row:C.startRow,col:C.startColumn}};f.open({header:{title:_.t("sheet.numfmt.title")},children:{label:T5,...I},onClose:()=>{var k,O;this._sheetSkeletonManagerService.reCalculate(),(O=(k=this._renderManagerService.getRenderById(y.getUnitId()))==null?void 0:k.mainComponent)==null||O.makeDirty(),p.executeCommand(Np.id)}})}),k2(this,"_initLocal",()=>{this._localeService.load({zhCN:gVe})}),this._sheetInterceptorService=t,this._themeService=e,this._injector=n,this._univerInstanceService=r,this._sheetSkeletonManagerService=i,this._commandService=o,this._selectionManagerService=s,this._renderManagerService=a,this._numfmtService=l,this._componentManager=u,this._menuService=c,this._sidebarService=d,this._localeService=h,this._initInterceptorCommands(),this._initRealTimeRenderingInterceptor(),this._initPanel(),this._initCommands(),this._commandExecutedListener(),this._initMenu(),this._initInterceptorCellContent(),this._initLocal()}_initCommands(){[lU,dU,cU,$5,Np,a0].forEach(t=>{this.disposeWithMe(this._commandService.registerCommand(t))})}_initPanel(){this._componentManager.register(T5,KVe)}_initMenu(){[dje,hje,cje,fje].map(t=>t(this._componentManager)).forEach(t=>{this.disposeWithMe(this._menuService.addMenuItem(t(this._injector)))})}_initInterceptorCommands(){const t=this;this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations(e){switch(e.id){case A4.id:case N4.id:{const n=t._univerInstanceService.getCurrentUniverSheetInstance().getUnitId(),r=t._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),i=t._selectionManagerService.getSelectionRanges();if(!(i!=null&&i.length))break;const o={unitId:n,subUnitId:r,ranges:[]},s=t._numfmtService.getModel(n,r);i.forEach(l=>{Er.foreach(l,(u,c)=>{s!=null&&s.getValue(u,c)&&o.ranges.push({startColumn:c,endColumn:c,startRow:u,endRow:u})})}),o.ranges=Ta(o.ranges);const a=rc(t._injector,o);return{redos:[{id:Fo.id,params:o}],undos:a}}}return{redos:[],undos:[]}}}))}_initInterceptorCellContent(){const t=new nt;this.disposeWithMe(this._sheetInterceptorService.intercept(Ra.CELL_CONTENT,{handler:(e,n,r)=>{const i=n.unitId,o=n.subUnitId,s=this._numfmtService.getValue(i,o,n.row,n.col);if(!s)return r(e);const a=e;if(!a||a.t!==er.NUMBER)return r(e);let l="";const u=t.getValue(n.row,n.col);if(u&&u.parameters===a.v)return{...e,...u.result};const c=LI(s.pattern,Number(a.v));if(l=c.result,!l)return r(e);const d={v:l};if(c.color){const h=this._themeService.getCurrentTheme()[`${c.color}500`];h&&(d.interceptorStyle={cl:{rgb:h}})}return t.setValue(n.row,n.col,{result:d,parameters:a.v}),{...e,...d}}})),this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===Zi.id){const n=e.params;Object.keys(n.values).forEach(r=>{n.values[r].ranges.forEach(i=>{Er.foreach(i,(o,s)=>{t.realDeleteValue(o,s)})})})}})),this.disposeWithMe(Be(this._sheetSkeletonManagerService.currentSkeleton$.pipe(Fs(e=>e==null?void 0:e.sheetId),eb()).subscribe(()=>{t.reset()})))}_initRealTimeRenderingInterceptor(){const t=new tn(n=>{this._commandService.onCommandExecuted(r=>{r.id===$5.id&&n.next(!0),r.id===Np.id&&n.next(!1)})}),e=mx([t,this._selectionManagerService.selectionMoveEnd$.pipe(Fs(n=>n?n.map(r=>r.range):[]))]);this.disposeWithMe(Be(e.pipe(tb(([n,r])=>new tn(i=>{const o=new Ia;return n&&r.length&&i.next({selectionRanges:r,disposableCollection:o}),()=>{o.dispose()}})),KH(()=>{this._previewPattern=null})).subscribe(({disposableCollection:n,selectionRanges:r})=>{var i,o;const s=this._univerInstanceService.getCurrentUniverSheetInstance();this.openPanel(),n.add(this._sheetInterceptorService.intercept(Ra.CELL_CONTENT,{priority:99,handler:(a,l,u)=>{const{row:c,col:d}=l;if(r.find(h=>h.startColumn<=d&&h.endColumn>=d&&h.startRow<=c&&h.endRow>=c)){const h=l.worksheet.getCellRaw(c,d),f=h==null?void 0:h.v,m=h==null?void 0:h.t;if(f==null||m!==er.NUMBER||this._previewPattern===null)return u(a);const p=LI(this._previewPattern,f);if(p.color){const g=this._themeService.getCurrentTheme()[`${p.color}500`];return{...a,v:p.result,t:er.STRING,s:{cl:{rgb:g}}}}return{...a,v:p.result,t:er.STRING}}return u(a)}})),(o=(i=this._renderManagerService.getRenderById(s.getUnitId()))==null?void 0:i.mainComponent)==null||o.makeDirty()})))}_commandExecutedListener(){this.disposeWithMe(Be(P5(new tn(t=>{const e=this._commandService.onCommandExecuted(n=>{if(Zi.id===n.id){const r=n.params;t.next(r.unitId)}});return()=>{e.dispose()}}),this._numfmtService.modelReplace$).pipe(YH(16)).subscribe(t=>{var e,n;this._sheetSkeletonManagerService.reCalculate(),(n=(e=this._renderManagerService.getRenderById(t))==null?void 0:e.mainComponent)==null||n.makeDirty()})))}};Z8=gje([yt(it.Rendered,Z8),Io(0,ne(En)),Io(1,ne(Ki)),Io(2,ne(Tn)),Io(3,ne(oe)),Io(4,ne(kr)),Io(5,ne(le)),Io(6,ne(ut)),Io(7,ne(kn)),Io(8,ne(eo)),Io(9,ne(Pa)),Io(10,ne(I1)),Io(11,ne(C0)),Io(12,ne(mn))],Z8);var vje=Object.defineProperty,_je=Object.getOwnPropertyDescriptor,bje=(t,e,n,r)=>{for(var i=r>1?void 0:r?_je(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&vje(e,n,i),i},o3=(t,e)=>(n,r)=>e(n,r,t);let q8=class extends je{constructor(t,e,n,r){super(),k2(this,"_copyInfo"),this._sheetClipboardService=t,this._injector=e,this._numfmtService=n,this._univerInstanceService=r,this._initClipboardHook()}_initClipboardHook(){this.disposeWithMe(this._sheetClipboardService.addClipboardHook({hookName:"numfmt",onBeforeCopy:(t,e,n)=>this._collectNumfmt(t,e,n),onPasteCells:(t,e,n,r)=>this._generateNumfmtMutations(t,{...r,pasteType:n})}))}_collectNumfmt(t,e,n){const r=new nt;this._copyInfo={matrix:r,info:{unitId:t,subUnitId:e}};const i=this._numfmtService.getModel(t,e);i&&Er.foreach(n,(o,s)=>{const a=this._numfmtService.getValue(t,e,o,s,i);if(!a)return;const l=pt.getRelativeRange({startRow:o,endRow:o,startColumn:s,endColumn:s},n);r.setValue(l.startRow,l.startColumn,{pattern:a.pattern,type:a.type})})}_generateNumfmtMutations(t,e){const n=this._univerInstanceService.getCurrentUniverSheetInstance(),r=n.getActiveSheet(),i=n.getUnitId(),o=r.getSheetId();if(e.copyType===al.CUT)return this._copyInfo=null,{redos:[],undos:[]};if(!this._copyInfo||!this._copyInfo.matrix.getSizeOf()||!e.copyRange)return{redos:[],undos:[]};if([Wi.SPECIAL_PASTE_COL_WIDTH,Wi.SPECIAL_PASTE_VALUE].includes(e.pasteType))return{redos:[],undos:[]};const s=aAe(e.copyRange,t,!0),a=[],l={unitId:i,subUnitId:o,ranges:[]},u=this._numfmtService.getModel(i,o);Er.foreach(t,(h,f)=>{this._numfmtService.getValue(i,o,h,f,u)&&l.ranges.push({startRow:h,startColumn:f,endRow:h,endColumn:f})}),s.forEach(h=>{this._copyInfo&&this._copyInfo.matrix.forValue((f,m,p)=>{const g=pt.getPositionRange({startRow:f,endRow:f,startColumn:m,endColumn:m},h.startRange);a.push({row:g.startRow,col:g.startColumn,pattern:p.pattern,type:p.type})})});const c=Ll(i,o,a);Object.keys(c.values).forEach(h=>{const f=c.values[h];f.ranges=Ta(f.ranges)}),l.ranges=Ta(l.ranges);const d=[...H4(this._injector,c),...rc(this._injector,l)];return{redos:[{id:Fo.id,params:l},{id:Zi.id,params:c}],undos:d}}};q8=bje([yt(it.Rendered,q8),o3(0,ne(_c)),o3(1,ne(Tn)),o3(2,ne(eo)),o3(3,ne(oe))],q8);var Cje=Object.defineProperty,yje=Object.getOwnPropertyDescriptor,Sje=(t,e,n,r)=>{for(var i=r>1?void 0:r?yje(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Cje(e,n,i),i},_d=(t,e)=>(n,r)=>e(n,r,t);const Eje=()=>{let t=[];return{add:(e,n,r,i,o)=>t.push({unitId:e,subUnitId:n,row:r,col:i,value:o}),getEffects:()=>t,clean:()=>{t=[]}}};let Q8=class extends je{constructor(t,e,n,r,i){super(),k2(this,"_collectEffectMutation",Eje()),this._sheetInterceptorService=t,this._numfmtService=e,this._univerInstanceService=n,this._injector=r,this._editorBridgeService=i,this._initInterceptorEditorStart(),this._initInterceptorEditorEnd(),this._initInterceptorCommands()}_initInterceptorEditorStart(){this.disposeWithMe(Be(this._editorBridgeService.interceptor.intercept(this._editorBridgeService.interceptor.getInterceptPoints().BEFORE_CELL_EDIT,{handler:(t,e,n)=>{const r=e.row,i=e.col,o=this._numfmtService.getValue(e.unitId,e.subUnitId,r,i);if(o)switch(Ky(o.pattern)){case"scientific":case"percent":case"currency":case"grouped":case"number":{const s=e.worksheet.getCellRaw(r,i);return s&&wje(s,["s"])}case"date":case"time":case"datetime":default:return n&&n(t)}return n(t)}})))}_initInterceptorEditorEnd(){this.disposeWithMe(Be(this._editorBridgeService.interceptor.intercept(this._editorBridgeService.interceptor.getInterceptPoints().AFTER_CELL_EDIT,{handler:(t,e,n)=>{this._collectEffectMutation.clean();const r=this._numfmtService.getValue(e.unitId,e.subUnitId,e.row,e.col),i=()=>{r&&this._collectEffectMutation.add(e.unitId,e.subUnitId,e.row,e.col,null)};if(!(t!=null&&t.v))return i(),n(t);const o=String(t.v),s=ka.parseDate(o)||ka.parseTime(o);if(s){if(s&&s.z){const a=Number(s.v);return this._collectEffectMutation.add(e.unitId,e.subUnitId,e.row,e.col,{type:"date",pattern:s.z}),{...t,v:a,t:er.NUMBER}}}else(["date","time","datetime"].includes((r==null?void 0:r.type)||"")||!Rje(o))&&i();return n(t)}})))}_initInterceptorCommands(){const t=this;this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations(e){switch(e.id){case Oa.id:{const n=t._univerInstanceService.getCurrentUniverSheetInstance().getUnitId(),r=t._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),i=t._collectEffectMutation.getEffects();if(!i.length)return{redos:[],undos:[]};const o=i.filter(u=>{var c;return!!((c=u.value)!=null&&c.pattern)}).map(u=>({row:u.row,col:u.col,pattern:u.value.pattern,type:u.value.type})),s=i.filter(u=>{var c;return!((c=u.value)!=null&&c.pattern)}).map(u=>({startRow:u.row,endColumn:u.col,startColumn:u.col,endRow:u.row})),a=[],l=[];if(o){const u={id:Zi.id,params:Ll(n,r,o)};a.push(u),l.push(...H4(t._injector,u.params))}if(s){const u={id:Fo.id,params:{unitId:n,subUnitId:r,ranges:s}};a.push(u),l.push(...rc(t._injector,u.params))}return{redos:a,undos:l.reverse()}}}return{redos:[],undos:[]}}}))}};Q8=Sje([yt(it.Rendered,Q8),_d(0,ne(En)),_d(1,ne(eo)),_d(2,ne(oe)),_d(3,ne(Tn)),_d(4,ne(Eo))],Q8);const wje=(t,e)=>Object.keys(t).filter(n=>!e.includes(n)).reduce((n,r)=>(n[r]=t[r],n),{});function Rje(t){return/^-?\d+(\.\d+)?$/.test(t)}var Dje=Object.defineProperty,Ije=Object.getOwnPropertyDescriptor,xje=(t,e,n,r)=>{for(var i=r>1?void 0:r?Ije(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Dje(e,n,i),i},Xc=(t,e)=>(n,r)=>e(n,r,t);const Mje=[Zi.id,Fo.id];let J8=class extends je{constructor(t,e,n,r,i,o){super(),this._numfmtService=t,this._univerInstanceService=e,this._injector=n,this._refRangeService=r,this._sheetSkeletonManagerService=i,this._commandService=o,this._registerRefRange(),this._mergeRefMutations()}_mergeRefMutations(){this._refRangeService.interceptor.intercept(this._refRangeService.interceptor.getInterceptPoints().MERGE_REDO,{handler:(t,e,n)=>{if(!t)return n(t);const r=t.filter(i=>!Mje.includes(i.id));return r.push(...j_(t)),n(r)}})}_registerRefRange(){this.disposeWithMe(Be(P5(this._sheetSkeletonManagerService.currentSkeleton$.pipe(Fs(t=>t==null?void 0:t.sheetId),eb()),this._numfmtService.modelReplace$).pipe(tb(()=>new tn(t=>{const e=new Ia;return t.next(e),()=>{e.dispose()}}))).subscribe(t=>{const e=this._univerInstanceService.getCurrentUniverSheetInstance().getUnitId(),n=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),r=this._numfmtService.getModel(e,n),i=new Map,o=(s,a,l)=>{const u={startRow:a,startColumn:l,endRow:a,endColumn:l};let c=[];switch(s.id){case cr.DeleteRangeMoveLeftCommandId:{c=jB(s,u);break}case cr.DeleteRangeMoveUpCommandId:{c=zB(s,u);break}case cr.InsertColCommandId:{c=UB(s,u);break}case cr.InsertRangeMoveDownCommandId:{c=HB(s,u);break}case cr.InsertRangeMoveRightCommandId:{c=VB(s,u);break}case cr.InsertRowCommandId:{c=FB(s,u);break}case cr.MoveRangeCommandId:{c=LB(s,u);break}case cr.RemoveColCommandId:{c=PB(s,u);break}case cr.RemoveRowCommandId:{c=BB(s,u);break}}const d=la(c,u),h=this._numfmtService.getValue(e,n,a,l);if(!d&&h){const f={id:Fo.id,params:{unitId:e,subUnitId:n,ranges:[{startColumn:l,startRow:a,endColumn:l,endRow:a}]}},m=rc(this._injector,f.params);return{redos:[f],undos:m}}if(h&&d){const f=[],m=[],p=[{pattern:h.pattern,type:h.type,row:d.startRow,col:d.startColumn}],g={id:Zi.id,params:Ll(e,n,p)},v=H4(this._injector,g.params),_={id:Fo.id,params:{unitId:e,subUnitId:n,ranges:[{startColumn:l,startRow:a,endColumn:l,endRow:a}]}},C=rc(this._injector,_.params);return f.push(g,_),m.push(...v,...C),{redos:f,undos:m.reverse()}}return{redos:[],undos:[]}};r&&r.forValue((s,a)=>{const l={startRow:s,startColumn:a,endRow:s,endColumn:a},u=this._refRangeService.registerRefRange(l,c=>o(c,s,a));i.set(`${s}_${a}`,u),t.add(u)}),t.add(Be(new tn(s=>{t.add(this._commandService.onCommandExecuted(a=>{[Zi.id,Fo.id].includes(a.id)&&s.next(a.params)}))}).pipe(Wp(s=>s.unitId===e&&s.subUnitId===n),Fs(s=>s.ranges?s.ranges:s.values?Object.keys(s.values).reduce((a,l)=>{const u=s.values[l];return a.push(...u.ranges),a},[]):[]),XH(300),Fs(s=>s.reduce((a,l)=>(a.push(...l),a),[])),Wp(s=>!!s.length)).subscribe(s=>{s.forEach(a=>{Er.foreach(a,(l,u)=>{const c=`${l}_${u}`,d=i.get(c);if(i.delete(c),d&&d.dispose(),this._numfmtService.getValue(e,n,l,u)){const h={startRow:l,startColumn:u,endRow:l,endColumn:u},f=this._refRangeService.registerRefRange(h,m=>o(m,l,u));i.set(c,f),t.add(f)}})})})))})))}};J8=xje([yt(it.Rendered,J8),Xc(0,ne(eo)),Xc(1,ne(oe)),Xc(2,ne(Tn)),Xc(3,ne($2)),Xc(4,ne(kr)),Xc(5,ne(le))],J8);var Oje=Object.defineProperty,Tje=Object.getOwnPropertyDescriptor,$je=(t,e,n,r)=>{for(var i=r>1?void 0:r?Tje(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Oje(e,n,i),i},s3=(t,e)=>(n,r)=>e(n,r,t);let eh=class extends je{constructor(t,e,n,r){super(),this._numfmtService=t,this._sheetInterceptorService=e,this._univerInstanceService=n,this._injector=r,this._initSheetChange()}_initSheetChange(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:t=>{if(t.id===pf.id){const e=t.params,n=e.unitId||kje(this._univerInstanceService),r=e.subUnitId||Aje(this._univerInstanceService),i=this._numfmtService.getModel(n,r);if(!i)return{redos:[],undos:[]};const o=[];i.forValue((l,u)=>{o.push({startColumn:u,endColumn:u,startRow:l,endRow:l})});const s={unitId:n,subUnitId:r,ranges:Ta(o)},a=rc(this._injector,s);return{redos:[{id:Fo.id,params:s}],undos:a}}return{redos:[],undos:[]}}}))}};eh=$je([yt(it.Rendered,eh),s3(0,ne(eo)),s3(1,ne(En)),s3(2,ne(oe)),s3(3,ne(Tn))],eh);const kje=t=>t.getCurrentUniverSheetInstance().getUnitId(),Aje=t=>t.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();var Nje=Object.defineProperty,Lje=Object.getOwnPropertyDescriptor,Pje=(t,e,n,r)=>{for(var i=r>1?void 0:r?Lje(e,n):e,o=t.length-1,s;o>=0;o--)(s=t[o])&&(i=(r?s(e,n,i):s(i))||i);return r&&i&&Nje(e,n,i),i},Bje=(t,e)=>(n,r)=>e(n,r,t),Pp;let W_=(Pp=class extends S1{constructor(t,e){super(T5),this._injector=e}onStarting(){this._injector.add([Yy,{useClass:Z8,lazy:!1}]),this._injector.add([Q8]),this._injector.add([k5]),this._injector.add([J8]),this._injector.add([eh]),this._injector.add([q8]),this._injector.add([G8])}},k2(Pp,"type",dr.Sheet),Pp);W_=Pje([Bje(1,ne(Tn))],W_);const Fje={},O1=new sz({theme:Ak,locale:F5.ZH_CN,logLevel:bx.VERBOSE});O1.registerPlugin(i_,{hasScroll:!1});O1.registerPlugin(Nv);O1.registerPlugin(Jv,{container:"app",header:!0,toolbar:!0,footer:!0});O1.registerPlugin(b_);O1.registerPlugin(B_);O1.registerPlugin(W_);O1.registerPlugin(f_);O1.registerPlugin(V_);O1.createUniverSheet(Fje);
